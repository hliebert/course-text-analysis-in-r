The Solution and Estimation of Discrete Choice Dynamic Programming Models by Simulation
and Interpolation: Monte Carlo Evidence
Author(s): Michael P. Keane and Kenneth I. Wolpin
Source: The Review of Economics and Statistics, Vol. 76, No. 4 (Nov., 1994), pp. 648-672
Published by: The MIT Press
Stable URL: http://www.jstor.org/stable/2109768 .
Accessed: 25/04/2013 12:06
Your use of the JSTOR archive indicates your acceptance of the Terms & Conditions of Use, available at .
http://www.jstor.org/page/info/about/policies/terms.jsp

.
JSTOR is a not-for-profit service that helps scholars, researchers, and students discover, use, and build upon a wide range of
content in a trusted digital archive. We use information technology and tools to increase productivity and facilitate new forms
of scholarship. For more information about JSTOR, please contact support@jstor.org.

.

The MIT Press is collaborating with JSTOR to digitize, preserve and extend access to The Review of
Economics and Statistics.

http://www.jstor.org

This content downloaded from 130.82.1.40 on Thu, 25 Apr 2013 12:06:33 PM
All use subject to JSTOR Terms and Conditions

THE SOLUTION AND ESTIMATIONOF DISCRETE
CHOICE DYNAMIC PROGRAMMINGMODELS
BY SIMULATIONAND INTERPOLATION:
MONTE CARLO EVIDENCE
Michael P. Keane and Kenneth I. Wolpin*
Abstract-Over the past decade, a substantialliteratureon
methods for the estimationof discrete choice dynamicprogramming(DDP) models of behaviorhas developed. However, the implementationof these methodscan imposemajor
computationalburdens because solving for agents' decision
rules often involveshigh dimensionalintegrationsthat must
be performedat each point in the state space.
In this paper we develop an approximatesolution method
that consistsof: 1) usingMonte Carlointegrationto stimulate
the requiredmultipleintegralsat a subsetof the state points,
and 2) interpolatingthe non-simulatedvalues using a regression function.The overallperformanceof this approximation
methodappearsto be excellent.

Introduction

VER the last decade there has been growing a substantialliteratureon the structural
estimationof dynamicdiscrete choice models of
behavior.The reason for this growthis that many
behavioraleconomic models are described naturally as sequential discrete choice optimization
problemsconstrainedby resourcelimitationsand
imperfect informationabout future events. Such
models have found applicationin industrialorganization, labor economics, development economics, health economics, public finance, and
economic demography.Recent surveys by Eckstein and Wolpin (1989a) and by Rust (1992,
forthcoming)provide a good introductionto this
literature.
A majorimpedimentto the applicationof this
approachis computational.As in static discrete
choice models when the choice set is large, it is
typicalthat high dimensionalintegrationsmust be
performed to calculate the choice probabilities
needed for estimation.However, in the dynamic
setting, it is typicallythe case that high dimenO

Received for publicationDecember 17, 1992. Revision accepted for publicationAugust 19, 1994.
* Universityof Minnesotaand New York University,respectively.
Supportfor this researchfrom NIH GrantHD30156,from
the MinnesotaSupercomputerInstitute, and from the C.V.
Starr Center of Applied Economics is gratefullyacknowledged.We havereceivedhelpfulcommentson an earlierdraft
from Zvi Eckstein,John Rust, Steve Stern, Gerardvan den
Berg, and severalanonymousreferees.

[ 648

sional integrations also must be performed to
solve the dynamic optimization problem itself.'
Moreover,those integrationsmust be performed
at all values of the state space (discrete, or discretized if continuous)upon which the evaluation
of choices is conditioned,which is what Bellman
(1957) called the "curseof dimensionality."
The inherent computationalproblem of this
approachhas been accommodatedin the literature in several ways. In many applications the
dimensionalityof the problem, both in terms of
the number of choices and the size of the state
space, has been kept small. A significantpart of
the literaturehas been restrictedto problemsof
only two alternatives.Among the earliest contributions of this type were studies of the following
dichotomousdecisions:to re-enlistin the air force
or not (Gotz and McCall, 1984), to remain in an
occupation or choose a different occupation
(Miller, 1984), to renew a patent or let it expire
(Pakes, 1986), to replace a bus engine or not
(Rust, 1987), to have a child or not (Wolpin,
1984),to acceptemploymentor continueto search
(Wolpin, 1987).
A number of alternativesto reducingthe size
of the choice set and/or the state space have
been developed and implemented.They can be
classifiedas methodsthat rely on the full solution
of the dynamicprogrammingmodel but take advantage of particularstructures,functionalforms
or distributionalassumptions(Miller,1984;Pakes,
1987; Rust, 1987), or methods that circumvent
havingto solve completelythe optimizationproblem (Hotz and Miller, 1991;Manski, 1991;Hotz,

IIn randomutility models (McFadden,1973), it is usually
assumed that the additive random errors attached to each
choice, while possiblycorrelated,have some unique component. However,a statisticallynon-degeneratemodel, one in
which all mutuallyexclusivechoices have non-zeroprobability, can be obtained with as few errors as the number of
distinct(non-mutuallyexclusive)decisionvariables.Thus, the
relevant dimensionalityof the numericalintegrationsneed
increaseonly linearlywith the numberof decisionvariables.

1

Copyright ? 1994

This content downloaded from 130.82.1.40 on Thu, 25 Apr 2013 12:06:33 PM
All use subject to JSTOR Terms and Conditions

DISCRETE CHOICE DYNAMIC PROGRAMMING MODELS

Miller,Sandersand Smith, 1992).The advantages
and drawbacksof these methods will be addressed in a later section.
Computationalcomplexitywill alwaysbe limiting if exact full solutions to optimizationproblems are desired. The purposeof this paper is to
explore the performance of approximatesolutions obtainedby simulationand interpolationof
the integralvalues that must be computedwithin
full solutionmethods.In section I we present the
general problem and the specific example of occupationalchoice we use throughoutthe paperto
illustratealternativesolutionmethods.In the second section, we present a brief overviewof methods that have been developed in the literatureto
amelioratethe computationalcomplexitiesinherent in the estimationof dynamicchoice models.
Section III begins with the presentationof our
approximationmethod,which consistsof simulating the multiple integrations embedded in the
optimalsolutionby Monte Carlointegrationfor a
subset of the state space elements and interpolating the non-simulatedvalues using a specific regression function approximationthat we develop.2 This procedurecan potentiallygreatlyameliorate the "curse of dimensionality"problem.
We next present the results of using the approximation, first in terms of the degree to which it
mimics the optimal choice sequence, and second
in terms of the parameterestimates it generates
and in its resulting predictive accuracy.Evaluations are made for three different sets of structural parameter values that generate different
behavioral choice patterns. The overall performance of the approximationsis excellent, although not universallyacross the three data sets
and not with respect to all performancecriteria.
The method is sufficientlypromising,in our view,
to consider its implementationon real data as a
serious alternativeto other methods of estimation.
The particular interpolatingfunction we develop has the disadvantagethat it may become
computationallyinfeasiblewhen the state space is
extremelylarge, as occurs,for example,when the
underlyingunobservablesare serially correlated.
We therefore present several alternativeswhere

649

the computationalburden does not necessarily
grow with the dimension of the state space and
assess their relative performance.An important
advantage of the approximationmethods explored in this paper, in our view, is that their
performancewill improve naturallyas computational power continuesto increase.
I. The General Problem
A.

The Choice-TheoreticFramework

We considera general model in which an individual decides among K possible alternativesin
each of T (finite) discrete periods of time. Alternatives are defined to be mutually exclusive so
that if dk(t) = 1 indicates that alternative k is
chosen at time t and dk(t) = 0 indicates otherwise, then Ek=l dk(t) = 1. Associated with each
choice at time t is a current period reward,
Rk(t), that is known to the individualat time t
but that is randomfrom the perspectiveof periods prior to t.
The objective of the individual at any time
t = 0, ..., T, is to maximize
- T

E

E5

-'tE

,r=t

t)

R&rT)d&0T)IS(0

(1)

k c-K

where 5 > 0 is the individual'sdiscount factor,
E(>) is the mathematicalexpectationsoperator,
and S(t) is the state space at time t. The state
space consistsof all factors,knownto the individual, that affect currentrewardsor the probability
distributionof any of the future rewards.
Maximizationof (1) is accomplishedby choice
of the optimal sequence of control variables
{dk(t)}k e K for t = O,..., T. Define the maximal
expected value of the discountedlifetime reward
at t as
V(S(t), t)
T
-

max
{dk(t))kEK

E 6&-'
Lr=t

K
E Rk(T)
k=1

xdk(r)IS(t)]0

(2)

The value function V(S(t), t) depends on the
state space at t and on t itself (due to the
2
finiteness
of the horizon or the direct effect of
Bellman,Kalabaand Kotkin(1963) proposedusing polynomialsin the state space to approximatevalue functionsin a age on rewards),and can be written as

continuouschoice setting. As will become apparent,our approachto approximation,while related, differs in important
ways.

V(S(t),t)

=

max{Vk(S(t),t)},

k c-K

This content downloaded from 130.82.1.40 on Thu, 25 Apr 2013 12:06:33 PM
All use subject to JSTOR Terms and Conditions

(3)

THE REVIEW OF ECONOMICS AND STATISTICS

650

where Vk(S(t), t), the alternative-specificex- attend school, or to remain at home (consume
pected lifetime reward or value function, obeys leisure or engage in home production).4There
the Bellmanequation(Bellman, 1957)
are thus four mutuallyexclusivealternatives:occupation one, occupation two, schooling, and
Vk(S(t), t) = Rk(S(t), t)
home. The per-periodrewardfunctionsare given
+8E[V(S(t + 1),t + 1)
by
t < T-

= 11,
IS(t),dk(t)
1, Vk(S(T), T) = Rk(S(T), T).

(4)

Notice that the dependenceof the currentperiod
rewardon the state space (or at least a subset of
it) is made explicit in (4). As seen in (4), the
alternative-specificvalue function assumes that
future choices are optimallymade for any given
currentperiod decision. The expectationin (4) is
taken over the distributionof S(t + 1) conditional on S(t) and dk(t) = 1, with the conditional
densitydenoted by
Pkt(S(t

+ l)IS(t),

dk(t)

=

1).

(5)

The randomnessin rewardsarises from the existence of state variablesat time t + 1 observable
to the agent at t + 1, but unobservableat t or
before. The formulationin (5) allowsfor contemporaneouslyand seriallycorrelatedrewards.
B. A Model of Occupational Choice

To understandthe difficulties in solving and
estimatingdynamicdiscrete choice problems,we
consider as a concrete example a model of occupationalchoice. This exampleis the basis for the
subsequentwork in this paper on the simulation
method we propose as a means of solving and
estimatingthe generalmodel. We chose a specific
example because it is difficult to conceive a
generic specificationof the currentrewardfunctions. We chose an occupational choice model
because its structureaccommodatesa wide range
of complicationsthat are illustrativeof the general problem and because the economics literature on occupationalchoice has been stagnantfor
some time (Miller (1984) discussed below, is an
important exception).3Nevertheless, the reader
shouldunderstandthat the approximationmethod
we propose is applicable to discrete choice dynamic programmingmodels generally.
Assume that in each period an individual
chooses to work in either of two occupations,to
3We are also currently implementinga version of this
model on actualdata.

Rl(t)

= Wl, =

R2(t)

= W2t = w2(SI,

l((s , xlt,

x2t; a,))eElt

xlt, X2t; a2)eE2t

R3(t) = l30- 831I(st 2 12)
R4(t)

- P32(1 - d3(t = yO + E4t.

1))

+ E3t,

(6)

In (6), st is the numberof periods of schooling
obtained by the beginningof period t, x1t is the
numberof periods that the individualworked in
occupationone (experience)by the beginningof
period t, X2t is the analogouslydefined level of
experience in occupation two, a1 and a2 are
parametervectors associatedwith the wage functions, 830is the consumptionvalue of schooling,
/3, is the post-secondarytuition cost of schooling,
with I an indicator function equal to one if
si ? 12 (the individualhas completedhigh school)
and zero otherwise, fl2 is an adjustment cost
associated with returningto school (if d3(t - 1)
= 0), and yo is the (mean) value of the nonmarket alternative. The Ek5's are alternativespecific shocks, to skill levels (k = 1,2), to the
consumptionvalue of schooling (k = 3), and to
the value of non-markettime (k = 4). Note that
these shocks appear multiplicativelyin the wage,
and thus reward, functions for the two occupations, but additivelyfor the schooling and home
alternatives.Wage offers are alwaysnon-negative,
but consumptionvalues of school and home may
be of either sign.'
C. Solvingthe OptimizationProblem
Case: Ek'S seriallyuncorrelated.
It is convenientto considerfirstthe case where
the Ek's are jointly serially uncorrelated.In that
case, the joint distribution of the Ek'S is
4See Keane and Wolpin(1994) for a more completespecificationof the model.
5Given that the model representsthe optimizationproblem
of a single individual,incorporatingindividual(permanent)
heterogeneityin occupation-specificskill endowments and
school and home preferencesdoes not change anythingof
substance.The same is true of the oppositeextremein which
there are aggregate shocks affecting all individualsin the
same way.

This content downloaded from 130.82.1.40 on Thu, 25 Apr 2013 12:06:33 PM
All use subject to JSTOR Terms and Conditions

DISCRETE CHOICE DYNAMIC PROGRAMMING MODELS

651

-q) where -j is the vector of
E3t,
distributionparameters and f is the marginal
(joint) distributionof time t errors. Further,denote the full parametervector of the model as

the Emax(-) function is in general a multivariate
integral even when the EkT'S are stochastically
independent. Further,because each choice k =
1, ... , 4 leads to a different state at time T,
0 = {a1, a2, , y7,-} where the elements of 0 are Emax( ) must be calculatedat each of these four
the appropriatevectors in (6). The individual time T state points for each element of S(T - 1).
knows 0 and must solve for the sequence {dk,(t)}
Having calculated (8), the value functions at
for t = O,.. ., T, that maximizes(1) subjectto the T - 1, Vk(S(T - 1), T - 1), are known up to the
evolutionof the state space (5).
random draws of the Ek, T- 's. The individual
The state space for this problem at time t is receives a set of drawsat T - 1 and chooses the
S(t) = {St, X1t, X2t, d3(t - 1), Elt E2t, E3t, E4t)} It alternativewith the highestvalue.
is convenient to denote the deterministic(more
Movingbackwardsin time, the individualmust
accurately,predetermined)elements of the state compute, analogouslyto (8), the expected maxispace, st, Xlt, X2t, d3(t - 1), as s(t). The ele- mum of the alternative-specific
value functionsat
ments of the state space evolve accordingto
every t = O,... , T. These take the form

77rT=O(lE2t

X1 t+ 1=

Emax[V1(S(t + 1),t + 1),

Xlt + dl(t),

X2,t+1 = X2t + d2(t),

St+ = St + d3(t),
f(Et+lIS(t),

= f(Et+lIS(t),

dk(t))

dk(t)).

+ 1),

V3(S(t

+ 1),t

t + 1)
+ 1),

V4(S(t + 1), t + 1) IS(t), dk(t)]*

(7)

The last equation in (7) reflects the fact that the
Ek's are serially independent. Initial conditions
are x1O= x20 = 0, sO = 10. Notice that the deterministicelements of the state space take on only
discretevalues.
Consider an individualentering the last deci.
sion period, T, with particularvalues of the deterministicstate space elements S(T). At T the
individualreceivesa drawfrom the joint distribution of the EkT's. The individualwould then calculate each of the T period reward functions

V2(S(t

(9)

As in (8), (9) is a four-variatemultiple integral
over the joint Ek,t +1 distribution.Moreover, in
orderto calculate(9) the alternative-specific
value
functionsat (t) must have been calculatedfor all
of the possible state space values at t + 1,
S(t + 1), that may arise given S(t) and dk(t).
This impliesthat at t + 2, t + 3, .. ., T, the alter-

native-specificvalue functionsat those times must
have been calculated at all of the feasible state
points that could have arisenat those times given
S(t) and dk(t). Thus, in order to solve for the
t = 0 alternative-specificvalue functions, it is
(equation (6) at t = T) and choose the alternanecessary to have calculated the alternativetive with the largestrealized reward.
specificvalue functionsat each future date at all
Suppose the individualwere instead at period feasible state
points. At time T, this means calcuT - 1, again with particularvalues of the deterlating (8) for every feasible combination of
ministicstate space elements, S(T - 1). In order
S(T - 1) and dk(T - 1), i.e., for every possible
to calculate the alternative-specificvalue funcpoint in S(T). In the case of T = 40, S(T) has
tions, (4) at T - 1, the individualmust calculate
13,150elements.6
Emax(R1(T), R2(T), R3(T), R4(T)
IS(T-

1),dk(T-

CaseII: Ek'S seriallycorrelated.
In this case the joint distributionof the E's is

1))

state
E4T; -q). The
space at t now must include all of the E's that are

f(

=ffT fT fmax(R1(T),R2(T),
E4T E3T

E2T

EIT

1), dk(T-

E2T, E3T, E4T)dElTdE2TdE3TdE4T,

for each k = 1, ...

,

...

,

E40

...

,

ElT,

...,

known at t and that affect the distributionof

R3(T), R4(T) IS(TXf(ElT,

10

1))

(8)

4. It is important to note that

6
This numberreflects the appropriateconstraintthat the
sum of the occupation-specific
work experiencesand schooling cannot exceed T. We also assumedthat schoolingcould
not exceed ten additionalyears.

This content downloaded from 130.82.1.40 on Thu, 25 Apr 2013 12:06:33 PM
All use subject to JSTOR Terms and Conditions

652

THE REVIEW OF ECONOMICS AND STATISTICS

must be calculatedfor each element of the state
space. However, the reason for solving the optiE2t E3t, E4t, ***,
E20,
E30,
{S(t),
Eit
is composedof both discrete and continuousele- mization problem is that the solution serves as
the input into estimatingthe parametersof the
ments.
model given data on choices and possiblysome of
With serial dependence,(8) becomes
the rewards.Any inexactnessin the solutionpreEmax(Rl(T), R2(T), R3(T),
sumablytranslatesinto estimationbias.
To understandthe connectionbetween the so1),dk(T1))
R4(T)IS(Tlution of the model and estimation,considerhaving data on a sampleof homogeneousindividuals
-fT
f3TfT fmax(Rl(T),R2(T),
from the same birth cohort who are assumed to
E4T E3T E2T EIT
be solving the occupationalchoice model previously described and for whom choices are obR3(T), R4(T)IS(T - 1), dk(T - 1))
served in each of the periods t = 0, .. ., T. In
addition, as is usual, wages are assumed to be
E2T, E3T, E4TIS(T
1),
Xf(ELT
observed only in the periods in which market
dk(T1))dELT, dE2T dE3T, dE4T.
(10)
workis chosen and only for the occupationthat is
The expected maximumof the period T rewards chosen.
To simplifythe presentation,considerthe case
now depends on the prior Ekt drawsas well as on
where
the randomelements of the rewardfuncthe state space elements S(T - 1). This carries
are
serially independent. Then, the joint
tions
over to all periods of the Emax functions; S(t)
probability
of choosing occupationone at time t
replaces S(t) in (9). Clearly, the computational
and its corresponding(accepted)wage is
t+ 1. Thus, the state space at

= 1,wl,lS(t))

Pr(dl(t)

is S(t) =
E40}, which

t

= Pr(wl, + S Emax(V(S(t

2

+ 1),t + 1)IS(t),dl(t)

+ S Emax( V(S(t +

>2t

= 1)

1), t + 1)IS(t),d2(t)

=

1),

Wlt + S Emax( V(S(t + 1), t + 1) IS(t), dl(t) = 1)
80

-

831I(st ? 12)

+ E3t

-

32(1

+ S Emax(V(S(t

wlt + S Emax(V(S(t
> YO+ E4t5

-

d3(t

-

+ 1),t + 1)1S(t),d3(t)

+ 1), t + 1)IS(t),dl(t)

Emax(V(S(t

1))

C. Estimation

The computationalcomplexity that arises in
providingan exact solution to the optimization
problem is that, as the model is specified, the
expected maximum function entails a multiple
integration of dimension K and that function

1),

=

1), w,),

= 1)

+ 1), t + 1)IS(t), d4(t)

effort is greatly magnified when there is serial
dependence because the state space becomes infinitelylarge.Lackinganalyticalsolutionsfor (10),
backwardssolution of the dynamicprogramming
problemrequiresdiscretizationof the Ekt'S. With
four distinct shocks, the increase in the number
of state space elements can be substantial.

=

(11)

namely, the probabilitythat the alternativeone
value function exceeds the other three and that
the wage that is accepted is the observedwage.
An exactlyanalogousprobabilitystatementholds
for occupationtwo, with the differencebetween
those for the occupations and the probability
statementsfor schoolingand home being that the
currentperiod rewardsare not observedfor the
latter.
The likelihood function for the sample is the
productof these probabilitystatementsover time
and people. Maximizingthe sample likelihood
with respect to 0 would yield consistent and
asymptoticallynormal estimates. Evaluation of
the likelihood itself requires the calculation of

This content downloaded from 130.82.1.40 on Thu, 25 Apr 2013 12:06:33 PM
All use subject to JSTOR Terms and Conditions

DISCRETE CHOICE DYNAMIC PROGRAMMING MODELS

four-variate integrals. In the context of serial
dependence in the stochastic elements of the
rewardfunctions,maximumlikelihoodestimation
would require the calculation of a KT variate
integral rather than a sequence of K variate
integrals.
If the Emax(-) functions could be calculated
without error, it would be possible to construct
unbiased simulators of the choice probabilities
and form an MSM (method of simulated moments) estimator of the type developed by
McFadden(1989) and Pakes and Pollard (1989)
for static discrete choice models.7The computational gain over maximumlikelihoodwould be no
differentin kind for the dynamicdiscrete choice
model. The MSM estimatoris linear in the choice
probabilitiesand is therefore a consistentestimator for a fixed numberof simulationdraws used
to simulate choice probabilities.However, it is
importantto understandthat the MSM estimator
combined with a simulated estimate of the
Emax( ) functions is not consistent. As seen in
(11) the choice probabilitiesare nonlinear functions of the Emax(*)functions,which impliesthat
the simulatedchoice probabilitiesusing simulated
Emax( ) functionswill be biased. Both the likelihood estimator and the MSM estimator, which
depend on simulatedEmax(-) functions, are inconsistent in the context of nonlinear measurement error.
II. A Brief Review of Existing Solution and
Estimation Methods

In this section, we review existing methods in
the literaturefor dealing with the computational
problems described in the previous section that
arise in the full solution and estimation of discrete choice dynamicprogrammingmodels. Notice that there are no conceptual problems in
implementingmodels with large choice sets, large
state spaces, and serial dependencies in unobservables.The problemis in implementinginteresting economic models that are computationally
tractable.A comprehensivereview is beyond the
scope of this paper, particularlyin light of the
several surveys previouslymentioned that have
7 Berkovecand Stern (1991) use the MSM estimatorfor a
dynamicprogrammingoptimizationproblemfor which there
are analyticalsolutions.

653

appearedin the literature.Our purposeis to give
the reader a context within which to place the
approximationmethod exploredin this paper.
Full-SolutionMethods
Computational simplifications for handling
largechoice sets and/or large state spaces(which
includes the case of seriallycorrelatedunobservables), while remainingwithin the full-solution
paradigm,have involvedfindingconvenientforms
for the rewardfunctionsand error distributions.8
Miller (1984), Pakes (1986), and Rust (1987) are
the leading examples of this approach.The approach in Rust has been more widely adopted in
the economics literature,perhaps because of its
structuralsimilaritywith the static randomutility
model.9 That formulationhas also served as the
basis for the implementationof several of the
non-full solution methods discussedbelow.
Rust makes the following assumptions:(i) the
rewardfunctions are additivelyseparable in the
unobservables,with each unobservableassociated
with a mutually exclusive choice, (ii) the unobservablesare conditionallyindependent,i.e., conditional on observablestate variables,the unobservables are serially independent, and (iii) the
unobservablesare distributedas multivariateextreme value. There are two very appealingconsequences of these assumptionsfor solution and

8

The earliest examplesof obtainingtractabilityessentially
throughsmall choice sets and state spaces are those of Gotz
and McCall(1984)and Wolpin(1984).
9 Miller formulates an occupational choice model as a
multi-armedbandit problem. The method he develops for
tractablysolving(employingthe Gittensindex)and estimating
that model, accommodatingas it does a large choice set and
serial correlationin wages, is generalizableto problemswith
the same structure.Its main drawbackis that the assumption
in such problemsof independenceacross arms may be too
restrictiveover a broad range of economic problems. For
example,it would be inapplicableto the occupationalchoice
model we consider if work experience in one occupation
affectsproductivityin anotheroccupation.Pakesconsidersan
optimalstoppingproblem(whetheror not to renew a patent)
in which seriallycorrelatedunobservablesenter the reward
functionadditively.While the distributionalassumptionsthat
make the solution of the dynamic programmingproblem
tractableare specificto the particularproblem,and thus not
generally transportableto other stopping problems, Pakes
demonstratedthe feasibilityof incorporatingserialcorrelation
into the estimationof discretechoice dynamicprogramming
models.

This content downloaded from 130.82.1.40 on Thu, 25 Apr 2013 12:06:33 PM
All use subject to JSTOR Terms and Conditions

THE REVIEW OF ECONOMICS AND STATISTICS

654

estimation:
about the same. Stern (1991), analyzinga differ1. The Emax( ) function(the expectedvalue of ent model of retirementconcluded from simula(3) appearingin (4)) has the closed form solution tion evidence that while the approximationdid
predict well the large impact of a pension winE[V(S(t), t)]
dow, it did not predictwell other dynamicaspects
K
Y
exp(ik((t),
t)) }
of the model.
,
=y +rIns E
Wolpin (1992) estimates a structuralmodel of
|k=i
T
J
(12) laborforce dynamicsin which agents are assumed
to optimize over longer discrete periods the furwhere Vlk is the expectation of the alternative- ther are the periods into the future. This simplispecific value functions, the expectation of (4), fication has the effect of reducingthe size of the
and y is Euler's constant.Thus, multivariatenu- state space. More recently, Geweke, Slonim and
merical integrations are avoided in solving the Zarkin(1992) have proposed a solution and estidynamic programmingproblem. It should be mation method based on approximatingthe
noted that (conditional)independenceof the al- agent's decision rules that still recoverstructural
ternative-specificerrorsis not sufficientto obtain parameters.This latter paper is the closest in
an analyticalform; additive separabilityand the spiritto the approximationmethod proposedand
extremevalue assumptionsare crucial.
analyzedin this paper.
2. The choice probabilities are multinomial
logit, i.e., with X normalizedto unity,
Non-Full-Solution Methods
= 1)IA(t))

The non-full-solutionmethods that have apin the literature,Hotz and Miller (1993),
peared
(13)
exp('k(S(t), t))
Hotz, Miller, Sanders, and Smith (1994), and
, t))
Eexp(Vj(S(t)
Manski(1988), use alternativerepresentationsof
jeK
the future componentof the choice-specificvaluTherefore,multivariatenumericalintegrationsare ations that do not depend explicitlyon the strucalso avoided in likelihood estimation. However, tural parameters of the model. The Emax(*)
as in the static logit model, only limited forms of functions are estimated from data on future
correlationamong the alternative-specificerrors choice or reward probabilities. Because the
can be accommodated.10
choice-specificvaluation functions are specified
In addition to simplificationachieved through in the first two papers as they are presented in
functional form assumptions,there are several section I, it is relatively easy to describe their
examplesin the publishedliteratureof what can methodologies. However, the representationin
be viewed as a simplificationachievedthroughan Manski's path utility framework is sufficiently
approximationto the full solution. Stock and different that we will forgo discussion of it.
Wise (1990)estimatea model of retirementwhich Manski'sapproachdoes share many of the same
they call an "option value"' model, but which is advantagesand drawbacks."1
The insight of Hotz and Miller can be most
equivalent to substitutingthe maximumof the
expected alternative-specificvalue functions for easily illustratedunder Rust's assumptions.Using
the expected maximumof the alternative-specific (12) and (13), it can be shown that
value functions. Lumsdaine, Stock, and Wise
K
(1990) evaluatedthe performanceof this approxi=
=
E[V(S(t),t)]
E Pr(dk(t)
1IS(t))
mation vs. the exact solution in predicting the
k=1
effect of the pension window plan studied by
x [y + 4k(9(t),t)
Stock and Wise, and concluded that the fit was
Pr(dk(t)

10
There is a direct analogy to nested logit, but without its
usual implied sequential decision-making interpretation. Even
in the non-nested case, the independence of irrelevant alternatives axiom does not hold in the dynamic setting because
augmenting the choice set must affect the valuation attached
to all choices.

-ln(Pr(dk(t)

=

11S(t))].

(14)
11 For a brief descriptionof Manski'sapproachsee Eckstein
and Wolpin(1989).

This content downloaded from 130.82.1.40 on Thu, 25 Apr 2013 12:06:33 PM
All use subject to JSTOR Terms and Conditions

DISCRETE CHOICE DYNAMIC PROGRAMMING MODELS

Successive forward substitution for Pk(S(t), t),
recognizingthat it containsfuture expectedmaximum functions, implies that the expected maximum function at any t can be written as a function of the futureconditionalchoice probabilities.
Hotz and Miller show that this result is not
dependent on the extreme value distributionassumption,but generalizesto any distribution.The
extreme value distributionis appealing because
the representationhas a closed form. Empirical
implementation uses data on observed future
choices to sobtainthe conditionalchoice probabilities that are needed for calculatingalternativespecificvalue functions.Because choice probabilities are obtained non-parametricallyfrom the
data and are state-specific,implementationmay
require very large observation sets, particularly
when the state space is large. Structuralparameters are recovered from the contemporaneous
rewardfunctions,which are the only places they
enter in this formulation.The estimation therefore does not take into accountall of the parameter restrictionscontainedin the theory.
Although this method is significantly more
tractablethan a full solutionmethod, an inherent
limitationof this approachis that it cannot admit
to the existence of individual-specificunobservables as a componentof the state space, generally
ruling out forms of serial correlation including
permanent unobserved heterogeneity. Furthermore the Emax( ) values calculated from the
data are obviously not policy invariant as they
dependon the structuralparametersof the model.
Thus, full solution would be necessaryafter estimation in order to conductpolicy experiments.
The methodologyin Hotz, Miller,Sanders,and
Smith also uses the Hotz and Miller representation theorem. However, rather than computing
the alternative-specificvaluation functions by
consideringall feasible future paths as in Hotz
and Miller,they simulatefuturepaths in calculating the expected maximumfunctions, using (14)
in the extreme value case. Noting that in the
extreme value case, for example, the expected
values of the alternative-specificvalue functions
(normalizedagainst one of the alternatives)are
just the log-oddsof the choice probabilities,data
on choice probabilitiesare sufficientto estimate
(non-parametrically)the normalizedvalue functions. Parameterestimates are obtained by comparing the data to the simulatedvalue functions

655

using a weighted distance estimator.Because the
estimator is linear in the simulated value functions, analogousto the MSM estimator,only one
future path needs to be simulatedto obtain consistent estimates.While this method is even more
tractablecomputationallythan Hotz and Miller,
its limitationsare not different.
III. Approximating the Solutions by
Simulation and Interpolation
A.

The Method

In this section, we present an approximation
method based on simulation and interpolation.
As illustrated by (11), the choice probabilities
that enter the likelihood function are nonlinear
functions of the expected maximum function
(EMAX). Consistentestimationof 0 (T fixed as
N grows)requiresthat EMAX be preciselycalculated for all elements of the state space. Approximations to EMAX lead to inconsistentestimates
and presumablyto greaterfinite samplebias. The
extent of this bias as the accuracyof the EMAX
calculationvaries is unknowna priori and is the
subjectof the rest of the paper. The method we
propose can accommodateboth iid and serially
correlatedunobservables.
We propose to approximateEMAX by crude
Monte Carlo integration.12That is, we take D
drawsfrom the joint E distribution,calculate the
maximumof the value functions over the four
choices for the given E draw, and average the
maximumover the D draws. Clearly the simulated EMAX is unbiased,and is consistent as D
becomes large. It is possible to simulate EMAX
in this way at each point in a finite state space
and a continuousstate space can be discretized.
However,for problemsof the size we would like
to consider,such a pure simulationstrategyis not
computationallypracticable.
As a method for coping with the "curse of
dimensionality,"we propose to simulate EMAX
by the above Monte Carlo integrationfor only a
subset of the possible state points and to interpolate EMAX at the remainingstate points. There
are severalpossibleways to do the interpolations.
One method would be to use a neighborhood
12
We do not employaccelerationtechniques,e.g., antithetical variates,in order to keep the method simple.Using such
methods might increase accuracyfor given computational
burden.

This content downloaded from 130.82.1.40 on Thu, 25 Apr 2013 12:06:33 PM
All use subject to JSTOR Terms and Conditions

656

THE REVIEW OF ECONOMICS AND STATISTICS

criterion,interpolatingEMAX values from those
states that are nearby.However,there is no obvious metric of proximityamong state points in a
multi-dimensionalsetting. A second approach,
the one we adopt, is to searchfor a functionthat
relates EMAX (as in (8) or (9)) to its arguments
and that approximatesEMAX well. Those arguments depend only on the state space elements,
so that potential interpolatingfunctionsare functions of the state space elements themselves or
functions of transformationsof the state points,
such as expectedrewardsor expected alternativespecificvalue functions.After considerableexperimentation,we found that the following general
class of functionsworkswell. Denoting, as before,
Vk(S(t), t) as the expected value of Vk(S(t), t),
and MAXE(S(t), t) as maxk(Vk(S(t)),
the

Consider how a backwardsrecursive solution
would be obtained using our simulation-interpolation method. At T we perform the EMAX
simulations as described above for a subset of
state points, S*(T). These simulatedEMAX values along with the alternative-specificexpected
value functions, Vk(S*(T), T), are used to estimate the interpolatingfunction by a regression
equation.Movingbackwardsto T - 1 we wish to
perform the same calculationfor a subset S*(T
- 1). To calculatethe simulatedEMAX's as well
as the argumentsfor the interpolatingfunction,
as seen from equation(4), requiresthat we calculate EMAX at T at every point in the state
space that can be reached from a point in
S*(T - 1). Those EMAX values that are in S*(T)

are available directly,while those not in S*(T)
are calculated from the interpolatingfunction,
g(T). These steps are repeated as the backwards
EMAX(S(t), t) = MAXE(S(t), t)
solution proceeds.
It is important to note that the backwards
+ g(MAXE(S(t), t)
solution using the interpolatingfunction (15) requires that the value of EMAX either be simu-VJ(S()I t) It)
lated
or interpolatedat every point in the state
(15)
space. To see this, denote by S**(t) the set of
where the term inside the g( ) function is a points at which we either simulateor interpolate
vector of elements over k E K and where g( ) > EMAX at time t. Clearly, if K alternativesare
0. The intuition for this form is that the differ- availablein each state in each time period, then
ence between EMAX and MAXE, which must be S** (T) must be K times larger than S**(T - 1),
positive, will depend on how far apart are the which must be K times larger than S**(T - 2),
expected alternative-specificvalue functions as etc. Thus, S**(t) must contain the entire state
captured by the individual differences between space regardless of the number of state points
MAXE and the Vk's. The inclusion of MAXE in containedin S*(t).
The computationaladvantageof this approxig, along with the alternative-specificvalue functions, capturesthe notion of distancebetween the mate solution method is that, for S*(t) a small
value functions.The parametersof the g( ) func- subset of S(t), most of the time-consumingmultition depend on propertiesof the joint E distribu- ple integrationsnecessaryto constructthe EMAX
tion, i.e., on its higher-ordermoments, and on t functionsare replacedby fast interpolationsusing
itself.13Below, we compare the accuracyof sev- a regressionestimate of (15). If the interpolating
function provides a close approximationto the
eral alternativeinterpolatingfunctions(g( )).4
EMAX(Q)function,this method has the potential
13 As can be seen by manipulating (12), this representation is
to amelioratethe "curseof dimensionality"probexact, i.e., it is an equality, in the case of the multivariate lem.
However, it is importantto determine how
extreme value distribution.
14 For the case with additive errors, Stern (1991)
shows that rapidlythe numberof state space points used to
the EMAX function must satisfy the following derivative estimate the interpolatingfunction must increase
conditions with respect to 1lk (Stern, 1991): (1) the first-partial with the size of
the state space in order to mainderivatives are positive, (2) the first-partial derivatives sum
(over k) to one, (3) the first-partial derivatives are less than tain accuracy. Moreover, even though the
one, (4) the second own-partial derivatives are positive, and interpolations are considerablyfaster than the
(5) the second cross-partial derivatives are negative. When the
multiple integrations that would otherwise be
errors are multiplicative, or a mixture of multiplicative and
necessary(regardlessof the numericalintegration
additive errors as in the occupational choice model, conditions (1), (4) and (5) still hold.
technique),if the size of the state space becomes
Emax(V(S(t), t)) function is approximated by

This content downloaded from 130.82.1.40 on Thu, 25 Apr 2013 12:06:33 PM
All use subject to JSTOR Terms and Conditions

DISCRETE CHOICE DYNAMIC PROGRAMMING MODELS

657

sufficientlylarge, the computationalburden of
calculatingthe fitted values of the non-simulated
state points from the regressionmay become excessive. Later, in section III.D, we analyze the
performance of alternative interpolating functions that permit S**(t) to be less than the full
state space at time t, S(t).
An importantpoint about our approximatesolution method is that we use the interpolated
values of the Emax(Q)functions only at those
points in the state space needed for the backwardssolution for which we did not simulatethe
Emax(Q)function. We always use the simulated
EMAX values when they occur in the backwards
solution. Thus, as the numberof state points at
which we calculate simulated EMAX values increases and the number of draws used in the
simulationbecome large, our approximationapproachesthe exact solution.
As already noted, the interpolatingfunction
based on (15) may be implementedin the serially
dependent case using discretized values of the
Ek(t)'s. If they take on M possiblevalues at each
t and the serial dependenceis first-orderMarkov,
then the state space will be M * K' (K' is the
numberof disturbances,which in our example is
the same as the numberof alternatives,K) times
larger than in the iid case. If this state space is
too large, given a "reasonable"value for M and
given the size of S, for the interpolationusing
(15) to be computationallyfeasible, one of the
alternative interpolatingfunctions described in
section III.D below can be used. These interpolating functions do not require discretizationof
the shocks.

The other aspects of the model are as previously
described.
Table 1 reports parameter values for three
differentdata sets that we use for assessingperformance.15In all of the data sets, occupation
two is more skill-intensive in the sense that
schoolinghas a higher return(except in data set
three where they are equal), and "own" experience has a higher return.In addition,experience
in occupation one increases skills (and thus the
wage) in occupation two while the reverse is
never true. Thus, both schoolingand occupation
one experience provide general skills useful in
both occupations,while occupation two experience provides skills specific only to occupation
two.
Data set two differs from data set one in several aspects:(i) occupationtwo has a lower mean
wage at t = 0 in the second data set than in the
first,(ii) schoolinghas positiveconsumptionvalue,
there is a non-zero tuition cost for college and a
larger adjustmentcost associated with returning
to school in data set two, (iii) the value of nonmarkettime is lower in data set two, and (iv) the
standard deviations of the (ln) wage errors are
twice as large, and those of the schoolingvalue
and home value errorsfour times as large, in data
set two.
Data set three differsfrom one and two in that
(i) the (ln) wage functionsin both occupationsare
linear in experience,ratherthan concave,in data
set three, (ii) the schooling adjustmentcost is
larger in data set three, (iii) the value of home
time is larger in data set three, (iv) the standard
deviations of the (ln) wage errors are at least
twice as big in data set three as in two and at
B. Simulated Data
least four times as big as in one, and the standard
deviationsof the schoolingand home time value
To ascertainthe performanceof the approxierrorsare slightlybiggerin three than in two, and
mate solution method describedabove, we adopt
(v) the ln wage errorsof the two occupationshave
the followingspecificationsof the four-alternative
a contemporaneouscorrelation of 0.5 and the
occupationalchoice model
schooling and home time value errors have a
i7vlt
alo0
?a11
-a1C13Xlt 2 ++(14X2t
a
correlationof - 0.5 in data set three, while all
tzo -iallst
cglSt
Wlt
c12Xlt
2
contemporaneouscorrelations are zero in data
a
-(t15X22t
sets one and two.
+
V2t
C20 +L215t
24X2t
23Xlt
L22Xlt
These particularparametervalues were chosen
2
a
for two reasons: because they give substantively
-C25X22t
different life-cycle choice patterns and because
- 1), dk(t - 1))
6E3t,E4S(t
f(Eilt ,E2
f
f(Elt

E2 IE3t IE4S(t

N(O, E).

-

1),dk(t-1))

(16)

15 The discount factor is set to 0.95 throughout the analysis.

This content downloaded from 130.82.1.40 on Thu, 25 Apr 2013 12:06:33 PM
All use subject to JSTOR Terms and Conditions

658

THE REVIEW OF ECONOMICS AND STATISTICS
TABLE 1.-PARAMETER

VALUES

Wolpin (1994). Here we describe their main features. In data set one, the proportionof individuals in occupation one begins at 0.39, rises to a
9.21
a10
9.21
8.00
peak
in period 4 of 0.46 and graduallydeclines
0.038
0.04
a11
0.07
0.033
0.033
0.055
throughout
the rest of the life cycle to 0.23 in
a12
0.0005
0.0005
0.0
a13
period
40.
In
data set two, the pattern is similar
a 14
0.0
0.0
0.0 althoughthe initial rise in participationin occua 15
0.0
0.0
0.0
8.20
8.48
a20
7.90
pation one is greater, from 0.34 in period 1 to
0.07
0.08
0.07
a21
in period 7, and the fall more gradualto 0.55
0.66
0.067
0.067
0.06
a22
in
period
40. In data set three the rise is even
0.001
0.001
a23
0.0
0.022
0.022
0.055
more pronounced,from 0.17 in period 1 to 0.80
a24
0.0005
0.0005
0.0
a25
in period 12, as the skills acquiredin occupation
5000.
5000.
?0.
/30
one
are more general, and the decline more
,l8I0.
5000.
5000.
4000.
pronounced, to only 0.27 in period 40, as the
15000.
20000.
P2
17750.
21500.
14500.
Yo
returns are obtained by switchingto occupation
0.2
0.4
1.0
(0T11)1/2
two.
Participationin occupation two increases
0.0
0.0
0.5
UT12
0.0
0.0
0.0
continuouslyover the life cycle in all three data
T13
0.0
0.0
0.0
T14
sets, althoughmore steeply in data sets one and
0.25
0.5
(oT22)1/2
1.0
three.
0.0
0.0
0.0
T23
0.0
0.0
0.0
The proportion of individuals in school deU24
6000.
1500.
(033)1/3
7000.
clines
rapidlywith age in all three data sets as
- 2.975 x 107
0.0
0.0
UT34
is essentiallyonly an investmentgood.
schooling
6000.
1500.
(U44)1/2
8500.
Schoolinghas its highestoverallreturnin data set
= w, = exp(a,I( + a1Is, + a212XI, - a13XI, + alA2, - al5X2, +, El)
three. Home-time is lowest in data set one and
- a-,3X21?+ a-,4XI, - a25X12 + E21)
R2() = W,2 = exp(a-,(, + a-Is, ?a-,-x-,
+
constant
over the life cycle, has an inverted u- 1)) + E3,
R30) = ,31'(si 2 13) - 2(1 - d
in
data
shape
set two reachinga peak of 0.09 in
R40) = Y*A+ E41
period 7, and has a u-shape in data set three
X = (o,,)
rising to 0.13 in period 40. Thus, data set three
generatessome degree of voluntaryretirementas
they have increasinglylargererror-variances.The individualsleave occupation one because its inlatter characteristicshould, by itself, reduce the vestment opportunitiesare less valuable as the
end of the horizon is approached.
accuracyof the EMAX simulations. Using the
parametervalues in table 1, we generated three
artificialdata sets of 1000 persons each based on C. Results:Assessing Performance
an ''exact"solution of the optimizationproblem
In this section, we report on the performance
that uses 100,000drawsfor EMAX computedfor
of the approximationmethod using severalcriteall state space elements.'6 The individualsare
ria: (1) how well the approximatesolution correinitially identical;their different life cycle paths
sponds
to the true solution at the given parameare generated solely by their differentsequences
ter
values,
(2) the extent of the bias in estimated
of lifetime errordraws.
parameters
resultingfrom using the approximate
The choice distributionsgeneratedby each set
solution
method,
(3) the extent of the bias in
of parametervalues are reported in Keane and
out-of-samplepredictionsusing the approximate
solution method, and (4) the extent of the bias in
16 We did not
create a data set with serially correlated predictingthe
impactof the policy experimentof
unobservables because obtaining an exact solution and conducting an analysis of the performance of our approximation introducinga college tuition subsidy using the
method would have been computationally prohibitive. Except
approximatesolution method.
for the errors caused by the discretization of the disturbances,
In order to implementthe method we need to
there is no reason to believe that, for a given dimension of the
specify a functional form for the interpolating
state space, the performance of the approximation method
would be different with serially correlated disturbances.
function (15). The specificationthat worked best
Parameters Data Set One

Data Set Two

Data Set Three

This content downloaded from 130.82.1.40 on Thu, 25 Apr 2013 12:06:33 PM
All use subject to JSTOR Terms and Conditions

DISCRETE CHOICE DYNAMIC PROGRAMMING MODELS

(evidence is presentedbelow) is of the form:
MAXE

EMAX-

4
+

=To

ETlj(MAXE

-Vj)

j=1

+

412

E
1=1

T2j(MAXE

-

Vj).

(17)

The r's are freely time-varyingand are estimated
by ordinaryleast squares.17The subset of state
points used to estimate the interpolatingfunction, for a fixednumberof elements in the subset,
is chosen randomly.18
1. Approximate Solutions at TrueParameter Val-

ues: The first set of results considersthe performance of approximatesolutions in terms of how
closely they correspondto the optimal solutions
at the true parametervalues. SimulatingEMAX
at all of the state points, we vary the numberof
EMAX simulation draws using 2000, 1000, and
250 draws. Then, fixing the draws at 2000 we
simulated EMAX values at randomly selected
state points and used these points to estimatethe
interpolatingfunction (17). The EMAX values
are interpolated at the remaining state points.
We report results of this interpolationmethod
using 2000 and 500 state points. In contrastto the
simulation-interpolationapproximationwe also
solve the optimizationproblemusing MAXE instead of EMAX.19For each approximationspecification we generate a sample of 1000 people
using the same E draws.Thus, differencebetween
approximatesolutions and the optimal solution
17

Not all of the derivative properties of the EMAX function
are consistent with (17); specifically, some of the cross-partial
derivatives in (17) are identically zero. However, adding interaction terms generally led to worse out-of-sample EMAX
predictions. And, imposing the set of restrictions when the
interpolating function is only an approximation will not necessarily improve the predictions. For example, using the form
for EMAX obtained in the extreme value case (12) performed
worse than our interpolating function, even though it obviously satisfies the derivative restrictions. The one restriction
we did impose on the interpolated values was to set EMAX
equal to MAXE if the predicted value for EMAX was below
MAXE.
18 We were not able to find a systematic method of selecting
the state points that improved the EMAX out-of-sample
predictions. This is clearly an area for further research.
19 Even ignoring the existing literature on the use of MAXE,
the fact that MAXE is a lower bound to EMAX and that they
move together makes it a natural choice as a comparison
approximation. Moreover, EMAX approaches MAXE as the
dispersion in the disturbances go to zero.

659

are due solely to the approximationerror. Further, because estimation in the case of serial
independence is based on one-step ahead forecasts ratherthan full forecaststhat are based only
on initial conditions, we also report one-step
ahead forecastsfor the case with 2000 drawsand
500 points.20

The top panels in tables 2.1-2.3 report the
proportionof times an approximationspecification yields an optimal choice at ten period intervals and over all 40 periods for each data set,
respectively. In all three data sets, using 2000
simulationdrawsat all state points almost always
producesoptimal solutions:98.5%of the time in
data set one, 99.4% of the time in data set two,
and 99.1% of the time in data set three. While
performancedeterioratesas the numberof draws
is reducedand all state points are used, even with
only 250 draws over 96% of the choices are
correctlymatched in all of the data sets. Performance also deterioratesonly mildly as the number of state points used is reduced. Simulating
EMAX at 2000 state points (as opposed to all of
the state pQints),and applyingour interpretation
method reducesthe overallcorrectmatchesto no
worse than 96.6%. Using only 500 state points
(3.8% of the maximum number in period 40)
reduces the percentage of correct matches to
96.8% in data set one, to 92.3% in data set two,
and to 94.2% in data set three. The comparable
one-step ahead forecasts do considerablybetter,
particularlyin data set two for which the full
forecastwas least effective.The use of MAXE as
an approximationto EMAX does much worse
than any of the other approximations,achievinga
34% overall success rate in data set one, a 74%
success rate in data set two, and a 50% success
rate in data set three.
The previousset of results refers only to crosssectional matches. The bottom panels of tables
2.1-2.3 evaluate performanceof the same set of
20
Calculating the exact solution using 100,000 draws and all
of the state points took approximately 50 minutes of cpu time
on a CRAY 2. Using 2000 draws and all state points took
47 seconds, using 2000 draws and 2000 state points took 20
seconds, and using 2000 draws and 500 state points took 10
seconds. Cutting the number of draws in half, to 1000, using
2000 state point values reduced the cpu time to 13 seconds
and using 500 state points to 6 seconds. Comparable times on
an IBM RISC 6000 Model 350 are 7-8 times greater.

This content downloaded from 130.82.1.40 on Thu, 25 Apr 2013 12:06:33 PM
All use subject to JSTOR Terms and Conditions

THE REVIEW OF ECONOMICS AND STATISTICS

660
TABLE

2.1.-PROPORTION

CORRECT

No. EMAX
Drawsb
No. States

2000
All

FOR ALTERNATIVE

CHOICES

DATA

1000
All

APPROXIMATIONS

SET ONEa

250

2000

All

2000

At Selected

2000

2000C

MAXEd

500

500

All

0.971
0.963
0.967
0.971
0.973
0.968

0.971
0.992
0.994
1.00
1.00
0.994

0.401
0.386
0.312
0.279
0.264
0.338

Periods

Period

1
10
20
30
40
Total

0.979
0.982
0.986
0.985
0.985
0.985

0.974
0.969
0.970
0.972
0.971
0.970

0.977
0.972
0.977
0.979
0.977
0.977
Number

of Periods

0.984
0.983
0.983
0.986
0.988
0.984
Over

the Lifetime

Periods

1-10
11-35
36-38
39
40
Average
Number

1.3
0.7
2.4
1.4
94.2
39.4

2.1
0.7
3.1
2.4
91.7
39.1

1.0
1.0
2.8
9.5
85.7
39.4

2.6
1.5
3.1
3.0
89.8
38.8

2.4
2.2
5.2
10.6
79.6
38.7

0.0
0.0
1.8
18.6
79.6
39.8

71.0
4.4
1.6
1.9
21.1
13.6

of

Periods
a Based on a simulated sample of 1000 people.
bEMAX = Emax(V', V2, V3, V4).
c One-step ahead forecast.
d
MAXE = max(EV', EV2, EV3, EV4).

TABLE

2.2.-PROPORTION

CORRECT

No. EMAX
Drawsb
No. States

2000
All

FOR ALTERNATIVE

CHOICES

DATA

1000
All

APPROXIMATIONS

SETTWOa

250

2000

All

2000

At Selected

2000

2000C

MAXEd

500

500

All

0.976
0.898
0.907
0.927
0.930
0.923

0.976
0.966
0.965
0.994
1.00
0.978

0.742
0.769
0.728
0.721
0.734
0.740

Periods

Period

1
10
20
30
40
Total

0.997
0.995
0.996
0.996
0.996
0.994

0.980
0.975
0.974
0.978
0.984
0.975
Number

0.986
0.957
0.962
0.960
0.970
0.962
of Periods

0.987
0.969
0.956
0.961
0.981
0.967
Over

the Lifetime

Periods

1-10
11-35
36-38
39
40
Average

0.0
1.5
2.4
1.9
94.2
39.7

0.1
6.3
4.9
3.4
85.3
39.0

0.2
9.8
8.3
5.5
76.2
38.5

0.0
7.7
12.3
16.8
63.2
38.7

0.4
19.1
18.0
19.7
42.8
36.9

0.0
0.4
23.1
33.7
42.8
39.1

Number
of
Periods
a Based on a simulated sample of 1000 people.
bEMAX = Emax(V', V2, V3, V4).
c One-step ahead forecast.
dMAXE = max(EV', EV2, EV3, EV4).

This content downloaded from 130.82.1.40 on Thu, 25 Apr 2013 12:06:33 PM
All use subject to JSTOR Terms and Conditions

3.4
58.4
17.7
8.6
11.9
29.6

DISCRETE CHOICE DYNAMIC PROGRAMMING MODELS
TABLE

2.3.-PROPORTION

CHOICES

CORRECT
DATA

No. EMAX
Drawsb
No. States

2000
All

1000
All

FOR ALTERNATIVE

661

APPROXIMATIONS

SET THREEa

250

2000

All

2000

At Selected

2000

2000C

MAXEd

500

500

All

0.969
0.898
0.924
0.960
0.975
0.942

0.969
0.941
0.961
0.974
1.00
0.963

0.709
0.427
0.421
0.514
0.765
0.508

Periods

Period

1
10
20
30
40
Total

0.995
0.989
0.994
0.989
0.996
0.991

0.995
0.992
0.997
0.997
0.998
0.994
Number

0.992
0.956
0.987
0.990
0.990
0.982
of Periods

0.993
0.970
0.970
0.959
0.982
0.966
Over

the Lifetime

Periods

1-10
11-35
36-38
39
40
Average

0.0
1.6
6.4
7.4
84.7
39.7

0.0
0.7
5.7
5.3
88.3
39.8

0.0
3.4
13.1
11.6
71.9
39.3

0.0
6.9
25.8
21.2
46.1
38.7

0.0
15.3
35.6
23.9
25.2
37.7

0.0
2.7
38.9
33.2
25.2
38.5

1.4
97.8
0.6
0.3
0.0
20.3

Number
of
Periods
a Based on a simulated sample of 1000 people.
bEMAX = Emax(V', V2, V3, V4).
c One-step ahead forecast.
dMAXE = max(EV1, EV2, EV3, EV4).

alternativeapproximationspecificationson a longitudinalbasis by reportingthe distributionof the
number of periods over the 40 period lifetime
that choices were optimal and the averageof the
total number of periods in which the optimal
choice is made. Using this criterion,the approximations other than MAXE performvery well in
all three data sets. Although the fractionof individuals with all 40 choices correctly predicted
does diminish when fewer draws are used and
also when interpolationis used, the fraction of
individuals with at least 30 periods correctly
matched never is below 90%. And even in the
worst case, over 50% of individualsare matched
correctlyin 39 or 40 periods. In contrast,for the
21
We also performed period-by-period chi-square fit tests,
based on the same simulated sample of 1000 people, of the
choice distribution and the state variables, accumulated
schooling and occupation-specific work experience, for each
approximation specification. The results are reported in Keane
and Wolpin (1994). To summarize, for data set one all of the
approximations except for MAXE performed extremely well
in this dimension. For data set two, the fit was only rejected
consistently for the 2000 points-500 draws approximation and
for the MAXE approximation. For data set three, the schooling distribution was not well fit even for the 2000/2000 and
250/ALL cases, while the choice distribution fit well even for
the 2000/500 approximation and MAXE continued to perform poorly.

MAXE approximationonly in data set two are
even 50%of the individualsmatchedcorrectlyfor
30 or more periods.21
Overall, the evidence presented above implies
that (i) when EMAX is approximatedby Monte
Carlointegrationat all state points, in most cases
even 250 simulationdraws may be adequate to
approximate the solution of the optimization
problem, and (ii) the approximationsolution,
while more sensitiveto the numberof state points
for which EMAX must be interpolatedthan was
the EMAX approximationusing all state points
to the numberof draws,is by most criteriaclose
to the true solution.
It is possible that the deteriorationin the performance of the approximationsas fewer state
points are used to estimate the interpolating
function occurs because the interpolatingfunction that we have specifieddoesn'tpredictEMAX
very well. Table 3, however,provideslimited evidence that the function we use provides a quite
accurateprediction.Table 6 reports the correlation between the actual EMAX in period 40 and
the predicted EMAX for the three data sets,
when all state points are used and when only 200
state points are used, for four differentspecifications of the interpolatingfunction. The different

This content downloaded from 130.82.1.40 on Thu, 25 Apr 2013 12:06:33 PM
All use subject to JSTOR Terms and Conditions

THE REVIEW OF ECONOMICS AND STATISTICS

662

TABLE 3.-CORRELATION

OF PREDICTED EMAX USING 200 STATE POINTS AND ALL (13150)
IN PERIOD 40 FOR ALTERNATIVE INTERPOLATING FUNCTIONS

200
Points

200
Points

200
Points

200
Points

Linear and Square Root

Logarithmic

Square Root

Linear

STATE POINTS

Data
Set

All
Pts

In
Sample

Out of
Sample

All
Pts

In
Sample

Out of
Sample

All
Pts

In
Sample

Out of
Sample

All
Pts

In
Sample

Out of
Sample

One
Two
Three

0.874
0.978
0.974

0.870
0.980
0.979

0.870
0.978
0.974

0.931
0.982
0.941

0.916
0.986
0.941

0.930
0.982
0.938

0.873
0.849
0.724

0.874
0.918
0.764

0.870
0.950
0.721

0.980
0.994
0.989

0.975
0.996
0.990

0.973
0.994
0.989

specificationsrefer to different functional forms
for g(Q) in (15). The forms we report are linear,
square root, logarithmic, and both linear and
square root. Recall that the linear plus square
root specificationis the function used in producing the previous tables. The combined linearsquare root specification yields the highest
out-of-sample correlation among the different
specifications,0.973 for data set one, 0.994 for
data set two, and 0.989 for data set three.
Figures1.1-1.3 depict the actualand predicted
dependent variable, EMAX - MAXE, as V2
varies over a representative part of the state
space at fixed values of VI and V3 (V4 is always
fixed)for each of the three data sets. When V2 is
below MAXE, i.e., P2 is not the maximumof VI
through

174,

EMAX - MAXE rises with P2 as

MAXE is constant. EMAX - MAXE reaches a
maximumwhen V2 equals MAXE and then declines as V2 increases; each unit increase in V2
and thus MAXE increases EMAX by less than
one unit and by smalleramountsthe greateris V2
(and thus MAXE). As is evidentfrom the figures,
and consistentwith table 3, the predictionsbased
on the interpolatingfunction(17) are usuallyvery
close.
Figures2.1-2.3 replace EMAX - MAXE with
EMAX itself, which is what enters the dynamic
programmingsolution. The figures also include
the MAXE approximationwhich is below V2 until V2= MAXE and is thereafter equal to V2.
While the interpolatingfunctionfits quite well, as
is alreadyknownfrom the previousset of figures,
MAXE differs from EMAX by as much as 40%.22

In spite of the evidence from table 2 and these
figures, it is nevertheless true that the errors
22 Interestingly, while the MAXE function is convex in V2'
as must be the Emax function, the best fitting approximation
function is not.

of EMAX
inducedby the simulation-interpolation
must be sufficientlylarge in some cases to produce the false predictionsreportedin table 2.
2. Estimation Based on Approximate Solutions.

Given the fit-test results reported in the preceding tables, it is unclearto what extent the approximations would generate biases in parameters
estimatedfrom data obtained from the exact solution. To ascertain how large estimationbiases
would be, we performeda Monte Carlo experiment of estimatingthe parametersof the occupational choice model for 40 different 100 person
data sets generatedfrom the exact solution. Estimation was performed by simulated maximum
likelihood(Albrightet al., 1977) using 200 draws
to form kernel-smoothedsimulatorsof the probabilities, as given by (11), that enter the likelihood
function.23For these experiments,we used a 500200 approximationspecification, 500 draws to
simulated EMAX and 200 state points for the
interpolatingfunction, considerablysmaller than
the draw-state point combinations reported in
tables 35.24

Tables 4.1-4.3 report the resultsof this Monte
Carlo experiment for the three data sets. The
parametersare as previouslydefined except for
the ai's which are the Cholesky decomposition
parametersused to generate the joint Ek error
covariancematrix.The thirdcolumnin the tables

23
The smoothing function is necessary because with only
200 draws there are cells that have no simulated observations
and because it enables the use of gradient methods for
estimation. The smoothing function used was the kernel
smoothing function described in McFadden (1989) with a
window parameter of 500.
24 The simulated ML estimator is consistent as the number
of state points, the number of EMAX simulation draws, and
the number of choice probability simulation draws all become
large.

This content downloaded from 130.82.1.40 on Thu, 25 Apr 2013 12:06:33 PM
All use subject to JSTOR Terms and Conditions

663

DISCRETECHOICEDYNAMICPROGRAMMINGMODELS
FIGURE 1.1.-ACTUAL

FIGURE

VS. PREDICrED VALUE OF
DATA SET ONE

w
)J

-

MAXE:

DATA SET

Two

7000 _
6000

X 2500 W 2000

-

8000

3500 w
X 3000

1.2.-AcTUALVS. PREDICTEDVALUE OF

EMAX

EMAX - MAXE:

w

-

5000

-o 4000

0 1500 -

-

0)

0)

d1000

_

t3500

-

3000

t

0
0

I

10000

15000

20000

I

I

I

I

25000 30000 35000 40000

V2
o ActualEMAX-MAXEA PredictedEMAX-MAXE

Note: Dataset one, points 415 through442 in the state space
in period 40. At these points, VF = 20,619.65, V3 = -4000.0
and V4= 17,750.0.
FIGURE

1.3.-AcTUAL

2000_

1000

A

10000

15000

20000

25000

30000

35000

V2
o ActualEMAX-MAXE A PredictedEMAX-MAXE

Note: Dataset two, points 415 through 442 in the state space
in period 40. At these points, VP = 22,337.01, V13= -10,000.0
and V4 = 14,500.0.

VS. PREDICTED VALUE OF
DATA SET THREE

reports the estimated bias, that is, the average
deviation of the estimated parameter from the
15000
true parameter over the 40 experiments. The
t-statisticfor that bias, reported in the next column, is obtained from the standarddeviationof
the estimated parameters over the 40 experiments, which is shown in column five. The last
column shows the average estimated standard
E 10000_
error of the parameter estimate obtained from
the (simulated)first derivativeouter product approximationof the Hessian matrix of the likeli~\
7500
hood.
Considerthe results for each of the data sets.
For data set one, the biases overall seem to be
15000 very small and preciselyestimated. The only parametersfor which the bias seems at all substantively significant are the Cholesky parameters
I ,
2500
,
a33,a42, and a44. Given that we observe the cur90000
70000
50000
30000
10000
rent period rewards for occupations, namely
V2
(accepted)wages, but not for schoolingor home,
j PredictedEMAX-MAXE
o ActualEMAX-MAXE
it might be expected that pinning down error
variancesand covariancesinvolvingthose choices
would be most difficult.Based on the empirical
Note: Dataset three, points 415 through 442 in the state space
=
=
15,000.0 standarddeviations,the model parameters(true
in period40. At these points, V1 19,148.89,V3
and V4= 21,500.0.
value + bias) are themselves in most cases also
EMAX - MAXE:

-n

This content downloaded from 130.82.1.40 on Thu, 25 Apr 2013 12:06:33 PM
All use subject to JSTOR Terms and Conditions

664

THE REVIEW OF ECONOMICS AND STATISTICS

FIGURE 2.1.-AcTUAL
vs. PREDICTED
DATA SET ONE

40000

EMAX:

DATA SET

-

40000

x
<

VS. PREDICTED

FIGURE 2.2.-ACTUAL

x
<

35000

35000

Lu

EMAX:

Two

-

-

LuJ

~~~~~~~~~~~0
0
~~~~~~~~~~0
~~~~~~~~~~0
~~~~~~~~~~0
0
O

V
4-

0
V

30000

V

0) 30000

Q)

0

0

CL

-o

o

0o

? 25000

0

0O

?

0

0

25000

~~~~~~~~0

0
<

0
ooooo0

0~~~~~~

-

0

0

20000
10000

o Do0

I

15000

o 000

I

20000

I1
25;00

I

30000

35000

V2

o ActualEMAX o MAXE A PredictedEMAX
Note: Dataset two, points 415 through 442 in the state space

in period 40. At these points, PI = 20,619.65,V3
and V4= 17,750.0.

4000.0 in period 40. At these points, V1 = 22,337.01, V3 = -10,000.0
and V4 = 14,500.0.

FIGURE 2.3.-ACTUAL
VS. PREDICTED EMAX:
DATA SET THREE

100000
90000

_

x

<

80000

0

LuJ
?70000

-0

a) 60000

-

C

o

50000

0o

0~~~~~~~
<

0~~~~~~~
o? 0

A

ie 40000

0p

V~~~~~V
30a000
20000
10000

=

8

-

I
,
70000

I
90000

OO
.

I
,
30000

I
50000

V2
o ActualEMAX 0 MAXE

a PredictedEMAX

Note: Dataset three, points 415 through 442 in the state space
in period 40. At these points, V1 = 19,148.89, V3 = - 15,000.0
and V4 = 21,500.0.

precisely estimated; t-statisticsover 100 are not
unusual. However, standarderrors based on the
simulated approximationto the Hessian matrix
are significantlyoverstated,often by an order of
magnitude.
The biases are also generallysmallfor data sets
two and three, althoughless preciselyestimated.
Again, the only substantivelyimportant biases
seem to be for the Choleskydecompositionparametersassociatedwith schoolingand home, a31
and a32 for data set two and a31and a42 for data
set three. Also, as with data set one, parameters
are estimatedprecisely,but standarderrorsusing
the simulatedouter productapproximationto the
Hessian, while generally overstated, seem to be
less severely overstated than was the case with
data set one.
While the biases appearsmall in some sense, it
is unclearwhat is an appropriatemetric.If one is
interested in the estimates of particularparameters in themselves, then it probablymakes little
differenceif the "return"to schoolingis thought
to be 3.8% in occupationone or 3.822%as is the
case for data set one. However, it is likely that
the parametervalues themselves are not of pri-

This content downloaded from 130.82.1.40 on Thu, 25 Apr 2013 12:06:33 PM
All use subject to JSTOR Terms and Conditions

DISCRETE CHOICE DYNAMIC PROGRAMMING MODELS
TABLE

4.1.-MONTE

CARLO
DATA

Parameter
a10
all
a12
a13
a14

a15
a20
a21
a22
a23

a24
a25

po

p1
P2

Yof
all
a21
a22
a3l

a32
a33
a41

a42
a43
a44

ESTIMATION

RESULTS

SET ONEa

Biasb

t-statistic
Biasc

Standard Deviation
of Estimated
Parameterd

9.21
0.038
0.033
0.0005
0.0
0.0
8.48
0.07
0.067
0.001
0.022
0.0005
0.0
0.0

0.0025
0.00022
0.00037
-0.000035
-0.00062
0.0000009
0.0023
0.000007
0.00031
- 0.000029
-0.00040
- 0.000035
- 67
147

9.92
8.73
16.0
- 19.5
-3.52
0.10
7.59
0.49
13.6
- 23.1
-6.24
- 5.46
4.24
6.42

0.0016
0.00016
0.00014
0.000011
0.0011
0.000058
0.0019
0.000095
0.00014
0.000008
0.00040
0.000041
100
145

4000

- 207

- 4.15

317

- 111
17750
- 0.0014
0.2
-0.0017
0.0
- 0.00029
0.25
0.270
0.0
0.0
- 0.037
- 424
1500
0.042
0.0
0.0
0.210
-0.103
0.0
- 467
1500

-4.40
- 3.10
-0.70
-0.41
6.56
- 1.05

159
0.0030
0.016
0.0044
0.261
0.224

True
Value

665

- 12.3
2.19
3.27
- 1.10
- 8.20

Mean of Estimated
Standard Errore
0.014
0.0015
0.00079
0.000019
0.0024
0.000096
0.0123
0.00096
0.0010
0.000030
0.00090
0.000070
459
410

660
1442
0.0056
0.023
0.0046
0.413
0.379

218

350

0.123
0.406
-0.588
360

0.911
0.624
0.870
786

a Based on 40 sets of 100 individuals. EMAX simulation uses 500 draws, interpolation uses 200 points, and
likelihood simulation uses 200 draws.
40)

,2

I^

2

1

d.
9

3J
40)

fJ=

'El/ =

ali'71it

e21 = a2-17i,

+ a2272,

E31= a3171, + a32772, + a33773,

e4
7k/

= a4-17i,
N((,1),

+ a42772, + a43773, + a44774,
k = 1,...,4.

maryinterest,but ratherthat the model wouldbe
used for some forecastingpurpose.It is therefore
important to consider the performance of the
approximationwhen the estimated models are
used for out-of-sampleprediction. Table 5 provides such information.To obtain out-of-sample
predictions,a new set of 40 samples of 100 persons each was drawnand matchedto each of the
40 sets of estimated parametervectors obtained
from the original 40 samples of 100 persons.
From each of those 40 new samples, we calculated mean schoolingattainmentand work expe-

rience in each occupationat the end of life based
on the estimated parametersand using the approximate solution method. The same calculations were performedat the true parametersusing the exact solution method.
For data set one, table 5 showsthat the approximate solutionoverstatesschoolingattainmentby
0.06 periods, understateswork experience in occupationone by 0.36 periods,and overstateswork
experience in occupation two by 0.32 periods.
The residual home time, not reported in the
table, is overstatedby 0.02 periods.In percentage

This content downloaded from 130.82.1.40 on Thu, 25 Apr 2013 12:06:33 PM
All use subject to JSTOR Terms and Conditions

666

THE REVIEW OF ECONOMICS AND STATISTICS
TABLE

4.2.-MONTE

True
Value

Parameter

Biasb

9.21
0.40
0.33
0.0005
0.0
0.0
8.20
0.08
0.067
0.001
0.022
0.0005

alo
a11
a12

a13
a 14
a 15
a20
a21
a22
a23
a24
a25

a21

a22
a31

a32
a33
a41
a42
a43
a44

t-statistic
Biasc
2.58
2.63
2.43
- 10.0
- 3.29
- 4.55
0.70
- 1.87
0.61
- 7.53
1.62
- 5.77

- 223

- 2.31

218

15000

- 114

14500
0.4
0.0
0.5
0.0
0.0
6000
0.0
0.0
0.0
6000

- 392
- 0.00028
0.0051
- 0.00039
- 0.394
0.421
106
- 0.065
0.070
0.117
89

1.89
0.67
5.03
0.40
1.55
0.62
3.20
2.71
1.24
0.059
0.49
0.59
0.85

-

d

RESULTS

TWO

5000

p1

Yof
all

0.00076
0.000079
0.000059
-0.000022
- 0.00017
- 0.000032
0.00023
- 0.000058
0.000017
- 0.000036
0.000039
- 0.000023

SET

5000

p0
2

ESTIMATION

CARLO
DATA

Standard Deviation
of Estimated
Parameterd

Mean of Estimated
Standard Errore

0.0019
0.00019
0.00015
0.000014
0.00033
0.000044
0.0021
0.00020
0.00017
0.000030
0.00015
0.000025

610
732
1064
493
0.0044
0.021
0.0040
0.778
0.982
541
0.699
0.903
1.26
660

Based on 40 sets of 100 individuals. EMAX simulation uses 500 draws, interpolation
likelihood simulation uses 200 draws.

0.0041
0.00051
0.00030
0.000012
0.00050
0.000036
0.0054
0.00060
0.00060
0.000026
0.00040
0.000017

906
999
2565
1601
0.0057
0.022
0.0076
0.971
0.793
1034
1.02
0.641
0.658
955
uses 200 points, and

40

bd. 1

4O
0i1

1

40
+ 122

/2.

40

fj=l

cl, =
'E2, =
'E3, =
e41

=

7ki=

ali'71l,
a2i1711t

+

a22772,

a3i17i1t

+

a32772,

a4i17i1t

+

a42772,

-N(O, 1), k=

+

a33773,

+

a43773,

+

a44774,

1, ...,4.

terms, predictionerrorsare all below 3%. While
the standarderrors of the predictionerror estimates generally exceed their point estimates,
based on 95% confidence intervals one would
probablyjudge these differences to be substantively small. The prediction biases for data set
two are larger than those obtained for data set
one, and they are also much more preciselyestimated. However, 95% confidence intervalsspan
still reasonablysmall biases. Data set three has
the largest schooling prediction bias, 15%, but
small experiencebiases. The 95% confidence in-

terval for the schoolingbias includeswhat might
be judged an economically significanterror, at
the outer bound 0.75 periods (years)given actual
additional attainmentof 3.78 periods or a 20%
error.
An importantreason for obtainingestimatesof
the structuralchoice model is to calculate the
effects of counterfactualpolicy interventionson
decisions. Table 6 compares the estimates of a
college tuition subsidy on end-of-life schooling
and occupation-specificexperienceusing the approximateand exact solutionsbased on the same

This content downloaded from 130.82.1.40 on Thu, 25 Apr 2013 12:06:33 PM
All use subject to JSTOR Terms and Conditions

DISCRETE CHOICE DYNAMIC PROGRAMMING MODELS
TABLE

4.3.-MONTE

CARLO
DATA

a10
a11

8.00
0.070
0.055
0.0
0.0
0.0
7.90
0.070
0.06
0.0
0.55
0.0
5000
5000

a 12
a13
a 14
a 15

a20
a21
a22
a23
a24
a25

po

p1

20000

P2

21500
1.0
0.5
0.866
0.0
0.0
7000
0.0
0.0
-4250
7361

Yof

all

a2l

a22
a3l

a32
a33
a4l

a42
a43
a44

RESULTS

SET THREEa

Biasb

t-statistic
Biasc

Standard Deviation
of Estimated
Parameter d

Mean of Estimated
Standard Errore

0.00032
- 0.000047
0.000020
- 0.0000018
- 0.00034
0.00014
0.00021
0.000026
- 0.00013
- 0.000064
0.0000078
- 0.0000086
71.0
489

2.72
- 2.47
1.29
-0.69
- 2.60
2.95
1.74
1.07
- 3.00
- 4.93
0.64
- 3.66
1.18
4.45

0.00075
0.00012
0.000097
0.000011
0.00083
0.00031
0.00076
0.00016
0.00027
0.000082
0.000077
0.000015
381
695

0.012
0.00038
0.00023
0.0000079
0.0016
0.00021
0.0068
0.00037
0.00049
0.000032
0.00026
0.000011
1073
1208

962

2004

True
Value

Parameter

ESTIMATION

243
- 0.78
-0.000033
0.00051
0.000086
-0.321
-0.110
182
0.055
0.179
12.3
-1.11

667

1.59
-0.26
-0.25
1.95
0.40
-4.37
-0.75
2.69
1.00
1.87
0.11
-0.01

19.2
0.00082
0.0016
0.0013
0.465
0.927
426
0.346
0.604
735
695

25.3
0.011
0.0059
0.0082
0.756
0.630
725
0.518
0.494
579
519

a
Based on 40 sets of 100 individuals. EMAX simulation uses 500 draws, interpolation uses 200 points, and
likelihood simulation uses 200 draws.
40

bd-

e,60= 40

40

40
140
0lt =
f

1,

t7l

J=
2t=
3t=
4t=

a21-q1, + a22n2,
a31-q1, + a32n2, + a33n3,
a41-rj1 + a42-r2, + a43rj3, + a44-r4,
4kN0..04.

method of constructingout-of-sampledata used
in table 5 described above. The amount of the
tuition subsidyvaries acrossthe data sets in order
to keep the effects of similarmagnitude.As table
6 indicates, a 500 dollar per-period subsidy assumingdata set one parametersincreasesschooling by 1.44 periods, a 1000 dollar per-period
subsidy assuming data set two parameters
increasingschoolingby 1.12 periods, and a 2000
dollarper-periodsubsidyassumingdata set three
parametersincreases schooling by 1.67 periods.
The correspondingtuition effects based on the

parameterestimates obtained from the approximate solution are 1.72, 1.08, and 1.14 periods.
Using the approximatesolution would overstate
the cost of the programby 140 dollarsper cohort
member for data set one (860 dollars vs. 720
dollars per cohort member).It would understate
the cost by only 35 dollarsper cohort memberfor
data set two (1082 vs 1117),but would understate
the cost by 1060 dollars per cohort member for
data set three (2280 vs. 3340). Confidenceintervals on all of these estimates are quite narrow.
Whether an understatementof 30% of the total

This content downloaded from 130.82.1.40 on Thu, 25 Apr 2013 12:06:33 PM
All use subject to JSTOR Terms and Conditions

668
TABLE

THE REVIEW OF ECONOMICS AND STATISTICS
5.-OUT-OF-SAMPLE

FIT

OF MEAN

OF STATE

VARIABLES

AFTER

PERIOD

40

FOR APPROXIMATE

SOLUTION

METHOD

(standard deviations in parentheses)
Data Set One

Data Set Two

Experience
Schooling
Exact Solutiona
Approximate
Solutionb
Absolute
Prediction Error
Percent
Prediction Error
0.95 Confidence
Interval for
Absolute
Prediction Error

12.75
(0.25)
12.81
(0.38)

Occ. 1

Occ. 2

12.73
(1.40)
12.37
(2.33)

Data Set Three

Experience
Schooling

23.90
(1.31)
24.22
(2.20)

12.30
(0.23)
12.54
(0.39)

0.32

0.24

0.06

-0.36

2.2c

2.8

1.3

-0.082,
0.202

-1.18,
0.462

-0.480,
1.12

Occ. 1
23.81
(0.78)
22.64
(1.28)

10.4
0.106,
0.374

Experience

Occ. 2

Schooling

11.36
(0.75)
12.38
(1.22)

Occ. 1

13.78
(0.27)
13.21
(0.48)

-1.17

1.02

-4.9

9.0

-0.746,
-1.59

0.590,
1.46

-0.57
-15.1
-0.370,
-0.750

Occ. 2

24.65
(0.49)
24.72
(0.82)

10.58
(0.42)
10.89
(0.63)

0.07

0.31

0.3

2.9

-0.228,
0.368

0.070,
0.550

a

Based on 40 samples of 100 persons using true parameter values.
on 40 samples of 100 persons using estimated parameter values for each of the 40 samples as in tables 4.1-4.3.
c Relative to schooling - 10.0.
hBased

TABLE

6.-EFFECT

OF COLLEGE
FOR

TUITION

ON STATE

SUBSIDY

APPROXIMATE

vs.

EXACT

Data Set Onea

Exact Solutiond
Approximate
Solutione
Absolute
Prediction Error
0.95 Confidence
Interval for
Difference

Occ. 1
- 3.43
(0.94)
-4.36
(1.10)

1.44
(0.18)
1.72
(0.27)

AFTER

PERIOD

Data Set Twob

Experience
Schooling

VARIABLES

Occ. 2

Data Set Threec

Experience
Schooling

40

SOLUTION

Occ. 1

Occ. 2

2.19
(0.89)
2.90
(1.06)

1.12
(0.22)
1.08
(0.30)

- 2.71
(0.53)
-2.70
(0.75)

2.08
(0.43)
2.12
(0.60)

0.28

-0.93

0.71

- 0.035

0.006

0.039

0.178,
0.382

-1.47,
-0.390

0.190,
1.27

-0.159
0.089

-0.304,
0.316

-0.207
0.285

Experience
Schooling
1.67
(0.20)
1.14
(0.23)

Occ. 1

Occ. 2

-1.27
(0.18)
-0.812
(0.27)

- 0.236
(0.10)
-0.154
(0.20)

-0.529

0.455

0.083

-0.641
- 0.417

0.339,
0.569

0.015,
0.151

a

500 dollar tuition subsidy.
dollar tuition subsidy.
c 2000 dollar tuition subsidy.
dBased
on 40 samples of 100 persons using true parameter values.
on 40 samples of 100 persons using estimated parameter values for each of the 40 samples as in tables 4.1-4.3.
eBased
h1000

cost of the intervention,as for data set three, is polating function (15), the Vk's,are themselves
large dependson the accuracyof alternativefore- functions of the next period EMAX function, as
casts.
can be seen by takingthe expectationof (4). Even
very fast interpolationswill become too computationally burdensomewhen the state space, and
D. The Case of Extremely Large State Spaces:
therefore the numberof fitted EMAX's, is suffiAlternative Interpolating Functions
ciently large. Computermemory limitationswill
1. The Problem:As discussed in the previous be reachedeventuallyas well.
section, the interpolatingfunction based on (15)
Serial correlation in unobservablestate variwouldbecome infeasibleto implementif the state ables is a special case of the general problem
space is sufficientlylarge. Recall that the approxi- because, as noted, it has the effect of increasing
mate solutionmethodbased on (15) requiresthat the size of the state space. If each disturbanceis
the value of EMAX be either simulatedor inter- first-orderMarkov,calculatingEMAX(S(t + 1),
polated at every point in the state space. The t + 11S(t), E(t), dk(t) = 1) requires integrating
reason is that the argumentsin the EMAX inter- over the distribution of E(t + 1) conditional on

This content downloaded from 130.82.1.40 on Thu, 25 Apr 2013 12:06:33 PM
All use subject to JSTOR Terms and Conditions

DISCRETE CHOICE DYNAMIC PROGRAMMING MODELS

669

E(t). Backwards solution using (15) involves con- istic componentsof the rewardfunctions shown
structing and saving in memory a value (simu- in (6).25 The third specificationof the interpolatlated or interpolated) of EMAX(S(t + 1), t + ing function modifies the second by adding the
lS(t),E(t), dk(t) = 1) for every (S(t + 1), E(t)) maximumof the deterministiccomponentsof the
value functions, MAXE (0), as a regressor.This
point in the state space.
The general problem of an extremely large last formulation is still feasible in the case of
state space can be avoidedby using interpolating serial correlation because, unlike the Vk funcfunctions for EMAX that do not include next tions, this deterministicfunctiondoes not depend
period EMAX values as arguments. Examples on E(t - 1). However, this form is not feasible if
would be interpolatingfunctions for EMAX at the deterministiccomponentof the state space is
time t whose argumentswere the state variable extremelylarge, because MAX(O)must be conat time t themselves, or the expected reward structed at all points of the deterministicpart of
functions at time t. In these cases, the fitted the state space.
The performanceof these interpolatingfuncEMAX values can be constructed as they are
needed in the backwardssolution from the esti- tions is comparedin tables 7 and 8. We use the
mated interpolating function parameters, and same three data sets as in tables 1-6. Unfortunone of the interpolatedEMAX values need to nately, it is not feasible to comparethe approxibe saved in memory.Thus, the curse of dimen- mations to the exact solutions for models where
sionalityis essentiallycircumventedprovidedthe serial correlationis actuallypresent or where the
interpolatingfunction provides accurate predic- state space is many times larger than that we
tions based on a computationallyfeasible number have already considered, because obtaining an
exact solutionof the model is computationallytoo
of simulatedstate points.
In the case of seriallycorrelatedunobservables, burdensome.
it is only necessary to treat them symmetrically Table 7 reports the proportion of correct
with the other state variables.This approachhas choices, paralleling the top panels of tables
the additional advantage that the disturbances 2.1-2.3, and the averagenumberof periods corneed not be discretized.In terms of estimation, rect, as in the bottom panels. The dynamicprosimulated maximum likelihood is substantially gram is solved using 2000 simulation draws for
complicated when there is serial correlation. the EMAX calculationsand 500 state points for
However,the recursivesimulationmethod devel- the interpolatingregression.The results indicate
oped by Keane (1994) applies directly to this that the third specificationis the most consistent,
performingslightlybetter than our preferredincase.
terpolating function in data set three, slightly
2. Results Using Alternative Interpolating Funcworse in data set two, and fairly significantly
tions: In this section, we provideevidence on the
worse in data set one. The third specification
performance of three alternative interpolating
dominates the more parismonioussecond specifunctionsthat are computationallytractableeven
fication in all three data sets. The first specificawhen the state space is sufficientlylarge that it
tion, using the state space elements directly for
becomes infeasible to fill in all of the EMAX
the interpolation,is almost identical to the third
values by interpolation.The first alternativewe
specificationin data three, is somewhatbetter in
consideris to interpolateEMAX from a quadratic
data set two, but is very significantlyworse in
approximationin the deterministic state space
data set one.
elements. Recall that the deterministicpart of
Table 8 reports the performanceof the three
the state space for the dynamicprogramconsists
alternativeinterpolatingfunctions in estimation.
of the number of periods of experience in each
Monte Carlo experimentswere performedusing
occupation,the numberof periods of schooling,
the same design as those in table 4. However,
and a dichotomousindicatorof whetherthe indigiven the computationalburden of this exercise,
vidual attended school in the previous period.
The second alternativeuses a quadraticapproximation in the contemporarypayoffsevaluatedat
25
Note that the deterministicreward in the non-market
the means of their stochastic components; the sectordoes not varywith the state spaceand is not used in the
contemporarypayoffsare given by the determin- interpolatingfunction.

This content downloaded from 130.82.1.40 on Thu, 25 Apr 2013 12:06:33 PM
All use subject to JSTOR Terms and Conditions

THE REVIEW OF ECONOMICS AND STATISTICS

670
TABLE

2000 DRAWS

USING

1
5
10
15
20
25
30
35
40
Total
Average No.

la

0.608
0.493
0.578
0.645
0.702
0.719
0.744
0.758
0.760
0.665
26.6

AT SELECTED

PERIODS

POINTS

STATE

Data Set Three
Interpolating Function

Data Set Two
Interpolating Function

Data Set One
Interpolating Function
Period

500

AND

FUNCTIONS

INTERPOLATING

FOR ALTERNATIVE

CHOICES

CORRECT

7.-PROPORTION

2b

3c

la

2b

3c

la

2b

3c

0.954
0.796
0.753
0.774
0.775
0.773
0.768
0.775
0.768
0.778
31.1

0.983
0.888
0.875
0.891
0.910
0.916
0.909
0.912
0.910
0.904
36.1

0.993
0.934
0.918
0.925
0.936
0.928
0.938
0.943
0.938
0.938
37.2

0.908
0.844
0.820
0.827
0.850
0.859
0.836
0.851
0.847
0.837
33.5

0.933
0.930
0.889
0.891
0.889
0.909
0.907
0.902
0.924
0.901
36.0

0.992
0.950
0.958
0.972
0.971
0.974
0.955
0.958
0.979
0.966
38.7

0.952
0.826
0.843
0.940
0.955
0.963
0.963
0.961
0.974
0.931
37.2

0.977
0.933
0.941
0.970
0.977
0.977
0.965
0.983
0.984
0.968
38.7

Periods
Correct
a

Quadratic in state space.
Quadratic in contemporaneous payoffs evaluated at mean errors.
c Same ash with maximum of future value functions evaluated at mean errors as additional regressor.
h

we use only data set one for the evaluation.
Unlike the results in table 4.1, the quadraticin
state variables approximationshown in table 8
revealsbiases of substantialeconomic magnitude
in severalparameters,in particular,the blue-collar wage function intercept,the cost of returning
TABLE

8.-MONTE

CARLO

ESTIMATION

Quadratics in State Space
Parameter

Bias

alo
all

- 0.028
0.0061
0.0024
-0.00010
-0.0067
0.00022
0.00049
- 0.0022
0.0030
-0.00014
0.0016
- 0.00017
0.66
0.71
3556
-3141
-0.0068
0.0041
0.0046
- 1.61
-1.83
950
-0.73
2.29
1.05
714

a 12
a13
a 14
a 15
a20
a2l

a22
a23
a24

a25

po

p1
P2

Yo
all
a2l

a22
a3l

a32
a33
a4l

a42
a43
a44
a

S.D.a
0.011
0.00085
0.0010
0.000034
0.0027
0.000092
0.0069
0.00053
0.00063
0.000026
0.0016
0.00013
0.703
0.795
1100
2261
0.0056
0.026
0.0053
0.85
0.623
698
2.04
1.27
2.92
1773

to school, the value of home-time, and the concavity of the experience effects. Biases in the
covariance matrix of the disturbancesare also
considerablylargerthan in table 4.1. Approximations based on the second alternativeinterpolating function,quadraticsin the rewardsevaluated

RESULTS:

ALTERNATIVE

APPROXIMATION

Quadratics in Rewards
at Mean Errors
Bias
- 0.00050
0.0014
0.00069
-0.000049
0.0065
- 0.00021
- 0.00099
- 0.00020
0.00085
-0.00013
0.0041
- 0.00024
- 78
- 31
1184
-2425
- 0.0045
0.022
0.0060
- 1.70
0.11
45
-1.5
3.00
65
- 1058

S.D.a

FUNCTIONS

Quadratic in Rewards
Plus MAX(0)
Bias

0.0045
0.0064
0.00024
0.00063
0.00076
0.00039
-0.000045
0.000018
-0.0016
0.0017
0.000064
0.000073
0.0055
0.0050
0.000094
0.00036
0.00078
0.00068
-0.000055
0.000019
-0.00081
0.0011
- 0.000035
0.000078
66
32
35
42
-228
960
- 273
1486
-0.0026
0.0036
0.011
0.019
-0.0016
0.0058
0.267
0.46
-0.073
0.55
-458
454
-0.024
1.01
0.420
0.91
-0.272
1.23
-575
1159

See note d in table 4.1.

This content downloaded from 130.82.1.40 on Thu, 25 Apr 2013 12:06:33 PM
All use subject to JSTOR Terms and Conditions

S.D.a
0.0021
0.00025
0.00028
0.000017
0.0015
0.000070
0.0030
0.00013
0.00026
0.000015
0.00069
0.000053
151
197
370
291
0.0035
0.016
0.0045
0.31
0.26
241
0.21
0.60
0.75
706

DISCRETE CHOICE DYNAMIC PROGRAMMING MODELS

at the mean disturbance,generallyhave smaller
biases as seen in table 8. However,the bias in the
estimated cost of returningto school and in the
value of home-timeremainslarge, as do those of
some of the Cholesky parameters. As table 8
indicates,the third interpolatingfunctioncauses,
on balance, the smallest biases. Although larger
than those in table 4.1, they are usually of the
same order of magnitude.
The evidence indicates that the interpolating
functionbased directlyon the state variablescan
perform poorly. Taking into account how the
state variables enter into the reward functions
seems to matter. Experimentswith alternative
functional forms in these sets of arguments is
needed before strong generalizationsshould be
drawn.
IV. Conclusion

671

lated policy effects very similar in most cases to
those predicted by the true parametervalues in
conjunctionwith the exact solution method.
A drawbackto the interpolatingfunction that
uses the expectedvalue functionsas regressorsis
that it requires that the simulated plus interpolated EMAX values span the entire state space.
As the state space grows,the numberof interpolated values can themselves become intractably
large in terms of computational capacity and
memory.Alternativeinterpolatingfunctions that
do not require spanning the whole state space
were presented and evaluated.We find that approximationsbased on quadratics in the state
space elements perform rather poorly at least
with respect to one of the simulated data sets,
while those based on quadraticsin the expected
rewardsperform reasonablywell. None perform
as well overallas the interpolatingfunctionbased
on the expectedvalue functions.
In conclusion,it is our view that the approximate solutionmethod proposedin this paper is a
promisingway to greatlyincrease the complexity
of the optimizationmodels that are feasible to
solve and estimate. However, much additional
work,with expandedstate spaces and choice sets,
needs to be done to determine the method's
general applicability.

In this paper we have proposed a new method
for approximatelysolvingdiscretechoice dynamic
programmingproblems.The method is based on
simulationand interpolation.It requiresthat one
simulatethe expected maximaof the value functions only at a subset of the state points. Then,
these simulatedexpected maximaare used to fit
an interpolatingregression that provides fitted
values for the expected maxima at the other
points, which are needed in the backwardssolution process. Thus, our approximationmethod
REFERENCES
amelioratesBellman's "curse of dimensionality" Albright, R., S. Lerman, and C. Manski, "Report on the
Development of an Estimation Program for the Multiproblem, obtaining approximate solutions for
nomial Probit Model," report prepared by Cambridge
problems with otherwise intractablylarge state
Systematics for the Federal Highway Administration
spaces.
(1977).
The method we propose requires choosing a Bellman, Richard, Dynamic Programming (Princeton: Princeton University Press, 1957).
particularinterpolatingfunction. For the fairly
Bellman, Richard, Robert Kalaba, and Bella Kotkin, "Polygeneraltype of problemwe consider,we find, in a
nomial Approximation-A New Computational Technique in Dynamic Programming:Allocation Processes,"
numberof Monte Carloexperiments,that a funcMathematics of Computation 1 (1963), 155-161.
tion that includesthe expectedalternative-specific
Berkovec, James, and Steven Stern, "Job Exit Behavior of
value functions performs quite well in several
Older Men," Econometrica 59 (Jan. 1991), 189-210.
dimensions. First, it produces optimal decision Eckstein, Zvi, and Kenneth I. Wolpin, "The Specification and
Estimation of Dynamic Stochastic Discrete Choice
paths very similarto those producedby the true
Models," Journal of Human Resources 24 (Fall 1989a),
solution. Second, estimation based on this ap562-598.
proximationmethod embedded in a simulated
, "Dynamic Labour Force Participation of Married
Women and Endogenous Wage Growth," Review of
ML procedureproducesparameterestimateswith
Economic Studies 56 (July 1989b), 375-390.
biases that seem negligible from a substantive Geweke, John, Robert Slonim, and Gary Zarkin, "Econometric Solution Methods for Dynamic Discrete Choice
economic point of view. Third, the estimates so
Problems," mimeo, University of Minnesota (1992).
obtained, used in conjunctionwith the same apGotz, G. A., and J. J. McCall, "A Dynamic Retention Model
proximatesolution method, do exceedinglywell
for Air Force Officers," Report R-3028-AF, the RAND
at out-of-sampleprediction, and produce simuCorporation, Santa Monica, California (1984).

This content downloaded from 130.82.1.40 on Thu, 25 Apr 2013 12:06:33 PM
All use subject to JSTOR Terms and Conditions

672

THE REVIEW OF ECONOMICS AND STATISTICS

Hotz, Joseph V., and Robert A. Miller, "Conditional Choice
Probabilities and the Estimation of Dynamic Programming Models," Review of Economic Studies 60 (July
1993), 497-530.
Hotz, V. Joseph, Robert A. Miller, Seth Sanders, and Jeffrey
Smith, "A Simulation Estimator for Dynamic Models
of Discrete Choice," Review of Economic Studies 61
(Apr. 1994), 265-290.
Keane, Michael P., "A Computationally Practical Simulation
Estimator for Panel Data," Econometrica 62 (1994),
95-116.
Keane, Michael P., and Kenneth I. Wolpin, "The Solution
and Estimation of Discrete Choice Dynamic Programming Models by Simulation and Interpolation: Monte
Carlo Evidence," Federal Reserve Bank of Minneapolis, no. 181 (1994).
Lumsdaine, R., James Stock and David Wise, "Three Models
of Retirement: Computational Complexity vs. Predictive Validity," in D. Wise (ed.), Topics in the Economics
of Aging (Chicago: University of Chicago, 1992).
Manski, Charles, "Path Utility Analysis of Dynamic Choice,"
SSRI Working Paper No. 8805, University of Wisconsin, Madison (1988).
McFadden, Daniel, "A Method of Simulated Moments for
Estimation of Multinomial Probits without Numerical
Integration," Econometrica 57 (Sept. 1989), 995-1026.
, "Conditional Logit Analysis of Qualitative Choice
Behavior," in P. Zarembka (ed.), Frontiers of Econometrics (New York: Academic Press, 1973).
Miller, Robert, "Job Matching and Occupational Choice,"
Journal of Political Economy 92 (Dec. 1984), 1086-1120.
Pakes, Ariel, "Patents as Options: Some Estimates of the

Value of Holding European Patent Stocks," Econometrica 54 (July 1987), 755-784.
Pakes, Ariel, and David Pollard, "Simulation and the Asymptotics of Optimization Estimates," Econometrica 57
(Sept. 1989), 1027-1058.
Rust, John, "Optimal Replacement of GMC Bus Engines: An
Empirical Model of Harold Zurcher," Econometrica 55
(Sept. 1987), 999-1035.
,"Do People Behave According to Bellman's Principle
of Optimality?" mimeo, Hoover Institution, Stanford
University (1992).
, "Structural Estimation of Markov Decision Processes," in R. Engle and D. McFadden (eds.), Handbook of Econometrics, Vol. 4 (Amsterdam: North Holland, forthcoming).
Stern, Steven, "Approximate Solutions to Stochastic Dynamic
Programming Problems," mimeo, University of Virginia (1991).
Stock, James, and David Wise, "Pensions, the Option Value
of Work and Retirement," Econometrica 58 (Sept.
1990), 1151-1180.
Wolpin, Kenneth I., "An Estimable Dynamic Stochastic Model
of Fertility and Child Mortality," Journal of Political
Economy 92 (Oct. 1984), 852-874.
, "Estimating a Structural Search Model: The Transition from School to Work," Econometrica 55 (July
1987), 852-874.
, "The Determinants of Black-White Differences in
Early Employment Careers: Search, Layoffs, Quits, and
Endogenous Wage Growth," Journal of Political Economy 100 (June 1992), 535-560.

This content downloaded from 130.82.1.40 on Thu, 25 Apr 2013 12:06:33 PM
All use subject to JSTOR Terms and Conditions

