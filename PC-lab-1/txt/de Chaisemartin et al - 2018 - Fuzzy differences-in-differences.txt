Review of Economic Studies (2018) 85, 999–1028
doi:10.1093/restud/rdx049
© The Author 2017. Published by Oxford University Press on behalf of The Review of Economic Studies Limited.
Advance access publication 28 August 2017

Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018

Fuzzy
Differences-in-Differences
C. DE CHAISEMARTIN
University of California at Santa Barbara

and
X. D’HAULTFŒUILLE
Center for Research in Economics and Statistics
First version received June 2014; Editorial decision June 2017; Accepted August 2017 (Eds.)
Difference-in-differences (DID) is a method to evaluate the effect of a treatment. In its basic version,
a “control group” is untreated at two dates, whereas a “treatment group” becomes fully treated at the second
date. However, in many applications of the DID method, the treatment rate only increases more in the
treatment group. In such fuzzy designs, a popular estimator of the treatment effect is the DID of the
outcome divided by the DID of the treatment. We show that this ratio identifies a local average treatment
effect only if the effect of the treatment is stable over time, and if the effect of the treatment is the same
in the treatment and in the control group. We then propose two alternative estimands that do not rely on
any assumption on treatment effects, and that can be used when the treatment rate does not change over
time in the control group. We prove that the corresponding estimators are asymptotically normal. Finally,
we use our results to reassess the returns to schooling in Indonesia.
Key words: Differences-in-differences, Control group, Local average treatment effects, Changes-inchanges, Partial identification, Returns to education.
JEL Codes: C21, C23

1. INTRODUCTION
Difference-in-differences (DID) is a method to estimate the effect of a treatment. In its basic
version, a “control group” is untreated at two dates, whereas a “treatment group” becomes treated
at the second date. If the trend on the mean outcome without treatment is the same in both groups,
the so-called common trend assumption, one can estimate the effect of the treatment by comparing
the evolution of the mean outcome in the two groups.
However, in many applications of the DID method, the share of treated units increases more
in some groups than in others between the two dates, but no group experiences a sharp change
in treatment, and no group remains fully untreated. In such fuzzy designs, a popular estimator of
treatment effects is the DID of the outcome divided by the DID of the treatment, the so-called
Wald-DID estimator. In de Chaisemartin and D’Haultfœuille (2016), we show that 10.1% of all
papers published by the American Economic Review between 2010 and 2012 use fuzzy DID
designs, and estimate either a simple Wald-DID or a weighted average of Wald-DIDs.
To our knowledge, no paper has studied treatment effect identification and estimation in fuzzy
DID designs. This is the purpose of this article. Hereafter, let “switchers” refer to units that become
999

[20:12 16/3/2018 rdx049.tex]

RESTUD: The Review of Economic Studies

Page: 999

999–1028

1000

REVIEW OF ECONOMIC STUDIES

Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018

treated at the second date. Our main parameter of interest is the local average treatment effect
(LATE) of treatment group switchers.
First, we consider the case where the share of treated units does not change over time in
the control group. In this case, we start by showing that the Wald-DID estimand identifies our
parameter of interest if the usual common trend assumption holds, and if the average treatment
effect of units treated at both dates is stable over time. This stable treatment effect assumption
is not required for identification in sharp DID designs. It is often implausible: we review below
some applications where the effect of the treatment is likely to change over time. Then, we
show that two alternative estimands identify our parameter of interest even if the effect of the
treatment changes over time. The first one, the time-corrected Wald ratio (Wald-TC), relies on
common trend assumptions within subgroups of units sharing the same treatment at the first
date. The second one, the changes-in-changes Wald ratio (Wald-CIC), generalizes the changesin-changes (CIC) estimand introduced by Athey and Imbens (2006) to fuzzy designs. It relies
on a “common change” assumption which is invariant to the scaling of the outcome, contrary
to common trends, but which also imposes restrictions on the full distribution of the potential
outcomes while common trends only imposes a restriction on their mean. We discuss below the
respective advantages and drawbacks of the Wald-TC and Wald-CIC estimands.
Second, we consider the case where the share of treated units changes over time in the control
group. In this case, we show that the Wald-DID estimand identifies the LATE of treatment
group switchers if the aforementioned common trend and stable treatment effect assumptions
are satisfied, and if the LATEs of treatment and control group switchers are equal. Here as well,
this homogeneous treatment effect assumption is often implausible. We also show that under
the assumptions underlying the Wald-TC and Wald-CIC estimands, our parameter of interest is
partially identified. The smaller the change of the share of treated units in the control group, the
tighter the bounds.
We extend these results in several directions. We start by showing how our results can be used
in applications with more than two groups. We also show that our results extend to applications
with a non-binary treatment variable. Finally, we consider estimators of the Wald-DID, Wald-TC,
and Wald-CIC, and we derive their limiting distributions.1
We use our results to revisit findings in Duflo (2001) on returns to education in Indonesia.
Years of schooling increased substantially in the control group used by the author. Hence, for
her Wald-DID to identify the switchers’ LATE, returns to schooling should be homogeneous in
her treatment and control groups. As we argue in more detail later, this assumption might not be
applicable in this context. The bounds we propose do not rely on this assumption, but they are
wide and uninformative, here again because schooling increased in the author’s control group.
Therefore, we form a new control group where years of schooling did not change. The Wald-DID
with our new groups is twice as large as the author’s original estimate. But it is still likely to be
biased, as it relies on the assumption that returns to schooling are stable between birth cohorts,
which rules out decreasing returns to experience. The Wald-TC and Wald-CIC do not rely on
such a restriction. They are very close to each other, and lie in-between the author’s estimate and
the Wald-DID.
Overall, our article shows that researchers who use the DID method with fuzzy groups can
obtain estimates not resting on the assumption that treatment effects are stable and homogeneous,
provided they can find a control group whose exposure to the treatment does not change over
time. There are applications where such control groups are readily available (see Field, 2007;
Gentzkow et al., 2011, which we revisit in our Supplementary Data). In other applications, the

1. A Stata package computing the estimators is available on the authors’ webpages.

[20:12 16/3/2018 rdx049.tex]

RESTUD: The Review of Economic Studies

Page: 1000

999–1028

CHAISEMARTIN & D’HAULTFŒUILLE

FUZZY DID

1001

Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018

control groups need to be estimated. We propose a method to estimate the control groups that
can be used when the number of groups is small relative to the size of each group. Studying how
to estimate the control groups when the number of groups is large relative to their size, as is the
case in Duflo (2001), is left for future work.
Though we are the first to study fuzzy DID estimators in models with heterogeneous treatment
effects, our article is related to several other papers in the DID literature. Blundell et al. (2004)
and Abadie (2005) consider a conditional version of the common trend assumption in sharp DID
designs, and adjust for covariates using propensity score methods. Our Wald-DID estimator with
covariates is related to their estimators. Bonhomme and Sauder (2011) consider a linear model
allowing for heterogeneous effects of time, and show that in sharp designs it can be identified if the
idiosyncratic shocks are independent of the treatment and of the individual effects. Our Wald-CIC
estimator builds on Athey and Imbens (2006). In work posterior to ours, D’Haultfœuille et al.
(2015) study the possibly non-linear effects of a continuous treatment, and propose an estimator
related to our Wald-CIC estimator.
The remainder of the article is organized as follows. Section 2 presents our main identification
results in a simple setting with two groups, two periods, and a binary treatment. Section 3 presents
extensions of those main identification results. Section 4 presents estimation and inference. In
Section 5 we revisit results from Duflo (2001). Section 6 concludes. The Appendix gathers the
main proofs. For brevity, further identification and inference results, two additional empirical
applications, and additional proofs are deferred to our Supplementary Data.

2. IDENTIFICATION
2.1.

Framework

We are interested in measuring the effect of a treatment D on some outcome. For now, we assume
that the treatment is binary. Y (1) and Y (0) denote the two potential outcomes of the same unit
with and without treatment. The observed outcome is Y = DY (1)+(1−D)Y (0).
Hereafter, we consider a model best suited for repeated cross sections. This model also
applies to single cross sections where cohort of birth plays the role of time, as in Duflo (2001)
for instance. The extension to panel data is sketched in Subsection 3.4 and developed in our
Supplementary Data. We assume that the data can be divided into “time periods” represented by
a random variable T , and into groups represented by a random variable G. In this section, we
focus on the simplest possible case where there are only two groups, a “treatment” and a “control”
group, and two periods of time. G is a dummy for units in the treatment group and T is a dummy
for the second period.
We now introduce the notation we use throughout the article. For any random variable R, let
S(R) denote its support. Let also Rgt and Rdgt be two other random variables such that Rgt ∼ R|G =
g,T = t and Rdgt ∼ R|D = d,G = g,T = t, where ∼ denotes equality in distribution. For instance, it
follows from those definitions that E(R11 ) = E(R|G = 1,T = 1), while E(R011 ) = E(R|D = 0,G =
1,T = 1). For any event or random variable A, let FR and FR|A denote the cumulative distribution
function (cdf) of R and its cdf conditional on A.2 Finally, for any increasing function F on the
real line, we denote by F −1 its generalized inverse, F −1 (q) = inf {x ∈ IR : F(x) ≥ q}. In particular,
FR−1 is the quantile function of the random variable R.
Contrary to the standard “sharp” DID setting where D = G×T , we consider a “fuzzy” setting
where D  = G×T . Some units may be treated in the control group or at period 0, and some units

2. With a slight abuse of notation, P(A)FR|A should be understood as 0 when A is an event and P(A) = 0.

[20:12 16/3/2018 rdx049.tex]

RESTUD: The Review of Economic Studies

Page: 1001

999–1028

1002

REVIEW OF ECONOMIC STUDIES

may remain untreated in the treatment group at period 1. Still, we consider two assumptions on
the evolution of the share of treated units in the treatment and control groups.
Assumption 1. (Fuzzy design). E(D11 ) > E(D10 ), and E(D11 )−E(D10 ) > E(D01 )−E(D00 ).

Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018

Assumption 2. (Stable percentage of treated units in the control group). 0 < E(D01 ) =
E(D00 ) < 1.
Assumption 1 is just a way to define the treatment and the control group in our fuzzy setting.
The treatment group is the one experiencing the larger increase of its treatment rate. If the
treatment rate decreases in both groups, one can redefine the treatment variable as D̃ = 1−D.
Thus, Assumption 1 only rules out the case where the two groups experience the same evolution
of their treatment rates. Assumption 2 corresponds to the special case where the percentage of
treated units does not change between period 0 and 1 in the control group.
We consider the following treatment participation equation.
Assumption 3. (Treatment participation equation). D = 1{V ≥ vGT }, with V ⊥⊥ T |G.
Assumption 3 imposes a latent index model for the treatment (see, e.g., Vytlacil, 2002), where
V may be interpreted as a unit’s propensity to be treated, and where the threshold for treatment
participation depends both on time and group. This participation equation implies that within
each group, units can switch treatment in only one direction. For instance, once combined with
Assumption 1, Assumption 3 implies that in the treatment group there are no units switching from
treatment to non treatment between period 0 and 1. Assuming that treatment is monotonous with
respect to time is not necessary for our results to hold (see Subsection 3.4 for further detail on
this point). However, this greatly simplifies the exposition.
We now define our parameters of interest. For that purpose, let us introduce
D(t) = 1{V ≥ vGt }.
In repeated cross sections, D(0) and D(1) denote the treatment status of a unit at period 0 and
1, respectively, and only D = D(T ) is observed. In single cross sections where cohort of birth
plays the role of time, D(t) denotes instead the potential treatment of a unit had she been born at
T = t. Here again, only D = D(T ) is observed. Let S = {D(0) < D(1),G = 1}. S stands for treatment
group units going from non-treatment to treatment between period 0 and 1, hereafter referred to
as the “treatment group switchers”. Our parameters of interest are their LATE and Local Quantile
Treatment Effects (LQTE), which are respectively defined by
 = E (Y11 (1)−Y11 (0)|S),
τq = FY−1
(q)−FY−1
(q),
11 (1)|S
11 (0)|S

q ∈ (0,1).

We focus on these parameters for two reasons. First, there are instances where treatment group
switchers are the only units affected by some policy, implying that they are the relevant subgroup
one should consider to assess its effects. Consider for instance a policy whereby in T = 1, the
treatment group becomes eligible to some treatment for which it was not eligible in T = 0 (see,
e.g., Field, 2007). In this example, treatment group switchers are all the units in that group treated
in T = 1. Those units are affected by the policy: without it, they would have remained untreated.
Moreover, nobody else is affected by the policy. Second, identifying treatment effects in the

[20:12 16/3/2018 rdx049.tex]

RESTUD: The Review of Economic Studies

Page: 1002

999–1028

CHAISEMARTIN & D’HAULTFŒUILLE

FUZZY DID

1003

whole population would require additional conditions, on top of those we consider below. In the
example above, the policy extension does not provide any information on treatment effects in the
control group, because this group does not experience any change.

2.2. The Wald-DID estimand
Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018

We first investigate the commonly used strategy of running an IV regression of the outcome
on the treatment with time and group as included instruments, and the interaction of the two as
the excluded instrument. The estimand arising from this regression is the Wald-DID defined by
WDID = DIDY /DIDD , where for any random variable R we let
DIDR = E(R11 )−E(R10 )−(E(R01 )−E(R00 )).
Let also S  = {D(0)  = D(1),G = 0} denote the control group switchers. Control group switchers
are defined by D(0)  = D(1) because the treatment rate may decrease in this group, thus implying
3

that
 switchers may go
 from being treated to being untreated between period 0 and 1. Let  =
E Y01 (1)−Y01 (0)|S  denote their LATE. Finally, let α = (P(D11 = 1)−P(D10 = 1))/DIDD .
We consider the following assumptions, under which we can relate WDID to  and  .
Assumption 4. (Common trends). E(Y (0)|G,T = 1)−E(Y (0)|G,T = 0) does not depend on G.
Assumption 5. (Stable treatment effect over time). For all d ∈ S(D),4 E(Y (d)−Y (0)|G,
T = 1,D(0) = d) = E(Y (d)−Y (0)|G,T = 0,D(0) = d).
Assumption 6. (Homogeneous treatment effect between groups).  =  .
Assumption 4 requires that the mean of Y (0) follow the same evolution over time in the
treatment and control groups. This assumption is not specific to the fuzzy settings we are
considering here: DID in sharp settings also rely on this assumption (see, e.g., Abadie, 2005).
Assumption 5 requires that in both groups, the average effect of going from 0 to d units of
treatment among units with D(0) = d is stable over time. This is equivalent to assuming that
among these units, the mean of Y (d) and Y (0) follow the same evolution over time:
E(Y (d)|G,T = 1,D(0) = d)−E(Y (d)|G,T = 0,D(0) = d)
= E(Y (0)|G,T = 1,D(0) = d)−E(Y (0)|G,T = 0,D(0) = d).

(2.1)

This stable treatment effect condition, which is also equivalent to imposing a common trend
condition for all potential outcomes Y (d), is very different from Assumption 4, the only condition
required for identification in sharp DID settings. Assumption 6 requires that in both groups,
switchers have the same LATE. This assumption is also specific to fuzzy settings: it is not required
for identification in sharp DID settings.

3. On the other hand, Assumptions 1 and 3 ensure that treatment group switchers can only go from being untreated
to being treated, which is why they are defined by D(0) < D(1).
4. When the treatment is binary, Assumption 5 only requires that the equation therein holds for d = 1. Writing
Assumption 5 this way ensures it carries through to the case of a non-binary treatment.

[20:12 16/3/2018 rdx049.tex]

RESTUD: The Review of Economic Studies

Page: 1003

999–1028

1004

REVIEW OF ECONOMIC STUDIES

Theorem 1.
(1) If Assumptions 1 and 3–5 are satisfied, then
WDID = α+(1−α) .
Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018

(2) If Assumption 2 or 6 further holds, then
WDID = .
When the treatment rate increases in the control group, E(D01 )−E(D00 ) > 0, so α > 1. Therefore,
under Assumptions 1 and 3–5 the Wald-DID is equal to a weighted difference of the LATEs of
treatment and control group switchers in period 1. In both groups, the evolution of the mean
outcome between period 0 and 1 is the sum of three things: the change in the mean of Y (0) for
units untreated at T = 0; the change in the mean of Y (1) for units treated at T = 0; the average
effect of the treatment for switchers. Under Assumptions 4 and 5, changes in the mean of Y (0)
and Y (1) in both groups cancel out. The Wald-DID is finally equal to the weighted difference
between the LATEs of treatment and control group switchers. This weighted difference does not
satisfy the no sign-reversal property: it may be negative even if the treatment effect is positive
for everybody in the population. If one is ready to further assume that Assumption 6 is satisfied,
this weighted difference simplifies into .5
When the treatment rate diminishes in the control group, E(D01 )−E(D00 ) < 0, so α < 1.
Therefore, under Assumptions 1 and 3–5 the Wald-DID is equal to a weighted average of the
LATEs of treatment and control group switchers in period 1. This quantity satisfies the no signreversal property, but it still differs from  unless here as well one is ready to further assume that
Assumption 6 is satisfied.
When the treatment rate is stable in the control group, α = 1 so the Wald-DID is equal to 
under Assumptions 1 and 3–5 alone. But even then, the Wald-DID relies on the assumption that in
both groups, the average treatment effect among units treated at T = 0 remains stable over time.
This assumption is necessary. Under Assumptions 1 and 3–4 alone, the Wald-DID is equal to 
plus a bias term involving several LATEs. Unless this combination of LATEs cancels out exactly,
the Wald-DID differs from . We give the formula of the bias term in the end of the proof of
Theorem 1.

2.3. The time-corrected Wald estimand
In this section, we consider a first alternative estimand of . Instead of relying on Assumptions 4
and 5, it is based on the following condition:
Assumption 4.’ (Conditional common trends). For all d ∈ S(D), E(Y (d)|G,T = 1,D(0) = d)−
E(Y (d)|G,T = 0,D(0) = d) does not depend on G.

5. Under this assumption, the Wald-DID actually identifies the LATE of all switchers, not only of those in the
treatment group. There are instances where this LATE measures the effect of the policy under consideration, because
treatment and control group switchers are the only units affected by this policy. Consider for instance the case of a policy
whereby a new treatment is introduced in both groups in T = 1 (see Enikolopov et al., 2011). In this example, treatment
and control group switchers are all the units treated in T = 1. These units are affected by the policy (without it, they would
have remained untreated) and nobody else is affected by it.

[20:12 16/3/2018 rdx049.tex]

RESTUD: The Review of Economic Studies

Page: 1004

999–1028

CHAISEMARTIN & D’HAULTFŒUILLE

FUZZY DID

1005

Assumption 4’ requires that the mean of Y (0) (resp. Y (1)) follows the same evolution over
time among treatment and control group units that were untreated (resp. treated) at T = 0.
Let δd = E(Yd01 )−E(Yd00 ) denote the change in the mean outcome between period 0 and 1
for control group units with treatment status d. Then, let
WTC =

Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018

E(Y11 )−E(Y10 +δD10 )
.
E(D11 )−E(D10 )

WTC stands for “time-corrected Wald”.
Theorem 2. If Assumptions 1–3, and 4’ are satisfied, then WTC = .
Note that
WTC =

E(Y |G = 1,T = 1)−E(Y +(1−D)δ0 +Dδ1 |G = 1,T = 0)
.
E(D|G = 1,T = 1)−E(D|G = 1,T = 0)

This is almost the Wald ratio in the treatment group with time as the instrument, except that we
have Y +(1−D)δ0 +Dδ1 instead of Y in the second term of the numerator. This difference arises
because time is not a standard instrument: it can directly affect the outcome. When the treatment
rate is stable in the control group, we can identify the trends on Y (0) and Y (1) by looking at
how the mean outcome of untreated and treated units changes over time in this group. Under
Assumption 4’, these trends are the same in the two groups. As a result, we can add these changes
to the outcome of untreated and treated units in the treatment group in period 0, to recover the
mean outcome we would have observed in this group in period 1 if switchers had not changed their
treatment between the two periods. This is what (1−D)δ0 +Dδ1 does. Therefore, the numerator
of WTC compares the mean outcome in the treatment group in period 1 to the counterfactual mean
we would have observed if switchers had remained untreated. Once normalized, this yields the
LATE of treatment group switchers.
2.4. The CIC estimands
In this section, we consider a second alternative estimand of  for continuous outcomes, as well
as estimands of the LQTE. They rely on the following condition.
Assumption 7. (Monotonicity and time invariance of unobservables). Y (d) = hd (Ud ,T ), with
Ud ∈ IR and hd (u,t) strictly increasing in u for all (d,t) ∈ S((D,T )). Moreover, Ud ⊥⊥ T |G,D(0).
Assumptions 3 and 7 generalize the CIC model in Athey and Imbens (2006) to fuzzy settings.
Assumptions 3 and 7 imply Ud ⊥⊥ T |G. Therefore, they require that at each period, both potential
outcomes are strictly increasing functions of a scalar unobserved heterogeneity term whose
distribution is stationary over time, as inAthey and Imbens (2006). ButAssumption 7 also imposes
Ud ⊥⊥ T |G,D(0): the distribution of Ud must be stationary within subgroups of units sharing the
same treatment status at T = 0.
We also impose the assumption below, which is testable in the data.
Assumption 8. (Data restrictions).
(1) S(Ydgt ) = S(Y ) for (d,g,t) ∈ S((D,G,T )), and S(Y ) is a closed interval of IR.
(2) FYdgt is continuous on IR and strictly increasing on S(Y ), for (d,g,t) ∈ S((D,G,T )).

[20:12 16/3/2018 rdx049.tex]

RESTUD: The Review of Economic Studies

Page: 1005

999–1028

1006

REVIEW OF ECONOMIC STUDIES

FCIC,d (y) =
WCIC =

Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018

The first condition requires that the outcome have the same support in each of the eight treatment
× group × period cells. Athey and Imbens (2006) make a similar assumption.6 Note that this
condition does not restrict the outcome to have bounded support: for instance, [0,+∞) is a
closed interval of IR. The second condition requires that the distribution of Y be continuous
with positive density in each of the eight groups × periods × treatment status cells. With a
discrete outcome, Athey and Imbens (2006) show that one can bound treatment effects under
their assumptions. Similar results apply in fuzzy settings, but for the sake of brevity we do not
present them here.
Let Qd (y) = FY−1
◦FYd00 (y) be the quantile-quantile transform of Y from period 0 to 1 in
d01
the control group conditional on D = d. This transform maps y at rank q in period 0 into the
corresponding y at rank q in period 1. Let also
P(D11 = d)FYd11 (y)−P(D10 = d)FQd (Yd10 ) (y)
,
P(D11 = d)−P(D10 = d)
E(Y11 )−E(QD10 (Y10 ))
.
E(D11 )−E(D10 )

−1
(q)−
Theorem 3. If Assumptions 1–3, and 7–8 are satisfied, then WCIC =  and FCIC,1
−1
FCIC,0 (q) = τq .

This result combines ideas from Imbens and Rubin (1997) and Athey and Imbens (2006). We
seek to recover the distribution of, say, Y (1) among switchers in the treatment group × period
1 cell. On that purpose, we start from the distribution of Y among all treated observations of
this cell. Those include both switchers and units already treated at T = 0. Consequently, we must
“withdraw” from this distribution that of units treated at T = 0, exactly as in Imbens and Rubin
(1997). But this last distribution is not observed. To reconstruct it, we adapt the ideas in
Athey and Imbens (2006) and apply the quantile-quantile transform from period 0 to 1 among
treated observations in the control group to the distribution of Y among treated units in the
treatment group in period 0.
Intuitively, the quantile-quantile transform uses a double-matching to reconstruct the
unobserved distribution. Consider a treated unit in the treatment group × period 0 cell. She
is first matched to a treated unit in the control group × period 0 cell with same y. Those two units
are observed at the same period of time and are both treated. Therefore, under Assumption 7 they
must have the same u1 . Second, the control × period 0 unit is matched to her rank counterpart
among treated units of the control group × period 1 cell. We denote by y∗ the outcome of this
last observation. Because U1 ⊥⊥ T |G,D(0) = 1, under Assumption 2 those two observations must
also have the same u1 . Consequently, y∗ = h1 (u1 ,1), which means that y∗ is the outcome that the
treatment × period 0 cell unit would have obtained in period 1.
Note that
WCIC =

E(Y |G = 1,T = 1)−E((1−D)Q0 (Y )+DQ1 (Y )|G = 1,T = 0)
.
E(D|G = 1,T = 1)−E(D|G = 1,T = 0)

6. Common support conditions might not be satisfied when outcome distributions differ in the treatment and
control groups, the very situations where the Wald-CIC estimand we propose below might be more appealing than the
Wald-DID or Wald-TC (see Subsection 2.5). Athey and Imbens (2006) show that in such instances, quantile treatment
effects are still point identified over a large set of quantiles, while the average treatment effect can be bounded. Even
though we do not present them here, similar results apply in fuzzy settings.

[20:12 16/3/2018 rdx049.tex]

RESTUD: The Review of Economic Studies

Page: 1006

999–1028

CHAISEMARTIN & D’HAULTFŒUILLE

FUZZY DID

1007

Here again, WCIC is almost the standard Wald ratio in the treatment group with T as the instrument,
except that we have (1−D)Q0 (Y )+DQ1 (Y ) instead of Y in the second term of the numerator.
(1−D)Q0 (Y )+DQ1 (Y ) accounts for the fact that time directly affects the outcome, just as
(1−D)δ0 +Dδ1 does in the WTC estimand. Under Assumption 4’, the trends affecting the outcome
are identified by additive shifts, while under Assumptions 7–8 they are identified by possibly
non-linear quantile-quantile transforms.
Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018

2.5. Discussion
There are many applications where Assumption 5 is implausible, because the effect of the
treatment is likely to change over time. In Section 5 we review a specific example. In such
instances, if the share of treated units is stable over time in the control group, one needs to choose
between the Wald-TC and Wald-CIC estimands. This choice should be based on the suitability of
Assumption 4’ and 7 in the application under consideration. Assumption 4’ is not invariant to the
scaling of the outcome, but it only restricts its mean. Assumption 7 is invariant to the scaling of
the outcome, but it restricts its entire distribution. When the treatment and control groups have
different outcome distributions conditional on D in the first period, the scaling of the outcome
might have a large effect on the Wald-TC. The Wald-CIC is much less sensitive to the scaling of
the outcome, so using this estimand might be preferable. On the other hand, when the two groups
have similar outcome distributions conditional on D in the first period, using the Wald-TC might
be preferable as Assumption 4’ only restricts the mean of the outcome. This choice should also be
based on the parameters one seeks to identify. Under Assumption 7, both the LATE and LQTEs
of treatment group switchers are identified; under Assumption 4’, only the LATE is identified.
In applications where Assumption 5 is plausible, the Wald-DID may be appealing, especially
when the treatment rate decreases in the control group. Indeed, in such instances, the assumptions
underlying the Wald-TC and Wald-CIC only lead to partial identification (see Subsection 3.1).
On the other hand, the Wald-DID identifies a weighted average of LATEs even if Assumption 6
fails to hold.7

3. EXTENSIONS
We now consider several extensions. We first show that when the treatment rate is not stable in the
control group,  and τq can still be partially identified under our assumptions. We then consider
applications with multiple groups. Next, we show that our results extend to ordered, non-binary
treatments. Finally we sketch other extensions that are fully developed in the Supplementary Data.

3.1.

Partial identification with a non-stable control group

We first consider partial identification of  and τq when Assumption 2 does not hold. Let us
introduce some additional notation. When the outcome is bounded, let y and y respectively denote
the lower and upper bounds of its support. For any real number x, let M01 (x) = min(1,max(0,x)).
For any g ∈ S(G), let λgd = P(Dg1 = d)/P(Dg0 = d) be the ratio of the shares of units in group g
receiving treatment d in period 1 and period 0. For instance, λ00 > 1 when the share of untreated

7. In our Supplementary Data, we also explain how to use placebo tests to assess the plausibility of Assumptions 4,
5, 4’, and 7 when more than two periods of data are available.

[20:12 16/3/2018 rdx049.tex]

RESTUD: The Review of Economic Studies

Page: 1007

999–1028

1008

REVIEW OF ECONOMIC STUDIES

observations increases in the control group between period 0 and 1. Let also

Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018



F d01 (y) = M01 1−λ0d (1−FYd01 (y)) −M01 (1−λ0d )1{y < y},


F d01 (y) = M01 λ0d FYd01 (y) +(1−M01 (λ0d ))1{y ≥ y},


δ d = ydF d01 (y)−E(Yd00 ), δ d = ydF d01 (y)−E(Yd00 ).
We define the bounds obtained under Assumption 4’ (TC bounds hereafter) as follows:
W TC =

E(Y11 )−E(Y10 +δ D10 )
E(Y11 )−E(Y10 +δ D10 )
, W TC =
.
E(D11 )−E(D10 )
E(D11 )−E(D10 )

Next, we define the bounds obtained under Assumptions 7–8 (CIC bounds hereafter). For d ∈ {0,1}
and any cdf T , let Hd = FYd10 ◦FY−1
and
d00
Gd (T ) = λ0d FYd01 +(1−λ0d )T ,
P(D11 = d)FYd11 −P(D10 = d)Hd ◦Gd (T )
,
P(D11 = d)−P(D10 = d)


λ0d FYd01 −Hd−1 (λ1d FYd11 )
T d = M01
,
λ0d −1


λ0d FYd01 −Hd−1 (λ1d FYd11 +(1−λ1d ))
.
T d = M01
λ0d −1

Cd (T ) =

In the definition of T d and T d , we use the convention that FR−1 (q) = inf S(R) for q < 0,
 
and FR−1 (q) = sup S(R) for q > 1. Then let F CIC,d (y) = supy ≤y Cd T d (y ) and F CIC,d (y) =
  
inf y ≥y Cd T d (y ). We define the CIC bounds on  and τq by:

W CIC =


ydF CIC,1 (y)−


W CIC =

ydF CIC,0 (y),


ydF CIC,1 (y)−

ydF CIC,0 (y),

−1

τ q = max(F CIC,1 (q),y)−min(F −1
CIC,0 (q),y),
−1

τ q = min(F −1
CIC,1 (q),y)−max(F CIC,0 (q),y).
Finally, we introduce the two following conditions, which ensure that the CIC bounds are
well-defined and sharp.
Assumption
9. (Existence

|y|dF CIC,d (y) < +∞.

of

moments).

For

d ∈ {0,1},



|y|dF CIC,d (y) < +∞

and

Assumption 10. (Increasing bounds). For (d,g,t) ∈ S((D,G,T )), FYdgt is continuously differentiable, with positive derivative on the interior of S(Y ). Moreover, T d ,T d ,Gd (T d ),Gd (T d ),Cd (T d )
and Cd (T d ) are increasing on S(Y ).

[20:12 16/3/2018 rdx049.tex]

RESTUD: The Review of Economic Studies

Page: 1008

999–1028

CHAISEMARTIN & D’HAULTFŒUILLE

FUZZY DID

1009

Theorem 4. Assume that Assumptions 1 and 3 are satisfied and 0 < P(D01 = 1)  = P(D00 = 1) < 1.
Then:

Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018

(1) If Assumption 4’ holds and P(y ≤ Y (d) ≤ y) = 1 for d ∈ {0,1}, W TC ≤  ≤ W TC .8
(2) If Assumptions 7-9 hold, FY11 (d)|S (y) ∈ [F CIC,d (y),F CIC,d (y)] for d ∈ {0,1},  ∈
[W CIC ,W CIC ] and τq ∈ [τ q ,τ q ]. These bounds are sharp if Assumption 10 holds.
The reasoning underlying the TC bounds goes as follows. Assume for instance that the treatment
rate increases in the control group. Then, the difference between E(Y101 ) and E(Y100 ) arises both
from the trend on Y (1), and from the fact the former expectation is for units treated at T = 0 and
switchers, while the latter is only for units treated at T = 0. Therefore, we can no longer identify
the trend on Y (1) among units treated at T = 0. But when the outcome has bounded support, this
trend can be bounded, because we know the percentage of the control group switchers account
for. A similar reasoning can be used to bound the trend on Y (0) among units untreated at T = 0.
Eventually,  can also be bounded. The smaller the change of the treatment rate in the control
group, the tighter the bounds.
The reasoning underlying the CIC bounds goes as follows. When 0 < P(D00 = 1)  = P(D01 =
1) < 1, the second matching described in Subsection 2.4 collapses, because treated (resp.
untreated) observations in the control group are no longer comparable in period 0 and 1
as explained in the previous paragraph. Therefore, we cannot match period 0 and period 1
observations on their rank anymore. However, we know the percentage of the control group
switchers account for, so we can match period 0 observations to their best- and worst-case rank
counterparts in period 1.
If the support of the outcome is unbounded, F CIC,0 and F CIC,0 are proper cdfs when λ00 > 1,
but they are defective when λ00 < 1. On the contrary, F CIC,1 and F CIC,1 are always proper cdfs.
As a result, when S(Y ) is unbounded and λ00 > 1, the CIC bounds we derive for  and τq are
finite under Assumption 9. The TC bounds, on the other hand, are always infinite when S(Y ) is
unbounded.
3.2. Multiple groups
We now consider the case where there are more than two groups but only two time periods in the
data. The case with multiple groups and time periods is considered in the Supplementary Data. Let
G ∈ {0,1,...,g} denote the group a unit belongs to. For any g ∈ S(G), let Sg = {D(0)  = D(1),G = g}
g
denote units of group g who switch treatment between T = 0 and 1. Let S ∗ = ∪g=0 Sg be the union
of all switchers. We can partition the groups depending on whether their treatment rate is stable,
increases, or decreases. Specifically, let
Gs = {g ∈ S(G) : E(Dg1 ) = E(Dg0 )}
Gi = {g ∈ S(G) : E(Dg1 ) > E(Dg0 )}
Gd = {g ∈ S(G) : E(Dg1 ) < E(Dg0 )},
and let G∗ = 1{G ∈ Gi }−1{G ∈ Gd }.
Theorem 5 below shows that when there is at least one group in which the treatment rate is
stable, our assumptions allow us to point identify ∗ = E(Y (1)−Y (0)|S ∗ ,T = 1), the LATE of all
8. It is not difficult to show that these bounds are sharp. We omit the proof for brevity.

[20:12 16/3/2018 rdx049.tex]

RESTUD: The Review of Economic Studies

Page: 1009

999–1028

1010

REVIEW OF ECONOMIC STUDIES

switchers. Before presenting this result, additional notation is needed. For any random variable
R, g  = g ∈ {−1,0,1}2 , and d ∈ {0,1}, let
DID∗R (g,g ) = E(R|G∗ = g,T = 1)−E(R|G∗ = g,T = 0)
− (E(R|G∗ = g ,T = 1)−E(R|G∗ = g ,T = 0)),
Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018

δd∗ = E(Y |D = d,G∗ = 0,T = 1)−E(Y |D = d,G∗ = 0,T = 0),
∗
Qd∗ (y) = FY−1
|D=d,G∗ =0,T =1 ◦FY |D=d,G =0,T =0 (y),

∗
(g,g ) =
WDID

DID∗Y (g,g )
,
DID∗D (g,g )

∗
(g) =
WTC

∗ |G∗ = g,T = 0)
E(Y |G∗ = g,T = 1)−E(Y +δD
,
E(D|G∗ = g,T = 1)−E(D|G∗ = g,T = 0)

∗
(g) =
WCIC

∗ (Y )|G∗ = g,T = 0)
E(Y |G∗ = g,T = 1)−E(QD
.
E(D|G∗ = g,T = 1)−E(D|G∗ = g,T = 0)

We also define the following weight:
w10 =

DID∗D (1,0)P(G∗ = 1)
.
∗
DIDD (1,0)P(G∗ = 1)+DID∗D (0,−1)P(G∗ = −1)

∗ = w W ∗ (1,0)+(1−w )W ∗ (−1,0), W ∗ =
We finally define our estimands as WDID
10 DID
10
DID
TC
∗
∗
∗
∗ (1)+(1−w )W ∗ (−1).
w10 WTC (1)+(1−w10 )WTC (−1) and WCIC = w10 WCIC
10
CIC

Theorem 5. Assume that Assumption 3 is satisfied, that Gs  = ∅, and that G ⊥⊥ T .
∗ = ∗ .
(1) If Assumptions 4 and 5 are satisfied, WDID
∗ = ∗ .
(2) If Assumption 4’ is satisfied, WTC
∗ = ∗ .
(3) If Assumptions 7 and 8 are satisfied, WCIC

This theorem states that with multiple groups and two periods of time, treatment effects for
switchers are identified if there is at least one group in which the treatment rate is stable over
time. The estimands we propose can then be computed in four steps. First, we form three
“supergroups”, by pooling together the groups where treatment increases (G∗ = 1), those where it
is stable (G∗ = 0), and those where it decreases (G∗ = −1). While in some applications these three
sets of groups are known to the analyst (see, e.g., Gentzkow et al., 2011), in other applications
they must be estimated (see our application in Section 5). Second, we compute the Wald-DID,
Wald-TC, or Wald-CIC estimand with G∗ = 1 and G∗ = 0 as the treatment and control groups.
Third, we compute the Wald-DID, Wald-TC, or Wald-CIC estimand with G∗ = −1 and G∗ = 0 as
the treatment and control groups. Finally, we compute a weighted average of those two estimands.
Theorem 5 relies on the assumption that G ⊥⊥ T . This requires that the distribution of groups
be stable over time. This will automatically be satisfied if the data are a balanced panel and G
is time invariant. With repeated cross sections or cohort data, this assumption might fail to hold.
However, when G is not independent of T , it is still possible to form Wald-DID and Wald-TC
type of estimands identifying ∗ . We give the formulas of these estimands in Subsection 1.2 in
the Supplementary Data.
Two last comments on Theorem 5 are in order. First, groups where the treatment rate diminishes
can be used as “treatment” groups, just as those where it increases. Indeed, it is easy to show that

[20:12 16/3/2018 rdx049.tex]

RESTUD: The Review of Economic Studies

Page: 1010

999–1028

CHAISEMARTIN & D’HAULTFŒUILLE

FUZZY DID

1011

all the results from the previous section still hold if the treatment rate decreases in the treatment
group and is stable in the control group. Second, when there are more than two groups where
the treatment rate is stable, our three sets of assumptions become testable. Under each set of
assumptions, using any subset of Gs as the control group should yield the same estimand for ∗ .

Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018

3.3. Non-binary, ordered treatment
We now consider the case where treatment takes a finite number of ordered values, D ∈ {0,1,...,d}.
To accommodate this extension, Assumption 3 has to be modified as follows.
Assumption 3.’ (Ordered treatment equation). D =

d

1 ... < vd+1 = +∞ and V ⊥⊥ T |G. As before, let D(t) =
vGT
GT

d
d=1 1{V ≥ vGT },
d
d=1 1{V ≥ vGt }.

d

0 <
with −∞ = vGT

Let  denote stochastic dominance between two random variables, and let ∼ denote equality
in distribution. Let also wd = [P(D11 ≥ d)−P(D10 ≥ d)]/[E(D11 )−E(D10 )].
Theorem 6. Suppose that Assumptions 1 and 3’ hold, that D01 ∼ D00 , and that D11  D10 .
(1) If Assumptions 4–5 are satisfied,
d

WDID =

wd E(Y11 (d)−Y11 (d −1)|D(0) < d ≤ D(1)).
d=1

(2) If Assumption 4’ is satisfied,
d

WTC =

wd E(Y11 (d)−Y11 (d −1)|D(0) < d ≤ D(1)).
d=1

(3) If Assumptions 7 and 8 are satisfied,
d

WCIC =

wd E(Y11 (d)−Y11 (d −1)|D(0) < d ≤ D(1)).
d=1

Theorem 6 shows that with an ordered treatment, the estimands we considered in the
previous sections are equal to the average causal response (ACR) parameter considered in
Angrist and Imbens (1995). This parameter is a weighted average, over all values of d, of the
effect of increasing treatment from d −1 to d among switchers whose treatment status goes from
strictly below to above d over time.
For this theorem to hold, two conditions have to be satisfied. First, in the treatment group, the
distribution of treatment in period 1 should dominate stochastically the corresponding distribution
in period 0.Angrist and Imbens (1995) impose a similar stochastic dominance condition.Actually,
this assumption is not necessary for our three estimands to identify a weighted sum of treatment

[20:12 16/3/2018 rdx049.tex]

RESTUD: The Review of Economic Studies

Page: 1011

999–1028

1012

REVIEW OF ECONOMIC STUDIES

effects. If it is not satisfied, one still has that WDID , WTC , or WCIC identify
d

wd E (Y11 (d)−Y11 (d −1)|D(0) < d ≤ D(1)∪D(1) < d ≤ D(0)),
d=1

Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018

which is a weighted sum of treatment effects with some negative weights.
Second, the distribution of treatment should be stable over time in the control group. When
it is not, one can still obtain some identification results. First, Theorem 1 generalizes to nonbinary and ordered treatments. When treatment increases in the control group, the Wald-DID
identifies a weighted difference of the ACRs in the treatment and in the control group; when
treatment decreases in the control group, the Wald-DID identifies a weighted average of these
two ACRs. The weights are the same as those in Theorem 1. Secondly, our partial identification
results also generalize to non-binary and ordered treatments. When the distribution of treatment
is not stable over time in the control group, the ACR in the treatment group can be bounded under
Assumption 4’, or Assumptions 7–8, as shown in Subsection 3.2 of the Supplementary Data.
Finally, Theorem 6 extends to a continuous treatment. In such instances, one can show that
under an appropriate generalization of Assumption 3, the Wald-DID, Wald-TC, and Wald-CIC
identify a weighted average of the derivative of potential outcomes with respect to treatment, a
parameter that resembles that studied in Angrist et al. (2000).
3.4. Other extensions
In the Supplementary Data, we present additional extensions that we discuss briefly here.
3.4.1. Multiple groups and multiple periods. With multiple groups and periods, we
show that one can gather groups into “supergroups” for each pair of consecutive dates, depending
on whether their treatment increases, is stable, or decreases. Then, a properly weighted sum of
the estimands for each pair of dates identifies a weighted average of the LATEs of units switching
at any point in time.
3.4.2. Particular fuzzy designs. Up to now, we have considered both general fuzzy
designs where the P(Dgt = d)s are restricted only by Assumption 1, and the special case where
Assumption 2 is satisfied. In our Supplementary Data, we consider two other interesting special
cases. First, we show that when P(D00 = 1) = P(D01 = 1) = P(D10 = 1) = 0, identification of the
average treatment effect on the treated can be obtained under the same assumptions as those of the
standard DID or CIC model. Second, we consider the case where P(D00 = 0) = P(D01 = 0) ∈ {0,1}.
Such situations arise when a policy is extended to a previously ineligible group, or when a program
or a technology previously available in some geographic areas is extended to others (see, e.g.,
Field, 2007). One can show that Theorem 1 still holds in this special case. On the other hand,
Theorems 2–3 do not hold. In such instances, we obtain identification by supposing that Y (0) and
Y (1) change similarly over time.
3.4.3. Including covariates. We also propose Wald-DID, Wald-TC, and Wald-CIC
estimands with covariates. Including covariates in the analysis has two advantages. First, our
estimands with covariates rely on conditional versions of our assumptions, which might be
more plausible than their unconditional counterparts. Second, there might be instances where
P(D00 = d)  = P(D01 = d) but P(D00 = d|X) = P(D01 = d|X) > 0 almost surely for some covariates

[20:12 16/3/2018 rdx049.tex]

RESTUD: The Review of Economic Studies

Page: 1012

999–1028

CHAISEMARTIN & D’HAULTFŒUILLE

FUZZY DID

1013

X, meaning that in the control group, the change in the treatment rate is driven by a change in
the distribution of X. If that is the case, one can use our results with covariates to point identify
treatment effects among switchers, while one would only obtain bounds without covariates.

Dit = 1{Vit ≥ vGi t },

Vi1 |Gi ∼ Vi0 |Gi

Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018

3.4.4. Panel data. Finally, we discuss the plausibility of our assumptions when panel
data are available. First, Assumption 3 is well suited for repeated cross sections or cohort data,
but less so for panel data. Then, it implies that within each group units can switch treatment in
only one direction, because V does not depend on time. Actually, this assumption is not necessary
for our results to hold. For instance, Theorem 1 still holds if Assumptions 3 and 5 are replaced
by
(3.2)

and
E(Yi1 (1)−Yi1 (0)|Gi ,Vi1 ≥ vGi 0 ) = E(Yi0 (1)−Yi0 (0)|Gi ,Vi0 ≥ vGi 0 ),
where we index random variables by i to distinguish individual effects from constant terms.
The result applies to treatment and control group switchers, respectively defined as Si = {Vi1 ∈
[v11 ,v10 ),Gi = 1} and Si = {Vi1 ∈ [min(v01 ,v00 ),max(v01 ,v00 )),Gi = 0}. Theorems 2 and 3 also
still hold if Assumption 3 is replaced by Equation (3.2), under modifications of Assumptions 4’
and 7 that we present in our Supplementary Data.
Secondly, we discuss the validity of our estimands under Equation (3.2) and the following
model:
Yit = (αi +γt +[βi +λt ]Dit +εit ),
with
(αi ,βi )|Gi ,Vi1 ≥ vGi 0 ∼ (αi ,βi )|Gi ,Vi0 ≥ vGi 0 ,
(αi ,βi )|Gi ,Vi1 < vGi 0 ∼ (αi ,βi )|Gi ,Vi0 < vGi 0 ,
and (.) strictly increasing. We prove that  is identified by the Wald-DID, Wald-TC, or Wald-CIC
estimand under alternative restrictions on (.), λt , and the distribution of εit .

4. ESTIMATION AND INFERENCE
In this section, we study the asymptotic properties of the estimators corresponding to the
estimands introduced in Section 2, assuming we have an i.i.d. sample with the same distribution
as (Y ,D,G,T ).
Assumption 11. (Independent and identically distributed observations). (Yi ,Di ,Gi ,Ti)i=1,...,n
are i.i.d.
Let Igt = {i : Gi = g,Ti = t} (resp. Idgt = {i : Di = d,Gi = g,Ti = t}) and ngt (resp. ndgt ) denote the
size of Igt (resp. Idgt ) for all (d,g,t) ∈ {0,1}3 . For d ∈ {0,1}, let
δd =

[20:12 16/3/2018 rdx049.tex]

1
nd01

Yi −
i∈Id01

1
nd00

Yi .
i∈Id00

RESTUD: The Review of Economic Studies

Page: 1013

999–1028

1014

REVIEW OF ECONOMIC STUDIES

Let
WDID =

1 
1 
i∈I11 Yi − n10
i∈I10 Yi + δDi
n11

1
1 
i∈I11 Di − n10
i∈I10 Di
n11

Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018

WTC =

1 
1 
1 
1 
i∈I11 Yi − n10
i∈I10 Yi − n01
i∈I01 Yi + n00
i∈I00 Yi
n11
,
1 
1 
1 
1 
i∈I11 Di − n10
i∈I10 Di − n01
i∈I01 Di + n00
i∈I00 Di
n11

denote our Wald-DID and Wald-TC estimators.

Let FYdgt denote the empirical cdf of Y on the subsample Idgt , FYdgt (y) = i∈Idgt 1{Yi ≤
y}/ndgt . Let FY−1
(q) = inf {y : FYdgt (y) ≥ q} denote the empirical quantile of order q ∈ (0,1) of
dgt

◦ FYd00 denote the estimator of the quantile-quantile transform. Let
Ydgt . Let Qd = FY−1
d01

WCIC =

1 
1 
i∈I11 Yi − n10
i∈I10 QDi (Yi )
n11
1 
1 
i∈I11 Di − n10
i∈I10 Di
n11

denote the Wald-CIC estimator. Let P(Dgt = d) denote the proportion of units with D = d in the
, and let
sample Igt , let Hd = FYd10 ◦ FY−1
d00
FY11 (d)|S =

P(D10 = d)Hd ◦ FYd01 − P(D11 = d)FYd11
.
P(D10 = d)− P(D11 = d)

Finally, let
τq = FY−1
(q)− FY−1
(q)
11 (1)|S
11 (0)|S
denote the estimator of the LQTE of order q for switchers.
We derive the asymptotic behaviour of our CIC estimators under the following assumption,
which is similar to the one made by Athey and Imbens (2006) for the CIC estimators in sharp
settings.
Assumption 12. (Regularity conditions for the CIC estimators). S(Y ) is a bounded interval
[y,y]. Moreover, for all (d,g,t) ∈ {0,1}3 , FYdgt and FY11 (d)|S are continuously differentiable with
strictly positive derivatives on [y,y].
Theorem 7 shows that all our estimators are root-n consistent and asymptotically normal.
We also derive the influence functions of our estimators. However, because these influence
functions take complicated expressions, using the bootstrap might be convenient for inference.
For any statistic T , we let T b denote its bootstrap counterpart. For any root-n consistent statistic
θ estimating consistently θ√
, we say that the bootstrap is consistent if with probability one and
conditional
on
the
sample,
n(θ b − θ ) converges to the same distribution as the limit distribution
√
of n(θ −θ ) (see, e.g., van der Vaart, 2000, Section 23.2.1, for a formal definition of conditional
convergence). Theorem 7 implies that bootstrap confidence intervals are asymptotically valid for
all our estimators.

[20:12 16/3/2018 rdx049.tex]

RESTUD: The Review of Economic Studies

Page: 1014

999–1028

CHAISEMARTIN & D’HAULTFŒUILLE

FUZZY DID

1015

Theorem 7. Suppose that Assumptions 1–3 and 11 hold. Then
 
(1) If E Y 2 < ∞ and Assumptions 4–5 also hold,
 L
√ 
n WDID − −→ N (0,V (ψDID )),
Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018

where ψDID is defined in Equation (A29) in the Appendix. Moreover, the bootstrap is
consistent
  for WDID .
(2) If E Y 2 < ∞ and Assumption 4’ also holds,
 L
√ 
n WTC − −→ N (0,V (ψTC )),
where ψTC is defined in Equation (A30) in the Appendix. Moreover, the bootstrap is
consistent for WTC .
(3) If Assumptions 7, 8 and 12 also hold,
 L
√ 
n WCIC − −→ N (0,V (ψCIC )),


 L

√ 
n τq −τq −→ N 0,V ψq,CIC ,
where ψCIC and ψq,CIC are defined in Equations (A31) and (A32) in the Appendix.
Moreover, the bootstrap is consistent for both estimators.
The result is straightforward for WDID and WTC . Regarding WCIC and τq , our proof differs from
the one of Athey and Imbens (2006). It is based on the weak convergence of the empirical cdfs
of the different subgroups, and on a repeated use of the functional delta method. This approach
can be readily applied to other functionals of (FY11 (0)|S ,FY11 (1)|S ).
In our Supplementary Data, we extend the asymptotic theory presented here in several
directions. First, in applications with multiple groups, one sometimes needs to estimate the
supergroups Gs ,Gi , and Gd introduced in Subsection 3.2. We propose an estimation procedure,
and show that when the number of groups is fixed, as is the case in the framework we considered
in Subsection 3.2, this first-step estimation of the supergroups does not have any impact on the
asymptotic variances of our estimators. Secondly, we show that we can allow for clustering.
Even with repeated cross section or cohort data, independence is a strong assumption in DID
analysis: clustering at the group level can induce both cross-sectional and serial correlation within
clusters (see, e.g., Bertrand et al., 2004). Thirdly, we consider estimators of the bounds presented
in Subsection 3.1 and we derive their limiting distributions. Finally, we consider estimators
incorporating covariates and we also derive their limiting distributions.
5. APPLICATION: RETURNS TO SCHOOLING IN INDONESIA
5.1.

Results with the same control and treatment groups as in Duflo (2001)

Duflo (2001) uses the 1995 intercensal survey of Indonesia to measures returns to education among
men. In 1973–74, the Indonesian government launched a major primary school construction
program, the so-called INPRES program. In the author’s analysis, year of birth plays the role of
time, as it determines exposure to the program. The author defines men born between 1957 and
1962 as her cohort 0, as they had finished primary school by the time the program was launched.
She defines men born between 1968 and 1972 as her cohort 1, as they entered primary school after

[20:12 16/3/2018 rdx049.tex]

RESTUD: The Review of Economic Studies

Page: 1015

999–1028

1016

REVIEW OF ECONOMIC STUDIES
TABLE 1
Returns to education using the groups in Duflo (2001)
95% CI

0.195
0.073
[−3.70, 2.18]
[−5.60, 3.36]

[−0.102, 0.491]
[−0.011, 0.157]
[−5.29, 3.00]
[−8.00, 4.63]

Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018

Wald-DID
2SLS with fixed effects
TC bounds
CIC bounds

Estimate

Notes: Sample size 30,828 observations. Confidence intervals account for clustering at
the district level.

the program was launched. The author constructs two “supergroups” of districts, by regressing the
number of primary schools constructed on the number of school-age children in each district. She
defines treatment districts as those with a positive residual in that regression. She starts by using
a simple Wald-DID with her two groups of districts and cohorts to estimate returns to education.
She also estimates a 2SLS regression of wages on cohort dummies, district dummies, and years
of schooling, using the interaction of cohort 1 and schools constructed in one’s district of birth
as the instrument for years of schooling.
As an alternative, we apply our results to the author’s data. Because years of schooling changed
between cohorts 0 and 1 in her control group, we estimate bounds for returns to schooling. These
bounds are similar to those presented in Subsection 3.1, but account for the fact that schooling
is not binary (see Subsection 3.2 of the Supplementary Data for more details). We estimate TC
bounds relying on Assumptions 1, 3, and 4’, and CIC bounds relying on Assumptions 1, 3, and
7–8. Because the support of wages does not have natural boundaries, we use the lowest and
highest wage in the sample.
Results are shown in Table 1.9 The Wald-DID is large. However, it is not significantly different
from 0, which is the reason why the author turns to a 2SLS regression with cohort and district
dummies. The estimate of returns to schooling in that regression is equal to 7.3% and is more
precisely estimated.10
To identify switchers’ LATE, the Wald-DID and 2SLS estimands rely on the assumption that
returns to education are homogeneous between districts. The INPRES program explains a small
fraction of the differences in increases in schooling between districts. A district-level regression
of the increase in years of schooling between cohort 0 and 1 on primary schools constructed has
an R2 of 0.03 only. Accordingly, years of schooling increased almost as much in the author’s
control group than in her treatment group: while the average of years of schooling increased by
0.47 between cohort 0 and 1 in her treatment group, it increased by 0.36 in her control group (see
Table 3 in Duflo, 2001). Therefore, one can show that under Assumptions 1 and 3–5, the author’s
Wald-DID is equal to 0.47/0.11×ACR−0.36/0.11×ACR , where ACR and ACR respectively
denote the ACR parameters we introduced in Section 3.3 in her treatment and control groups. If
ACR  = ACR , this Wald-DID could lie far from both ACR and ACR .
However, returns to schooling might differ across districts. In cohort 0, years of schooling
were substantially higher in control than in treatment districts (see Table 3 in Duflo, 2001).
This difference in years of schooling might for instance indicate a higher level of economic

9. Our Wald-DID and 2SLS estimates differ slightly from those of in Duflo (2001) because we were not able to
obtain exactly her sample of 31,061 observations.
10. This point estimate was significant at the 5% level in the original paper (see the 3rd line and 1st column of
Table 7 in Duflo, 2001). But once clustering standard errors at the district level, which has become standard practice in
DID analysis since Bertrand et al. (2004), it loses some statistical significance.

[20:12 16/3/2018 rdx049.tex]

RESTUD: The Review of Economic Studies

Page: 1016

999–1028

CHAISEMARTIN & D’HAULTFŒUILLE

FUZZY DID

1017

Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018

development in control districts, in which case demand for skilled labour and returns to education
could be higher there.
Our TC and CIC bounds do not rely on this assumption. But because years of schooling
changed substantially in the authors’ control group, they turn out not to be informative. One
could argue that this is due to outliers or measurement error, because we use the minimum and
maximum wages in the sample as estimates of the boundaries of the support of wages. Using
instead the first and third quartile of wages still yields very uninformative bounds: our TC and
CIC bounds are respectively equal to [−0.79, 0.36] and [−0.97, 0.35].
Overall, using the treatment and control groups of districts defined in Duflo (2001) either
yields point estimates relying on a questionable assumption, or wide and uninformative bounds.

5.2. Results with new control and treatment groups
In this subsection, we propose a method to point estimate returns to schooling without assuming
that returns are homogeneous between districts or over time. On that purpose, we form three
supergroups of districts depending on whether their average years of schooling increased,
remained stable, or decreased between cohorts 0 and 1. Though this approach is inspired from
the results of Subsection 3.2, a difficulty here is that the supergroups are not known and need to
be estimated. Indeed, years of schooling vary at the individual level, and therefore there is no
group where years of schooling are perfectly stable between cohort 0 and 1. In Subsection 2.1
in our Supplementary Data, we propose a method to estimate the supergroups, and we show that
when the number of groups is fixed, this first-step estimation does not have any impact on the
asymptotic variances of our estimators. We expect this asymptotic framework to provide a good
approximation of the finite sample behaviour of our estimators when the size of each group is
large compared to the total number of groups. However, in Duflo (2001) there are 284 groups with
109 units on average, so this asymptotic framework is not appropriate. Studying how the first-step
estimation of the supergroups should be accounted for in an asymptotic framework where the
number of groups goes to infinity is beyond the scope of this article. Therefore, what follows is
tentative.11
The procedure we use to estimate the supergroups should classify as controls only districts
with a stable distribution of education. Any classification method leads us to make two types of
errors: classify some districts where the distribution of education remained constant as treatments
(type 1 error); and classify some districts where this distribution changed as controls (type 2 error).
Type 1 errors are innocuous. For instance, if Assumptions 4 and 5 are satisfied, all control districts
have the same evolution of their expected outcome. Misclassifying some as treatment districts
leaves our estimators unchanged, up to sampling error. On the other hand, type 2 errors are a
more serious concern. They lead us to include districts where the true distribution of education
was not stable in our super control group, thus violating one of the requirements of Theorem 5.
We therefore choose a method based on chi-squared tests with very liberal level. Specifically, we
assign a district to our control group if the p-value of a chi-squared test comparing the distribution
of education between the two cohorts in that district is greater than 0.5.
We end up with estimated control (G∗ = 0) and treatment groups (G∗ = 1 and G∗ = −1)
respectively made up of 64, 123, and 97 districts. Table 2 shows that in treatment districts where
schooling increased, cohort 1 completed one more year of schooling than cohort 0. In treatment

11. There are many other applications of the fuzzy DID method where the set of groups where treatment is stable
is known and does not need to be estimated. Examples include Field (2007) or Gentzkow et al. (2011), which we revisit
in our Supplementary Data.

[20:12 16/3/2018 rdx049.tex]

RESTUD: The Review of Economic Studies

Page: 1017

999–1028

1018

REVIEW OF ECONOMIC STUDIES
TABLE 2
Years of schooling completed in the new groups of districts
Cohort 0
Districts where schooling increased
Control districts
Districts where schooling decreased

8.65
9.60
10.17

Cohort 1
9.64
9.55
9.43

Evolution
0.99
−0.05
−0.74

(s.e.)
(0.082)
(0.097)
(0.080)

Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018

Notes: Sample size 30,828 observations. Standard errors are clustered at the district level.

TABLE 3
Returns to education using our new groups

Returns to education

WDID

WTC

WCIC

0.140
(0.015)

0.101
(0.017)

0.099
(0.017)

Notes: Sample size 30,828 observations. Standard errors are clustered at the
district level.

districts where schooling decreased, cohort 1 completed nine months less of schooling than cohort
0. Finally, in control districts, the number of years of schooling did not change.
We now follow results from Theorem 5 to estimate returns to education in Indonesia, treating
our estimated treatment and control groups as if they were the true treatment and control groups.
In Table 3, we report the Wald-DID, Wald-TC, and Wald-CIC estimates we obtain.12 The WaldDID is large, and suggests returns of 14% per year of schooling. Our Wald-TC and Wald-CIC
estimators are substantially smaller, around 10% per year of schooling. They significantly differ
from the Wald-DID, with t-stats respectively equal to −4.27 and −4.61.
In this application, Assumption 5 is implausible, because it is incompatible with decreasing
returns to experience, while an extensive literature has shown that returns to experience tend to
be decreasing (see Mincer and Jovanovic, 1979, and Willis, 1986, for a survey). The data used
in this application are a single cross-section, the 1995 intercensal survey of Indonesia, where
cohort of birth plays the role of time. Then, Equation (2.1) shows that Assumption 5 implies,
for instance, that the wage gap between high-school graduates in cohort 0 and 1 should remain
the same if they had only completed primary school. Had they only completed primary school,
high-school graduates would have joined the labour market earlier, and would have had more
labor market experience in 1995, the year when their wages are measured. If returns to experience
are decreasing, the wage gap between the two cohorts would then have been lower.13 Therefore,
using the Wald-TC or Wald-CIC seems preferable to using the Wald-DID estimator, as those two
estimators do not rule out decreasing returns to experience.
We also conduct placebo tests, which are presented in Subsection 3.3.2 in the
Supplementary Data. Overall, they lend slightly stronger support to our Wald-TC and WaldCIC estimators, though we lack power to make definitive conclusions. In Subsection 3.3.2 of
12. Our Wald-DID estimate is actually a weighted average of the Wald-DID estimate comparing G∗ = 1 and G∗ = 0
and of the Wald-DID estimate comparing G∗ = −1 and G∗ = 0. The same holds for the Wald-TC and Wald-CIC estimates.
The formulas of the corresponding estimands are given in Theorem 5. Also, to estimate the numerators of the Wald-CICs,
we group schooling into five categories (did not complete primary school, completed primary school, completed middle
school, completed high school, completed college). Thus, we avoid estimating the Qd s on small numbers of units. To
be consistent, we also use this definition to estimate the numerators of the Wald-TCs. Using years of schooling hardly
changes our Wald-TC estimate.
13. In Subsection 3.3.1 of our Supplementary Data , we prove this point formally.

[20:12 16/3/2018 rdx049.tex]

RESTUD: The Review of Economic Studies

Page: 1018

999–1028

CHAISEMARTIN & D’HAULTFŒUILLE

FUZZY DID

1019

the Supplementary Data, we show that decreasing returns to experience can explain why our
placebo DID tests may have low power. Finally, in Subsection 3.4 of the Supplementary Data, we
explore the effect of the first-stage estimation of the supergroups on our final estimators. While
the corresponding theoretical analysis goes beyond the scope of this article, our robustness checks
suggest that our estimates of returns to schooling are not sensitive to this first-step estimation.
Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018

6. CONCLUSION
In many applications of the DID method, the treatment increases more in the treatment group, but
some units are also treated in the control group, and some units remain untreated in the treatment
group. In such fuzzy designs, a popular estimand of treatment effects is the DID of the outcome
divided by the DID of the treatment, the so-called Wald-DID estimand. We start by showing
that the Wald-DID identifies the LATE of treatment group switchers only if two restrictions on
treatment effects are satisfied, in addition to the usual common trend assumption. The average
treatment effect of units treated at both dates must not change over time. Moreover, when the share
of treated units varies in the control group, the LATEs of treatment and control group switchers
must be equal. Second, we propose two new estimands that can be used when the share of treated
units in the control group is stable, and that do not rely on any assumption on treatment effects.
We use our results to revisit Duflo (2001).
Overall, our article shows that researchers who use the DID method with fuzzy groups can
obtain estimates not resting on the assumption that treatment effects are stable and homogeneous,
provided they can find a control group whose exposure to the treatment does not change over
time. When a policy is extended to a previously ineligible subgroup or when the treatment is
assigned at the group level, such control groups are usually readily available. Examples include
Field (2007) or Gentzkow et al. (2011), which we revisit in our Supplementary Data. When the
treatment is assigned at the individual level and no policy rule warrants that treatment remains
stable in some groups, such control groups usually still exist but they need to be estimated. We
propose a method to estimate the control groups that can be used when the number of groups is
small relative to the size of each group. Studying how to estimate the control groups when the
number of groups is large relative to their size, as is the case in Duflo (2001), is left for future
work. Finally, when researchers cannot find a control group whose exposure to the treatment is
stable over time, our results show that their conclusions will rest on the assumption that treatment
effects are stable and homogeneous. These assumptions should then be discussed.
APPENDIX
A. MAIN PROOFS
The lemmas prefixed by S are stated and proven in our Supplementary Data (see de Chaisemartin and D’Haultfœuille,
2017). To simplify the notation, throughout the proofs we adopt the following normalization, which is without loss
of generality: v10 = v00 . For any (d,g,t) ∈ S((D,G,T )), we also let pgt = P(G = g,T = t), pdgt = P(D = d,G = g,T = t),
◦

pd|gt = P(Dgt = d), and Fdgt = FYdgt . Finally, for any ⊂ IR k , let denote its interior and let C 0 ( ) and C 1 ( ) denote
respectively the set of continuous functions and the set of continuously differentiable functions with strictly positive
derivative on . We often use this notation with = S(Y ), in which case we respectively denote these sets by C 0 and C 1 .

Proof of Theorem 1
Proof of 1 when p1|01 ≥ p1|00

It follows from Assumptions 1 and 3 that

p1|11 −p1|10 = P(V ≥ v11 |G = 1,T = 1)−P(V ≥ v00 |G = 1,T = 0)
= P(S|G = 1).

[20:12 16/3/2018 rdx049.tex]

RESTUD: The Review of Economic Studies

(A3)

Page: 1019

999–1028

1020

REVIEW OF ECONOMIC STUDIES

Moreover,
E(Y11 )−E(Y10 )
= E (Y11 (1)[1{V11 ∈ [v11 ,v00 )}+1{V11 ≥ v00 }])+E(Y11 (0)1{V11 < v11 })
− E(Y10 (1)1{V10 ≥ v00 })−E(Y10 (0)1{V10 < v00 })

Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018

= E(Y11 (1)−Y11 (0)|S)P(S|G = 1)+E(Y11 (0))−E(Y10 (0))
+ E ((Y11 (1)−Y11 (0))1{V11 ≥ v00 })−E ((Y10 (1)−Y10 (0))1{V10 ≥ v00 })
= P(S|G = 1)+E(Y11 (0))−E(Y10 (0)).

(A4)

The first equality follows from Assumptions 1 and 3, the second follows from Assumption 3, and the third follows from
Assumptions 3 and 5.
Similarly, one can show that
p1|01 −p1|00 = P(S  |G = 0)
E(Y01 )−E(Y00 ) =  P(S  |G = 0)+E(Y01 (0))−E(Y00 (0)).

(A5)
(A6)

Taking the difference between Equations (A4) and (A6), and using Assumption 4, we obtain
DIDY = P(S|G = 1)− P(S  |G = 0).
Dividing each side by DIDD and using Equations (A3) and (A5) yields the result.

Proof of 1 when p1|01 < p1|00

In this case, reasoning similarly as in the derivation of Equation (A3) yields
p1|00 −p1|01 = P(S  |G = 0).

(A7)

Moreover,
E(Y01 )−E(Y00 )
= E (Y01 (1)[1{V01 ≥ v00 }−1{V01 ∈ [v00 ,v01 )}])+E (Y01 (0)×
[1{V01 ∈ [v00 ,v01 )}+1{V01 < v00 }])−E (Y00 (1)1{V00 ≥ v00 })−E (Y00 (0)1{V00 < v00 })
= − P(S  |G = 1)+E(Y01 (0)−Y00 (0))
+ E ((Y01 (1)−Y01 (0)1{V01 ≥ v00 })−E ((Y00 (1)−Y00 (0)1{V00 ≥ v00 })
= − P(S  |G = 1)+E(Y01 (0)−Y00 (0)).

(A8)

The first equality follows from Assumption 3 and p1|01 < p1|00 , the second follows from Assumption 3, and the third
follows from Assumptions 3 and 5. Taking the difference between Equations (A4) and (A8), and using Assumption 4, we
obtain
DIDY = P(S|G = 1)+ P(S  |G = 0).
Dividing each side of the previous display by DIDD and using Equations (A3) and (A7) yields the result.

Proof of 2 The result follows directly from the first point of the theorem.

Bias term without Assumption 5
holds but Assumption 5 does not,

Using the Equations above (A4) and (A8), we obtain that when Assumption 2

WDID = +


1 
(11 −10 )p1|10 −(01 −00 )p1|00 ,
DIDD



where gt = E Ygt (1)−Ygt (0)|D(0) = 1 .

[20:12 16/3/2018 rdx049.tex]

RESTUD: The Review of Economic Studies

Page: 1020

999–1028

CHAISEMARTIN & D’HAULTFŒUILLE

FUZZY DID

1021

Proof of Theorem 2
Following the same steps as those used to derive Equation (A4), we obtain
E(Y11 )−E(Y10 )
= E(Y11 (1)−Y11 (0)|S)P(S|G = 1)+E (Y11 (1)−Y10 (1)|G = 1,V ≥ v00 )P(V ≥ v00 |G = 1)
+ E (Y11 (0)−Y10 (0)|G = 1,V < v00 )P(V < v00 |G = 1).

(A9)

Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018

Then,
δ1 = E(Y01 (1)|G = 0,V ≥ v01 )−E(Y00 (1)|G = 0,V ≥ v00 )
= E(Y01 (1)−Y00 (1)|G = 0,V ≥ v00 ).

(A10)

The first equality follows from Assumption 3. The second one follows from the fact that p1|01 = p1|00 combined with
Assumption 3 implies that {G = 0,V ≤ v01 } = {G = 0,V ≤ v00 }.
Similarly,
δ0 = E(Y01 (0)−Y00 (0)|G = 0,V < v00 ).
(A11)
Finally, the result follows combining Equations (A9), (A10), (A11), and Assumption 4’, once noted that p1|10 = P(V ≥
v00 |G = 1) and P(S|G = 1) = p1|11 −p1|10 2

Proof of Theorem 3
We first prove the following result, which holds irrespective of whether Assumption 2 holds:


pd|11 Fd11 −pd|10 Hd ◦ λ0d Fd01 +(1−λ0d )FY01 (d)|S
,
FY11 (d)|S =
pd|11 −pd|10

(A12)

where λgd = pd|g1 /pd|g0 . We establish (A12) for d = 0 only, the reasoning is similar for d = 1.
First,
P(S|G = 1,T = 1,V < v00 ) =
=

P(S|G = 1)
P(V < v00 |G = 1,T = 0)
p0|10 −p0|11
.
p0|10

The first equality stems from Assumption 3, the second from Equation (A3) and Assumption 3. Moreover,
FY11 (0)|V <v00 = P(S|G = 1,T = 1,V < v00 )FY11 (0)|S
+ (1−P(S|G = 1,T = 1,V < v00 ))FY11 (0)|V <v11
=

p0|10 −p0|11
p0|11
FY11 (0)|S +
F011 .
p0|10
p0|10

Therefore,

p0|11 F011 −p0|10 FY11 (0)|V <v00
.
p0|11 −p0|10

(A13)

−1
FY11 (0)|V <v00 = F010 ◦F000
◦FY01 (0)|V <v00 .

(A14)

FY11 (0)|S =
Then, we show that for all y ∈ S(Y11 (0)|V < v00 ),

For all

(g,t) ∈ {0,1}2 ,
FYgt (0)|V <v00 (y) = P(h0 (U0 ,t) ≤ y|G = g,T = t,V < v00 )
= P(U0 ≤ h0−1 (y,t)|G = g,V < v00 )
= FU0 |G=g,V <v00 (h0−1 (y,t)),

where the first and second equalities follow from Assumption 7. Assumptions 7 and 8 imply that FU0 |G=g,V <v00 is strictly
increasing. Hence, its inverse exists and for all q ∈ (0,1),

(q) = h0 FU−10 |G=g,V <v00 (q),t .
FY−1
gt (0)|V <v00

[20:12 16/3/2018 rdx049.tex]

RESTUD: The Review of Economic Studies

Page: 1021

999–1028

1022

REVIEW OF ECONOMIC STUDIES

This implies that for all y ∈ S(Yg1 (0)|V < v00 ),
FY−1
◦FYg1 (0)|V <v00 (y) = h0 (h0−1 (y,1),0).
g0 (0)|V <v00

(A15)

By Assumption 8, we have
S(Y010 ) = S(Y000 )
⇒ S(Y10 (0)|V < v00 ) = S(Y00 (0)|V < v00 )

Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018

⇒ S(h0 (U0 ,0)|V < v00 ,G = 1,T = 0) = S(h0 (U0 ,0)|V < v00 ,G = 0,T = 0)
⇒ S(U0 |V < v00 ,G = 1) = S(U0 |V < v00 ,G = 0)
⇒ S(h0 (U0 ,1)|V < v00 ,G = 1,T = 1) = S(h0 (U0 ,1)|V < v00 ,G = 0,T = 1)
⇒ S(Y11 (0)|V < v00 ) = S(Y01 (0)|V < v00 ),
where the third and fourth implications follow from Assumption 7. Once combined with Equation (A15), the previous
display implies that for all y ∈ S(Y11 (0)|V < v00 ),
◦FY11 (0)|V <v00 (y) = FY−1
◦FY01 (0)|V <v00 (y).
FY−1
10 (0)|V <v00
00 (0)|V <v00

This proves Equation (A14), because {V < v00 ,G = g,T = 0} = {D = 0,G = g,T = 0}.
Finally, we show that
FY01 (0)|V <v00 = λ00 F001 +(1−λ00 )FY01 (0)|S .
(A16)
Suppose first that λ00 ≤ 1. Then, v01 ≤ v00 and S  = {V ∈ [v01 ,v00 ),G = 0}. Moreover, reasoning as for P(S|G = 1,V < v00 ),
we get
P(V < v01 |G = 0)
λ00 =
= P(V < v01 |G = 0,V < v00 ),
P(V < v00 |G = 0)
FY01 (0)|V <v00 = λ00 F001 +(1−λ00 )FY01 (0)|S .

If λ00 > 1, v01 > v00 and S  = {V ∈ [v00 ,v01 ),G = 0}. We then have

1/λ00 = P(V < v00 |G = 0,V < v01 ),
F001 = 1/λ00 FY01 (0)|V <v00 +(1−1/λ00 )FY01 (0)|S ,
so Equation (A16) is also satisfied. (A12) follows by combining (A13), (A14), and (A16).
Now, under Assumption 2, λ00 = λ01 = 1. This and the fact that Hd ◦Fd01 = FQd (Yd10 ) shows that FY11 (d)|S = FCIC,d .
−1
−1
This proves that τq = FCIC,1
(q)−FCIC,0
(q). Moreover,


p1|11 ydFY111 (y)−p1|10 ydFQ1 (Y101 ) (y)
WCIC =
p1|11 −p1|10


p0|11 ydFY011 (y)−p0|10 ydFQ0 (Y001 ) (y)
−
p0|11 −p0|10


= ydFCIC,1 (y)− ydFCIC,0 (y)
= E(Y11 (1)−Y11 (0)|S).

Proof of Theorem 4
Proof of 1. We only prove that W TC is a lower bound when λ00 > 1. The proofs for the upper bound and when
λ00 < 1 are symmetric.
We have
E(Y11 (1)−Y11 (0)|S)P(S|G = 1)
= E(Y11 )−E(Y10 )−E(Y11 (1)−Y10 (1)|V ≥ v00 )P(V ≥ v00 |G = 1)
− E(Y11 (0)−Y10 (0)|V < v00 )P(V < v00 |G = 1)
= E(Y11 )−E(Y10 )−E(Y01 (1)−Y00 (1)|V ≥ v00 )p1|10
− E(Y01 (0)−Y00 (0)|V < v00 )p0|10
= E(Y11 )−E(Y10 )−(E(Y01 (1)|V ≥ v00 )−E(Y100 ))p1|10
− (E(Y01 (0)|V < v00 )−E(Y000 ))p0|10 .

[20:12 16/3/2018 rdx049.tex]

RESTUD: The Review of Economic Studies

Page: 1022

999–1028

CHAISEMARTIN & D’HAULTFŒUILLE

FUZZY DID

1023

The first equality follows from Equation (A9), the second fromAssumptions 3 and 4’. Thus, the proof will be complete if we
can show that δ 1 and δ 0 are respectively upper bounds for E(Y01 (1)|V ≥ v00 )−E(Y100 ) and E(Y01 (0)|V < v00 )−E(Y000 ).
When λ00 > 1, Assumption 3 implies that v00 < v01 . Then, reasoning as in the proof of Theorem 3, we obtain P(V ≥
v01 |G = 0,T = 1,V ≥ v00 ) = λ01 and

Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018

E(Y01 (1)|V ≥ v00 ) = λ01 E(Y01 (1)|V ≥ v01 )+(1−λ01 )E(Y01 (1)|S  )

≤ λ01 E(Y101 )+(1−λ01 )y = ydF 101 (y).
This proves that δ 1 is an upper bound for E(Y01 (1)|V ≥ v00 )−E(Y100 ).
Similarly, P(V < v00 |G = 0,T = 1,V < v01 ) = 1/λ00 and
FY001 = 1/λ00 FY01 (0)|V <v00 +(1−1/λ00 )FY01 (0)|S .
Following Horowitz and Manski (1995), the last display implies that

E(Y01 (0)|V < v00 ) ≤ ydF 001 (y).
This proves that δ 0 is an upper bound for E(Y01 (0)|V < v00 )−E(Y000 ).
Proof of 2. Construction of the bounds.
We only establish the validity of the bounds for FY11 (0)|S (y). The reasoning is similar for FY11 (1)|S (y). Bounds for 
and τq directly follow from those for the cdfs. Hereafter, to simplify the notation, we let T0 = FY01 (0)|S . Following the
notation introduced in Subsection 3.1 combined with Equations (A12) and (A16), we then have G0 (T0 ) = FY01 (0)|V <v00
and C0 (T0 ) = FY11 (0)|S .
We start by considering the case where λ00 < 1. We first show that in such instances, 0 ≤ T0 ,G0 (T0 ),C0 (T0 ) ≤ 1 if and
only if
(A17)
T0 ≤ T0 ≤ T0 .
G0 (T0 ) is included between 0 and 1 if and only if
−λ00 F001
1−λ00 F001
≤ T0 ≤
,
1−λ00
1−λ00
while C0 (T0 ) is included between 0 and 1 if and only if
H0−1 (λ10 F011 )−λ00 F001
H −1 (λ10 F011 +(1−λ10 ))−λ00 F001
≤ T0 ≤ 0
.
1−λ00
1−λ00
Since −λ00 F001 /(1−λ00 ) ≤ 0 and (1−λ00 F001 )/(1−λ00 ) ≥ 1, T0 , G0 (T0 ) and C0 (T0 ) are all included between 0 and 1 if
and only if




H0−1 (λ10 F011 )−λ00 F001
H0−1 (λ10 F011 +(1−λ10 ))−λ00 F001
≤ T0 ≤ m1
,
(A18)
M0
1−λ00
1−λ00
where M0 (x) = max(0,x) and m1 (x) = min(1,x). Composing each term of these inequalities by M0 (.) and then by m1 (.)
yields Equation (A17), since M0 (T0 ) = m1 (T0 ) = T0 and M0 ◦m1 = m1 ◦M0 .
Now, when λ00 < 1, G0 (T0 ) is increasing in T0 , so C0 (T0 ) as well is increasing in T0 . Combining this with (A17)
implies that for every y ,
C0 (T0 )(y ) ≤ C0 (T0 )(y ) ≤ C0 (T0 )(y ).
(A19)
Because C0 (T0 )(y) is a cdf,
C0 (T0 )(y) = inf C0 (T0 )(y ) ≤ inf C0 (T0 )(y ) = F CIC,0 (y).
y ≥y

y ≥y

This proves the result for the upper bound. The result for the lower bound follows similarly.
Let us now turn to the case where λ00 > 1. Using the same reasoning as above, we get that G0 (T0 ) and C0 (T0 ) are
included between 0 and 1 if and only if
λ00 F001 −1
λ00 F001
≤ T0 ≤
,
λ00 −1
λ00 −1
λ00 F001 −H0−1 (λ10 F011 +(1−λ10 ))
λ00 F001 −H0−1 (λ10 F011 )
.
≤ T0 ≤
λ00 −1
λ00 −1

[20:12 16/3/2018 rdx049.tex]

RESTUD: The Review of Economic Studies

Page: 1023

999–1028

1024

REVIEW OF ECONOMIC STUDIES

The inequalities in the first line are not binding since they are implied by those on the second line. Thus, we also get
(A18). Hence, 0 ≤ T0 ,G0 (T0 ),C0 (T0 ) ≤ 1 if and only if
T0 ≤ T0 ≤ T0 .

(A20)

Besides, when λ00 > 1, G0 (T0 ) is decreasing in T0 , so C0 (T0 ) is also decreasing in T0 . Combining this with Equation
(A20) implies that for every y, Equation (A19) holds as well. This proves the result.

Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018

Sketch of the proof of sharpness.
The full proof is in the Supplementary Data (see de Chaisemartin and D’Haultfœuille, 2017). We only consider the
sharpness of F CIC,0 , the reasoning being similar for the upper bound. The proof is also similar and actually simpler for
d = 1. The corresponding bounds are proper cdfs, so we do not have to consider converging sequences of cdfs as we do
in case b) below.
0 , 
a. λ00 > 1. We show that if Assumptions 8–10 hold, then F CIC,0 is sharp. For that purpose, we construct 
h0 , U
V
such that:
0 ,T ) when D = 0 and D = 1{
(i) Y =
h0 (U
V ≥ vGT };
0 , 
(ii)(U
V ) ⊥⊥ T |G;
(iii)
h0 (.,t) is strictly increasing for t ∈ {0,1};
(iv)Fh0 (U
0 ,1)|G=0,T =1,
V ∈[v00 ,v01 ) = T 0 .
0 ,T ) when D = 1 without contradicting the data, (i)–(iii) ensures that
Because we can always define 
Y (0) as 
h0 ( U
0 and 
0 , 
V . (iv) ensures that the DGP corresponding to (
h0 , U
V)
Assumptions 3 and 7 (for d = 0) are satisfied with 
h0 , U
rationalizes the bound.
0 , and 
The construction of 
h0 , U
V is long, so its presentation is deferred to the Supplementary Data.
b. λ00 < 1. The idea is similar as in the previous case. A difference, however, is that when λ00 < 1, T 0 is not a proper
T0 = T 0 , However, by
cdf, but a defective one, since limy→y T 0 (y) < 1. As a result, we cannot define a DGP such that 
Lemma S2, there exists a sequence (T k0 )k∈IN of cdfs such that T k0 → T 0 , G0 (T k0 ) is an increasing bijection from S(Y ) to
k
k , 
h0k (.,0),
h0k (.,1), U
(0,1) and C0 (T k0 ) is increasing and onto (0,1). We can then construct a sequence of DGP (
0 V ) such
that Points (i) to (iii) listed above hold for every k, and such that 
T0k = T k0 . Since T k0 (y) converges to T 0 (y) for every y
◦

◦

T0k can be arbitrarily close to T 0 on S(Y ) for sufficiently large k.
in S(Y ), we thus define a sequence of DGP such that 
◦

Since C0 (.) is continuous, this proves that F CIC,0 is sharp on S(Y ). Again, this construction is long and its exposition is
deferred to the Supplementary Data.

Proof of Theorem 5
We prove the first statement, the second and third following from similar arguments. Under the assumptions of the
theorem, Assumptions 1–5 are satisfied for the treatment and control groups G∗ = 1 and G∗ = 0. Therefore, it follows
from Theorem 1 that
∗
WDID
(1,0) = E(Y (1)−Y (0)|S ∗ ,G∗ = 1,T = 1).
(A21)
Similarly, one can show that

∗
WDID
(−1,0) = E(Y (1)−Y (0)|S ∗ ,G∗ = −1,T = 1).

(A22)

Moreover, by Assumption 3 and G ⊥⊥ T ,
DID∗D (1,0)P(G∗ = 1) = E(D|G∗ = 1,T = 1)−E(D|G∗ = 1,T = 0) P(G∗ = 1|T = 1)
= P(S ∗ ,G∗ = 1|T = 1).
Similarly, DID∗D (0,−1)P(G∗ = −1) = P(S ∗ ,G∗ = −1|T = 1). Combining both equalities, we obtain
w10 =

P(S ∗ ,G∗ = 1|T = 1)
= P(G∗ = 1|S ∗ ,T = 1).
P(S ∗ ,G∗ = 1|T = 1)+P(S ∗ ,G∗ = −1|T = 1)

(A23)

The result follows combining Equations (A21)–(A23).

Proof of Theorem 6
We only prove the first statement, the second and third statements follow from similar arguments.

[20:12 16/3/2018 rdx049.tex]

RESTUD: The Review of Economic Studies

Page: 1024

999–1028

CHAISEMARTIN & D’HAULTFŒUILLE

FUZZY DID

1025

D01 ∼ D00 and D11  D10 combined with Assumption 3’ imply that for all d ∈ {1,...,d},
d
d
v01
= v00
,

(A24)

d
v10
.

(A25)

≤

d
v11

Then, it follows from Assumption 3’ and Equation (A25) that for every d ∈ {1,...,d},

Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018

d
d
P(D11 ≥ d)−P(D10 ≥ d) = P(V ≥ v11
|T = 1,G = 1)−P(V ≥ v10
|T = 0,G = 1)
d
d
= P(V ∈ [v11
,v10
)|G = 1)

= P(D(0) < d ≤ D(1)|G = 1).

(A26)

Then, for every g ∈ {0,1},
E(Yg1 )−E(Yg0 )
d
d+1
d+1
d
d
E(Yg1 (d)|G = g,V ∈ [vg1
,vg1
))P(V ∈ [vg1
,vg1
)|G = g)

=
d=0
d

d+1
d+1
d
d
E(Yg0 (d)|G = g,V ∈ [vg0
,vg0
))P(V ∈ [vg0
,vg0
)|G = g)

−
d=0
d

=

d
d
d
d
E(Yg1 (d)−Yg1 (d −1)|G = g,V ∈ [vg1
,vg0
))P(V ∈ [vg1
,vg0
)|G = g)
d=1
d
d+1
d+1
d
d
E(Yg1 (d)−Yg0 (d)|G = g,V ∈ [vg0
,vg0
))P(V ∈ [vg0
,vg0
)|G = g)

+
d=0
d

=

E(Yg1 (d)−Yg1 (d −1)|D(0) < d ≤ D(1))P(D(0) < d ≤ D(1)|G = g)
d=1

+ E(Yg1 (0))−E(Yg0 (0)).

(A27)

The first, second and third equalities respectively follow from Assumption 3’, Equations (A24) and (A25) combined with
Assumption 3’, and Assumptions 3’ and 5.
Combining Equation (A27) with Equation (A24) and Assumption 4 imply that
DIDY =

d

d=1 E(Y11 (d)−Y11 (d −1)|D(0) < d ≤ D(1))P(D(0) < d ≤ D(1)|G = 1).

The result follows from Equation (A26), after dividing each side of the previous display by DIDD .

Proof of Theorem 7
Proof of 1 and 2 Asymptotic normality is obvious by the central limit theorem and the delta method. Consistency
of the bootstrap follows by consistency of the bootstrap for sample means (see, e.g., van der Vaart, 2000, Theorem 23.4)
and the delta method for bootstrap (van der Vaart, 2000, Theorem 23.5). A convenient way to obtain the asymptotic
variance is to use repeatedly the following argument. If

√ 
1
n A−A = √
n
then Lemma S3 ensures that

n

ai +oP (1),
i=1



√ A A
1
n
=√
−
n
B B


√ 
1
n B−B = √
n

n
i=1

n

bi +oP (1),
i=1

ai −(A/B)bi
+oP (1).
B

(A28)

This implies for instance that

√ 
1
n E(Y11 )−E(Y11 ) = √
n

[20:12 16/3/2018 rdx049.tex]

n
i=1

Gi Ti (Yi −E(Y11 ))
+oP (1),
p11

RESTUD: The Review of Economic Studies

Page: 1025

999–1028

1026

REVIEW OF ECONOMIC STUDIES

and similarly for E(D11 ). Applying repeatedly this argument, we obtain, after some algebra,

√ 
1
n WDID − = √
n

n

ψDID,i +oP (1),
i=1

and ε = Y −D. Similarly,


√ 
1
n WTC − = √
n

Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018

where, omitting the index i, ψDID is defined by

1
GT (ε −E(ε11 )) G(1−T )(ε −E(ε10 )) (1−G)T (ε −E(ε01 ))
ψDID =
−
−
DIDD
p11
p10
p01

(1−G)(1−T )(ε −E(ε00 ))
+
p00

(A29)

n

ψTC,i +oP (1),
i=1

where ψTC is defined by
ψTC =


GT (ε −E(ε11 )) G(1−T )(ε +(δ1 −δ0 )D−E(ε10 +(δ1 −δ0 )D10 ))
1
−
E(D11 )−E(D10 )
p11
p10


T (Y −E(Y101 )) (1−T )(Y −E(Y100 ))
−E(D10 )D(1−G)
−
p101
p100


T (Y −E(Y001 )) (1−T )(Y −E(Y000 ))
−(1−E(D10 ))(1−D)(1−G)
.
−
p001
p000

(A30)

Proof of 3. We first show that (FY11 (0)|S , FY11 (1)|S ) tends to a continuous gaussian process.
Let 
θ = (F000 ,F001 ,...,F111 ,λ10 ,λ11 ). By Lemma S4, 
θ = (F000 , F001 ,..., F111 , λ10 , λ11 ) converges to a continuous
gaussian process. Let
πd : (F000 ,F001 ,...,F111 ,λ10 ,λ11 )  → (Fd10 ,Fd00 ,Fd01 ,Fd11 ,1,λ1d ), d ∈ {0,1},


so that (FY11 (0)|S , FY11 (1)|S ) = R1 ◦π0 (
θ ),R1 ◦π1 (
θ ) , where R1 is defined as in Lemma S5. πd is Hadamard
differentiable as a linear continuous map. Because Fd10 ,Fd00 ,Fd01 ,Fd11 are continuously differentiable with
strictly positive derivative by Assumption 12, λ1d > 0, and λ1d  = 1 under Assumption 8, R1 is also Hadamard
differentiable at (Fd10 ,Fd00 ,Fd01 ,Fd11 ,1,λ1d ) tangentially to (C 0 )4 ×IR 2 . By the functional delta method (see, e.g.,
van der Vaart and Wellner, 1996, Lemma 3.9.4), (FY11 (0)|S , FY11 (1)|S ) tends to a continuous gaussian process.
Now, by integration by parts for Lebesgue-Stieljes integrals,
 y
FY11 (0)|S (y)−FY11 (1)|S (y)dy.
=


y

Moreover, the map ϕ1 : (F1 ,F2 )  → S(Y ) (F2 (y)−F1 (y))dy, defined on the domain of bounded càdlàg functions, is linear.
Because S(Y ) is bounded by Assumption
12, ϕ1 is also

 continuous with respect to the supremum norm. It is thus Hadamard
differentiable. Because  = ϕ1 FY11 (1)|S , FY11 (0)|S ,  is asymptotically normal by the functional delta method. The
asymptotic normality of τq follows along similar lines. By Assumption 12, FY11 (d)|S is differentiable with strictly positive
derivative on its support. Thus, the map (F1 ,F2 )  → F2−1 (q)−F1−1 (q) is Hadamard differentiable at (FY11 (0)|S ,FY11 (1)|S )
tangentially to the set of functions that are continuous at (FY−1
(q),FY−1
(q)) (see Lemma 21.3 in van der Vaart,
11 (0)|S
11 (1)|S
2000). By the functional delta method, τq is asymptotically normal.
The validity of the bootstrap follows along the same lines. By Lemma S4, the bootstrap is consistent for 
θ . Because
both the LATE and LQTE are Hadamard differentiable functions of 
θ , as shown above, the result simply follows by the
functional delta method for the bootstrap (see, e.g., van der Vaart, 2000, Theorem 23.9).
Finally, we compute the asymptotic variance of both estimators. The functional delta method also implies that both
estimators are asymptotically linear. To compute their asymptotic variance, it suffices to provide their asymptotic linear
approximation. For that purpose, let us first linearize FY11 (d)|S (y), for all y. It follows from the proof of the first point of
Lemma S5 that the mapping φ1 : (F1 ,F2 ,F3 )  → F1 ◦F2−1 ◦F3 is Hadamard differentiable at (Fd10 ,Fd00 ,Fd01 ), tangentially
to (C 0 )3 . Moreover applying the chain rule, we obtain


dφ1 (h1 ,h2 ,h3 ) = h1 ◦Qd−1 +Hd ◦Fd01 × −h2 ◦Qd−1 +h3 .
Applied to (F1 ,F2 ,F3 ) = (Fd10 ,Fd00 ,Fd01 ), this and the functional delta method once more imply that

√ 
n Hd ◦ Fd01 −Hd ◦Fd01 = dφ1 (h1n ,h2n ,h3n )+oP (1),

[20:12 16/3/2018 rdx049.tex]

RESTUD: The Review of Economic Studies

Page: 1026

999–1028

CHAISEMARTIN & D’HAULTFŒUILLE

FUZZY DID

1027

√
where the oP (1) is uniform over y and h1n = n(Fd10 −Fd10 ). h2n and h3n are defined similarly. Furthermore, applying
Lemma S3 yields, uniformly over y,
1
h1n (y) = √
n

n
i=1

1{Di = d}Gi (1−Ti )(1{Yi ≤ y}−Fd10 (y))
+oP (1).
pd10

1
= √
n



n

1{Di = d}
i=1

Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018

A similar expression holds for h2n and h3n . Hence, by continuity of dφ1 , we obtain, after some algebra,

√ 
n Hd ◦ Fd01 (y)−Hd ◦Fd01 (y)
Gi (1−Ti )(1{Qd (Yi ) ≤ y}−Hd ◦Fd01 (y))
+(1−Gi )Hd ◦Fd01 (y)
pd10



(1−Ti )(1{Qd (Yi ) ≤ y}−Fd01 (y)) Ti (1{Yi ≤ y}−Fd01 (y))
+
+oP (1),
× −
pd00
pd01

which holds uniformly over y. Applying repeatedly Lemma S3, we then obtain, after some algebra,

√ 
1
n FY11 (d)|S (y)−FY11 (d)|S (y) = √
n
where, omitting the index i,
d (y) =

1
pd|11 −pd|10



n

di (y)+oP (1),
i=1



GT
1{D = d}1{Y ≤ y}−pd|11 Fd11 (y)−FY11 (d)|S (y) 1{D = d}−pd|11
p11



G(1−T )
−1{D = d}(1{Qd (Y ) ≤ y}−Hd ◦Fd01 (y))+ 1{D = d}−pd|10 FY11 (d)|S (y)
p10


(1−T )(1{Qd (Y ) ≤ y}−Fd01 (y))
−Hd ◦Fd01 (y) +pd|10 (1−G)1{D = d}Hd ◦Fd01 (y)
pd00

T (1{Y ≤ y}−Fd01 (y))
.
−
pd01

+

By the functional delta method, this implies that we can also linearize WCIC and τq . Moreover, we obtain by the chain
rule the following influence functions:

ψCIC = 0 (y)−1 (y)dy,
(A31)

ψq,CIC =

1
fY11 (1)|S



(q)−
◦FY−1
11 (1)|S



0
fY11 (0)|S



(q).
◦FY−1
11 (0)|S

(A32)

Acknowledgments. We thank Yannick Guyonvarch for outstanding research assistance, and are very grateful to
Esther Duflo for sharing her data with us. We also want to thank the editor, five anonymous referees, Alberto Abadie, Joshua
Angrist, Marc Gurgand, Guido Imbens, Rafael Lalive, Thierry Magnac, Blaise Melly, Roland Rathelot, Bernard Salanié,
Frank Vella, Fabian Waldinger, Yichong Zhang, and participants at various conferences and seminars for their helpful
comments. This article is a merged and revised version of “Fuzzy Changes-in-Changes” by the two authors, and “A note on
instrumented Differences-in-Differences” by de Chaisemartin. Xavier D’Haultfoeuille gratefully acknowledges financial
support from the research grant Labex Ecodec: Investissements d’Avenir (ANR-11-IDEX-0003/Labex Ecodec/ANR-11LABX-0047).
Supplementary Data
Supplementary Data are available at Review of Economic Studies online.
REFERENCES
ABADIE, A. (2005), “Semiparametric Difference-in-Differences Estimators”, Review of Economic Studies, 72, 1–19.
ANGRIST, J. D., GRADDY, K. and IMBENS, G. W. (2000), “The Interpretation of Instrumental Variables Estimators in
Simultaneous Equations Models with an Application to the Demand for Fish”, The Review of Economic Studies, 67,
499–527.
ANGRIST, J. D. and IMBENS, G. W. (1995), “Two-Stage Least Squares Estimation of Average Causal Effects in Models
with Variable Treatment Intensity”, Journal of the American Statistical Association, 90, 431–442.

[20:12 16/3/2018 rdx049.tex]

RESTUD: The Review of Economic Studies

Page: 1027

999–1028

1028

REVIEW OF ECONOMIC STUDIES

[20:12 16/3/2018 rdx049.tex]

RESTUD: The Review of Economic Studies

Downloaded from https://academic.oup.com/restud/article-abstract/85/2/999/4096388 by Universitat St Gallen user on 25 September 2018

ATHEY, S. and IMBENS, G. W. (2006), “Identification and Inference in Nonlinear Difference-in-Differences Models”,
Econometrica, 74, 431–497.
BERTRAND, M., DUFLO, E. and MULLAINATHAN, S. (2004), “How Much Should We Trust Differences-inDifferences Estimates?”, The Quarterly Journal of Economics, 119, 249–275.
BLUNDELL, R., DIAS, M. C., MEGHIR, C., et al. (2004), “Evaluating the Employment Impact of a Mandatory Job
Search Program”, Journal of the European Economic Association, 2, 569–606.
BONHOMME, S. and SAUDER, U. (2011), “Recovering Distributions in Difference-in-Differences Models: A
Comparison of Selective and Comprehensive Schooling”, Review of Economics and Statistics, 93, 479–494.
DE CHAISEMARTIN, C. and D’HAULTFŒUILLE, X. (2016), “Double Fixed Effects Estimators with Heterogeneous
Treatment Effects” (Working paper).
—— (2017), “Supplement to “Fuzzy Differences-in-Differences” ” (Working paper).
D’HAULTFŒUILLE, X., HODERLEIN, S. and SASAKI, Y. (2015): “Nonlinear Difference-in-Differences in Repeated
Cross Sections with Continuous Treatments” (Working paper).
DUFLO, E. (2001), “Schooling and Labor Market Consequences of School Construction in Indonesia: Evidence from an
Unusual Policy Experiment”, American Economic Review, 91, 795–813.
ENIKOLOPOV, R., PETROVA, M. and ZHURAVSKAYA, E. (2011), “Media and Political Persuasion: Evidence from
Russia”, The American Economic Review, 101, 3253.
FIELD, E. (2007), “Entitled to Work: Urban Property Rights and Labor Supply in Peru”, The Quarterly Journal of
Economics, 122, 1561–1602.
GENTZKOW, M., SHAPIRO, J. M. and SINKINSON, M. (2011), “The Effect of Newspaper Entry and Exit on Electoral
Politics”, The American Economic Review, 101, 2980.
HOROWITZ, J. L. and MANSKI, C. F. (1995): “Identification and Robustness with Contaminated and Corrupted Data”,
Econometrica, 63, 281–302.
IMBENS, G. W. and RUBIN, D. B. (1997), “Estimating Outcome Distributions for Compliers in Instrumental Variables
Models”, Review of Economic Studies, 64, 555–574.
MINCER, J. and JOVANOVIC, B. (1979), “Labor Mobility and Wages” (Working paper).
VAN DER VAART, A. W. and WELLNER, J. A. (1996), Weak Convergence and Empirical Processes (New York:
Springer).
VAN DER VAART, A. W. (2000), Asymptotic Statistics (Cambridge: Cambridge Series in Statistical and Probabilistic
Mathematics).
VYTLACIL, E. (2002), “Independence, Monotonicity, and LATEnt Index Models: An Equivalence Result”,
Econometrica, 70, 331–341.
WILLIS, R. J. (1986), “Wage Determinants: A Survey and Reinterpretation of Human Capital Earnings Functions”,
Handbook of labor economics, 1, 525–602.

Page: 1028

999–1028

