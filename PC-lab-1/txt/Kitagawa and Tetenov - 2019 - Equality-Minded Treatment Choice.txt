Journal of Business & Economic Statistics

ISSN: 0735-0015 (Print) 1537-2707 (Online) Journal homepage: https://www.tandfonline.com/loi/ubes20

Equality-Minded Treatment Choice*
Toru Kitagawa & Aleksey Tetenov
To cite this article: Toru Kitagawa & Aleksey Tetenov (2019): Equality-Minded Treatment Choice*,
Journal of Business & Economic Statistics, DOI: 10.1080/07350015.2019.1688664
To link to this article: https://doi.org/10.1080/07350015.2019.1688664

View supplementary material

Accepted author version posted online: 06
Nov 2019.

Submit your article to this journal

Article views: 30

View related articles

View Crossmark data

Full Terms & Conditions of access and use can be found at
https://www.tandfonline.com/action/journalInformation?journalCode=ubes20

Equality-Minded Treatment Choice*
Toru Kitagawa† and Aleksey Tetenov‡
†Cemmap/University
‡University
*We

College London, Department of Economics

of Geneva

would like to thank Ignacio Monzón, John Weymark, Max Tabord-Meehan,

ip

t

and Jeff Rowley for useful comments. We have also benefitted from presenting
this work at Academia Sinica, Bristol ESG, RES, Cowles Conference on

cr

Econometrics, IAAE, SCW, AMES, Cemmap Advances in Econometrics, CEU,

us

EEA-ESEM, Oxford, and Northwestern Conference of Former Econometrics
Students. Financial support from the ESRC through the ESRC Centre for

an

Microdata Methods and Practice (CeMMAP) (grant number RES-589-28-0001)
and the European Research Council (Starting grant No. 715940) is gratefully

M

acknowledged. Toru Kitagawa thanks the Visiting Researcher Fellowship from
Collegio Carlo Alberto.

d

Corresponding author Toru Kitagawa t.kitagawa@ucl.ac.uk

Abstract

Ac

ce

pt
e

The goal of many randomized experiments and quasiexperimental studies in economics is to inform policies that
aim to raise incomes and reduce economic inequality. A policy
maximizing the sum of individual incomes may not be
desirable if it magnifies economic inequality and posttreatment redistribution of income is infeasible. This paper
develops a method to estimate the optimal treatment
assignment policy based on observable individual covariates
when the policy objective is to maximize an equality-minded
rank-dependent social welfare function, which puts higher
weight on individuals with lower-ranked outcomes. We
estimate the optimal policy by maximizing a sample analog of
the rank-dependent welfare over a properly constrained set of
policies. We show that the average social welfare attained by
our estimated policy converges to the maximal attainable
welfare at n1/2 rate uniformly over a large class of data
distributions when the propensity score is known. We also

show that this rate is minimax optimal. We provide an
application of our method using the data from the National
JTPA Study.
Keywords: Program evaluation, Treatment choice, Social welfare, Inequality
index, Gini coefficient

1 Introduction

ip

t

In causal inference studies analyzing experimental or quasi-experimental data,
treatment response generally varies with individual observable characteristics.

cr

Learning about such heterogeneity from the data is essential for designing

us

individualized treatment rules that assign treatments on the basis of individual
observable characteristics. The optimal individualized treatment rule maximizes a

an

social welfare criterion representing the policy maker’s preferences over
population distributions of post-treatment outcomes. The literature on statistical

M

treatment choice initiated by Manski (2004) emphasizes this perspective of
welfare-based empirical policy design and pursues statistically sound ways to

d

estimate the optimal treatment assignment rule.

pt
e

Research on statistical treatment rules typically focuses on the additive social

welfare criterion (sometimes called “utilitarian”) defined as the mean of the
outcomes in the population, even though welfare economics offers a variety of

ce

alternative criteria. The additive social welfare criterion offers analytical and
computational convenience because the optimal treatment rule then depends

Ac

only on the conditional average treatment effect. Empirical researchers studying
causal impacts of social programs have stressed the importance of evaluating
distributional impacts, which are overlooked when only mean outcomes are
considered (e.g., Bitler et al. (2006)). The distributional impact of a policy is
especially important when the policy maker is concerned about economic

inequality in the population.

We study the problem of treatment assignment that aims to maximize a rankdependent social welfare function (SWF), which has the form
W   Yi · (Rank(Yi ))di,

(1.1)

where Yi is individual i’s outcome, Rank(Yi ) is the outcome rank of i from the
bottom of the outcome distribution, and  (·) is a non-negative weight assigned

ip

class of generalized Gini SWFs proposed by Mehran (1976) and

t

to each rank. The additive SWF is a special case of (1.1) with constant  (·) . The

cr

Weymark (1981) consists of SWFs of the form (1.1) with non-increasing  (·) . It
closely relates to income inequality indices, including the widely-used Gini index.

us

Blackorby and Donaldson (1978) show that, given a specification of  (·) , the
rank-dependent SWF can be written as a product of the average outcome and

an

one minus the generalized relative index of inequality, e.g., Gini. This implies that
these SWFs generate a ranking of outcome distributions that is increasing in the

M

average outcome and decreasing in the chosen index of inequality. While
inequality measures are predominantly applied to net income, our analysis allows

d

Yi to denote other outcome variables of interest, including functions of income,

pt
e

consumption, wealth, or human capital. We will therefore refer to Yi simply as “
the outcome” in this paper.

ce

The goal is to choose a treatment rule δ that assigns individuals to one of two
treatments d {0,1} depending on their observable pre-treatment covariates

Ac

X  . This choice is made after experimental data has been collected and

analyzed. We do not consider the problem of optimal experimental design in this
paper, taking the design as given. We assume that an individual’s treatment
outcome does not depend on treatments received by others. The policy-maker in
our setup can only impact the distribution of outcomes through the choice of a
treatment assignment rule and cannot combine it with other redistributive
policies.

Finding a policy that maximizes a rank-dependent SWF is a non-trivial problem
without a closed-form solution even if the conditional distributions of potential
outcomes ( P(Y0 | X ) and P(Y1 | X ) ) are known (in a slight abuse of notation
typical in the literature, Yi will denote individual i’s realization of random variable

Y  (1  D)Y0  DY1 , whereas Y0, Y1, and Yd will denote random variables for
potential outcomes of treatments 0, 1, and d {0,1} ). Under an additive SWF

  u(Y )di (averaging either outcomes Y or, more generally, their non-linear
i

i

ip

t

transformations u (Yi ) ), it is optimal to assign for each subgroup the treatment
with the highest conditional mean E (u(Yd ) | X ) . In contrast, a rank-dependent

cr

SWF is non-decomposable across subgroups, as the ranking of treatment

us

assignment rules for a given covariate value may change depending on the
treatment assignment of other subgroups (see Section B in the online

an

supplement).

We show in Theorem 2.1 that an equality-minded rank-dependent SWF is always

M

maximized by a non-randomized treatment rule (assigning the same treatment to
all individuals with identical covariates). This result greatly simplifies the space of

d

treatment rules that need to be considered. It also allows us to index treatment
, denoting all values of the covariates  X G

pt
e

rules by their decision sets G 

for which treatment 1 is assigned.

ce

Our aim is to estimate from the sample data a treatment assignment rule Ĝ
belonging to a constrained (but generally large) set of feasible policies

, which

Ac

is a collection of non-randomized treatment rules indexed by their decision sets.
Policy makers often face legal, ethical, or political constraints that restrict how
individual characteristics can be used to determine treatment assignment. One of
the advantages of our framework is that it easily incorporates such exogenous
restrictions. Our analytical results also require

to satisfy a certain complexity

restriction (a finite VC-dimension) to prevent overfitting. Kitagawa and
Tetenov (2018a) argue that this is not restrictive for many public policy

applications and provide rich examples of treatment rule classes that satisfy this
complexity restriction.
We propose estimating the treatment rule Ĝ by maximizing a sample analog of

W(G), the SWF evaluated at the population distribution of Y that would realize if
treatment assignment rule G is implemented. The general idea of estimating a
policy by maximizing an empirical welfare criterion is in line with the method

t

developed by Kitagawa and Tetenov (2018a) for the additive welfare case, hence

ip

we refer to the method proposed in the current paper for rank-dependent SWFs

cr

as equality-minded Empirical Welfare Maximization (EWM). However, the results
of Kitagawa and Tetenov (2018a) cannot be directly applied in this setting. We

us

had to construct a suitable sample analog of W(G) using the whole distribution
function and derive new methods to show that this distributional welfare analog

an

(which is not a sample average, as in Kitagawa and Tetenov (2018a)) converges
uniformly over a VC-class of policies. Additionally, we develop a novel proof

M

technique to establish this convergence for unbounded outcome distributions
using a weak tail condition, whereas the results in Kitagawa and Tetenov (2018a)

d

for the additive welfare require outcomes to be bounded.

pt
e

We evaluate the statistical performance of Ĝ in terms of regret

ce



EPn sup W (G)  W (Gˆ )  , which is the average welfare loss relative to the maximum
 G


welfare achievable in

with respect to the sampling distribution Pn of a size n

sample. We derive a non-asymptotic and distribution-free upper bound on regret

Ac

in terms of the sample size n and a measure of complexity of

, and show that it

converges to zero at n 1/2 rate. We also show that this rate is minimax optimal
over a minimally constrained class of population distributions, ensuring that no
other data-driven treatment rule can lead to a faster welfare loss convergence
rate uniformly over the class of distributions.
The remainder of this paper is organized as follows. Section 1.1 provides an
overview of related literature. Section 2 discusses the properties of equality-

minded rank-dependent social welfare functions and their application to the
analysis of treatment choice. In Section 3, we introduce the general analytical
framework and show the convergence rate properties of the EWM rule for rankdependent welfare. Section 4 provides extensions of the model that incorporate
cost or capacity constraints and that allow the sampled population to be only a
subset of the full population on which social welfare is defined. In Section 5, we
apply our method to the experimental data from the National JTPA study. Main

ip

t

proofs are collected in the appendix. An online supplement contains additional

cr

proofs, examples, and extensions.

us

1.1 Related Literature

The analysis of statistical treatment rules was pioneered by Manski (2004), and

an

is a growing area of research in econometrics. Important recent developments
can be found in Dehejia (2005); Hirano and

M

Porter (2009); Stoye (2009, 2012); Chamberlain (2011); Bhattacharya and
Dupas (2012); Tetenov (2012), Kasy (2016, 2018), Kitagawa and
Tetenov (2018a), Mbakop and Tabord-Meehan (2018), and Athey and

d

Wager (2018), among others. All the existing works on treatment choice except

pt
e

for Kasy (2016) posit an additive welfare criterion as the objective function of the
policy maker. Motivated by policy concerns about economic inequality, the

ce

current paper instead analyzes the treatment choice problem for a class of rankdependent social welfare functions that embody inequality aversion.

Ac

The main feature distinguishing the current analysis from the EWM approach for
the additive welfare case considered in Kitagawa and Tetenov (2018a) is that the
rank-dependent welfare criterion is non-decomposable. Computing the empirical
welfare criterion then requires that the whole distribution of outcomes that would
be generated by each policy is estimated first, before a nonlinear transformation
is applied to this distribution estimate. This problem has not been previously
considered in econometrics nor in the machine learning and statistics literatures
on empirical risk minimization problems (Vapnik (1998)), where the empirical risk

criterion always takes the form of a sample average (with the exception of Wang
et al. (2018), who maximize one specific quantile of the outcome distribution).
Another novel technical contribution of this paper is that we allow outcomes to be
unbounded (which is important for analysis of economic outcomes like earnings)
with only a weak restriction on the tail of the potential outcome distribution.
Kasy (2016) analyzes treatment choice for a class of social welfare functions

t

including rank-dependent social welfare. Our approach differs from his in several

ip

aspects. First, Kasy (2016) considers a linear approximation of the rank-

cr

dependent welfare function around a status-quo policy in order to discuss

(partial) identification of a welfare-improving local policy change. We instead

us

focus on a globally optimal policy without invoking approximations. Second, we
assume that the welfare criterion is point-identified by the sampling process,

an

while Kasy (2016) focuses on partial identification of the welfare criterion and
construction of the social planner’s incomplete preference ordering over policies.

M

Third, we study estimation of an optimal policy and examine optimality of the
estimator in terms of welfare regret convergence rate, while Kasy (2016) studies

pt
e

d

asymptotically valid inference on the welfare rankings.
Aaberge et al. (2018) estimate a rank-dependent social welfare function of two
policy alternatives: with and without uniform implementation of the treatment.

ce

Firpo and Pinto (2016) estimate the impact of uniform implementation of the
treatment on measures of inequality, including the Gini coefficient. In contrast,

Ac

the focus of the current paper is on estimating the optimal treatment rule from a
large class of individualized assignment rules.
We consider social welfare functions that satisfy the axiom of anonymity, i.e.,
social welfare functions that are functionals of the distribution of outcomes after
treatment assignment and that are indifferent to reshuffling of the outcomes
between individuals. Thus, our objective does not depend on the distribution of
individual treatment effects P(Y1  Y0 ) , which has also received attention recently

in the program evaluation literature (Heckman et al. (1997b); Firpo and
Ridder (2019); Fan and Park (2010)).
Building social welfare functions satisfying the Pigou-Dalton principle of transfers
(that a transfer of income from a higher ranked individual to a lower ranked
individual that does not change their ranks is always desirable) is one of the
central themes in the literature of inequality measurement and welfare economics

t

(see Cowell (1995, 2000); Lambert (2001)). Currently, there are two widely-used


ip

classes of social welfare functions that meet the Pigou-Dalton principle. The first

cr

is the class of Atkinson-type SWFs (Atkinson (1970)), W ( F )   U ( y)dF ( y) ,
0

where F(y) is the cumulative distribution function (cdf) of the outcome and U (·) is

us

a concave non-decreasing function. Since the Atkinson-type social welfare
function is linear in F, the EWM approach of Kitagawa and Tetenov (2018a) can

an

be readily applied by defining the outcome observations as U(Y). The second
class, which is this paper’s main focus, is the class of rank-dependent social

M

welfare functions introduced by Mehran (1976); Blackorby and Donaldson (1978)
and Weymark (1981) and axiomatized by Yaari (1988). The key axiom of

d

Yaari (1988) that distinguishes rank-dependent social welfare from Atkinson-type

pt
e

social welfare is Invariance under a Rank-Preserving Lump-Sum Change of

Incomes at the Upper Tail, which means that the preference ordering between
two income distributions F and F is invariant to any fixed lump-sum increase

ce

(decrease) in income of all those above (below) the τ-th quantile of F and F for
any  (0,1) . On the other hand, the key axiom that characterizes the Atkinson-

Ac

type social welfare is the independence axiom: the preference ordering between

F and F is invariant to any mixing with another common income distribution. As
noted in Machina (1982), the rank-dependent social welfare generalizes the
Atkinson-type social welfare exactly as rank-dependent expected utility
generalizes classical von Neumann-Morgenstern expected utility
(Machina (1982) and Quiggin (1982)) by relaxing the controversial independence
axiom. These rich and insightful works in welfare economics have not yet been
well linked to econometrics and empirical analysis for policy design. One of the

main aims of the current paper is to establish a link between these two important
literatures.

2 Treatment Choice with Equality-Minded Social
Welfare Functions
We call a SWF equality-minded if it satisfies the Pigou-Dalton Principle of

Transfers: a transfer of income from a higher ranked individual to a lower ranked

ip

t

individual is always desirable when it does not change their ranks in the income
distribution. The equality-minded SWFs analyzed in this paper are the rank-

cr

dependent SWFs with decreasing welfare weights (also called generalized Gini

us

SWFs), introduced by Mehran (1976) and Weymark (1981) and axiomatized by
Yaari (1988). An equality-minded rank-dependent SWF admits the following



W ( F )   ( F ( y))dy,

(2.1)

M

0

an

representation:

where (·) :[0,1]  [0,1] is a non-increasing, non-negative function with (0)  1

d

and (1)  0 . A rank-dependent SWF satisfies the Pigou-Dalton Principle of

pt
e

Transfers if and only if  (·) is convex.

The term rank-dependent is due to an equivalent representation of (2.1) as a

ce

weighted sum of outcomes. Given that a convex  (·) is almost everywhere

Ac

differentiable, we can apply integration by parts to equivalently express W ( F ) as

W ( F )   F 1 ( ) ( )d ,
1

0

(2.2)

where F 1 ( )  inf{ y : F ( y)  } is the τ-th quantile of the outcome distribution
d [1  ( )]
and  ( ) 
. Thus W ( F ) is a weighted average of outcomes Y, where
d

 ( ) specifies the rank-specific welfare weight assigned to individuals with
outcomes at the τ-th quantile. If the SWF is equality-minded then  (·) is convex,

hence  (·) is non-increasing and assigns larger welfare weights to individuals
with lower outcomes.
Throughout the paper, we consider equality-minded SWFs satisfying the
following assumption:
Assumption 2.1 (SWF).

ip

t

The policy-maker’s SWF has representation (2.1), where (·) :[0,1]  [0,1] is a

non-increasing, convex function with (0)  1, (1)  0 , and its right derivative at

cr

the origin is finite: | (0) |  .

us

An important family of social welfare functions satisfying Assumption 2.1 is the

extended Gini family considered in Donaldson and Weymark (1980, 1983) and





0

0

an

Aaberge et al. (2018):

Wk ( F )   (1  F (y))k 1 dy    k ( F ( y))dy   F 1 ( ) k ( )d ,

M

1

0

(2.3)

where  k ( )  (1   )k 1 and the welfare weight function is  k ( )  (k  1)(1   )k 2 .

d

Extended Gini social welfare functions are equality-minded for k > 2. Setting k =


0

ce

equality-minded.

pt
e

2 yields the additive welfare function W2 ( F )   (1  F ( y))dy  E (Y ) , which is not

The standard Gini social welfare function (Blackorby and

Ac

Donaldson, 1978; Weymark, 1981) corresponds to k = 3 in the extended Gini
family, with 3 ( )  (1   )2 and welfare weights 3 ( )  2(1   ) . It could also be
written as

WGini ( F )  E (Y )(1  IGini ( F )), (2.4)

where I Gini


(F )  1 

1

0

F 1 ( )·2(1   )d
E (Y )

is the widely-used Gini inequality index.

Assumption 2.1 implies that the rank-specific weight function  (·) defined in (2.2)
does not asymptote at the origin, i.e., the welfare weight assigned to the lowest
rank is bounded. This restriction rules out SWFs that closely approximate the
Rawlsian social welfare.
We consider the problem of choosing a policy that assigns individuals to one of
two treatments d {0,1} in order to maximize the chosen SWF. A treatment
observable pre-treatment covariates X 



dx

t

 [0,1] specifies the proportion of individuals with

who will be assigned to

ip

assignment rule  :

cr

treatment 1 by the policy-maker. The policy randomly assigns individuals with
covariates X to the two treatments with probabilities 1   ( X ) and  ( X )) . The

us

population distribution of outcomes induced by treatment rule δ has cdf
(2.5)

an

F ( y)   (1   ( x)) FY0 | X  x ( y)   ( x) FY1| X  x ( y) dPX ( x),

M

where Y0 and Y1 denote the potential outcomes of the two treatments with
conditional distributions FY0 | X and FY1| X given X and PX is the marginal distribution

d

of X.

pt
e

If the population distribution of (Y0 , Y1 , X ) were known, the optimal policy
maximizing the social welfare function (2.1) would be



ce

 * arg max W ( F ). (2.6)

Ac

For the additive welfare function (the mean of Y), the welfare maximization
problem simplifies to
*
 util
arg max   (1   ( x)) E (Y0 | X  x)   ( x) E (Y1 | X  x)dPX ( x).



(2.7)

This social welfare is additive across covariates and depends on the outcome
distributions only through their conditional means E (Yd | X ) . Then the optimal
policy is

*
 util
 1 x  : E (Y1 | X  x)  E (Y0 | X  x) .

In contrast, the optimal rule for a rank-dependent welfare function (2.1) depends
on the whole conditional distributions of potential outcomes FY0 | X and FY1| X , not
only on their means. The optimal rule can differ from the one maximizing an
additive welfare if there is no first-order stochastic dominance relationship

t

between FY0 | X and FY1| X for some covariate values.

ip

Even with the knowledge of the distribution of (Y0 , Y1 , X ) , a simple

cr

characterization of the optimal rule does not seem available for rank-dependent
SWFs. The following theorem mitigates this complication by substantially

us

reducing the set of candidate treatment rules that need to be considered.

treatment rule  :

an

Theorem 2.1. If W (·) satisfies Assumption 2.1, then for every measurable
 [0,1] , there exists a non-randomized treatment rule
G





of Borel subsets of

:

pt
e

d

If all upper level sets of δ belong to a collection
{x :  ( x)  t}  , t  ,

   W (F ) .

, such that W F

M

 G ( x)  1{x G} for some Borel set G 

   W (F ) .
G





ce

then there exists  G ( x), G  , such that W F
Proof. See Appendix A. □

Ac

This theorem shows that a treatment assignment rule maximizing an equalityminded rank-dependent welfare is non-randomized (assigns all individuals with
the same covariates to the same treatment). We can therefore restrict our search
for an optimal policy to the set of non-randomized rules that can be succinctly
characterized by their decision sets G 

. Decision set G determines the group

of individuals  X G to whom treatment 1 is assigned. With abuse of notation,
we denote the welfare of a non-randomized treatment rule with decision set G by

W (G) , suppressing the cumulative distribution function in its argument,

W (G)  W ( FG ),
FG ( y)    FY0 | X  x ( y)1{x G}  FY1| X  x ( y)1{x G}dPX ( x). (2.8)

Our goal is to estimate from the sample data a treatment assignment rule that
attains the maximum level of social welfare sup W (G) over the set of feasible

 , which is a collection of non-randomized treatment rules

ip

 G 

(subsets of the covariate space

). An important feature of our empirical welfare

maximization approach is that the complexity of

cr

policies

t

G

is constrained by a finite

us

Vapnik-Cervonenkis (VC) dimension (defined in the Appendix).

has a finite VC-dimension v   .

M

The class of decision sets

an

Assumption 2.2 (VC).

The VC-dimension is a restriction on the complexity of the set of feasible policies.

d

Without it, maximizing a sample analog of W (G) over G can lead to arbitrarily

pt
e

complicated policies (overfitting) and prevent us from learning the optimal policy
on the basis of a finite number of observations. It does not require

to be finite

and allows for very large classes of treatment rules. For example, a class of

ce

treatment rules defined by a linear equation in functions of x,

Ac

m

 G  {x :   j f j ( x)  0},  
i 1


m


 has a finite VC-dimension. See Kitagawa and


Tetenov (2018a) for other examples of classes
example of

that satisfy Assumption 2.2. An

that does not satisfy Assumption 2.2 is the class of all monotone

treatment rules



 G  {( x1 , x2 ) 

2

: x2  f ( x1 )}, f :





increasing

considered by Mbakop and Tabord-Meehan (2018) in the additive welfare case.

3 EWM for Equality-Minded Welfare

We proceed to propose our method of estimating the treatment rule in finite
samples and analyze its properties.
The population from which the sample is drawn is characterized by P, a joint
distribution of Y0i , Y1i , Di , X i  , where X i 



treatment covariates of individual i, Y0i , Y1i 

dx



refers to observable pre-

are the potential outcomes of

experimental treatment. The observed experimental outcome is

cr

ip

Yi  (1  Di )Y0i  DY
i 1i .

t

treatments 0 and 1, and Di {0,1} is a binary indicator of the individual’s

The data is a size n random sample from P of observations Zi  (Yi , Di , X i ) .

G

us

Based on this data, the policy-maker has to choose a conditional treatment rule
that determines whether individuals with covariates X in the target

maintained assumptions about the class

of population distributions of

M

(Y0 , Y1 , D, X ) :

an

population will be assigned to treatment 0 or to treatment 1. The following are our

d

Assumption 3.1.

pt
e

(UCF) Unconfoundedness: (Y0 , Y1 )  D | X .





P(Yd  y)dy  . (3.1)

Ac

0

ce

(TC) Tail Condition: There exists    such that for all P 

(SO) Strict Overlap: There exist  (0,1/ 2] such that the propensity score
satisfies e( x) [ ,1   ] for all x 

.

These assumptions generally hold if the data come from an experiment with
randomized treatment assignment. In observational studies, on the other hand,

Unconfoundedness rules out situations in which the observed treatment
assignments depend on subjects’ unobserved characteristics that can be
associated with their potential outcomes. Strict Overlap can also be violated in an

observational study if only one of the treatments is assigned in the sampling
process for some covariate values. We do not constrain any feature of the joint
distribution of (Y0 , Y1 , X ) except that the distributions of Y0 and Y1 satisfy the tail
condition (TC). A sufficient condition for (TC) is that
sup
P , d {0,1}

E[Yd2 ]   (3.2)

t

for some   0 . The outcome variable and the covariates can be discrete,

ip

continuous, or their combination, and the support of X does not have to be

cr

bounded.

us

Throughout the main text we maintain the assumption that the propensity score
e( X )  P( D  1| X ) is known, as is usually the case in experimental data. Section

an

C in the Online Supplement extends the analysis to observational data for which
the propensity score is unknown and needs to be estimated.

M

We estimate the treatment rule by maximizing a sample analog of the population

d

SWF. The equality-minded EWM treatment rule Ĝ maximizes a sample analog
Wˆ (G) of the welfare criterion over the set of feasible rules G  . The unknown


pt
e

outcome distribution FG induced by treatment rule G in (2.8) could be estimated
by

Ac

ce


1  Di
1 n  Di
ˆ
FG ( y)  1   
·1{ X i G} 
·1{ X i G}·1{Yi  y}. (3.3)
n i 1  e( X i )
1  e( X i )

Under Assumption 3.1 (UCF), FˆG ( y ) is an unbiased estimator of FG ( y) .
The sample analog of welfare (equation (2.1)) is defined as


Wˆ (G)   ( FˆG ( y)  0)dy (3.4)
0

and the equality-minded EWM treatment rule is then

Gˆ arg max Wˆ (G). (3.5)
G

The maximum (  ) of FˆG ( y ) and 0 is taken in (3.4) because FˆG ( y ) may take
values smaller than 0, for which  (·) is not defined. The summands in (3.3) are
non-negative, so FˆG ( y)  1 for all y. FˆG ( y)  1 for all y  max Yi . FˆG may not be a
1i  n


1  Di
1  D
proper CDF because lim FˆG ( y)  1    i ·1{ X i G} 
·1{ X i G}
y 
n i 1  e( X i )
1  e( X i )

n

ip

t

may be either below or above zero in finite samples.

G

0

(3.7)

d

M

1{ y  min Yi } if FˆG ( )  1,
1 i  n


FˆGR ( y )  
1  FˆG ( y )
if FˆG ( )  1,
1 
ˆ
1

F
(

)

G


an

using a normalized CDF sample analog

(3.6)

us


Gˆ R arg max WˆR (G), where WˆR (G)   ( FˆGR ( y))dy,

cr

We also consider properties of the normalized equality-minded EWM rule

pt
e

which always yields a proper CDF. The ranking of treatment rules by the
normalized criterion Wˆ R (G) is invariant to positive affine transformations of


ce

outcomes Y, whereas the ranking by Wˆ (G) is not.



Di
1  Di
·1{ X i G} 
·1{ X i G}


e
(
X
)
1

e
(
X
)
1
R
i
i

·1{Y  y}.
Note that 1  FˆG ( y )  
i
n

n i 1 1  Di

1  Di
·1{ X i G} 
·1{ X i G} 
 
1  e( X i )
 
 n i 1  e( X i )

Ac

n

This is similar to the idea of normalizing propensity score weights recommended
for the estimation of the average treatment effect (Imbens, 2004).

3.1 Rate Optimality of EWM

The next theorem derives a uniform upper bound of the average welfare loss of
the EWM rule.
Theorem 3.1. Under Assumptions 2.1 and 2.2, the average welfare loss of
treatment rules Ĝ and Gˆ R satisfies
(3.8)

t

 v


sup EPn sup W (G)  W (Gˆ )  C | (0) |
 n
P
 G


2

cr

is the class of all distributions satisfying

an

 1 
for all n  C 
v , where
  
R
3

(3.9)

us

R 2 

v


sup EPn sup W (G)  W (Gˆ R ) | (0) |  C1R
 4ne  C2  n 

n
P
 G



ip

for all n > 1, and

M

Assumption 3.1 and C, C1R , C2R , C3R  0 are universal constants.
Proof. The proof of (3.8) is in Appendix A. The proof of (3.9) is in the Online

d

Supplement.

pt
e

This theorem shows that for a large class of data generating processes
characterized by Assumption 3.1, the welfare of the equality-minded EWM rule is

ce

guaranteed to converge to the maximal attainable welfare no slower than at n 1/2
rate (the second term in bound (3.9) is of a lower order). The uniform

Ac

convergence rate of n 1/2 coincides with that of the EWM rule for the additive
welfare shown in Theorem 2.1 of Kitagawa and Tetenov (2018a). This is a
nontrivial result, given that the rank-dependent welfare function depends on the
whole conditional distributions of the potential outcomes given covariates, rather
than only on their conditional means, as is the case for the additive welfare
criterion.
The next theorem provides a universal lower bound for the worst-case average
welfare loss of any treatment rule.

Theorem 3.2. Suppose that Assumptions 2.1 and 2.2 hold with v  2 , then for any

non-randomized treatment choice rule Ĝ that is a function of the sample, and for
any  * (0,1] at which (·) is differentiable, it holds
4
v 1
v 1

 e
sup EPn sup W (G)  W (Gˆ ) 
 ( * )  *
for all n  4 * , (3.10)
n

P
 G
 2

is the class of all distributions satisfying Assumption 3.1.

t

where

ip

Proof. See the Online Supplement.

cr

Since  (·) is convex and | (0) | 0 , there also exists some  *  0 for which

us

| ( * ) | 0 . Hence the bound (3.10) is always positive for some  *  0 . A
comparison of the lower bound of this theorem with the welfare loss upper bound

an

of the EWM rule obtained in Theorem 3.1 shows that the EWM rule is minimax

rate optimal over the class of data generating processes satisfying Assumption

M

3.1. We can therefore claim that in the absence of any additional restrictions
other than Assumption 3.1, no other data-driven procedure for obtaining a non. This optimality claim is analogous to that of the EWM

pt
e

convergence rate over

d

randomized rule can outperform the EWM rule in terms of the uniform
rule for the additive welfare case (Theorems 2.1 and 2.2 in Kitagawa and
Tetenov (2018a)), and the minimax optimal rate attained by the equality-minded

ce

EWM rule is the same as the optimal rate in the additive welfare case. It is
remarkable to see that even in the absence of any analytical characterization of

Ac

the true optimal assignment rule in terms of the population distribution of

(Y0 , Y1 , X ) , maximizing the empirical welfare leads to a policy that, if implemented,
is guaranteed to reach the maximum attainable social welfare at the minimax
optimal rate.
It is also worth noting that the VC-dimension of

appears in the same order

both in the upper and lower bound expressions of Theorems 3.1 and 3.2. Since
these bounds are non-asymptotic, we can let v increase with the sample size,

and we can still conclude the minimax rate optimality of the equality-minded
EWM rule. This insight is similar to the EWM rule for the additive welfare case
(Remark 2.6 in Kitagawa and Tetenov (2018a)).

4 Extensions

t

4.1 Social Welfare is Defined on a Population Larger than
the Sampled Population

ip

One of the distinguishing features of rank-dependent social welfare is that it is

cr

not additive over subpopulations (see Section B in the Online Supplement for an
illustration). If the subpopulation for which the policy intervention takes place

us

(e.g., unemployed workers) is only a subset of the whole population on which the
rank-dependent SWF is defined (e.g., the population of a country), it is important

an

to explicitly take into account the outcome distribution for the rest of the

M

population in estimating the optimal assignment rule.

Suppose that the social welfare function is defined on a population with

d

distribution J that is a mixture of two subpopulations with distributions F and H:

pt
e

J  F  (1  ) H ,  (0,1). (4.1)

Let F be the outcome distribution on the targeted subpopulation from which the

ce

experimental data are sampled and on which the estimated treatment policy is to
be implemented. Let H be the outcome distribution for the rest of the population

Ac

(excluded from the sampling process and unaffected by the chosen treatment
assignment rule). The mixture weight η represents the size of subpopulation F.
For simplicity, we assume that η and H are known to the social planner. We also
assume that the outcome distribution H is invariant to the treatment assignment
policy applied to subpopulation F, e.g., there are no spillover or general
equilibrium effect across F and H.

Implementing treatment assignment rule { X G} on subpopulation F leads to full
population welfare equal to


W ( J G )   (FG ( y)  (1  ) H ( y))dy,
0

where FG (·) is the cdf defined in (2.8). The empirical welfare maximization
method in this case consists of maximizing a sample analog of W ( J G ) ,

t

Gˆ arg max W (FˆG  (1  ) H ),

ip

G

cr

where FˆG is defined in (3.3).

us

The uniform convergence proof of Theorem 3.1 can be easily extended to this

an

case, the only change being the proportionality of the bound to η.
Corollary 4.1. Under Assumptions 2.1, 2.2 and 3.1,

(4.2)

d

M

 v


sup EPn supW ( J G )  W ( J Gˆ )  C | (0) |
,
 n
P
 G


pt
e

where C > 0 is a universal constant defined in Theorem 3.1.

4.2 Cost of Treatment

ce

In the preceding sections we did not take into account the cost of treatment even
though cost differences among treatments are often an important consideration

Ac

in practice. In this section we discuss how to take the cost of treatment into
account in the estimation of welfare maximizing treatment assignment policies.
Let 0  c( x)  , x  , be the cost of treatment 1 for a subject whose observable
characteristics are x. We assume that treatment 0 is cost-free and c(·) is known.
For the additive social welfare function, we can easily incorporate treatment costs
into the EWM criterion by subtracting the per-capita cost of treatment
C (G)  c( x)dP ( x) from Wˆ (G) . The additive social welfare criterion depends



G

X

only on the average treatment cost, it is invariant to assumptions about who pays

the cost. For rank-dependent social welfare this invariance does not hold, hence
we have to be explicit about who bears the cost in the construction of the social
welfare criterion. We illustrate this using two cost allocation scenarios.
In the first scenario, assume that the outcome variable is income and the cost of
treatment is self-financed by each recipient of the treatment. Specifically, the

t

income of individuals assigned to treatment 1 (individuals with X G ) will be

ip

reduced by the full cost of their own treatment c(X). The transformed potential

cr

outcomes in this scenario are Y1i  Y1i  c  c( X i ) and Y0i  Y0i  c . We add the
constant c  sup c( x)   to all outcomes to keep them non-negative in line with

us

x

Assumption 3.1 (TC). The welfare ranking of policies is unchanged when a

an

constant is added uniformly to all outcomes.

M

The rank-dependent SWF of policy G with self-financed treatment cost is


Wsf (G)    ( FGsf ( y))dy,
0

(4.3)

pt
e

d

FGsf ( y )    FY0 | X  x ( y )1{x G}  FY1| X  x ( y)1{x G}dPX ( x),

where FY0 | X  x (·) and FY1| X  x (·) are the cdfs of the transformed potential outcomes.

ce

An empirical analog for W sf (G) can be obtained by replacing FˆG ( y ) in (3.4) by

Ac


1  Di
1 n  D
FˆG ( y)  1    i ·1{ X i G} 
·1{ X i G}·1{Yi  y}, (4.4)
n i 1  e( X i )
1  e( X i )

where Yi  Yi  c  Di ·c( X i ) . Since this modification does not affect the validity of
Assumption 3.1, the EWM rule with self-financed treatment cost attains the
uniform welfare loss upper bounds of Theorem 3.1 with   c in place of  .
In the second scenario, suppose that the treatment cost is financed by all of the
population members equally via a lump-sum transfer. The average per-capita
treatment cost C(G) is subtracted from every individual’s income regardless of

their covariates and assigned treatment. Using representation (2.2), the rankdependent SWF with equal lump-sum treatment costs can be expressed as

Wls (G)   [ FG1 ( )  c  C (G)] ( )d  W (G)  c  C (G),
1

(4.5)

0

using the fact that

  ( )d  (0)  (1)  1 and adding c
1

0

to ensure non-

negative outcomes. Per-capita treatment cost of policy G could be estimated

cr

ip

t

1 n
using its sample analog Cˆ (G)   c( X i )·1{ X i G} and the EWM rule is obtained
n i 1
ls
by maximizing Wˆ (G)  Wˆ (G)  c  Cˆ (G) over G  .

us

In this paper we do not consider the joint optimization of the treatment

assignment and cost allocation. However, the comparison of Wsf (G) and Wls (G)

an

shows that the allocation of treatment costs across the population can be used
as an additional vehicle of policy intervention to increase a rank-dependent SWF.

M

4.3 Capacity-Constrained Treatment

d

Another practical concern ruled out in the preceding sections is a capacity

pt
e

constraint limiting the proportion of population that can be assigned to treatment.
Suppose that the proportion of the target population that could receive treatment
1 cannot exceed K (0,1) . If PX is unknown, then policies that seem to satisfy the

ce

capacity constraint based on the sample estimates of PX (G) may not actually
satisfy it in the population. The analysis of the welfare loss needs to take into

Ac

account what happens if the proposed policy is infeasible. For tractability, we
continue to restrict attention only to non-randomized treatment rules (the result in
Theorem 2.1 need not hold with a capacity constraint).
For the additive welfare case, Kitagawa and Tetenov (2018a) proposed a
capacity-constrained EWM procedure assuming that if a proposed treatment rule

G violates the capacity constraint ( PX (G)  K ) then the scarce treatment is
randomly rationed to a fraction

K
of individuals with X G independently of
PX (G )

(Y0 , Y1 , X ) . This random rationing approach can be straightforwardly extended to
the EWM for the rank-dependent social welfare.
With the capacity constraint and random rationing, the cdf of outcomes
generated by policy G can be written as

FY0 | X  x ( y ) 





K 

dPX ( x).
min
1,
F
(
y
)

F
(
y
)
·1{
x

G
}


Y
|
X

x
Y
|
X

x
1
0


 PX (G ) 



(4.6)



t



ip

F ( y)  
K
G

cr

Hence the social welfare under the capacity constraint and random rationing is


WK (G)   ( FGK ( y))dy . Its sample analog can be constructed by replacing

us

0

FˆG ( y ) in (3.4) with

(4.7)

1 n
1{X i G} is a sample analog of PX (G) .
n i 1

pt
e

where PX ,n (G) 

d

M

an

1  Di





1  e( X i )
1 n 
K
·1{Y  y},
ˆ
FG ( y )  1  
 i




n i 1 
1  Di
K  Di

 min 1,

 1{ X i G}


 PX ,n (G )   e( X i ) 1  e( X i ) 

Proposition 4.1 establishes a finite sample bound for the capacity-constrained

ce

equality-minded EWM rule similar to the bound in Proposition 3.1.

Ac

Proposition 4.1. Under Assumptions 2.1, 2.2 and 3.1,

 v


 C
sup EPn supWK (G)  WK (Gˆ K )   K 1  CK 2  | (0) |
,

 n
P
 G
  K

where CK 1 , CK 2  0 are universal constants.
Proof. See the Online Supplement. □

5 Empirical Illustration

(4.8)

To illustrate equality-minded empirical treatment choice, we apply our method to
the experimental data from the National Job Training Partnership Act (JTPA)
Study. A detailed description of the study and an assessment of average
program effects for five large subgroups of the target population is found in
Bloom et al. (1997). The study randomized whether applicants were eligible to
receive a mix of training, job-search assistance, and other services for a period of
18 months. It collected background information about the applicants prior to

ip

t

random assignment, as well as administrative and survey data on applicants’

earnings in the 30-month period following assignment. Our sample consists of

cr

9,223 observations with available data on years of education and pre-program

us

earnings from the sample of adults (22 years and older) used in the original
evaluation of the program and in subsequent studies (Bloom

et al., 1997; Heckman et al., 1997a; Abadie et al., 2002). The probability of being

an

assigned to the treatment was two thirds in this sample.

M

For this illustration, total individual earnings in the 30-month period following
program assignment serve as the measure of income. We use three social

d

welfare functions from the extended Gini family (2.3) with parameters k {2,3,6} .

pt
e

k = 2 corresponds to the additive social welfare, which is not equality-minded. k =
3 corresponds to the standard Gini SWF with welfare weights 3 ( )  2(1   ) and

k = 6 corresponds to an extended Gini SWF with welfare weights 6 ( )  5(1   )4

ce

, which places even greater weight on low-ranked outcomes.

Ac

For simplicity, we consider only the distribution of earnings in the population
sampled for the experiment in the social welfare function. This embodies
concerns about inequality within the study population (JTPA-eligible economically
disadvantaged adults). In practice, policy makers are more likely to be concerned
with inequality in the overall population, which also includes individuals outside of
the experiment’s sampling frame. Then the social welfare function should be
evaluated on the income distribution of the whole population of interest.

Pre-treatment variables on which we consider conditioning treatment assignment
are the individual’s years of education and earnings in the year prior to
assignment. We do not use race, sex, or age to condition treatment assignment.
Though treatment effects may vary with these characteristics, using them to
condition treatment assignment is often socially unacceptable and illegal.
Education and earnings are verifiable characteristics, which is also important for
conditioning treatment assignment. The performance of treatment rules that

ip

t

condition on unverifiable characteristics is hard to evaluate if individuals change
their self-reported characteristics to obtain their desired treatment assignment

cr

(either in the experiment or when the policy is implemented).

us

Table 1 compares empirical estimates of social welfare measures (representative
income) for a few alternative treatment rules. First, we consider simple treatment

an

rules that either assign no one or everyone to treatment. Second, we consider
empirically optimal rules from the class of quadrant treatment rules:

M

 x : s1 (education  t1 )  0 & s2 (prior earnings  t2 )  0 ,

.
s1 , s2 {1, 0,1}, t1 , t2 



(5.1)

d

Q

pt
e

This class of treatment eligibility rules is easily implementable and is often used
in practice. To be assigned to treatment according to such rules, an individual’s
education and pre-program earnings both have to be above (or below) some

ce

specific thresholds. Third, we consider empirically optimal rules from the class of

Ac

linear treatment rules:
LES

  x : 0  1· education  2·prior earnings  0 , 0 , 1 , 2 

.

(5.2)

The first column in Table 1 displays the estimated average income under each
treatment rule. The second column shows the standard Gini social welfare,
expressed in terms of the representative income of the policy (the income
distribution generated by the policy is valued as much as an equal income

distribution with the representative income). The third column shows the
representative income under an extended Gini SWF with k = 6. The fourth
column lists the proportion of the target population assigned to treatment by each
policy.
Figure 1 compares the quadrant treatment rules maximizing the average income,
the standard Gini SWF, and an extended Gini SWF (k = 6). Figure 2 compares

t

the linear treatment rules maximizing the same three criteria. The size of black

ip

dots shows the number of individuals with different covariate values. Many

cr

individuals would be assigned to treatment by treatment rules maximizing any of
the considered welfare functions, but there are also notable differences.

us

Treatment rules maximizing the standard Gini SWF target a smaller proportion of
the population, focusing on individuals with lowest pre-program earnings.

an

Treatment rules maximizing the more equality-minded extended Gini SWF assign
even fewer individuals to treatment. The estimated treatment rules change

M

discontinuously with the Gini parameter k. For example, the linear treatment rule
maximizing the additive SWF (k = 2) is also optimal for a range of other Gini

d

parameters ( k  2.25, 2.5, 2.75 ), whereas the linear rule maximizing the extended

pt
e

Gini SWF (k = 6) is also optimal for larger parameters (k = 7, 8, 9).
Figure 3 explores the trade-off between treatment rules maximizing different

ce

social welfare functions. We compute the income distributions generated by Gˆ Add ,
the quadrant treatment rule maximizing average income, and by Gˆ , the
Gini

Ac

quadrant rule maximizing the Gini SWF. The left panel displays the difference
between the income distributions generated by these treatment rules at each
quantile: Fˆ 1 ( )  Fˆ 1 ( ) . The average-maximizing treatment rule Gˆ
GˆGini

Gˆ Add

Add

generates an income distribution in which top quantiles (0.8 and higher) are
substantially higher than in the income distribution generated by the Gini
treatment rule. However, the distribution produced by the Gini treatment rule is
better at midrange quantiles (0.4-0.8). The additive welfare criterion equally
weights changes of all quantiles, hence it favors Gˆ .
Add

The standard Gini welfare criterion, in contrast, uses decreasing welfare weights

3 ( )  2(1   ) . The right panel of Figure 3 displays the same quantile
differences between the two income distributions weighted by 3 ( ) . With these
equality-minded welfare weights, the gains offered by treatment rule Gˆ
at top
Add

quantiles get a lower welfare weight than the gains offered by Gˆ Gini in the middle
of the income distribution, hence Gˆ
is preferred under the Gini SWF.
Gini

ip

t

6 Conclusion

cr

This paper develops the first method for individualized treatment choice when the
policy maker’s objective is to maximize an equality-minded rank-dependent SWF.

us

We showed that the average social welfare obtained by the estimated policy
converges at the minimax-optimal n 1/2 rate. The key restriction underlying these

an

rate results is the complexity restriction (Assumption 2.2 (VC)) imposed on the
set of feasible policies. This complexity restriction still allows for rich classes of

M

individualized treatment rules and offers a flexible and convenient way to
incorporate exogenous constraints that policy makers face in realistic settings of

d

policy design. Our analytical results cover a general class of equality-minded

pt
e

rank-dependent SWFs, and the shown regret bounds are valid even when the
complexity of policies grows with the sample size. Efficient computation for the
equality-minded EWM and a data-driven choice of complexity for policies (e.g.,

ce

as proposed by Mbakop and Tabord-Meehan (2018) for the additive welfare

Ac

case) remain open questions.

A Appendix: Lemmas and Proofs
Proof of Theorem 2.1. Denote an upper level set of  ( x) at level u [0,1] by
G(u)  {x  :  ( x)  u} . By noting that

 ( x)   1{x G(u)}du,
1

0

we can rewrite F ( y) defined in (2.5) as

1
1
F ( y )    1{x G (u )}du·FY0 | X  x ( y )   1{x G (u )}du·FY1| X  x ( y ) dPX ( x)
0
 0






    1{x G (u )}·FY0 | X  x ( y )  1{x G (u )}·FY1| X  x ( y ) dPX ( x) du
0

1

  FG (u ) ( y )du,
1

0

where FG (u ) ( y) is the distribution of outcomes induced by treatment rule

t

 G (u )  1{x G(u)} . By convexity of (·) , we obtain
( F ( y))   ( FG (u ) ( y))du,

ip

1

cr

0

W ( F )   W ( FG (u ) )du  W .
1

us

and this leads to
(A.1)

an

0

Suppose that W  W ( FG (u ) )  0 for all u [0,1] . Then the integral of this function



M

over the set u [0,1] of positive measure must also be strictly positive,



0   W  W ( FG (u ) ) du  W  W ,
1

d

0

pt
e

which is a contradiction. Therefore, there exists u [0,1] for which

W ( FG (u ) )  W , hence W ( FG (u ) )  W ( F ) . If all upper level sets G(u) of δ belong
, then also G(u )  . □

ce

to

The following five lemmas will be used in the proof of Theorem 3.1. The first

Ac

lemma establishes a quadratic upper bound for the function t 1/2 for t  1 .
Lemma A.1. Let t0  1 , define

0
g (t )   1/2
t

for t  0,
for t  1,

(A.2)

1
h(t )  t01/2  t03/2 (t  t0 )  t02 (t  t0 )2 .
2

(A.3)

Then g (t )  h(t ) for t = 0 and for all t  1 .
Proof of Lemma A.1.
For t = 0,

us
an

1
1
(h  g )(t )   t03/2  2t02 (t  t0 )  t 3/2 ,
2
2

M

3
(h  g )(t )  2t02  t 5/2 , and
4
15 7/2
t .
8

d

(h  g )(t ) 

cr

1
(h  g )(t )  t01/2  t03/2 (t  t0 )  t02 (t  t0 )2  t 1/2 ,
2

ip

Now consider the function (h  g )(t ) and its derivatives for t  1 :

t

1
3
h(0)  t01/2  t03/2t0  t02t02  t01/2  1  0  g (0).
2
2

pt
e

First, we will show that (h  g )(t )  0 for t [1, t0 ] . The function is positive at t = 1:

Ac



ce

1
(h  g )(1)  t01/2  t03/2 (1  t0 )  t02 (1  t0 ) 2  1
2
1
1
 t01/2  t03/2  t01/2  t02  2t01  1  1
2
2
1
 t01/2 3  4t01/2  t01  2t03/2
2
2
1
 t01/2 1  t01/2 3  2t01/2  0
2









because t01/2  0 . At t = t0, (h  g )(t0 )  0 . We will next show that (h  g )(t )  0
between t = 1 and t = t0.
The second derivative of (h  g ) is positive at t = t0,

3
3


(h  g )(t0 )  2t02  t05/2  t02  2  t01/2   0


4
4

(A.4)

because t0  1 by assumption, hence t01/2  1 . Since the third derivative is
positive on [1, t0 ] , it follows that the second derivative is either positive
everywhere on [1, t0 ] , or it is first negative on some interval [1, t2 ) and then
positive on (t2 , t0 ] .

ip

t

The first derivative of (h  g ) equals zero at t = t0:

cr

1
1
(h  g )(t0 )   t03/2  2t02 (t0  t0 )  t03/2  0.
2
2

us

If the second derivative is positive everywhere on [1, t0 ] , then the first derivative
must be negative everywhere on [1, t0 ) . If the second derivative changes sign

an

from negative to positive, then the first derivative must either be negative on

[1, t0 ) or it could switch sign from positive on some interval [1, t1 ) to negative on

M

(t1, t0).

d

Since (h  g )(1)  0, (h  g )(t0 )  0 , and (h  g ) is either decreasing on [1, t0 ) or
all t [1, t0 ] .

pt
e

increasing on [1, t1 ) and then decreasing on (t1, t0), it follows that (h  g )(t )  0 for

ce

Second, consider t  t0 . At t = t0, (h  g )(t0 )  0, (h  g )(t0 )  0 , and the second
derivative is positive for all t  t0 because it is positive at t = t0 (A.4) and the third

Ac

derivative is positive for all t  t0 . It follows that (h  g )(t )  0 for all t  t0 . □
The second lemma applies the bound in Lemma A.1 to the expectation of the
function g (·) of a binomial variable.
Lemma A.2. Suppose that random variable B ~ Binomial(n, p) with np > 1 and
g (·) is the function defined in (A.2). Then

E[ g ( B)]  2(np)1/2 .

Proof of Lemma A.2.
Let h(·) be the function defined in (A.3) with t0  np  E[ B] . Lemma A.1 shows

ip

1


E[ g ( B)]  E[h( B)]  E (np) 1/2  (np) 3/2 ( B  E[ B])  (np ) 2 ( B  E[ B]) 2 
2


1
 (np) 1/2  (np) 3/2·0  (np) 2 Var[ B]
2
1/2
 (np)  (np) 2 (np)(1  p)

cr

 (np) 1/2  (np) 1  2(np) 1/2

us

because np > 1 implies p > 0 and (np)1  (np)1/2 . □
Let xl  {x1 ,, xl } be a finite set with l  1 points in

. Given a class of subsets

, define N (xl ) |{xl  G : G  }| be the number of different subsets of xl

an

in

t

that g (t )  h(t ) for all values in the support of B ( t {0,1, 2,} ), therefore

picked out by G  . The VC-dimension v  1 of

is defined by the largest l

M

such that sup N (xl )  2l holds (Vapnik (1998)). See Vapnik (1998), (Dudley, 1999,
xl

Chapter 4), and van der Vaart and Wellner (1996) for extensive discussions.

d

Note that the VC-dimension is smaller by one compared to the VC-index used to

pt
e

measure the complexity of a class of sets in empirical process theory, e.g.,
van der Vaart and Wellner (1996).

ce

Let Zi  (Yi , Di , X i )  , where

Ac

function f :

SG( f )  {( z, t )  





  0,1 

. The subgraph of a real-valued

is the set
: 0  t  f ( z) or f ( z)  t  0}.

The third lemma is reproduced from Kitagawa and Tetenov (2018b) (Lemma
A.1). It establishes a link between the VC-dimension of a class of subsets in the
covariate space
.

and the VC-dimension of a class of subgraphs of functions on

Lemma A.3. Let

be a VC-class of subsets of

g and h be two given functions from

to

with VC-dimension v   . Let

. Then the set of functions from

to
  fG ( z)  g ( z)·1 x G  h( z)·1 x G : G 



is a VC-subgraph class of functions with VC-dimension less than or equal to v.

ip

t

The fourth lemma, reproduced from Kitagawa and Tetenov (2018b) (Lemma

A.4), is a maximal inequalitiy that bounds the mean of a supremum of a centered

be a class of uniformly bounded functions, i.e., there exists

F   such that || f (  F for all f 

us

Lemma A.4. Let

cr

empirical process indexed by a VC-subgraph class of functions.

. Assume that

is a VC-subgraph class

pt
e

d

holds for all n  1 .

M

v


EPn sup En ( f )  EP ( f )   C1F
n
 f


an

with VC-dimension v   . Then, there is a universal constant C1 such that

The last novel lemma allows us to prove Theorem 3.1 for unbounded outcomes.

be a class of uniformly bounded functions, i.e., there exists

ce

Lemma A.5. Let

F   such that || f (  F for all f 

. Assume that

is a VC-subgraph class

with VC-dimension v   . Let (Y , Z ) ~ P , where Y  0 is a scalar (Y and Z may



Ac

be dependent). Let (Yi , Zi )i 1 ~ Pn be an i.i.d. sample from P. Assume that


0

n

P(Y  y )dy  M . (A.5)

Then, there is a universal constant CT such that





0



1 n
v
EPn sup  f ( Zi )1{Yi  y}  EP  f (Z )1{Y  y}  dy  CT FM
n
 f  n i 1


(A.6)

holds for all n  1 .
Proof of Lemma A.5. We start by deriving upper bounds for each value of y, y >
0, on

1 n
EPn n ( y) , n ( y)  sup  f ( Zi )1{Yi  y}  EP  f ( Z )1{Y  y} .
f  n i 1

ip

, hence

cr

1 n
1 n
f ( Zi )1{Yi  y}  F· 1{Yi  y} for any f 

n i 1
n i 1

t

First, consider values of y for which nP(Y  y)  1 . Due to the envelope condition,



1 n
EPn sup  f ( Zi )1{Yi  y}   F·EPn
 f  n i 1


us

1 n

 n 1{Yi  y}  FP(Y  y ).
 i 1


an

Also, EP  f (Z )1{Y  y}  P(Y  y) EP  f (Z ) | Y  y   FP(Y  y). It follows that

P(Y  y )
n

,

(A.7)

pt
e

 2 FP(Y  y)  2 F

d

M



1 n
EPn n ( y)  EPn sup  f ( Zi )1{Yi  y}   sup EP  f ( Z )1{Y  y}
 f  n i 1
 f

nP(Y  y)  1 .

ce

where the last inequality holds because

Second, we consider values of y for which nP(Y  y)  1 . Define random variables
n

Ac

N y  1{Yi  y} for the number of observations in the data with Yi  y , then
i 1

0
1 n

f ( Zi )1{Yi  y}   N y 1

n i 1
 n ·N
y


If N y  1 then

if N y  0,
n

 f (Z )1{Y  y}
i

i 1

i

if N y  1.

i 1

Ny
n

i

i

i 1

i

i

P

i 1

n

 f (Z )1{Y  y}
i

i

i 1

n

1
Ny

 f (Z )1{Y  y}  E  f (Z ) | Y  y 
i

i

P

i 1

cr

F

 f (Z )1{Y  y}

 f (Z )1{Y  y}  P(Y  y) E  f (Z ) | Y  y 

1

 P(Y  y ) sup
n
Ny
f

f

n

n

1
Ny

Ny

 P(Y  y ) sup

P

1
f ( Z i )1{Yi  y}  P(Y  y )
Ny



 P(Y  y )

i

 P (Y  y ) (the sum has N y non-zero terms, each bounded by F )

 P(Y  y ) sup
f

1
Ny

us

f

i

i 1

n

 f (Z )1{Y  y}  E  f (Z ) | Y  y  .
i

i

P

i 1

(A.8)

an

 sup

n

 f (Z )1{Y  y}  P(Y  y) E  f (Z ) | Y  y 

t

Ny 1
·
n Ny

n

ip

N 1
n ( y )  sup y ·
n Ny
f

Note that  Zi i:Y  y is an i.i.d. sample of size Ny from the conditional distribution

M

i

P(Z | Y  y) . We next apply the bound in Lemma A.4 for each value of N y  1 :


i 1


v
f ( Zi )1{Yi  y}  EP  f (Z ) | Y  y  N y   C1F
.
Ny


d

n

pt
e


1
EPn  sup
 f  N y

(A.9)

Combining inequality (A.8) with bound (A.9), and using the definition g (t )  t 1/2

ce

for t  1 from (A.2), we obtain a bound on the conditional expectation of n ( y ) for

Ac

Ny  1:

Ny
EPn n ( y) | N y   F
 P(Y  y)  P(Y  y )C1F vg ( N y ).
n
If Ny = 0 then 1{Yi  y}  0 for all i, hence

n ( y )  sup EP  f ( Z )1{Y  y}  P(Y  y )sup EP  f ( Z ) | Y  y 
f

 FP(Y  y )  F

f

Ny
n

 P(Y  y )  P(Y  y )C1F vg ( N y ),

(A.10)

where the last equality uses the definition g (0)  0 from (A.2). Therefore, the
conditional expectation bound (A.10) also holds for Ny = 0.
The unconditional expectation of n ( y ) is then bounded by

n

 P(Y  y )  P(Y  y )C1F vEPn  g ( N y )  .

(A.11)

t

Ny

ip

EPn n ( y)  FEPn

 Ny 
 P(Y  y)  Var   
n
 n 

Ny

P(Y  y)(1  P(Y  y))

n

P(Y  y)
.
n

us

EPn

cr

The random variable Ny has a Binomial(n, P(Y  y)) distribution, hence

an

2
Since nP(Y  y)  1 , applying Lemma A.2 yields EPn  g ( N y ) 
.
n P(Y  y )

P(Y  y )
2
 P(Y  y )C1F v
n
n P(Y  y )

d

EPn n ( y )  F

M

Combining this inequality with (A.11) and v  1 we obtain

(A.12)

ce

pt
e

v
v
 2(1  C1 ) F
P(Y  y )  CT F
P(Y  y ),
n
n

where CT  2(1  C1 ) . This bound is higher than the bound (A.7) derived for y

Ac

such that nP(Y  y)  1 , hence bound (A.12) holds for all y  0 .
The last step is to integrate the bound (A.12) over y and apply (A.5):





0

EPn n ( y) dy   CT F


0

v
v
P(Y  y )dy  CT FM
.
n
n

□

Proof of Theorem 3.1. Take an arbitrary set G*  , then

W (G* )  W (Gˆ )  W (G* )  Wˆ (Gˆ )  Wˆ (Gˆ )  W (Gˆ )
 W (G* )  Wˆ (G* )  Wˆ (Gˆ )  W (Gˆ )








 2sup Wˆ (G )  W (G ) ,
G

where the second line follows since Wˆ (Gˆ ) maximizes Wˆ (G) over G  . It
follows that
supW (G)  W (Gˆ )  2sup Wˆ (G)  W (G) .

ip

Since  (·) is convex and non-increasing,




0

0

G



 sup   ( FˆG ( y )  0)   ( FG ( y )) dy
0

an

G


  sup  ( FˆG ( y )  0)   ( FG ( y )) dy


0 G

d

(A.14)

M

0 G

|  (0) |  sup FˆG ( y )  FG ( y ) dy.

us

sup Wˆ (G )  W (G )  sup   ( FˆG ( y )  0)dy    ( FG ( y ))dy
G

t

(A.13)

G

cr

G

pt
e

Combining (A.13) and (A.14), the average welfare loss of Ĝ can be bounded by

ce




EPn sup W (G)  W (Gˆ )  2 | (0) |  EPn
0
 G


Ac

By Lemma A.3, the class of functions



FˆG ( y)  FG ( y)  dy.
sup
G

  wG (·) : G 

 D

1  Di
wG ( Zi )   i ·1{ X i G} 
·1{ X i G}
1  e( X i )
 e( X i )


(A.15)

 , where
(A.16)

is a VC-subgraph class with VC-dimension of at most v. Assumption 3.1 (SO)
1
 1
implies that wG ( Zi )  0,  , hence functions in
are uniformly bounded by .

 

n

1
Since FG ( y)  1  EP  wG (Z )·1{Y  y} and FˆG ( y)  1   wG ( Zi )·1{Yi  y} ,
n i 1

1 n
FˆG ( y)  FG ( y)   wG ( Zi )·1{Yi  y}  EP  wG ( Z )·1{Y  y} .
n i 1
It follows from Assumption 3.1 (TC) and
P(Y  y )dy  

0



0

P(Y1  y, D  1)  P(Y0  y, D  0)dy

t





a  b  a  b that



us

cr

ip

   P(Y1  y )  P(Y0  y ) dy  2.
0
(A.17)

an

Applying Lemma A.5 to (A.15) yields

M

 v


EPn sup W (G)  W (Gˆ )  4CT | (0) |
.
 n
 G


Setting C  4CT completes the proof of (3.8).

References

pt
e

d

The proof of (3.9) is found in the online supplement. □

ce

AABERGE, R., T. HAVNES, AND M. MOGSTAD (2018): “Ranking Intersecting

Ac

Distribution Functions,” Journal of Applied Econometrics, forthcoming.
ABADIE, A., J. ANGRIST, AND G. IMBENS (2002): “Instrumental Variables Estimates
of the Effect of Subsidized Training on the Quantiles of Trainee Earnings,”

Econometrica, 70, 91–117.
ATHEY, S. AND S. WAGER (2018): “Efficient Policy Learning,” arXiv preprint, arXiv
1702.0289.

ATKINSON, A. B. (1970): “On the measurement of inequality,” Journal of

Economic Theory, 2, 244 – 263.
BHATTACHARYA, D. AND P. DUPAS (2012): “Inferring Welfare Maximizing
Treatment Assignment under Budget Constraints,” Journal of Econometrics, 167,
168 – 196.
BITLER, M. P., J. B. GELBACH, AND H. W. HOYNES (2006): “What Mean Impacts

ip

t

Miss: Distributional Effects of Welfare Reform Experiments,” American Economic

cr

Review, 96, 988–1012.

BLACKORBY, C. AND D. DONALDSON (1978): “Measures of Relative Equality and

us

Their Meaning in Terms of Social Welfare,” Journal of Economic Theory, 18, 59–

an

80.

BLOOM, H. S., L. L. ORR, S. H. BELL, G. CAVE, F. DOOLITTLE, W. LIN, AND J. M. BOS

M

(1997): “The Benefits and Costs of JTPA Title II-A Programs: Key Findings from
the National Job Training Partnership Act Study,” Journal of Human Resources,

d

32, 549–576.

pt
e

CHAMBERLAIN, G. (2011): “Bayesian Aspects of Treatment Choice,” in The Oxford

Handbook of Bayesian Econometrics, ed. by J. Geweke, G. Koop, and H. van

ce

Dijk, Oxford University Press, 11–39.

Ac

COWELL, F. (1995): Measuring Inequality, Hemel Hempstead: Harvester
Wheatsheaf, 2 ed.
——— (2000): “Measurement of Inequality,” in Handbook of Income Distribution,
ed. by A. Atkinson and F. Bourguignon, Elsevier, vol. 1.
DEHEJIA (2005): “Program Evaluation as a Decision Problem,” Journal of

Econometrics, 125, 141–173.

DONALDSON, D. AND J. A. WEYMARK (1980): “A Single-Parameter Generalization
of the Gini Indices of Inequality,” Journal of Economic Theory, 22, 67–86.
——— (1983): “Ethically Flexible Gini Indices for Income Distributions in the
Continuum,” Journal of Economic Theory, 29, 353–358.
DUDLEY, R. (1999): Uniform Central Limit Theorems, Cambridge University

ip

t

Press.
FAN, Y. AND S. S. PARK (2010): “Sharp Bounds on the Distribution of Treatment

cr

Effects and Their Statistical Inference,” Econometric Theory, 26, 931–951.

us

FIRPO, S. AND C. PINTO (2016): “Identification and Estimation of Distributional

Applied Econometrics, 31, 457–486.

an

Impacts of Interventions Using Changes in Inequality Measures,” Journal of

M

FIRPO, S. AND G. RIDDER (2019): “Partial identification of the treatment effect
distribution and its functionals,” Journal of Econometrics, forthcoming.

d

HECKMAN, J. J., H. ICHIMURA, AND P. E. TODD (1997a): “Matching As An

pt
e

Econometric Evaluation Estimator: Evidence from Evaluating a Job Training
Programme,” The Review of Economic Studies, 64, 605–654.

ce

HECKMAN, J. J., J. SMITH, AND N. CLEMENTS (1997b): “Making The Most Out Of
Programme Evaluations and Social Experiments: Accounting For Heterogeneity

Ac

in Programme Impacts,” The Review of Economic Studies, 64, 487–535.
HIRANO, K. AND J. R. PORTER (2009): “Asymptotics for Statistical Treatment
Rules,” Econometrica, 77, 1683–1701.
IMBENS, G. W. (2004): “Nonparametric estimation of average treatment effects
under exogeneity: a review,” Review of Economics and Statistics, 86, 4–29.

KASY, M. (2016): “Partial Identification, Distributional Preferences, and the
Welfare Ranking of Policies,” Review of Economics and Statistics, 98, 111–131.
——— (2018): “Optimal taxation and insurance using machine learning Sufficient statistics and beyond,” Journal of Public Economics, 167, 205 – 219.
KITAGAWA, T. AND A. TETENOV (2018a): “Who Should Be Treated? Empirical
Welfare Maximization Methods for Treatment Choice,” Econometrica, 86, 591–

ip

t

616.

cr

——— (2018b): “Supplement to “Who Should Be Treated? Empirical Welfare

us

Maximization Methods for Treatment Choice”,” Econometrica.

LAMBERT, P. J. (2001): The Distribution and Redistribution of Income,

an

Manchester University Press, 3 ed.

M

MACHINA, M. (1982): “”Expected Utility” Analysis without the Independence
Axiom,” Econometrica, 50, 277–323.

d

MANSKI, C. F. (2004): “Statistical Treatment Rules for Heterogeneous

pt
e

Populations,” Econometrica, 72, 1221–1246.
MBAKOP, E. AND M. TABORD-MEEHAN (2018): “Model Selection for Treatment

ce

Choice: Penalized Welfare Maximization,” arXiv preprint, arXiv 1609.03167.

Ac

MEHRAN, F. (1976): “Linear Measures of Income Inequality,” Econometrica, 44,
805–09.

QUIGGIN, J. (1982): “A Theory of Anticipated Utility,” Journal of Economic

Behavior and Organization, 3, 323–343.
STOYE, J. (2009): “Minimax regret treatment choice with finite samples,” Journal

of Econometrics, 151, 70 – 81.

——— (2012): “Minimax regret treatment choice with covariates or with limited
validity of experiments,” Journal of Econometrics, 166, 138 – 156.
TETENOV, A. (2012): “Statistical treatment choice based on asymmetric minimax
regret criteria,” Journal of Econometrics, 166, 157–165.
VAN DER VAART, A.

W. AND J. A. WELLNER (1996): Weak Convergence and

ip

t

Empirical Processes, Springer.

cr

VAPNIK, V. N. (1998): Statistical Learning Theory, John Wiley & Sons.

WANG, L., Y. ZHOU, R. SONG, AND B. SHERWOOD (2018): “Quantile-Optimal

us

Treatment Regimes,” Journal of the American Statistical Association, 113, 1243–

an

1254.

WEYMARK, J. A. (1981): “Generalized gini inequality indices,” Mathematical

M

Social Sciences, 1, 409 – 430.

YAARI, M. E. (1988): “A controversial proposal concerning inequality

Ac

ce

pt
e

d

measurement,” Journal of Economic Theory, 44, 381 – 397.

t
ip
cr
us
an
M
d

pt
e

Fig. 1 Treatment rules from the quadrant class that maximize welfare functions

Ac

ce

from the extended Gini family (including the additive welfare)

t
ip
cr
us
an
M
d

Fig. 2 Treatment rules from the linear class that maximize welfare functions

Ac

ce

pt
e

from the extended Gini family (including the additive welfare)

t
ip
cr
us

an

Fig. 3 Quantile treatment effects of the Gini welfare maximizing rule compared

M

to the additive welfare maximizing rule. Treatment rules from the quadrant class.

Table 1 Estimated representative income under alternative treatment rules

Ac

ce

pt
e

d

that condition on education and pre-program earnings.

t
ip
cr
us
an

Treatment rule:

income

Proportion
Gini

Average (k=2) (k=3)

Gini

to be

(k=6)

treated

$15,311

$6,769 $1,561 0

$16,487

$7,423 $1,786 1

$16,646

$7,490 $1,807 95%

Maximize standard Gini SWF (k=3)

$16,462

$7,522 $1,828 80%

Maximize extended Gini SWF (k=6)

$16,153

$7,388 $1,835 52%

Maximize average income

$16,670

$7,528 $1,820 96%

Maximize standard Gini SWF (k=3)

$16,489

$7,537 $1,839 78%

Maximize extended Gini SWF (k=6)

$16,154

$7,405 $1,852 51%

M

Treat no one

Representative

Treat everyone

ce

pt

Maximize average income

ed

Quadrant class conditioning on years of education and pre-program earnings

Ac

Linear class conditioning on years of education and pre-program earnings

