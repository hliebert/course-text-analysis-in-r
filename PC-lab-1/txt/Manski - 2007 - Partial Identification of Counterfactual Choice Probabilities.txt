INTERNATIONAL ECONOMIC REVIEW
Vol. 48, No. 4, November 2007

PARTIAL IDENTIFICATION OF COUNTERFACTUAL
CHOICE PROBABILITIES∗
BY CHARLES F. MANSKI1
Northwestern University, U.S.A.
This article shows how to predict counterfactual discrete choice behavior when
the presumed behavioral model partially identifies choice probabilities. The simple, general approach uses observable choice probabilities to partially infer the
distribution of types in the population and then applies the results to predict behavior in unrealized choice settings. Two illustrative applications are given. One
assumes only that persons have strict preferences. The other assumes strict preferences and utility functions that are linear in attribute bundles, with no restrictions
on the shape of the distribution of preference parameters.

1.

INTRODUCTION

From the early 1970s on, applied economists have used parametric random utility models (RUMs) to interpret observed discrete-choice behavior and to predict
the choices that persons would make in counterfactual choice settings. McFadden
(1974) initiated what has become the standard econometric implementation of
discrete choice analysis. One poses an RUM that characterizes alternatives as attribute bundles and that specifies the population distribution of preferences over
attribute bundles up to a point-identified parameter vector. One uses data on
observed choices to estimate the parameters of the preference distribution. One
then applies the estimated RUM to infer the choice probabilities that would occur
in counterfactual settings of interest.
McFadden originally embodied this vision of discrete choice analysis in the
remarkably tractable conditional logit model, which has remained prominent in
applications through the present day. The severe preference assumptions of the
logit model were apparent from the outset, and econometricians have mainly responded by studying more flexible parametric RUMs that point-identify counterfactual choice probabilities. Advances in computing technology and development
of new estimation methods have steadily expanded the menu of tractable models.
Thus, we now have multinomial probit models (e.g., Daganzo et al., 1977; Hausman
and Wise, 1978; Lerman and Manski, 1981; Berry et al., 1994), nested logit and
∗

Manuscript received September 2005.
This research was supported in part by National Science Foundation grant SES-0549544. I am
grateful to Ben Handel for able research assistance and to Guido Imbens and Alex Tetenov for
comments. I have benefitted from the opportunity to present this work in seminars at the California Institute of Technology, Northwestern University, the Tinbergen Institute, and University College
London. Please address correspondence to: Charles F. Manski, Department of Economics, Northwestern University, 2001 Sheridan Road, Evanston, IL 60208-2600, U.S.A. Phone: 847-491-8223. Fax:
847-491-7001. E-mail: cfmanski@northwestern.edu.
1

1393

1394

MANSKI

generalized extreme value models (McFadden, 1978, 1981), and mixed logit models (McFadden and Train, 2000). A separate stream of research has studied
semiparametric and nonparametric RUMs that point-identify choice probabilities when the population is observed to face a sufficiently rich variety of choice
sets. See, for example, Cosslett (1983) and Matzkin (1992).
However hard econometricians may work to develop new specifications for
RUMs, strong predictive power inevitably requires strong assumptions. And there
is no escaping what I have called the Law of Decreasing Credibility: The credibility
of inference decreases with the strength of the assumptions maintained (Manski,
2003). Researchers concerned with the credibility of discrete choice analysis need
to understand the tension between predictive power and strength of assumptions.
And they should be willing, to some degree, to give up predictive power in return for enhanced credibility. These considerations lead naturally to the study of
behavioral models that partially identify counterfactual choice probabilities, the
subject of this article.
In the econometric literature on discrete choice analysis, the closest precedent
for methodological research of the type to be presented here is my own early
investigation of a semiparametric RUM that reveals the ordering of choice probabilities across alternatives, but not their magnitudes (Manski, 1975, 1988). Although the associated body of work on maximum score estimation mainly studies
point-identification and estimation of the parametric part of these models, Manski
(1988, Section 3) considered counterfactual prediction in binary choice settings
and did not presume that the parametric part of the model is point identified. Less
direct precedents, but still relevant, are some recent papers that study partial identification of RUM parameters in certain observational settings; see Manski and
Tamer (2002), Honoré and Tamer (2006), and Magnac and Maurin (2007). These
papers do not study counterfactual prediction, but their findings can be applied
to that purpose.
A distinct precedent is a body of research on RUMs stemming from Marschak
(1960). Marschak asked what restrictions on binary choice probabilities are implied by the elementary RUM assumptions that persons behave rationally and
have strict preference orderings over alternatives. Considering a setting with a
universe of three alternatives, say (c, d, e), Marschak showed that the three binarypreference probabilities P(c  d),P(d  e), and P(c  e) satisfy the triangular
condition P(c  e) ≤ P(c  d) + P(d  e). He proposed use of this inequality to
test the hypothesis that the population obeys an RUM with strict preferences.
Marschak did not study counterfactual prediction, but his finding can be applied
to that purpose. I explain how in Section 3.2.
The contribution of this article is achieved by first going back to basics and then
moving forward to develop a simple new approach to counterfactual prediction.
To go back to basics, Section 2 frames prediction of choice behavior as a problem of
predicting treatment response, the treatment being a choice set and the response
being the chosen alternative. The language and notation of analysis of treatment
response make clear how choice data, assumptions about the process generating
observed choice sets, and behavioral models combine to enable counterfactual
prediction.

COUNTERFACTUAL CHOICE PROBABILITIES

1395

The new approach to prediction is presented in Section 3. I consider situations
with a finite universe of alternatives. In these situations, there exists a finite set
of logically possible types, each type having a distinct choice function. Behavioral
models and choice data place restrictions on the distribution of types within the
population. These restrictions enable partial prediction of population behavior in
counterfactual settings. I show that when a behavioral model places linear equality
or inequality restrictions on the distribution of types, the identification region for
a counterfactual choice probability is an interval whose lower and upper bounds
solve two linear programming problems.
Aside from the finiteness of the universe of alternatives, the prediction approach
is entirely general. I present two illustrative cases. In the first, the behavioral model
assumes that all members of the population have strict preference orderings over
the universe of alternatives. This is the setup in Marschak (1960) and I re-derive
his triangular condition. In the second case, the behavioral model characterizes
alternatives as attribute bundles and assumes that each member of the population
has a utility function that is linear in parameters. I show that partial prediction
of counterfactual behavior is possible whenever the distribution of preference
parameters is continuous—one need not assume anything about the shape of this
distribution.
Section 4 considers statistical inference when one observes the choices made by
a random sample of the population. Here I develop finite-sample confidence sets
for partially identified counterfactual choice probabilities. Section 5 concludes.

2.

CHOICE AS TREATMENT RESPONSE

Research on discrete choice has not previously used the language and notation
of the analysis of treatment response, but it is easy to define concepts in those terms
and helpful to do so.2 I show how here and introduce the type of counterfactual
prediction problem studied in this article.
The standard treatment-response setting begins with a population J and a set of
potential treatments T. Each person j ∈ J has a response function y j (·) : T → Y
mapping treatments t ∈ T into outcomes y j (t) ∈ Y. Persons may also have observable covariates, but I suppress them to simplify notation.
The population is a “large” probability space (J, , P), in the sense that J
is uncountable and P(j) = 0, j ∈ J . The probability distribution P[y(·)] of the
random function y(·) : T → Y describes treatment response across the population.
Person j actually receives some treatment z j ∈ T and realizes the outcome
y j ≡ y j (z j ). The outcomes [y j (t), t = z j ] that would have been experienced under other treatments are counterfactual. Observation of the population reveals
the population distribution P(z, y) of realized treatments and outcomes. The problem is to predict the counterfactual outcomes that would occur if members of the
population were to receive unrealized treatments.
2 The language and notation of analysis of treatment response has previously been used to describe
classical demand settings, where the problem is to choose the quantity of a homogeneous commodity.
There the treatment is the price of the commodity, which indexes the budget set, and the response is
the quantity demanded at that price. See Manski (1995, Chapter 6, 1997) and Angrist et al. (2000).

1396

MANSKI

In the case of discrete choice, one begins with a population J and a universe
of distinct alternatives A. Distinct alternatives need not be qualitatively different,
as in the proverbial “apples and oranges.” They may carry the same commonlanguage name but differ quantitatively in their attributes. For example, they may
be eggs that vary in size and price.
The set of potential treatments T is the set of all nonempty finite subsets of A,
each of which is a possible choice set. The response function y j (·) is a choice function specifying the alternative that person j would choose when facing any choice
set. Thus, yj (C) is the alternative that person j would choose if he were to face set
C. The realized choice made by person j is y j ≡ y j (z j ), where zj is the choice set
that this person actually faces. The problem is to predict the counterfactual choices
that would occur if members of the population were to face unrealized choice
sets.3
This article considers prediction of behavior in a counterfactual scenario where
all persons face the same choice set, again denoted C. The objective is to predict the
fraction of the population who would choose a specified alternative c ∈ C. Thus,
the problem is to learn the counterfactual choice probability P[y(C) = c]. Scenarios
where counterfactual choice sets vary across the population are notationally more
complex, but the approach to be developed applies to them as well.
As a prelude, consider the prediction problem using choice data alone. The Law
of Total Probability and the definition y ≡ y(z) give
(1)

P[y(C) = c] = P[y(C) = c | z = C]P(z = C) + P[y(C) = c | z = C]P(z = C)
= P(y = c | z = C)P(z = C) + P[y(C) = c | z = C]P(z = C).

Realized choice sets and choices are observable, so choice data can reveal P(y =
c | z = C) and P(z) but not P[y(C) = c | z = C]. Hence, one may conclude that
(2)

P[y(C) = c] ∈ [P(y = c | z= C)P(z= C),P(y = c | z= C)P(z= C)+ P(z = C)].

This is the standard result for prediction of treatment response using empirical
evidence alone (Manski, 1990, 2003, Chapter 7), applied here to prediction of
choice behavior.
The above shows that if a positive fraction of the population actually faces choice
set C, the counterfactual choice probability P[y(C) = c] is partially identified using
choice data alone. However, it is common in discrete choice analysis to want to
predict behavior when C differs from all realized choice sets. Then P(z = C) = 0
and Equation (2) becomes the uninformative statement that P[y(C) = c] ∈ [0,1].
This formalizes the obvious fact that data on observed choices alone reveal nothing
about behavior in an entirely counterfactual choice setting. Prediction is possible
only when the choice data are combined with assumptions that have identifying
power. This article studies prediction with such assumptions.
3 The assumption that each person actually faces one choice set is standard in econometric analysis
of discrete choice. It is also standard in analysis of treatment response more broadly, as treatments are
defined to be mutually exclusive. This assumption is not maintained in Samuelson’s version of revealed
preference analysis, which supposes that one can observe how a person with fixed preferences would
behave in multiple choice settings (Samuelson, 1948; Afriat, 1967).

COUNTERFACTUAL CHOICE PROBABILITIES

1397

It is useful to distinguish assumptions about the process generating observed
choice sets from ones on the decision rules that persons use when facing specified
choice sets. This article maintains the usual “exogenous choice set” assumption
that realized choice sets z and choice functions y(·) are statistically independent.
That is,
P[y(·)] = P[y(·) | z].

(3)

When considering assumptions about the decision rules that persons use, it
is useful to distinguish assumptions restricting the set of types found within the
population from assumptions on the shape of the distribution of types. A type is
defined by a choice function. All persons who share the same choice function are
of the same type.
In the econometric literature on discrete choice, assumptions restricting the
set of types appear through the basic RUM assumption that all members of the
population behave rationally and the common additional assumption that utility
functions are linear in person-specific parameters. Assumptions on the shape of
the distribution of types appear when researchers suppose that the distribution of
preference parameters is, say, Type I extreme value or multivariate normal.
To keep attention focused on the identification problem at the heart of counterfactual prediction, I suppose in Section 3 that the observable distribution
P(z, y) of realized treatments and outcomes is known. Section 4 addresses statistical inference when P(z, y) must be inferred from sample data.

3.

PREDICTION WITH A FINITE UNIVERSE OF ALTERNATIVES

3.1. Anatomy of the Problem. The relevant universe of alternatives for counterfactual prediction comprises all alternatives that appear in a realized choice set
or the counterfactual choice set. Let (Dm, m ∈ M) denote the collection of realized
choice sets in the population of interest. The objective is to predict choice from a
counterfactual choice set C. Hence, the relevant universe is A = C ∪ (Dm,m ∈ M).
The basic maintained assumption of the present analysis is that M, hence A, is
finite.4 Finiteness of A implies that there are finitely many possible choice sets,
specifically 2|A| − 1 many. Hence, there are finitely many distinct choice functions.
Let yk(·) be the choice function for persons of type k. Let K denote the set of logically possible types. Let π k denote the fraction of the population who are of type
k. Then π ≡ (π k, k ∈ K) is the multinomial distribution of types. A behavioral
model is an assumption that π lies in some specified set of distributions, say .
The objective is to learn about a counterfactual choice probability P[y(C) = c],
where c ∈ C. This probability is related to π by the linear equation

P[y(C) = c] =
(4)
1[yk(C) = c] · πk.
k∈K
4 It is natural to want to extend the present analysis to settings with infinite universes of alternatives.
I am tempted to assert that such extensions should be possible with sufficient attention to regularity
conditions and technical details. However, I think it more prudent to simply say that the question is
open.

1398

MANSKI

What is known about π? Members of the population face the realized choice
sets (Dm, m ∈ M). Under the maintained statistical independence Assumption 3,
choice data reveal the choice probabilities P[y(Dm ) = d], d ∈ Dm , m ∈ M.5 These
probabilities are related to π through the equations6

(5)
P[y(Dm) = d] =
1[yk(Dm) = d] · πk, d ∈ Dm, m ∈ M.
k∈K

Distribution π necessarily solves the logical adding-up and nonnegativity conditions

(6)
πk = 1; πk ≥ 0, k ∈ K.
k∈K

Finally, the behavioral model assumes that
(7)

π ∈ .

The identification region for π is the set H(π ) of values of π that solve (5),
(6), and (7). If the behavioral model is correct, then H(π ) is nonempty. If H(π)
is empty, the behavioral model is incorrect. Supposing the model to be correct, π
is point identified if H(π ) is a singleton. It is partially identified if H(π ) is not a
singleton but is a proper subset of the space of all multinomial distributions on
the set of logically possible types.
The identification region for P[y(C) = c] follows immediately from H(π ). It is
the set



H{P[y(C) = c]} =
(8)
1[yk(C) = c] · λk, λ ∈ H(π )
k∈K

obtained by applying Equation (4) with all feasible values of π .
5 In econometric analysis of discrete choice, realized choice sets often vary systematically across
subpopulations of persons with different covariates. For example, choice sets may vary geographically,
or persons with higher income may face larger choice sets than persons with lower income. Assumption 3 supposes that choice-set variation is statistically independent of preferences. For example, if
choice sets vary geographically, it supposes that the residents of different areas have the same distribution of types. This assumption is maintained in most econometric analysis of discrete choice, implicitly
if not explicitly.
Inference on π is much more difficult without Assumption 3. Then Equation (5) below does not
hold because choice data reveal only P[y(Dm ) = d | z = Dm ], d ∈ Dm , m ∈ M. These conditional choice
probabilities are related to π through the equations

P[y(Dm) = d | z = Dm] =
1[yk(Dm) = d] · πkm, d ∈ Dm, m ∈ M,
k∈K

where π km is the fraction of type k within the subpopulation of persons who face choice set Dm .
6 For each m ∈ M, the choice probabilities P[y(D ) = d], d ∈ D sum to one. Hence, the collection
m
m
of equations in (5) contains redundancies. These are harmless, so I do not remove them here. However,
I will do so in Section 4 when constructing confidence sets.

COUNTERFACTUAL CHOICE PROBABILITIES

1399

3.1.1. Linear behavioral models. I shall say that a behavioral model is linear
if  is a set of multinomial distributions that satisfies specified linear equalities
or inequalities. Particularly common in applications are models assuming that the
population does not contain some types K0 . These are linear models that set π k =
0, k ∈ K0 .
The identification regions resulting from linear models have simple structures.
Set H(π ) is convex. Convexity of H(π) and linearity of Equation (4) in π imply
that the set H{P[y(C) = c]} is an interval. The lower and upper bounds of this
interval solve two linear programming problems. The lower bound solves
min

(9)

λ



1[yk(C) = c] · λk

k∈K

subject to
P[y(Dm) = d] =



1[yk(Dm) = d] · λk,

d ∈ Dm,m ∈ M,

k∈K



λk = 1; λk ≥ 0, k ∈ K; λ ∈ .

k∈K

The upper bound solves the analogous problem, with a max replacing the min in
(9).
When the behavioral model is not linear, minimization problem (9) still gives the
sharp lower bound on P[y(C) = c], and the corresponding maximization problem
gives the sharp upper bound. However, the identification region may or may not
be the entire interval connecting these bounds, depending on the structure of .
3.2. Random Utility Models with Strict Preferences. As a first application
of Section 3.1, assume that all members of the population have strict preference
orderings on A. This is a linear behavioral model that excludes all types whose
choice functions are not consistent with a strict preference ordering. There are
|A|! strict preference orderings on A, hence this many feasible types.7
The simplest nontrivial case occurs when A has three elements, say (c, d, e). Then
there are six feasible types, with preference orderings (c  d  e), (c  e  d),
(d  c  e), (d  e  c), (e  c  d), and (e  d  c). There are four nontrivial
choice sets, these being (c, d, e), (c, d), (c, e), and (d, e). The relationship between
choice probabilities and the distribution of preferences is as follows:
(10a)

P[y(c, d, e) = c] = P(c  d  e) + P(c  e  d),

7 The assumption that all persons have strict preference orderings can be weakened. However, when
considering prediction with RUMs, it is essential that at least some positive fraction of preference
orderings be strict rather than weak. The concept of rationality makes no prediction about choice
among equally ranked alternatives. An RUM that permits an unknown fraction of the population to
be indifferent among all elements of A is vacuous.

1400

MANSKI

(10b)

P[y(c, d, e) = d] = P(d  c  e) + P(d  e  c),

(10c)

P[y(c, d, e) = e] = P(e  c  d) + P(e  d  c),

(11a)

P[y(c, d) = c] = P(c  d  e) + P(c  e  d) + P(e  c  d),

(11b)

P[y(c, d) = d] = P(d  c  e) + P(d  e  c) + P(e  d  c),

(12a)

P[y(c, e) = c] = P(c  d  e) + P(c  e  d) + P(d  c  e),

(12b)

P[y(c, e) = e] = P(e  d  c) + P(e  c  d) + P(d  e  c),

(13a)

P[y(d, e) = d] = P(c  d  e) + P(d  e  c) + P(d  c  e),

(13b)

P[y(d, e) = e] = P(c  e  d) + P(e  d  c) + P(e  c  d).

With this as background, we can study counterfactual prediction given observation of choice behavior from different choice sets. Here are two examples.
3.2.1. All persons face (c, d, e) and the objective is to predict choice from (c, d).
The empirical evidence reveals P[y(c, d, e)]. Hence, Equation (5) takes the form
(10). Combining (10a) and (11a) gives
(14)

P[y(c, d) = c] = P[y(c, d, e) = c] + P(e  c  d).

Equation (10c) shows that 0 ≤ P(e  c  d) ≤ P[y(c,d, e) = e]. This bound is
sharp. Hence,
(15)

P[y(c, d, e) = c] ≤ P[y(c, d) = c] ≤ P[y(c, d, e) = c] + P[y(c, d, e) = e].

In words, if alternative e were eliminated from choice set (c, d, e), the persons
who chose c or d would not change their behavior. The persons who chose e now
must choose either c or d. The lower bound on P[y(c, d) = c] occurs if they would
all choose d and the upper bound if they would all choose c.
3.2.2. Some persons face (c, d), some face (d, e), and the objective is to predict
choice from (c, e). Given statistical independence Assumption 3, the empirical
evidence reveals P[y(c, d)] and P[y(d, e)]. Hence, Equation (5) takes the form
(11) and (13). Combining (11a) and (12a) gives
(16)

P[y(c, e) = c] = P[y(c, d) = c] − P(e  c  d) + P(d  c  e).

Equations (11b) and (13a) shows that 0 ≤ P(d  c  e) ≤ min{P[y(c, d) =
d],P[y(d, e) = d]}. Equations (11a) and (13b) show that 0 ≤ P(e  c  d) ≤
min{P[y(c, d) = c],P[y(d, e) = e]}. Hence,

COUNTERFACTUAL CHOICE PROBABILITIES

(17)

1401

max{0, P[y(c, d) = c] − P[y(d, e) = e]} ≤ P[y(c, e) = c]
≤ min{1, P[y(c, d) = c] + P[y(d, e) = d]}.

Letting S ≡ P[y(c, d) = c] + P[y(d, e) = d], bound (17) can be written more concisely as


(17 )

max(0,S − 1) ≤ P[y(c, e) = c] ≤ min (1,S).

Thus, the lower bound is informative when S > 1 and converges to one as S →
2. The upper bound is informative when S < 1 and converges to zero as S → 0.
It remains to show that the bound is sharp. This is so if there exist distributions
of types that solve (11) and (13) and that make P[y(c, e) = c] equal the lower
and upper bounds. It suffices to consider the lower bound, as the upper bound on
P[y(c, e) = c] equals one minus the lower bound on P[y(c, e) = e]. There are two
cases to consider. If P[y(c, d) = c] ≥ P[y(d, e) = e], the lower bound is achieved
when
P(c  d  e) = P[y(c, d) = c] − P[y(d, e) = e], P(c  e  d) = 0,
P(d  c  e) = 0,

P(d  e  c) = P[y(c, d) = d],

P(e  c  d) = P[y(d, e) = e],

P(e  d  c) = 0.

If P[y(c, d) = c] ≤ P[y(d, e) = e], it is achieved when
P(c  d  e) = 0,

P(c  e  d) = 0,

P(d  c  e) = 0,

P(d  e  c) = P[y(d, e) = d],

P(e  c  d) = P[y(c, d) = c], P(e  d  c) = P[y(d, e) = e] − P[y(c, d) = c].
Bound (17) is the triangular condition of Marschak (1960). Marschak’s use of
the bound presumed that one observes all the binary choice probabilities P[y(c,
d) = c], P[y(d, e) = d], and P[y(c, e) = c]. His objective was to test the consistency
of these choice probabilities with a strict-preference RUM. They are consistent
with such an RUM if and only if P[y(c, e) = c] lies within the bound. A subsequent
body of research extends Marschak’s work to settings in which the universe A
contains more than three alternatives and one observes the choice probabilities
for all binary subsets of A. Fishburn (1992) and McFadden (2005) review this
literature.8
8 The triangular condition clearly holds when A contains more than three alternatives. That is, given
any three-element subset of A, say (c, d, e), the binary choice probabilities P[y(c, d) = c], P[y(d, e) = d],
and P[y(c, e) = c] are consistent with a strict-preference RUM only if bound (17) holds. The question
addressed in the literature is the sufficiency of the triangular condition when A contains more than
three alternatives. That is, if the triangular condition holds for all three-element subsets of A, does
this imply consistency of the choice data with a strict-preference RUM? This question turns out to be
subtle, the answer being positive if A contains fewer than six alternatives but not otherwise.

1402

MANSKI

3.3. Linear Utility Models with Random Coefficients. The strict preference
assumption per se has no power to identify the choice probability for an alternative
that appears in no realized choice set. Suppose, for example, that the only realized
choice set is (d, e) and that the objective is to predict behavior when the choice
set is (c, d, e). The quantity P[y(c, d, e) = c] can lie anywhere in the interval [0, 1].
To enable prediction of behavior when choice sets contain new alternatives,
econometricians have often characterized alternatives as observable attribute
bundles, presumed that persons maximize utility functions defined on attribute
bundles, and assumed that the distribution of utility functions has specified properties. Leading cases were cited in Section 1.
As a second application of Section 3.1, I now characterize alternatives as attribute bundles and assume that almost all members of the population have linear
utility functions.9 Thus, each alternative d now is characterized by a distinct observable attribute vector wd and the utility of d to person j is uj (d) = w d θ j , where θ j
is the person’s vector of preference parameters. For example, in a study of choice
among travel modes, the attributes characterizing an alternative may be (travel
time, travel cost, vehicle class), where vehicle class distinguishes car from bus.
In contrast to prevailing econometric practice, I assume nothing about the shape
of the population distribution of θ . I only assume that almost all members of
the population have strict preference orderings. A sufficient but not necessary
condition for almost-everywhere strict preferences is continuity of the distribution
of utility, as has routinely been assumed in the literature. However, it is important
to understand that continuity of the distribution of utility does not imply that the
population contains a continuum of types. When the universe of alternatives is
finite, all persons with sufficiently similar utility functions have the same choice
function. Hence, the set of types is finite.
Let A , ∈ L, denote the |A|! distinct ordered representations of set A. Let w n
be the attribute bundle of the nth element of the ordered set A . Let be the
space of parameter values that the researcher deems feasible. Let
(18)

≡ [θ ∈

: w 1θ > w 2θ · · · > w

|A| θ ]

be the parameter values that generate preference ordering A . All persons with
θ∈
are of the same type.
When does a linear utility model have identifying power? A model has no power
if all of the sets , ∈ L are nonempty. Then every strict preference ordering is
representable through a linear utility function. A model may have identifying
power if some of the sets , ∈ L are empty. Then some strict preference orderings are not representable through linear utility functions.
When is
empty? There appears to be no succinct necessary and sufficient
condition, as
depends jointly on the parameter space and the set (w d , d ∈
A) of attribute bundles. However, a simple sufficient condition is that A contain
9 The reader should not interpret my consideration of linear utility as an endorsement of this
functional form. I examine linear utility because it is ubiquitous in applied research and because it
enables a simple illustration of general ideas.

COUNTERFACTUAL CHOICE PROBABILITIES

1403

an element n such that w n is a convex combination
of the attribute bundles that

=
α
w
precede
it
in
order
.
Suppose
that
w
n
i
i , where (αi ≥ 0, i < n) and
i<n

α
=
1.
Then
min
w
θ
≤
w
θ
≤
max
w
θ
for all values of θ . Thus,
i
i<n
in
n
i<n
in
i<n
there exists no value of θ such that all of the alternatives i < n are preferred to
n. The same reasoning applies when w n is a convex combination of the attribute
bundles that follow it in order .
With this as background, let A , ∈ L∗ denote the feasible ordered representations of set A; that is, those such that
is nonempty. All θ ∈
yield the same
choice function. Hence, without loss of generality, we can select any value θ ∈
and proceed as if all persons with θ ∈
have parameter θ . Thus, an assumption that the distribution of θ is continuous is observationally equivalent to the
assumption that this distribution has the finite support (θ , ∈ L∗ ).
Now consider the prediction problem. The objective is to learn P[y(C) = c].
Equation (4) becomes
(19)

P[y(C) = c] =


∈L∗

1[w c θ ≥ wd θ , d ∈ C] · π .

Equation (5) becomes
(20)

P[y(Dm) = d] =


∈L∗

1[w d θ ≥ we θ , e ∈ Dm] · π , d ∈ Dm,m ∈ M.

To perform prediction, one would first determine L∗ , next apply (20) to obtain
the identification region for π, and then insert the feasible values of π into (19)
to determine the feasible values of P[y(C) = c].
3.3.1. Models with two attributes. Equations (19) and (20) simplify when
there are two attributes and the sign of some element of the coefficient vector
is known to be homogeneous across types. For example, the first attribute might
measure the quality of a product and the second its price. Then it is reasonable
to assume that all persons value the first attribute positively and the second negatively. Thus, = [θ : θ 1 > 0 and θ2 < 0].
Let u (d) = θ 1 wd1 + θ 2 wd2 and normalize the scale of preferences by setting
θ 1 = 1. Assume that wc2 = wd2 for d = c. Then (19) becomes
(21)
P[y(C) = c] =


∈L∗

1[w c1 + θ 2 wc2 ≥ wd1 + θ 2 wd2 , d ∈ C] · π

= P[θ 2 ≥ (w d1 − wc1 )/(w c2 − wd2 )] if wc2 − wd2 > 0,
≤ (wd1 − wc1 )/(w c2 − wd2 ) if wc2 − wd2 < 0; d ∈ C, d = c]
= P[r (c, C) ≤ θ2 ≤ s(c, C)],

1404

MANSKI

where
r (c, C) ≡
s(c, C) ≡

max

(w d1 − wc1 )/(w c2 − wd2 ) and

min

(w d1 − wc1 )/(w c2 − wd2 ).

d∈C:(w c2 −wd2 )>0
d∈C:(w c2 −wd2 )<0

Similarly, (20) becomes
(22)

P[y(Dm) = d] = P[r (d,Dm) ≤ θ2 ≤ s(d, Dm)],

d ∈ Dm, m ∈ M.

Thus, the counterfactual P[y(C) = c] is the probability that θ 2 lies in the interval
[r(c, C), s(c, C)]. Choice data reveal the probability that θ2 lies in each of the
intervals [r(d, Dm ), s(d, Dm )], d ∈ Dm , m ∈ M. Knowledge of the latter probabilities
may imply restrictions on the former one.
3.3.2. Numerical examples. Here are some examples that illustrate prediction with two attributes, the first being quality and the second being price. Normalize the scale of preferences by setting θ j1 = 1 for all j ∈ J. Let θ2 be distributed
uniform on the interval [−4, −0.25]. Let A = (a, b, c, d, e), with w a = (0, 0), w b =
(1, 1), wc = (0.25, 0.5), w d = (0.75, 1.25), and w e = (1.5, 2).
First suppose that choice probabilities are observed for choice sets (a, b), (a, c),
(a, d), and (b, c). Let the counterfactual choice set be (a, e). The assumed uniform
distribution of price preferences implies that the observed choice probabilities are
P[y(a, b) = a] = 0.8,
P[y(a, d) = a] = 0.91,

P[y(a, c) = a] = 0.93,
P[y(b, c) = b] = 0.33.

The counterfactual choice probability is P[y(a, e) = a] = 0.87. Its identification
region, which is computed using only knowledge of the observed choice probabilities, is P[y(a, e) = a] ∈ [0.8, 0.91].
Next consider the same observed choice sets and let the counterfactual choice
set be (c, d, e). The counterfactual choice probabilities are
P[y(c, d, e) = c] = 0.84,

P[y(c, d, e) = d] = 0,

P[y(c, d, e) = e] = 0.16.

Their identification regions are
P[y(c, d, e) = c] ∈ [0.8, 0.91],

P[y(c, d, e) = d] = 0,

P[y(c, d, e) = e] ∈ [0.09, 0.2].
The choice probability for d must be zero because no value of θ2 makes this
alternative preferred to both c and e. Alternative d is preferred to c if θ2 > −2/3,
and it is preferred to e if θ2 < −1.
Finally suppose that choice probabilities are observed for choice sets (a, b, c),
(a, c, d), and (b, c, d). Let the counterfactual choice set be (a, b, e). The assumed
distribution of preferences implies that the observed choice probabilities are

COUNTERFACTUAL CHOICE PROBABILITIES

P[y(a, b, c) = a] = 0.8,

P[y(a, b, c) = b] = 0.2,

P[y(a, c, d) = a] = 0.91,

P[y(a, c, d) = c] = 0,

P[y(b, c, d) = b] = 0.33,

P[y(b, c, d) = c] = 0.67,

1405

P[y(a, b, c) = c] = 0.
P[y(a, c, d) = d] = 0.09.
P[y(b, c, d) = d] = 0.

The counterfactual choice probabilities are
P[y(a, b, e) = a] = 0.8,

P[y(a, b, e) = b] = 0.13,

P[y(a, b, e) = e] = 0.07.

Their identification regions are
P[y(a, b, e) = a] = 0.8, P[y(a, b, e) = b] ∈ [0.11, 0.2], P[y(a, b, e) = e] ∈ [0, 0.09].

4.

FINITE-SAMPLE CONFIDENCE SETS

Suppose that one does not observe the choice probabilities P[y(Dm ) = d], d ∈
Dm , m ∈ M. Instead one observes the choices made by a random sample of the
population. Then the counterfactual prediction problem involves statistical inference.
A growing literature develops asymptotically valid confidence sets for partially
identified parameters; see Beresteanu and Molinari (2006), Chernozukhov et al.
(2007), Horowitz and Manski (2000), Imbens and Manski (2004), and Rosen
(2006), among others. Some of the approaches proposed in this literature apply to the present counterfactual prediction problem. However, the structure of
the present problem is so simple that one does not need to resort to asymptotics.
I show here how to develop confidence sets that are valid for all sample sizes.
4.1. Observed Binary Choice Sets. I first consider settings where all observed
choice sets have two alternatives. Consider Equation (5). For each m ∈ M, let (dm ,
em ) denote the two elements of Dm . Then (5) takes the form
(23)

P[y(Dm) = dm] =



1[yk(Dm) = dm] · πk

, m ∈ M.

k∈K

We need not consider the analogous equation for P[y(Dm ) = em ] because it is
redundant, the choice probabilities for dm and em necessarily summing to one.
Let pm ≡ P[y(Dm ) = dm ] and p ≡ (pm , m ∈ M). Let N m be the number of sample
members facing choice set Dm and ȳm be the empirical frequency of choice of
alternative dm . The problem is to use knowledge of [( ȳm, N m ), m ∈ M] to construct
a confidence set for the vector p of choice probabilities. Conditional on the sample
sizes, the components of ( ȳm, m ∈ M) are statistically independent of one another.

1406

MANSKI

Hence, it suffices to consider each value of m separately and use knowledge of
( ȳm, N m ) to construct a confidence set for pm . The coverage probability for p of the
Cartesian product of these sets then equals the product of their separate coverage
probabilities.
Use of random-sample data to construct a confidence set for the probability
of an event is among the most basic problems of statistical inference, and the
literature offers many alternative procedures. Let α m ∈ (0, 1) be a desired coverage
probability for pm . To enable finite-sample inference, we want a procedure whose
confidence coefficient (infimum of the coverage probabilities across all feasible
values of pm ) is known to be at least α m . Clopper and Pearson (1934) first proposed
a confidence interval with this property, and statisticians have studied others since
then. The aim has been to tighten or otherwise refine the Clopper–Pearson interval
while still achieving a confidence coefficient at least equal to α m . See Blyth and Still
(1983), Casella (1986), Agresti and Min (2001), and Brown et al. (2001), among
other sources.
Let Q( ȳm, N m , α m ) be any confidence interval for pm that has confidence coefficient α m or greater. Consider the |M|-dimensional rectangle
Q = × Q( ȳm, Nm, αm).

(24)

m∈M

Conditional
on (N m , m ∈ M), the coverage probability for p of set Q is at least

α ≡ m∈M αm.
Having obtained Q as a confidence set for p, let q ∈ Q and let Hq (π ) be the set
of type distributions that satisfy the conditions
(25)

qm =



1[yk(Dm) = dm] · πk,

m ∈ M.

k∈K



πk = 1;

πk ≥ 0,

k ∈ K; π ∈ .

k∈K

Then HQ(π ) ≡ ∪q∈Q Hq (π) is a confidence set for π with coverage probability at
least α. Finally,

(26)

HQ{P[y(C) = c]} =




1[yk(C) = c] · λk, λ ∈ HQ(π )

k∈K

is a confidence set for P[y(C) = c] with coverage probability at least α.
Construction of HQ{P[y(C) = c]} is particularly simple when the behavioral
model is linear. Let Q( ȳm, N m , α m ) be the interval [q0 ( ȳm, N m , α m ), q1 ( ȳm, N m ,
α m )]. Then HQ{P[y(C) = c]} is an interval whose lower bound solves the linear
programming problem
(27)

min
λ


k∈K

1[yk(C) = c] · λk

COUNTERFACTUAL CHOICE PROBABILITIES

1407

subject to
q0 ( ȳm, α m) ≤




1[yk(Dm) = d] · λk ≤ q1 ( ȳm, Nm, α m), m ∈ M,

k∈K

λk = 1;

λk ≥ 0,

k ∈ K;

λ ∈ .

k∈K

The upper bound solves the analogous problem, with a max replacing the min in
(27).
4.2. Observed Multinomial Choice Sets. Construction of confidence sets when
observed choice sets have three or more alternatives is conceptually similar to the
case with binary choice sets, but differs in an important detail.
Generalizing the notation introduced above, let pmd ≡ P[y(Dm ) = d], pm ≡
{P[y(Dm ) = d], d ∈ Dm }, and p ≡ (pm , m ∈ M). Again let N m be the number of
sample members facing choice set Dm . Let ȳmd be the empirical frequency of choice
of alternative d, and let ȳm = ( ȳmd , d ∈ Dm ). The problem is again to use knowledge
of [( ȳm, N m ), m ∈ M] to construct a confidence set for the choice probabilities p.
As above, the components of ( ȳm, m ∈ M) are statistically independent of one
another conditional on the sample sizes, so it suffices to consider each value of m
separately and use knowledge of ( ȳm, N m ) to construct a confidence set for pm .
Again, the coverage probability for p of the Cartesian product of these sets equals
the product of their separate coverage probabilities.
The important difference in detail concerns construction of the confidence set
for pm . When a choice set is binary, pm has one nonredundant element and the
statistical literature provides confidence intervals with known finite-sample coverage. When a choice set is multinomial, pm has multiple nonredundant elements
and one faces the problem of joint inference on a vector of multinomial probabilities. Research on this subject has a long history but, as far as I am aware,
proposed procedures have been studied solely from an asymptotic perspective.
See, for example, Goodman (1965), Fitzpatrick and Scott (1987), and Sison and
Glaz (1995).
In the apparent absence of a literature on multinomial confidence sets with
known finite-sample coverage, I will suffice here with a conservative suggestion.
Again let em be the redundant element of Dm . The problem is to use knowledge
of ( ȳm, N m ) to construct a set Q( ȳm, N m , α m ) that covers (pmd , d ∈ Dm /em ) with
probability α m or greater. For each d ∈ Dm /em and γ md ∈ (0, 1), one can use the
Clopper–Pearson or another procedure to construct a confidence interval Qd ( ȳm,
N m , γ md ) that covers pmd with probability γ md or greater. Now let Q( ȳm, N m , α m )
be the {|Dm| − 1}-dimensional rectangle
(28)

Q( ȳm, Nm, α m) =

×

d∈Dm /em

Qd ( ȳm, Nm, γ md ).

1408

MANSKI

The Bonferroni inequality shows that this confidence set for (pmd , d ∈ Dm /em ) has
coverage probability at least equal to

γm= 1 −
(29)
(1 − γmd ).
d∈Dm /em

Hence, coverage of at least α m is achieved by choosing (γ md , d ∈ Dm /em ) so that
γ m ≥ αm.

5.

CONCLUSION

This article has used the basic structure of discrete choice analysis to develop a
simple approach to counterfactual prediction of population choice behavior. The
first step of the derivation in Section 3.1 recognized that discrete choice analysis
is a problem of decomposition of probability mixtures, where one uses observable choice probabilities to infer the distribution of types in the population. The
second step used the inferred restrictions on the distribution of types to predict
behavior in unrealized choice settings. Section 4 showed how the approach may
be implemented when one observes random-sample data on choices rather than
population choice probabilities.
Sections 3.2 and 3.3 gave two illustrative applications. Both restricted the set of
types appearing in the population. Section 3.2 considered prediction under the sole
assumption that all persons have strict preferences. Section 3.3 studied prediction
when almost all persons have strict preferences and utility functions that are linear
in attribute bundles. In contrast to prevailing econometric practice, nothing was
assumed about the shape of the distribution of preference parameters.
Looking beyond these applications, I foresee enormous scope for research that
uses the general approach of Section 3.1 to make predictions with other behavioral
models. Researchers who are comfortable with the assumption of strict preferences but who are uncomfortable with linear utility functions on attribute bundles
may want to pose other assumptions on preference orderings. Those who are uncomfortable with the assumption of rational behavior may want to consider types
who are nonrational in various ways.
Although this article has focused on prediction, the derivation of Section 3.1
also enables the testing of behavioral models. Suppose that one hypothesizes a
model and finds that the implied identification region for the distribution of types
is empty. Then one should conclude that the hypothesized model is incorrect.
REFERENCES

AFRIAT, S., “The Construction of Utility Functions from Expenditure Data,” International
Economic Review 8 (1967), 67–77.
AGRESTI, A., AND Y. MIN, “On Small-Sample Confidence Intervals for Parameters in Discrete Distributions,” Biometrics 57 (2001), 963–71.
ANGRIST, J., K. GRADDY, AND G. IMBENS, “The Interpretation of Instrumental Variables
Estimators in Simultaneous Equations Models with an Application to the Demand
for Fish,” Review of Economic Studies 67 (2000), 499–527.

COUNTERFACTUAL CHOICE PROBABILITIES

1409

BERESTEANU, A., AND F. MOLINARI, “Asymptotic Properties for a Class of Partially Identified
Models,” Mimeo, Department of Economics, Cornell University, 2006.
BERRY, S., J. LEVINSOHN, AND A. PAKES, “Automobile Prices in Market Equilibrium,” Econometrica 63 (1994), 841–90.
BLYTH, C., AND H. STILL, “Binomial Confidence Intervals,” Journal of the American Statistical Association 78 (1983), 108–16.
BROWN, L., T. CAL, AND A. DASGUPTA, “Interval Estimation for a Binomial Proportion,”
Statistical Science 16 (2001), 101–33.
CASELLA, G., “Refining Binomial Confidence Intervals,” The Canadian Journal of Statistics
14 (1986), 113–29.
CHERNOZHUKOV, V., H. HONG, AND E. TAMER, “Estimation and Confidence Regions for
Parameter Sets in Econometric Models,” Econometrica 75 (2007), 1243–84.
CLOPPER, C., AND E. PEARSON, “The Use of Confidence or Fiducial Limits Illustrated in the
Case of the Binomial,” Biometrika 26 (1934), 404–13.
COSSLETT, S., “Distribution-Free Maximum Likelihood Estimation of the Binary Choice
Model,” Econometrica 51 (1983), 765–82.
DAGANZO, C., F. BOUTHELIER, AND Y. SHEFFI, “Multinomial Probit and Qualitative Choice:
A Computationally Efficient Algorithm” Transportation Science 11 (1977), 338–
58.
FISHBURN, P., “Induced Binary Probabilities and the Linear Ordering Polytope: A Status
Report,” Mathematical Social Sciences 23 (1992), 67–80.
FITZPATRICK, S., AND A. SCOTT, “Quick Simultaneous Confidence Intervals for Multinomial
Proportions,” Journal of the American Statistical Association 82 (1987), 875–78.
GOODMAN, L., “On Simultaneous Confidence Intervals for Multinomial Proportions,” Technometrics 7 (1965), 247–54.
HAUSMAN, J., AND D. WISE, “A Conditional Probit Model for Qualitative Choice: Discrete
Decisions Recognizing Interdependence and Heterogeneous Preferences,” Econometrica 46 (1978), 403–26.
HONORÉ, B., AND E. TAMER, “Bounds on Parameters in Panel Dynamic Discrete Choice
Models,” Econometrica 74 (2006), 611–29.
HOROWITZ, J., AND C. MANSKI, “Nonparametric Analysis of Randomized Experiments with
Missing Covariate and Outcome Data,” Journal of the American Statistical Association
95 (2000), 77–84.
IMBENS, G., AND C. MANSKI, “Confidence Intervals for Partially Identified Parameters,”
Econometrica 72 (2004), 1845–57.
LERMAN, S., AND C. MANSKI, “On the Use of Simulated Frequencies to Approximate Choice
Probabilities,” in C. Manski and D. McFadden, eds., Structural Analysis of Discrete
Data with Econometric Applications (Cambridge, MA: M.I.T. Press, 1981).
MAGNAC, T., AND E. MAURIN, “Identification and Information in Monotone Binary Models,”
Journal of Econometrics 139 (2007), 76–104.
MANSKI, C., “Maximum Score Estimation of the Stochastic Utility Model of Choice,” Journal of Econometrics 3 (1975), 205–28.
——, “Identification of Binary Response Models,” Journal of the American Statistical Association 83 (1988), 729–38.
——, “Nonparametric Bounds on Treatment Effects,” American Economic Review Papers
and Proceedings 80 (1990), 319–23.
——, Identification Problems in the Social Sciences (Cambridge, MA: Harvard University
Press, 1995).
——, “Monotone Treatment Response,” Econometrica 65 (1997), 1311–34.
——, Partial Identification of Probability Distributions (New York: Springer-Verlag, 2003).
——, AND E. TAMER, “Inference on Regressions with Interval Data on a Regressor or
Outcome,” Econometrica 70 (2002), 519–46.
MARSCHAK, J., “Binary Choice Constraints on Random Utility Indicators,” in K. Arrow,
ed., Stanford Symposium on Mathematical Methods in the Social Sciences (Stanford:
Stanford University Press, 1960).

1410

MANSKI

MATZKIN, R. “Nonparametric and Distribution-Free Estimation of the Binary ThresholdCrossing and the Binary Choice Models,” Econometrica 60 (1992), 239–70.
MCFADDEN, D., “Conditional Logit Analysis of Qualitative Choice Behavior,” in P.
Zarembka, ed., Frontiers in Econometrics (New York: Academic Press, 1974).
——, “Modelling the Choice of Residential Location,” in A. Karlqvist, L. Lundqvist,
F. Snickars, and J. Weibull, eds., Spatial Interaction Theory and Planning Models
(Amsterdam: North-Holland, 1978).
——, “Econometric Models of Probabilistic Choice,” in C. Manski and D. McFadden, eds.,
Structural Analysis of Discrete Data with Econometric Applications (Cambridge, MA:
M.I.T. Press, 1981).
——, “Revealed Stochastic Preference: A Synthesis,” Economic Theory 26 (2005), 245–64.
——, AND K. TRAIN, “Mixed MNL Models for Discrete Response,” Journal of Applied
Econometrics 15 (2000), 447–70.
ROSEN, A., “Confidence Sets for Partially Identified Parameters that Satisfy a Finite Number of Moment Inequalities,” Mimeo, Department of Economics, University College
London, 2006.
SAMUELSON, P., “Consumption Theory in Terms of Revealed Preferences,” Economica 15
(1948), 243–53.
SISON, C., AND J. GLAZ, “Simultaneous Confidence Intervals and Sample Size Determination
for Multinomial Proportions,” Journal of the American Statistical Association 90 (1995),
366–69.

