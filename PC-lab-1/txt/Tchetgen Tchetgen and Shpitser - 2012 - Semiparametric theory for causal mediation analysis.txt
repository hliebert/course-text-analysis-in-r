The Annals of Statistics
2012, Vol. 40, No. 3, 1816‚Äì1845
DOI: 10.1214/12-AOS990
¬© Institute of Mathematical Statistics, 2012

SEMIPARAMETRIC THEORY FOR CAUSAL MEDIATION
ANALYSIS: EFFICIENCY BOUNDS, MULTIPLE ROBUSTNESS
AND SENSITIVITY ANALYSIS
B Y E RIC J. T CHETGEN T CHETGEN1

AND I LYA

S HPITSER

Harvard School of Public Health
While estimation of the marginal (total) causal effect of a point exposure
on an outcome is arguably the most common objective of experimental and
observational studies in the health and social sciences, in recent years, investigators have also become increasingly interested in mediation analysis. Specifically, upon evaluating the total effect of the exposure, investigators routinely
wish to make inferences about the direct or indirect pathways of the effect
of the exposure, through a mediator variable or not, that occurs subsequently
to the exposure and prior to the outcome. Although powerful semiparametric methodologies have been developed to analyze observational studies that
produce double robust and highly efficient estimates of the marginal total
causal effect, similar methods for mediation analysis are currently lacking.
Thus, this paper develops a general semiparametric framework for obtaining
inferences about so-called marginal natural direct and indirect causal effects,
while appropriately accounting for a large number of pre-exposure confounding factors for the exposure and the mediator variables. Our analytic framework is particularly appealing, because it gives new insights on issues of efficiency and robustness in the context of mediation analysis. In particular,
we propose new multiply robust locally efficient estimators of the marginal
natural indirect and direct causal effects, and develop a novel double robust
sensitivity analysis framework for the assumption of ignorability of the mediator variable.

1. Introduction. The evaluation of the total causal effect of a given point exposure, treatment or intervention on an outcome of interest is arguably the most
common objective of experimental and observational studies in the fields of epidemiology, biostatistics and in the social sciences. However, in recent years, investigators in these various fields have become increasingly interested in making
inferences about the direct or indirect pathways of the exposure effect, through
a mediator variable or not, that occurs subsequently to the exposure and prior to
the outcome. Recently, the counterfactual language of causal inference has proven
particularly useful for formalizing mediation analysis. Indeed, causal inference
Received March 2011; revised March 2012.
1 Supported by NIH Grant R21ES019712.

MSC2010 subject classifications. 62G05.
Key words and phrases. Natural direct effects, natural indirect effects, double robust, mediation
analysis, local efficiency.

1816

1817

ESTIMATION OF THE MEDIATION FUNCTIONAL

offers a formal mathematical framework for defining varieties of direct and indirect effects, and for establishing necessary and sufficient identifying conditions of
these effects. A notable contribution of causal inference to the literature on mediation analysis is the key distinction drawn between so-called controlled direct
effects versus natural direct effects. In words, the controlled direct effect refers
to the exposure effect that arises upon intervening to set the mediator to a fixed
level that may differ from its actual observed value [Robins and Greenland (1992),
Pearl (2001), Robins (2003)]. In contrast, the natural (also known as pure) direct
effect captures the effect of the exposure when one intervenes to set the mediator
to the (random) level it would have been in the absence of exposure [Robins and
Greenland (1992), Pearl (2001)]. As noted by Pearl (2001), controlled direct and
indirect effects are particularly relevant for policy making, whereas natural direct
and indirect effects are more useful for understanding the underlying mechanism
by which the exposure operates. In fact, natural direct and indirect effects combine
to produce the exposure total effect.
To formally define natural direct and indirect effects first requires defining counterfactuals. We assume that for each level of a binary exposure E, and of a mediator variable M, there exist a counterfactual variable Ye,m corresponding to the
outcome Y had possibly contrary to fact the exposure and mediator variables taken
the value (e, m). Similarly, for E = e, we assume there exists a counterfactual variable Me corresponding to the mediator variable had possibly contrary to fact the
exposure variable taken the value e. The current paper concerns the decomposition
of the total effect of E on Y , in terms of natural direct and natural indirect effects,
which, expressed on the mean difference scale, is given by


(1)

total effect





E(Ye=1 ‚àí Ye=0 ) = E(Ye=1,Me=1 ‚àí Ye=0,Me=0 )


natural indirect effect







natural direct effect





= E(Ye=1,Me=1 ‚àí Ye=1,Me=0 ) + E(Ye=1,Me=0 ‚àí Ye=0,Me=0 ),
where E stands for expectation.
In an effort to account for confounding bias when estimating causal effects,
such as the average total effect (1) from nonexperimental data, investigators routinely collect and adjust for in data analysis, a large number of confounding factors. Because of the curse of dimensionality, nonparametric methods of estimation are typically not practical in such settings, and one usually resorts to one of
two dimension-reduction strategies; either one relies on a model for the outcome
given exposure and counfounders, or alternately one relies on a model for the exposure, that is, the propensity score. Recently, powerful semiparametric methods
have been developed to analyze observational studies that produce so-called double robust and highly efficient estimates of the exposure total causal effect [Robins
(2000), Scharfstein, Rotnitzky and Robins (1999), Bang and Robins (2005), Tsiatis
(2006)] and similar methods have also been developed to estimate controlled direct

1818

E. J. TCHETGEN TCHETGEN AND I. SHPITSER

effects [Goetgeluk, Vansteelandt and Goetghebeur (2008)]. An important advantage of a double robust method is that it carefully combines both of the aforementioned dimension reduction strategies for confounding adjustment, to produce an
estimator of the causal effect that remains consistent and asymptotically normal,
provided at least one of the two strategies is correct, without necessarily knowing
which strategy is indeed correct [van der Laan and Robins (2003)]. Unfortunately,
similar methods for making semiparametric inferences about marginal natural direct and indirect effects are currently lacking. Thus, this paper develops a general
semiparametric framework for obtaining inferences about marginal natural direct
and indirect effects on the mean of an outcome, while appropriately accounting
for a large number of confounding factors for the exposure and the mediator variables.
Our semiparametric framework is particularly appealing, as it gives new insight on issues of efficiency and robustness in the context of mediation analysis.
Specifically, in Section 2, we adopt the sequential ignorability assumption of Imai,
Keele and Tingley (2010) under which, in conjunction with the standard consistency and positivity assumptions, we derive the efficient influence function and
thus obtain the semiparametric efficiency bound for the natural direct and natural indirect marginal mean causal effects, in the nonparametric model Mnonpar in
which the observed data likelihood is left unrestricted. We further show that in order to conduct mediation inferences in Mnonpar , one must estimate at least a subset
of the following quantities:
(i) the conditional expectation of the outcome given the mediator, exposure
and confounding factors;
(ii) the density of the mediator given the exposure and the confounders;
(iii) the density of the exposure given the confounders.
Ideally, to minimize the possibility of modeling bias, one may wish to estimate each of these quantities nonparametrically; however, as previously argued,
when as we assume throughout, we wish to account for numerous confounders,
such nonparametric estimates will likely perform poorly in finite samples. Thus,
in Section 2.3 we develop an alternative multiply robust strategy. To do so, we propose to model (i), (ii) and (iii) parametrically (or semiparametrically), but rather
than obtaining mediation inferences that rely on the correct specification of a specific subset of these models, instead we carefully combine these three models to
produce estimators of the marginal mean direct and indirect effects that remain
consistent and asymptotically normal (CAN) in a union model, where at least one
but not necessarily all of the following conditions hold:
(a) the parametric or semi-parametric models for the conditional expectation
of the outcome (i) and for the conditional density of the mediator (ii) are correctly
specified;

ESTIMATION OF THE MEDIATION FUNCTIONAL

1819

(b) the parametric or semiparametric models for the conditional expectation of
the outcome (i) and for the conditional density of the exposure (iii) are correctly
specified;
(c) the parametric or semiparametric models for the conditional densities of the
exposure and the mediator (ii) and (iii) are correctly specified.
Accordingly, we define submodels Ma , Mb and Mc of Mnonpar corresponding
to models (a), (b) and (c) respectively. Thus, the proposed approach is triply robust
as it produces valid inferences about natural direct and indirect effects in the union
model Munion = Ma ‚à™ Mb ‚à™ Mc . Furthermore, as we later show in Section 2.3,
the proposed estimators are also locally semiparametric efficient in the sense that
they achieve the respective efficiency bounds for estimating the natural direct and
indirect effects in Munion , at the intersection submodel Ma ‚à© Mb ‚à© Mc = Ma ‚à©
Mc = Ma ‚à© Mb = Mb ‚à© Mc ‚äÇ Munion ‚äÇ Mnonpar .
Section 3 summarizes a simulation study illustrating the finite sample performance of the various estimators described in Section 2, and Section 4 gives a real
data application of these methods. Section 5 describes a strategy to improve the stability of the proposed multiply robust estimator which directly depends on inverse
exposure and mediator density weights, when such weights are highly variable,
and Section 6 demonstrates the favorable performance of two modified multiply
robust estimators in the context of such highly variable weights. In Section 7, we
compare the proposed methodology to the prevailing estimators in the literature.
Based on this comparison, we conclude that the new approach should generally
be preferred because an inference under the proposed method is guaranteed to
remain valid under many more data generating laws than an inference based on
each of the other existing approaches. In particular, as we argue below the approach of van der Laan and Petersen (2005) is not entirely satisfactory because,
despite producing a CAN estimator of the marginal direct effect under the union
model Ma ‚à™ Mc (and therefore an estimator that is double robust), their estimator
requires a correct model for the density of the mediator. Thus, unlike the direct
effect estimator developed in this paper, the van der Laan estimator fails to be
consistent under the submodel Mb ‚äÇ Munion . Nonetheless, the estimator of van
der Laan is in fact locally efficient in model Ma ‚à™ Mc , provided the model for
the mediator‚Äôs conditional density is either known, or can be efficiently estimated.
This property is confirmed in a supplementary online Appendix [Tchetgen Tchetgen and Shpitser (2012)], where we also provide a general map that relates the
efficient influence function for model Munion to the corresponding efficient influence function for model Ma ‚à™ Mc , assuming an arbitrary parametric or semiparametric model for the mediator conditional density is correctly specified. In
Section 8, we describe a novel double robust sensitivity analysis framework to assess the impact on inferences about the natural direct effect, of a departure from
the ignorability assumption of the mediator variable. We conclude with a brief
discussion.

1820

E. J. TCHETGEN TCHETGEN AND I. SHPITSER

2. The nonparametric mediation functional.
2.1. Identification. Suppose i.i.d. data on O = (Y, E, M, X) is collected for n
subjects. Recall that Y is an outcome of interest, E is a binary exposure variable, M
is a mediator variable with support S , known to occur subsequently to E and prior
to Y and X is a vector of pre-exposure variables with support X that confound
the association between (E, M) and Y . The overarching goal of this paper is to
provide some theory of inference about the fundamental functional of mediation
analysis which Judea Pearl calls ‚Äúthe mediation causal formula‚Äù [Pearl (2011)] and
which, expressed on the mean scale, is
Œ∏0 =
(2)



E(Y |E = 1, M = m, X = x)

S √óX

√ó fM|E,X (m|E = 0, X = x)fX (x) dŒº(m, x),

fM|E,X and fX are respectively the conditional density of the mediator M given
(E, X) and the density of X, and Œº is a dominating measure for the distribution of
(M, X). Hereafter, to keep with standard statistical parlance, we shall simply refer
to Œ∏0 as the ‚Äúmediation functional‚Äù or ‚ÄúM-functional‚Äù since it is formally a functional on the nonparametric statistical model Mnonpar = {FO (¬∑) : FO unrestricted}
of all regular laws FO of the observed data O that satisfy the positivity assumption given below; that is, Œ∏0 = Œ∏0 (FO ) : Mnonpar ‚Üí R, with R the real line. The
functional Œ∏0 is of keen interest here because it arises in the estimation of natural
direct and indirect effects as we describe next. To do so, we make the consistency
assumption.
Consistency:
if E = e, then Me = M w.p.1

and

if E = e and M = m, then Ye,m = Y w.p.1.
In addition, we adopt the sequential ignorability assumption of Imai, Keele and
Tingley (2010) which states that for e, e ‚àà {0, 1}.
Sequential ignorability:
{Ye ,m , Me } ‚ä•
‚ä• E|X,
‚ä• M|E = e, X,
Ye  m ‚ä•
where A ‚ä•
‚ä• B|C states that A is independent of B given C; paired with the following:
Positivity:
fM|E,X (m|E, X) > 0
fE|X (e|X) > 0

w.p.1 for each m ‚àà S

and

w.p.1 for each e ‚àà {0, 1}.

ESTIMATION OF THE MEDIATION FUNCTIONAL

1821

Then, under the consistency, sequential ignorability and positivity assumptions,
Imai, Keele and Tingley (2010) showed that
Œ∏0 = E(Y1,M0 )
Œ¥e ‚â°



and

E(Y |E = e, X = x)fX (x) dŒº(x)

X

(3)

=



E(Y |E = e, M = m, X = x)

S √óX

√ó fM|E,X (m|E = e, X = x)fX (x) dŒº(m, x)
= E(Ye ) = E(Ye,Me ),

e = 0, 1,

so that E(Y1,M0 ) and E(Ye ), e = 0, 1, are identified from the observed data, and so
is the mean natural direct effect E(Y1,M0 ) ‚àí E(Y0 ) = Œ∏0 ‚àí Œ¥0 and the mean natural
indirect effect E(Y1 ) ‚àí E(Y1,M0 ) = Œ¥1 ‚àí Œ∏0 . For binary Y , one might alternatively
consider the natural direct effect on the risk ratio scale E(Y1,M0 )/E(Y0 ) = Œ∏0 /Œ¥0
or on the odds ratio scale {E(Y1,M0 )E(1 ‚àí Y0 )}/{E(1 ‚àí Y1,M0 )E(Y0 )} = {Œ∏0 (1 ‚àí
Œ¥0 )}/{Œ¥0 (1 ‚àí Œ∏0 )} and similarly defined natural indirect effects on the risk ratio
and odds ratio scales. It is instructive to contrast the expression (2) for E(Y1,M0 )
with the expression (3) for e = 1 corresponding to E(Y1 ), and to note that the two
expressions bare a striking resemblance except the density of the mediator in the
first expression conditions on the unexposed (with E = 0), whereas in the second expression, the mediator density is conditional on the exposed (with E = 1).
As we demonstrate below, this subtle difference has remarkable implications for
inference.
Pearl (2001) was the first to derive the M-functional Œ∏0 = E(Y1,M0 ) under a
different set of assumptions. Others have since contributed alternative sets of identifying assumptions. In this paper, we have chosen to work under the sequential
ignorability assumption of Imai, Keele and Yamamoto (2010), Imai, Keele and
Tingley (2010), but note that alternative related assumptions exist in the literature
[Robins and Greenland (1992), Pearl (2001), van der Laan and Petersen (2005),
Hafeman and Vanderweele (2011)]; however, we note that Robins and Richardson
(2012) disagree with the label ‚Äúsequential ignorability‚Äù because its terminology
has previously carried a different interpretation in the literature. Nonetheless, the
assumption entails two ignorability-like assumptions that are made sequentially.
First, given the observed pre-exposure confounders, the exposure assignment is
assumed to be ignorable, that is, statistically independent of potential outcomes
and potential mediators. The second part of the assumption states that the mediator
is ignorable given the observed exposure and pre-exposure confounders. Specifically, the second part of the sequential ignorability assumption is conditional on
the observed value of the ignorable treatment and the observed pretreatment confounders. We note that the second part of the sequential ignorability assumption is

1822

E. J. TCHETGEN TCHETGEN AND I. SHPITSER

particularly strong and must be made with care. This is partly because it is always
possible that there might be unobserved variables that confound the relationship
between the outcome and the mediator variables, even upon conditioning on the
observed exposure and covariates. Furthermore, the confounders X must all be
pre-exposure variables; that is, they must precede E. In fact, Avin, Shpitser and
Pearl (2005) proved that without additional assumptions, one cannot identify natural direct and indirect effects if there are confounding variables that are affected
by the exposure, even if such variables are observed by the investigator [also see
Tchetgen Tchetgen and VanderWeele (2012)]. This implies that, similarly to the
ignorability of the exposure in observational studies, ignorability of the mediator
cannot be established with certainty, even after collecting as many pre-exposure
confounders as possible. Furthermore, as Robins and Richardson (2012) point out,
whereas the first part of the sequential ignorability assumption could, in principle, be enforced in a randomized study, by randomizing E within levels of X;
the second part of the sequential ignorability assumption cannot similarly be enforced experimentally, even by randomization. And thus, for this latter assumption
to hold, one must entirely rely on expert knowledge about the mechanism under
study. For this reason, it will be crucial in practice to supplement mediation analyses with a sensitivity analysis that accurately quantifies the degree to which results
are robust to a potential violation of the sequential ignorability assumption. Later
in the paper, we develop a variety of sensitivity analysis techniques that allow the
analyst to quantify the degree to which his or her mediation analysis results are
robust to a potential violation of the sequential ignorability assumption.
2.2. Semiparametric efficiency bounds for Mnonpar . In this section, we derive
the efficient influence function for the M-functional Œ∏0 in Mnonpar . This result is
then combined with the efficient influence function for the functional Œ¥e [Robins,
Rotnitzky and Zhao (1994), Hahn (1998)] to obtain the efficient influence function
for the natural direct and indirect effects on the mean difference scale. Thus, in the
eff,nonpar
following, we shall use the efficient influence function SŒ¥e
(Œ¥e ) of Œ¥e which
is well known to be
I (E = e)
{Y ‚àí Œ∑(e, e, X)} + Œ∑(e, e, X) + Œ¥e ,
fE|X (e|X)
where for e, e‚àó ‚àà {0, 1}, we define
Œ∑(e, e‚àó , X) =



S

E(Y |X, M = m, E = e)fM|E,X (m|E = e‚àó , X) dŒº(m),

so that Œ∑(e, e, X) = E(Y |X, E = e), e = 0, 1.
The following theorem is proved in the Appendix.
T HEOREM 1. Under the consistency, sequential ignorability and positivity assumptions, the efficient influence function of the M-functional Œ∏0 in model Mnonpar

1823

ESTIMATION OF THE MEDIATION FUNCTIONAL

is given by
eff,nonpar

SŒ∏0

(Œ∏0 )

eff,nonpar

= sŒ∏ 0
=

(O; Œ∏0 )

I {E = 1}fM|E,X (M|E = 0, X)
{Y ‚àí E(Y |X, M, E = 1)}
fE|X (1|X)fM|E,X (M|E = 1, X)
I (E = 0)
{E(Y |X, M, E = 1) ‚àí Œ∑(1, 0, X)} + Œ∑(1, 0, X) ‚àí Œ∏0 ,
fE|X (0|X)

+

and the efficient influence function of the natural direct and indirect effects on the
mean difference scale in model Mnonpar are respectively given by
eff,nonpar

SNDE

(Œ∏0 , Œ¥0 )

eff,nonpar

= sNDE

(O; Œ∏0 , Œ¥0 )

eff,nonpar

= SŒ∏0
=

eff,nonpar

(Œ∏0 ) ‚àí SŒ¥0

(Œ¥0 )

I {E = 1}fM|E,X (M|E = 0, X)
{Y ‚àí E(Y |X, M, E = 1)}
fE|X (1|X)fM|E,X (M|E = 1, X)
I (E = 0)
{E(Y |X, M, E = 1) ‚àí Y ‚àí Œ∑(1, 0, X) + Œ∑(0, 0, X)}
fE|X (0|X)

+

+ Œ∑(1, 0, X) ‚àí Œ∑(0, 0, X) ‚àí Œ∏0 + Œ¥0 ,
and
eff,nonpar

SNIE

(Œ¥1 , Œ∏0 )

eff,nonpar

= sNIE
=

(O; Œ¥1 , Œ∏0 )


I (E = 1)
Y ‚àí Œ∑(1, 1, X)
fE|X (1|X)



fM|E,X (M|E = 0, X)
{Y ‚àí E(Y |X, M, E = 1)}
‚àí
fM|E,X (M|E = 1, X)
‚àí

I (E = 0)
{E(Y |X, M, E = 1) ‚àí Œ∑(1, 0, X)}
fE|X (0|X)

+ Œ∑(1, 1, X) ‚àí Œ∑(1, 0, X) + Œ∏0 ‚àí Œ¥1 .
Thus, the semiparametric efficiency bound for estimating the natural direct
and the natural indirect effects in Mnonpar are respectively given by
eff,nonpar
eff,nonpar
(Œ∏0 , Œ¥0 )2 }‚àí1 and E{SNIE
(Œ¥1 , Œ∏0 )2 }‚àí1 .
E{SNDE

1824

E. J. TCHETGEN TCHETGEN AND I. SHPITSER

Although not presented here, Theorem 1 is easily extended to obtain the efficient influence functions and the respective semiparametric efficiency bounds
for the direct and indirect effects on the risk ratio and the odds ratio scales by
a straightforward application of the delta method. An important implication of
the theorem is that all regular and asymptotically linear (RAL) estimators of Œ∏0 ,
Œ¥1 ‚àí Œ∏0 and Œ∏0 ‚àí Œ¥0 in model Mnonpar share the common influence functions
eff,nonpar
eff,nonpar
eff,nonpar
(Œ∏0 ), SNDE
(Œ∏0 , Œ¥0 ) and SNIE
(Œ¥1 , Œ∏0 ), respectively. Specifically,
SŒ∏0
any RAL estimator Œ∏0 of the M-functional Œ∏0 in model Mnonpar , shares a common asymptotic expansion,
eff,nonpar

n1/2 (Œ∏0 ‚àí Œ∏0 ) = n1/2 Pn SŒ∏0

(Œ∏0 ) + oP (1),

where Pn [¬∑] = n‚àí1 i [¬∑]i . To illustrate this property of nonparametric RAL estimators, and as a motivation to multiply robust estimation when nonparametric
methods are not appropriate, we provide a detailed study of three nonparametric strategies for estimating the M-functional in a simple yet instructive setting in
which X and M are both discrete with finite support.
Strategy 1: The first strategy entails obtaining the maximum likelihood estimator upon evaluating the M-functional under the empirical law of the observed data,
ym

Œ∏0

= Pn

E(Y |E = 1, M = m, X)fM|E,X (m|E = 0, X),
m‚ààS

where fY |E,M,X and fM|E,X are the empirical probability mass functions, and
E(Y |E = e, M = m, X = x) is the expectation of Y under fY |E,M,X .
Strategy 2: The second strategy is based on the following alternative representation of the M-functional:


E(Y |E = 1, M = m, X = x) dFM|E (m|E = 0, X = x) dFX (x)

S √óX

=

1 

E(Y |E = 1, M = m, X = x)

e=0 S √óX



I (e = 0)
dFM,E,X (m, e, x)
fE|X (e|X = x)



I (E = 0)
E(Y |E = 1, M, X) .
=E
fE|X (0|X)
Thus, our second estimator takes the form
ye

Œ∏0 = Pn





I (E = 0)
E(Y |E = 1, M, X) ,
fE|X (0|X)

with fE|X the empirical estimate of the probability mass function fE|X .

ESTIMATION OF THE MEDIATION FUNCTIONAL

1825

Strategy 3: The last strategy is based on a third representation of the Mfunctional


E(Y |E = 1, M = m, X = x) dFM|E (m|E = 0, X = x) dFX (x)

S √óX

1

=



y
e=0 Y √óS √óX

I (e = 1) fM|E,X (M|E = 0, X)
dFY,M,E,X (y, m, e, x)
fE|X (e|X = x) fM|E,X (M|E, X)





I (E = 1) fM|E,X (M|E = 0, X)
=E Y
.
fE|X (E|X) fM|E,X (M|E, X)
Thus, our third estimator takes the form


Œ∏0em

= Pn



I (E = 1) fM|E,X (M|E = 0, X)
Y
.
fE|X (E|X) fM|E,X (M|E, X)
ye

ym

At first glance the three estimators Œ∏0em , Œ∏0 and Œ∏0 might appear to be distinct; however, we observe that provided the empirical distribution function FO =
FY |E,M,X √ó FM|E,X √ó FE|X √ó FX satisfies the positivity assumption, and thus
ye
ym
FO ‚àà Mnonpar , then actually Œ∏0em = Œ∏0 = Œ∏0 = Œ∏0 (FO ) since the three representations agree on the nonparametric model Mnonpar . Therefore we may conclude that these three estimators are in fact asymptotically efficient in Mnonpar
eff,nonpar
with common influence function SŒ∏0
(Œ∏0 ). Furthermore, from this observation, one further concludes that (asymptotic) inferences obtained using one of the
three representations are identical to inferences using either of the other two representations.
At this juncture, we note that the above equivalence no longer applies when
as we have previously argued will likely occur in practice, (M, X) contains 3 or
more continuous variables and/or X is too high dimensional for models to be saturated or nonparametric, and thus parametric (or semiparametric) models are specified for dimension reduction. Specifically, for such settings, we observe that three
distinct modeling strategies are available. Under the first strategy, the estimator
ym,par
ym
Œ∏0
is obtained Œ∏0 using parametric model estimates Epar (Y |E, M, X) and
par
fM|E,X (m|E, X) instead of their nonparametric counterparts; similarly under the
ye,par
ye
second strategy, the estimator Œ∏0
is obtained similarly to Œ∏0 using estimates
par
of parametric models Epar (Y |E = 1, M = m, X) and fE|X (e|X) and finally, unem,par
par
is obtained similarly to Œ∏0em using fE|X (e|X) and
der the third strategy, Œ∏0
par
ym,par
fM|E,X (m|E, X). Then, it follows that Œ∏0
is CAN under the submodel Ma ,
par
par
but is generally inconsistent if either E (Y |E, M, X) or fM|E,X (m|E, X) fails
ye,par
em,par
to be consistent. Similarly, Œ∏0
and Œ∏0
are, respectively, CAN under the
submodels Mb and Mc , but each estimator generally fails to be consistent outside of the corresponding submodel. In the next section, we propose an approach

1826

E. J. TCHETGEN TCHETGEN AND I. SHPITSER

that produces a triply robust estimator by combining the above three strategies so
that only one of models Ma , Mb and Mc needs to be valid for consistency of the
estimator.
triply

2.3. Triply robust estimation. The proposed triply robust estimator Œ∏0
solves
eff,nonpar

Pn SŒ∏0
eff,nonpar

triply

(Œ∏0

eff,nonpar

(Œ∏ ) is equal to SŒ∏0
where SŒ∏0
par
par
fM|E,X (m|E, X), fE|X (e|X)}; that is,

) = 0,

(Œ∏ ) evaluated at {Epar (Y |E, M, X),

par

triply
Œ∏0

= Pn

I {E = 1}fM|E,X (M|E = 0, X)
par

par

fE|X (1|X)fM|E,X (M|E = 1, X)
√ó {Y ‚àí Epar (Y |X, M, E = 1)}

(4)

+

I (E = 0) par
{E (Y |X, M, E = 1)
par
fE|X (0|X)
‚àí Œ∑ par (1, 0, X)} + Œ∑ par (1, 0, X) ,

is CAN in model Munion = Ma ‚à™ Mb ‚à™ Mc , where
Œ∑

par

‚àó

(e, e , X) =



S

Epar (Y |X, M = m, E = e)fM|E,X (m|E = e‚àó , X) dŒº(m).
par

In the next theorem, the estimator in the above display is combined with a doudoubly
of Œ¥e [see van der Laan and Robins (2003) or Tsiatis
bly robust estimator Œ¥e
(2006)], to obtain multiply robust estimators of natural direct and indirect effects,
where
I (E = e)
{Y ‚àí Œ∑ par (e, e, X)} + Œ∑ par (e, e, X) .
Œ¥edoubly = Pn par
fE|X (e|X)
To state the result, we set Epar (Y |X, M, E) = Epar (Y |X, M, E; Œ≤y ) = g ‚àí1 (Œ≤yT h(X,
M, E)), where g is a known link function, and h is a user specified function of
(X, M, E) so that Epar (Y |X, M, E; Œ≤y ) = g ‚àí1 (Œ≤yT h(X, M, E)) entails a working
regression model for E(Y |X, M, E), and Œ≤y solves the estimating equation






0 = Pn [Sy (Œ≤y )] = Pn h(X, M, E) Y ‚àí g ‚àí1 (Œ≤yT h(X, M, E)) .
par

par

par

Similarly, we set fM|E,X (m|E, X) = fM|E,X (m|E, X; Œ≤m ) for fM|E,X (m|E, X;
Œ≤m ), a parametric model for the density of [M|E, X] with Œ≤m , solving
0 = Pn [Sm (Œ≤m )] = Pn

‚àÇ
par
log fM|E,X (M|E, X; Œ≤m ) ,
‚àÇŒ≤m

1827

ESTIMATION OF THE MEDIATION FUNCTIONAL
par

par

par

and we set fE|X (e|X) = fE|X (e|X; Œ≤e ) for fE|X (e|X; Œ≤e ), a parametric model for
the density of [E|X] with Œ≤e solving
‚àÇ
par
0 = Pn [Se (Œ≤e )] = Pn
log fE|X (E|X; Œ≤e ) .
‚àÇŒ≤e
T HEOREM 2. Suppose that the assumptions of Theorem 1 hold, and that the
regularity conditions stated in the Appendix hold and that Œ≤m , Œ≤e and Œ≤y are variation independent.
‚àö
triply
‚àí Œ∏0 ) is RAL under model Munion
(i) Mediation functional: Then, n(Œ∏0
with influence function
(Œ∏0 , Œ≤ ‚àó )
SŒ∏union
0
eff,nonpar

eff,nonpar
= SŒ∏0
(Œ∏0 , Œ≤ ‚àó ) ‚àí

‚àÇE{SŒ∏0


 

‚àÇSŒ≤ (Œ≤)  ‚àí1
 E
SŒ≤ (Œ≤ ‚àó ),
 ‚àó
‚àÇŒ≤ T  ‚àó

(Œ∏0 , Œ≤)} 

‚àÇŒ≤ T
Œ≤
and thus converges in distribution to a N(0, Œ∏0 ), where

Œ≤

Œ∏0 (Œ∏0 , Œ≤ ‚àó ) = E(SŒ∏union
(Œ∏0 , Œ≤ ‚àó )2 ),
0
T , Œ≤ T , Œ≤ T ) and S (Œ≤) = (S T (Œ≤ ), S T (Œ≤ ), S T (Œ≤ ))T , and with Œ≤ ‚àó
with Œ≤ T = (Œ≤m
Œ≤
e
y
e
y
m m
e
y
T
T
T
denoting the probability limit of the estimator Œ≤ = (Œ≤m , Œ≤e , Œ≤y )T .
‚àö
triply
doubly
(ii) Natural direct effect: Similarly, n(Œ∏0
‚àí Œ¥0
‚àí (Œ∏0 ‚àí Œ¥0 )) is
union
RAL under model Munion with influence function SNDE (Œ∏0 , Œ¥0 , Œ≤ ‚àó ) defined as
eff,nonpar
eff,nonpar
(Œ∏0 , Œ≤ ‚àó ) with SNDE
(Œ∏0 , Œ¥0 , Œ≤ ‚àó ) replacing SŒ∏0
(Œ∏0 , Œ≤ ‚àó ), and asympSŒ∏union
0
‚àó
totic variance Œ∏0 ‚àíŒ¥0 (Œ¥1 , Œ∏0 , Œ≤ ) defined accordingly.
‚àö doubly
triply
(iii) Natural indirect effect: Similarly, n(Œ¥1
‚àí Œ∏0
‚àí (Œ¥1 ‚àí Œ∏0 )) is
union (Œ¥ , Œ∏ , Œ≤ ‚àó ) defined as
RAL under model Munion with influence function SNIE
1 0
‚àó ) with S eff,nonpar (Œ¥ , Œ∏ , Œ≤ ‚àó ) replacing S eff,nonpar (Œ∏ , Œ≤ ‚àó ), and asympSŒ∏union
(Œ∏
,
Œ≤
0
1 0
0
NIE
Œ∏0
0
totic variance Œ¥1 ‚àíŒ∏0 (Œ¥1 , Œ∏0 , Œ≤ ‚àó ) defined accordingly.
triply
triply
doubly
doubly
triply
, Œ∏0
‚àí Œ¥0
and Œ¥1
‚àí Œ∏0
are semiparametric locally
(iv) Œ∏0
efficient in the sense that they are RAL under model Munion and respectively
achieve the semiparametric efficiency bound for Œ∏0 , Œ∏0 ‚àí Œ¥0 , and Œ¥1 ‚àí Œ∏0 under model Munion at the intersection submodel Ma ‚à© Mb ‚à© Mc , with reeff,nonpar
eff,nonpar
(Œ∏0 , Œ≤ ‚àó ), SNDE
(Œ∏0 , Œ¥0 , Œ≤ ‚àó ) and
spective efficient influence functions: SŒ∏0
eff,nonpar

SNIE

(Œ¥1 , Œ∏0 , Œ≤ ‚àó ).

Empirical versions of Œ∏0 ‚àíŒ¥0 (Œ¥1 , Œ∏0 , Œ≤ ‚àó ) and Œ¥1 ‚àíŒ∏0 (Œ¥1 , Œ∏0 , Œ≤ ‚àó ) are easily obtained, and the corresponding Wald-type confidence intervals can be used to make
formal inferences about natural direct and indirect effects. It is also straightforward to extend the approach to the risk ratio and odds ratio scales for binary Y . By a theorem due to Robins and Rotnitzky (2001), part (iv) of the
triply
triply
doubly
, Œ∏0
‚àí Œ¥0
and
theorem implies that when all models are correct, Œ∏0

1828
doubly

E. J. TCHETGEN TCHETGEN AND I. SHPITSER
triply

Œ¥1
‚àí Œ∏0
are semiparametric efficient in model Mnonpar at the intersection
submodel Ma ‚à© Mb ‚à© Mc .
3. A simulation study of estimators of direct effect. In this section, we report a simulation study which illustrates the finite sample performance of the various estimators described in previous sections. We generated 1000 samples of size
n = 600, 1000 from the following model:
(Model.X) X1 ‚àº Bernoulli(0.4); [X2 |X1 ] ‚àº Bernoulli(0.3 + 0.4X1 );
[X3 |X1 , X2 ] ‚àº ‚àí0.024 ‚àí 0.4X1 + 0.4X2 + N(0, 1);
(Model.E) [E|X1 , X2 , X3 ] ‚àº Bernoulli([1 + exp{‚àí(0.4 + X1 ‚àí X2 + 0.1X3 ‚àí
1.5X1 X3 )}]‚àí1 );
(Model.M) [M|E, X1 , X2 , X3 ] ‚àº Bernoulli([1 + exp{‚àí(0.5 ‚àí X1 + 0.5X2
‚àí0.9X3 + E ‚àí 1.5X1 X3 )}]‚àí1 );
(Model.Y) [Y |M, E, X1 , X2 , X3 ] ‚àº 1 + 0.2X1 + 0.3X2 + 1.4X3
‚àí2.5E ‚àí 3.5M + 5EM + N(0, 1).
We then evaluated the performance of the following four estimators of the natdoubly
ye
doubly
ym
doubly
triply
doubly
ural direct effect Œ∏0em ‚àí Œ¥0
, Œ∏0 ‚àí Œ¥ 0
, Œ∏0 ‚àí Œ¥ 0
and Œ∏0
‚àí Œ¥0
.
doubly
was used throughout to estimate
Note that the doubly robust estimator Œ¥0
Œ¥0 = E(Y0 ). To assess the impact of modeling error, we evaluated these estimators
in four separate scenarios. In the first scenario, all models were correctly specified, whereas the remaining three scenarios respectively mis-specified only one of
Model E, Model M and Model Y. In order to mis-specify Model E and Model M,
we respectively left out the X1 X3 interaction when fitting each model, and we
assumed an incorrect log‚Äìlog link function. The incorrect model for Y simply assumed no EM interaction.
Tables 1 and 2 summarize the simulation results which largely agree with the
theory developed in the previous sections. Mainly, all proposed estimators performed well at both moderate and large sample sizes in the absence of modeling
error. Furthermore, under the partially mis-specified model in which Model.Y was
ye
doubly
ym
doubly
and Œ∏0 ‚àí Œ¥0
, showed significant
incorrect, both estimators, Œ∏0 ‚àí Œ¥0
doubly
triply
doubly
em
bias irrespective of sample size, while Œ∏0 ‚àí Œ¥0
and Œ∏0
‚àí Œ¥0
both perdoubly
em
formed well. Similarly when Model M was incorrect, the estimators Œ∏0 ‚àí Œ¥0
ym
doubly
and Œ∏0 ‚àí Œ¥0
resulted in large bias, when compared to the relatively small
ye
doubly
triply
doubly
bias of Œ∏0 ‚àí Œ¥0
and Œ∏0
‚àí Œ¥0
. Finally, mis-specifying Model E lead
ye
doubly
doubly
em
to estimators Œ∏0 ‚àí Œ¥0
and Œ∏0 ‚àí Œ¥0
that were significantly more biased
ym
doubly
triply
doubly
than the estimators Œ∏0 ‚àí Œ¥0
and Œ∏0
‚àí Œ¥0
. Interestingly, the efficiency
loss of the multiply robust estimator remained relatively small when compared to
the consistent nonrobust estimator under the various scenarios, suggesting that, at
least in this simulation study, the benefits of robustness appear to outweigh the loss
of efficiency.

1829

ESTIMATION OF THE MEDIATION FUNCTIONAL
TABLE 1
Simulation results n = 600

All correct
Y wrong
M wrong
E wrong

ym

bias
MC
bias
MC
bias
MC
bias
MC

s.e.‚àó
s.e.
s.e.
s.e.

doubly

ye

Mym

Mye

Mem

Munion

0.002
0.005
‚àí0.500
0.005
0.038
0.005
0.003
0.005

0.008
0.007
‚àí0.500
0.006
0.008
0.007
0.027
0.005

0.002
0.006
0.0001
0.006
‚àí0.054
0.006
0.059
0.005

0.005
0.006
0.004
0.006
0.003
0.006
0.004
0.005

doubly

Mym : Œ∏0 ‚àí Œ¥0
; Mye : Œ∏0 ‚àí Œ¥0
‚àó Monte Carlo standard error.

doubly

; Mem : Œ∏0em ‚àí Œ¥0

triply

; Munion : Œ∏0

doubly

‚àí Œ¥0

.

4. A data application. In this section, we illustrate the methods in a real
world application from the psychology literature on mediation. We re-analyze data
from The Job Search Intervention Study (JOBS II) also analyzed by Imai, Keele
and Tingley (2010). JOBS II is a randomized field experiment that investigates
the efficacy of a job training intervention on unemployed workers. The program
is designed not only to increase reemployment among the unemployed but also
to enhance the mental health of the job seekers. In the study, 1801 unemployed
workers received a pre-screening questionnaire and were then randomly assigned
to treatment and control groups. The treatment group with E = 1 participated in
job skills workshops in which participants learned job search skills and coping
strategies for dealing with setbacks in the job search process. The control group
with E = 0 received a booklet describing job search tips. An analysis considers
TABLE 2
Simulation results n = 1000

All correct
Y wrong
M wrong
E wrong

ym

bias
MC
bias
MC
bias
MC
bias
MC
doubly

s.e.‚àó
s.e.
s.e.
s.e.
ye

Mym

Mye

Mem

Munion

0.001
0.004
‚àí0.484
0.004
0.136
0.004
0.001
0.004

0.009
0.005
‚àí0.484
0.004
‚àí0.008
0.05
‚àí0.024
0.004

0.001
0.004
0.003
0.004
0.056
0.004
‚àí0.054
0.004

0.001
0.004
0.003
0.004
0.01
0.01
0.001
0.004

doubly

Mym : Œ∏0 ‚àí Œ¥0
; Mye : Œ∏0 ‚àí Œ¥0
‚àó Monte Carlo standard error.

doubly

; Mem : Œ∏0em ‚àí Œ¥0

triply

; Munion : Œ∏0

doubly

‚àí Œ¥0

.

1830

E. J. TCHETGEN TCHETGEN AND I. SHPITSER
TABLE 3
Estimated causal effects of interest using the job search intervention study data

Direct effect
Indirect effect

Estimate
s.e.‚àó
Estimate
s.e.‚àó

Mym

Mye

Mem

Munion

‚àí0.0310
0.0124
‚àí0.0160
0.0372

‚àí0.0310
0.0620
‚àí0.0160
0.0620

0.0280
0.0465
‚àí0.0750
0.0434

‚àí0.0409
0.0217
‚àí0.0070
0.0217

‚àó Nonparametric bootstrap standard errors.

a continuous outcome measure Y of depressive symptoms based on the Hopkins
Symptom Checklist [Imai, Keele and Tingley (2010)]. In the JOBS II data, a continuous measure of job search self-efficacy represented the hypothesized mediating variable M. The data also included baseline covariates X measured before
administering the treatment including: pretreatment level of depression, education,
income, race, marital status, age, sex, previous occupation, and the level of economic hardship.
Note that by randomization, the density of [E|X] was known by design not to
depend on covariates, and therefore its estimation is not prone to modeling error.
The continuous outcome and mediator variables were modeled using linear regression models with Gaussian error, with main effects for (E, M, X) included in the
outcome regression and main effects for (E, X) included in the mediator regresye
ym
triply
sion. Table 3 summarizes results obtained using Œ∏0em , Œ∏0 , Œ∏0 and Œ∏0
together
doubly
, e = 0, 1, to estimate the direct and indirect effects of the treatment.
with Œ¥e
Point estimates of both natural direct and indirect effects closely agreed under
models Mym and Mye , and also agreed with the results of Imai, Keele and Tingley (2010). We should note that inferences under our choice of Mym are actually
robust to the normality assumption and, as in Imai, Keele and Tingley (2010), only
require that the mean structure of [Y |E, M, X] and [M|E, X] is correct. In contrast, inferences under model Mem require a correct model for the mediator density. This distinction may partly explain the apparent disagreement in the estimated
direct effect under Mem when compared to the other methods, also suggesting that
the Gaussian error model for M is not entirely appropriate. The multiply robust
estimate of the natural direct effect is consistent with estimates obtained under
models Mym and Mye , and is statistically significant, suggesting that the intervention may have beneficial direct effects on participants‚Äô mental health; while
the multiply robust approach suggests a much smaller indirect effect than all other
estimators although none achieved statistical significance.
5. Improving the stability of Œ∏0
when weights are highly variable. The
triply
which involves inverse probability weights for the extriply robust estimator Œ∏0
posure and mediator variables, clearly relies on the positivity assumption, for good
triply

ESTIMATION OF THE MEDIATION FUNCTIONAL

1831

finite sample performance. But as recently shown by Kang and Schafer (2007) in
the context of missing outcome data, a practical violation of positivity in data analysis can severely compromise inferences based on such methodology; although
their analysis did not directly concern the M-functional Œ∏0 . Thus, it is crucial to
critically examine, as we do below in a simulation study, the extent to which the
various estimators discussed in this paper are susceptible to a practical violation
of the positivity assumption, and to consider possible approaches to improve the
finite sample performance of these estimators in the context of highly variable emdoubly
pirical weights. Methodology to enhance the finite sample behavior of Œ¥j
is
well studied in the literature and is not considered here; see, for example, Robins
et al. (2007), Cao, Tsiatis and Davidian (2009) and Tan (2010). We first describe
triply
an approach to enhance the finite sample performance of Œ∏0
, particularly in
the presence of highly variable empirical weights. To focus the exposition, we
only consider the case of a continuous Y and a binary M, but in principle, the approach could be generalized to a more general setting. The proposed enhancement
involves two modifications.
The first modification adapts to the mediation context, an approach developed
for the missing data context (and for the estimation of total effects) in Robins et al.
(2007). The basic guiding principle of the approach is to carefully modify the
estimation of the outcome and mediator models in order to ensure that the triply
robust estimator given by equation (4) has the simple M-functional representation
triply,‚Ä†

Œ∏0

= Pn {Œ∑par,‚Ä† (1, 0, X)},

where Œ∑ par,‚Ä† (1, 0, X) is carefully estimated to ensure multiple robustness. The reason for favoring an estimator with the above representation is that it is expected
to be more robust to practical positivity violation because it does not directly depend on inverse probability weights. However, as we show next, to ensure multiple
robustness, estimation of Œ∑par involves inverse probability weights, and therefore,
triply,‚Ä†
Œ∏0
indirectly depends on such weights. Our strategy involves a second step to
minimize the potential impact of this indirect dependence on weights.
In the following, we assume, to simplify the exposition, that a simple linear
model is used:
Epar (Y |X, M, E = 1) = Epar (Y |X, M, 1; Œ≤y ) = [1, X T , M]Œ≤y .
Then, similar to Robins et al. (2007), one can verify that the above M-functional
par
representation of a triply robust estimator is obtained by estimating fM|E,X (M|E =
par,‚Ä†

0, X) with fM|E,X (M|E = 0, X) obtained via weighted logistic regression in the
par
unexposed-only, with weight fE|X (0|X)‚àí1 ; and by estimating Epar (Y |X, M, E =
1) using weighted OLS of Y on (M, X) in the exposed-only, with weight
fM|E,X (M|E = 0, X){fE|X (1|X)fM|E,X (M|E = 1, X)}‚àí1 ;
par,‚Ä†

par

par,‚Ä†

1832

E. J. TCHETGEN TCHETGEN AND I. SHPITSER

provided that both working models include an intercept. The second enhancement
to minimize undue influence of variable weights on the M-functional estimator,
par,‚Ä†
par
entails using fE|X in the previous step instead of fE|X , where
par,‚Ä†

par

logit fE|X (1|X) = logit fE|X (1|X) + C1
with







par



par

C1 = ‚àí log 1 ‚àí Pn (E) + log Pn [E fE|X (0|X)/fE|X (1|X)] .
This second modification ensures a certain boundedness property of inverse
propensity score-weighting. Specifically, for any bounded function R = r(Y, M)
of Y and M; consider for a moment the goal of estimating the counterfactual mean
E{r(Y1 , M1 )}; then it is well known that even though R is bounded, the simple
par
inverse-probability weighting estimator Pn {ER fE|X (1|X)‚àí1 } could easily be unbounded, particularly if positivity is practically violated. In contrast, as we show
par,‚Ä†
next, the estimator Pn {ER fE|X (1|X)‚àí1 } is generally bounded. To see why, note
that
Pn {ER fE|X (1|X)‚àí1 } = Pn {ER fE|X (0|X)fE|X (1|X)‚àí1 } + Pn {R}
par,‚Ä†

par,‚Ä†



= Pn R

par,‚Ä†

E fE|X (0|X)fE|X (1|X)‚àí1
par

par

par

par

Pn [E fE|X (0|X)fE|X (1|X)‚àí1 ]







1 ‚àí Pn (E)

+ Pn {R}
which is bounded since the second term is bounded, and the first term is a convex
combination of bounded variables, and therefore is also bounded. Furthermore,
par,‚Ä†
par,‚Ä†
Pn [E fE|X (0|X)fE|X (1|X)‚àí1 ] converges in probability to (1 ‚àí E(E)) provided
par
that fE|X converges to fE|X , ensuring that the expression in the above display is
consistent for E{r(Y1 , M1 )}. The nonparametric bootstrap is most convenient for
par,‚Ä†
inference using fE|X .
In the next section, we study, in the context of highly variable weights, the
behavior of our previous estimators of Œ∏0 , together with that of the enhanced estitriply,‚Ä†,j
= Pn {Œ∑par,‚Ä†,j (1, 0, X)}, j = 1, 2, where Œ∑ par,‚Ä†,1 is constructed as
mators Œ∏0
par
par,‚Ä†
described above using fE|X , and Œ∑ par,‚Ä†,2 uses fE|X .
6. A simulation study where positivity is practically violated. We adapted
to the mediation setting, the missing data simulation scenarios in Kang and Schafer
(2007) which were specifically designed so that, when misspecified, working models are nonetheless nearly correct, but yield highly variable inverse probability
weights with practical positivity violation in the context of estimation. We generated 1000 samples of size n = 200, 1000 from the following model:
i.i.d.

(Model.X) Z = Z1 , Z2 , Z3 , Z4 ‚àº N(0, 1); X1 = exp(Z1 /2);

1833

ESTIMATION OF THE MEDIATION FUNCTIONAL

X2 = Z2 /{1 + exp(Z1 )} + 10; X3 = (Z1 Z3 /25 + 0.6)3
and X4 = (Z2 + Z4 + 20)2 , so that Z may be expressed in terms of X.
(Model.E) [E|X1 , X2 , X3 ] ‚àº Bernoulli([1 + exp{(Z1 ‚àí 0.5Z2 + 0.25Z3
+0.1Z4 )}]‚àí1 );
(Model.M) [M|E, X1 , X2 , X3 ] ‚àº Bernoulli([1 + exp{‚àí(0.5 ‚àí Z1 + 0.5Z2
‚àí0.9Z3 + Z4 ‚àí 1.5E)}]‚àí1 );
(Model.Y) [Y |M, E, X1 , X2 , X3 ] ‚àº 210 + 27.4Z1 + 13.7Z3 + 13.7Z3
+M + E + N(0, 1).
Correctly specified working models were thus achieved when an additive linear
regression of Y on Z, a logistic regression of M with linear predictor additive in
Z and E and a logistic regression of E with linear predictor additive in the Z,
respectively. Incorrect specification involved fitting these models with X replacing Z, which produces higly variable weights. For instance, an estimated propensity score as small as 5.5 √ó 10‚àí33 occurred in the simulation study reflecting an
effective violation of positivity; similarly, a mediator predicted probability as small
as 3 √ó 10‚àí20 also occured in the simulation study.
ym
ye
triply
triply,‚Ä†,1
, Œ∏0
Tables 4 and 5 summarize simulation results for Œ∏0 , Œ∏0 , Œ∏0em , Œ∏0
triply,‚Ä†,2
and Œ∏0
. When all three working models are correct, all estimators perform
well in terms of bias, but there are clear differences between the estimators in
TABLE 4
Simulation results n = 200

All correct
Y wrong
M wrong
E wrong
Y, E wrong
Y, M wrong
E, M wrong
Y, E, M wrong

ym

bias
MC
bias
MC
bias
MC
bias
MC
bias
MC
bias
MC
bias
MC
bias
MC

s.e.‚àó
s.e.
s.e.
s.e.
s.e.
s.e.
s.e.
s.e.

ye

Mym

Mye

0.001
2.614
‚àí9.87
3.322
‚àí0.033
2.613
‚àí0.001
2.614
‚àí9.869
3.322
‚àí9.355
3.224
‚àí0.032
2.614
‚àí9.355
3.224

‚àí0.207
8.333
‚àí10.221
10.539
‚àí0.207
8.333
0.132
4.373
‚àí13.535
5.256
‚àí10.220
10.539
0.132
4.373
‚àí13.535
5.356

Mem

‚Ä†,2

Munion

Munion

0.498
0.003
20.214
2.6151
0.498 ‚àí0.147
20.214
4.461
‚àí9.497
0.001
15.376
2.615
210.450
0.066
2336.92
4.891
210.454 ‚àí33.090
2336.92
375.334
‚àí9.496 ‚àí4.346
15.376
3.912
205.060
0.088
2289.788
4.763
205.060 ‚àí37.757
2289.78
379.122

‚àí0.08
2.6155
‚àí0.502
3.177
0.046
2.614
‚àí0.089
2.619
‚àí1.4609
5.187
‚àí3.579
3.480
‚àí0.001
2.623
‚àí4.223
5.835

‚àí0.079
2.6153
‚àí0.202
3.141
0.046
2.614
‚àí0.087
2.615
‚àí2.487
4.245
‚àí3.579
3.441
‚àí3.77√ó10‚àí5
2.618
‚àí5.253
4.828

triply

Mym : Œ∏0 ; Mye : Œ∏0 ; Mem : Œ∏0em ; Munion : Œ∏0
‚àó Monte Carlo standard error.

‚Ä†,1

Munion

triply,‚Ä†,1

; M‚Ä†,1
union : Œ∏0

triply,‚Ä†,2

‚Ä†,2
; Munion
: Œ∏0

.

1834

E. J. TCHETGEN TCHETGEN AND I. SHPITSER
TABLE 5
Simulation results n = 1000
Mym

All correct

bias
MC
Y wrong
bias
MC
M wrong
bias
MC
E wrong
bias
MC
Y, E wrong
bias
MC
Y, M wrong
bias
MC
E, M wrong
bias
MC
Y, E, M wrong bias
MC
ym

s.e.‚àó
s.e.
s.e.
s.e.
s.e.
s.e.
s.e.
s.e.

0.0324
1.136
‚àí10.256
1.675
‚àí5 √ó 10‚àí4
1.136
0.032
1.136
‚àí10.256
1.675
‚àí9.705
1.626
5.7 √ó 10‚àí4
1.136
‚àí9.075
1.626

ye

Mye

Munion

‚Ä†,1

triply

triply

triply,‚Ä†,1

; M‚Ä†,1
union : Œ∏0

triply,‚Ä†,1

‚Ä†,2

Munion Munion

0.004 ‚àí0.106
0.034
‚àí0.047
3.06
6.490
1.136
1.137
‚àí10.305 ‚àí0.106
0.063
‚àí0.147
4.005 6.490
1.769
1.419
0.004 ‚àí9.706
0.033
0.076
3.060 5.395
1.137
1.137
‚àí0.038
0.135 2.4 √ó 106 1908.76
1.400
1.794 4.3 √ó 107 53911.63
‚àí1.1 √ó 106 6.201
‚àí14.011 2.4 √ó 106
2.1 √ó 107 9.406
2.386 4.3 √ó 107
‚àí10.305 ‚àí9.706
‚àí4.216
‚àí3.555
4.004 5.395
1.667
1.527
0.135 2.5 √ó 106 2034.83
0.0539
1.429
1.794 4.6 √ó 107 56090.10
‚àí1.2 √ó 106 4.659
‚àí14.011 2.5 √ó 106
2.2 √ó 107 10.121
2.386 4.6 √ó 107

Mym : Œ∏0 ; Mye : Œ∏0 ; Mem : Œ∏0em ; Munion : Œ∏0
‚àó Monte Carlo standard error.
ym

Mem

‚àí0.047
1.137
‚àí0.148
1.407
0.076
1.135
‚àí0.030
1.242
1.024
5.097
‚àí3.557
1.510
0.0599
1.272
‚àí0.755
5.910

triply,‚Ä†,2

; M‚Ä†,2
union : Œ∏0

.

triply,‚Ä†,2

terms of efficiency. In fact, Œ∏0 , Œ∏0
, Œ∏0
and Œ∏0
have comparaye
ble efficiency for n = 200, 1000, but Œ∏0 , Œ∏0em is far more variable. Moreover,
triply
triply,‚Ä†,1
triply,‚Ä†,2
under mis-specification of a single model, Œ∏0
, Œ∏0
and Œ∏0
remain
nearly unbiased, and for the most part substantially more efficient than the correym
ye
sponding consistent estimator in {Œ∏0 , Œ∏0 , Œ∏0em }. When at least two models are
triply
triply,‚Ä†,1
triply,‚Ä†,2
mis-specified, the multiply robust estimators Œ∏0
, Œ∏0
and Œ∏0
gentriply
erally outperform the other estimators, although Œ∏0
occasionally succumbs to
the unstable weights resulting in disastrous mean squared error; see Table 5 when
triply,‚Ä†,2
generally improves
Model M and Model E are both incorrect. In contrast, Œ∏0
triply,‚Ä†,1
triply
triply,‚Ä†,1
on Œ∏0
which generally outperforms Œ∏0
and for the most part Œ∏0
triply,‚Ä†,2
and Œ∏0
appear to eliminate any possible deleterious impact of highly variable weights.
7. A comparison to some existing estimators. In this section, we briefly
compare the proposed approach to some existing estimators in the literature. Perhaps the most common approach for estimating direct and indirect effects when
Y is continuous uses a system of linear structural equations; whereby, a linear
structural equation for the outcome, given the exposure, the mediator and the confounders, is combined with a linear structural equation for the mediator, given

ESTIMATION OF THE MEDIATION FUNCTIONAL

1835

the exposure and confounders, to produce an estimator of natural direct and indirect effects. The classical approach of Baron and Kenny (1986) is a particular
instance of this approach. In recent work, mainly motivated by Pearl‚Äôs mediation
functional, several authors [Imai, Keele and Tingley (2010), Imai, Keele and Yamamoto (2010), Pearl (2011), VanderWeele (2009), Vanderweele and Vansteelandt
(2010)] have demonstrated how the simple linear structural equation approach generalizes to accommodate both, the presence of an interaction between exposure and
mediator variables, and a nonlinear link function, either in the regression model
for the outcome, or in the regression model for the mediator, or both. In fact, when
the effect of confounders is also modeled in such structural equations, inferences
based on the latter can be viewed as special instances of inferences obtained under
a particular specification of model Ma for the outcome and the mediator densities.
And thus, as previously shown in the simulations, an estimator obtained under a
system of structural equations will generally fail to produce a consistent estimator
of natural direct and indirect effects when model Ma is incorrect, whereas, by
using the proposed multiply robust estimator, valid inferences can be recovered
under the union model Mb ‚à™ Mc , even if Ma fails.
A notable improvement on the system of structural equations approach is the
double robust estimator of a natural direct effect due to van der Laan and Petersen (2005). Their estimator solves the estimating equation constructed using
eff,Ma ‚à™Mc
(Œ∏0 , Œ¥0 ) given in the online Appendix. They
an empirical version of SNDE,singleton
show their estimator remains CAN in the larger submodel Ma ‚à™ Mc and therefore, they can recover valid inferences even when the outcome model is incorrect,
provided both the exposure and mediator models are correct. Unfortunately, the
van der Laan estimator is still not entirely satisfactory because unlike the proposed
multiply robust estimator, it requires that the model for the mediator density is correct. Nonetheless, if the mediator model is correct, the authors establish that their
estimator achieves the efficiency bound for model Ma ‚à™ Mc at the intersection
submodel Ma ‚à© Mc where all models are correct; and thus it is locally semiparametric efficient in Ma ‚à™ Mc . Interestingly, as we report in the online supplement,
the semiparametric efficiency bounds for models Ma ‚à™ Mc and Ma ‚à™ Mb ‚à™ Mc
are distinct, because the density of the mediator variable is not ancillary for inferences about the M-functional. Thus, any restriction placed on the mediator‚Äôs
conditional density can, when correct, produce improvements in efficiency. This is
in stark contrast with the role played by the density of the exposure variable, which
as in the estimation of the marginal causal effect, remains ancillary for inferences
about the M-functional and thus the efficiency bound for the latter is unaltered by
any additional information on the former [Robins, Rotnitzky and Zhao (1994)]. In
the online Appendix, we provide a general functional map that relates the efficient
influence function for the larger model Ma ‚à™ Mb ‚à™ Mc to the efficient influence
for the smaller model Ma ‚à™ Mc where the model for the mediator is either parametric or semiparametric. Our map is instructive because it makes explicit using

1836

E. J. TCHETGEN TCHETGEN AND I. SHPITSER

simple geometric arguments, the information that is gained from increasing restrictions on the law of the mediator. In the online Appendix, we illustrate the map
by recovering the efficient influence function of van der Laan and Petersen in the
case of a singleton model (i.e., a known conditional density) for the mediator and
in the case of a parametric model for the mediator.
8. A semiparametric sensitivity analysis. We describe a semiparametric
sensitivity analysis framework to assess the extent to which a violation of the ignorability assumption for the mediator might alter inferences about natural direct
and indirect effects. Although only results for the natural direct effect are given
here, the extension for the indirect effect is easily deduced from the presentation.
Let
t (e, m, x) = E[Y1,m |E = e, M = m, X = x] ‚àí E[Y1,m |E = e, M = m, X = x],
then
Ye ,m ‚ä•‚ä• M|E = e, X,
that is, a violation of the ignorability assumption for the mediator variable, generally implies that
t (e, m, x) = 0

for some (e, m, x).

Thus, we proceed as in Robins, Rotnitzky and Scharfstein (2000), and propose to
recover inferences by assuming the selection bias function t (e, m, x) is known,
which encodes the magnitude and direction of the unmeasured confounding for
the mediator. In the following, the support of M, S is assumed to be finite. To
motivate the proposed approach, suppose for the moment that fM|E,X (M|E, X)
is known; then under the assumption that the exposure is ignorable given X, we
show in the Appendix that
E[Y1,m |M0 = m, X = x]
= E[Y1,m |E = 0, M = m, X = x]



= E[Y |E = 1, M = m, X = x] ‚àí t (1, m, x) 1 ‚àí fM|E,X (m|E = 1, X = x)




+ t (0, m, x) 1 ‚àí fM|E,X (m|E = 0, X = x) ,
and therefore the M-functional is identified by










E E[Y |E = 1, M = m, X] ‚àí t (1, m, X) 1 ‚àí fM|E,X (m|E = 1, X)
m‚ààS

+ t (0, m, X) 1 ‚àí fM|E,X (m|E = 0, X)

(5)
√ó fM|E,X (m|E = 0, X),



1837

ESTIMATION OF THE MEDIATION FUNCTIONAL

which is equivalently represented as
E

I {E = 1}fM|E,X (M|E = 0, X)
fE|X (1|X)fM|E,X (M|E = 1, X)










√ó Y ‚àí t (1, M, X) 1 ‚àí fM|E,X (m|E = 1, X)

(6)

+ t (0, M, X) 1 ‚àí fM|E,X (M|E = 0, X)

.

Below, these two equivalent representations, (5) and (6), are carefully combined
to obtain a double robust estimator of the M-functional, assuming t (¬∑, ¬∑, ¬∑) is
known. A sensitivity analysis is then obtained by repeating this process and reporting inferences for each choice of t (¬∑, ¬∑, ¬∑) in a finite set of user-specified
functions T = { tŒª (¬∑, ¬∑, ¬∑) : Œª} indexed by a finite dimensional parameter Œª with
t0 (¬∑, ¬∑, ¬∑) ‚àà T corresponding to the unmeasured confounding assumption, that
par
is, t0 (¬∑, ¬∑, ¬∑) ‚â° 0. Throughout, the model fM|E,X (¬∑|E, X; Œ≤m ) for the probability mass function of M is assumed to be correct. Thus, to implement the
sensitivity analysis, we develop a semiparametric estimator of the natural direct effect in the union model Ma ‚à™ Mc , assuming t (¬∑, ¬∑, ¬∑) =tŒª‚àó (¬∑, ¬∑, ¬∑) for a
fixed Œª‚àó . The proposed doubly robust estimator of the natural direct effect is
doubly ‚àó
doubly
doubly
(Œª ) ‚àí Œ¥0
where Œ¥0
is as previously described,
then given by Œ∏0
and
par

doubly ‚àó
Œ∏0
(Œª ) = Pn

I {E = 1}fM|E,X (M|E = 0, X)
par

par

fE|X (1|X)fM|E,X (M|E = 1, X)
Œ∑ par (1, 0, X; Œª‚àó ) ,
√ó {Y ‚àí Epar (Y |X, M, E = 1)} + 

with

Œ∑ par (1, 0, X; Œª‚àó )
 par

E

=

m‚ààS



par





par



(Y |X, M = m, E = 1) + tŒª‚àó (0, m, X) 1 ‚àí fM|E,X (m|E = 0, X)
‚àí tŒª‚àó (1, m, X) 1 ‚àí fM|E,X (m|E = 1, X)

par

√ó fM|E,X (m|E = 0, X).
doubly

doubly

(Œª) ‚àí Œ¥0
: Œª}
Our sensitivity analysis then entails reporting the set {Œ∏0
(and the associated confidence intervals), which summarizes how sensitive inferences are to a deviation from the ignorability assumption Œª = 0. A theoretical justification for the approach is given by the following formal result, which is proved
in the supplemental Appendix.

1838

E. J. TCHETGEN TCHETGEN AND I. SHPITSER

T HEOREM 4. Suppose t (¬∑, ¬∑, ¬∑) = tŒª‚àó (¬∑, ¬∑, ¬∑); then under the consistency, posidoubly ‚àó
(Œª ) ‚àí
tivity assumptions and the ignorability assumption for the exposure, Œ∏0
doubly
Œ¥0
is a CAN estimator of the natural direct effect in Ma ‚à™ Mc .
(Œª‚àó ) is provided in the Appendix, and can be
The influence function of Œ∏0
used to construct a corresponding confidence interval.
It is important to note that the sensitivity analysis technique presented here
differs in crucial ways from previous techniques developed by Hafeman (2008),
VanderWeele (2010) and Imai, Keele and Yamamoto (2010). First, the methodology of VanderWeele (2010) postulates the existence of an unmeasured confounder
U (possibly vector valued) which, when included in X, recovers the sequential
ignorability assumption. The sensitivity analysis then requires specification of a
sensitivity parameter encoding the effect of the unmeasured confounder on the
outcome within levels of (E, X, M), and another parameter for the effect of the
exposure on the density of the unmeasured confounder given (X, M). This is a
daunting task which renders the approach generally impractical, except perhaps
in the simple setting where it is reasonable to postulate a single binary confounder is unobserved, and one is willing to make further simplifying assumptions about the required sensitivity parameters [VanderWeele (2010)]. In comparison, the proposed approach circumvents this difficulty by concisely encoding a
violation of the ignorability assumption for the mediator through the selection
bias function tŒª (e, m, x). Thus the approach makes no reference and thus is agnostic about the existence, dimension and nature of unmeasured confounders U .
Furthermore, in our proposal, the ignorability violation can arise due to an unmeasured confounder of the mediator-outcome relationship that is also an effect
of the exposure variable, a setting not handled by the technique of VanderWeele
(2010). The method of Hafeman (2008) which is restricted to binary data, shares
some of the limitations given above. Finally, in contrast with our proposed double robust approach, a coherent implementation of the sensitivity analysis techniques of Imai, Keele and Yamamoto (2010), Imai, Keele and Tingley (2010) and
VanderWeele (2010) rely on correct specification of all posited models. We refer
the reader to VanderWeele (2010) for further discussion of Hafeman (2008) and
Imai, Keele and Yamamoto (2010).
doubly

9. Discussion. The main contribution of the current paper is a theoretically
rigorous yet practically relevant semiparametric framework for making inferences
about natural direct and indirect causal effects in the presence of a large number of
confounding factors. Semiparametric efficiency bounds are given for the nonparametric model, and multiply robust locally efficient estimators are developed that
can be used when nonparametric estimation is not possible.
Although the paper focuses on a binary exposure, we note that the extension
to a polytomous exposure is trivial. In future work, we shall extend our results

ESTIMATION OF THE MEDIATION FUNCTIONAL

1839

for marginal effects by considering conditional natural direct and indirect effects,
given a subset of pre-exposure variables [Tchetgen Tchetgen and Shpitser (2011)].
These models are particularly important in making inferences about so-called moderated mediation effects, a topic of growing interest, particularly in the field of psychology [Preacher, Rucker and Hayes (2007)]. In related work, we have recently
extended our results to a survival analysis setting [Tchetgen Tchetgen (2011)].
A major limitation of the current paper is that it assumes that the mediator is
measured without error, an assumption that may be unrealistic in practice and,
if incorrect, may result in biased inferences about mediated effects. We note that
much of the recent literature on causal mediation analysis makes a similar assumption. In future work, it will be important to build on the results derived in
the current paper to appropriately account for a mis-measured mediator [Tchetgen
Tchetgen and Lin (2012)].
APPENDIX
P ROOF OF T HEOREM 1. Let FO;t = FY |M,X,E;t FM|E,X;t FE|X;t FX;t denote a
one-dimensional regular parametric submodel of Mnonpar , with FO,0 = FO , and
let
Œ∏t = Œ∏0 (FO;t ) =



Et (Y |E = 1, M = m, X = x)

S √óX

√ó fM|E,X;t (m|E = 0, X = x)fX;t (x) dŒº(m, x).
eff,nonpar

The efficient influence function SŒ∏0
satisfy the following equation:

(Œ∏0 ) is the unique random variable to

eff,nonpar

‚àát=0 Œ∏t = E{SŒ∏0

(Œ∏0 )U }

for U the score of FO;t at t = 0, and ‚àát=0 denoting differentiation w.r.t. t at t = 0.
We observe that


‚àÇŒ∏t 
=
‚àát=0 Et (Y |E = 1, M = m, X = x)
‚àÇt t=0
S √óX

√ó fM|E,X (m|E = 0, X = x)fX (x) dŒº(m, x)

+



E(Y |E = 1, M = m, X = x)

S √óX

+



√ó ‚àát=0 fM|E,X;t (m|E = 0, X = x)fX (x) dŒº(m, x)
E(Y |E = 1, M = m, X = x)

S √óX

√ó fM|E,X (m|E = 0, X = x)‚àát=0 fX;t (x) dŒº(m, x).

1840

E. J. TCHETGEN TCHETGEN AND I. SHPITSER

Considering the first term, it is straightforward to verify that


‚àát=0 Et (Y |E = 1, M = m, X = x)fM|E,X (m|E = 0, X = x)fX (x) dŒº(m, x)

S √óX

=E U

fM|E,X (M|E = 0, X)
I (E = 1)
{Y ‚àí E(Y |E, M = m, X = x)}
.
fE|X (E|X)
fM|E,X (M|E = 1, X)

Similarly, one can easily verify that


E(Y |E = 1, M = m, X = x)‚àát=0 fM|E,X;t (m|E = 0, X = x)fX (x) dŒº(m, x)

S √óX

=E U

I (E = 0)
{E(Y |E = 1, M = m, X = x) ‚àí Œ∑(1, 0, X)} ,
fE|X (E|X)

and finally, one can also verify that


E(Y |E = 1, M = m, X = x)fM|E,X (m|E = 0, X = x)‚àát=0 fX;t (x) dŒº(m, x)

S √óX

= E[U {Œ∑(1, 0, X) ‚àí Œ∏0 }].
Thus we obtain
eff,nonpar

‚àát=0 Œ∏t = E{SŒ∏0

(Œ∏0 )U }.

eff,nonpar

(Œ¥e ), the results for the direct and indirect effect follow from the
Given SŒ¥e
fact that the influence function of a difference of two functionals equals the difference of the respective influence functions. Because the model is nonparametric,
there is a unique influence function for each functional, and it is efficient in the
model, leading to the efficiency bound results. 
P ROOF OF T HEOREM 2.

We begin by showing that
eff,nonpar

E{SŒ∏0

(7)

‚àó
(Œ∏0 ; Œ≤m
, Œ≤e‚àó , Œ≤y‚àó )}

=0

‚àó ) = (Œ≤ , Œ≤ ) under model M . Equalunder model Munion . First note that (Œ≤y‚àó , Œ≤m
y m
a
par
ity (7) now follows because E (Y |X, M, E = 1; Œ≤y ) = E(Y |X, M, E = 1) and
Œ∑(1, 0, X; Œ≤y , Œ≤m ) = E[{Epar (Y |X, M, E = 1; Œ≤y )}|E = 0, X] = Œ∑(1, 0, X):
eff,nonpar

E{SŒ∏0

(Œ∏0 ; Œ≤m , Œ≤e‚àó , Œ≤y )}
par

=E

I {E = 1}fM|E,X (M|E = 0, X; Œ≤m )
par

par

fE|X (1|X; Œ≤e‚àó )fM|E,X (M|E = 1, X; Œ≤m )

ESTIMATION OF THE MEDIATION FUNCTIONAL
=0



√ó E{Y ‚àí E
+E

par



1841



(Y |X, M, E = 1; Œ≤y )|E = 1, M, X}

I (E = 0)
par
fE|X (1|X; Œ≤e‚àó )



√ó E[{E

=0
par





(Y |X, M, E = 1; Œ≤y ) ‚àí Œ∑(1, 0, X; Œ≤y , Œ≤m )}|E = 0, X]

+ E[Œ∑(1, 0, X; Œ≤y , Œ≤m )] ‚àí Œ∏0
= 0.
Second, (Œ≤y‚àó , Œ≤e‚àó ) = (Œ≤y , Œ≤e ) under model Mb . Equality (7) now follows because
par
Epar (Y |X, M, E = 1; Œ≤y ) = E(Y |X, M, E = 1) and fE|X (1|X; Œ≤e ) = fE|X (1|X):
eff,nonpar

E{SŒ∏0

‚àó
(Œ∏0 ; Œ≤m
, Œ≤e , Œ≤y )}
‚àó)
I {E = 1}fM|E,X (M|E = 0, X; Œ≤m
par

=E

par

par

‚àó)
fE|X (1|X; Œ≤e )fM|E,X (M|E = 1, X; Œ≤m



=0

√ó E{Y ‚àí E
+E

par





(Y |X, M, E = 1; Œ≤y )|E = 1, M, X}

I (E = 0)
par
fE|X (1|X; Œ≤e )
‚àó
)}|E = 0, X]
√ó E[{Epar (Y |X, M, E = 1; Œ≤y ) ‚àí Œ∑(1, 0, X; Œ≤y , Œ≤m

‚àó
+ E[Œ∑(1, 0, X; Œ≤y , Œ≤m
)] ‚àí Œ∏0





= E E[{Epar (Y |X, M, E = 1; Œ≤y )}|E = 0, X] ‚àí Œ∏0 = 0.
Third, equality (7) holds under model Mc because
eff,nonpar

E{SŒ∏0

(Œ∏0 ; Œ≤m , Œ≤e , Œ≤y‚àó )}
par

=E

I {E = 1}fM|E,X (M|E = 0, X; Œ≤m )
par

par

fE|X (1|X; Œ≤e )fM|E,X (M|E = 1, X; Œ≤m )
√ó E{Y ‚àí Epar (Y |X, M, E = 1; Œ≤y‚àó )}

+E

I (E = 0)
par
fE|X (1|X; Œ≤e )

1842

E. J. TCHETGEN TCHETGEN AND I. SHPITSER

√ó E[{Epar (Y |X, M, E = 1; Œ≤y‚àó ) ‚àí Œ∑(1, 0, X; Œ≤y‚àó , Œ≤m )}|E = 0, X]
+ E[Œ∑(1, 0, X; Œ≤y‚àó , Œ≤m )] ‚àí Œ∏0


= E E[{E(Y |X, M, E = 1)}|E = 0, X]











‚àí E E[Epar (Y |X, M, E = 1; Œ≤y‚àó )|E = 0, X]

+ E E[Epar (Y |X, M, E = 1; Œ≤y‚àó )|E = 0, X] ‚àí E[Œ∑(1, 0, X; Œ≤y‚àó , Œ≤m )]
+ E[Œ∑(1, 0, X; Œ≤y‚àó , Œ≤m )] ‚àí Œ∏0




= E E[{E(Y |X, M, E = 1)}|E = 0, X] ‚àí Œ∏0 .
Assuming that the regularity conditions of Theorem 1A in Robins, Mark
eff,nonpar
(Œ∏0 ; Œ≤m , Œ≤e , Œ≤y ), SŒ≤ (Œ≤), the expression for
and Newey (1992) hold for SŒ∏0
union
‚àó
SŒ∏0 (Œ∏0 , Œ≤ ) follows by standard Taylor expansion arguments, and it now follows that
(8)

‚àö
1
triply
n(Œ∏0
‚àí Œ∏0 ) = 1/2
n

n

SŒ∏union
(Œ∏0 , Œ≤ ‚àó ) + op (1).
0 ,i

i=1

‚àö
triply
‚àí Œ∏0 ) under model Munion follows from
The asymptotic distribution of n(Œ∏0
the previous equation by Slutsky‚Äôs Theorem and the Central Limit Theorem.
doubly
We note that Œ¥e
is CAN in the union model Munion since it is CAN
in the larger model where either the density for the exposure is correct, or the
density of the mediator and the outcome regression are both correct and thus
‚àó ) = E(Y |X, E = e). This gives the multiply robust result for diŒ∑(e, e, X; Œ≤y‚àó , Œ≤m
rect and indirect effects. The asymptotic distribution of direct and indirect effect
estimates then follows from similar arguments as above.
At the intersection submodel
eff,nonpar

‚àÇE{SŒ∏0

(Œ∏0 , Œ≤)}

‚àÇŒ≤ T

=0

hence
eff,nonpar

SŒ∏union
(Œ∏0 , Œ≤) = SŒ∏0
0

(Œ∏0 , Œ≤).
triply

The semiparametric efficiency claim then follows for Œ∏0
ment gives the result for direct and indirect effects. 
P ROOFS OF T HEOREMS 3
pendix. 

AND

4.

, and a similar argu-

The proofs are given in the online Ap-

ESTIMATION OF THE MEDIATION FUNCTIONAL

1843

Acknowledgments. The authors would like to acknowledge Andrea Rotnitzky who provided invaluable comments that improved the presentation of the
results given in Section 7. The authors also thank James Robins and Tyler VanderWeele for useful comments that significantly improved the presentation of this
article.
SUPPLEMENTARY MATERIAL
Supplemental Appendix to Semiparametric theory for causal mediation
analysis (DOI: 10.1214/12-AOS990SUPP; .pdf). The supplementary material
gives the semiparametric efficiency theory for estimation of natural direct effects
with a known model for the mediator density. The Appendix also gives the proof
of Theorem 3 (stated in the Supplementary Appendix) and of Theorem 4.
REFERENCES
AVIN , C., S HPITSER , I. and P EARL , J. (2005). Identifiability of path-specific effects. In IJCAI-05,
Proceedings of the Nineteenth International Joint Conference on Artificial Intelligence, Edinburgh, Scotland, UK, July 30‚ÄìAugust 5, 2005 357‚Äì363.
BANG , H. and ROBINS , J. M. (2005). Doubly robust estimation in missing data and causal inference
models. Biometrics 61 962‚Äì972. MR2216189
BARON , R. M. and K ENNY, D. A. (1986). The moderator-mediator variable distinction in social
psychological research: Conceptual, strategic, and statistical considerations. J. Pers. Soc. Psychol.
51 1173‚Äì1182.
C AO , W., T SIATIS , A. A. and DAVIDIAN , M. (2009). Improving efficiency and robustness of the
doubly robust estimator for a population mean with incomplete data. Biometrika 96 723‚Äì734.
MR2538768
G OETGELUK , S., VANSTEELANDT, S. and G OETGHEBEUR , E. (2008). Estimation of controlled
direct effects. J. R. Stat. Soc. Ser. B Stat. Methodol. 70 1049‚Äì1066. MR2530329
H AFEMAN , D. (2008). Opening the black box: A reassessment of mediation from a counterfactual
perspective. PhD dissertation, Columbia Univ., New York.
H AFEMAN , D. M. and VANDERW EELE , T. J. (2011). Alternative assumptions for the identification
of direct and indirect effects. Epidemiology 22 753‚Äì764.
H AHN , J. (1998). On the role of the propensity score in efficient semiparametric estimation of average treatment effects. Econometrica 66 315‚Äì331. MR1612242
I MAI , K., K EELE , L. and T INGLEY, D. (2010). A general approach to causal mediation analysis.
Psychological Methods 15 309‚Äì334.
I MAI , K., K EELE , L. and YAMAMOTO , T. (2010). Identification, inference and sensitivity analysis
for causal mediation effects. Statist. Sci. 25 51‚Äì71. MR2741814
K ANG , J. D. Y. and S CHAFER , J. L. (2007). Demystifying double robustness: A comparison of
alternative strategies for estimating a population mean from incomplete data. Statist. Sci. 22 523‚Äì
539. MR2420458
P EARL , J. (2001). Direct and indirect effects. In Proceedings of the 17th Annual Conference on
Uncertainty in Artificial Intelligence (UAI-01) 411‚Äì442. Morgan Kaufmann, San Francisco, CA.
P EARL , J. (2011). The mediation formula: A guide to the assessment of causal pathways in nonlinear
models. Technical report. Available at http://ftp.cs.ucla.edu/pub/stat_ser/r379.pdf.
P REACHER , K. J., RUCKER , D. D. and H AYES , A. F. (2007). Assessing moderated mediation
hypotheses: Strategies, methods, and prescriptions. Multivariate Behavioral Research 42 185‚Äì
227.

1844

E. J. TCHETGEN TCHETGEN AND I. SHPITSER

ROBINS , J. M. (2000). Robust estimation in sequentially ignorable missing data and causal inference models. Proceedings of the American Statistical Association Section on Bayesian Statistical
Science 1999 6‚Äì10. Amer. Statist. Soc., Alexandria, VA.
ROBINS , J (2003). Semantics of causal DAG models and the identification of direct and indirect
effects. In Highly Structured Stochastic Systems (P. Green, N. Hjort and S. Richardson, eds.)
70‚Äì81. Oxford Univ. Press, Oxford.
ROBINS , J. M. and G REENLAND , S. (1992). Identifiability and exchangeability for direct and indirect effects. Epidemiology 3 143‚Äì155.
ROBINS , J. M., M ARK , S. D. and N EWEY, W. K. (1992). Estimating exposure effects by modelling
the expectation of exposure conditional on confounders. Biometrics 48 479‚Äì495. MR1173493
ROBINS , J. M. and R ICHARDSON , T. S. (2012). Alternative graphical causal models and the identification of direct effects. In Causality and Psychopathology: Finding the Determinants of Disorders
and Their Cures (P. Shrout, ed.). Oxford Univ. Press. To appear.
ROBINS , J. M. and ROTNITZKY, A. (2001). Comment on ‚ÄúInference for semiparametric models:
Some questions and an answer by P. J. Bickel and J. Kwon.‚Äù Statist. Sinica 11 920‚Äì936.
ROBINS , J. M., ROTNITZKY, A. and Z HAO , L. P. (1994). Estimation of regression coefficients when
some regressors are not always observed. J. Amer. Statist. Assoc. 89 846‚Äì866. MR1294730
ROBINS , J. M., ROTNITZKY, A. and S CHARFSTEIN , D. O. (2000). Sensitivity analysis for selection
bias and unmeasured confounding in missing data and causal inference models. In Statistical
Models in Epidemiology, the Environment, and Clinical Trials (Minneapolis, MN, 1997). IMA
Vol. Math. Appl. 116 1‚Äì94. Springer, New York. MR1731681
ROBINS , J., S UED , M., L EI -G OMEZ , Q. and ROTNITZKY, A. (2007). Comment: Performance of
double-robust estimators when ‚Äúinverse probability‚Äù weights are highly variable. Statist. Sci. 22
544‚Äì559. MR2420460
S CHARFSTEIN , D. O., ROTNITZKY, A. and ROBINS , J. M. (1999). Adjusting for nonignorable
drop-out using semiparametric nonresponse models. J. Amer. Statist. Assoc. 94 1096‚Äì1146.
MR1731478
TAN , Z. (2010). Bounded, efficient, and doubly robust estimation with inverse weighting. Biometrika
97 661‚Äì682.
T CHETGEN T CHETGEN , E. J. (2011). On causal mediation analysis with a survival outcome. Int. J.
Biostat. 7 Art. 33, 38. MR2843528
T CHETGEN T CHETGEN , E. J. and L IN , S. H. (2012). Robust estimation of pure/natural direct effects with mediator measurement error. Technical report, Dept. Epidemiology, Harvard School of
Public Health.
T CHETGEN T CHETGEN , E. J. and S HPITSER , I. (2011). Semiparametric estimation of models for
natural direct and indirect effects. Harvard Univ. Biostatistics Working Paper 129. Available at
http://biostats.bepress.com/harvardbiostat/paper129.
T CHETGEN T CHETGEN , E. J. and S HPITSER , I. (2012). Supplement to ‚ÄúSemiparametric theory
for causal mediation analysis: Efficiency bounds, multiple robustness and sensitivity analysis.‚Äù
DOI:10.1214/12-AOS990SUPP.
T CHETGEN T CHETGEN , E. J. and VANDERW EELE , T. J. (2012). On identification of natural direct
effects when a confounder of the mediator is directly affected by exposure. Harvard Univ. Biostatistics Working Paper 148. Available at http://biostats.bepress.com/harvardbiostat/paper148.
T SIATIS , A. A. (2006). Semiparametric Theory and Missing Data. Springer, New York. MR2233926
VAN DER L AAN , M. and P ETERSEN , M. (2005). Direct effect models. Working Paper 187. Univ.
California Berkeley Division of Biostatistics Working Paper Series. Available at http://www.
bepress.com/ucbbiostat/paper187.
VAN DER L AAN , M. J. and ROBINS , J. M. (2003). Unified Methods for Censored Longitudinal Data
and Causality. Springer, New York. MR1958123
VANDERW EELE , T. J. (2009). Marginal structural models for the estimation of direct and indirect
effects. Epidemiology 20 18‚Äì26.

ESTIMATION OF THE MEDIATION FUNCTIONAL

1845

VANDERW EELE , T. J. (2010). Bias formulas for sensitivity analysis for direct and indirect effects.
Epidemiology 21 540‚Äì551.
VANDERWEELE , T. J. and VANSTEELANDT, S. (2010). Odds ratios for mediation analysis for a
dichotomous outcome. Am. J. Epidemiol. 172 1339‚Äì1348.
D EPARTMENTS OF E PIDEMIOLOGY AND B IOSTATISTICS
H ARVARD S CHOOL OF P UBLIC H EALTH
677 H UNTINGTON AVENUE
B OSTON , M ASSACHUSETTS 02115
USA
E- MAIL : etchetge@hsph.harvard.edu

D EPARTMENT OF E PIDEMIOLOGY
H ARVARD S CHOOL OF P UBLIC H EALTH
677 H UNTINGTON AVENUE
B OSTON , M ASSACHUSETTS 02115
USA
E- MAIL : ishpitse@hsph.harvard.edu

