Biostatistics (2003), 4, 3, pp. 327–340
Printed in Great Britain

MARSHALL M. JOFFE∗ , THOMAS R. TEN HAVE, COLLEEN BRENSINGER
Department of Biostatistics and Epidemiology, University of Pennsylvania School of Medicine, 602
Blockley Hall, 423 Guardian Dr, Philadelphia, PA 19104-6021, USA
mjoffe@cceb.upenn.edu

S UMMARY
The compliance score in randomized trials is a measure of the effect of randomization on treatment
received. It is in principle a group-level pretreatment variable and so can be used where individual-level
measures of treatment received can produce misleading inferences. The interpretation of models with the
compliance score as a regressor of interest depends on the link function. Using the identity link can lead to
valid inference about the effects of treatment received even in the presence of nonrandom noncompliance;
such inference is more problematic for nonlinear links. We illustrate these points with data from two
randomized trials.
Keywords: Causal inference; Instrumental variables; Noncompliance; Potential outcomes; Randomized trials.

1. I NTRODUCTION
Many randomized trials are plagued with noncompliance. Until recently, analysts have been loathe
to use information on compliance in estimating treatment efficacy; the most obvious ways to use this
information on compliance, through ‘as treated’ analysis and its variants, are justly regarded as subject
to bias (Lee et al., 1991). There have been a number of recent proposals on how to use compliance
information; several of them involve a useful quantity known as the ‘compliance score’ (Follmann, 2000).
In this paper, we discuss the compliance score, its properties, and its proposed use as a regressor in
standard regression models. As we shall see, some of its usefulness in estimating treatment effects depends
on the measure of effect. We illustrate our points with data from two randomized trials.
2. O BSERVED AND LATENT DATA
Consider the data in a randomized trial. Let R be a randomization indicator: R = 1 for subjects
randomized to the experimental treatment, 0 if randomized to placebo. Let A refer to treatment received.
For a binary treatment, A = 1 indicates taking the study medication, 0 not taking it. More generally, A
indicates the dose of the active drug received, as a proportion of the medication prescribed to subjects
randomized to treatment; for subjects in the treatment arm, A = 1 indicates full compliance. Finally, let
X refer to pretreatment covariates, and Y refer to the outcome.
∗ To whom correspondence should be addressed

c Oxford University Press; all rights reserved.
Biostatistics 4(3) 

Downloaded from https://academic.oup.com/biostatistics/article-abstract/4/3/327/226509 by guest on 24 October 2019

The compliance score as a regressor in randomized
trials

328

M. M. J OFFE ET AL.
2.1

The compliance score

2.2 The potential outcomes model
We use the potential outcomes model (Neyman, 1990; Rubin, 1974) to define the effects of a treatment.
Let Y r,a denote the outcome that would be observed in an individual were he or she to be randomized to
group r and to receive treatment level a. The outcome Y r,a is only observed for subjects randomized to
group r who receive treatment level a, otherwise it is unobserved or counterfactual. Treatment effects are
defined in terms of comparisons of the potential outcomes Y r,a .
It is common to assume that randomization does not directly affect the outcome (Robins and
Greenland, 1992): i.e. that all of its effect is mediated by treatment received. Mathematically, this can
be written as


Y r,a = Y r ,a = Y a

(1)

for any r, r  . This assumption is sometimes called an exclusion restriction (Angrist, Imbens and Rubin,
1996).
Because the distribution of individual treatment effects is not generally estimable (Greenland and
Robins, 1986), we concentrate on aggregate causal effects, which are comparisons of the distributions
of different potential outcomes in the same population subgroups. Let µC ≡ E(Y |C) denote the mean
r,a
outcome in the subgroup characterized by variables C, and let µr,a
C ≡ E(Y |C) denote the expected
r,a
value of the potential outcome Y in that subgroup; subscripts denote subsets of the data, and superscripts
R,A
R,0
specify which potential outcomes are referenced. Comparisons of µ X,R,A
and µ X,R,A
are measures of the
effect of treatment received among subjects who received level A of treatment, and comparisons of µ1,a
X,R,A
and µ0,a
X,R,A are measures of the direct effect of randomization. When randomization has no direct effect
(1), the potential outcomes need be indexed only by treatment received a, and so we sometimes write the
singly superscripted µaX,R,A for µr,a
X,R,A .

Downloaded from https://academic.oup.com/biostatistics/article-abstract/4/3/327/226509 by guest on 24 October 2019

The compliance score δ X is E(A|R = 1, X ) − E(A|R = 0, X ). It is the effect of randomization on
treatment received on a difference scale. For a binary treatment A, it will sometimes also refer to the
proportion of compliers in the subset of the population with covariate level X . Let Ar denote the level of
treatment a subject would receive were he or she to be randomized to group r . Ar is a ‘potential receipt’
(Frangakis and Rubin, 1999) observed only if the observed R = r . A complier is defined here as a
subject who would follow whichever treatment to which he/she is randomized: i.e. for whom A1 = 1 and
A0 = 0. In a population with no defiers (i.e. subjects for whom A1 = 0 and A0 = 1), δ X is the proportion
of compliers among subjects with covariate level X . In a population which also has no always-takers (i.e.
subjects for whom A1 = 1 and A0 = 1), we can identify compliers in the treatment or experimental arm
as those who comply with their observed treatment (i.e. subjects for whom A = 1 and R = 1); compliers
in the control arm cannot be identified. When subjects randomized to the control or placebo arm have no
access to the active treatment, there are no defiers or always-takers, and E(A|R = 0, X ) = 0; thus, the
compliance score δ X is E(A|R = 1, X ) in this setting.
The compliance score is a function solely of pre-randomization covariates and may be calculated for
all subjects in a study, regardless of what treatment they are assigned. Thus, its use in analysis of data
from randomized trials does not run afoul of the injunction against using post-randomization variables in
estimating treatment effects. The compliance score, as the average effect of randomization on treatment
received in the subgroup with covariates X , can also be viewed as a group-level or aggregate variable.
Such variables are often included in regression models. Nonetheless, as in the analysis of ecologic data,
using such group-level variables to learn about individual-level effects has pitfalls (Morgenstern, 1982).

The compliance score as a regressor in randomized trials

329

g{E(Y |δ X , R)} = β0 + δ X β1 + Rβ2 + Rδ X β3 ,

(2)

where g(·) is a monotonic 1–1 link function (McCullagh and Nelder, 1989). One might view β2 as the
direct effect of randomization and β3 as the indirect effect: i.e. that part mediated by treatment received.
Further, some might regard β2 + β3 as the intent-to-treat comparison among compliers (Follmann,
2000). Especially for nonlinear models (i.e. link functions g(·) other than the identity function), these
interpretations are often unwarranted. When there is no variation in the compliance score δ X , as would be
the case if there is only a single stratum X or a trial with perfect compliance, β0 and β1 , and β2 and β3 are
not separately identified; we consider appropriate simpler models for this situation below.
One could also consider as an alternate model the somewhat more complicated
g{E(Y |X, δ X , R)} = β0 + δ X β1 + Rβ2 + Rδ X β3 + Xβ4 .

(3)

We concentrate on (2) because of its simplicity. In the development, it will emerge that the linearity
implied by δ X β1 in either equation and the absence of Xβ4 in either model are convenient simplifications
which may or may not be justified in particular applications; little should be read into them. The linearity
implied by Rδ X β3 plays a more central role.
3. M ODELS FOR THE OUTCOME
We consider the interpretation of model (2) in several settings. We first consider all-or-none
compliance, then settings in which compliance may take on multiple levels. For all-or-none compliance,
we consider the identity link, then the logit link.
We begin with some preliminaries. We can express some observed regressions like (2) in terms of
the compliance score and other variables: the effect of treatment received on outcome, the direct effect
1,0
1,0
of randomization, and selection bias. Let  X ≡ µ1,1
x,1,1 − µx,1,1 = µx,1,1 − µx,1,1 measure, on a linear
scale, the effect of treatment received among subjects randomized to treatment who take their assigned
0,0
treatment and who have covariate level X . Let  X,R,A ≡ µ1,0
X,R,A − µ X,R,A measure the direct effect of
0,1
randomization on outcome among subjects with observed variables {X, R, A}; note that µ1,1
X,R,A − µ X,R,A
is an alternative measure of direct effects (Joffe and Colditz, 1998; Robins and Greenland, 1992). Let
0,0
σ X,R,A ≡ µ0,0
X,R,A − µ X,R=0 indicate the difference in prognosis, among subjects with covariates X ,
between people in group R, A and the control group; σ X,R,A is a measure of selection bias (see Robins et
al. (2000)). The effects and bias terms may also be defined for other links; nonetheless, there is particular
advantage to considering the identity link, as will be explained.

Downloaded from https://academic.oup.com/biostatistics/article-abstract/4/3/327/226509 by guest on 24 October 2019

There have been two general approaches to estimating these effects for this setting. One, which we
call ‘estimation first’, posits a model for the observed outcome given observable quantities. The approach
then proposes a causal interpretation for the parameters in these models. The second approach, which
we call ‘estimands first’, starts with the potential outcomes and their comparisons, as above. It then
specifies assumptions which identify the causal estimands and valid procedures for their estimation. These
principled approaches are sometimes difficult to apply and software may be unavailable. Thus, it is of
interest to know when the ‘estimation first’ approach provides an adequate basis for inference for causal
effects.
Methods using the compliance score are among the more promising of ‘estimation first’ methods,
because they have been proposed formally for this setting (Follmann, 2000), are sometimes valid even in
the presence of nonignorable noncompliance, and do not use post-randomization variables as predictors
in the regression. We will formally consider models of the following form:

330

M. M. J OFFE ET AL.
3.1

All-or-none compliance

E(Y |X, R) = µ X,R = µ X,0,0 + R X,1,0 + Rδ X ( X +  X,1,1 −  X,1,0 ).

(4)

Each term in (4) corresponds to particular terms in (2): to µ X,0,0 to β0 + δ X β1 , R X,1,0 to Rβ2 ,
and Rδ X ( X +  X,1,1 −  X,1,0 ) to Rδ X β3 ; this will aid interpretation of (2). The selection bias term
σ X,R,A does not play a role in (4), because of a cancellation which occurs on the linear scale. We consider
interpretation of our observed regression (2) in light of (4) first for a single stratum with constant X , then
for multiple strata.
3.1.1 All-or-none compliance, single stratum. For a single covariate level X , there are two design
points in regression (2) (we do not use treatment received A in the regression except through the
compliance score δ X ): the group randomized to control, and that randomized to treatment. Because there
are two design points but four unknown parameters, model (2) is overparametrized for this setting; one
can set to 0 either β0 or β1 and either β2 or β3 . For the identity link function g(y) = y, we have (fixing
β3 = 0) that β2 =  X,1,0 + δ X ( X +  X,1,1 −  X,1,0 ).
If randomization has no direct effect (1), (4) simplifies to (5)
E(Y |X, R) = µ X,0,0 + δ X R X .

(5)

Under (5), it is useful to set β2 = 0 in the observed regression (2); then, β3 equals the effect  X of
treatment received. This interpretability of β3 under the assumption of no direct effects derives from the
fact that the expectation in (5) is linear in δ X R on an untransformed scale, and so depends on the use of
the identity link for the observed regression (2). Note that treatment effects on the untransformed scale
are identified without knowing the degree of selection bias σ X,R,A . We note that (5) can be rearranged to
give the usual Wald version of the instrumental variables formula (Angrist et al., 1996); i.e.
β3 =  X = {E(Y |X, R = 1) − E(Y |X, R = 0)}/δ X .
3.1.2 All-or-non compliance, identity link, multiple strata. When, as in the last section, one does
not account for covariates, the observed regression (2) can be used to identify the effect of treatment
received only under the assumption that randomization has no direct effect (1). We might think to use
the distribution of outcomes in different strata defined by baseline covariates X to disentangle the direct
and indirect effects of randomization. When compliance is associated with covariates X , the variation in
compliance with X can be used to disentangle these effects, but other assumptions must be substituted for
(1). Suppose that the direct effect of randomization on treatment received is the same for all X and A, so
that we can substitute a common  for  X,1,a and a common  for  X . These assumptions state, for
example, that both the direct effect of randomization and the effect of treatment received are the same for
men and women. The plausibility of these strong assumptions should be assessed in practical applications.
Under these assumptions, (4) becomes
E(Y |X, R) = µ X,0,0 + R + Rδ X .

(6)

Downloaded from https://academic.oup.com/biostatistics/article-abstract/4/3/327/226509 by guest on 24 October 2019

This section considers a simple but important setting, in which compliance is all-or-none, and in
which subjects randomized to control have no access to the active treatment. To examine the proposed
interpretations of the coefficients in (2), we write the marginal (with respect to A) expectation of the
outcome in terms of expectations of variables known by the time of randomization. In this setting, there is
a simple expression corresponding to the expectations modeled in (2) (see the Appendix for derivation):

The compliance score as a regressor in randomized trials

331

E(Y |X, δ X , R = 1) − E(Y |X, δ X , R = 0) =  + δ X .

(7)

Thus,  may be recovered from by taking the difference between the treated and control groups in
slopes in the regression of Y on δ X , even when those regressions are not linear; there is no need to
extrapolate the expected outcomes beyond the range of the compliance scores δ X . Under the assumption
that randomization has no direct effect, we can restrict β2 to equal 0; this is a model with common
intercepts in the treatment and control arms.
Alternatively, one can examine the fit of models (2) for the observed data. Departures from the model
for the observed data can indicate departures from causal assumptions (e.g. that the effect  X of treatment
received and the direct effect  X,1,a of randomization are the same across strata).
3.1.3
Nonlinear links, all-or-none compliance. With other links g(x)  = x, interpretation of
coefficients β in the regression model is more complicated; we illustrate this for the logit link, where
the model for the observed data (2) is
logit{E(Y |X, δ X , R)} = β0 + δ X β1 + Rβ2 + Rδ X β3 .

(8)

In our illustrations, treatment has no direct effect (1), compliance is all-or-none, people in the control
group have no access to the study treatment, and there is no selection bias (i.e. σ X,R,A = 0). Let  X ≡
{µ X,1,1 /(1−µ X,1,1 )}/{µ0X,1,1 /(1−µ0X,1,1 )} be the effect of treatment on the odds ratio scale for compliers
with covariates X .
Figure 1 illustrates regressions on the logit scale using the compliance score in two settings. In both
settings, the control group risk is derived from the linear logistic regression logit{E(Y |δ X , R)} = β0 +
δ X β1 . The treatment group risk at a given compliance score is derived from the control group risk, the
assumed treatment effect  X = exp(β3 ), the assumptions stated in the previous paragraph, and (5). In the
first setting, depicted in the left-hand panels, the compliance score is unassociated with risk in the control
group, µ X,0,0 , which is also the prognosis if unexposed for people in the treatment group µ0X,R=1,1 . In the
second setting, depicted in the right-hand panels, the compliance score is positively and linearly associated
with the logit of risk if unexposed, µ X,0,0 . The upper panels plot the observed risk E(Y |R, X ) in each
treatment arm as a function of the compliance score δ X . Even though the plots of the logit of the control
risk (‘control group’ line in the upper panels) are linear in δ X , the logit of the treatment risk (‘treatment
group’ lines) is not.

Downloaded from https://academic.oup.com/biostatistics/article-abstract/4/3/327/226509 by guest on 24 October 2019

When (6) holds on the basis of the above assumptions, we can provide causal interpretation to the
coefficients in the observed regression (2) using the identity link g(y) = y. If the model µ X,0,0 for the
mean response in the control group is correctly specified (e.g. as β0 + δ X β1 , as in (2)), the coefficient
β2 is the direct effect  of randomization on response, and the coefficient β3 is the effect  of treatment
received. If the direct effects  X,1,a are different among subjects who do and do not receive their assigned
treatment, the coefficient β3 does not equal the effect of treatment received  X ; the assumption of equal
effects  X,1,a is not testable in these data. Even if β3 is not the effect of treatment received, β2 and β2 +β3
are the intent-to-treat effects (i.e. the overall effect of randomization, both direct and mediated through
0,0
1,1
0,0
treatment received) among noncompliers (µ1,0
X,1,0 − µ X,1,0 ) and compliers (µ X,1,1 − µ X,1,1 ), respectively.
A heuristic view (Follmann, 2000) would look at extrapolating the expected outcomes E{Y |X, δ X , R}
to a group in which everyone is a complier: i.e. to look at E{Y |X, δ X = 1, R} The difference between
treatment and control in this group is then the overall effect of treatment β2 + β3 . This extrapolation is,
in principle, of little interest if there are no groups of subjects identifiable by pretreatment characteristics
with nearly perfect compliance, because we are extrapolating to groups which do not exist. Note that,
from (4), the difference between treatment and control groups in expected outcomes is

332

M. M. J OFFE ET AL.

The lower panels show the regression difference logit{E(Y |X, R = 1)} − logit{E(Y |X, R = 0)} as a
function of the compliance score. In both lower panels, the true regression difference is not linear in δ X .
This is most easily explained for the left-hand panels, where the control group risk does not vary with
compliance score, and so the risk difference E(Y |X, R = 1) − E(Y |X, R = 0) and the treated group risk
E(Y |X, R = 1) are linear in δ X . Transformation of the linear treated-group risk function to the logit scale
results in a nonlinear regression function logit{E(Y |X, R = 1)} and a nonlinear regression difference.
If the range of compliance scores is restricted, these regressions may appear linear. Suppose that
there are only two values of δ X , 0.5 and 0.7; a regression approximation (‘treatment group-regression
approximation’ in the top panels) is obtained by connecting the values of g{E(Y |X, R = 1)} for the two
values of δ X . Nonetheless, there may appear to be a main effects term β2 for randomization even though
there is no direct effect, especially if there are no strata with compliance scores close to 0. Further, the
slope β3 of the regression difference (‘regression approximation’ slopes in the lower panel of Figure 1)
will not generally equal the log odds ratio ln( X ) (‘true’ in the lower panel of Figure 1 at δ X = 1),
whether or not the main effect of randomization β2 is restricted to equal 0.
In both examples, we also considered a model with a common intercept, which might be thought
to represent the effect of treatment received under an assumption of no direct effects. The slope of the
regression difference is again an overestimate of the common causal log odds ratio ln( X ).

Downloaded from https://academic.oup.com/biostatistics/article-abstract/4/3/327/226509 by guest on 24 October 2019

Fig. 1.

The compliance score as a regressor in randomized trials
3.2

333

Multiple treatment levels, identity link

E(Y |X, R) = µ X,0 + δ X Rη X ,

(9)

where µ X,0 ≡ E(Y |X, R = 0). Again, if the proportional effect η X of treatment received is the same
for all X , and A = 1 indicates full compliance, β3 in the observed regression will equal the effect of
treatment in the fully compliant, and a regression of outcome on observable variables (the left-hand side
of (9)) can be used to learn about treatment effects defined through the potential outcomes approach (the
right-hand-side of (9)). As with (5), (9) can be rearranged to give the usual instrumental variables estimator
β3 = η X = {E(Y |X, R = 1) − E(Y |X, R = 0)}/δ X for stratum X .
4. A PPLICATIONS
4.1

Cholestyramine and cholesterol

We use data from two studies to illustrate the use of the compliance score. To illustrate continuous
outcomes, we use data from the Lipid Research Clinics Coronary Primary Prevention Trial (LRCCPPT), a randomized placebo-controlled double-blind trial of cholestyramine (CLT), a drug used to lower
cholesterol levels and, thereby, the risk of coronary events and death (Lipid Research Clinic Program,
1984a, 1984b). Efron and Feldman (1991) used a subset of this study to examine the effect of compliance;
we apply different methods towards the same end.
In the LRC-CPPT, serum cholesterol was measured at several pre-randomization and at bimonthly
post-randomization clinic visits for the duration of follow-up, which averaged 7.4 years. These clinic
visits were also used to dispense packets of their assigned medication; patients returned unused packets at
each clinic visit. The proportion of packets used is a measure of compliance.
As above, our endpoint is the serum cholesterol at the end of a fixed follow-up period, here one year
(400 days). We use as a scalar measure of the treatment received over the year (A) the proportion of the
total potential number of packets (number of days × 6 packets/day) used; for subjects who were prescribed
reduced doses because they could not tolerate the drug, this variable is not identical to percentage
compliance, such as used by Efron and Feldman (1991). Our model implicitly assumes that the actual
dose taken, not the relation of the dose taken to the prescribed dose, determines treatment response. This
would be reasonable if reasons for dose reduction are unrelated to the effect of CLT on serum cholesterol.
The distribution of compliance in the LRC-CPPT is skewed (Figure 2) and (essentially) has an upper
limit of 1. To model the data, we divided compliance into several ordered categories j, j = 0, ..., J . We
used the continuation ratio model (Greenland, 1994) (instead of the more commonly used ordinal logit or
proportional odds model (McCullagh et al., 1989), which we had trouble fitting to these data) to model
compliance with CLT (divided into several ordered categories) and so derive the compliance score δ̂ X . We
derived
the compliance score from the fitted probabilities π̂ j of falling in each category, and estimated
δ X as j π̂ j τ j , where τ j is the midpoint of the compliance values in each category; thus, for the lowest

Downloaded from https://academic.oup.com/biostatistics/article-abstract/4/3/327/226509 by guest on 24 October 2019

For treatments A with many levels, the situation is more complicated; because of difficulties with
nonlinear links g(·), we restrict attention to the identity link. It is less relevant to concentrate solely on the
effect of treatment on the compliers, since there are degrees of compliance and perhaps few if any subjects
will comply perfectly. We concentrate on the effect of treatment received and will consider models relating
dose of treatment to outcome. Let  X,R,A ≡ µ X,R,A − µ0X,R,A be the mean effect of treatment received A
on the outcome in the subgroup defined by the subscripted variables; we again assume that randomization
has no direct effect. We no longer assume that access to active treatment is limited to subjects randomized
to active treatment, but suppose that the effect of treatment received is linear in A, so that  X,R,A = η X A.
Under these assumptions, it can be shown that

334

M. M. J OFFE ET AL.

category (0  A < 0.2), τ j = 0.1. We modeled compliance A in this way in the treatment arm as a
function of pretreatment covariates X , which included age, race, sex, and center (Table 1); center was the
most potent predictor of compliance.
We next relate compliance scores to outcome. The top panel of Figure 3 plots the mean log cholesterol
against categorized compliance scores. Higher compliance scores are associated with lower cholesterol
levels, especially in the active treatment group.
We next fit regression models to the uncategorized data; Table 2 presents coefficients from regression
models for log cholesterol, using the compliance score as a regressor; some included a main effects term
β2 for treatment group R, and some restricted β2 to 0. Figure 3 plots the corresponding linear regression
lines. There is not much indication of departure from the assumption that randomization has no direct

Downloaded from https://academic.oup.com/biostatistics/article-abstract/4/3/327/226509 by guest on 24 October 2019

Fig. 2.

The compliance score as a regressor in randomized trials

335

Table 1. Continuation ratio model regression coefficients for compliance
outcome in treatment arm
Point estimate
−1.05
−4.90
−0.010

Standard error
0.37
2.54
0.005

0.33
0.56
−0.69
−0.31
0.03
−0.11
−0.09
0.21
−0.20
0.39
0.03

0.15
0.15
0.16
0.14
0.15
0.15
0.14
0.15
0.14
0.14
0.15

The model coefficients are for the model logit{ p A∗ < j|X, A∗  j)} = α j +
Xβ, where A∗ , the categorized compliance variable, has the following categories:
0 : A ∈ [0, 0.2); 1: A ∈ [0.2, 0.4); 2: A ∈ [0.4, 0.6); 3: A ∈ [0.6, 0.8); 4:
A ∈ [0.8, 0.9); 5: A ∈ [0.9, 0.95); 6: A ∈ [0.95, 1.0]. The cholesterol predictors
refer to the average or standard deviation of the predictors over the five initial
visits to the study, before randomization. The likelihood ratio chi-squared statistic
for clinic as a predictor was 104.5 with 11 degrees of freedom.

effect on cholesterol (1). Under (1), we estimate that the effect of full compliance on log cholesterol is
to reduce it by about 0.08 units; this corresponds to a decrease of about 17% in cholesterol. As in the
derivation of (9), this interpretation depends on the assumption that the effect of treatment does not vary
with age, race, sex, and center. The results are similar to results from G-estimation for the same data
(Joffe and Brensinger, 2001). The intent-to-treat effect is a decline of 0.057 units; as-treated analyses
yield a larger association, about 0.088 units.
The bottom panel of Figure 3 plots the difference in log cholesterol between treatment and placebo
groups as a function of the compliance score. Under (1), the extrapolation of the second line (i.e.
common intercept model) to a compliance score δ̂ X of 1 estimates the effect of CLT on outcome. One
can also estimate CLT’s efficacy by extrapolating estimates of the cholesterol difference in the different
compliance-score strata to δ̂ X = 1; Figure 3 also plots these estimates of efficacy. Despite visual
appearances, there is insufficient evidence to conclude that there is a downward trend in these efficacy
estimates.
Because in this and any application the compliance scores are estimated, variance estimates for the
effect of treatment received may be incorrect. To deal with this, we used a nonparametric bootstrap (Efron
and Tibshirani, 1993), in which we sampled subjects with replacement from the cohort and used the
bootstrap samples to recalculate the compliance score before regressing the outcome on the compliance
score and other regressors. Table 2 provides bootstrap standard errors as well as the nominal standard
errors obtained from the regression program.

Downloaded from https://academic.oup.com/biostatistics/article-abstract/4/3/327/226509 by guest on 24 October 2019

Predictor
Baseline log HDL cholesterol
Standard deviation baseline log cholesterol
Baseline age
Clinic (vs clinic 12)
1
2
3
4
5
6
7
8
9
10
11

336

M. M. J OFFE ET AL.

4.2

An educational intervention and cholesterol change

The second example data come from a study of an audio tape-based educational program to modify diet
and thereby cholesterol levels. This study comprised 266 African American adults, aged 40 to 70, with
high cholesterol and/or hypertension. Subjects were randomized to one of two arms. Both arms received
the same conventional printed nutritional materials for a general population of adults; subjects in the
experimental arm also received home-based audio tapes tailored to African Americans. Non-compliance
in the randomized-to-treatment group entailed non-use of the home-based audio equipment so that those
in the treatment arm were exposed to only the conventional print materials as those in the usual care
group were. Thus, treatment received (A) is binary. One of the primary outcomes in the study and which
is of interest in this paper is positive (i.e. beneficial) change in cholesterol according to established
criteria determined by NIH-sponsored panels (National Cholesterol Education Program (NCEP), 1993);
the outcome Y as used in the study was binary (improvement in cholesterol).

Downloaded from https://academic.oup.com/biostatistics/article-abstract/4/3/327/226509 by guest on 24 October 2019

Fig. 3.

0.02020

0.01638

-0.02310

-0.00793

Point
estimate
2.44321
-0.10953
0.02320

0.02038

Standard error
Nominal Bootstrap
0.01695
0.01493
0.03263
0.03280
-0.02577
0.02203
0.94317

Point
estimate
0.14267
-0.08072

0.01353
0.02384
0.02301

0.01305
0.02395
0.02339

Standard error
Nominal Bootstrap
0.05724
0.05817
0.00253
0.00232

Downloaded from https://academic.oup.com/biostatistics/article-abstract/4/3/327/226509 by guest on 24 October 2019

Bootstrap standard errors were based on 1000 bootstrap samples.

Intercept
Compliance score * randomization
assignment (δ ∗X R)
Compliance score (δ X )
Randomization assignment (R)
Baseline log cholesterol (X )

Standard error
Nominal Bootstrap
0.01192
0.01479
0.00306
0.00291

Point
estimate
2.45435
-0.07951

Table 2. Regression models for log cholesterol

The compliance score as a regressor in randomized trials
337

338

M. M. J OFFE ET AL.

5. D ISCUSSION
Methods using the compliance score as a regressor are closely related to other methods of analysis, in
particular methods (Angrist et al., 1996; Baker, 1998; Permutt and Hebel, 1989; Robins et al., 1992;
Robins et al., 2000) familiar to econometricians as instrumental variables methods. Some of these
methods (e.g. two-stage least squares) have been automated in commercial statistical software. Explicit
consideration of the compliance score has two advantages for data analysis. First, it forces the analyst to
consider explicitly the models for treatment received A, rather than using the default linear least squares
approach. One can use nonlinear models, as we have in our example, and take the requisite care in
examining such issues as interpretation of these models and goodness of fit. Second, using an explicitly
calculated variable δ X enables application of familiar regression methods and readily available plots and
diagnostics.
As we have seen, the causal interpretation of models using the compliance score with nonidentity links
can be problematic; these problems result from the familiar finding that the expectation of a nonlinear
function is not the nonlinear function of the expectation. Similar issues exist with proportional hazards
models, for which these methods have been suggested (Follmann, 2000). Estimating the effect of treatment
received in the presence of noncompliance in this setting may require using less familiar methods not
easily implemented using standard statistical software (Robins, 1994; Ten Have and Joffe, 2001).
The compliance score has other possible uses in randomized trials with noncompliance. Joffe and
Brensinger (2001) show that it can be used as a weight to improve efficiency in G-estimation. Further, the
compliance score is closely related to the propensity score (Follmann, 2000). In trials in which the control
group cannot obtain the active treatment, the compliance score of subjects in the treatment group is these
subjects’ propensity score. As such, standard methods for adjustment using the propensity score may be
used (Joffe and Rosenbaum, 1999; Robins et al., 1992; Rosenbaum and Rubin, 1983). The validity of
such adjustments relies on assumptions about the ignorability of noncompliance in the treatment group
(Rosenbaum et al., 1983), or, equivalently, of the comparability of subjects with the same compliance
scores but different levels of compliance (Greenland et al., 1986). Such analyses are essentially ‘as treated’

Downloaded from https://academic.oup.com/biostatistics/article-abstract/4/3/327/226509 by guest on 24 October 2019

We fit the regression models (2) to the data using both the identity and logit links. Most (78.36%)
subjects in the intervention group adhered. The compliance score δ X scarcely varied with covariates X .
Thus, the coefficient for the compliance score (β1 ) is highly collinear with the intercept (β0 ), and the coefficient for the compliance score-randomization interaction (β3 ) is collinear with the randomization main
effect (β2 ), and so we set β1 = β2 = 0, and take δ X = 0.7836 for all subjects. One-quarter of subjects
randomized to control improved, while a higher proportion in the active treatment group (0.366) did so.
Under the linear model, the effect of treatment received (β3 ) on a risk difference scale is 0.148(=
(0.366 − 0.25)/0.7836). Translating this into the odds ratio for compliers  X requires knowledge of the
selection bias σ X,1,1 , which is not identified only from regression (2). In cases such as this study, where
controls have no access to the active treatment, under the assumption that randomization has no direct
effects, we have σ X,1,1 = −σ X,1,0 (1 − δ X )/δ X , which is identified from the data as −(0.3103 − 0.2500) ∗
(1 − 0.7836)/0.7836 = −0.017. The expected outcome in compliers in the treatment group is µ X,1,1 =
µ X,0,0 +  X + σ X,1,1 = 0.25 + 0.148 − 0.017 = 0.381; to obtain the expected outcome in compliers had
they not complied, we subtract the effect of treatment  X to obtain µ1,0
X,1,1 = µ X,0,0 + σ X,1,1 = 0.381 −
0.148 = 0.233. Thus, the causal odds ratio  X for compliers is 0.381/(1 − 0.381)/(0.233/(1 − 0.233)) =
2.02. On the logit scale, we obtain a coefficient β3 for the randomization-compliance score interaction of
2.01. The closeness of the compliance-score regression estimator of the odds ratio to the better justified
estimate may be explained by the high proportion of compliers, requiring linear extrapolation only from
δ X = 0.78 to 1.0, and by the relatively small treatment effect; under these conditions, the two estimates
tend to differ little.

The compliance score as a regressor in randomized trials

339

analyses, which make no use of the fact of randomization and are widely and justly distrusted (Lee et al.,
1991). The methods proposed here avoid these problems.
A PPENDIX . D ERIVATION OF (4)
µ0,0
X,R,A

R,A
E(Y |X, R) = E{E(Y |X, R, A)|X, R} = E(µ X,R,A
|X, R)

= R{δ X µ X,1,1 + (1 − δ X )µ X,1,0 } + (1 − R)µ X,0,0 = µ X,0,0 + R(µ X,1,0 − µ X,0,0 )
+δ X R(µ X,1,1 − µ X,1,0 )
0,0
0,0
= µ X,0,0 + R{(µ X,1,0 − µ0,0
X,1,0 ) + (µ X,1,0 − µ X,0,0 )} + δ X R[{(µ X,1,1 − µ X,1,1 )
0,0
0,0
0,0
+(µ1,0
X,1,1 − µ X,1,1 ) + (µ X,1,1 − µ X,0,0 ) + µ X,0,0 } − {(µ X,1,0 − µ X,1,0 )

+(µ0,0
X,1,0 − µ X,0,0 ) + µ X,0,0 }]
= µ X,0,0 + R X,1,0 + δ X R X,1,1 − δ X R X,1,0 + δ X R X + R(1 − δ X )σ X,1,0 + δ X Rσ X,1,1
= µ X,0,0 + R X,1,0 + δ X R( X,1,1 −  X,1,0 ) + δ X R X .
ACKNOWLEDGEMENTS
MMJ was supported by a grant from the National Heart, Lung, and Blood Institute (grant R29
HL59184), and TRTH was supported by a grant from the National Cancer Institute (R29 CA69223).
The authors thank Drs Basil Rifkind, David Gordon, and Michael Hartman for assistance in obtaining
data from the LRC-CPPT study, and Dr Shiriki Kumanyika and her CARDES project (R01 HL46778)
for data on the study of the audiotape intervention. The authors thank the reviewers for helpful reviews;
in particular, they thank one reviewer for suggesting a discussion of distinctions between the ‘estimation
first’ and ‘estimands first’ approaches.
R EFERENCES
A NGRIST , J. D., I MBENS , G. W. AND RUBIN , D. B. (1996). Identification of causal effects using instrumental
variables (with discussion). Journal of the American Statistical Association 91, 444–472.
BAKER , S. G. (1998). Analysis of survival data from a randomized trial with all-or-none compliance: estimating the
cost-effectiveness of a cancer screening program. Journal of the American Statistical Association 93, 929–934.
E FRON , B. AND F ELDMAN , D. (1991). Compliance as an explanatory variable in clinical trials (with discussion).
Journal of the American Statistical Association 86, 9–26.
E FRON , B. AND T IBSHIRANI , R. J. (1993). Efron, B. (ed.), An Introduction to the Bootstrap. New York: Chapman
and Hall.
F OLLMANN , D. A. (2000). On the effect of treatment among would-be treatment compliers: an analysis of the
multiple risk factor intervention trial. Journal of the American Statistical Association 95, 1101–1109.
F RANGAKIS , C. AND RUBIN , D. (1999). Addressing complications of intention-to-treat analysis in the combined
presence of all-or-none treatment-compliance and subsequent missing outcomes. Biometrika 86, 365–379.
G REENLAND , S. (1994). Alternative models for ordinal logistic regression. Statistics in Medicine 13, 1665–1677.

Downloaded from https://academic.oup.com/biostatistics/article-abstract/4/3/327/226509 by guest on 24 October 2019

Let σ X,R,A ≡
− µ X,0,0 indicate the difference in prognosis between people in group R, A and
the control group (here not having access to the study treatment); σ X,R,A is a measure of selection bias.
0,0
0,0
0,0
Because of randomization, we have µ0,0
X,1,0 (1 − δ X ) + µ X,1,1 δ X µ X,0,0 = µ X,0,0 (1 − δ X ) + µ X,0,0 δ X ; this
in turn implies δ X σ X,1,1 = −(1 − δ X )σ X,0,0 .
We then have

340

M. M. J OFFE ET AL.

G REENLAND , S. AND ROBINS , J. M. (1986). Identifiability, exchangeability, and epidemiological confounding.
International Journal of Epidemiology 15, 412–418.
J OFFE , M. AND ROSENBAUM , P. (1999). Propensity Scores. American Journal of Epidemiology 150, 327–333.
J OFFE , M. M. AND B RENSINGER , C. (2002). Weighting in instrumental variables and G-estimation. Statistics in
Medicine, to appear

L EE , Y. J., E LLENBERG , J. H., H IRTZ , D. G. AND N ELSON , K. B. (1991). Analysis of clinical trials by treatment
actually received: is it really an option? Statistics in Medicine 10, 1595–1605.
L IPID R ESEARCH C LINIC P ROGRAM (1984a). The Lipid Research Clinics Coronary Primary Prevention Trial
results. I. Reduction in incidence of coronary heart disease. Journal of the American Medical Association 251,
351–364.
L IPID R ESEARCH C LINIC P ROGRAM (1984b). The Lipid Research Clinics Coronary Primary Prevention Trial
results. II. The relationship of reduction in incidence of coronary heart disease to cholesterol lowering. Journal of
the American Medical Association 251, 365–374.
M C C ULLAGH , P. AND N ELDER , J. A. (1989). McCullagh, P. (ed.), Generalized Linear Models, 2nd ed. London:
Chapman and Hall.
M ORGENSTERN , H. (1982). Uses of ecologic analysis in epidemiologic research. American Journal of Public Health
72, 1336–1344.
NATIONAL C HOLESTEROL E DUCATION P ROGRAM (NCEP) (1993). Summary of the second report of the NCEP
expert panel on detection, evaluation, and treatment of high blood cholesterol in adults (Adult Treatment Panel II).
Journal of the American Medical Association 269, 3015–3023.
N EYMAN , J. (1990). On the application of probability theory to agricultural experiments. Essay on principles.
Translated by D.M. Dabrowska and edited by T. P. Speed. Statistical Science 5, 465–472.
P ERMUTT , T. AND H EBEL , J. R. (1989). Simultaneous-equation estimation in a clinical trial of the effect of smoking
on birth weight. Biometrics 45, 619–622.
ROBINS , J. M. (1994). Correcting for non-compliance in randomized trials using structural nested mean models.
Communications in Statistics-Theory and Methods 23, 2379–2412.
ROBINS , J. AND G REENLAND , S. (1992). Identifiability and exchangeability for direct and indirect effects.
Epidemiology 3, 143–155.
ROBINS , J. M., M ARK , S. D. AND N EWEY , W. K. (1992). Estimating exposure effects by modelling the
expectation of exposure conditional on confounders. Biometrics 48, 479–495.
ROBINS , J. M. et al. (2000). Sensitivity Analysis for Selection Bias and Unmeasured Confounding in Missing Data
and Causal Inference Models. Halloran, E and Berry, D (eds), Statistical Models in Epidemiology. New York:
Springer, pp. 1–99.
ROSENBAUM , P. R. AND RUBIN , D. B. (1983). The central role of the propensity score in observational studies for
causal effects. Biometrika 70, 41–55.
RUBIN , D. B. (1974). Estimating causal effects of treatments in randomized and nonrandomized studies. Journal of
Educational Psychology 66, 688–701.
T EN H AVE , T. R. AND J OFFE , M. M. (2001). Causal logistic models for non-compliance under randomized treatment
with single endpoint binary response. Biometrics, submitted
[Received February 6, 2001; first revision August 3, 2001; second revision January 21, 2002;
accepted for publication February 21, 2002]

Downloaded from https://academic.oup.com/biostatistics/article-abstract/4/3/327/226509 by guest on 24 October 2019

J OFFE , M. M. AND C OLDITZ , G. A. (1998). Restriction as a method for reducing bias in the estimation of direct
effects. Statistics in Medicine 17, 2233–2249.

