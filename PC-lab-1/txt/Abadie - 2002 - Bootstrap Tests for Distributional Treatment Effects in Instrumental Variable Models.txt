Bootstrap Tests for Distributional Treatment Effects in Instrumental Variable Models
Author(s): Alberto Abadie
Source: Journal of the American Statistical Association, Vol. 97, No. 457 (Mar., 2002), pp.
284-292
Published by: Taylor & Francis, Ltd. on behalf of the American Statistical Association
Stable URL: https://www.jstor.org/stable/3085782
Accessed: 17-10-2019 16:05 UTC
REFERENCES
Linked references are available on JSTOR for this article:
https://www.jstor.org/stable/3085782?seq=1&cid=pdf-reference#references_tab_contents
You may need to log in to JSTOR to access the linked references.
JSTOR is a not-for-profit service that helps scholars, researchers, and students discover, use, and build upon a wide
range of content in a trusted digital archive. We use information technology and tools to increase productivity and
facilitate new forms of scholarship. For more information about JSTOR, please contact support@jstor.org.
Your use of the JSTOR archive indicates your acceptance of the Terms & Conditions of Use, available at
https://about.jstor.org/terms

American Statistical Association, Taylor & Francis, Ltd. are collaborating with JSTOR to
digitize, preserve and extend access to Journal of the American Statistical Association

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:05:27 UTC
All use subject to https://about.jstor.org/terms

Bootstrap Tests for Distributional Treatment
Effects in Instrumental Variable Models
Alberto ABADIE

This article considers the problem of assessing the distributional consequences of a treatment on some outcome variable of interest

treatment intake is (possibly) nonrandomized, but there is a binary instrument available for the researcher. Such a scenario is com

observational studies and in randomized experiments with imperfect compliance. One possible approach to this problem is to co
the counterfactual cumulative distribution functions of the outcome with and without the treatment. This article shows how to estimate

these distributions using instrumental variable methods and a simple bootstrap procedure is proposed to test distributional hypotheses,
such as equality of distributions, first-order and second-order stochastic dominance. These tests and estimators are applied to the study
of the effects of veteran status on the distribution of civilian earnings. The results show a negative effect of military service during the

Vietnam era that appears to be concentrated on the lower tail of the distribution of earnings. First-order stochastic dominance cannot be
rejected by the data.

KEY WORDS: Compliers; Empirical processes; Kolmogorov-Smirnov test; Stochastic dominance.

1. INTRODUCTION

(for P(l) dominating P(0)), then these distributions will be

ranked in the same way by any monotonic utilitarian social
Although most empirical research on treatment effects focus
welfare function (u' > 0). If two income distributions can be
on the estimation of differences in mean outcomes, analysts
ranked by second-order stochastic dominance,
have long been interested in methods for estimating the impact
of a treatment on the entire distribution of outcomes. This is

especially true in economics, where social welfare compar-(fdr

())dP y fz (f dP()fy(o))) dz Vx > (2)

isons may require integration of utility functions under alter-

native distributions of income. Following Atkinson (1970),
(for P(M) dominating P(0)), then these distributions will be
consider the class of symmetric utilitarian social welfare
ranked in the same way by any concave monotonic utilitarfunctions:
ian social welfare function (u' > O, u" < 0) (see Foster and
Shorrocks 1988
W(P, u)= f u(y) dP(y),

for details). Therefore, stochastic dominance

can be used to evaluate the distributional consequences of

where P is an income distribution and u: lR ~- R is a twice

treatments under mild assumptions about social preferences.
continuously differentiable individual utility function. Let P(1)
Another possible question is whether the treatment has any
and P(0) denote the (potential) distributions that income would
effect on the distribution of the outcome, that is, whether or
follow if the population were exposed to the treatment in one
case, and excluded from the treatment in the other case.not
If the
u two distributions P(1) and P(0) are the same.

In general, the assessment of the distributional conse-

is completely specified (u = u) we rank P(1) and P(0) by comquences of treatments may be carried on by estimating
paring W(P(l), u) and W(P(o), u). Note that affine transformaP() and P(0). Estimation of the potential income distributions of u do not affect the ranking of any two distributions.
tions,
Typically, u is not fixed by the analyst but is restricted to P(M) and P(0), is straightforward when the treatment
is randomly assigned in the population. However, this type
have some desirable properties. In particular, social welfare
of analysis becomes difficult in observational studies (or in

(W(P, u)) is usually assumed to increase with the income
randomized experiments with imperfect compliance) when
of any subset of individuals in the population (u' > 0). If
treatment intake is not randomly determined. Recently, Imbens
u is affine, then W(P, u) ranks income distributions solely
and Rubin (1997) have shown that, when there is a binary
on the basis of average income. However, distributional coninstrumental variable available for the researcher, the poten-

siderations often motivate social welfare functions that favor

tial distributions of the outcome variable are identified for the

income redistribution to the poorer (u' > 0 and u" < 0). Under
subpopulation potentially affected in their treatment status by
these assumptions, stochastic dominance can be used to establish a partial ordering on the distributions of income. If twovariation in the instrument (the so-called compliers). In addiincome distributions can be ranked by first-order stochastiction, Abadie, Angrist and Imbens (in press) have studied distributional effects of treatments for compliers in instrumental
dominance,

variable models using quantile regression techniques. How-

Jx J Vx>0 (1)x

dP() (y) < dP(o)(y) Vx > 0 (1)

ever, up to date, no testing procedure has been proposed to
compare entire potential outcome distributions for compliers.
This article proposes a bootstrap strategy to perform this kind
of comparison. In particular, equality of distributions, firstAlberto Abadie is Assistant Professor, John F. Kennedy School of
order and second-order stochastic dominance hypotheses, all
Government, Harvard University, Cambridge, MA 02138 (E-mail:
alberto_abadie@harvard.edu). The author thanks Joshua Angrist for
comimportant
for social welfare comparisons, are considered.
ments and for providing the data, and Jinyong Hahn, Kei Hirano, Guido

Imbens, Tom Knox, Guido Kuersteiner, Whitney Newey, Emmanuel Saez, Jim
Stock, seminar participants at the 2000 Econometric Society North American

Winter Meeting in Boston and the 2001 Conference of Econometrics and

Mathematical Economics in Rochester, the editor, an associate editor, and

? 2002 American Statistical Association
Journal of the American Statistical Association

the referees for helpful comments.

March 2002, Vol. 97, No. 457, Theory and Methods
284

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:05:27 UTC
All use subject to https://about.jstor.org/terms

285

Abadie: Bootstrap Tests for Distributional Treatment Effects

The proposed method is applied to the study of the

individual with treatment. Define Di to be the treatment p

effects of Vietnam veteran status on the distribution of civil-

ipation indicator (that is, Di equals one when individua
ian earnings. Following Angrist (1990), random variation in been exposed to the treatment, Di equals zero otherwis
enrollment induced by the Vietnam era draft lottery is usedZi be a binary variable that is independent of the resp
to identify the effects of veteran status on civilian earnings.Y,(0) and Yi(l) but that is correlated with Di in the
However, the focus of the present article is not restricted totion (an instrument). Denote Di(0) the value that Di
have taken if Zi = 0; Di(l) has the same meaning for
the average treatment effect for compliers. The entire marginal
In
practice, for any particular individual the analyst d
distributions of potential earnings for veterans and nonveterobserve
both potential treatment indicators Di(0) an
ans are described for this subgroup of the population. These
Instead
the
realized treatment Di = Di (1) . Zi + Di (0) (1
distributions differ in a notable way from the correspondis
observed.
In the same fashion, the analyst does not
ing distributions of realized earnings. Veteran status appears
both
Yi(0)
and
Y,(1) for any individual i, one of these
to reduce lower quantiles of the earnings distribution, leav-

ing higher quantiles unaffected. Although the data show a fairtial outcomes is counterfactual. Only the realized ou
amount of evidence against equality in potential income dis- Yi = Yi(l) - Di + Y,(0) - (1 - Di), is observed. In the analy
randomized experiments with imperfect compliance, Z
tributions for veterans and nonveterans, statistical testing falls
ally represents treatment assignment (randomized) whe
short of rejecting this hypothesis at conventional significance
represents treatment intake (nonrandomized). In observ
levels. First- and second-order stochastic dominance of the
studies, instruments are often provided by the so-calle
potential income distribution for nonveterans are not rejected
ral experiments or quasiexperiments. For the rest of the
by the data.
use
the following identifying assumption:
The rest of the article is structured as follows. In Section 2,
a framework for identification of treatment effects in instru-

mental variable models is briefly reviewed. It also shows how
to estimate the distributions of potential outcomes for compliers. In contrast with Imbens and Rubin (1997) who report histogram estimates of these distributions, here a simple method
is shown to estimate the cumulative distribution functions (cdf)

of the same variables. An approach based on cdfs rather than
histograms is often convenient. First, the problem of choos-

ing adequate binwidths for histograms is avoided. The cdf,
estimated by instrumental variable methods, can be evaluated
at each observation in our sample, just as for the conventional empirical distribution function. Moreover, as inspection of equations (1) and (2) reveals, first- and second-order
stochastic dominance can be easily defined in terms of cdfs.
Estimated cdfs may therefore suggest stochastic dominance
between estimated distributions in a way that would be hard
to visualize from histograms. In addition, tests for stochastic
dominance can be easily constructed within the well-known
family of tests which are based on differences in cdfs (see Dar-

ling 1957 for a review of this class of tests). In summary, an
approach to estimation of distributions of potential outcomes
based on cdfs is important because it is often easier to define,
visualize, and test some distributional hypotheses of interest, such as first- or second-order stochastic dominance, using
cdfs rather than histograms (see, however, Anderson 1996 for

an approach to test for stochastic dominance based on histograms; approaches based on nonparametric density estimation can also be conceived for the case in which the outcome

Assumption 2.1.

(i) Independence of the Instrument: (Yi(0), Yi(1),
Di ()) is independent of Zi.

(ii) First Stage: 0 < P(Zi = 1) < 1 and P(Di(1) =
P(Di(O) = 1).
(iii) Monotonicity: P(Di,() > Di(0)) = 1.

Assumption 2.1 contains a set of nonparametric restri
under which instrumental variable models identify th

effect of the treatment for the subpopulation pote

affected in their treatment status by variation in the i

ment: Di(l) = 1 and Di(0) = 0 (see Imbens and Angris
Angrist, Imbens, and Rubin 1996). This subpopula

sometimes called compliers. When the treatment intak

is itself randomized, Assumption 2.1 holds for Zi =

every individual is a complier.
Notice that there are some important exclusion restri
implicit in the notation. First, for each individual i, po
treatment indicators (Di(0), Di(l)) are not affected by t
ues taken by the instrument for other individuals Z1,
in the same fashion, potential outcomes (Yi(0), Y,(1)) ar
affected by the values taken by the treatment and inst

for other individuals (Zj, Dj), j - i. This restriction i
stable-unit-treatment-value-assumption (SUTVA) and i
quently used in statistical models of causal inferen
Rubin 1990). In addition, potential outcomes (Yi(0),
not depend on Zi. This last restriction, commonly inv

instrumental variable models, allows us to attribute corr
between the instrument and the outcome variables to the effect

variable of interest has a continuous distribution). A com-

of the
plete description of the bootstrap strategy is also provided
intreatment alone (see Angrist et al. 1996 for a more elaborate
Section 2, along with a proposition which states the asymp- discussion of the restrictions in Assumption 2.1).
In this article, distributional effects of possibly nonrandomtotic validity of the bootstrap for the tests proposed in this
ized treatments are studied by comparing the distributions
article. Section 3 describes the data and presents the empirical

of potential outcomes Y,(1) and Y,(0) with and without the

results. Section 4 concludes.

2. STATISTICAL METHODS

treatment. The first step is to show that the identification conditions in Assumption 2.1 allow us to estimate these distribu-

tions for the subpopulation of compliers. To estimate the cdfs
Let Yi(0) be the potential outcome for individualofi potential
withoutoutcomes for compliers, the following lemma will
be useful.
treatment, and Y,(l) be the potential outcome for
the same

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:05:27 UTC
All use subject to https://about.jstor.org/terms

Journal of the American Statistical Association, March 2002

286

First-order stochastic dominance: FA dominates FB if

Lemma 2.1. Let h(.) be a measurable function on the real
line such that EIh(Yi)I < oo. If Assumption 2.1 holds, then

FA(Y) < FB() Vy E

E[h(Yi)DilZi = 1] - E[h(Y)DilZi = 0]
E[Di Zi = 1]- E[Di Zi = 0]

(H.2)

Second-order stochastic dominance: FA dominates F. if

FA(x) dx < FB(x) dx VyE R

= E[h(Y(l))IDi(O) = 0, Di(l) = 1], (3)

-x

(H.3)

-O0

One possible way to carry out these tests for the distributions of potential outcomes for compliers is to use statistics
directly based on the comparison between the estimates for

and

E[h(Yi)(1 - i)lZi = 1] - E[h(Yi)(l - Di)lZ = 0]
E[(1-Di)|Z = 1] - E[(1 -Di)IZi = 0]

F) and Fc. However, it is easier to test the implications of

= E[h(Yi(0))D,(0) = 0, Di(l) = 1]. (4)

these hypotheses on the two conditional distributions of the
outcome variable, given Zi = 1 and Zi = 0. Denote F, the cdf
of the outcome variable conditional on Zi = 1, and define Fo in

Proof. Note that h(Yi)Di is equal to h(Yi(l)) if Di = 1 andthe same way for Zi = 0. That is, F (y) = E[l {Yi < y}lIZ = I]

equal to 0 if Di = 0. By Lemma 4.2 in Dawid (1979), we have and Fo(y) = E[{Yi < y}lZ, = 0].

that (h(Yi(1)), 0, Di(0), Di(1)) is independent of Zi. Then by Proposition 2.1. Under Assumption 2.1, hypotheses
(H.1)-(H.3) hold for (FA, FB) = (F), FC)) if and only if they
hold for (FA, F) = (F, Fo).

Theorem 1 in Imbens and Angrist (1994), we have that

E[h(Y(l))lDi(0) = 0, D(1l) = 1]

Proof. From equations (5) and (6), we have

E[h(Yi) . DilZi = 1] - E[h(Y,) . DiiZi = 0]

F) (y) - F() (y)

E[D,lZi = 1]-E[DilZi = 0]

E[{Yi < y}Zi= 1]-E[l{Yi < y}Zi = 0]
E[D, IZ = 1]- E[D,IZi = 0]

The second part of the lemma follows from an analogous argument.

Lemma 2.1 provides a simple way to estimate the cumulaTherefore, Fc()- F() = K (F1 - Fo) for K = 1/(E[D lZi =
1] - E[Di[Zi = 0]) < oo, and the result of the proposition
tive distribution functions of the potential outcomes for comholds.
pliers. Define Fc)(y) = E[l{Y(1) < y}lD(l) = 1, Di(0) =0]
and F(o)(y) = E[l{Yi(0) < y}]Di(l) = 1, Di(0) = 0]. ApplyOf course F1 and Fo can easily be estimated by the empir-

Lemma 2.1 with h(Y) = 1 {Yi < y} to get

ical distribution of Yi for Zi = 1 and Z_ = 0, respectively.

F((y) = {E[1{Yi < y}DilZi = 1]-E[I{Yi < y}DilZi = 0]}

Divide (Y, ..., Yn) into two subsamples given by different values for the instrument, (Y ,l ..., Y I ) are those observations

/{E[Di Z, = 1]- E[D IZi = 0]}, (5)
and

with Zi = 1 (n1 = Ei Zi) and (Y ..., Y ,,o) are those with
Zi = 0 (no = Ei 1 - Zi). Consider the empirical distribution
functions
1 n'

F,,n,(y)= E { Yi < y

F(o)(y) = {E[l{Yi < y}(l - Di)jZi = 1]
-E[l{Yi < y}(l - D)Zi = 0]}

/{E[( -Di)|Zi = 1]-E[(1 - Di)Zi = 0]}. (6)

F0.no(Y)= - y l{Yj _y}.
no j=lI

Suppose that we have a random sample, {(Yi, Di, Zi)}l, Then, the Kolmogorov-Smirnov statistic provides a nat-

drawn from the studied population. The sample counterparts
ural way to measure the discrepancy in the data from

of equations (5) and (6) can be used to estimate FC()(y) and
the hypothesis of equality of distributions. A two-sample
F(o)(y) for y = {Y..., . ., . We can compare the distribu-Kolmogorov-Smirnov statistic can be defined as

tions of potential outcomes by plotting the estimates of Fc)

Teq _ n=no)
and F(). This comparison tells us how the treatment affects
sup
IF,., (y)-F O) nO(y)
e[R
different parts of the distribution of the outcome variable, at
least for the subpopulation of compliers.
Following McFadden (1989), the Kolmogorov-Smirnov
Researchers often want to formalize this type of comparison
statistic can be modified to test the hypotheses of first-order
using statistical hypothesis testing. In particular, a researcher
stochastic dominance (for Fl dominating Fo)
may want to compare Fc) and F() by testing the hypotheses
of equality in distributions, first-order or second-order stochasrfsd (nl no )/2 sup(F (Y)F-n o (y/))
n vER
tic dominance. For two distribution functions FA and FB, the

T= sup , (y) - , ,0 (Y)),

hypotheses of interest can be formulated as follows.
Equality of distributions:

FA(y)=(y) FB() Y R.

(7)

(8)

and second-order stochastic dominance

(H.1)

(9)
T (Sd \---= (nUt0)
/ sup (F,ln(x)-Fo,, ())dx.
yER oc

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:05:27 UTC
All use subject to https://about.jstor.org/terms

287

Abadie: Bootstrap Tests for Distributional Treatment Effects

Kolmogorov-Smirnov type nonparametric distance tests
generally have good power properties. Unfortunately, the
asymptotic distributions of the test statistics under the null

simplifies the asymptotic analysis considerably and is hardly
restrictive for empirical applications.
The results of a simulation study to assess the small sample

hypotheses are generally unknown, because they depend

performance of the tests proposed in this article are reported in

Romano 1988). In this article, a bootstrap strategy is used

Appendix B. This simulation study suggests that the bootstrap
distribution of the tests provides a good approximation to the

on the underlying distribution of the data (see e.g.,

to overcome this problem. This strategy is described by the
following 4 steps:

Step 1: In what follows, let Tn be a generic notation for
Teq Tfsd or TSSd. Compute the statistic Tn for the original
samples (Y,,, .... Yln, ) and (Y0o,, ... Yo,no)'

nominal level even in fairly small samples.

The idea of using resampling techniques to obtain critical values for Kolmogorov-Smimov type statistics probably

originated with Bickel (1969) and has also been used by
Romano (1988), McFadden (1989), Klecan, McFadden, and
McFadden (1991), Praestgaard (1995) and Andrews (1997)

among others. A related approach based on simulation of pStep 2: Resample n observations (Y ...,) from
values
(Y, . . ., Y with replacement. Divide (Y1 .. ., Y) into
twocan be found in Barrett and Donald (1999).
Note that Proposition 2.2 naturally applies to tests based
samples: (Yl1, ...Y, ,n) given by the nl first elements

on perfectly
randomized experiments (in which Zi = Di for
of (Y ..., Yn), and (Y0,1 ..., Y,no) given by the no last
eleall
i).
In
such
case, the entire population is madeup of comments of (Yl, ..., Y). Use these two generated samples to

pliers. Another interesting special case arises when Di(0) = 0
for all i. This happens, for example, in randomized trials if
Step 3: Repeat Step 2, B times. Note that no and individuals
n1 are
in the control group are perfectly excluded from
constant across bootstrap repetitions.
treatment intake (not ruling out noncompliance in the treat-

compute the test statistic Tn,b.

ment group).
Then, the distribution of (Yi(0), Yi(1)) for the
Step 4: Calculate the p-values of the tests with p-value
=

E= 1 {Tn,b > Tn}/B. Reject the null hypotheses if the treated
p-valueis the distribution for compliers (see, e.g., Abadie et al.
in
is smaller than some significance level a, 0 < a < 0.5. press).

By resampling from the pooled data set (Y1 ..., Yn) we

3. EMPIRICAL EXAMPLE
approximate the distribution of our test statistics when F1 =
Fo. Note that for (H.2) and (H.3), F, = Fo represents the least
Theusdata used in this study consist of a sample of 11,6
favorable case for the null hypotheses. This strategy allows
white
men, born in 1950-1953, from the March Current
to estimate the supremum of the probability of rejection under
ulation
the composite null hypotheses, which is the conventional def- Surveys of 1979 and 1981-1985. Annual labor
ings,
inition of test size. The proof of next proposition shows
that,weekly wages, Vietnam veteran status and an i
cator
of draft-eligibility based on the Vietnam draft
under a nondegeneracy condition, the asymptotic distributions
tery
outcome
are provided for each individual in the
of Tfsd and Tssd are continuous, perhaps except for an atom at
ple.
Additional
information about the data can be fou
zero that must have probability mass less than 0.5. Therefore,
Appendix C.
the restriction that a < 0.5 is necessary to establish asymptotic
Figure 1 shows the empirical distribution of realized annual
size a. This restriction is, however, consistent with conven-

labor earnings (from now on, annual earnings) for veterans and

tional test levels.

nonveterans. We can observe that the distribution of earnings
Assumption 2.2. The distribution of the outcome variable
for veterans has higher low quantiles and lower high quantiles
is nondegenerate with bounded support.
than that for nonveterans. Naive reasoning would lead us to
that military service during the Vietnam era reduced
Justification of the asymptotic validity of this procedure conclude
is

the probability of extreme earnings without a strong effect
on average earnings. The difference in means is indeed quite
Proposition 2.2. Under Assumption 2.2, the procedure
small. On average, veterans earn only $264 less than nonvetdescribed in Steps 1-4, for Tn equal to the test statistics in
erans and this difference is not significant at conventional test
equations (7)-(9) and hypotheses (H.1)-(H.3), (i) provides
levels. However, this analysis does not take into account that
correct asymptotic size, a, (ii) is consistent against any fixed
veteran status was not randomly assigned in the population. In
alternative, (iii) has power (greater or equal to size) against
fact, there was a strong selection process in the military durcontiguous alternatives.
ing the Vietnam era. Some individuals volunteered, and others avoided enrollment using different methods, like student
This proposition is proven in Appendix A. Note that the disor occupational deferments. In addition, there was a screening
tribution of Yi is not assumed to be continuous. This is imporprocess in the military prior to enrollment which disqualified
tant because outcome variables of interest in economics typisome individuals for service for a variety of reasons such as
cally have probability atoms (for example, earnings variables
typically have probability mass at zero; wage variables typihaving health problems or for having committed a felony (see
Baskir and Strauss 1978 for an account of the issues involved
cally have probability mass at the minimum wage.) If the out-

provided by the following proposition.

come variable is absolutely continuous, then exact asymptotic
in military enrollment during the Vietnam era). Thus, enrollresults can be obtained (as in Dudley 1989, chap. 12). The
ment for military service during the Vietnam era was influbounded support assumption is stronger than necessary, but
enced by variables associated with future potential earnings.

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:05:27 UTC
All use subject to https://about.jstor.org/terms

288

Journal of the American Statistical Association, March 2002
1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

30,000 40,0C
Annual earnings

Figure 1. Empirical Distributions of Earnings for Veterans and Nonveterans.

Therefore, we cannot draw causal inferences
by
simply(H.
comabout
hypotheses
)-(H.3) for the subpopulation of comparing the distributions of realized earnings
between
veterans
pliers.
(The computer
code used for these calculations is availand nonveterans.

able from the author on request.) Table 1 reports p-values for
If draft eligibility is a valid instrument, then the marginal
the tests of equality of distributions, first-order and seconddistributions of potential outcomes for compliers are consisorder stochastic dominance. Notice that, for this example, the
tently estimated by using sample analogs of equations (5) and
stochastic dominance tests are for earnings for nonveterans
(6). Figure 2 is the result of applying our data to those equadominating earnings for veterans. The first row of Table 1
tions. Note that in finite samples, the instrumental variables
contains the results for annual earnings as the outcome variestimates of the potential cdfs for compliers may not be nonable. In the second row the analysis is repeated for weekly
decreasing functions (see Imbens and Rubin 1997 for a relatedwages. Bootstrap resampling was performed 2,000 times
discussion). The most remarkable feature of Figure 2 is the
(B =2,000).
change in the estimated distributional effect of veteran status
First, consider the results for annual earnings. The
on earnings with respect to the naive analysis. The average
Kolmogorov-Smirov statistic for equality of distributions is
effect of military service for compliers can be easily estimated
revealed to take an unlikely high value under the null hypothusing the techniques in Imbens and Angrist (1994). On averesis. However, we cannot reject equality of distributions at
age, veteran status is estimated to have a negative impact of
conventional test levels. The lack of evidence against the null
$1,278 on earnings for compliers, although this effect is far
hypothesis increases as we go from equality of distributions
from being statistically different from zero. Now, veteran stato first-order stochastic dominance, and from first-order to
tus seems to reduce low quantiles of the income distribution,
second-order stochastic dominance. The results for weekly
leaving high quantiles unaffected. If this characterization is
wages
are slightly different. For weekly wages we fall far from
true, the potential outcome for nonveterans would dominate
rejecting
equality of distributions at conventional test levels.
that for veterans in the first-order stochastic sense.

Following the strategy described in Section 2, hypothe-This example illustrates how useful it can be to think in
terms of distributional effects, and not merely average effects,
ses testing is performed. First, the test statistics in

equations (7)-(9) are computed for the draft-eligible/draft- when formulating the null hypothesis. Once we consider disineligible samples. Then, the distributions of the test statis- tributional effects, the belief that military service in Vietnam
tics under the least favorable null hypothesis are approximatedhad a negative effect on civilian earnings can naturally be
by resampling from the pooled sample and recomputing the incorporated in the null hypothesis by first- or second-order

test statistics. In this way, we are able to make inferencestochastic

dominance.

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:05:27 UTC
All use subject to https://about.jstor.org/terms

Abadie: Bootstrap Tests for Distributional Treatment Effects

289

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

10,000 20,000 30,000 40,000 50,000 60,000
Annual earnings

Figure 2. Estimated Distributions of Potential Earnings for

4. SUMMARY AND DISCUSSION OF

est. Estimates of cumulative distrib
tial outcomes for compliers show an
tary experience on the lower tail of
When treatment intake is not randomized, instrumental variearnings. However, equality of distri
able models allow us to identify the effects of a treatment on
at conventional confidence levels. First- and second-order
some outcome variable, for the subpopulation whose treatment
stochastic dominance are not rejected by the data. Results
status is determined by variation in the instrument. For this
more favorable to the hypothesis of equality of distributi
group of the population, called compliers, the entire marginal
when using weekly wages as the outcome variable.
distribution of the outcome under different treatments can be
Equality of distributions and first- and second-order stoch
estimated. In this article, a strategy to test for distributional
tic dominance are not the only hypotheses that can be tes
effects of treatments within the population of compliers is
using the bootstrap to compare the distribution of the outco
developed. In particular, the focus is on the equality of disvariable for different values of the instrument. For examp
tributions, first-order and second-order stochastic dominance
POSSIBLE EXTENSIONS

a test for a constant treatment effect, a = Y(1)- Y(0), c

hypotheses. First, how to estimate the distributions of potenbe implemented by applying the test of equality of distri
tial outcomes for compliers is explained. Then, bootstrap sam-

tions to Wi = Yi- a . Di. If a is unknown and needs to

pling is used to approximate the null distribution of the test
estimated, the asymptotic distribution of the test statistic w
statistics.
be affected. Nuisance parameters may also arise if parame
I illustrate this method with an application to the study of
models are used to adjust for the effect of covariates. Altho
the effects of veteran status on civilian earnings. Following
estimation of nuisance parameters is not explicitly address
Angrist (1990), use variation in veteran status induced by ranin the present article, modifications along the lines of Rom
domly assigned draft eligibility to identify the effects of inter-

(1988) or theorem 19.23 in van der Vaart (1998) look l

Table 1. Tests on Distributional Effects of Veteran Status on Civilian

Earnings, p-values
First-order Second-order

Outcome Equality in stochastic stochastic

variable distributions dominance dominance

Annual earnings .1245 .6260 .7415
Weekly wages .2330 .6490 .7530

promising starting points to obtain results analogous to tho
in Proposition 2.2.
Another interesting question is how to make the cdf est

mators proposed in this article nondecreasing. One pos
ble approach is to choose the nondecreasing function t

minimizes a weighted average quadratic distance to the est

mated cdf. This can be accomplished using well-know
isotonic regression methods as in Robertson, Wright,
Dykstra (1988).

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:05:27 UTC
All use subject to https://about.jstor.org/terms

Journal of the American Statistical Association, March 2002

290

define the pooled empirical measure

Finally, using techniques similar to those in Appendix A, it
can be seen that the results in Proposition 2.2 also hold for the

permutation versions of the tests proposed in this article (for

H = ,,
/i=

permutation tests resampling is done without replacement). An
appealing feature of permutation tests is that, by construction,
they provide exact level in finite samples (see, e.g., Efron and
Tibshirani 1993).

then Pl,,, - , = (1 - 7rn)(Pl,,l - Po,,n). Let (Y,,..., Y,) be a random sample from the pooled empirical measure. Define the bootstrap

empirical measures:

APPENDIX A: ASYMPTOTIC VALIDITY

1 nl

OF THE BOOTSTRAP

n1 i=l

Proof of Proposition 2.2.

j1 1

P0o,no= - E .
nO j=n,l ,+1

By theorem 3.7.7 in van der Vaart and Wellner (1996), if

Part (i) can be proven by extending the argument in vannder
Vaart
-- oo,
then n /2(P1, - l-H) =? GH given almost every sequence

and Wellner (1996) chap. 3.7 to tests for first- and second-order
(Yl, ... Y,1,,1), (Yo,, ..., Yo,n), where H = rr.P, +(1 - 7r) Po.
stochastic dominance. Let PI, PO, be the probability laws of Y conThe same result holds for no2(P ,0o - H,). Let
ditional on Z = 1 and Z = 0, respectively. Let Q be the probability
law of Z which is Bernoulli with parameter 7r. Define the empirical
Dn= (I? (P1 I 11)-Fho, I ).
measures
1

nI

1

n

pI , ,, *n
=no =Y1,i
- Y l, nO j=
/ /= 1 0 j=1

Note that T(D,,) = T( - 17 ,,)' /2nl / ,, - H) - l /2nl (P
H,)). Therefore, T(D,) converges in distribution to T((1-

7r) 1/2GH - 7/2GH) almost surely, where GH and G' are independent H-Brownian bridges. Because (1- 7r)1/2GH- 7Tr/2GH is also an
{l(-oo, y]} : y E lR}, that is, the class of indicators of all lower half
H-Brownian bridge, we have that, if P1 = Po = P, then T(D,) conlines in 1R. Because Y is known to be universally Donsker, by theoverges in distribution to T(Gp) almost surely. Let P be the bootstrap
rem 3.5.1 in van der Vaart and Wellner (1996) we have
probability measure for the sample, and let

where 5r indicates a probability mass point at Y. Let ' =

G ,,n = n /2(l,nl - Pl) X Gpl,

c, = inf{c: P(T(D,) > c) < a}.

Go, n = no/ (Po,, -Po) =X GP

the result of asymptotic size equal to a note that Teq, Tfsd,
in 1 (Y), where "=" denotes weak convergence, 1? (oY) is the To
setobtain
of
and
Tssd
are
convex continuous functionals. Note also that if P is
all uniformly bounded real functions on Y and Gp is a P-Brownian
nondegenerate, T(Gp) has support equal to [0, oo). By theorem 11.1
bridge. Let
n I no 1/2
in Davydov, Lifshits, and Smorodina (1998), T(Gp) has continuous
Dn = (npi,h,-PO,no)
and strictly increasing cdf everywhere except possibly at zero. If P

is nondegenerate, Pr(supf IGp(f)l = 0) = 0 so Teq(Gp) has absoAs n -> oo, rnT = nl/n -->. E (0, 1) almost surely. Then, if PI =
lutely continuous distribution. It is left to be shown that TfSd(Gp)
Po = P, D,n = (1 - 7r)1/2 Gp - G T1/2 G'p, where Gp and G' are
and Tssd(Gp) cannot have probability mass greater than 0.5 at zero.
independent versions of a P-Brownian bridge. Because (1- r) 1/2
Because the variance of Gp(f) is zero outside the support of P, we
Gp - T1/2 * Gp is also a P-Brownian bridge, we have that Dn => Gp.

have that Pr(supf0: Gp(f) = 0) = Pr(A f E F : Gp(f) > 0). By
For f E ., let a(f) = sup{t E R: f(t) = 1} and A be the
symmetry of Gaussian measures, Pr(3f E F : Gp(f) > 0) = Pr(i,
Lebesgue measure on R. For z E 1'(Y), define the following
f E t : Gp(f) < 0). By Assumption 2.2, P is nondegenerate, hence
maps: Teq(z) = supfE Iz(f)J, Tfsd(z) = supfEY z(f) and T"Sd(z) =

Pr(/f E Y : Gp(f) > 0n ]f E . : Gp(f) < 0)= 0. Therefore,

SUpfE fSgE:a(g)a(g)(f)} z(g) dt(g) where = = A o a. Our test statis1 > Pr(,f E . : Gp(f) > 0 U Af E G : Gp(f) < 0) = 2 Pr(sup,f
tics are Teq(Dn), Tfsd(D,) and Tsd(Dn). Let T be a generic notaGp(f) = 0). The same reasoning applies to Tssd(Gp) once we subtion for Teq, Tfsd or Tssd. Notice that, for z1, z2 E 1X(F), T(z2) <
T(zl)+T(z2-z1). Because Teq is equal to the norm in Io(S), triv-stitute f{gEa(g)<a()f)) Gp(g) dlt(g) for Gp(f). Therefore, for a < .5,
we have cn -> Cp(a) almost surely. Then, the first result of the theially Teq is continuous. Tfsd is also continuous because Tfd(z2 orem holds by continuity of T(Gp) - cp(a) at zero.
zl) < Teq(z2- z). Finally, the bounded support condition allows us
By tightness of the limiting process, c,, is bounded in probability
to restrict ourselves to functions z2, z E {x E 10(.F) : x(a-~(t)) =
and the tests are consistent against any fixed alternative. This proves
0 for t E (-0o, 1) U (u, oo)}, for some real 1, u (I < u) such that the
(i) and (ii).
support of P is contained in the interval [1, u]. Then, it is easy to
To prove (iii), let M = Q P. Under M,
see that Tssd(z2 - Zl) < (U - I) - Tfsd(z2 - ), hence Tsd, is continuous. For the stochastic dominance tests we will use the least favor-

able case (P1 = P0) to derive the null asymptotic distribution. Under
the least favorable null hypotheses, by continuity, the tests statistics
converge in distribution to Teq(Gp), Tfsd(Gp), and Tssd(Gp), respectively. Note that, in general, the asymptotic distribution of our test
statistics under the least favorable null hypotheses depends on the
underlying probability P. It can easily be seen that our test statistics
tend to infinity under any fixed alternative.

( n?nl )1/2

DI'(f) =( (P,l I/(f)-P0n(f))
[( 1- 12 ) 1/2 Zi -)]. ((Y) - Pf(Y))
/1/2 '/2 n1

= I E[(1 ) Z-( )i- (1 -Z]
n1/2 i=l 71' 1 - rc~, ~",12,

(f(Yi) - Pf(Yi)) + o().
Let Cp(a) = inf{c : P(T(Gp) > c) < a}. Consider a test that rejects
the null hypothesis if T(D,) > c,,. Because cp(a) depends on P, the
sequence {c,} is determined by a resampling method. Consider the Local alternatives are given by M, = Q P,, where P, is a sequence
pooled- sample (Y,, ... Y, ,) = (Y1, . .., Yl,, , Y, , *.... Y, ,o), andof conditional probability measures equal to P:, for Z = z. P(,,) and

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:05:27 UTC
All use subject to https://about.jstor.org/terms

Abadie: Bootstrap Tests for Distributional Treatment Effects

291

Table 2. True Test Size in Small Samples, Monte Carlo Simulation
Distribution
Nominal test level

Empirical

example N(0, 1) U(0, 1) b(.5, 10)

Sample

size .10 .05 .01 .10 .05 .01 .10 .05 .01 .10 .05 .01

Equality 25 .119 .062 .017 .121 .063 .011 .130 .063 .014 .107 .053 .010
of distributions 50 .114 .059 .015 .127 .072
100 .114 .055 .012 .114 .058
250 .106 .051 .011 .119 .058
500 .099 .047 .010 .107 .052

.017
.011
.011
.010

.148
.127
.111
.112

.085
.069
.053
.055

.020
.016
.011
.010

.108
.115
.121
.106

.061
.060
.058
.053

.013
.016
.013
.012

First-order 25 .122 .059 .015 .125 .060 .012 .134 .070 .014 .101 .050 .011

stochastic dominance
100
250
500

50 .109 .055 .012 .135 .068 .018 .131 .072 .016 .118
.106 .056 .012 .115 .058 .011 .123 .067 .016 .112
.105 .053 .011 .120 .061 .013 .119 .056 .010 .110
.091 .049 .010 .106 .055 .011 .114 .057 .011 .093

.051 .013
.056 .015
.062 .014
.046 .009

Second-order 25 .110 .058 .011 .106 .052 .006 .107 .050 .011 .101 .049 .009
stochastic dominance 50 .101 .050 .012 .110 .059 .010 .103 .054 .011 .103 .052 .009
100 .104 .051 .009 .100 .047 .007 .105 .052 .011 .105 .053 .012
250 .098 .049 .011 .095 .048 .010 .100 .045 .007 .105 .051 .011
500 .100 .048 .011 .102 .053 .009 .101 .051 .009 .092 .045 .011
s.e.

Pl,

.005

.003

.002

approach

a

.005

.003

common

.002

.005

.003

.002

.005

.003

.002

The same
holds
for first-following
and second-order dominancesense:
tests
limit
Presult
in
the

(note that for these tests the sequence of contiguous alternatives

j[nld2(dP
where

xI,

xo

1-

are

should
2xdP/2)

measurable

Sl/2(dmi/2
^ /^(n/2
If
2 J

be-x
specifieddPj]
such that Tfsd(vl
> 0 and Tssd(vl
v0) > 0,
0 - v0)
for
z -=0,

respectively.)

-

real

functions.

Therefore,

APPENDIX B: SMALL SAMPLE BEHAVIOR

To assess
the xdM'/I
small sample performance
of the
dM'I/2)
--O0,

tests proposed
this article a Monte Carlo study was conducted. To mimic as clo
for x(Zi, Yi) = (1 - Zi) xo(Y) + Zi as
Xpossible
(Yi).the actual small sample behavior of these tests in
one of the distributions
used for the simulation s
It can be shown (van der Vaartapplications,
and Wellner
(1996), lemma
is the measures
empirical distribution
of annual
from the data
3.10.11) that the sequences of product
Mn and
M"earnings
are conin
Section
3.
The
other
three
distributions
are
a
standard nor
tiguous, Mx = 0, Mx2 < oo, and

a uniform on (0,1), and a binomial with parameters (.5, 10). (N

dMn no dMn I n 1 2

that the simulation considers a distribution, the standard normal,

log
d-= E log ( Zi, Yi belongs
) -=
I Z,
Y-Mx2
op(l),
to a larger
family
than permitted by +
the regularity
conditio
dlMn i= dM n1/2 2

because it does not have bounded support.) For each distribution

under M. Therefore

each Monte Carlo iteration, a sample of size n was drawn (n eq

to 25, 50, 100, 250, and 500). Each sample was divided into

following the proportion of draft eligibles/nonelig
(D"(f)l?og
? dM -n 0 (P(f-Pf)2T(f subsamples
)
DJ l}ogdMn" N -Mx/j2'\ r'(f) Mx2

in the original data for the first distribution, and a 1/1 propo
(approximate for n odd) for the other three distributions. Then,

where r(f) = T/2(1 /2( - T2(vl(f)- Vo(f)) and v,(f) = Pxzf.

test statistics in equations (7)-(9) were computed and the boots
tests were performed using 2,000 bootstrap iterations. This pro
was repeated for 4,000 Monte Carlo iterations. Table 2 shows
DO(f) : N(0, P(f - Pf)2) + 7/2( - )/2(I (f) - vo(f)).results of this simulation study for samples sizes equal to 25, 50,
250, and 500 and nominal test levels equal to 0.10, 0.05, and
Using the Donsker property of F, we obtain the uniform version of
Asymptotic standard errors (as the number of Monte Carlo itera
last result (see van der Vaart and Wellner 1996, theorem 3.10.12.)
tends to infinity) are reported in the last row of the table. The t
shows highly satisfactory performance of the tests, even in f
Applying LeCam's third lemma

D, =$ Gp + irT/2(1- _ - )1/2 ' (VI -_o0).

small samples (n = 25).

In addition, suPfy I nl/2(Pz, - P)f - v,(f)I -* 0 for z = 0, 1, and
therefore suPf,E In'/2(P,, - P0,,)f - (v (f) - v0(f))l - 0.

APPENDIX C: DATA DESCRIPTION

Mn

By contiguity arguments cn - cp(a). Then, using a version of
The data set was especially prepared for Angrist and Kru

Anderson's lemma for general Banach spaces (see, e.g., van der Vaart
(1995). Both annual earnings and weekly wages are in real te
and Wellner 1996, lemma 3.11.4), we obtain the desired result Weekly
for
wages are imputed by dividing annual labor earnings by
the test of equality of distributions.
number of weeks worked. The Vietnam era draft lottery is caref

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:05:27 UTC
All use subject to https://about.jstor.org/terms

Journal of the American Statistical Association, March 2002

292

described in Angrist (1990), where the validity of draft eligibility as
an instrument for veteran status is also discussed. This lottery was

conducted every year between 1970 and 1974 and it used to assign
numbers (from 1 to 365) to dates of birth in the cohorts being drafted.

Men with lowest numbers were called to serve up to a ceiling deter-

mined every year by the Department of Defense. The value of that
ceiling varied from 95 to 195 depending on the year. Here, an indicator for lottery numbers lower than 100 is used as an instrument
for veteran status. The fact that draft eligibility affected the probabil-

ity of enrollment along with its random nature makes this variable a
good candidate to instrument veteran status.
[Received March 2000. Revised May 2001.]

Baskir, L. M., and Strauss, W. A. (1978), Chance and Circumstance: the
Draft, the War, and the Vietnam Generation. New York: Alfred A. Knopf.
Bickel, P. J. (1969), "A Distribution Free Version of the Smirnov Two Sample

Test in the p-Variate Case," The Annals of Mathematical Statistics, 40,
1-23.

Darling, D. A. (1957), "The Kolmogorov-Smimov, Cramer-von Mises Tests,"
The Annals of Mathematical Statistics, 28, 823-838.
Davydov, Y. A., Lifshits, M. A., and Smorodina, N. V. (1998), Local Properties of Distributions of Stochastic Functionals. Providence: American Mathematical Society.
Dawid, A. P. (1979), "Conditional Independence in Statistical Theory," Journal of the Royal Statistical Society, 41, 1-31.
Dudley, R. M. (1989), Real Analysis and Probability. New York: Chapman
& Hall.

Efron, B., and R. J. Tibshirani (1993), An Introduction to the Bootstrap.
New York: Chapman & Hall.

Foster, J. E., and Shorrocks, A. F. (1988), "Poverty Orderings," Econometrica
56, 173-177.
Imbens, G. W., and Angrist, J. D. (1994), "Identification and Estimation o
REFERENCES
Local Average Treatment Effects," Econometrica, 62, 467-476.
Imbens, G. W., and Rubin, D. B. (1997), "Estimating Outcome Distribution
Abadie, A., Angrist, J. D., and Imbens, G. W. (in press), "Instrumental
for VariCompliers in Instrumental Variable Models," Review of Economic Studables Estimates of the Effect of Subsidized Training on the Quantiles
of
ies, 64, 555-574.
Trainee Earnings," Econometrica.
Klecan, L., McFadden, R., and McFadden, D. (1991), "A Robust Test fo

Anderson, G. (1996), "Nonparametric Tests for Stochastic Dominance
inDominance," unpublished manuscript, MIT.
Stochastic
Income Distributions," Econometrica, 64, 1183-1193.
McFadden, D. (1989), "Testing for Stochastic Dominance," in Studies in th
Andrews, D. W. K. (1997), "A Conditional Kolmogorov Test," Econometrica,
Economics of Uncertainty in Honor of Josef Hadar, ed. by T. B. Fomby
65, 1097-1128.
and T. K. Seo. New York. Springer-Verlag.
Angrist, J. D. (1990), "Lifetime Earnings and the Vietnam Era Draft Lottery: Prestgaard, J. T. (1995), "Permutation and Bootstrap Kolmogorov-Smirnov
Evidence from Social Security Administrative Records," American Eco- Tests for the Equality of Two Distributions," Scandinavian Journal o
nomic Review, 80, 313-336.

Statistics, 22, 305-322.

Angrist, J. D., Imbens, G. W., and Rubin, D. B. (1996), "Identification of Robertson, T., Wright, F. T., and Dykstra, R. L. (1988), Order Restricted

Causal Effects Using Instrumental Variables," Journal of the American Sta- Statistical Inference. New York: Wiley.
tistical Association, 91, 444-472.
Romano, J. P. (1988), "A Bootstrap Revival of Some Nonparametric Distan
Angrist, J. D., and Krueger, A. B. (1995), "Split-Sample Instrumental Vari- Tests," Journal of the American Statistical Association, 83, 698-708.
ables Estimates of the Return to Schooling," Journal of Business and Eco- Rubin, D. B. (1990), "Formal Models of Statistical Inference for Causa
nomic Statistics, 13, 225-235.
Effects," Journal of Statistical Planning and Inference, 25, 279-292.

Atkinson, A. B. (1970), "On the Measurement of Inequality," Journal of Eco- van der Vaart, A. W. (1998), Asymptotic Statistics. New York: Cambridg
nomic Theory, 2, 244-263.
University Press.

Barrett, G., and Donald, S. (1999), "Consistent Tests for Stochastic Domi- van der Vaart, A. W., and Wellner, J. A. (1996), Weak Convergence an
nance," unpublished manuscript.
Empirical Processes. New York: Springer-Verlag.

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:05:27 UTC
All use subject to https://about.jstor.org/terms

