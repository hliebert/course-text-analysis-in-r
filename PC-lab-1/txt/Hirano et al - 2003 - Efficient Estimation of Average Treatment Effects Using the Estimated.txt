Econometrica, Vol. 71, No. 4 (July, 2003), 1161â€“1189

EFFICIENT ESTIMATION OF AVERAGE TREATMENT EFFECTS
USING THE ESTIMATED PROPENSITY SCORE
By Keisuke Hirano, Guido W. Imbens, and Geert Ridder1

We are interested in estimating the average effect of a binary treatment on a scalar
outcome. If assignment to the treatment is exogenous or unconfounded, that is, independent of the potential outcomes given covariates, biases associated with simple treatmentcontrol average comparisons can be removed by adjusting for differences in the covariates.
Rosenbaum and Rubin (1983) show that adjusting solely for differences between treated
and control units in the propensity score removes all biases associated with differences in
covariates. Although adjusting for differences in the propensity score removes all the bias,
this can come at the expense of efï¬ciency, as shown by Hahn (1998), Heckman, Ichimura,
and Todd (1998), and Robins, Mark, and Newey (1992). We show that weighting by the
inverse of a nonparametric estimate of the propensity score, rather than the true propensity
score, leads to an efï¬cient estimate of the average treatment effect. We provide intuition
for this result by showing that this estimator can be interpreted as an empirical likelihood
estimator that efï¬ciently incorporates the information about the propensity score.
Keywords: Propensity score, treatment effects, semiparametric efï¬ciency, sieve
estimator.

1 introduction
Estimating the average effect of a binary treatment or policy on a scalar
outcome is a basic goal of many empirical studies in economics. If assignment to
the treatment is exogenous or unconfounded (i.e., independent of potential outcomes conditional on covariates or pre-treatment variables, an assumption also
known as selection on observables), the average treatment effect can be estimated
by matching2 or by averaging within-subpopulation differences of treatment and
control averages. If there are many covariates, such strategies may not be desirable or even feasible. An alternative approach is based on the propensity score,
the conditional probability of receiving treatment given covariates. Rosenbaum
and Rubin (1983, 1985) show that, under the assumption of unconfoundedness,
adjusting solely for differences in the propensity score between treated and control units removes all biases. Recent applications of propensity score methods
1

We thank Gary Chamberlain, Jinyong Hahn, James Robins, Donald Rubin, Jeffrey Wooldridge,
four anonymous referees, seminar participants at the University of Chicago, UC Davis, the University
of Michigan, Michigan State University, UC Irvine, the University of Miami, Johns Hopkins, and
Harvard-MIT, and especially Whitney Newey for comments. Financial support for this research was
generously provided through NSF Grants SBR-9818644 and SES-0136789 (Imbens) and SES-9985257
(Hirano).
2
See Abadie and Imbens (2002) for a formal discussion of matching estimators in this context.
1161

1162

k. hirano, g. imbens, and g. ridder

in economics include Dehejia and Wahba (1999), Heckman, Ichimura, and Todd
(1997), and Lechner (1999).
Although adjusting for differences in the propensity score removes all bias, it
need not be as efï¬cient as adjusting for differences in all covariates, as shown
by Hahn (1998), Heckman, Ichimura, and Todd (1998), and Robins, Mark, and
Newey (1992). However, Rosenbaum (1987), Rubin and Thomas (1996), and
Robins, Rotnitzky, and Zhao (1995) show that using parametric estimates of the
propensity score, rather than the true propensity score, can avoid some of these
efï¬ciency losses.
In this paper we propose estimators that are based on adjusting for nonparametric estimates of the propensity score. The proposed estimators weight observations by the inverse of nonparametric estimates of the propensity score, rather
than the true propensity score. Extending results from Newey (1994) to derive
the large sample properties of these semiparametric estimators, we show that
they achieve the semiparametric efï¬ciency bound. We also show that for the case
in which the propensity score is known the proposed estimators can be interpreted as empirical likelihood estimators (e.g., Qin and Lawless (1994), Imbens,
Spady, and Johnson (1998)) that efï¬ciently incorporate the information about
the propensity score.
Our proposed estimators are relevant whether the propensity score is known
or not. In randomized experiments, for example, the propensity score is known
by design. In that case the proposed estimators can be used to improve efï¬ciency
over simply differencing treatment and control averages. With the propensity
score known, an attractive choice for the nonparametric series estimator for the
propensity score is to use the true propensity score as the leading term in the
series. The proposed estimators can also be used in the case where the propensity score is unknown. In that case they are alternatives to the previously proposed efï¬cient estimators that require nonparametric estimation of functions in
addition to the propensity score.
In the next section we lay out the problem and discuss the prior literature.
In Section 3 we provide some intuition for our efï¬ciency results by examining
a simpliï¬ed version of the problem. In Section 4 we give the formal conditions
under which weighting by the estimated propensity score results in an efï¬cient
estimator. Section 5 concludes.

2 the basic setup and previous results
21 The Model
We have a random sample of size N from a large population. For each unit i
in the sample, for i = 1     N , let Ti indicate whether the treatment of interest
was received, with Ti = 1 if unit i receives the active treatment, and Ti = 0 if unit i
receives the control treatment. Using the potential outcome notation popularized
by Rubin (1974), let Yi 0 denote the outcome for each unit i under control

estimation of average treatment effects

1163

and Yi 1 the outcome under treatment.3 We observe Ti and Yi , where Yi â‰¡
Ti Â· Yi 1 + 1 âˆ’ Ti  Â· Yi 0. In addition, we observe a vector of covariates denoted
by Xi .4 Initially we focus on the population average treatment effect:
(1)

 â‰¡ EY 1 âˆ’ Y 0

We shall also discuss estimation of weighted average treatment effects,

EY 1 âˆ’ Y 0X = xgxdF x

(2)

wate â‰¡
gxdF x
where gÂ· is a known function of the covariates.5 In the special case where the
weight function gx is equal to the propensity score px = PrT = 1X = x,
this leads under the unconfoundedness assumption to the average effect for the
treated:
(3)

treated â‰¡ EY 1 âˆ’ Y 0T = 1

The central problem of evaluation research is that for unit i we observe either
Yi 0 or Yi 1, but never both. To solve the identiï¬cation problem, we maintain
throughout the paper the unconfoundedness assumption (Rubin (1978), Rosenbaum and Rubin (1983)), related to the selection-on-observables assumption
(Barnow, Cain, and Goldberger (1980)), which asserts that conditional on the
observed covariates, the treatment indicator is independent of the potential outcomes. Formally, we have the following assumption:
Assumption 1 (Unconfounded Treatment Assignment):
T âŠ¥Y 0 Y 1  X
Heckman, Ichimura, and Todd (1998) point out that for identiï¬cation of the
average treatment effect  this assumption can be weakened to mean independence EY tT  X = EY tX for t = 0 1. If one is interested in the average
effect for the treated, the assumption can be further weakened to only require
3
Implicit in this notation is the stability assumption or SUTVA (Rubin (1978)) that units are not
affected by receipt of treatment by others, and that there is only one version of the treatment.
4
These variables are assumed not to be affected by the treatment.
5
An alternative estimand, which we do not consider here, is the direct weighted average treatment
effect of the form

EY 1 âˆ’ Y 0X = xgx dx

dwate =

gx dx

where the weighting is only over the known function gx. Note that in general F x is unknown
so that knowledge of gx does not imply knowledge of gx dF x and the other way around;
estimation strategies for the two estimands wate and dwate are in general different. Estimands of the
latter type can be ï¬tted into the framework of Robins and Ritov (1997).

1164

k. hirano, g. imbens, and g. ridder

that EY 0T  X = EY 0X. In this paper we focus on the full independence
assumption in order to be consistent with much of the literature.
Under unconfoundedness we can estimate the average treatment effect conditional on covariates, x â‰¡ EY 1 âˆ’ Y 0X = x, because
x = EY 1 âˆ’ Y 0X = x
= EY 1T = 1 X = x âˆ’ EY 0T = 0 X = x
= EY T = 1 X = x âˆ’ EY T = 0 X = x
The population average treatment effect can then be obtained by averaging the
x over the distribution of X  = EX. In practice, the strategy of forming
cells and comparing units with exactly the same value of X may fail if X takes
on too many distinct values.6 To avoid the need to match units on the values of
all covariates, Rosenbaum and Rubin (1983, 1985) developed an approach based
on the propensity score, the probability of selection into the treatment group:
(4)

px â‰¡ PrT = 1X = x = ET X = x

which is assumed to be bounded away from zero and one. Their key insight
was that if treatment and potential outcomes are independent conditional on all
covariates, they are also independent conditional on the conditional probability
of receiving treatment given covariates. Formally, as shown by Rosenbaum and
Rubin (1983), unconfoundedness implies
(5)

T âŠ¥Y 0 Y 1  pX

implying that adjustment for the propensity score sufï¬ces for removing all biases
associated with differences in the covariates.
22 Previous Results
The model set out above, as well as related models, have been examined by a
number of researchers. In an important paper Hahn (1998), studying the same
model as we do here, calculates the semiparametric efï¬ciency bounds, and proposes efï¬cient estimators, for  and treated . Hahnâ€™s estimator for , which is efï¬cient irrespective of whether the propensity score is known, nonparametrically
estimates the two conditional expectations EY T X = x and EY 1 âˆ’ T X = x
as well as the propensity score px, and then imputes the missing potential
i 0 = 
i 1 = 
EY T Xi /pÌ‚Xi  and Y
EY 1 âˆ’ T Xi /1 âˆ’ pÌ‚Xi .
outcomes as Y
Hahn shows that conditioning only on the true propensity score rather than on the
6
A related issue is whether standard asymptotic theory provides adequate approximations to the
sampling distributions of estimators based on initial nonparametric estimates of conditional means,
especially when the dimension of the conditioning variable is high. For discussions of these issues,
see Robins and Ritov (1997) and Angrist and Hahn (1999) and references therein.

estimation of average treatment effects

1165

full set of covariates does not in general lead to an efï¬cient estimator. In addition Hahn concludes that knowledge of the propensity score is informative for
estimating treated and derives efï¬cient estimators both with and without such
knowledge. A difference between Hahnâ€™s estimators and our proposed estimators is that Hahn requires nonparametric estimation of the propensity score as
well as the two conditional means EY T X = x and EY 1âˆ’T X = x, whereas
our proposed estimator only requires nonparametric estimation of the propensity
score.
Heckman, Ichimura, and Todd (1997, 1998) and Heckman, Ichimura, Smith,
and Todd (1998) focus on treated , the average treatment effect for the treated.
They consider estimators based on local linear regressions of the outcome on
treatment status and either covariates or the propensity score. They conclude that
in general there is no clear ranking of their estimators; under some conditions
the estimator based on adjustment for all covariates is superior to the estimator
based on adjustment for the propensity score, and under other conditions the
second estimator is to be preferred. Lack of knowledge of the propensity score
does not alter this conclusion.
Rosenbaum (1987) and Rubin and Thomas (1996) investigate the differences
between using the estimated and the true propensity score when the propensity
score belongs to a parametric family. They conclude that there can be efï¬ciency
gains from using the estimated propensity score. Our results show that by making
the speciï¬cation of the propensity score sufï¬ciently ï¬‚exible, this approach leads
to a fully efï¬cient estimator.
Robins, Mark, and Newey (1992), Robins and Rotnitzky (1995), Robins, Rotnitzky, and Zhao (1995), and Rotnitzky and Robins (1995) study the related
problem of inference for parameters in regression models where some data are
Missing At Random (MAR; Rubin (1976), Little and Rubin (1987)). Rotnitzky
and Robins (1995) show that in parametric settings weighting using the estimated
rather than true selection probability can improve efï¬ciency. They suggest it may
be possible to achieve full efï¬ciency by allowing the dimension of the model for
the selection probability to grow with the sample size. For this missing data case
Robins and Rotnitzky (1995) also propose an efï¬cient estimator that relies on
an initial consistent, but not necessarily efï¬cient, estimator of the full population
parameters. The estimator we propose is efï¬cient (as is the estimator proposed
by Hahn), but does not require an initial consistent estimator.

3 a simple example with binary covariates
To develop some intuition for the formal results that will be presented in
Section 4, we consider the simpler problem of estimating the population average of a variable Y , 0 = EY , given a random sample of size N of the triple
Ti  Xi  Ti Â· Yi . In other words, Ti and Xi are observed for all units in the sample,
but Yi is only observed if Ti = 1. We provide a heuristic argument for efï¬ciency
of using estimated weights, deferring formal results to Section 4.

1166

k. hirano, g. imbens, and g. ridder

The analog to the unconfoundedness assumption here is the assumption that
the Yi are Missing At Random (MAR; Rubin (1976)), or
T âŠ¥Y  X
The role of the propensity score is played here by the selection probability:
px = ET X = x = PrT = 1X = x. First, we restrict our attention in this
section to the case with a single binary covariate.7 Let Ntx denote the number of
observations with Ti = t and Xi = x, for t x âˆˆ 0 1 . Furthermore, suppose the
true selection probability is constant, px = 1/2 for all x âˆˆ 0 1 .8 The normalized variance bound for 0 is
(6)

Vbound = 2 Â· EVY X + VEY X

The â€œtrue weightsâ€ estimator weights the complete observations by the inverse
of the true selection probability:
(7)

N
N

1 
Yi Â· Ti
Yi Â· Ti
Ë† tw = 1
=

N i=1 pXi  N i=1 1/2

Its large sample normalized variance is
Vtw = 2Â·EVY X+VEY X+EEY X2  = Vbound +EEY X2 
strictly larger than the variance bound (6) unless EY X = 0.
The second estimator weights the complete observations by the inverse of a
nonparametric estimate of the selection probability. This estimator is the main
focus of the paper and it will be discussed in Section 4 in more general settings.
In the current setting the estimated selection probability is simply the proportion
of observed outcomes for a given value of the covariate. For units with Xi = 0 the
proportion of observed outcomes is N10 /N00 +N10 , and for units with Xi = 1 the
proportion of observed outcomes is N11 /N01 +N11 . Thus the estimated selection
probability is

N10 /N00 + N10  if x = 0
pÌ‚x =
N11 /N01 + N11  if x = 1
The proposed â€œestimated weightsâ€ estimator is then
(8)
7

N

Yi Â· Ti
Ë† ew = 1

N i=1 pÌ‚Xi 

An efï¬cient estimator is easily obtained by averaging the within-subsample difference of treatment/control averages. It can also be found by specializing the more general estimators in Robins
and Rotnitzky (1995) and Hahn (1998) to this simple case. The discussion here is solely intended to
convey intuition for the formal results that will be presented in Section 4.
8
Thus the missing data are Missing Completely At Random (MCAR; Rubin (1976), Little and
Rubin (1987)).

estimation of average treatment effects

1167

The normalized variance of this estimator is equal to the variance bound:
Vew = 2 Â· EVY X + VEY X = Vbound 
Not only does the weighting estimator with nonparametrically estimated weights
have a lower variance than the estimator using the â€œtrueâ€ weights in this simple
case, but it is in fact fully efï¬cient. In the remainder of this section we shall provide some intuition for this result. This will suggest why this efï¬ciency property
may carry over to the case with continuous and vector-valued covariates, as well
as with general dependence of the selection probability or propensity score on
the covariates.
An alternative interpretation of the estimated-weights estimator is based on
a Generalized Method of Moments (GMM) representation (Hansen (1982)).
Under the assumption that the selection probability is px = 1/2, we can estimate 0 using the single moment restriction E 1 Y  X T  0  = 0, with
1 y t x

=

yÂ·t
yÂ·t
âˆ’ =
âˆ’ 
px
1/2

The GMM estimator based on the single moment restriction 1 Â·, given knowledge of the selection probability, is the true-weights estimator Ë† tw in (7).
However, this estimator is not necessarily efï¬cient, because it ignores the additional information that is available in the form of knowledge of the selection
probability. This additional information can be written in moment condition
form as ET âˆ’ pXX = ET âˆ’ 1/2X = 0. With a binary covariate this conditional moment restriction corresponds to two marginal moment restrictions,
E 2 Y  T  X 0  = 0, with:


x Â· t âˆ’ 1/2
y
t
x

=

2
1 âˆ’ x Â· t âˆ’ 1/2
Estimating 0 in a generalized method of moments framework using the
moments 1 Â· and 2 Â· leads to a fully efï¬cient estimator.9 Here it is of particular interest to consider the empirical likelihood estimator (e.g., Qin and Lawless
(1994), Imbens (1997), Kitamura and Stutzer (1997), Imbens, Spady, and Johnson (1998)). Empirical likelihood estimation is based on maximization, both over
a nuisance parameter  = 1      N  and over the parameter of interest , of
the logarithm of the empirical likelihood function:
(9)

L =

N


ln i 

i=1

9

Although 2 Â· does not depend on the parameter of interest, 2 Â· is generally correlated with
Â·. Thus there can be efï¬ciency gains from using both sets of moment conditions as in seemingly
unrelated regressions. See, e.g., Hellerstein and Imbens (1999) and Qian and Schmidt (1999).
1

1168

k. hirano, g. imbens, and g. ridder


subject to the adding-up restriction
i i = 1 and the moment conditions

Ë† el by maximizing (9) subject to the
Ë†

y

t

x


=
0.
Solving
for

and
i i
i
i
i i
restrictions leads, after some manipulation, to:

N11
âˆ’ 1/2
N +N
Â· xi Â· ti âˆ’ 1/2
Ë† i = 1 + 01 11
1/4
+

N10
N00 +N10

âˆ’ 1/2

1/4

âˆ’1

Â· 1 âˆ’ xi  Â· ti âˆ’ 1/2



which in turn implies
Ë† el =

N


2 Â· Ë† i Â· Yi Â· Ti = Ë† ew 

i=1

equal to the estimated weights estimator.
The above discussion generalizes directly to the case with general discrete
covariates. With continuous covariates knowledge of the propensity score implies
a conditional moment restriction corresponding to an inï¬nite number of unconditional moment restrictions (e.g., Chamberlain (1987)). Using a series estimator
for the propensity score captures the information content of such a conditional
moment restriction by a sequence of unconditional moment restrictions.
The empirical likelihood interpretation suggests that moving from the trueweights estimator to the estimated-weights estimator increases efï¬ciency in the
same way that adding moment restrictions in a generalized method of moments
framework improves efï¬ciency. A similar ï¬nding appears in Crepon, Kramarz,
and Trognon (1998) who ï¬nd that using a reduced set of moment conditions, in
which nuisance parameters are replaced by solutions to the sample analogs of the
remaining moment conditions, is asymptotically equivalent to using the full set
of moment conditions, whereas using the true values of the nuisance parameters
may lead to efï¬ciency losses. These results are also linked to the literature on
weighting in stratiï¬ed sampling. Translated to this simple example, the results by
Lancaster (1990) suggest studyingthe distribution
of the various estimators con

ditional on the ancillary statistics Ti , Xi , and Ti Â· Xi . Conditional on those
three statistics the true-weights estimator is biased, while the estimated-weights
estimator remains unbiased. Rosenbaum (1987) discusses this issue speciï¬cally
in the context of estimated versus true propensity scores. In a general discussion
of weighted M-estimators, Wooldridge (1999, 2002) shows that weighting by the
inverse of estimated rather than population probabilities can lead to efï¬ciency
gains.
4 efï¬cient estimation using estimated weights
In this section we present the main results of the paper. We discuss three
distinct cases. First, we consider the problem of estimating the population average treatment effect under the unconfoundedness assumption. This includes as

estimation of average treatment effects

1169

a special case the extension of the binary-covariate MAR example of the previous section to continuous covariates. Second, we consider estimation of weighted
average treatment effects. Finally, we consider estimation of the effect of the
treatment on the treated which, in the known propensity score case, will follow
directly from the solution to the general weighted average treatment effect case.
This discussion will shed additional light on Hahnâ€™s (1998) interesting result that
for this parameter knowledge of the propensity score affects the efï¬ciency bound,
as well as on the ï¬ndings in Heckman, Ichimura, and Todd (1998) that in the
case of the average treatment effect for the treated, neither using the true nor
using the estimated propensity score dominates the other.
41 Estimating Population Average Treatment Effects
In this section we use the set up from Section 2 with a pair of potential outcomes Y 0 Y 1 for each unit and focus on efï¬cient estimation of the population average treatment effect,  âˆ— = EY 1 âˆ’ Y 0.10 As before, px = PrT =
1X = x is the propensity score, the probability of receiving the active treatment.
We maintain the unconfoundedness assumption. Deï¬ne t x â‰¡ EY tX =
x and t2 x = VY tX = x to be the conditional mean and variance of
Y t respectively. Under unconfoundedness we have t x = EY T = t X = x
and t2 x = VY T = t X = x. We can characterize  âˆ— through the moment
equation:
E Y  T  X  âˆ—  pâˆ— X = 0
where
(10)

y t x  px =

yÂ·t
y Â· 1 âˆ’ t
âˆ’
âˆ’ 
px 1 âˆ’ px

Given an estimator pÌ‚x for the propensity score, we estimate  âˆ— by setting the
average moment evaluated
 at the estimated selection probability equal to zero as
Ë† pÌ‚Xi  = 0, leading to the estimator
a function of : 1/N  N
i=1 Yi  Ti  Xi  

N 
1 
Yi Â· Ti
Y Â· 1 âˆ’ Ti 
Ë† =
âˆ’ i
(11)

N i=1 pÌ‚Xi 
1 âˆ’ pÌ‚Xi 
Because pâˆ— x is a conditional expectation, this semiparametric estimation problem directly ï¬ts into the framework of Newey (1994). So we could apply his
results directly if we estimate pâˆ— x by a series of least squares regressions of
treatment on polynomials in the covariates. (See the working paper version,
Hirano, Imbens, and Ridder (2000).) However, because pâˆ— x is a probability, such an approach has the unattractive feature that it approximates a probability by a linear function. We therefore estimate pâˆ— x in a sieve approach
10
Whenever necessary to avoid confusion we will use a superscript âˆ— to denote true (population)
values, so that  âˆ— denotes the population average treatment effect and pâˆ— x the true (population)
propensity score.

1170

k. hirano, g. imbens, and g. ridder

(e.g., Geman and Hwang (1982)) by the Series Logit Estimator (SLE). For K =
1 2    , let RK x = r1K x r2K x     rKK x be a K-vector of functions.
Although the theory is derived for general sequences of approximating functions, the most common class of functions are power series. Let  = 1      r 
be anr-dimensional vector of nonnegative integers (multi-indices), with norm
 = rj=1 j , let k
k=1 be a sequence that includes all distinct multi-indices


and satisï¬es k â‰¤ k + 1, and let x = rj=1 xj j . For a sequence k
we consider the series rkK x = xk . If we denote the logistic cdf by La =
expa/1 + expa, the SLE for pâˆ— x is deï¬ned by pÌ‚x = LRK x Ë† K  with
Ë† K = arg max


N

Ti Â· ln LRK Xi   + 1 âˆ’ Ti  Â· ln1 âˆ’ LRK Xi  
i=1

In Appendix A we discuss the relevant asymptotic theory for pÌ‚x.
In addition to the unconfoundedness assumption the following assumptions are
used to derive the properties of the estimator. First, we restrict the distribution
of X, Y 0, and Y 1:
Assumption 2 (Distribution of X):
(i) the support X of the r-dimensional covariate X is a Cartesian product of
compact intervals, X = rj=1 xlj  xuj ;
(ii) the density of X is bounded, and bounded away from 0, on X.
Assumption 3 (Distribution of Y 0 Y 1):
(i) EY 02  <  and EY 12  < ;
(ii) 0 x and 1 x are continuously differentiable for all x âˆˆ X.
The next assumption requires sufï¬cient smoothness of the propensity score.
Assumption 4 (Selection Probability): The propensity score pâˆ— x satisï¬es the
following conditions. For all x âˆˆ X:
(i) pâˆ— x is continuously differentiable of order s â‰¥ 7 Â· r where r is the dimension
of X;
(ii) pâˆ— x is bounded away from zero and one: 0 < p â‰¤ pâˆ— x â‰¤ pÌ„ < 1.
Finally, we restrict the rate at which additional terms are added to the series
approximation to pâˆ— x, depending on the dimension of X and the number of
derivatives of pâˆ— x.
Assumption 5 (Series Estimator): The series logit estimator of pâˆ— x uses a
power series with K = N  for some 1/4s/r âˆ’ 1 <  < 19 .
The restriction on the derivatives (Assumption 4(i)) guarantees the existence
of a  that satisï¬es the conditions in Assumption 5. Under these conditions we
can state the ï¬rst result.

estimation of average treatment effects

1171

Theorem 1: Suppose Assumptions 1â€“5 hold. Then:
p
(i) Ë† âˆ’â†’  âˆ— ;
âˆš
d
(ii) N Ë† âˆ’  âˆ—  âˆ’â†’  0 V , where


YT
Y 1 âˆ’ T 
âˆ—
âˆ’
âˆ’

V =E
pâˆ— X 1 âˆ’ pâˆ— X
2


0 X
1 X
âˆ—
âˆ’
+
X
T
âˆ’
p
pâˆ— x 1 âˆ’ pâˆ— X
= E X âˆ’ 2 +

12 X
02 X

+
pâˆ— X 1 âˆ’ pâˆ— X

and

(iii) Ë† reaches the semiparametric efï¬ciency bound.
Proof: See Appendix B.
Remark 1: This result also covers the extension of the binary-covariate MAR
example in Section 3 to the continuous covariate case. For this case set Y = 0 if
T = 0 and set Y 0 identically equal to 0.
Remark 2: Theorem 1 establishes the result for continuous X. If X has both
continuous and discrete components, this can be dealt with in a conceptually
straightforward manner by using the continuous covariate estimator within samples homogenous in the discrete covariates, at the expense of additional notation.
Derivations presented in Appendix B show that the estimator in Theorem 1
can be represented as asymptotically linear:
Ë† =  âˆ— +
where
(12)

N
âˆš
1 
 Yi  Ti  Xi   âˆ—  pâˆ— Xi  + Ti  Xi  + op 1/ N 
N i=1

Â· is deï¬ned in (10) and


1 x
0 x
+
Â· t âˆ’ pâˆ— x
t x = âˆ’ âˆ—
p x 1 âˆ’ pâˆ— x

The known-weights estimator, (11) with pÌ‚x replaced by pâˆ— x, is asymptotically
linear with score function Â·. The function t x represents the effect on the
score function of estimating pâˆ— x. Its ï¬rst factor, âˆ’1 x/pâˆ— x + 0 x/1 âˆ’
pâˆ— x, is the conditional expectation of the derivative of the moment condition
y t x  âˆ—  pâˆ— x with respect to pâˆ— x. Hence, the score linearizes the estimator with respect to  (which is trivial since the estimator is already linear in
) and pÂ·.
The asymptotically linear representation of Ë† implies that its asymptotic variance equals
(13)

E Y  T  X  âˆ—  pâˆ— X + T  X2 

1172

k. hirano, g. imbens, and g. ridder

shown in Appendix B to be equal to the variance expression in Theorem 1. We
estimate this variance by replacing the unknown quantities , pâˆ— Â·, and Â· by
estimates and replacing the expectation by a sample average:
(14)

N

= 1
Ë† pÌ‚Xi  + T
Ë† i  Xi 2 
V
 Yi  Ti  Xi  
N i=1

The estimation of t x requires some additional explanation. The second
factor, t âˆ’ pâˆ— x is estimated as t âˆ’ pÌ‚x. The ï¬rst factor, âˆ’1 x/pâˆ— x +
0 x/1 âˆ’ pâˆ— x, can be written as the conditional expectation of
âˆ’Y T /pâˆ— X2 +Y 1âˆ’T /1âˆ’pâˆ— X2  given X. We therefore estimate the ï¬rst
factor in t x by nonparametric regression of âˆ’Y T /pÌ‚X2 + Y 1 âˆ’ T /1 âˆ’
pÌ‚X2  on X, using the same series approach as we used for estimating pâˆ— x.
Thus



N 
Y i Ti
1 
Yi 1 âˆ’ Ti 
K
+
X

R
âˆ’
i
N i=1 pÌ‚Xi 2 1 âˆ’ pÌ‚Xi 2
âˆ’1

N
1 
K
K

Ã—
R Xi R Xi 
RK x
N i=1
with RK x the same series of approximating functions as before, is used as an
estimator for âˆ’1 x/pâˆ— x + 0 x/1 âˆ’ pâˆ— x, and the function t x is
Ë† x:
estimated by t



N 
1 
Y i Ti
Yi 1 âˆ’ Ti 
K
Ë† x = âˆ’
t
(15)
+
X

R
i
N i=1 pÌ‚Xi 2 1 âˆ’ pÌ‚Xi 2

âˆ’1
N
1 
K
K

R Xi R Xi 
RK xt âˆ’ pÌ‚x
Ã—
N i=1
The following theorem describes the formal result.
 is consistent for V .
Theorem 2: Suppose Assumptions 1â€“5 hold. Then V
Proof: See Appendix B.
In practice bootstrapping methods may be a valuable alternative to the above
variance estimator.
42 Estimating the Weighted Average Treatment Effect
âˆ—
In this section we generalize the previous result to wate
, the weighted average
treatment effect for a known weight function gx. One motivation for considering this estimand is that by choosing gx appropriately, we can obtain treatment
effects for subpopulations deï¬ned by X. In addition, by choosing gx equal to

estimation of average treatment effects

1173

the propensity score pâˆ— x, we can recover the average effect of the treatment
on the treated, as will be discussed below.
To estimate wate , we use the following moment function:


yÂ·t
y Â· 1 âˆ’ t
y t x wate  px = gx Â·
âˆ’
âˆ’ wate 
(16)
px 1 âˆ’ px
leading to the estimator
Ë†wate =



gXi 

i

Y Â· 1 âˆ’ Ti 
Yi Â· Ti
âˆ’ i
pÌ‚Xi 
1 âˆ’ pÌ‚Xi 



gXi 

i

This estimator is asymptotically linear:
Ë†wate =

N
1 
1
âˆ—
 Yi  Ti  Xi  wate
 pâˆ— x
EgX N i=1
âˆš
+ Ti  Xi  + op 1/ N 

where now



t x = âˆ’gx Â·


1 x
0 x
+
t âˆ’ pâˆ— x
pâˆ— x 1 âˆ’ pâˆ— x

The asymptotic variance can be estimated as
N
1
1 
= 
Ë† i  Xi 2 
V
 Yi  Ti  Xi  Ë†wate  pÌ‚Xi  + T
 i gXi /N 2 N i=1

with an estimator for t x analogous to that for the average treatment effect:


N 
Y i Ti
1 
Yi 1 âˆ’ Ti 
K
K
Ë† x = âˆ’gx
R
t
+
X
R
X

i
i
pÌ‚K Xi 2 1 âˆ’ pÌ‚K Xi 2
N i=1

âˆ’1
N
1 
K
K

Ã—
R Xi R Xi 
RK xt âˆ’ pÌ‚K x
N i=1
Similar reasoning to the previous results gives the following theorem:
Theorem 3: Suppose Assumptions 1â€“5 hold, that gx is bounded from above
and that EgX > 0. Then:
p
âˆ—
(i) Ë†wate âˆ’â†’ wate
;
âˆš
d
âˆ—
(ii) N Ë†wate âˆ’ wate
 âˆ’â†’  0 V , with
V=

1
gX2 2
âˆ—
 X
E gX2 X âˆ’ wate
2 + âˆ—
2
EgX
p X 1
+

 is consistent for V .
(iii) V

gX2
 2 X 
1 âˆ’ pâˆ— X 0

and

1174

k. hirano, g. imbens, and g. ridder

The proof for this theorem follows the same line of argument as that for
Theorems 1 and 2 and is omitted.
Remark: We could weaken Assumption 4(ii), the assumption that the
propensity score is bounded away from 0 and 1, by the assumption that
gx/pâˆ— x and gx/1âˆ’pâˆ— x are bounded from above. Thus, if there is insufï¬cient overlap in the distributions of the treated and untreated units, one may
wish to choose gÂ· to restrict attention to a subpopulation for which there is
sufï¬ciently large probability of observing both treated and untreated units.
A semiparametric efï¬ciency bound for wate has not been previously calculated
in the literature. The next result shows that our estimator is efï¬cient.
Theorem 4: The semiparametric efï¬ciency bound for estimation of wate is
V=

gX2 2
1
 X
E gX2 X âˆ’ wate 2 + âˆ—
2
EgX
p X 1
+

gX2
 2 X 
1 âˆ’ pâˆ— X 0

Proof: See Appendix B.
43 Estimating the Average Treatment Effect for the Treated
Under unconfoundedness the average treatment effect for the treated (Rubin
(1977), Heckman and Robb (1985), Heckman, Ichimura, and Todd (1997, 1998))
is a special case of the weighted average treatment effect, corresponding to the
weighting function gx = pâˆ— x. To see this, ï¬rst note that under unconfoundedness
âˆ—
treated
= EY 1 âˆ’ Y 0T = 1 = EEY 1 âˆ’ Y 0X T = 1T = 1

= EEY 1 âˆ’ Y 0XT = 1 = EXT = 1
Second, the latter is equal to

EXT = 1 = xdF xT = 1
=



xpâˆ— xdF x



pâˆ— xdF x

âˆ—
which is wate
with gx equal to pâˆ— x. Hence we can use the moment equation
(16) with pâˆ— x substituted for gx:


yÂ·t
y Â· 1 âˆ’ t
âˆ’
âˆ’ treated 
y t x treated  px = pâˆ— x Â·
(17)
px 1 âˆ’ px

estimation of average treatment effects

1175

The estimator is the solution to


N

Yi Â· 1 âˆ’ Ti 
Yi Â· Ti
âˆ—
âˆ’
âˆ’ treated 
(18)
0 = p Xi  Â·
pÌ‚Xi 
1 âˆ’ pÌ‚Xi 
i=1
with the same nonparametric series estimator pÌ‚x as before.
The next result, which follows directly from Theorem 4, shows that this estimator achieves the efï¬ciency bound calculated by Hahn (1998) for estimation of the
effect of treatment on the treated, assuming that the propensity score is known.
Corollary 1: Suppose that Assumptions 1â€“5 hold. Then:
p
âˆ—
;
(i) Ë†treated âˆ’â†’ treated
âˆš
d
âˆ—
(ii) N Ë†treated âˆ’ treated  âˆ’â†’  0 V , with
V=

1
E pâˆ— X2 X âˆ’ treated 2 + pâˆ— X12 X
Epâˆ— X2
+

pâˆ— X2 2
 X 
1 âˆ’ pâˆ— X 0

and

(iii) Ë†treated achieves the semiparametric efï¬ciency bound.
The proof for this corollary is omitted as the result directly follows from
Theorem 4.
Note that in the moment function (17) the propensity score appears in two
places, ï¬rst as pâˆ— x multiplying the remainder of the moment function where
it replaces the general weight function gx in (16), and second as px in the
denominator of the two terms. We only use the estimated propensity score in the
second part in the efï¬cient estimator in (18). The result of the theorem above
implies that this is more efï¬cient than using the true propensity score everywhere
and solving


N

Yi Â· 1 âˆ’ Ti 
Yi Â· Ti
(19)
âˆ’
âˆ’

0 = pâˆ— Xi  Â·
treated 
pâˆ— Xi  1 âˆ’ pâˆ— Xi 
i=1
or using the estimated propensity score everywhere, which amounts to solving


N

Yi Â· Ti
Yi Â· 1 âˆ’ Ti 
âˆ’
âˆ’ treated 
(20)
0 = pÌ‚Xi  Â·
pÌ‚Xi 
1 âˆ’ pÌ‚Xi 
i=1
A direct implication
 result is that the sample average of the outcomes
 of this
for the treated
i Y i Ti /
i Ti is less efï¬cient
 for âˆ—the population average
âˆ—
EY 1T = 1 than the weighted average
i Yi Ti p Xi /pÌ‚Xi /
i p Xi 
where the weights are the ratio of the true and estimated propensity score.
Another implication is that the estimators characterized by (19) and (20) cannot
in general be ranked in terms of efï¬ciency as there are effects of opposite signs
(e.g., Heckman, Ichimura, and Todd (1997)).

1176

k. hirano, g. imbens, and g. ridder

If the propensity score is not known, then Hahn (1998) shows that this affects
the efï¬ciency bound for the effect of treatment on the treated. Our previous
estimator Ë†treated cannot be used since it makes use of pâˆ— x. However, we can use
the estimated propensity score in place of pâˆ— x in the weighting of observations
as in (20). Call this estimator Ë†te . The next theorem shows that this estimator is
efï¬cient if the propensity is not known.
Theorem 5: Suppose that Assumptions 1â€“5 hold. Then:
p
âˆ—
(i) Ë†te âˆ’â†’ treated
;
âˆš
d
âˆ—
(ii) N Ë†te âˆ’ treated  âˆ’â†’  0 V , with
V=

1
E pâˆ— XX âˆ’ treated 2 + pâˆ— X12 X
Epâˆ— X2
+

pâˆ— X2 2
 X 
1 âˆ’ pâˆ— X 0

and

(iii) Ë†te achieves the semiparametric efï¬ciency bound for estimation of treated when
the propensity score is not known.
The proof goes along the same lines as that for Theorems 1 and 2 and is
omitted.
5 conclusion
In this paper we have studied efï¬cient estimation of various average treatment
effects under an unconfounded treatment assignment assumption. Although
weighting observations by the inverse of the true propensity score does not lead
to efï¬cient estimators, weighting each observation by the inverse of a nonparametric estimate of the propensity score does lead to efï¬cient estimators. We provide intuition for this result through connections to the literatures on empirical
likelihood estimators and choice-based sampling.
The estimators proposed in this paper require fewer functions to be estimated
nonparametrically than other efï¬cient estimators previously proposed in the literature. Which estimators have more attractive ï¬nite sample properties, and
which have more attractive computational properties, remain open questions.
The results underline the important role played by the propensity score in estimation of average causal effects.
Dept. of Economics, University of Miami, P.O. Box 248126, Coral Gables FL
33124-6550; khirano@miami.edu;
Dept. of Agricultural and Resource Economics, University of California at
Berkeley, 330 Giannini Hall, Berkeley, CA 94720-3310; imbens@econ.berkeley.edu;
http://elsa.berkeley.edu/users/imbens/; and Dept. of Economics, University of California at Berkeley, and NBER;

estimation of average treatment effects

1177

and
Dept. of Economics, University of Southern California, Kaprielian Hall, University
Park Campus, Los Angeles, CA 90089; ridder@usc.edu.
Manuscript received January, 2000; ï¬nal revision received August, 2002.
APPENDIX A: Logistic Series Estimator
In this appendix we derive the relevant properties of the logistic series estimator, which can be
interpreted as a sieve estimator (e.g., Geman and Hwang (1982)). Let r K x = r1K x     rKK x
be a K-vector of functions. The triangular array of functions r K x, K = 1 2    , is the basis for
the approximation of the propensity score. In particular, we approximate a function f R r â†’ R
K
K
K
by K r K x. Because K r K x = K Aâˆ’1
K AK r x we can also use R x = AK r x as the basis of
approximation. By choosing AK appropriately we obtain a system of orthogonal (with respect to
some weight function) functions. Speciï¬cally we choose AK so that ERK XRK X  = IK . The
properties of the series logit estimator and the proof of Theorem 1 are mostly for a general system of
approximating functions. We shall indicate where the properties
 of the speciï¬c approximating class
of functions are used. We will use the matrix norm A = trA A. Note that this is the usual
Euclidean norm if A is a column vector.11 If A is a scalar, we denote the norm by A. Deï¬ne
(21)

K = sup RK x 
xâˆˆX

In general, this bound depends on the array of approximating functions that is used. For orthonormal
polynomials Newey (1994, 1997) shows K â‰¤ CK. Here, and in the sequel, C denotes a generic
positive constant.12
We consider approximation of the log odds ratio by a power series. One possible choice for a
triangular sequence of powers of x is

(22)

r 1 x = 1

r 2 x =

1

x1

ï£® ï£¹
1
ï£¯x ï£º
1ï£º
ï£¯
ï£º
r r+1 x = ï£¯
ï£¯  ï£º 
ï£°ï£»
xr

ï£® ï£¹
1
ï£¯ x1 ï£º
ï£¯ ï£º
ï£¯ï£º
ï£º
r r+1 x = ï£¯
ï£¯  ï£º     
ï£¯ ï£º
ï£° xr ï£»
x12

Linear combinations of the elements of the vectors r K x are the approximating power series. A
power series with n + 1r terms has x1      xr included at least up to power n. Hence, if we use
the sequence in (22) and set K = n + 1r , then r K x has powers in all variables at least up to n.
If a function f is s times continuously differentiable and K = n + 1r , then by Theorem 8, p. 90, in
Lorentz (1986) there is a K-vector K such that for RK x = AK r K x, and on the compact set X,
(23)

s

sup f x âˆ’ RK x K  < C1 nâˆ’s â‰¤ C2 K âˆ’ r 
xâˆˆX

11

It is useful to list some properties of this norm that will be used in the following discussion.
  
Let A and B be K Ã— K matrices and c be a K vector. Then AB 2 = i j  k aik bkj 2 . Applying
the vector Cauchy-Schwartz inequality to
 the inner sum, we ï¬nd AB â‰¤ A B . By the maximum
inequality for quadratic forms Ac â‰¤ max A A c , where max is the largest eigenvalue, which
gives a sharp upper bound (the upper bound A c is not sharp in general). We also frequently use
the Cauchy-Schwartz
 inequality for expectations, which implies that for nonnegative random variables
X Y , EXY  â‰¤ EX 2 EY 2 .
12
If two constants are needed, we will use the generic notation C1  C2 .

1178

k. hirano, g. imbens, and g. ridder

To ensure that the approximation of pâˆ— x is between 0 and 1 we ï¬rst approximate the log odds
ratio, which is also s times continuously differentiable and which is bounded on X if the propensity
score is bounded away from zero and one. Hence by (23) there is a K such that
(24)

 




pâˆ— x
K

âˆ’ rs

x


âˆ’
R
sup  ln
K  < CK
1 âˆ’ pâˆ— x
xâˆˆX

Let Lz = expz/1 + expz be the logistic cdf and L z = Lz Â· 1 âˆ’ Lz. The series logit
estimator of the population propensity score pâˆ— x is pÌ‚K x = LRK x Ë† K , where
(25)

Ë† K = arg max LN 


for
(26)

LN  =

N

Ti Â· ln LRK Xi   + 1 âˆ’ Ti  Â· ln1 âˆ’ LRK Xi  
i=1
p

For N â†’  and K ï¬xed we have Ë† K âˆ’
â†’ Kâˆ— , with Kâˆ— the pseudo true value:
(27)

Kâˆ— = arg max Epâˆ— X ln LRK X  + 1 âˆ’ pâˆ— X ln1 âˆ’ LRK X 


We also deï¬ne the pseudo true propensity score: pKâˆ— x = LRK x Kâˆ— .
In the proofs for the theorems we need some properties of this series logit estimator. For these
properties it is convenient to distinguish between (i) the deterministic difference between the true
propensity score and the pseudo true propensity score and (ii) the stochastic difference between the
estimated propensity score and the pseudo true value. In the remainder of this appendix we therefore
derive (i) a uniform bound on the difference between pâˆ— x and pKâˆ— x and (ii) a bound on the
sampling variance in the form of the stochastic order of Ë† K âˆ’ Kâˆ— .
Lemma 1 (Approximation of Propensity Score): Suppose that:
(i) the support X of X is a compact subset of R r ;
(ii) the propensity score pâˆ— x is s times continuously differentiable, with s/r â‰¥ 4;
(iii) the propensity score pâˆ— x is bounded away from zero and one on X;
(iv) the density of X is bounded away from zero on X.
Then for K in (24),
K âˆ’ Kâˆ— = OK âˆ’s/2r 
and
sup pâˆ— x âˆ’ pKâˆ— x = OK âˆ’s/2r K
xâˆˆX

Proof: From (24), and by monotonicity of LÂ·, for all x âˆˆ X,
(28)

LRK x K âˆ’ CK âˆ’s/r  âˆ’ LRK x K  < pâˆ— x âˆ’ LRK x K 
< LRK x K + CK âˆ’s/r  âˆ’ LRK x K 

Ëœ =
By the mean value theorem applied to the lower and upper bound and by L RK x 
Ëœ
Ëœ < 1/4 we ï¬nd that the lower and upper bound are bounded by
âˆ’ Lr K x 
LRK x 1
âˆ’ 14 CK âˆ’s/r and 14 CK âˆ’s/r , respectively. Hence, for the K that satisï¬es (24), we have
(29)

sup pâˆ— x âˆ’ LRK x K  < CK âˆ’s/r 
xâˆˆX

1179

estimation of average treatment effects
Deï¬ne
Qâˆ—  = Epâˆ— X ln LRK X  + 1 âˆ’ pâˆ— X ln1 âˆ’ LRK X 
and

QK  = ELRK X K  ln LRK X  + 1 âˆ’ LRK X K  ln1 âˆ’ LRK X 
Then, by deï¬nition we have Kâˆ— = arg max  Qâˆ— , and by the information inequality we have
K = arg max QK 


Let  = inf xâˆˆX pâˆ— x Â· 1 âˆ’ pâˆ— x, so that by assumption (iii)  > 0. Deï¬ne




K =  âˆˆ R K  inf LRK x 1 âˆ’ LRK x  â‰¥ /2 
xâˆˆX

Because of (29), for K large enough, we have K âˆˆ K . Also, because LRK x  is bounded away
from zero and one for  âˆˆ K , it follows that ln LRK x  is bounded, and thus by (29) there is a
C1 such that
(30)

sup Qâˆ—  âˆ’ QK  â‰¤ C1 K âˆ’s/r 
âˆˆK

Next, deï¬ne for ï¬xed C2
(31)

K =  âˆˆ R K   âˆ’ K â‰¤ C2 K âˆ’s/2r 


Because
sup

xâˆˆX âˆˆ
K

LRK x  âˆ’ LRK x K  â‰¤

sup
  Ëœ
xâˆˆX âˆˆ
K

Ëœ K x  âˆ’ K 
L RK x R

â‰¤ sup RK x Â· sup  âˆ’ K â‰¤ CKK âˆ’s/2r 
xâˆˆX


âˆˆ
K

K âŠ‚ K .
it follows that for a polynomial series estimator with K â‰¤ CK, and for large enough K, 
K and with min A the smallest eigenvalue of A, and for large enough K so that
Thus, for  âˆˆ 
K âŠ‚ K , given that ERK XRK X  = IK , we have



 2 QK
(32)

= min EL RK x RK XRK X  â‰¥ /2
min âˆ’
  

Now choose the C2 in (31) to satisfy C2 > 4C1 /, for the C1 in (30). Let K be large enough so that
K , the difference Qâˆ— K  âˆ’ Qâˆ— 
K âŠ‚ K . Then, for  such that  âˆ’ K = C2 K âˆ’s/2r , i.e.,  âˆˆ 

satisï¬es
Qâˆ— K  âˆ’ Qâˆ—  â‰¥ QK K  âˆ’ C1 K âˆ’s/r âˆ’ QK  âˆ’ C1 K âˆ’s/r
â‰¥âˆ’
â‰¥

QK
1
 2 QK
Ëœ

âˆ’ K  âˆ’ 2C1 K âˆ’s/r
K  âˆ’ K  âˆ’  âˆ’ K 

2
  

C22  âˆ’s/r
âˆ’ 2C1 K âˆ’s/r > 0
K
2

K , so that with Qâˆ—  concave,
Hence, there is a local maximum of Qâˆ—  in the interior of 
K , proving the ï¬rst assertion. Then
Kâˆ— = arg max Qâˆ—  must satisfy Kâˆ— âˆˆ 
LRK X K  âˆ’ LRK X Kâˆ—  â‰¤ RK X Â· Kâˆ— âˆ’ K = OKK âˆ’s/2r 
and thus by (29) and the triangle inequality we have
sup pâˆ— x âˆ’ LRK x Kâˆ—  = OK âˆ’s/2r K
xâˆˆX

Next we derive the stochastic order of Ë† K âˆ’ Kâˆ— as K increases with N .

QED

1180

k. hirano, g. imbens, and g. ridder

Lemma 2 (Convergence of Ë† K âˆ’ Kâˆ— ): Suppose the same four conditions as in Lemma 1 hold. In
addition, suppose that:
(v) KN  is a sequence of values of K satisfying KN  â†’ , and KN 4 /N â†’ 0.
Then


KN 
âˆ—

=
O
Ë† KN  âˆ’ KN
p

N
Proof: In the sequel we write K for KN . By deï¬nition of RK x,
(33)

N

K = 1
RK Xi RK Xi 
S
N i=1

has expectation equal to IK . By Newey (1997), it satisï¬es
 

K âˆ’ IK = Op K K 
S
N
which converges to zero in probability by condition (v). Hence the probability that the smallest
K is larger than 1/2 goes to one.
eigenvalue of S
Next, we show that
 
K
1 LN âˆ—
K  = Op
(34)

N 
N
Consider


 1 LN âˆ— 2
1
K
 âˆ—
K
 âˆ—
K
K


E
 N  K  = N tr ELR X K 1 âˆ’ LR X K R XR X 
â‰¤

1
tr ERK XRK X  = K/N 
N

Hence


 1 LN âˆ— 2

E
 N  K  = OK/N 
and the Markov inequality implies (34).
Next, let  = inf xâˆˆX K LRK x Kâˆ— 1 âˆ’ LRK x Kâˆ— /8, which by conditions (i) and (iii) and
Lemma 1 is positive. For any  > 0 choose C such that for N large enough
 


 1 LN âˆ— 
 < C K â‰¥ 1 âˆ’  
Pr 

(35)

K 
 N 
N
2
Note that,
sup
xâˆˆX âˆ’ âˆ— â‰¤C
K



LRK x  âˆ’ LRK x Kâˆ— 
K
N

â‰¤


sup

xâˆˆX âˆ’ âˆ— â‰¤C
K



RK x  âˆ’ Kâˆ—  â‰¤ KC
K
N

which goes to zero, so that for large enough N ,
inf

xâˆˆX âˆ’ âˆ— â‰¤C
K



K
N

LRK x 1 âˆ’ LRK x  â‰¥ 4

K

N

estimation of average treatment effects

1181

Choose N large enough so that this inequality holds, that (35) holds with probability at least 1 âˆ’ /2,
K is larger than 1/2 is at least 1 âˆ’ /2. Then
and that the probability that the smallest eigenvalue of S
âˆš
the probability that both of these hold is at least 1 âˆ’ . Then for every  with  âˆ’ Kâˆ— = C K/N ,
a second-order expansion gives
Â¯
 2 LN 
1
1 LN Kâˆ— 
1
1
 âˆ’ Kâˆ— 
L  = LN Kâˆ—  +
 âˆ’ Kâˆ—  +
 âˆ’ Kâˆ— 
N N
N
N

2N
  
âˆš
where Â¯ âˆ’ Kâˆ— â‰¤  âˆ’ Kâˆ— = C K/N . We have
(36)

n
Â¯
1 
1  2 LN 
K
Â¯
Â¯
=âˆ’
LRK Xi  1
Xi RK Xi  
âˆ’ LRK Xi  R

2N  
2N i=1

K 
â‰¤ âˆ’2S
with its eigenvalues bounded away from zero in absolute value by . Then, rearranging
(36) and
âˆš
using the triangle inequality, with probability greater than 1 âˆ’ , for  âˆ’ Kâˆ— = C K/N ,
1
1
1 LN âˆ— 
L  âˆ’ LN Kâˆ—  â‰¤
K   âˆ’ Kâˆ—  âˆ’   âˆ’ Kâˆ— 2
N N
N
N 


 1 LN âˆ— 
 Â·  âˆ’ âˆ— âˆ’   âˆ’ âˆ— 2
â‰¤


K
K
K
 N 





 1 LN âˆ— 
K
âˆ—

= 
 N  K  âˆ’ C N Â·  âˆ’ K < 0
That is, we have with probability greater than 1 âˆ’ ,
1
1
L  < LN Kâˆ— 
N N
N

for all  with


 âˆ’ Kâˆ— = C

K

N

âˆš
Since LN  is continuous, it has a maximum on the compact set   âˆ’ Kâˆ—âˆš â‰¤ C K/N . By
âˆ—
the last inequality, this maximum must occur for some Ë† K with Ë† âˆ’ K < C K/N . Hence the
ï¬rst-order conditions are satisï¬ed at Ë† K and by concavity of LN  Ë† K maximizes LN  over all
of R K  Because the probability of this is greater than 1 âˆ’  with  arbitrary, we conclude that Ë† K
âˆ—
Ë†
exists
âˆš and satisï¬es the ï¬rst order conditions with probability approaching one, and that K âˆ’ K =
Op  K/N .
Q.E.D.
APPENDIX B: Proofs of Theorems
Proof of Theorem 1: To ease the notational burden we present the proof for the special case
with Y 0 identically equal to 0. This can be interpreted as the special case where one is interested
in estimating the average outcome = EY 1, where Y 1 is missing at random conditional on the
covariates X. Thus it is the direct extension of the binary-covariate example in Section 3. Since
the average treatment effect case simply amounts to estimating two averages where in both cases
the variables are missing at random, the argument for the general case is exactly analogous, only
involving substantially longer equations. In the proof we therefore follow the missing at random set
up with the parameter of interest equal to = EY 1, making the missing at random assumption
Y 1 âŠ¥ T X, and with a random sample of Ti  Xi  Yi Ni=1 , where Yi = Yi 1 Â· Ti .
The estimated weight estimator Ë† ew is
(37)

N

Ti Â· Yi
Ë† ew = 1
N i=1 pÌ‚K Xi 

with pÌ‚K Xi  = LRK Xi  Ë† K . The key part of the proof is to show that



N 
âˆš


Ti Â· Yi
 X 
 N  Ë† ew âˆ’ âˆ—  âˆ’ âˆš1
(38)
âˆ’ âˆ— âˆ’ âˆ—1 i Ti âˆ’ pâˆ— Xi  

 = oP 1
âˆ—
p Xi 
p Xi 
N i=1

1182

k. hirano, g. imbens, and g. ridder

This implies that Ë† ew is asymptotically linear, i.e. behaves asymptotically as a sample average, with
score function Y  T  X âˆ—  pâˆ— Â· + T  X, where
y t x  pÂ· =

t Â·y
âˆ’ 
px

and

t x = âˆ’

1 x
Â· t âˆ’ pâˆ— x
pâˆ— x

The ï¬rst term of the score function, Â·, is equal to the score that would obtain if we substitute the
population probability pâˆ— for the estimator pÌ‚K in (37). The second term, Â·, gives the contribution
of estimating pâˆ— to the asymptotic distribution of Ë† ew . This contribution is linear in T âˆ’pâˆ— X. Hence,
the score linearizes the estimator with respect to and pÂ·. The asymptotic variance of Ë† ew is equal
to the variance of Y  T  x âˆ—  pâˆ— X + T  X (note that its mean is 0). The three components
of this variance are
E Y  T  X

âˆ—

 pâˆ— Â·2  = E

âˆ—

âˆ— 2



1 X2
âˆ’ E1 X2 
pâˆ— X

ET  X2  = E
E Y  T  X

1 X2
 2 X
+ E 1âˆ—
âˆ’
âˆ—
p X
p X

 pâˆ— Â· Â· T  X = âˆ’E

1 X2
+ E1 X2 
pâˆ— X

so that
E Y  T  X

âˆ—

 pâˆ— Â· + T  X2  = E1 X2  âˆ’ 

âˆ— 2

 +E

12 X
pâˆ— X

= VEY 1X + EVY 1X/pâˆ— X
which is the variance in Theorem 1, specialized to the case with 0 x = 02 x = 0.
In the proof of (38) we rewrite the difference by adding and subtracting a number of terms, so
that we can bound the differences. We give the asymptotic order of all differences, which makes it
easier to understand the role of the assumptions. We have

N 
âˆš
1 
Ti Yi
TY
TY
(39)
N  Ë† ew âˆ’ âˆ—  = âˆš
âˆ’ âˆ— i i + âˆ— i i 2 pÌ‚K Xi  âˆ’ pâˆ— Xi 
N i=1 pÌ‚K Xi  p Xi  p Xi 
N 
TY
1 
(40)
âˆ’ âˆ— i i 2 pÌ‚K Xi  âˆ’ pâˆ— Xi 
+âˆš
p Xi 
N i=1

  x
1
+
pÌ‚K x âˆ’ pâˆ— x dF0 x
âˆ—
X p x
âˆš  1 x
âˆ’ N
(41)
pÌ‚K x âˆ’ pâˆ— x dF0 x
âˆ—
X p x
N
1 
Ti âˆ’ pK Xi 
âˆ’âˆš
Ëœ K Xi  
N i=1
pK Xi 1 âˆ’ pK Xi 

(42)

(43)

(44)

N
1 
Ti âˆ’ pK Xi 
+âˆš
Ëœ K Xi  âˆ’ K Xi  
N i=1
pK Xi 1 âˆ’ pK Xi 
N 
1 
Ti âˆ’ pK Xi 
+âˆš
K Xi  
N i=1
pK Xi 1 âˆ’ pK Xi 

Ti âˆ’ pâˆ— Xi 
âˆ’ 0 Xi  
âˆ—
âˆ—
p Xi 1 âˆ’ p Xi 



N
1 
Ti âˆ’ pâˆ— Xi 
T i Â· Yi
+âˆš
âˆ’ âˆ— + 0 Xi  

âˆ—
p Xi 
N i=1
pâˆ— Xi 1 âˆ’ pâˆ— Xi 

estimation of average treatment effects

1183

In this expression F0 is the population cdf of X and
(45)
(46)
(47)

  z

1
âˆ’1 L RK x  âˆ— RK x
L RK z Ëœ K RK z dF0 z
K
K
âˆ—
X p z
  z

1
L RK z Kâˆ— RK z dF0 zâˆ’1
L RK x Kâˆ— RK x
K x = âˆ’
K
âˆ—
X p z

Ëœ K x = âˆ’

0 x = âˆ’

1 x  âˆ—
p Xi 1 âˆ’ pâˆ— Xi 
pâˆ— x

with
k = ERK XRK X L RK X Kâˆ— 

and

N

 = 1
RK Xi RK Xi  LRK Xi  Ëœ K 

K
N i=1

and Ëœ K between Ë† K and Kâˆ— .
âˆš
Note that (44) is equal to the linearized expression for N  Ë† ew âˆ’ âˆ— . To show that the estimator
is indeed asymptotically linear, we must derive bounds on the terms (39)â€“(43). If a bound depends
on both K and N , we derive the bound for sequences KN  that go to  with N . Because during the
derivation some restrictions on these sequences are imposed, the resulting bounds are not uniform
in K. We have seen this type of argument in the derivation of the order of Ë† KN  âˆ’ KN  where
we imposed the large sample identiï¬cation condition KN 4 /N â†’ 0.
Below we present the bounds on the terms (39)â€“(43). Details for the derivations for these bounds
are available from the authors (Hirano, Imbens, and Ridder (2002)). The bound for (39) is


N 
 1 

Ti Yi
Ti Yi
Ti Yi
âˆ—
âˆš


pÌ‚
X

âˆ’
p
X

âˆ’
+
K
i
i
 N

âˆ— X 
âˆ— X 2
pÌ‚
X

p
p
K
i
i
i
i=1


âˆš
K3
s
+ OP N K2 K âˆ’ r
= OP âˆš
N

s
+ OP K5/2 K âˆ’ 2r 
The bound for (40) is

  x
N 
TY
1 
1
âˆ—
x
âˆ’
p
x
dF
x
âˆ’ âˆ— i i 2 pÌ‚K Xi  âˆ’ pâˆ— Xi  +

pÌ‚
âˆš
K
0
âˆ—
p Xi 
X p x
N i=1


K2
s

= OP KK âˆ’ 2r  + OP âˆš
N
The bound for (41) is


N

 âˆš  1 x
1 
âˆ—
Ëœ K Xi   Ti âˆ’ pK Xi 

âˆ’ N

x
âˆ’
p
x
dF
x
âˆ’

pÌ‚
âˆš
K
0

âˆ—
X p x
N i=1
pK Xi 1 âˆ’ pK Xi  
âˆš
s
= O N KK âˆ’ 2r 
The bound for (42) is




N
9/2
 1 

Ti âˆ’ pK Xi 
âˆš
 = OP K
Ë† K Xi  âˆ’ K Xi  

 N

1/2
N
pK Xi 1 âˆ’ pK Xi 
i=1

1184

k. hirano, g. imbens, and g. ridder

The bound for (43) is


 1 
N
Ti âˆ’ pK Xi 
Ti âˆ’ pâˆ— Xi 

K Xi  
âˆ’ 0 Xi  
âˆš
âˆ—
 N i=1
pK Xi 1 âˆ’ pK Xi 
p Xi 1 âˆ’ pâˆ— Xi 


1 s
s
= OP max K âˆ’ 2 r  KK âˆ’ 2r









From these ï¬ve expressions we obtain
(48)


âˆš
 N  Ë† ew âˆ’




N 

1 
Ti Yi
 X 
âˆ’ âˆš
âˆ’ âˆ— âˆ’ âˆ—1 i Ti âˆ’ pâˆ— Xi  
âˆ—
p Xi 
p Xi 
N i=1


âˆš

K3
s
s
+ OP N K2 K âˆ’ r + OP K5/2 K âˆ’ 2r
= OP âˆš
N



âˆš
K2
s
s
+ OP KK âˆ’ 2r + OP âˆš
+ O N KK âˆ’ 2r
N




K9/2
s
s
+ OP
+ OP max K âˆ’ 2r  KK âˆ’ 2r
âˆš
N


âˆš

K9/2
s
s
= OP N K2 K âˆ’ r + OP K5/2 K âˆ’ 2r + OP

âˆš
N
âˆ—

Note that the second term of the ï¬nal expression is a bias term, the third a variance term, and the
ï¬rst a combination of a variance and bias term.
As noted K depends on the sequence of approximating functions. For power series we have
K = OK. If we consider sequences KN  = N c we can ï¬nd the range of c for which (48) is
oP 1. Substitution in the right-hand side of (48) gives that the ï¬rst term on the right-hand side
requires that c > 1/2s/r âˆ’2, the second that s/r > 5, and the third that c < 1/9. These inequalities
can be simultaneously satisï¬ed if s/r â‰¥ 7.
Q.E.D.
Proof of Theorem 2: Deï¬ne
N
1 
Yi Ti
RK Xi 
N i=1 pâˆ— Xi 2

(49)

K = âˆ’

(50)

N

Yi Ti
K = âˆ’ 1
RK Xi 

N i=1 pÌ‚K Xi 2

(51)

N

K = 1
RK Xi RK Xi  
S
N i=1

âˆ’1 RK x is the predicted value in a least squares series regression of âˆ’Yi Ti /pâˆ— Xi 2  on
Then K S
K
K
13
R Xi . This predicted value estimates âˆ’EY x/pâˆ— x, which is the conditional expectation (given
X = x) of the derivative of the moment condition with respect to pâˆ— . The usual bound for series
estimators applies:
(52)

13







K
s
âˆ’1 RK x + 1 x  â‰¤ C1 KN OP
sup K S
+ C2 K âˆ’ r
K

âˆ—
p x
N
xâˆˆX

The number of terms in this series estimator need not be equal to that in the series estimator
of the propensity score. The notation can be changed to reï¬‚ect this.

estimation of average treatment effects

1185

with s  the number of continuous derivatives of 1 x. Also


N

  

pÌ‚K Xi  âˆ’ pâˆ— Xi pâˆ— Xi  + pÌ‚K Xi 
K
K âˆ’ K  =  1


Y
T
R
X

(53)
i i
i 
N
2
âˆ—
2
pÌ‚K Xi  p Xi 
i=1


N  âˆ—



1 
 p Xi  + pÌ‚K Xi  pÌ‚K Xi  âˆ’ pâˆ— Xi  Â· Yi  Â· Ti Â· RK Xi 
â‰¤


2
âˆ—
2
N i=1 pÌ‚K Xi  p Xi 
As in the proof of Theorem 1 we have that pÌ‚K x is bounded from 0 and 1 on X if N â†’  and
hence we have the following bound for (53):
(54)

C sup pÌ‚K x âˆ’ pâˆ— x sup RK x
xâˆˆX

xâˆˆX


= C1 K2 OP

N
1 
Y  + oP 1
N i=1 i


K
s
+ C2 K2 K âˆ’ r 
N

We use the bounds (52) and (54) to obtain a bound on

âˆ’1 RK xt âˆ’ pÌ‚K x
K âˆ’ K  S
(55)
Ë† K t x âˆ’ t x = 
K

âˆ’1 RK x + 1 x t âˆ’ pÌ‚K x + 1 x pÌ‚K x âˆ’ pâˆ— x
+ K S
K
pâˆ— x
pâˆ— x
Under the asymptotic identiï¬cation condition
(56)







âˆ’1 RK x + 1 x 
K âˆ’ K  sup RK x + C2 sup  S
sup Ë† K t x âˆ’ t x â‰¤ C1 
 K K
pâˆ— x 
xâˆˆX
xâˆˆX
xâˆˆX
+ C3 sup 1 x sup pÌ‚K x âˆ’ pâˆ— x
xâˆˆX

xâˆˆX

Because X is compact and 1 x is continuous, supxâˆˆX 1 x < . Substitution of the bounds (52)
and (54), collecting terms of the same order and omitting terms of lower order gives the bound


K
sup Ë† K t x âˆ’ t x â‰¤ C1 K3 OP
(57)
N
xâˆˆX
s

s

+ C2 K3 K âˆ’ r + C3 K âˆ’ r 
It can be shown that the difference between (14) and (13) is bounded by (57) (details of these
calculations are available from the authors). Under the rates speciï¬ed in Theorem 1 this bound is
Q.E.D.
op 1. Hence (14) is a consistent estimator for (13).
Proof of Theorem 4: The derivation of the efï¬ciency bound follows the proof in Hahn (1998).
We consider the case where the propensity score is known. From Theorem 3, it will be evident that
the bound can be achieved without knowledge of the propensity score.
The density of Y 0 Y 1 T  X with respect to some -ï¬nite measure is
qy0 y1 t x = f y0 y1xpâˆ— xt 1 âˆ’ pâˆ— x1âˆ’t f x
The density of the observed data y t x, using the unconfoundedness assumption, is
qy t x = f1 yxpâˆ— xt f0 yx1 âˆ’ pâˆ— x1âˆ’t f x


where f1 Â·x = f y0 Â·x dy0, and f0 Â·x = f Â· y1x dy1. Consider a regular parametric
submodel indexed by , with density
qy t x = f1 yx pâˆ— xt f0 yx 1 âˆ’ pâˆ— x1âˆ’t f x

1186

k. hirano, g. imbens, and g. ridder

which equals qy t x for  = 0 . Note that  does not enter into the term pâˆ— x, because we are
assuming that the propensity score is known. The score is given by
d
lnqytx = sytx = t Â·s1 yx+1âˆ’tÂ·s0 yx+sx x
d
where
d
ln f1 yx 
d
d
ln f0 yx 
s0 yx  =
d
d
sx x =
ln f x
d
s1 yx  =

The tangent space of the model is the set of functions
 = t Â· s1 y x + 1 âˆ’ t Â· s0 y x + sx x
for s1  s0 , and sx satisfying




s1 y xf1 yx dy = 0

âˆ€ x

s0 y xf0 yx dy = 0

âˆ€ x

sx xf x dx = 0

We are interested in estimating

wate â‰¡


gxyf1 yxf x dy dx âˆ’ gxyf0 yxf x dy dx


gxf x dx

So for the parametric submodel indexed by ,

wate  â‰¡


gxyf1 yxf xdydx âˆ’ gxyf0 yxf xdydx


gxf xdx

We need to ï¬nd a function F y t x such that for all regular parametric submodels,
wate 0 
= EF Y  T  XsY  T  X0 


First we calculate wate /. Let g â‰¡ gxf x dx. Then
wate 0 
1 
gxys1 yx 0 f1 yx 0 f x0  dy dx
=

g

âˆ’ gxys0 yx 0 f0 yx 0 f x0  dy dx
+

1 
gx EY 1 âˆ’ Y 0X = x âˆ’ wate
g
Ã— sx x0 f x0  dx 

1187

estimation of average treatment effects
The following choice for F satisï¬es the condition:
F Y  T  X =

T Â· gX
1 âˆ’ T  Â· gX
Y âˆ’ EY 1X âˆ’
Y âˆ’ EY 0X
g Â· pâˆ— x
g Â· 1 âˆ’ pâˆ— x
+

gX
EY 1 âˆ’ Y 0X âˆ’ wate 
g

Hence wate is pathwise differentiable. By Theorem 2, in Section 3.3 of Bickel, Klaassen, Ritov, and
Wellner (1993), the variance bound is the expected square of the projection of F Y  T  X on  .
Since F âˆˆ  , the variance bound is
EF Y  T  X2  = E

gX2
gX2
V Y 1X + E
V Y 0X
2
âˆ—
2
g  p X
g  1 âˆ’ pâˆ— X

+E

gX2
EY 1X âˆ’ EY 0X âˆ’ wate 2 
g 2

QED

REFERENCES
Abadie, A., and G. Imbens (2002): â€œSimple and Bias-Corrected Matching Estimators for Average
Treatment Effects,â€ NBER Technical Working Paper 283.
Angrist, J. D., and J. Hahn (1999): â€œWhen to Control for Covariates? Panel-Asymptotic Results
for Estimates of Treatment Effects,â€ NBER Technical Working Paper 241.
Barnow, B., G. Cain, and A. Goldberger (1980): â€œIssues in the Analysis of Selectivity Bias,â€
in Evaluation Studies, Vol. 5, ed. by E. Stromsdorfer and G. Farkas. San Francisco: Sage.
Bickel, P. J., C. A. J. Klaassen, Y. Ritov, and J. A. Wellner (1993): Efï¬cient and Adaptive
Estimation for Semiparametric Models. Baltimore: Johns Hopkins University Press.
Chamberlain, G. (1987): â€œAsymptotic Efï¬ciency in Estimation with Conditional Moment Restrictions,â€ Journal of Econometrics, 34, 305â€“334.
Crepon, B., F. Kramarz, and A. Trognon (1998): â€œParameters of Interest, Nuisance Parameters and Orthogonality Conditions: An Application to Autoregressive Error Component Models,â€
Journal of Econometrics, 82, 135â€“156.
Dehejia, R., and S. Wahba (1999): â€œCausal Effects in Non-Experimental Studies: Re-Evaluating
the Evaluation of Training Programs,â€ Journal of the American Statistical Association, 94, 1053â€“1062.
Geman, S., and C. Hwang (1982): â€œNonparametric Maximum Likelihood Estimation by the
Method of Sieves,â€ Annals of Statistics, 10, 401â€“414.
Hahn, J. (1998): â€œOn the Role of the Propensity Score in Efï¬cient Semiparametric Estimation of
Average Treatment Effects,â€ Econometrica, 66, 315â€“331.
Hansen, L. (1982): â€œLarge Sample Properties of Generalized Method of Moments Estimators,â€
Econometrica, 50, 1029â€“1054.
Heckman, J., H. Ichimura, and P. Todd (1997): â€œMatching as an Econometric Evaluation
Estimator: Evidence from Evaluating a Job Training Program,â€ Review of Economic Studies, 64,
605â€“654.
(1998): â€œMatching As An Econometric Evaluations Estimator,â€ Review of Economic Studies,
65, 261â€“294.
Heckman, J., H. Ichimura, J. Smith, and P. Todd (1998): â€œCharacterizing Selection Bias Using
Experimental Data,â€ Econometrica, 66, 1017â€“1098.
Heckman, J., and R. Robb (1985): â€œAlternative Methods for Evaluating the Impact of Interventions,â€ in Longitudinal Analysis of Labor Market Data, ed. by J. Heckman and B. Singer. New York:
Cambridge University Press.

1188

k. hirano, g. imbens, and g. ridder

Hellerstein, J., and G. Imbens (1999): â€œImposing Moment Restrictions from Auxiliary Data by
Weighting,â€ Review of Economics and Statistics, 81, 1â€“14.
Hirano, K., G. Imbens, and G. Ridder (2000): â€œEfï¬cient Estimation of Average Treatment
Effects Using the Estimated Propensity Score,â€ NBER Technical Working Paper 251.
(2002): â€œAddendum to: Efï¬cient Estimation of Average Treatment Effects Using the Estimated Propensity Score,â€ http://elsa.berkeley.edu/users/imbens/.
Imbens, G. (1997): â€œOne-step Estimators in Overidentiï¬ed Generalized Method of Moments Estimator,â€ Review of Economic Studies, 64, 359â€“383.
Imbens, G., R. Spady, and P. Johnson (1998): â€œInformation Theoretic Approaches to Inference
in Moment Condition Models,â€ Econometrica, 66, 333â€“357.
Kitamura, Y., and M. Stutzer (1997): â€œAn Information-Theoretic Alternative to Generalized
Method of Moments Estimation,â€ Econometrica, 65, 861â€“874.
Lancaster, T. (1990): â€œA Paradox in Choice-based Sampling,â€ Mimeo, Department of Economics,
Brown University.
Lechner, M. (1999): â€œEarnings and Employment Effects of Continuous Off-the-job Training in East
Germany after Uniï¬cation,â€ Journal of Business and Economic Statistics, 17, 74â€“90.
Little, R., and D. Rubin (1987): Statistical Analysis with Missing Data. New York: Wiley.
Lorentz, G. (1986): Approximation of Functions. New York: Chelsea Publishing Company.
Newey, W. (1994): â€œThe Asymptotic Variance of Semiparametric Estimators,â€ Econometrica, 62,
1349â€“1382.
(1997): â€œConvergence Rates and Asymptotic Normality for Series Estimators,â€ Journal of
Econometrics, 79, 147â€“168.
Qian, H., and P. Schmidt (1999): â€œImproved Instrumental Variables and Generalized Method of
Moments Estimators,â€ Journal of Econometrics, 91, 145â€“169.
Qin, J., and J. Lawless (1994): â€œGeneralized Estimating Equations,â€ Annals of Statistics, 22, 300â€“
325.
Robins, J., S. Mark, and W. Newey (1992): â€œEstimating Exposure Effects by Modeling the Expectation of Exposure Conditional on Confounders,â€ Biometrics, 48, 479â€“495.
Robins, J., and Y. Ritov (1997): â€œTowards a Curse of Dimensionality Appropriate (CODA)
Asymptotic Theory for Semi-parametric Models,â€ Statistics in Medicine, 16, 285â€“319.
Robins, J., and A. Rotnitzky (1995): â€œSemiparametric Efï¬ciency in Multivariate Regression
Models with Missing Data,â€ Journal of the American Statistical Association, 90, 122â€“129.
Robins, J., A. Rotnitzky, and L. Zhao (1995): â€œAnalysis of Semiparametric Regression Models for Repeated Outcomes in the Presence of Missing Data,â€ Journal of the American Statistical
Association, 90, 106â€“121.
Rosenbaum, P. (1987): â€œModel-Based Direct Adjustment,â€ Journal of the American Statistical Association, 82, 387â€“394.
Rosenbaum, P., and D. Rubin (1983): â€œThe Central Role of the Propensity Score in Observational
Studies for Causal Effects,â€ Biometrika, 70, 41â€“55.
(1985): â€œReducing Bias in Observational Studies Using Subclassiï¬cation on the Propensity
Score,â€ Journal of the American Statistical Association, 79, 516â€“524.
Rotnitzky, A., and J. Robins (1995): â€œSemiparametric Regression Estimation in the Presence of
Dependent Censoring,â€ Biometrika, 82, 805â€“820.
Rubin, D. (1974): â€œEstimating Causal Effects of Treatments in Randomized and Nonrandomized
Studies,â€ Journal of Educational Psychology, 66, 688â€“701.
(1976): â€œInference and Missing Data,â€ Biometrika, 63, 581â€“592.
(1977): â€œAssignment to Treatment Group on the Basis of a Covariate,â€ Journal of Educational
Statistics, 2, 1â€“26.
(1978): â€œBayesian Inference for Causal Effects: the Role of Randomization,â€ Annals of Statistics, 6, 34â€“58.
Rubin, D., and N. Thomas (1996): â€œMatching Using Estimated Propensity Scores: Relating Theory
to Practice,â€ Biometrics, 52, 249â€“264.

estimation of average treatment effects

1189

Wooldridge, J. (1999): â€œAsymptotic Properties of Weighted M-Estimators for Variable Probability
Samples,â€ Econometrica, 67, 1385â€“1406.
(2002): â€œInverse Probability Weighted M-Estimators for Sample Selection, Attrition and Stratiï¬cation,â€ Institute for Fiscal Studies, Cemmap Working Paper cwp11/02.

