Labour Economics 41 (2016) 47–60

Contents lists available at ScienceDirect

Labour Economics
journal homepage: www.elsevier.com/locate/labeco

From LATE to MTE: Alternative methods for the evaluation of
policy interventions
Thomas Cornelissen a,⁎, Christian Dustmann b,1, Anna Raute c, Uta Schönberg d
a

Department of Economics and Related Studies, University of York, Heslington, York YO10 5DD, United Kingdom
Department of Economics, University College London and CReAM, 30 Gordon Street, London WC1H 0AX, United Kingdom
Department of Economics, University of Mannheim, L7, 3-5, 68131 Mannheim, Germany
d
Department of Economics, University College London, CReAM and IAB, 30 Gordon Street, London WC1H 0AX, United Kingdom
b
c

a r t i c l e

i n f o

Article history:
Received 13 May 2016
Received in revised form 13 June 2016
Accepted 13 June 2016
Available online 25 June 2016
JEL classiﬁcation:
C26
I26
Keywords:
Marginal treatment effects
Instrumental variables
Heterogeneous effects

a b s t r a c t
This paper provides an introduction into the estimation of marginal treatment effects (MTE). Compared to the
existing surveys on the subject, our paper is less technical and speaks to the applied economist with a solid
basic understanding of econometric techniques who would like to use MTE estimation. Our framework of analysis is a generalized Roy model based on the potential outcomes framework, within which we deﬁne different
treatment effects of interest, and review the well-known case of IV estimation with a discrete instrument
resulting in a local average treatment effect (LATE). Turning to IV estimation with a continuous instrument, we
demonstrate that the 2SLS estimator may be viewed as a weighted average of LATEs and discuss MTE estimation
as an alternative and more informative way of exploiting a continuous instrument. We clarify the assumptions
underlying the MTE framework, its relation to the correlated random coefﬁcients model, and illustrate how
the MTE estimation is implemented in practice.
© 2016 Elsevier B.V. All rights reserved.

1. Introduction
Evaluating the causal effects of programs or policy interventions
is a central task in empirical microeconomics. A common case is
when the program under evaluation takes the form of a binary treatment, such as attending college or attending preschool. Responses to
such treatments (and thus the treatment effect) will most likely differ across individuals. For example, more able individuals are likely
to have lower costs of learning than low ability individuals and
may therefore enjoy larger returns from college attendance. Children
from disadvantaged backgrounds may beneﬁt more from the exposure
to a high quality child care program than children from advantaged
backgrounds.
Even though treatment effects are likely to be heterogeneous, early
standard econometric textbooks aimed at applied researchers did not
pay much attention to heterogeneous treatment effects (see, e.g., the

⁎ Corresponding author.
E-mail addresses: thomas.cornelissen@york.ac.uk (T. Cornelissen),
c.dustmann@ucl.ac.uk (C. Dustmann), raute@uni-mannheim.de (A. Raute),
u.schoenberg@ucl.ac.uk (U. Schönberg).
1
Christian Dustmann acknowledges funding from the European Research Council
(ERC) under advanced grant no. 323992.

http://dx.doi.org/10.1016/j.labeco.2016.06.004
0927-5371/© 2016 Elsevier B.V. All rights reserved.

textbooks by Johnston, 1963; Maddala, 1992). Switching regression
models, in which the effects of observed and unobserved characteristics
are allowed to differ across states (where the state could be a treatment,
and thus the treatment effect would depend on observed and unobserved characteristics), present early approaches of modeling treatment
effect heterogeneity and date back to the 1970s (see Quandt, 1972;
Heckman, 1976; Lee, 1979). Rubin (1974) deﬁnes heterogeneous causal
effects at the individual level in terms of potential outcomes and discusses the average treatment effect (ATE) (or “average causal effect”)
as an interesting parameter in order learn about the “typical” causal effect in a population. The study of Heckman and Robb (1985) is an important early contribution in pointing out that the average treatment
effect (ATE) and the average treatment effect on the treated (ATT) are
two conceptually distinct parameters that ask different economic policy
questions. They analyze a random coefﬁcients treatment effects regression with observed and unobserved heterogeneity in rewards (which
they show to be equivalent to the switching regression model with
two states) and emphasize that different estimation methods will in
general identify different parameters. However, despite these seminal
early contributions, much of the applied work continued to assume
homogeneous treatment effects, focusing mainly on addressing the
problem of endogeneity caused by self-selection into treatment based
on unobserved characteristics.

48

T. Cornelissen et al. / Labour Economics 41 (2016) 47–60

The “LATE revolution” in the 1990s changed the focus to identiﬁcation of models when treatment effects are heterogeneous.2 The early
papers in this literature by Imbens and Angrist (1994) and Angrist
et al. (1996) raised awareness about potential heterogeneity in returns
and clariﬁed the interpretation of IV estimates when treatment effects
are heterogeneous. Heckman and Vytlacil (1998), Card (2001), and
others proposed a control function approach based on the correlated
random coefﬁcient model as an alternative to conventional linear IV estimation which, under stronger assumptions than IV estimation, allows
estimation of the ATE and yields some insight into the pattern of selection in the unobservables. The concept of the marginal treatment effect
MTE was ﬁrst introduced by Björklund and Mofﬁtt (1987) in the context
of a multivariate-normal switching regression model, in which they deﬁned the “marginal gain” as the gain from treatment for individuals who
are shifted into (or out of) treatment by a marginal change in the cost of
treatment (i.e., the instrument). It was extended in a series of papers by
Heckman and Vytlacil (1999, 2001b, 2005, 2007) who deﬁne the MTE as
the gain from treatment for individuals shifted into (or out of) treatment by a marginal change in the propensity score (i.e., the predicted
probability of treatment, which is a function of the instrument), develop
nonparametric estimation methods, and clarify the connection of the
switching regime self-selection model and of MTE with IV and LATE.
Since then, the applied literature estimating MTEs has been growing
and now includes, in addition to many applications in the economics of
education, applications as varied as the effect of foster care on child outcomes (Doyle, 2007), the effect of Disability Insurance receipt on labor
supply (Maestas et al., 2013; French and Song, 2014), and the interaction of quantity and quality of children (Brinch et al., forthcoming).3
Some recent surveys provide insightful discussions about MTE, see for
example Blundell and Costa Dias (2009), who discuss MTE among a
range of alternative policy evaluation approaches, French and Taber
(2011) who discuss treatment effects and MTE and its relation to the
Roy model, and the excellent, comprehensive, but technical treatments
of MTE in Heckman and Vytlacil (2007) and Heckman et al. (2006),
based on the earlier work by Heckman and Vytlacil (1999, 2001a,b, 2005).
Drawing on these earlier papers, we provide here an introduction to
the MTE framework, clarifying the discussion based on examples and developing it in a way that we believe is accessible to the applied economist.
We commence by proposing a simple framework that allows for treatment effect heterogeneity and deﬁne within this framework different
treatment effects of interest such as the average treatment effect (ATE)
the average treatment effect on the treated (ATT), and the average treatment effect on the untreated (ATU). We next discuss the well-known
local average treatment effect (LATE) identiﬁed by IV with a binary instrument, before reviewing IV estimation with continuous instruments.
We carefully describe how conventional ways of exploiting continuous
instruments identify one overall IV effect that can be difﬁcult to interpret
and can hide interesting patterns of treatment effect heterogeneity. Based
on the example of the correlated random coefﬁcients model, we then discuss the control function approach as an alternative to conventional linear IV estimation. We explain that, under considerably stronger

2
In their 1994 Econometrica paper, Imbens and Angrist (1994) deﬁne the local average
treatment effect (LATE) and spell out the assumptions under which IV identiﬁes LATE.
Angrist et al. (1996) coined the terms compliers, always-takers, never-takers, and deﬁers.
However, the notion that in a world of heterogeneous treatment effects a binary IV identiﬁes the average treatment effect for individuals who switch treatment status in response
to changes in the instrument predates these papers. For example, it was already discussed
in Angrist’s (1990) paper using the Vietnam draft lottery as an IV for veteran status.
3
Applications in economics of education range from estimating the effects of child care attendance on child performance (Felfe and Lalive, 2015; Noboa-Hidalgo and Urzúa, 2012, and
Cornelissen et al., 2016, the effects of secondary schooling attendance on earnings (Carneiro
et al., forthcoming), the effects of advanced high school mathematics education on earnings
(Joensen and Nielsen, 2016), the effects of mixed-ability schools on long-term health (Basu
et al., 2014), the effects of alternative breast cancer treatments on medical costs (Basu et al.,
2007), and the returns to attending college (see e.g. Carneiro et al., 2011 for the U.S., Balfe,
2015 for the U.K., Kamhöfer et al., 2015, for Germany, and Nybom, 2014, for Sweden as well
as Kaufmann, 2014, on the role of credit constraints in Mexico).

assumptions than conventional IV estimation, the control function estimator of that model identiﬁes a more general effect than IV and reveals
some information on the pattern of selection based on unobserved
gains. After that, we turn to MTE estimation as a more informative way
of exploiting a continuous instrument, which aims at identifying a continuum of treatment effects along the distribution of the individual unobserved characteristic that drives treatment decisions and allows the
identiﬁcation of a variety of treatment parameters such as ATE, ATT, and
ATU under potentially no stronger assumptions than IV estimation. We ﬁnally illustrate MTE estimation using two examples from the literature.
Our paper is less technical (and therefore also less rigorous) than the
previous methodological contributions on MTE. It is written for the applied economist and introduces the method in a simple way, with a
strong focus of relating MTE to more conventional IV estimation. The
two applications we discuss illustrate to the applied researcher how
MTE estimation can be implemented, and which additional insights hidden by IV estimation can be gained from MTE estimation. We also provide a set of lecture slides to accompany this article (available from the
authors’ personal websites).
2. Instrumental variable estimation with heterogeneous
treatment effects
2.1. Framework of analysis and deﬁnition of treatment effects
Our general framework is a generalized Roy model based on the potential outcomes model and a latent variable discrete choice model for selection into treatment, as in Heckman and Vytlacil (1999) and most of the
subsequent MTE literature.4 We assume that treatment is a binary
variable denoted by Di. Let Y1i be an individual’s outcome under the hypothetical scenario that the individual is treated (Di = 1) and Y0i the outcome under the hypothetical scenario that the individual is not treated
(Di = 0). For example, Y1i and Y0i could be an individual’s wage in the
two hypothetical scenarios that the individual attends college and does
not attend college, respectively. We model these potential outcomes as
Y 0i ¼ μ 0 ðX i Þ þ U0i

ð1Þ

Y 1i ¼ μ 1 ðX i Þ þ U1i

ð2Þ

where μ j(Xi) is the conditional mean of Yji given Xi in treatment state j and
Uji captures deviations from that mean implying that E[Uji |Xi]=0.5
Consider the following latent variable discrete choice model for selection into treatment, which forms the basis for the MTE approach:
Di ¼ μ D ðX i ; Z i Þ−V i
Di ¼ 1 if Di ≥0;

ð3Þ
Di ¼ 0 otherwise;

ð4Þ

where D⁎i is the latent propensity to take the treatment. D⁎i is interpretable as the net gain from treatment (because individuals take the treatment if D⁎i ≥0). The observed variables that affect the treatment decision
include the same covariates Xi as the outcome Eqs. (1) and (2), and one
or more variables Zi excluded from the outcome equation. Vi is an i.i.d.
error term indicating unobserved heterogeneity in the propensity for
treatment. Because the error term Vi enters the selection equation
with a negative sign, it embodies unobserved characteristics that
make individuals less likely to receive treatment. One could thus label
Vi unobserved “resistance” or “distaste” for treatment. The condition
D⁎i ≥ 0 of taking the treatment can be rewritten as μ D(Xi, Zi) ≥ Vi. If we
4
The potential outcome model, often also referred to as the “Rubin causal model,” is a
building block for the literature on causal inference and goes back to Rubin (1974) and
Holland (1986).
5
The assumption of linear separability of Yji in μ j(Xi) and Uji is common in the applied
MTE literature. It provides a simpliﬁcation of the more general case Yji = μ j(Xi, Uji) and
makes computation of the aggregate treatment parameters (Eqs. (7)–(10)) and of the
MTE weights (Section 4.3) more tractable.

T. Cornelissen et al. / Labour Economics 41 (2016) 47–60

apply the c.d.f. of V to this inequality, we get FV(μ D(Xi,Zi))≥ FV(Vi). Both
sides of this inequality are now bounded within the 0/1-interval. The
left-hand side represents the propensity score, the probability of being
treated based on the observed characteristics, and we refer to this
term as P(Xi, Zi) ≡ FV(μ D(Xi, Zi)). The right-hand side, FV(Vi), represents
the quantiles of the distribution of the unobserved distaste for treatment Vi, which we denote by UDi ≡ FV(Vi). The treatment decision can
thus be rewritten as
Di ¼ 1 if P ðX i ; Z i Þ≥UDi ;

Di ¼ 0 otherwise:

ð5Þ

Individuals take the treatment if the propensity score exceeds the
quantile of the distribution of Vi at which the individual is located—that
is, if the “encouragement” for treatment based on the observables Xi and
Zi exceeds the unobserved distaste for treatment.
It should be noted that the two potential outcomes Y0i and Y1i are
never jointly observed for the same individual. Instead, we observe
the realized outcome Yi,which is equal to either Y0i or Y1i depending
on treatment status:
Y i ¼ ð1−Di ÞY 0i þ Di Y 1i ¼ Y 0i þ Di ðY 1i −Y 0i Þ
This is in essence the switching regression model of Quandt (1972)
and Lee (1979). Substituting in for Y0i and Y1i shows that the potential
outcome framework can be represented as the regression model
Y i ¼ μ 0 ðX i Þ þ Di ½ μ 1 ðX i Þ−μ 0 ðX i Þ þ U 1i −U 0i  þU 0i ;
|ﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ{zﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ}

ð6Þ

Y 1i −Y 0i ≡ Δi

in which the coefﬁcient on the treatment dummy varies across individuals and is equal to
Δi ¼ Y 1i −Y 0i ¼ μ 1 ðX i Þ−μ 0 ðX i Þ þ U 1i −U 0i :
This treatment effect has two components: The average gain of
someone with given observed characteristics, μ1(Xi) − μ0(Xi), and an idiosyncratic individual-speciﬁc gain, (U1i − U0i).
There are good reasons to expect treatment effect heterogeneity.
Consider the example of college education. First, individuals can be heterogeneous in their untreated outcome (Y0i) reﬂecting differences in
their experiences before entering college, such as the quality of their
high school education, family background, etc. If the main effect of
college attendance is to equalize preexisting differences and to bring everyone to the same level, then Y1i would be more homogeneous than Y0i,
and individuals with lower outcomes in the untreated state would have
higher treatment effects. Alternatively, it could be that some individuals
are more able to beneﬁt from college attendance (maybe because their
ability to learn is higher) so that they would have a higher Y1i even if Y0i
was similar to that of other individuals. A higher Y1i for a given Y0i could
also result from variation in the quality of the treatment, for example,
because colleges differ in the quality of their teaching and resources.
A main implication of heterogeneous effects is that summary treatment effects that aggregate over different parts of the population will
in general be different from one another. Consider for example the average treatment effect (ATE), the average treatment effect on the treated
(ATT), and the average treatment effect on the untreated (ATU).6 Conditional on Xi = x, they are deﬁned as

49

average treatment effect in the subgroup of the population that participates in the treatment conditional on Xi =x. Similarly, the ATU is the average treatment effect in the subgroup of the population that does not
participate in the treatment conditional on Xi =x. ATE(x) measures how
individuals with observed characteristics Xi =x would beneﬁt on average
from the treatment if everybody with these observed characteristics were
participating in the treatment, or the expected effect if some individuals
from the group of individuals with observed characteristics Xi =x were
randomly assigned to treatment. ATT(x) measures how those individuals
with observed characteristics Xi = x that are currently enrolled in the
treatment beneﬁt from it on average. ATU(x) on the other hand answers
the question how those individuals with observed characteristics Xi =x
who are currently not enrolled would beneﬁt on average from treatment
if they participated.
By averaging these parameters over the appropriate distribution of
Xi, they can also be deﬁned unconditionally:
ATE ¼ E½Δi  ¼ E½μ 1 ðX i Þ−μ 0 ðX i Þ

ð7Þ

ATT ¼ E½Δi jDi ¼ 1 ¼ E½μ 1 ðX i Þ−μ 0 ðX i ÞjDi ¼ 1 þ E½U 1i −U 0i jDi ¼ 1 ð8Þ
ATU ¼ E½Δi jDi ¼ 0 ¼ E½μ 1 ðX i Þ−μ 0 ðX i ÞjDi ¼ 0 þ E½U 1i −U 0i jDi ¼ 0 ð9Þ
In a linear speciﬁcation for the conditional mean, that is, μ j(Xi) =
Xiβj, the terms E[μ1(Xi)−μ 0(Xi)], E[μ1(Xi)−μ 0(Xi)|Di =1], and E[μ1(Xi)−
μ 0(Xi)|Di =0] would simplify to E[Xi](β1 −β0), E[Xi |Di =1](β1 −β0), and
E[Xi |Di =0](β1 −β0), respectively.
Sometimes we would like to know the aggregate effect of a speciﬁc
policy change. This is given by the policy-relevant treatment effect
(PRTE), see Heckman and Vytlacil (2001a, 2005) and Carneiro et al.
(2011). Consider a policy change that affects the propensity score
P(Xi, Zi), but not potential outcomes (Y1i , Y0i) or the unobservables of
the selection process (Vi). Such a policy will not change the underlying
distribution of treatment effects, or preferences for treatment, but by
changing the propensity score, the policy will change who selects into
treatment based on the selection Eq. (5). Suppose Di is the treatment
~ i is the treatment choice under
choice under the baseline policy, and D
the alternative policy. The PRTE conditional on Xi = x is deﬁned as
(see Appendix A for details):
E½Y i jX i ¼ x; alternative policy−E½Y i jX i ¼ x; baseline policy
E½Di jX i ¼ x; alternative policy−E½Di jX i ¼ x; baseline policy
¼
μ 1 ðxÞ−μ 0 ðxÞ
E½U 1i −U 0i jX i ¼ x; D i ¼ 1E½D i jX i ¼ x−E½U 1i −U 0i jX i ¼ x; Di ¼ 1E½Di jX i ¼ x
þ
E½D i jX i ¼ x−E½Di jX i ¼ x

PRTEðxÞ ¼

and the corresponding unconditional effect is
PRTE ¼
þ

E½μ 1 ðX i Þ−μ 0 X i jD i ¼ 1E½D i −E½μ 1 ðX i Þ−μ 0 ðX i ÞjDi ¼ 1E½Di 
E½D i −E½Di 
ð10Þ
E½U 1i −U 0i jD i ¼ 1E½D i −E½U 1i −U 0i jDi ¼ 1E½Di 
E½D i −E½Di 

ATEðxÞ ¼ E½Δi jX i ¼ x ¼ μ 1 ðxÞ−μ 0 ðxÞ
ATTðxÞ ¼ E½Δi jX i ¼ x; Di ¼ 1 ¼ μ 1 ðxÞ−μ 0 ðxÞ þ E½U 1i −U 0i jX i ¼ x; Di ¼ 1
ATUðxÞ ¼ E½Δi jX i ¼ x; Di ¼ 0 ¼ μ 1 ðxÞ−μ 0 ðxÞ þ E½U 1i −U 0i jX i ¼ x; Di ¼ 0

Conditional on Xi =x, the ATE is the average treatment effect for an individual with given observed characteristics Xi =x, while the ATT is the
6
For an extension of the framework including additional parameters on the cost and
the surplus of the treatment, see Eisenhauer et al. (2015).

The PRTE is the mean effect of going from a baseline policy to an alternative policy per net person shifted. It also corresponds to a weighted
difference between the ATT under the alternative policy and the ATT
under the baseline policy.7
7
If a policy only shifts additional people into treatment without shifting anyone out of
the treatment, the PRTE is the average effect on the subgroup of individuals shifted into
treatment by the policy. In general, a policy may shift some individuals into treatment
and some individuals out of treatment. In this case, the PRTE is a net effect in which those
shifted out of treatment receive a negative weight. Nevertheless, it is still informative on
the aggregate effect of the policy (Heckman and Vytlacil, 2005).

50

T. Cornelissen et al. / Labour Economics 41 (2016) 47–60

It is important to note that ATE, ATT, ATU, and PRTE would be the
same if there was no selection into treatment based on gains—one
might imagine that individuals simply do not know their idiosyncratic
returns to treatment or simply do not act on them. In reality it however
seems likely that, depending on the context, individuals do select into
treatment either directly based on gains, or based on characteristics
that are related to gains. In consequence, the treatment parameters
would in general differ. In the case of college attendance, for example,
we would expect individuals who expect higher gains (e.g., higher future wages) from college attendance to be more likely to attend college.
Such positive selection on gains is likely to occur based on both observed and unobserved characteristics. Positive selection on “unobserved gains” implies that U1i − U0i is positively related to Di
conditional on Xi, such that E[U1i − U0i | Xi = x, Di = 1] N 0 and E[U1i −
U0i | Xi = x, Di = 0]b 0, and thus ATT(x) N ATE(x) N ATU(x). Positive selection on “observed gains” implies that μ1(Xi) − μ0(Xi) is positively related
to Di, and thus ATT N ATE N ATU (provided that
ATT(x) ≥ ATE(x) ≥ ATU(x)).
When treatment effects are heterogeneous, it is of primary relevance
to spell out which effect a given econometric method identiﬁes.
Next, we discuss which parameters linear instrumental variable estimation with a binary instrument and with a continuous instrument
identify (Sections 2.2 and 2.3) and contrast these approaches with
the control function estimator of the correlated random coefﬁcient
model (Section 2.4).
2.2. IV with a binary instrument and LATE
We ﬁrst apply the IV estimator within subsamples stratiﬁed by
Xi = x, leading to covariate-speciﬁc IV estimates, similar to the
covariate-speciﬁc treatment effects deﬁned in Section 2.1. We then
derive one aggregate IV estimator representing an average across
values of Xi.
2.2.1. Covariate-speciﬁc IV
Let Zi be a binary instrumental variable. The IV estimator with binary
instrument conditional on Xi = x is equal to the Wald estimator
WaldðxÞ ¼

E½Y i jZ i ¼ 1; X i ¼ x −E½Y i jZ i ¼ 0; X i ¼ x
:
E½Di jZ i ¼ 1; X i ¼ x−E½Di jZ i ¼ 0; X i ¼ x

ð11Þ

In the sample of individuals with Xi = x, this estimator divides
the average difference in the outcome between individuals with the instrument switched on (Zi = 1) and individuals with the instrument
switched off (Zi = 0) by the same difference in average treatment status.
The numerator is also commonly referred to as the “reduced form” and
the denominator as the “ﬁrst stage.”
The assumptions under which this ratio estimates a causal effect are
well understood, and we state them only brieﬂy here (see, e.g., Angrist
and Pischke, 2009 for a detailed discussion). Let D0i denote the potential
treatment state of individual i if Zi = 0 and D1i the potential treatment
state of individual i if Zi = 1, so that observed treatment Di is equal to 8
Di ¼ Z i D1i þ ð1−Z i ÞD0i :
The following assumptions are required for a causal interpretation of
(11):
(i) Independence: {Y1i, Y0i, D1i, D0i} ⫫ Zi | Xi. This assumption ﬁrst
states that the instrument Zi must be as good as randomly
assigned conditional on Xi. Random assignment ensures that
the reduced-form effect of Zi on Yi has a causal interpretation
(conditional on Xi) . The independence assumption further states
that conditional on Xi, the instrument must affect potential
8
Note that potential outcomes are indexed against the treatment state, whereas the potential treatment decision is indexed against the value of the instrument.

outcomes only through its effect on the treatment probability
Di—which is commonly referred to as the exclusion restriction.9
The exclusion restriction is necessary for the Wald estimator to
identify the causal effect of treatment Di on Yi. It should be
noted that the exclusion restriction would be violated if treatment effects Y1i − Y0i depended on the instrument.10 Within
the generalized Roy model of Eqs. (1)–(4), the independence assumption may be alternatively written as (U0, U1, V) ⫫ Z| X.
(ii) Existence of a ﬁrst stage: E[D1i − D0i | Xi] ≠0
(iii) Monotonicity (or uniformity): D1i ≥ D0i ∀ i or D1i ≤ D0i ∀ i. This assumption means that all individuals who change their treatment
status as a result of a change in the instrument either get all
shifted into treatment or get all shifted out of treatment.11 Here
we assume that Zi is coded in a way that Zi = 1 provides an
extra encouragement for treatment compared to Zi = 0, implying
that monotonicity holds in the form of D1i ≥D0i ∀i.
Under these assumptions, the IV estimator in Eq. (11) with a binary
instrument applied in a subsample in which the covariates are ﬁxed at
Xi = x identiﬁes the covariate-speciﬁc local average treatment effect
(LATE) deﬁned by
LATEðxÞ ¼ E½Y 1i −Y 0i jD1i ND0i ; X i ¼ x
¼ μ 1 ðX i Þ−μ 0 ðX i Þ þ E½U 1i −U 0i jD1i ND0i ; X i ¼ x

ð12Þ

The subpopulation for which D1i N D0i holds true is called the group of
compliers (Angrist et al., 1996). These are individuals whose potential
treatment status changes in response to the extra encouragement for
treatment as the instrument changes from 0 to 1. They are treated if
the instrument is switched on (D1i =1) and untreated if the instrument
is switched off (D0i = 0). For example, if the instrument is a dummy variable for a college being located nearby an individual’s place of residence, then the LATE is the treatment effect averaged over the group
of individuals who attend college if living nearby a college, but who
do not attend college if the college is far away. These might be people
who are constrained in their resources to take up college far away
from their place of residence, as argued by Card (2001), or who feel
that their return from college would not warrant the cost of attending
college in a faraway location. IV is not informative on the effect for the
subgroup of always-takers (deﬁned by D1i = D0i = 1) and never-takers
(deﬁned by D1i =D0i =0), who decide in favour (or against) college attendance independently of the value of the instrument. In this example,
always-takers could be individuals who estimate their returns as high
enough in order to warrant college attendance even in a faraway location, and never-takers would not attend college even in a nearby location. The existence of deﬁers, deﬁned by D1i b D0i, who attend college
9
To make the distinction between random assignment and exclusion more explicit,
Angrist and Pischke (2009) introduce the following notation. Let Yi(d,z,x) denote the potential outcome of an individual with treatment status Di =d, instrument value Zi =z, and
covariate Xi = x. The random assignment assumption may then be written as
{Yi(D1i, 1,x),Yi(D0i, 0,x),D1i,D0i} ⫫ Zi |Xi, while the exclusion restriction may be written as
Yi(d,0,x)=Yi(d,1,x).
10
To see this, consider the following simple example. Suppose Y0i does not depend on
the instrument, but treatment effects vary with the instrument such that Y1i −Y0i =Δ1 if
Zi =1 and Y1i −Y0i =Δ0 if Zi =0. This violates the exclusion restriction. It follows that E[Yi |Zi =1]=E[Y0i]+Δ1E[Di |Zi =1] and E[Yi |Zi =0]=E[Y0i]+ Δ0E[Di |Zi =0]. Substituting this
i jZ i ¼1−Δ0 E½Di jZ i ¼0
into the Wald estimator yields Δ1 E½D
E½Di jZ i ¼1−E½Di jZ i ¼0 . Because the treatment effect differs
for the two values of the instrument, it cannot be factored out of the difference in the numerator and the result is a nonsensically weighted average of Δ0 and Δ1, giving positive
−E½Di jZ i ¼0
i jZ i ¼1
weight E½Di jZ iE½D
¼1−E½Di jZ i ¼0 to Δ1 and negative weight E½Di jZ i ¼1−E½Di jZ i ¼0 to Δ0. Similarly, when
using group indicator dummies (say, regions, cohorts, region-year cells, etc.) as instruments, the exclusion restriction requires the treatment effects to be similar across groups
(conditional on the control variables). Whether or not this is credible depends on any given application.
11
The IV monotonicity assumption is an assumption of a unidirectional effect of Zi on
E[Di |Zi] across individuals. It is therefore sometimes referred to as uniformity rather than
monotonicity assumption (e.g., Heckman and Vytlacil, 2007).

T. Cornelissen et al. / Labour Economics 41 (2016) 47–60

in a faraway location but not in a nearby location is ruled out by the
monotonicity assumption.
2.2.2. Aggregating covariate-speciﬁc LATEs into one IV effect
The covariate-speciﬁc LATEs can be aggregated into one IV effect by
applying 2SLS with a fully saturated model in covariates in both the ﬁrst
and second stage and interactions between the instrument and the covariates in the ﬁrst stage (the “saturate and weight” theorem by
Angrist and Imbens, 1995). This produces a variance-weighted average
of the covariate-speciﬁc LATEs and equals:
IV ¼ ∑ ωðxÞLATEðxÞ
x∈X

where X is the set of all unique values of Xi, and ω(x) are weights that
sum to one and are equal to the contribution of the observations with
Xi = x to the variance of the ﬁrst-stage ﬁtted values.12 In practice, less
saturated models seem to provide a good approximation to the underlying causal relation (see the discussion related to Theorem 4.5.1 in
Angrist and Pischke, 2009).
There is an important difference between LATE deﬁned in Eq. (12)
and the other treatment parameters deﬁned in the previous section.
ATE, ATT, ATU, and PRTE are parameters that answer economic policy
questions and are deﬁned independently of any instrument. LATE, on
the other hand, is deﬁned by the instrumental variable used (because
compliers are deﬁned in relation to the instrument) and therefore
does not necessarily answer an economic policy question and does not
necessarily represent a treatment parameter for an economically interesting group of the population, criticisms made for example in Heckman
(1997), Deaton (2009), and Heckman and Urzúa (2010).
There are, however, special cases in which LATE coincides with economically interesting parameters. The ﬁrst case is when the instrument
is a policy change in which case LATE is equivalent to PRTE deﬁned in
Eq. (10) and thus a policy-relevant parameter (Heckman et al., 1999).
An example is the paper by Oreopoulos (2006) who uses an increase of
the compulsory school-leaving age as a binary instrument. LATE thus captures the effect for individuals induced to stay in school longer by the policy reform and is a PRTE. Interestingly, the case analyzed by Oreopoulos
(2006) is at the same time an example for a second special case. Because
the increase in the school-leaving age was fully enforced, there were no
never-takers. Consequently all untreated are compliers (with the instrument switched off) and in such a case LATE is equal to ATU. An example
for the opposite case is a recent paper by Chetty et al. (2016), who evaluate the long–run effects of the Moving To Opportunity (MTO) experiment,
which offered randomly selected families housing vouchers to move from
high-poverty housing projects to lower-poverty neighborhoods. The random assignment to the treatment group (offer of a voucher) was used as
an instrument for the actual treatment decision (in this case the decision
to relocate to a lower-poverty neighborhood). Because nobody in the control group had access to the treatment, there were no always-takers, implying that all treated are compliers (with the instrument switched on)
and LATE identiﬁes ATT. 13
̂
12
The weights are equal to ωðX i Þ ¼ px VarðDi jX̂ i ¼xÞ, where Dî ¼ E½Di jX i ; Z i  denotes the ﬁrst
VarðDi Þ
stage ﬁtted value and px the population share of individuals with Xi =x. These are the same
weights as equation 4.5.4 in Angrist and Pischke (2009) in somewhat different notation. It
should be noted that conditional on X, all variation inDî comes from the instrument(s) and
that VarðDî Þ ¼ CovðDî ; Di Þ. Therefore, the weight ω(x) can also be interpreted as the contribution of observations with Xi = x to the ﬁrst-stage covariance and in that sense the
weights are proportionate to how strongly individuals with Xi =x are shifted by the instrument. This is, however, not in general equal to the share of compliers at Xi =x relative to all
compliers.
13
Using treatment assignment as an instrument for actual treatment is common in randomized trials when there is not full compliance with the treatment assignment. Just as in
the examples above, LATE identiﬁes ATT (when some members of the treatment group do
not take the treatment, but nobody in the control group has access to treatment) or ATU
(when all members of the treatment group take the treatment, and some members of
the control group gain access to the treatment). These two cases are called “one-sided
non-compliance.”

51

2.3. IV with a continuous instrument
2.3.1. Pairwise covariate-speciﬁc LATEs
If Zi is a continuous instrument, then one can exploit any pair of
values z and z′ of Zi as a binary instrument calculating the covariatespeciﬁc IV estimator
Waldðz; z0 ; xÞ ¼

E½Y i jZ i ¼ z; X i ¼ x−E½Y i jZ i ¼ z0; X i ¼ x
:
E½Di jZ i ¼ z; X i ¼ x−E½Di jZ i ¼ z0; X i ¼ x

ð13Þ

In order for each of these IV estimators to capture the average treatment effect for compliers with a change in the instrument from z to z′, Zi
needs to fulﬁl the IV assumptions discussed in Section 2.2. In particular,
the monotonicity (or uniformity) assumption needs to hold between all
pairs of values z and z′ of Zi. Denoting by Dzi a binary indicator for the potential treatment status of individual i for instrument value Zi = z, the
monotonicity assumption requires that for any given pair of values z
and z′, either Dzi ≥ Dz ′ i , ∀ i, or Dzi ≤ Dz ′ i , ∀ i (Imbens and Angrist, 1994).
That is, all individuals whose treatment status is affected by a change
of the instrument from z to z′ have to either all be shifted into treatment,
or all be shifted out of treatment. A treatment choice model that ensures
monotonicity to hold between all pairs of values of Zi is the simple latent
index choice model with a linearly separable error term deﬁned in
Eqs. (3) and (4). Assuming that a move from z to z′ shifts individuals
into treatment (E[Di | Zi = z, Xi = x] N E[Di | Zi = z′, Xi = x]), the associated
LATE is14
LATEðz; z0 ; xÞ ¼ E½Y 1i −Y 0i jDzi N Dz0 i ; X i ¼ x:

ð14Þ

In terms of the latent index choice model, the condition Dzi N Dz ′ i
(which characterizes compliers in the case where a move from z
to z′ increases the average treatment probability) is equivalent to
P(z′) b UD b P(z). That is, compliers are individuals with intermediate
values of the “distaste” for treatment, such that they do not choose treatment when faced with a propensity score value of P(z′), but they choose
treatment when faced with the higher value P(z). The LATE exploiting
pairs of values z and z′ (for the case in which a change from z to z′ increases average treatment probability) can thus also be written as
E½Y 1i −Y 0i jP ðz0Þ b U D b P ðzÞ; X i ¼ x

ð15Þ

Fig. 1, which is based on hypothetical data, helps to illustrate the
group of compliers. Assuming a subsample with covariates ﬁxed at
Xi = x, the ﬁgure depicts a continuous instrument Zi on the horizontal
axis varying between 0 and 200. The vertical axis measures the treatment probability, and the solid line displays E[Di | Zi, Xi = x], the treatment probability as a function of Zi. For example, Zi could be distance
to college and Di college attendance. A reduction of the instrument
from Zi = 120 to Zi = 90 raises the probability of treatment from
P(120)=.5 to P(90)=.75. This shifts individuals with .5 b UD b . 75 into
treatment, which are individuals who are between the 50th and the
75th percentile of the distribution of V. The associated LATE would
thus be the treatment effect for this subgroup.
In practice, the possibility of computing all pairwise LATEs with a
continuous instrument is obviously limited, as the number of observations in a given sample for every z and z′ pair is likely to be small. A useful way of exploiting a continuous instrument is therefore to partition it
into discrete groups.15 Consider partitioning the range of Zi in Fig. 1 into
14
Conversely, if a move from z to z′ shifts compliers out of treatment (E[Di | Zi =
z, Xi =x]b E[Di |Zi =z′, Xi =x]), then the associated LATE is E[Y1i − Y0i | Dzi b Dz′i, Xi =x]. The
only difference is that compliers are now deﬁned by Dzi b Dz′i instead of Dzi N Dz′i.
15
It should be noted that simply using Zi as a continuous instrument in a linear IV estiCovðY i ;Z i Þ
mator CovðD
requires an additional type of monotonicity assumption (see condition 3
i ;Z i Þ
in Imbens and Angrist, 1994). This only produces a non-negatively weighted combination
of LATEs if Zi has a monotonic association with the treatment probability. One way to ensure this condition holds is to use the propensity score P(Z) as an instrument.

52

T. Cornelissen et al. / Labour Economics 41 (2016) 47–60

Fig. 1. Treatment probability as a function of a continuous instrument. Notes: Based on
hypothetical data, the ﬁgure shows the effect of a continuous instrument Z on the
probability of treatment in a sample with ﬁxed covariates (E[D = 1,Z,X = x]). For
example, the horizontal axis could represent distance to college and the vertical axis
could represent the probability to attend college. Data source: Simulated hypothetical data.

equally sized bins identiﬁed by a bin identiﬁer or grouping variable Ri,
which is a function of Zi and assumes the integer values of 1 to 20 to indicate in which bin a given value of Zi is situated. This is illustrated in
Fig. 2, where the horizontal axis is partitioned into 20 bins, and the
bin height indicates the average treatment probability in each bin,
E[Di | Ri, Xi = x]. From any pair of two points Ri = r and Ri = r′, and with
corresponding data on the average outcome by bin, conditional on Xi,
E½Y i jRi ¼r;X i ¼x−E½Y i jRi ¼r0;X i ¼x
can be constructa Wald estimator of the form E½D
i jRi ¼r;X i ¼x−E½Di jRi ¼r0;X i ¼x

ed, each of which identiﬁes LATE(r, r′, x), a covariate-speciﬁc LATE for
compliers with a move of the discretized instrument from r to r′.
2.3.2. Aggregating pairwise (covariate-speciﬁc) LATEs into one effect
An efﬁcient way of obtaining an overall IV estimate that aggregates
the covariate-speciﬁc Wald estimates LATE(r,r′, x) across r –r′ pairs and
across x into one overall effect is provided by 2SLS, using group indicator
dummies for the values of Ri as instruments, fully saturating the ﬁrst and
second stage in the covariates, and interacting the instruments in the ﬁrst
stage with the covariates. As discussed in Section 2.2.2, this provides a
variance-weighted average of covariate-speciﬁc LATEs. To further see
how 2SLS using group indicator dummies aggregates the pairwise
LATEs across r-–r′ pairs, it is useful to abstract from covariates by assuming again a subsample with covariates ﬁxed at Xi =x. Fig. 3 based on simulated data, which plots E[Yi | Ri, Xi = x] against E[Di | Ri, Xi = x], helps to
illustrate how the various Wald estimators are aggregated. The 2SLS estimator can be thought of as ﬁtting a straight line through the points in
Fig. 3 using generalized least squares (GLS) estimation because grouped
data have a known heteroscedasticity structure (Angrist, 1991). The
resulting weights that each covariate-speciﬁc LATE receives are positive
and sum to one. The weights are positively related to the strength of
the ﬁrst-stage E[Di | Ri = r, Xi = x] − E[Di | Ri = r′, Xi = x] and to group size
(i.e., number of observation in each bin).16
Whereas it is fairly straightforward to describe for whom LATE with
a single binary instrument is representative (the group of compliers
with that instrument), this is no longer the case with a continuous
instrument—since the overall IV effect is now representative for compliers with changes between all values of the instrument, with different
weights attached to groups of compliers at different pairs of values. An

Fig. 2. Treatment probability in discrete bins of a continuous instrument. Notes: Based on
hypothetical data, the bins in this ﬁgure show the probability of treatment in a sample
with ﬁxed covariates (E[D = 1,R,X = x]) as a function of a discrete variable R, which has
been generated by grouping the values of the continuous instrument depicted in Fig. 1
into 20 equally spaced bins. The dotted line reproduces the function depicted in Fig. 1.
Data source: Simulated hypothetical data.

aggregate IV estimate may also hide interesting information, such as
which pairs of values of the instrument shift a particularly large group
of individuals, or a group of individuals with particularly large treatment
effects, into treatment.
2.4. Control function approach: the correlated random coefﬁcients model
An alternative to conventional linear IV estimation is to use the instrument to construct a control function, and to include this into the regression alongside the endogenous variable (see Wooldridge (2015) for
an overview of control function methods). A well-known model for
which a control function estimator has been proposed is the correlated
random coefﬁcients model (Card, 2001; Heckman and Vytlacil, 1998;
Heckman and Robb, 1985). As we explain below, the control function
estimator for this model allows estimation of the ATE and yields some
insight into the pattern of selection in the unobservables, albeit under
stronger assumption than IV estimation. Consider the outcome of
Eq. (6) in which we assume linearity in the regressors, μ0(Xi) = Xiβ0
and μ1(Xi) = Xiβ1, and for a more compact notation rewrite the equation
as
~ i θ þ Di δi þ εi ;
Y i ¼ X i α þ Di X

ð16Þ

~ i ¼ X i −X
with α = β0, θ = β1 − β0, δi = U1i − U0i, εi = U0i, and where X
denotes the covariates centered around their sample means. This is a

16
A slope estimated by ordinary least squares is equal to a weighted average of all possible combinations of pairwise slopes between any two points, with a larger weight on
OLS
slopes between points that are further apart on the horizontal axis. This is because β ̂ ¼

covðx;yÞ
varðxÞ

¼

n

n

∑i¼1 ∑ j¼1 ðyi −y j Þðxi −x j Þ
n

∑ j¼1 ðxi −x j Þ2

n

¼

n

ðy −y Þ

∑i¼1 ∑ j¼1 ðxi −x j Þðxi −x j Þ2
i

n

j

∑ j¼1 ðxi −x j Þ2

. In Fig. 3, the distance between two

points on the horizontal axis is exactly equal to the ﬁrst stage E[Di | Ri =r] −E[Di |Ri =r′]
of the associated LATE, therefore LATEs with a stronger ﬁrst stage get a higher weight. If
in addition the slope is estimated by GLS, then LATEs associated with larger groups receive
a higher weight, because GLS weights observations inversely to their variance, and the variance of groups means decreases in group size.

Fig. 3. Grouped data IV. Notes: Based on hypothetical data, the ﬁgure plots the average
outcome against the average treatment probability in a sample with ﬁxed covariates for
20 groups, which are equal to the bins depicted in Fig. 2 and correspond to 20 equally
sized bins of an underlying continuous instrument. Grouped data IV can be visualized as
ﬁtting a line through these points. Data source: Simulated hypothetical data.

T. Cornelissen et al. / Labour Economics 41 (2016) 47–60

random coefﬁcient model, in which the coefﬁcient δi varies across individuals. Decomposing δi ¼ δ þ δ~i into its mean δ ¼ E½δi  and the devia~i ¼ δi −E½δi , Eq. (16) can be transformed into a
tion from the mean δ
constant coefﬁcient model
~ i θ þ Di δ þ ei :
Y i ¼ X i α þ Di X

ð17Þ

Here, the coefﬁcient on Di is deﬁned as the ATE. Because the covariates interacted with Di are centered around their mean, δ captures
the ATE at means of Xi, which in this linear speciﬁcation is also equal
to the unconditional ATE. Deviations from the ATE enter the error
~i þ εi . If there is selection based on gains, then δ~i and Di
term ei ¼ Di δ

are positively correlated, resulting in E½Di ~δi jDi ¼ 1NE½Di δ~i jDi ¼ 0, and
hence Eq. (17) is referred to as the correlated random coefﬁcients
model. Any instrument Zi that affects Di will in this case also be correlated with the augmented error term ei. IV estimation of Eq. (17) will
therefore yield a biased estimate of δ (the ATE). This is not surprising because, as explained above, when treatment effects are heterogeneous IV
estimation does not in general identify the ATE.
In addition to the standard assumptions of independence and existence of a ﬁrst stage, assume that Di can be explained by the reducedform equation
Di ¼ X i π1 þ Z i π2 þ ν i ; with E½ν i jX i ; Z i  ¼ 0;

3. Deﬁnition of the marginal treatment effect (MTE) and its relation
to LATE
3.1. Deﬁnition
While LATE aggregates treatment effects over a certain range of the
UD distribution – see Eq. (15) – MTE is deﬁned as the treatment effect at
a particular value of UD:
MTEðX i ¼ x; UDi ¼ uD Þ ¼ EðY 1i −Y 0i jX i ¼ x; UDi ¼ uD Þ

MTEðX i ¼ x; U Di ¼ pÞ ¼

E½εi jνi  ¼ ηνi

ð19Þ

h
i
E ~
δi jνi ¼ ψν i

ð20Þ

Eq. (19) describes conventional selection bias. Because εi = U0i, the
relation between εi and νi states that individuals who are more likely
due to unobserved characteristics to take the treatment differ in their
pre-treatment characteristics from individuals who are less likely to
take the treatment. Eq. (20) describes the process of selection based
on gains and embodies the (rather strong) assumption that the unobserved part of the treatment effect depends linearly on the unobservables that affect the treatment.
As shown in Card (2001), under these assumptions, Eq. (17) can be
estimated by OLS including ν ̂i and νî Di as two additional regressors
(control functions), where ν î is obtained as the predicted residual
from Eq. (18) estimated by OLS.17 The estimate of δ is consistent for
the ATE, and the sign of the coefﬁcient on the control function ν î Di is in-

ð21Þ

It is thus the treatment effect for an individual with observed characteristics X = x who are at the uD-th quantile of the V distribution, implying these individuals are indifferent to receiving treatment when having
a propensity score P(Xi, Zi) equal to uD.
To better understand what MTEs are, abstract from covariates by
assuming that we exploit a subsample with covariates ﬁxed at Xi = x.
The MTE for UDi = P(z) is the limit of LATE in Eq. (15) for P(z′) → P(z).
The MTE at U Di = P(z) is thus, roughly, the LATE identiﬁed from a
small departure of the propensity score from value P(z) induced by
the instrument.18
In formal notation, and as shown for example in Heckman et al.
(2006) and Carneiro et al. (2011), the MTE is identiﬁed by the derivative
of the outcome with respect to the propensity score:

ð18Þ

and that both of the unobservables in ei that cause selection bias in
Eq. (17) are linearly related to the reduced-form error νi:

53

∂EðY i jX i ¼ x; P ðZ i Þ ¼ pÞ
∂p

ð22Þ

Given that the Wald estimator in Eq. (13) is also a type of derivative
of the outcome with respect to the treatment probability (it divides the
instrument induced change in the outcome by the instrument induced
change in the treatment), it may not be surprising that the MTE is identiﬁed by the derivative of the outcome with respect to the propensity
score. In the following we provide some additional intuition why the
derivative of the outcome with respect to the “observed inducement
into treatment” (the propensity score) yields the treatment effect for individuals at a given point in the distribution of the unobserved resistance
to treatment (UD). At a given propensity score p = p0, individuals with
UD b p0 are treated, while individuals with UD = p0 are indifferent. Increasing p from p0 by a small amount dp shifts previously indifferent individuals into treatment, who thus have a marginal treatment effect of
MTE(UD = p0). The associated increase in Y equals the share of shifted
individuals times their treatment effect: dY=dp* MTE(UD = p0). Dividing the change in Y by the change in p (which is, roughly speaking, what
a derivative does) thus gives the MTE: dY/dp = MTE(UD = p0). Therefore, the derivative of the outcome with respect to the propensity
score yields the MTE at UD = p.
Fig. 3 helps to interpret MTEs in an alternative way. Whereas 2SLS
based on the discretized instrument ﬁts a straight line through the
grouped values in Fig. 3 (the slope of which is the aggregate IV effect),
MTE can be thought of as using very ﬁne “bins” (all available values of
the propensity score) and allowing the slope of the curve to differ across
values of P(Z). The local slope in a point P(Z) = P(z) then gives the MTE
at UD =P(z).

formative on the selection pattern (a positive sign implying selection
based on gains). This control function approach, which can be implemented with either a binary or a continuous IV, thus yields parameters
that are usually not identiﬁed by conventional IV. However, it relies on
stronger assumptions than those needed for IV estimation, which does
not require the assumptions in Eqs. (18)–(20). Moreover, while it estimates ATE, it does not recover other treatment parameters, such as
the ATT, ATU, or PRTE. Next, we introduce the concept of marginal treatment effects (MTE) as a more informative way of exploiting a continuous instrument, which uncovers treatment effect heterogeneity more
widely than the control function estimator and allows the identiﬁcation
of a variety of treatment parameters under potentially weaker
assumptions.

Identifying the MTE across the full range of UD between 0 and 1 requires a continuous instrument (at least if one wants to identify the
MTE under minimal assumptions, as we discuss in Section 4.2 below).
The following example illustrates this. Suppose that treatment is college

17
Because of the two-step approach, standard errors need to be adjusted or
bootstrapped (Wooldridge, 2015). The approach can be modiﬁed by explicitly accounting
for the binary nature of the endogenous variable and replacing ν̂i by a generalized residual
based on the inverse Mills ratio from a probit ﬁrst stage regression (Wooldridge, 2015).

18
The effect of a marginal change of the instrument as an interesting policy parameter
was ﬁrst introduced as the “marginal gain” in Björklund and Mofﬁtt (1987). It was ﬁrst deﬁned as a limit form of LATE by Heckman (1997), and its relevance for policy evaluation is
emphasized in Heckman and Smith (1998).

3.2. Relation to LATE and the importance of a continuous instrument

54

T. Cornelissen et al. / Labour Economics 41 (2016) 47–60

attendance, and that individuals continuously differ with respect to
their unobserved resistance to college enrolment, U D. The instrument is distance to college and assume that it varies from living directly next to a college to living very far from a college. Suppose
that, as depicted in Fig. 1, when living right next to a college (distance of zero), all individuals attend college, even those with the
highest resistance (conditional on X). By contrast, when living far
away from a college, only individuals with the lowest resistance attend college (conditional on Xi). Gradually decreasing the distance
from living maximally away until living right next to a college will
then gradually shift all types into college, starting from the low-UD
types, gradually up to the high-UD types. Thus, everybody is a complier at some value of the continuous instrument. The wage gains associated with increases in the propensity score that result from the
gradual shift in the instrument are informative on the treatment effects of each of the shifted types, and thus the marginal wage increase at a given point (the derivative with respect to p) identiﬁes
the MTE for each type.
Compare this continuous instrument with a binary instrument, say
an indicator DIST for whether a college is more than 50 miles away
(DIST = 1) versus being less than 50 miles away (DIST = 0). Suppose
that conditional on X = x the probability of attending college is
P(DIST=0)=0.95 if it is less than 50 miles away and P(DIST=1)=0.5
if it is more than 50 miles away. This instrument shifts types with UD between 0.5 and 0.95 into treatment (individuals between the 50th and
95th quantile of the distribution of the unobserved resistance to treatment). The associated LATE identiﬁes thus the average over the MTE
curve between UD =0.5 and UD =0.95.
MTE is therefore deﬁned as a continuum of treatment effects along
the full distribution of UD (the individual unobserved characteristic
that drives treatment decisions). This has several advantages. First, rather than identifying one aggregate parameter that can mask important
heterogeneity in treatment effects, the researcher is able to identify
the whole (or at least a substantial part of the) range of individual treatment effects and thus characterize the extent of effect heterogeneity.
Second, the MTE can be aggregated into economically interesting treatment effects such as the ATE, ATT, and PRTE, as we show in Section 4.3.
Third, by relating the treatment effects to the decision of taking up the
treatment measured by the participation probability, the researcher
can infer the pattern of selection into treatment in a general manner
along the entire unobserved resistance distribution. Estimation of the
MTE is therefore more informative than both the conventional IV estimator and the control function estimator of the correlated random coefﬁcients model discussed in Sections 2.2 to 2.4. In the ideal case, in which
the instrument varies strongly conditional on X (see Section 4.2), it requires assumptions that are no stronger than the assumptions for conventional IV estimation.
To represent the heterogeneity in gains from treatment based on unobserved characteristics, and how it relates to the unobserved propensity to take up the treatment, one usually plots the MTE on the vertical
axis of a graph against UD on the horizontal axis, with X ﬁxed at given
values (say, at means). One important aspect in interpreting an MTE
curve is its slope, as this reveals the selection pattern in unobserved
characteristics. Recall that UD are the quantiles of the unobserved resistance for treatment. An MTE curve that falls in UD would suggest that
low-resistance types (who are more likely due to unobserved reasons
to participate in the treatment) have a higher treatment effect, and
high-resistance types have a lower treatment effect. A falling MTE
curve would thus indicate positive selection in unobserved characteristics based on gains—the pattern we typically expect. A rising MTE curve,
by contrast, indicates reverse selection on gains in unobserved characteristics, while a ﬂat MTE indicates no selection based on unobserved
gains. In general, a non-monotonic shape of the MTE curve is also possible, which would imply a changing pattern of selection across the distribution of UD. We provide examples of both a falling and a rising MTE
curve in Section 5.

U0, U1, and V being residuals, their interpretation depends on the observables that are included in the regression. Changes in the variables
included in (X, Z) redeﬁne the residuals and thus potentially change
the MTE curve. Note however that if Z contains several instruments,
then using them one at a time (conditioning on the respective other
ones) identiﬁes the same MTE curve (although it could identify different
stretches of the MTE curve depending on the range of variation that the
different instruments cause in the propensity score).
The analysis of the selection pattern in unobserved characteristics
can be complemented by checking for selection on gains (or otherwise)
in observed characteristics, simply by checking whether those characteristics that lead to a high μ1(Xi) − μ0(Xi) in the outcome equations
lead to a high μD(Xi, Zi) in the selection equation (or otherwise).
Next, we discuss the estimation of MTEs, starting with the fully parametric normal model, which is the framework in which MTE was ﬁrst
introduced by Björklund and Mofﬁtt (1987) and which relies on strong
distributional assumptions.
4. Estimation of MTE
4.1. The fully parametric normal model
The parametric normal model assumes a joint normal distribution of
the error terms U0, U1 and V of the outcome and selection equations,
(U0,U1, V) ˜ N(0, Σ), with variance–covariance matrix Σ in which the variance of V is normalized to 1. Moreover, suppose that potential outcomes and the selection equation are based on linear indices, that is
Yji = Xiβj + Uji for j=(0,1), and D⁎i =(Xi ,Zi)βd − Vi (and Xi includes a constant). These assumptions lead to a switching regime normal selection
model or Heckman selection model (Heckman, 1976). Eqs. (1)–(4)
can be estimated either jointly by maximum likelihood or following a
two-step control function procedure. The two-step procedure exploits
the fact that the confounding endogenous variation in the error terms
of the outcome equations is given by


ϕððX i ; Z i Þβd Þ
;
E½U 0i jDi ¼ 0; X i ; Z i  ¼ E½U 0i jV i ≥ ðX i ; Z i Þβd ; X i ; Z i  ¼ ρ0
1−ΦððX i ; Z i Þβd Þ
ð23Þ

E½U 1i jDi ¼ 1; X i ; Z i  ¼ E½U 1i jV i bðX i ; Z i Þβd ; X i ; Z i  ¼ ρ1


−ϕððX i ; Z i Þβd Þ
;
ΦððX i ; Z i Þβd Þ
ð24Þ

where ϕ and Φ denote the p.d.f and c.d.f. of the standard normal distribution, and ρ0 and ρ1 are the correlation coefﬁcients between U0i and Vi
and U1i and Vi, respectively. Based on an estimate for βd from a ﬁrststage probit estimation of the selection equation, one can construct
estimates of the ratios in parentheses in Eqs. (23) and (24). With
these terms added as control functions, the outcome Eqs. (1) and
(2) can be estimated by OLS. The ATE conditional on X is then given
by X i ðβ̂1 −β̂0 Þ. The coefﬁcients on the correction terms provide esti-

mates for the correlations ρ0 and ρ1. In the normal selection model,
the MTE has a parametric representation that follows directly from
the joint normal distribution:19
MTEðx; uD Þ

¼ EðY 1i −Y 0i jX i ¼ x; UDi ¼ uD Þ ¼ xðβ1 −β0 Þ þ ðρ1 −ρ0 ÞΦ−1 ðuD Þ

Not only is joint normality of (U0i, U1i, Vi) a strong assumption, it
also puts strong restrictions on the shape of the MTE curve, which
is simply equal to Φ− 1 , the inverse of the standard normal c.d.f.,
19

The joint normal distribution has the property that EU 1i jVi ¼ v ¼ μ U 1 þ σρ12 v−μ V . GivV

en that in this model μU1 = μV = 0, σ2V = 1, and v = Φ−1(uD), it follows that
E(U1i |UDi =uD)=ρ1Φ−1(uD).

T. Cornelissen et al. / Labour Economics 41 (2016) 47–60

multiplied by a constant (ρ1 − ρ0), ruling out non-monotonic shapes
of the MTE curve. If ρ1 = ρ0 , there is no selection based on unobserved gains. If ρ1 − ρ0 b 0, there is positive selection based on
gains, and if ρ1 − ρ0 N 0, there is reverse selection on gains.
While Björklund and Mofﬁtt (1987) ﬁrst pointed out that the “marginal gain” is a relevant parameter which can be derived from the
switching regime Heckman normal selection model, the subsequent literature has further clariﬁed the deﬁnition and interpretation of the MTE
and, crucially, has shown how it can be derived under much weaker
assumptions (essentially under the same assumptions as conventional
IV estimation). We now ﬁrst describe the ideal case under which the
MTE can be estimated nonparametrically under minimal assumptions
(which puts high demands on the data), and then the more realistic
case of semiparametric or parametric assumptions typically followed
in practice (which are usually still weaker than those of the normal selection model).

4.2. Minimal assumptions and nonparametric estimation (the ideal case)
In addition to the assumptions required for a causal interpretation of
the IV estimator discussed in Section 2.2, the estimation of MTE requires
in the ideal case a continuous instrument Z that has enough variation to
generate a propensity score P(Z) with full common support (i.e., that
has support in the full unit interval for both treated and untreated individuals) conditional on Xi = x. It should be noted that the “conditional
on Xi = x” means within all unique combinations of the values of the
X’s—a much stronger requirement than the mere existence of a ﬁrst
stage. Suppose that X contains two dummy variables (say, gender and
race), then Z should have strong variation within each of the four cells
deﬁned by all possible combinations of the values for gender and race.
Obviously, the more regressors are included in X and the more values
each regressor assumes, the stronger is this requirement.
The conventional estimation method to identify the MTE is the
method of local instrumental variables (LIV; see Heckman and Vytlacil,
1999, 2001b, 2005), which estimates the MTE as the derivative of the
outcome equation with respect to the propensity score, where the outcome has been modeled as a ﬂexible function of the propensity score,
thus exploiting the representation of the MTE given in Eq. (22).20
If a continuous instrument with a large range of variation within
cells of Xi = x is available, then the analysis can proceed in subsamples
deﬁned by the values of Xi = x, thus conditioning perfectly and
nonparametrically on X, and identifying a separate MTE curve for each
value of Xi = x. It should be noted that this allows identifying the MTE
in a model with outcome equations of the form Yj = μj(Xi, Uji). This
“ideal” estimation approach thus does not rely on the linear separability
assumptions embodied in Eqs. (1) and (2). Below we provide a sketch of
this estimation method:
a. Split up the sample into the cells deﬁned by Xi = x and repeat the following steps separately within each of the subsamples.
b. Within each sample, estimate the probability of being treated (the
propensity score) P(Z) as a function of the excluded instrument(s) Z.
Ideally, this might be done nonparametrically. Denote the predicted
propensity score by p̂.
c. Within each sample, model the outcome Y nonparametrically as a
ﬂexible function of p̂ (for example by local polynomial regression).
Denote the predicted outcome from this ﬂexible function as Y ̂.
d. Within each sample, obtain MTE (Xi =x,UDi =p0) as the derivative of
Y ̂ with respect to p̂, evaluated at point p0. Doing this for a grid of values

20
The two-step estimation of the normal selection model described above is an example
in which the MTE is estimated by a control function estimator, instead of the local IV estimator. For a more general comparison between local IV and the control function approach
to estimate MTE, see Heckman and Vytlacil (2007, section 4.8).

55

for p0 from 0 to 1 allows tracing out the MTE curve for the full unit
interval.21

4.3. Strengthening assumptions for estimation in less ideal cases
The approach outlined in the previous section assumes the availability of an ideal continuous instrument with sufﬁcient variation conditional on Xi = x to generate a propensity score P(Z) with full common
support conditional on Xi =x. This is rarely available, and additional assumptions need to be made. A ﬁrst assumption is to not condition on X
fully nonparametrically, but in a parametric linear way and model potential outcomes as Y0i = Xiβ0 + U0i and Y1i = Xiβ1 + U1i and the selection equation as D⁎i = (Xi , Zi)βd − Vi.
A second assumption restricts the shape of the MTE curve to be
independent of X (common across all values of X), except for the intercept of the MTE curve, which is allowed to vary with X. Independence of the shape of the MTE curve across X is implied by the full
independence assumption (X i , Zi ) ⫫ (U0i , U1i , Vi ), which is stronger
than the conditional independence assumption Zi ⫫ (U0i, U1i, Vi) | Xi
necessary for a causal interpretation of IV and the estimation of
MTE in the ideal case. Full independence implies not only that X is exogenous but also that the way in which U1 and U0 depend on V, and
therefore the shape of the MTE curve, does not depend on X.22 Alternatively, rather than invoking full independence, one can, in addition
to the conditional independence assumption, assume additive separability between an observed and an unobserved component in the
expected potential outcomes conditional on UD = uD (Brinch et al.,
forthcoming):




E Y j jX i ¼ x; UDi ¼ uD ¼ X i β j þ E U ji jUDi ;

j ¼ 0; 1

Both the full independence and the linear separability assumption
imply that the marginal treatment effect deﬁned in Eq. (21) is additively
separable into an observed and an unobserved component:23
MTEðx; uD Þ

¼ EðY 1i −Y 0i jX i ¼ x; UDi ¼ uD Þ
¼ xðβ1 −β0 Þ þ EðU 1i −U 0i jUDi ¼ uD Þ :
|ﬄﬄﬄﬄﬄﬄﬄ{zﬄﬄﬄﬄﬄﬄﬄ}
|ﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ{zﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ}
observed component

ð25Þ

unobserved component

Exploiting linearity of the outcome in X and a constant shape of the
MTE across X (except for a varying intercept) leads to the following outcome equation:
E½Y i jX i ¼ x; P ðZ Þ ¼ p ¼ X i β0 þ X i ðβ1 −β0 Þp þ K ðpÞ;

ð26Þ

where K(p) is a nonlinear function of the propensity score. The coefﬁcients on the interaction terms of Xi and p identify β1 − β0 and show
how observed characteristics shift the treatment effect (and thus the intercept of the MTE curve). The fact that K(p) does not depend on X reﬂects the assumption that the slope of the MTE curve in uD does not
depend on X. Crucially, this allows identifying K(p) across all values of
Xi = x, instead of within all values of X = x, and it therefore only requires
unconditional full common support of the propensity score (across all
values of Xi = x), an assumption which is in many applications more
21
Steps c and d of the estimation algorithm make clear why a continuous instrument
that causes variation between 0 and 1 in the propensity score within each cell of unique
values of X is required. If P(Z) does not vary between 0 and 1 in each of the cells, then
non-parametric estimation of Y as a function ofp̂ is not possible across the full unit interval,
and thus the MTE curve cannot be identiﬁed across the full unit interval (which in turn
means that aggregate treatment parameters such as the ATE cannot be calculated).
22
Full independence between (X, Z) and (U0,U1,UD) is for example invoked in Aakvik et
al., (2005), Carneiro et al. (2011) and Carneiro et al. (forthcoming).
23
The choice of the assumption affects the interpretation of the coefﬁcients and error
terms of the outcome equations. Under full independence, β1, β0, U1i, and U0i are
interpreted as structural or causal, whereas under linear separability they are interpreted
in terms of a linear projection.

56

T. Cornelissen et al. / Labour Economics 41 (2016) 47–60

realistically obtainable than full common support conditional on Xi = x.
From Eq. (22), the MTE is then given by
MTEðX i ¼ x; U Di ¼ pÞ ¼

∂E½Y i jX i ¼ x; P ðZ Þ ¼ p
∂K ðpÞ
¼ xðβ1 −β0 Þ þ
∂p
∂p

As before, estimation of the outcome equation requires a preestimated propensity score from a ﬁrst-stage estimation in order to estimate the second stage outcome equation given in (26). Estimation of
MTE then proceeds by making varying degrees of functional form assumptions on K(p). Heckman et al. (2006) propose a semiparametric
estimation method for Eq. (26). A more parametric approach is to
model K(p) as a polynomial in p, which nevertheless allows for considerably more ﬂexibility than the parametric normal model described in Section 4.1.
We provide a brief sketch of the semiparametric and parametric
polynomial approaches in Appendix B. The semiparametric, parametric
polynomial, and the normal model are all implemented in Stata by the
user-written margte command, and an accompanying Stata Journal article is available (see Brave and Walstrum, 2014). Further documentation
on estimation techniques is also available in the supplementary online
material of Heckman et al. (2006).24
4.4. Aggregating the MTE into treatment parameters
An important advantage of MTE estimation is that the MTE Eq. (21)
can be aggregated into weighted averages over X and UD to generate aggregate treatment parameters, such as ATE, TT, TUT, and PRTE, or the IV
effect associated with a given instrument. Heckman and Vytlacil (2005,
2007) present weights that aggregate the MTE curve along the UD dimension, conditional on Xi =x, which then recover aggregate treatment
parameters conditional on Xi = x. One may want to further aggregate
these conditional parameters over the appropriate distribution of X in
order to obtain unconditional aggregate treatment parameters. While
in theory UD is continuous (and the MTE weights are therefore often
presented in continuous form), an applied researcher will usually
calculate the MTE along a grid of values of UD and will therefore in
practice face a discrete distribution of UD. Here we present unconditional treatment effects computed from a discrete distribution of UD.
We present the IV weights under the assumptions that potential outcomes are linear in Xi (i.e., μ0(Xi) = Xiβ0 and μ1(Xi) = Xiβ1) and that
the MTE is linearly separable into its observed and unobserved
part, as in Eq. (25), where the unobserved part is normalized to a
mean of zero. These assumptions are in line with the applied MTE literature and the strengthened set of assumptions discussed in
Section 4.3. We denote the sample size by N, index individual observations by i, denote the propensity score by pi, and deﬁne p as the
propensity score averaged over all individuals.
An equally weighted average of the MTE over the full distribution of
X and UD yields the unconditional average treatment effect (ATE) deﬁned in Eq. (7):
ATE ¼

N
100 

1X
1 X
X ðβ −β0 Þ þ
U −U 0i jUD ¼ u =100 ;
N i¼1 i 1
100 u¼1 1i
|ﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ{zﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ}
|ﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ{zﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ}

observed component
of MTE at sample means

ð27Þ

equally weighted average over unobserved
component of MTE

which designates the expected treatment effect for an individual with
average Xs picked at random from the distribution of UD.
On the other hand, the treatment effect on the treated (TT) deﬁned in Eq. (8) is an average of the MTE over individuals, whose UD
is such that at their given values of X = x and Z = z (and thus a

24

This is available at http://jenni.uchicago.edu/underiv/.

given propensity score, pi ), they choose to take the treatment. It
can be represented by
TT ¼

N
1X
pi
X i ðβ 1 −β 0 Þ
N i¼1 p
|ﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ{zﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ}

observed component of MTE
at means of treated



100
X

P pNu =100 
E U 1 −U 0 jUD ¼ u =100
100p
u¼1
|ﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ{zﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ}

þ

weighted average over unobserved component of MTE giving
more weight to low‐UD individuals

ð28Þ
Note that the observed characteristics Xi are weighted such that observations with a higher propensity score (and thus higher treatment
probability) get a higher weight—which corresponds to using observed
means of Xi of the treated subpopulation, as implied by Eq. (8). In the
unobserved component, the weight of a given value of uD is related to
the share of observations that have a propensity score higher than uD.
Thus, low-uD individuals (with unobserved characteristics that make
them more likely to be treated) get a higher weight, and the weight depends on the distribution of the propensity score (note that while UD is
by construction uniformly distributed, the distribution of p is an empirical question).
p
1−pi
PðpNu =100 Þ
and
in
Replacing i in the observed component by
p
1−p
100p
u
Pðp≤ =100 Þ
yields the equivalent expresthe unobserved component by
100ð1−pÞ
sion for the TUT deﬁned by Eq. (9). The TUT weights the observed part of
the treatment effect more strongly for individuals with a low propensity
score (and thus low probability of treatment)—which corresponds to
using observed means of Xi of the untreated subpopulation, as implied
by Eq. (9). The TUT additionally weights the unobserved part more
strongly for individuals at the higher end of the UD distribution who
have a stronger unobserved resistance to treatment.
Denoting the average propensity score under two policies by p0 and p,
the following expression recovers the PRTE deﬁned by Eq. (10) as a
weighted difference between the ATTs under the two policies:
PRTE ¼

 0

N
pi −pi
1X
X ðβ −β0 Þ
0
N i¼1 p −p i 1



!
100 
X
 P p0 Nu =100 −P pNu =100
u
 0

þ
E U 1 −U 0 jUD ¼ =100
p −p 100
u¼1

ð29Þ

Both, observed and unobserved characteristics are weighted proportionately to the policy-induced change in the probability of being
treated for individuals with given characteristics. Individual observed
characteristics Xi are weighted proportionately to the change in the individual propensity score (pi′− pi), and each value uD of the unobserved
characteristic is weighted proportionately to the change in the probability of being treated at that value, P(p ′ N ud) − P(p N ud).
Finally, it is possible to calculate IV weights, which recover the IV
effect when using a speciﬁc instrumental variable. Denoting the IV
weights using J as an instrument conditional on X and UD by ωJIV(x, ud),
the IV effect can be expressed as
IV ¼

N
X

J
ωIV
ðxi ÞX i ðβ1 −β0 Þ

i¼1
|ﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ{zﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ}

þ

100
X

 

J u
ωIV
=100 E U 1i −U 0i jUD ¼ u =100

u¼1

observed component of MTE at means
of individuals shifted by the instrument

ð30Þ
The weights on the observed characteristics are similar to the
weights discussed in Section 2.2.2 and are proportionate to the contribution of individuals with Xi = x to the IV ﬁrst-stage covariance (see
footnote 12). The weights on the unobserved part depend on the effect
of Zi on P(Zi) at different levels of P(Zi), weighted by the distribution of
P(Zi). More detail on the estimation of these weights is provided in
Appendix C.

T. Cornelissen et al. / Labour Economics 41 (2016) 47–60

For the purpose of illustrating the application of MTE we describe
two examples from the education literature in more detail, a paper analyzing marginal returns to college education by Carneiro et al. (2011),
as well as our own work on the marginal returns to preschool education
(Cornelissen et al., 2016). The papers ﬁnd fundamentally different selection patterns.
5. Two examples from the applied literature
5.1. Example of MTE applied to returns to college education
Carneiro et al. (2011) analyze the marginal returns to college attendance for the United States, based on a sample of white males from the
NLSY aged 28–34 years in 1991. The binary treatment, Di, is deﬁned as
having ever been enrolled in college by 1991. Hence, Di = 0 for high
school dropouts and high school graduates and Di = 1 for individuals
with some college, college graduates as well as postgraduates. The outcome, Yi, is the log wage in 1991. As instrumental variables (Zi in our
above notation) that enter the selection equation but not the outcome
equation, the authors draw on four instruments, some binary and
some continuous, that have been used in previous studies on the returns
to college attendance. These are on the one hand cost-shifters (i.e., the
presence of a four-year college and average tuition fees in public
4-year colleges in the county of residence during adolescents), and on
the other hand variables capturing local labor market opportunities at
the time the education decision is taken (i.e., the local average earnings
and the local unemployment rate).25 The instrumental variables, which
each identify a different part of the MTE curve, are included simultaneously in order to get larger support in the propensity score. Carneiro
et al. (2011) further control for individual’s socio-economic background
and measures of permanent local labor market characteristics (Xi in our
notation).
In their main speciﬁcation, the authors invoke the assumption of full
independence (X, Z) ⫫ (U0, U1, V) , implying that the shape of the MTE
curve does not vary with X, and the MTE can thus be identiﬁed over
the unconditional (marginal) support of the propensity score (see
Section 4.3).26 They then estimate the MTE using the semiparametric
estimation method outlined in Appendix B.1, which allows for a
completely ﬂexible shape of the MTE curve.
Fig. 4A depicts the MTE curve x(β1 − β0) + E(U1i − U0i | UDi = uD) –
see Eq. (25) – evaluating x at mean values in the sample. The ﬁgure reveals substantial heterogeneity in the returns to college: Whereas individuals with “low resistance” to college (i.e., very low UD) enjoy returns
of 40%, individuals with “high resistance” to college (i.e., very high UD)
lose from college by 20%. This large range of heterogeneity in the treatment effect due to unobserved characteristics would not be visible if
looking only at aggregate treatment effects such as ATE. Since these
returns refer to individuals with average X, heterogeneity in returns
will be even greater when variation in X is taken into account. The
downward sloping shape of the MTE curve highlights high gains for individuals likely to enroll in college (low UD) and lower gains, or even
losses, for individuals less likely to enrol in college (high UD). Thus, individuals positively select into college based on gains, and individuals
seem to possess information about their idiosyncratic returns and are
able to make informed choices about college attendance.
In a second step, Carneiro et al. (2011) weight and aggregate the
MTEs to compute various treatment effect parameters, as described in
Section 4.4. Their preferred estimates are based on the normal selection
25
The number of IVs is further expanded by interacting these variables with an ability
measure (Armed Forces Qualiﬁcation Test—AFQT), mother’s years of schooling, and number of siblings.
26
The conditional density of the propensity score conditional on values of a linear index
in X reveals an extremely narrow support of the propensity score at each value of the index (Figure 2 in Carneiro et al., 2011), preventing estimation of MTE in the ideal case (see
Section 4.1). The unconditional (marginal) support of the propensity score, in contrast, encompasses almost the full unit interval (Figure 3 in Carneiro et al., 2011).

57

model outlined in Section 4.1, which is less ﬂexible but results in more
precise estimates similar to the ones from the semiparametric estimation method. Column (1) in Table 1 summarizes these estimates. The
average treatment effect on the treated (TT), which puts most weight
on low UD individuals, shows substantial returns to college of 14% for
the average student selecting into college. By contrast, the returns to
college for the average individual (i.e., the ATE) are only 6.7% and the
returns for the average person who does not attend college (i.e., the
TUT) are close to zero and statistically insigniﬁcant. Thus, expansion of
college to individuals who currently do not attend would not be effective. Carneiro et al. (2011) also recover the IV effect from MTE. In their
case, the IV estimate is between the ATT and the ATE, but clearly
masks important heterogeneity in returns to college.

5.2. Example of MTE applied to returns to preschool education
Cornelissen et al. (2016) analyzes heterogeneous treatment effects
of a universal child care (preschool) program aimed at 3- to 6-yearolds on children’s school readiness. They draw on administrative data
on children’s outcomes from school readiness examinations for the
full population of school entry-aged children in one large region in
Germany for the years 1994–2002. The authors exploit a reform during
the 1990s that entitled every child in Germany to a heavily subsidized
half-day child care placement from the third birthday to school entry.
This reform was enacted in response to a severe shortage of child care
slots, which rationed in particular children who wanted to enroll at
the earliest possible age (at age 3 years).27 As a result, the reform greatly
increased the share of children enrolling at the earliest possible age and
thus attending child care for at least 3 years from 41% to 67% on average
over the program rollout period. Correspondingly, the treatment, Di, is
deﬁned as attending child care for at least 3 years and referred to as
“early attendance.” Their main outcome variable, Yi, is a measure of
overall school readiness (which determines whether the child is held
back from school entry for another year). As an instrument (denoted
by Zi in our notation above), the authors use the supply of available
child care slots at the municipality-year level measured by the child
care coverage rate, a continuous variable.28 The control variables (Xi in
our above notation) include municipality and examination cohort
dummies in addition to individual characteristics such as ethnic minority status, and average socio-demographic characteristics and child care
quality indicators at municipality-year level.
Similar to the previous example, the authors also exploit the marginal support of the propensity score (rather than the support conditional
on Xi in the ideal case), but based on the linear separability assumption
described in Section 4.3, rather than the full independence assumption
invoked in Carneiro et al. (2011). Their preferred estimation method is
the parametric polynomial approach with a second order polynomial
in the propensity score (see Appendix B.2). This model restricts the
MTE curve to a straight line and thus appears equally restrictive as the
normal section model (in that it rules out a non-monotonic shape). To
rule out concerns that this restrictive choice drives their results, the authors show that their main pattern of results is robust to estimating
more ﬂexible MTE curves by using higher-order polynomials or
implementing the semiparametric estimation method.
Fig. 4B depicts the resulting linear MTE curve, evaluated at mean
values of X in the sample. In contrast to the previous example, the
MTE curve now exhibits an upward sloping shape, indicating a pattern
of reverse selection on gains. Whereas children with low resistance to
prolonged child care attendance (low UD) do not gain, improvements
in school readiness are substantial for children with a high resistance
27
Children who wanted to enter at an older age (who may already have waited on the
waiting list for one year) were generally given priority.
28
Linear and squared terms of the instrument are included, and in the main speciﬁcation
both of these terms are interacted with a quadratic in age, gender, and ethnic minority
status.

58

T. Cornelissen et al. / Labour Economics 41 (2016) 47–60

Fig. 4. MTE curves. Notes: Part A depicts the MTE curve of Carneiro et al. (2011, Figure 4) for the wage returns to college estimated by the semiparametric method (see Appendix B.1). Part B
shows the MTE curve of Cornelissen et al. (2016, Figure 4, Part A) for the returns to early child care attendance on school readiness estimated by the parametric polynomial method (see
Appendix B.2). In both ﬁgures, the 90% conﬁdence interval is based on bootstrapped standard errors.

to prolonged child care attendance (high UD). In consequence, the TUT –
which indicates that early child care attendance would boost school
readiness of children currently not enrolled in child care by 17.3 percentage points – exceeds the ATE and TT, neither of which is statistically
signiﬁcant (see column (2) of Table 1).29
As in Carneiro et al. (2011), the linear IV estimate turns out to be
similar in magnitude to ATE and masks important heterogeneity in
returns. Moreover, the linear IV effect estimated by 2SLS is very similar
to the effect obtained when applying the IV weights to the MTE curve,
which can be considered a speciﬁcation check for the functional form
of the MTE curve.30
The authors conﬁrm a pattern of reverse selection on gains also
based on observed characteristics. For example, minority children are
12 percentage points less likely to attend preschool, but their treatment
effect is about 12 percentage points higher than for majority children.31
The authors provide additional evidence that children with a high resistance to attend early child care come from disadvantaged backgrounds
and have larger treatment effects because of their worse outcome when
not enrolled in child care.
These ﬁndings have important policy implications. They ﬁrst highlight
that early child care attendance acts as an equalizer. They also imply that
policies that successfully attract children with high resistance not currently enrolled in early child care may yield large returns. Further, programs
targeted at minority and disadvantaged children are likely to be more
cost effective and beneﬁcial than universal child care programs.
6. Conclusions
Some recent surveys provide insightful discussions about MTE (e.g.,
Heckman and Vytlacil, 2007; French and Taber, 2011; Blundell and
Costa Dias, 2009), and excellent technical treatments of MTE can be
found in the papers by Heckman and Vytlacil (1999, 2001b, 2005) and
in the application of Carneiro et al. (2011). Drawing on these earlier papers, we provide an introduction to the MTE framework, developing it
29

Kline and Walters (forthcoming) uncover a pattern of reverse selection on gains for
Head Start attendance when the nontreated state is home care. Aakvik et al. (2005) ﬁnd
reverse selection on gains in the context of a Vocational Rehabilitation training program.
30
MTE curves derived under different functional form assumptions may yield different
weighted IV effects, while neither the IV weights nor the 2SLS estimator depend on the
functional form of the MTE curve. A large discrepancy between the weighted IV effect
and the 2SLS IV effect may therefore indicate a speciﬁcation error in the functional form
of the MTE curve.
31
Note, however, that because they do not assume full independence of (X, Z) and
(U0,U1,V), the partitioning of the treatment effect into the observed and unobserved components has no causal interpretation, meaning that the higher treatment effect for minority children confounds higher treatment effects that are causally due to minority status
with those that are due to unobserved characteristics correlated with minority status.

in a way that we believe is accessible to the applied economist. We
also provide a set of lecture slides to accompany this article (available
from the authors’ personal websites).
Our framework of analysis is a generalized Roy model based on the
potential outcomes framework and a latent variable discrete choice
model for selection into treatment, assuming – as typically done in empirical applications – linear separability in observables and unobservables. Within this framework, we ﬁrst deﬁne different treatment
effects of interest, such as the average treatment effect (ATE), the average treatment effect on the treated (ATT), the average treatment effect
on the untreated (ATU), and the policy-relevant treatment effect
(PRTE). Next, we review the well-known case of IV estimation with a
discrete instrument and highlight that the resulting local average treatment effect (LATE) identiﬁed by a binary instrumental variable does not
necessarily represent a treatment parameter for an economically interesting group of the population, except in some important speciﬁc cases
which we discuss. In contrast to ATE, ATT, ATU, and PRTE, which are well
deﬁned parameters that answer economic policy questions, LATE is deﬁned by the instrumental variable used.
In a next step, we turn to IV estimation with a continuous instrument and demonstrate that the 2SLS estimator may be viewed as a
weighted average of LATEs obtained from all possible pairs of values of
the continuous instrument. Not only does this estimator lack a straightforward interpretation, but it may also hide interesting information
about the pattern of treatment effect heterogeneity. We also contrast
IV estimation with a control function estimator for the correlated random coefﬁcients model, which identiﬁes a more general effect than IV
(the ATE) and reveals some information on the pattern of selection
based on unobserved gains, albeit under stronger assumptions.
Table 1
Treatment effects parameters

ATE
TT
TUT
IV

(1)

(2)

Returns to college

Returns to early child care attendance

0.067⁎ (0.038)
0.143⁎⁎⁎ (0.035)
−0.007 (0.071)
0.095⁎⁎ (0.039)

0.059 (0.072)
−0.051 (0.080)
0.173⁎⁎ (0.085)
0.065 (0.133)

Notes: The table reports the average treatment effect (ATE), the treatment effect on the
treated (TT), treatment effect on the untreated (TUT), and the IV estimate from a linear
IV speciﬁcation for the papers presented in Sections 5.1 and 5.2. Column (1) refers to
the results reported in Table 5 in Carneiro et al. (2011). Column (2) refers to the results
shown in Table 5, column (1) in Cornelissen et al. (2016). Bootstrapped standard errors
are reported in parentheses.
⁎ Statistically signiﬁcant at 0.10 level.
⁎⁎ Statistically signiﬁcant at 0.05 level.
⁎⁎⁎ Statistically signiﬁcant at 0.01 level.

T. Cornelissen et al. / Labour Economics 41 (2016) 47–60

We then discuss MTE estimation as an alternative and more informative way of exploiting a continuous instrument which, unlike IV and control function estimation, allows the identiﬁcation of a variety of treatment
parameters such as ATE, TT, TUT, and PRTE. Instead of aggregating the underlying LATEs into one overall effect, MTE estimation aims at identifying
a continuum of treatment effects along the full distribution of the individual unobserved characteristic that drives treatment decisions. We clarify
the assumptions underlying the MTE framework, distinguishing between
an ideal case, in which the data are rich enough for nonparametric estimation under a set of assumptions no stronger than the general IV assumptions, and a more realistic case in which less ideal data can be exploited
using semiparametric and parametric methods (of which we provide a
brief sketch) under strengthened assumptions. We ﬁnally illustrate how
MTE estimation is implemented in practice, and which additional insights
can be gained from MTE estimation compared to conventional 2SLS estimation, based on two examples from the applied MTE literature: the
wage returns to college attendance and on the effects of preschool attendance on school readiness.

59

support of the propensity score. If the support of the propensity score
is limited (maybe because of limited variation in the instrument), then
one possibility is to continue to use the semiparametric method, but
identify the MTE only over some sub-range of the unit interval. While
this approach reveals useful information on the treatment effects and
the selection pattern for the range in which the MTE can be identiﬁed,
it precludes calculation of aggregate treatment effects such as the ATE,
TT, and TUT, as they require aggregating over the full unit interval. Alternatively, one can take more parametric approaches described below,
based on which the MTE curve can be extrapolated out of the support
of the propensity score. More parametric approaches can also be useful
when there is full support and nonparametric and semiparametric approaches are too time-consuming or too demanding on the data (e.g.,
if results are very sensitive to small changes in the data or speciﬁcation).
B.2. Parametric polynomial estimation
The parametric polynomial MTE model replaces K(p) in Eq. (26) by a
kth-order polynomial in p, so that the outcome equation becomes:

Appendix A. Policy-relevant treatment effects
The policy-relevant treatment effect conditional on Xi, PRTE(x), is the
mean effect of going from a baseline policy to an alternative policy per
net person shifted:
PRTEx ¼

E½Y i jX i ¼ x;
E½Di jX i ¼ x;

alternative policy−E½Y i jX i ¼ x;
alternative policy−E½Di jX i ¼ x;

baseline policy
baseline policy

¼

E½Y 0i þ Y 1i −Y 0i D i jX i ¼ x−E½Y 0i þ Y 1i −Y 0i Di jX 1 ¼ x
E½D i jX i ¼ x−E½Di jX i ¼ x

¼

E½Y 1i −Y 0i jX i ¼ x; D i ¼ 1E½D i jX i ¼ x−E½Y 1i −Y 0i jX i ¼ x; Di ¼ 1E½Di jX i ¼ x
E½D i jX i ¼ x−E½Di jX i ¼ x

¼ μ 1 ðxÞ−μ 0 ðxÞ
þ

E½U 1i −U 0i jX i ¼ x; D i ¼ 1E½D i jX i ¼ x−E½U 1i −U 0i jX i ¼ x; Di ¼ 1E½Di jX i ¼ x
E½D i jX i ¼ x−E½Di jX i ¼ x

The corresponding unconditional effect is
PRTE ¼
¼

E½Y 1i −Y 0i jD 1 ¼ 1E½D i −E½Y 1i −Y 0i jDi ¼ 1E½Di 
E½D i −E½Di 
E½μ 1 ðX i Þ−μ 0 ðX i ÞjD i ¼ 1E½D i −E½μ 1 ðX i Þ−μ 0 ðX i ÞjDi ¼ 1E½Di 
E½D i −E½Di 
E½U 1i −U 0i jD i ¼ 1E½D i −E½U 1i −U 0i jDi ¼ 1E½Di 
þ
E½D i −E½Di 

Appendix B. Sketch of common estimation methods for the MTE
B.1. Semiparametric estimation
A semiparametric version of estimating (26) consists in the following steps (see for example Appendix B of Heckman et al., 2006, for a
more detailed description):
a. Purging X and Xp from the effect of KðpÞ by regressing each of them in
turn on p using local polynomial regression (or a parametric polynomial in p), and predicting the residuals.
b. Regressing Y on the residualized version of X and Xp obtained under
a. using a linear regression, and predicting the residual.
c. Regressing the residualized version of Y obtained under b. on p by
local polynomial regression to identify KðpÞ.
d. Obtaining the MTE curve as the derivative of KðpÞ.
Note that in order to identify K(p) over the full unit interval by this
semiparametric method, one still needs full common unconditional

K

Y ¼ Xβ0 þ X ðβ1 −β0 Þp þ ∑ α k pk þ υ;
k¼2

and as before the MTE curve is the derivative of this equation with respect to p. The higher the degree of the polynomial, the more ﬂexible
the MTE curve is estimated. For example, choosing a second order polynomial (K = 2) restricts the MTE curve to be linear, which may hide
more ﬂexible patterns, such as a U-shape in the MTE curve. However,
strong parametric assumptions are powerful. As shown by Brinch et
al. (forthcoming), a linear MTE curve can be identiﬁed with a dummy
variable instrument (albeit with an alternative estimation method to
the conventional LIV method).
Appendix C. Computation of IV weights in the linear separable
model
ωJIV(xi) in Eq. (30) represent the IV weights conditional on X after inJ u
ð =100 Þ represent the IV weights conditional on
tegrating out UD, and ωIV
UD after integrating out X. We propose the following estimation
approach:

1. Running the 2SLS ﬁrst-stage regression of the treatment Di on the covariates Xi and the vector of excluded instruments Ji and predicting Di
from this regression.
2. Regressing Di on the covariates Xi and predicting the residual ϑ from
this regression. ϑ aggregates the excluded instruments into one scalar instrument that is orthogonal to the covariates Xi. The bivariate IV
CovðY;ϑÞ
, using ϑ as a single instrument, reproduces the
estimator aIV ¼ CovðD;ϑÞ
exact same IV estimate as a 2SLS second stage regression of Y on Di
and Xi.
1 ðD −DÞðϑ −ϑÞ
J
i
ðxi Þ ¼ N iCovðD;ϑÞ
, the weight given by each individ3. Computing ωIV
ual’s contribution to the ﬁrst-stage covariance CovðD; ϑÞ divided by
this covariance [rationalized by assuming that Yi = a + biDi and noting that in this case, because Eðϑ i Þ ¼ 0, CovðY i ; ϑ i Þ ¼ Covðbi Di ; ϑi Þ ¼
Eðbi Di ϑ i Þ, soCovðY i ; ϑ i Þ ¼ N1 ∑ bi Di ϑi. Similarly, CovðDi ; ϑi Þ ¼ N1 ∑ Di
Dϑ
CovðY i ;ϑii Þ
i
ϑi , meaning that aIV ¼ CovðD
¼ N1 ∑ bi 1 i i and bi is weighted
i ;ϑ i Þ
∑
Di ϑ i
i
N
by each individual’s contribution to the ﬁrst-stage
covariance.]
i
J u
1
ð =100 Þ
as the sample analog of
4. Computing
ωIV
100
u
u
½Eðϑjpi N =100 Þ−Eðϑi ÞPðpi N =100 Þ
(see, e.g., Eq. (19) and Appendix B.3 in
CovðD;ϑÞ
Heckman et al., 2006).
References
Aakvik, A., Heckman, J.J., Vytlacil, E.J., 2005. Estimating treatment effects for discrete outcomes when responses to treatment vary: an application to Norwegian vocational rehabilitation programs. J. Econ. 125 (1–2), 15–51.

60

T. Cornelissen et al. / Labour Economics 41 (2016) 47–60

Angrist, J.D., 1990. Lifetime earnings and the Vietnam Era draft lottery: evidence from social security administrative records. Am. Econ. Rev. 80 (3), 313–336.
Angrist, J.D., 1991. Grouped-data estimation and testing in simple labor-supply models.
J. Econ. 47 (2–3), 243–266.
Angrist, J.D., Imbens, G.W., 1995. Two-stage least squares estimation of average causal effects in models with variable treatment intensity. J. Am. Stat. Assoc. 90 (430),
431–442.
Angrist, J.D., Pischke, J.-S., 2009. Mostly harmless econometrics: an empiricist’s companion. Princeton University Press, Princeton.
Angrist, J.D., Imbens, G.W., Rubin, D.B., 1996. Identiﬁcation of causal effects using instrumental variables. J. Am. Stat. Assoc. 91 (434), 444–455.
Balfe, Cathy. 2015. “Heterogeneity, Selection and Advantage in the Graduate and NonGraduate Labour Market.” Unpublished Manuscript, University College London.
Basu, A., Heckman, J.J., Navarro-Lozano, S., Urzúa, S., 2007. Use of instrumental variables in
the presence of heterogeneity and self-selection: an application to treatments of
breast cancer patients. Health Econ. 16 (11), 1133–1157.
Basu, A., Jones, A.M., Rosa Dias, P., 2014. The roles of cognitive and non-cognitive skills in
moderating the effects of mixed-ability schools on long-term health. NBER Working
Paper 20811. National Bureau of Economic Research.
Björklund, A., Mofﬁtt, R., 1987. The estimation of wage gains and welfare gains in selfselection models. Rev. Econ. Stat. 69 (1), 42–49.
Blundell, R., Costa Dias, M., 2009. Alternative approaches to evaluation in empirical microeconomics. J. Hum. Resour. 44 (3), 565–640.
Brave, S., Walstrum, T., 2014. Estimating marginal treatment effects using parametric and
semiparametric methods. Stata J. 14 (1), 191–217.
Brinch, C.N., Mogstad, M., Wiswall, M., 2016. Beyond LATE with a discrete instrument.
J. Polit. Econ. (forthcoming).
Card, D., 2001. Estimating the return to schooling: progress on some persistent econometric problems. Econometrica 69 (5), 1127–1160.
Carneiro, P., Heckman, J.J., Vytlacil, E.J., 2011. Estimating marginal returns to education.
Am. Econ. Rev. 101 (6), 2754–2781.
Carneiro, P., Lokshin, M., Ridao-Cano, C., Umapathi, N., 2016. Average and marginal
returns to upper secondary schooling in Indonesia. J. Appl. Econ. (http://
onlinelibrary.wiley.com/doi/10.1002/jae.2523/abstract, forthcoming).
Chetty, R., Hendren, N., Katz, L.F., 2016. The effects of exposure to better neighborhoods
on children: new evidence from the moving to opportunity experiment. Am. Econ.
Rev. 106 (4), 855–902.
Cornelissen, Thomas, Christian Dustmann, Anna Raute, and Uta Schönberg. 2016. “Who
Beneﬁts from Universal Childcare? Estimating Marginal Returns to Early Childcare
Attendance.” Unpublished Manuscript, University College London.
Deaton, A.S., 2009. Instruments of development: randomization in the tropics, and the
search for the elusive keys to economic development. NBER Working Paper 14690.
National Bureau of Economic Research.
Doyle, J.J., 2007. Child protection and child outcomes: measuring the effects of foster care.
Am. Econ. Rev. 97 (5), 1583–1610.
Eisenhauer, P., Heckman, J.J., Vytlacil, E., 2015. The generalized Roy model and the costbeneﬁt analysis of social programs. J. Polit. Econ. 123 (2), 413–443.
Felfe, Christina, and Rafael Lalive. 2015. “Does Early Child Care Affect Children’s Development” Unpublished Manuscript.
French, E., Song, J., 2014. The effect of disability insurance receipt on labor supply. Am.
Econ. J. Econ. Pol. 6 (2), 291–337.
French, E., Taber, C., 2011. Identiﬁcation of models of the labor market. In: Ashenfelter, O.,
Card, D. (Eds.), Chap. 6 in Handbook of Labor Economics 4, Part A. Elsevier, Amsterdam,
pp. 537–617.
Heckman, J.J., 1976. The common structure of statistical models of truncation, sample selection and limited dependent variables and a simple estimator for such models. Ann.
Econ. Soc. Meas. 5 (4), 475–492.
Heckman, J.J., 1997. Instrumental variables: a study of implicit behavioral assumptions
used in making program evaluations. J. Hum. Resour. 32 (3), 441–462.
Heckman, J.J., Robb, R., 1985. Alternative methods for evaluating the impact of interventions. J. Econ. 30 (1), 239–267.

Heckman, J.J., Smith, J., 1998. Evaluating the Welfare State. Econometrics and Economic
Theory in the 20th Century: The Ragnar Frisch Centennial Symposium, no. 31. Cambridge University Press, Cambridge, p. 241.
Heckman, J.J., Urzúa, S., 2010. Comparing IV with structural models: what simple IV can
and cannot identify. J. Econ. 156 (1), 27–37.
Heckman, J.J., Vytlacil, E., 1998. Instrumental variables methods for the correlated random
coefﬁcient model: estimating the average rate of return to schooling when the return
is correlated with schooling. J. Hum. Resour. 33 (4), 974–987.
Heckman, J.J., Vytlacil, E., 1999. Local instrumental variables and latent variable models for
identifying and bounding treatment effects. Proc. Natl. Acad. Sci. 96 (8), 4730–4734.
Heckman, J.J., Vytlacil, E., 2001a. Policy-relevant treatment effects. Am. Econ. Rev. 91 (2),
107–111.
Heckman, J.J., Vytlacil, E., 2001b. Local instrumental variables. In: Hsiao, C., Morimune, K.,
Powell, J. (Eds.), Nonlinear Statistical Modeling: Essays in Honor of Takeshi Amemiya.
Cambridge University Press, Cambridge.
Heckman, J.J., Vytlacil, E., 2005. Structural equations, treatment effects, and econometric
policy evaluation. Econometrica 73 (3), 669–738.
Heckman, J.J., Vytlacil, E., 2007. Econometric evaluation of social programs, part II: using
the marginal treatment effect to organize alternative econometric estimators to evaluate social programs, and to forecast their effects in new environments. In: Heckman,
J.J., Leamer, E.E. (Eds.), Chap. 71 in Handbook of Econometrics. Elsevier, Amsterdam.
Heckman, J.J., LaLonde, R.J., Smith, J.A., 1999. The economics and econometrics of active
labor market programs. In: Ashenfelter, O., Card, D. (Eds.), Chap. 31 in Handbook of
Labor Economics vol. 3, Part A. Elsevier, Amsterdam, pp. 1865–2097.
Heckman, J.J., Urzúa, S., Vytlacil, E., 2006. Understanding instrumental variables in models
with essential heterogeneity. Rev. Econ. Stat. 88 (3), 389–432.
Holland, P.W., 1986. Statistics and causal inference. J. Am. Stat. Assoc. 81 (396), 945–960.
Imbens, G.W., Angrist, J.D., 1994. Identiﬁcation and estimation of local average treatment
effects. Econometrica 62 (2), 467–475.
Joensen, J.S., Nielsen, H.S., 2016. Mathematics and gender: heterogeneity in causes and
consequences. Econ. J. 126 (593), 1129–1163.
Johnston, J., 1963. Econometric Methods. McGraw-Hill, New York.
Kamhöfer, D.A., Schmitz, H., Westphal, M., 2015. Heterogeneity in marginal nonmonetary returns to higher education. Ruhr Economic Papers 591. RWI.
Kaufmann, K.M., 2014. Understanding the income gradient in college attendance in
Mexico: the role of heterogeneity in expected returns. Quant. Econ. 5 (3), 583–630.
Kline, P., Walters, C., 2016. Evaluating public programs with close substitutes: the case of
Head Start. Q. J. Econ. (forthcoming).
Lee, L.-F., 1979. Identiﬁcation and estimation in binary choice models with limited (censored) dependent variables. Econometrica 47 (4), 977–996.
Maddala, G.S., 1992. Introduction to Econometrics. second ed Macmillan Publishing Company, New York.
Maestas, N., Mullen, K.J., Strand, A., 2013. Does disability insurance receipt discourage
work? Using examiner assignment to estimate causal effects of SSDI receipt. Am.
Econ. Rev. 103 (5), 1797–1829.
Noboa-Hidalgo, G.E., Urzúa, S.S., 2012. The effects of participation in public child care centers: evidence from Chile. J. Hum. Cap. 6 (1), 1–34.
Nybom, M., 2014. The Distribution of Lifetime Earnings Returns to College. Working Paper
2/2014. Swedish Institute for Social Research, Stockholm University.
Oreopoulos, P., 2006. Estimating average and local average treatment effects of education
when compulsory schooling laws really matter. Am. Econ. Rev. 96 (1), 152–175.
Quandt, R.E., 1972. A new approach to estimating switching regressions. J. Am. Stat. Assoc.
67 (338), 306–310.
Rubin, D.B., 1974. Estimating causal effects of treatments in randomized and
nonrandomized studies. J. Educ. Psychol. 66 (5), 688–701.
Wooldridge, J.M., 2015. Control function methods in applied econometrics. J. Hum.
Resour. 50 (2), 420–445.

