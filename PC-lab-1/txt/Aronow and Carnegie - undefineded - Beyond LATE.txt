Downloaded from https://www.cambridge.org/core. Harvard-Smithsonian Centerfor Astrophysics, on 26 Nov 2019 at 19:39:17, subject to the Cambridge Core terms of use, available at https://www.cambridge.org/core/terms. https://doi.org/10.1093/pan/mpt013

Advance Access publication August 20, 2013

Political Analysis (2013) 21:492–506
doi:10.1093/pan/mpt013

Beyond LATE: Estimation of the Average Treatment Effect
with an Instrumental Variable
Peter M. Aronow
Department of Political Science, Yale University, New Haven, CT 06520
e-mail: peter.aronow@yale.edu (corresponding author)
Allison Carnegie
Department of Political Science, Princeton University, Princeton, NJ 08540, and
Department of Political Science, University of Chicago, Chicago, IL 60637
e-mail: acarnegie@uchicago.edu
Edited by Jonathan Katz

Political scientists frequently use instrumental variables (IV) estimation to estimate the causal effect of an endogenous treatment variable. However, when the treatment effect is heterogeneous, this estimation strategy
only recovers the local average treatment effect (LATE). The LATE is an average treatment effect (ATE) for a
subset of the population: units that receive treatment if and only if they are induced by an exogenous IV.
However, researchers may instead be interested in the ATE for the entire population of interest. In this
article, we develop a simple reweighting method for estimating the ATE, shedding light on the identification
challenge posed in moving from the LATE to the ATE. We apply our method to two published experiments in
political science in which we demonstrate that the LATE has the potential to substantively differ from the ATE.

1

Introduction

Instrumental variables (IV) estimation, although commonly used in political science, is subject to
an often overlooked limitation. IV estimation (Wald 1940) allows researchers to estimate the causal
eﬀect of an endogenous treatment variable through the use of an exogenous variable known as an
IV. However, although many researchers intend to estimate the average treatment eﬀect (ATE) for
the entire population of interest, IV estimation only recovers the local average treatment eﬀect
(LATE) or the ATE for the subpopulation that is inﬂuenced by the IV. When treatment eﬀects are
heterogeneous across units, the LATE and the ATE may take on diﬀerent values—potentially
causing complications in interpretation.
Several inﬂuential papers, including Deaton (2009) and Heckman and Urzua (2010), have expressed concern about the interpretation of the LATE. Both papers argue that the LATE is not
usually the parameter of interest, as “we are unlikely to learn much about the process at work” by
estimating the LATE (Deaton 2009, 430) and the LATE “is often very diﬃcult to interpret as an
answer to an interesting economic question” (Heckman and Urzua 2010, 35). Heckman and Urzua
(2010, 35) add that reliance on IV estimation often means that “problems of identiﬁcation and
interpretation are swept under the rug.” Even Imbens (2009, 403), who advocates the use of IV

Authors’ note: The replication archive for this article is available online at Aronow and Carnegie (2013). The authors
acknowledge support from the Yale University Faculty of Arts and Sciences High-Performance Computing facility and
staﬀ. Helpful comments from Jake Bowers, John Bullock, Dan Butler, Lara Chausow, Adam Dynes, Ivan Fernandez-Val,
Adam Glynn, Holger Kern, Malte Lierl, Mary McGrath, Joel Middleton, Cyrus Samii, two anonymous reviewers, and
the participants of the Yale American Politics and Public Policy Workshop, the New Faces in Political Methodology
Conference, and the Midwest Political Science Association Conference are greatly appreciated. We also thank Jonathan
Katz for helpful editorial guidance. Special thanks to Bethany Albertson, Adria Lawrence, and David Nickerson for
generous data sharing and to Dean Eckles, Alan Gerber, Don Green, Greg Huber, and Ken Scheve for particularly
helpful conversations. All remaining errors are our own. Supplementary materials for this article are available on the
Political Analysis Web site.
ß The Author 2013. Published by Oxford University Press on behalf of the Society for Political Methodology.
All rights reserved. For Permissions, please email: journals.permissions@oup.com

492

Downloaded from https://www.cambridge.org/core. Harvard-Smithsonian Centerfor Astrophysics, on 26 Nov 2019 at 19:39:17, subject to the Cambridge Core terms of use, available at https://www.cambridge.org/core/terms. https://doi.org/10.1093/pan/mpt013

Beyond LATE

493

estimation, admits that “in many cases the local average treatment eﬀects . . . are not the average
eﬀects that researchers set out to estimate.” Although the authors disagree on the utility of IV
estimation, they seem to largely agree on the limitations of the LATE.
The goal of this article is not to dissuade researchers from using IV estimation, particularly for
experimental analysis. When properly used and interpreted, IV estimation is a valuable tool, as it
allows researchers to overcome common problems of selection bias and unobserved heterogeneity
to consistently estimate an internally valid causal quantity for a subset of the population. But it is
nevertheless important for researchers to recognize the distinction between the LATE and the ATE.
Interpretation of the LATE as a causal quantity of interest is a concern for any researcher who
contends with noncompliance, but one that is rarely addressed in applied work in political science.
In fact, in a review of thirty-four empirical articles that employ IV estimation from 2004 to 2009 in
the American Political Science Review and the American Journal of Political Science, only two (6%)
mention that the causal eﬀect being estimated is the LATE.
So what should applied researchers do when a valid instrument is available and the ATE is the
causal quantity of interest? This article articulates a set of assumptions suﬃcient for moving beyond
the LATE to the ATE, and proposes a simple and intuitive reweighting method for operationalizing
these assumptions. The method leverages the random assignment of the instrument to achieve a
consistent estimator of the ATE for compliers, and then reweights the population so that the
compliers have a covariate distribution that matches that of the full population. Consistency for
the ATE will follow from nonexperimental assumptions (e.g., ignorability); however, unlike purely
observational methods, consistency for an average causal eﬀect—for some subpopulation—is
preserved under misspeciﬁcation. The logic of the method sheds light on the connection between
the LATE and ATE and the steps necessary to move from the former to the latter.
The article proceeds as follows. We begin by reviewing the assumptions and limitations of IV
estimation, ﬁrst from a structural equation modeling (SEM) perspective and then using the more
ﬂexible potential outcomes interpretation (Angrist, Imbens, and Rubin 1996). We next explain our
method for estimating the ATE. We provide a maximum likelihood (ML) estimator to estimate
each unit’s compliance score, or conditional probability of being a complier given covariates. We
show researchers how to use the estimated compliance scores to reweight the sample using a
method that we refer to as inverse compliance score weighting (ICSW), which is analogous to
inverse probability weighting (IPW) for sample correction. We propose suﬃcient conditions for
consistency and detail the consequences of assumption failure. We then apply the method to two
published papers in political science and ﬁnd the potential for substantively meaningful diﬀerences
between the LATE and ATE.
2

IV Estimation

Political scientists frequently contend with problems of endogeneity, which occur when a variable
of interest is systematically related to unobserved causes of the outcome variable. Endogeneity can
arise for a variety of reasons, including selection bias, simultaneity, or measurement error. A
popular method for dealing with endogeneity is IV estimation, which can be understood through
two frameworks: the SEM framework and the potential outcomes framework. The SEM framework is most familiar to political scientists, and so we begin with it. However, IV estimation in the
context of this framework introduces the rigid—and perhaps implausible—assumption of constant
treatment eﬀects. The potential outcomes model relaxes this assumption, but also changes the
causal estimand.
2.1

IV in an SEM Framework

The SEM interpretation of IV estimation posits a linear, additive relationship between an outcome
variable ðYi Þ, an endogenous treatment variable ðDi Þ, covariates ðQ1i , Q2i ::::QKi Þ, and an unobserved
error term ðui Þ for each unit i, such that
Yi ¼ 0 þ 1 Di þ 1 Q1i þ 2 Q2i þ :::: þ K QKi þ ui :

ð1Þ

Downloaded from https://www.cambridge.org/core. Harvard-Smithsonian Centerfor Astrophysics, on 26 Nov 2019 at 19:39:17, subject to the Cambridge Core terms of use, available at https://www.cambridge.org/core/terms. https://doi.org/10.1093/pan/mpt013

494

Peter M. Aronow and Allison Carnegie

We are able to consistently estimate 1 using ordinary least squares (OLS) regression when Di is
asymptotically uncorrelated with the error term (1n Di ui !p 0). This requirement is violated,
however, when Di is endogenous.
A solution to the endogeneity problem is to ﬁnd an instrument Zi that is only predictive of Yi
through its impact on Di. In other words, Zi aﬀects Di, but is excluded from equation (1). We can
then use IV regression, which is based on a two-equation model. The ﬁrst equation, or the “ﬁrst
stage,” is a regression of the endogenous variable on the instrument and covariates:
Di ¼ 0 þ 1 Zi þ 1 Q1i þ 2 Q2i þ :::: þ K QKi þ ei ,

ð2Þ

where ei is a second unobserved error term. The coeﬃcients from this ﬁrst-stage regression generate
predicted values of Di, purging Di of endogeneity. We can substitute the predicted values of Di back
into equation (1), regressing Yi on the predicted values of Di as well as the covariates. This twostage substitution process is what gives the regression the name two-stage least squares (2SLS).
Given the model in equations (1) and (2), the SEM IV framework relies on two main assumptions
for consistency. First, the correlation between Zi and ui must approach zero as n grows. Second, the
covariance between Zi and Di must converge to a nonzero quantity as n grows.
Note, however, that whereas the endogenous variable and covariates in equation (1) are indexed
by the subscript i, their coeﬃcients (the bs and s) are not. In other words, the SEM framework
assumes constant treatment eﬀects, so that the eﬀect of the treatment is identical for each unit i. The
constant eﬀects assumption is strong and may not always be justiﬁable in social science applications. For example, consider the implications of the constant eﬀects assumption in the context of an
experiment designed to assess the eﬀects of negative campaign advertising on political attitudes
(Arceneaux and Nickerson 2010). Constant eﬀects implies that a negative advertisement aﬀects
attitudes for all subjects, from those who have strong prior political opinions to those who are
indiﬀerent, by exactly the same amount.1 We can avoid making the constant treatment eﬀects
assumption using the potential outcomes framework developed by Angrist, Imbens, and Rubin
(1996), which shows that the IV estimator will identify the LATE even when treatment eﬀects are
heterogeneous. In the following section, we introduce the potential outcomes notation and discuss
the implications of identifying the LATE.

2.2

IV in a Potential Outcomes Framework

We now move to the Neyman-Rubin potential outcomes framework, focusing on the case of a
binary IV (or treatment assignment) Z and a binary endogenous treatment variable (or treatment
received) D. Suppose that we have a sample consisting of n units (indexed i ¼ 1, 2, . . . , n) independently drawn with equal probability from some large population of interest. For unit i, let Y0i be
the outcome if untreated, Di ¼ 0, and let Y1i be the outcome if treated, Di ¼ 1. The treatment eﬀect
for a given unit i is the diﬀerence between unit i’s outcomes in both possible states of the world,
Y1i  Y0i . Similarly, we may deﬁne D0i as the treatment condition of unit i when assigned to
control, Zi ¼ 0, and D1i as the treatment condition of unit i when assigned to treatment, Zi ¼ 1.
We will show that the causal estimand recovered by IV estimation will not generally be the ATE,
EðY1  Y0 Þ, but will instead be the LATE, EðY1  Y0 jD1 > D0 Þ.
Following Angrist, Imbens, and Rubin (1996), the population may be divided into four groups:
always-takers, never-takers, compliers, and deﬁers. Always-takers are units that receive treatment
regardless of whether they are assigned to treatment or control, so that D0i ¼ 1 and D1i ¼ 1.
Conversely, never-takers do not receive treatment regardless of their treatment assignment, so
that D0i ¼ 0 and D1i ¼ 0. Compliers receive treatment if assigned to treatment and do not
receive treatment if assigned to control, so that D0i ¼ 0 and D1i ¼ 1 (or D1i > D0i ). Deﬁers
1

Other examples include: Hidalgo et al. (2010) show that the effects of economic shocks on conflict are larger in regions
with high levels of preexisting inequality; Altonji and Dunn (1996) demonstrate that the returns to education are larger
for students in high-quality schools; Arceneaux and Nickerson (2009) find that the mobilizing effects of canvassing are
larger for high-propensity voters.

Downloaded from https://www.cambridge.org/core. Harvard-Smithsonian Centerfor Astrophysics, on 26 Nov 2019 at 19:39:17, subject to the Cambridge Core terms of use, available at https://www.cambridge.org/core/terms. https://doi.org/10.1093/pan/mpt013

495

Beyond LATE

receive treatment if assigned to control and do not receive treatment if assigned to treatment, so
that D0i ¼ 1 and D1i ¼ 0 (or D0i > D1i ). In the example of a randomized clinical trial to assess the
causal eﬀect of taking a medication, always-takers will take the medication regardless of which
group they are assigned to, never-takers will not take the medication regardless of which group they
are assigned to, compliers will take the medication if and only if assigned to the treatment group,
and deﬁers will take the medication if and only if assigned to the control group.
Using an IV estimator, we may estimate the LATE using ﬁve assumptions, as explicated by
Angrist, Imbens, and Rubin (1996). First, we assume that the exclusion restriction is valid, or that
Zi only aﬀects Yi through Di. Second, we assume that Zi to some degree predicts Di. Third, we
invoke the stable unit treatment value assumption, which states that the potential outcomes
D0i , D1i , Y0i , and Y1i are ﬁxed and unrelated to the particular arrangement of assignment and
treatment statuses. Fourth, we assume that the population contains no deﬁers, i.e.,
PrðD0 > D1 Þ ¼ 0. Fifth, we assume that Zi is randomly assigned and thus independent of all potential outcomes. As no parametric assumptions are necessary, these assumptions are considerably
weaker than (and subsumed by) those of the SEM framework.
Angrist, Imbens, and Rubin (1996) demonstrate that these ﬁve assumptions imply that
the “intention-to-treat” eﬀect of Zi on Yi (the average eﬀect of treatment assignment on the
outcome) divided by the intention-to-treat (ITT) eﬀect of Z on D (the average eﬀect of treatment
assignment on treatment received) is equal to the average causal treatment eﬀect for compliers:
EðY1  Y0 jD1 > D0 Þ ¼

EðYjZ ¼ 1Þ  EðYjZ ¼ 0Þ
:
EðDjZ ¼ 1Þ  EðDjZ ¼ 0Þ

The LATE, EðY1  Y0 jD1 > D0 Þ, can therefore be estimated with

P
. P
 P
. P
n
n
n
n
Zi Yi
Zi 
ð1  Zi ÞYi
ð1  Zi Þ
i¼1
i¼1
i¼1
^LATE ¼  i¼1

. P
 P
. P
n
n
n
n
P
Zi Di
Zi 
ð1  Zi ÞDi
ð1  Zi Þ
i¼1

i¼1

i¼1

ð3Þ

ð4Þ

i¼1

or, equivalently, the bivariate 2SLS estimator. This estimator is consistent but not unbiased; it is
subject to ﬁnite sample bias because it is a ratio estimator. When Zi is randomly assigned (and
therefore unrelated to covariates), the addition of covariates to the 2SLS model will also yield
consistent estimation of the LATE (Angrist and Pischke 2009).2 Intuitively, 2SLS rescales the ITT
eﬀect of Zi on Yi, acknowledging that only compliers will respond to changes in Zi.
Because IV estimation provides asymptotically unbiased estimates of the LATE even when
treatment eﬀects are heterogeneous, IV estimation has become the de facto standard for causal
inference in studies with noncompliance in the social sciences. However, as discussed in Section 1,
researchers are often interested in the ATE rather than the LATE. In the next section, we present a
method that allows for estimation of the ATE, albeit with a stronger set of assumptions for
consistency.
3

From LATE to ATE

Although the LATE is a well-deﬁned estimand, it is nevertheless only applicable to a particular
subpopulation: compliers. To address this problem, we provide a method to estimate the ATE
using the intuition behind IPW, a commonly used method to estimate population-level quantities
from nonrepresentative samples. IPW entails weighting units by the inverse of the probability of
sample inclusion (Horvitz and Thompson 1952) to asymptotically recover the population
quantities. ICSW follows the same logic, but weights units by the inverse of the compliance
2

We provide a simple intuition for why, under random assignment of Zi, 2SLS with covariates is consistent for the
LATE. The least squares regression of Yi on Zi and covariates is consistent for the numerator of equation (3), and the
least squares regression of Di on Zi and covariates is consistent for the denominator of equation (3). The 2SLS
estimator of the effect of Di will be the ratio of the two least squares estimators and, by Slutsky’s theorem, will be
consistent for the LATE.

Downloaded from https://www.cambridge.org/core. Harvard-Smithsonian Centerfor Astrophysics, on 26 Nov 2019 at 19:39:17, subject to the Cambridge Core terms of use, available at https://www.cambridge.org/core/terms. https://doi.org/10.1093/pan/mpt013

496

Peter M. Aronow and Allison Carnegie

score, or the conditional probability of being a complier. We next introduce the compliance score
and present a new ML estimator to estimate compliance scores even in the presence of two-sided
noncompliance (wherein both always-takers and never-takers are present).

3.1

The Compliance Score

The compliance score is a latent pretreatment covariate that represents the probability of being a
complier, conditional on a unit’s pretreatment covariate proﬁle X (so that X?
?Z). The compliance
score for unit i, PCi ¼ PrðD1 > D0 jX ¼ xi Þ, where xi is the covariate vector for unit i. Although we
cannot directly observe each unit’s compliance score, each unit’s score can be estimated from the
data. Consider a randomized experiment in which only one covariate, gender, is available. If we
estimate that 75% of the men in the sample are compliers (by estimating the ITT eﬀect of Zi on Di
for men), we would estimate that PCi ¼ 0:75 for all men. Indeed, when there is a small number of
unique covariate proﬁles (e.g., a small number of binary covariates), we could consistently estimate
PCi for each unique covariate proﬁle simply by estimating the conditional ITT eﬀects of Zi on Di.
However, when multiple and/or continuous covariates are available, it is useful to put additional
structure on the problem to permit estimation.
Given the assumptions outlined in the previous section, we know that the compliance score, as a
pretreatment covariate, is independent of Z. The compliance score for a given unit is thus simple to
estimate under one-sided noncompliance (when no units assigned to control will ever receive treatment), as EðD1 jZ ¼ 1, X ¼ xÞ  EðD0 jZ ¼ 0, X ¼ xÞ ¼ EðDjZ ¼ 1, X ¼ xÞ. When there are no
always-takers or deﬁers, all units assigned to treatment who take the treatment are compliers.
Therefore, for all units in the treatment group, we could run a binomial regression of D on X to
estimate the predicted probabilities of compliance.
We present a new ML estimation technique (similar to that of Yau and Little 2001) that generalizes existing methods of compliance score estimation to the case of two-sided noncompliance.
We have not seen an estimator of this form in the literature, as we propose a nested structure for
compliance that nevertheless reduces to a binomial ML under one-sided noncompliance and strata
means under saturation. For examples of the use of the compliance score under one-sided noncompliance in biostatistics, see Follmann (2000), Joﬀe and Brensinger (2003), Joﬀe, Ten Have, and
Brensinger (2003), and Roy, Hogan, and Marcus (2008). For Bayesian estimators of the compliance
score under two-sided noncompliance, see Imbens and Rubin (1997) and Hirano et al. (2000);
however, these methods require speciﬁcation of a parametric model for the joint distribution of
treatment assignment, compliance, and outcomes. In contrast, our method requires only speciﬁcation of a parametric model for the ﬁrst stage, and nonparametric extensions are clearly possible via
nonparametric ML estimation.
The compliance score may be directly estimated using ML estimation. To begin, we construct a
likelihood function. For convenience, we make three easily relaxed parametric assumptions. The
ﬁrst assumption is that the probability of being an always-taker or a complier is a function of
covariates with a known distribution:
PA, C, i ¼ PrðD1 > D0 [ D0 ¼ 1jX ¼ xi Þ ¼ FðA, C xi Þ,

ð5Þ

where PA, C, i is the conditional probability that unit i is either a complier or an always-taker, A, C is
a vector of coeﬃcients to be estimated, and FðÞ is the cumulative distribution function (CDF) for
an arbitrary distribution. For the purposes of this article, we use a probit model, so FðÞ ¼ ðÞ,
where  is the Normal CDF. Second, we similarly specify
PAjA, C, i ¼ PrðD0 ¼ 1jD1 > D0 [ D0 ¼ 1, X ¼ xi Þ ¼ FðAjA, C xi Þ,

ð6Þ

where PAjA, C, i is the conditional probability that unit i is an always-taker conditional on it being
either an always-taker or a complier, and AjA, C are coeﬃcients to be estimated. Therefore, we may
deﬁne the compliance score as PC, i ¼ PrðD1i > D0i Þ. Since we know, by deﬁnition, that compliers
receive treatment if and only if assigned to treatment and that always-takers always receive
treatment,

Downloaded from https://www.cambridge.org/core. Harvard-Smithsonian Centerfor Astrophysics, on 26 Nov 2019 at 19:39:17, subject to the Cambridge Core terms of use, available at https://www.cambridge.org/core/terms. https://doi.org/10.1093/pan/mpt013

Beyond LATE

497

PrðD ¼ 1jX ¼ xi Þ ¼ PrðD1 > D0 jX ¼ xi ÞZi þ PrðD0 ¼ 1jX ¼ xi Þ
¼ PA, C, i ð1  PAjA, C, i ÞZi þ PA, C, i PAjA, C, i :
We thus have a fully speciﬁed model for PrðD ¼ 1jX ¼ xi Þ, and this value is strictly bounded
within (0,1) since Zi 2 f0, 1g and PA, C, i 2 ð0, 1Þ. This boundedness, along with the binary nature of
Zi, allows us to specify our third assumption: Di is Bernoulli distributed. Then the likelihood for
any unit i,
LðPAjA, C, i , PA, C, i jD, ZÞ ¼ ðPA, C, i ð1  PAjA, C, i ÞZi þ PA, C, i PAjA, C, i ÞDi
ð1  PA, C, i ð1  PAjA, C, i ÞZi  PA, C, i PAjA, C, i Þ1Di :

ð7Þ

Combining equations (5), (6), and (7), LðA, C , AjA, C jD, ZÞ ¼
ni¼1 ððFðA, C xi Þð1  FðAjA, C xi ÞÞZi þ FðA, C xi ÞFðAjA, C xi ÞÞDi
ð1  FðA, C xi Þð1  FðAjA, C xi ÞÞZi  FðA, C xi ÞFðAjA, C xi ÞÞ1Di Þ:
Thus the ML estimate of fA, C , AjA, C g,


f^A, C , ^AjA, C g ¼ argmax LðA, C , AjA, C jD, ZÞ :
A, C , AjA, C

After estimating A, C and AjA, C , we may estimate the compliance score for unit i,
b 1 > D0 jX ¼ xi Þ ¼ Fð^A, C xi Þð1  Fð^AjA, C xi ÞÞ3 :
P^ Ci ¼ PrðD
Although the ML estimator imposes parametric assumptions about the relationship between the
covariates and the compliance score, these assumptions may be relaxed to arbitrary generality
(given data constraints) by including interactions in and nonlinear transformations (e.g., polynomial expansion, splines) of X. A natural extension would be a sieve-type estimator (Geman and
Hwang 1982), which would facilitate nonparametric estimation of the compliance score.

3.2

ICSW

How does the compliance score help solve the problem of reliance on the LATE even when treatment eﬀects are heterogeneous? Recall that the basic problem addressed by this article is that IV
estimation only generates estimates of the ATE for compliers. We propose a reweighting method
that we refer to as ICSW.4 ICSW follows the logic of IPW: if one type of unit is disproportionately
represented, we may reweight the sample to reﬂect the distribution in the target population.
We provide a simple example to illustrate how the method works. Imagine an experiment where
gender is the only determinant of compliance, such that 75% of males comply with their treatment
assignments but only 10% of females comply with their treatment assignments. Suppose that the
treatment eﬀect for males is 0, but the treatment eﬀect for females is 1. If males and females are
3

As suggested above, in the case of one-sided noncompliance, such that the probability of being an always-taker reduces
to zero, the likelihood function reduces to
LðC jD, ZÞ ¼ ni¼1 ½ðFðA, C xi ÞZi ÞDi þ ð1  FðA, C xi ÞZi Þ1Di :

This likelihood function is a familiar one: it is the standard likelihood function for binomial regression, if only applied to
units in the treatment condition. With one-sided noncompliance and F ðÞ ¼ ðÞ, our ML estimator therefore reduces to
the probit estimator as applied only to units with Zi ¼ 1.
4
In work developed contemporaneously with our article, Angrist and Fernandez-Val (2013) present a similar method to
reweight covariate-specific LATEs to target populations. Although conceptually similar, the estimation procedures in
Angrist and Fernandez-Val (2013) require discrete covariates that take on a finite and fixed number of values. It can
also be shown that when ICSW is used with a saturated set of covariates, it reproduces Angrist and Fernandez-Val’s
(2013) estimator. Angrist and Fernandez-Val (2013) also derive results on analogues to overidentification under the
potential outcomes framework given multiple instruments. In addition, for an integrative framework for recovering the
ATE along with other causal quantities in the case of one-sided noncompliance, see Esterling, Neblo, and Lazer (2011).
Frangakis and Rubin (1999) present a similar, foundational approach involving missing data.

Downloaded from https://www.cambridge.org/core. Harvard-Smithsonian Centerfor Astrophysics, on 26 Nov 2019 at 19:39:17, subject to the Cambridge Core terms of use, available at https://www.cambridge.org/core/terms. https://doi.org/10.1093/pan/mpt013

498

Peter M. Aronow and Allison Carnegie

represented equally in the population, then the ATE is 0:50þ0:51
¼ 0:5. The problem, of course, is
0:5þ0:5
that we cannot directly estimate the ATE due to noncompliance. IV estimation recovers the LATE,
¼ 0:12. In this example, the LATE
which we compute using a weighted average, 0:50:750þ0:50:101
0:50:75þ0:50:10
is much lower than the ATE because females are underrepresented among compliers. Recovering
the ATE with noncompliance entails weighting units by the inverse of the compliance score, then
performing IV estimation. Again computing a weighted average, the estimand recovered by this
procedure is the ATE:

1
1
0:50:750:75
0þ0:50:100:10
1
1
1
þ0:50:100:10
0:50:750:75

¼ 0:50þ0:51
¼ 0:5. We develop this intuition
0:5þ0:5

formally, ﬁrst providing a general expression for the estimator, then detailing the assumptions
necessary for consistency.
3.3

ICSW Estimator

Following from our use of the potential outcomes framework, the estimation procedure presented
here requires the instrument Zi and endogenous variable Di to be binary. This requirement is
satisﬁed in many empirical studies, including numerous randomized experiments with noncompliance.5 In the bivariate case (when there are no covariates), the estimator is simple. Deﬁne
w^ Ci ¼ 1=P^ Ci . The ICSW estimator ^ATE ¼
ð
ð

n
P

i¼1
n
P

w^ Ci Zi Yi Þ=ð
w^ Ci Zi Di Þ=ð

i¼1

n
P
i¼1
n
P
i¼1

w^ Ci Zi Þ  ð

n
P

i¼1
n
P

w^ Ci Zi Þ  ð

i¼1

w^ Ci ð1  Zi ÞYi Þ=ð

n
P
i¼1
n
P

w^ Ci ð1  Zi ÞDi Þ=ð

w^ Ci ð1  Zi ÞÞ
:
w^ Ci ð1  Zi ÞÞ

i¼1

An equivalent estimator may be derived using weighted 2SLS (with weights w^ Ci ). As with the simple
2SLS case, covariates may also be included to reduce sampling variability without any consequence
for the asymptotic bias of the estimator.
Like other estimators that rely on reweighting, this estimator is typically more variable than its
unweighted counterpart, 2SLS, and is potentially subject to greater ﬁnite sample bias. The ICSW
estimator, like 2SLS, has increased ﬁnite sample bias when compliance rates are low, and this
problem is exaggerated when some units have very low compliance scores.6 To characterize uncertainty, we recommend bootstrapping the entire process—from computing the compliance score to
weighted IV estimation (Abadie 2002).7
3.4

ICSW Assumptions

In order to consistently estimate the ATE using ICSW, three additional assumptions are required.
In the appendix, we demonstrate that ICSW is consistent under Assumptions 1–3, along with the IV
assumptions and suitable regularity conditions.
5

The method can be generalized to applications using continuous endogenous variables and multivalued (or multiple)
instruments. As Angrist and Imbens (1995) demonstrate, with continuous endogenous variables, 2SLS produces a
weighted average of grouped data IV estimators. With multiple instruments, 2SLS is a weighted average (efficient
under homoskedasticity) of the 2SLS estimator for each instrument. Although detailing such extensions is beyond
the scope of the article, under the assumptions outlined here, the ATE could be estimated for each instrument and a
weighted average could be produced for the overall ATE.
6
In order to prevent very small compliance scores from forming in finite samples, we Winsorize our estimates. Define c
as the 1=n th quantile of P^ Ci , where a is a positive calibrating constant. We replace all P^ Ci < c with c. We recommend
(and use in this article)  ¼ 0:275, which performed well in simulation studies presented in the supplementary appendix.
Winsorizing is performed because very low probabilities can introduce instability in the estimates resulting from IPW
(Elliott 2009), but Winsorizing may sometimes increase finite sample bias. Asymptotically, assuming that a remains
fixed, the Winsorization has no impact on estimation, because c ! 0 as n ! 1. In fact, non-Winsorized estimates
represent a special case of this Winsorization process whenever  ! 1.
7
For IPW-style estimators, analytic variance estimators presuming correct model specification may be highly sensitive to
model misspecification and inaccurate in finite samples, whereas the bootstrap tends to have better coverage (Funk et al.
2011). In our own simulation studies, assuming  ¼ 0:275, we find that the bootstrap has conservative coverage for
ICSW in small samples, and proper coverage in larger samples. These studies are presented in the supplementary
appendix.

Downloaded from https://www.cambridge.org/core. Harvard-Smithsonian Centerfor Astrophysics, on 26 Nov 2019 at 19:39:17, subject to the Cambridge Core terms of use, available at https://www.cambridge.org/core/terms. https://doi.org/10.1093/pan/mpt013

Beyond LATE

499

Assumption 1.
Latent ignorability of compliance with respect to treatment eﬀect heterogeneity (Frangakis and
Rubin 1999; Esterling, Neblo, and Lazer 2011) holds. Assumption 1 entails that, for all
x 2 SuppðXÞ, EðY1  Y0 jX ¼ xÞ ¼ EðY1  Y0 jD1 > D0 , X ¼ xÞ: the expected value of the treatment
eﬀect conditional on a covariate proﬁle is equal to the expected value of the treatment eﬀect
conditional on a covariate proﬁle and compliance. Put simply, the ATE for all units with a
covariate proﬁle x is equal to the ATE for compliers with a covariate proﬁle x.
Ignorability assumptions, while strong, are necessary for consistent estimation of causal eﬀects
under a variety of common methods, including propensity score methods, matching, and even
linear regression. However, Assumption 1 may be distinguished from the typical ignorability assumption (Rubin 1978), which requires that both EðY1 jD ¼ 1, X ¼ xÞ ¼ EðY1 jD ¼ 0, X ¼ xÞ and
EðY0 jD ¼ 1, X ¼ xÞ ¼ EðY0 jD ¼ 0, X ¼ xÞ. Assumption 1 is less restrictive than the typical
ignorability assumption as there is no need to account for baseline selection bias, only the determinants of treatment eﬀect heterogeneity. For example, consider a randomized clinical trial of an
experimental medicine. Assume the medicine may aﬀect subjects diﬀerently depending only on
certain known underlying medical conditions. The researcher might not be able to determine or
measure all of the causes of take-up that are related to potential outcomes (e.g., wealth or risktaking), so the typical ignorability assumption would not be satisﬁed. However, Assumption 1
might still hold; only the determinants of both compliance and heterogeneity need to be
included in the conditioning set for consistency.
We can describe suﬃcient conditions for and consequences of Assumption 1. If all predictors of
compliance are known, then Assumption 1 will clearly hold. But what if only some (or even none)
of the predictors of compliance are observed? In the case where the treatment eﬀect is a constant
value, t, across all units, Assumption 1 always holds: EðY1  Y0 jX ¼ xÞ ¼ EðY1  Y0 jD1 >
D0 , X ¼ xÞ ¼ . If we were to accept the SEM interpretation of IV, where treatment eﬀects are
constant, Assumption 1 would always be satisﬁed and both 2SLS and ICSW would be consistent
for t. More generally, even if treatment eﬀects are heterogeneous, but still statistically independent
of compliance, Assumption 1 would necessarily be satisﬁed, and both 2SLS and ICSW would be
consistent for the ATE.
But what if treatment eﬀects are heterogeneous and we have failed to identify the suﬃcient
conditioning set? As Assumption 1 no longer holds, the ICSW estimator is now biased, even
asymptotically. However, ICSW will still recover an internally valid causal eﬀect, not on the full
population of interest, but for some population that has a covariate proﬁle that matches that of the
full population. To see this, we can compare two expressions. Through simple manipulation of
expectations, the LATE may be written as
Z
PrðD1 > D0 jX ¼ xÞfðxÞdx
EðY1  Y0 jD1 > D0 , X ¼ xÞ
PrðD1 > D0 Þ

Z
¼
EðY1  Y0 jD1 > D0 , X ¼ xÞgðxÞdx,


where fð:Þ is the population pdf of X, gð:Þ is the subpopulation pdf of X among compliers, and
 ¼ SuppðXÞ. Manipulating equations (10) and (13) from the appendix, the asymptotic value of the
ICSW estimator under failure of Assumption 1 will be
Z
EðY1  Y0 jD1 > D0 , X ¼ xÞfðxÞdx:


The diﬀerence between gð:Þ and fð:Þ characterizes the nature of the adjustment performed by ICSW.
Much like we would reweight a poll to attempt to ensure that the sample is representative in its
observable covariates, ICSW reweights the subpopulation upon which eﬀects are estimated so that
it is representative in its observables.
When the ATE is the parameter of interest, the limiting value of the ICSW estimator is thus
typically more sensible than that of 2SLS/IV, as ICSW incorporates available covariate

Downloaded from https://www.cambridge.org/core. Harvard-Smithsonian Centerfor Astrophysics, on 26 Nov 2019 at 19:39:17, subject to the Cambridge Core terms of use, available at https://www.cambridge.org/core/terms. https://doi.org/10.1093/pan/mpt013

500

Peter M. Aronow and Allison Carnegie

information. In fact, 2SLS represents the special case of ICSW where no covariates are included in
the compliance score estimation process. Although there are examples where adding covariates can
increase asymptotic bias under misspeciﬁcation (due to complementary imbalances), we concur
with Rubin (2009), who argues that the most principled conditioning strategy is one that
includes all known pretreatment covariates.8
Assumption 2.
Consistency of P^ Ci for PCi. Assumption 2 amounts to requiring proper speciﬁcation of the ML
estimator. Application of a ﬂexible parametrization of the covariates in X, as is possible with large
samples, will necessarily yield consistency, so long as the rate of growth in the number of estimated
parameters is suﬃciently slow in n. In the case of a saturated model and Fð:Þ as the normal CDF,
P^ Ci will be unbiased for the conditional probability of compliance.

Assumption 3.
For all x 2 SuppðXÞ, PrðD1 > D0 jX ¼ xÞ 2 ð , 1, where > 0. Note that IV estimation already
requires the assumption of nonzero compliance in the full population, and we generalize this assumption to every covariate proﬁle. This assumption has both theoretical and practical implications. If Assumption 3 fails, then the ATE cannot generally be estimated using the variation
induced by Z: the instrument simply does not cause any variation in the treatment received by
some types of units. In practice, if a unit has zero probability of compliance, the weighting procedure will produce inﬁnite weights asymptotically, leading to an undeﬁned estimate. Conditional
on the validity of Assumptions 1 and 2, Assumption 3 is therefore veriﬁable in large samples.

4

Applications

We now present two case studies: Green, Gerber, and Nickerson (2003) and Albertson and
Lawrence (2009). We select these two articles because they allow us to display the use of our
method in the intuitive case of one-sided noncompliance as well as the more complex case of
two-sided noncompliance.9

4.1

Green, Gerber, and Nickerson (2003)

Green, Gerber, and Nickerson (2003) present results from a large-scale (n ¼ 18, 933) ﬁeld experiment designed to assess the eﬀect of canvassing on voter turnout. Registered voters in Bridgeport,
Columbus, Detroit, Minneapolis, Raleigh, and St. Paul were randomly assigned to treatment or
control, where the treatment was encouragement to vote in advance of the November 6, 2001, local
elections. Encouragement was delivered in the form of face-to-face contact with nonpartisan
student and community organization members. Because some citizens who were assigned to the
treatment group could not be contacted, the study features one-sided noncompliance. To get
around this limitation, the authors use the attempt to administer the treatment as an instrument
for the receipt of the treatment to consistently estimate the LATE. These results are presented in
column (1) of Table 1. Among compliers, canvassing is estimated to increase turnout by 5.6
percentage points with a conﬁdence interval of ð2:2, 8:9Þ.10
8

Data constraints (e.g., a large number of covariates or small n) may prevent inclusion of all covariates, in which case
some dimension reduction or variable selection may be necessary. Fodor (2002) provides a review of such methods.
9
Replication data for these applications are available at Aronow and Carnegie (2013).
10
The estimates presented differ slightly from those in the original paper because the original paper used one-way fixed
effects for randomization strata, which is inconsistent in the presence of heterogeneous probabilities of assignment to
treatment. In general, when using a covariate conditioning strategy, linear regression and IV estimators produce estimates reweighted by the conditional variance of the instrument (Angrist and Pischke 2009; Humphreys 2009). We
instead use IPW, which is consistent in this example.

Downloaded from https://www.cambridge.org/core. Harvard-Smithsonian Centerfor Astrophysics, on 26 Nov 2019 at 19:39:17, subject to the Cambridge Core terms of use, available at https://www.cambridge.org/core/terms. https://doi.org/10.1093/pan/mpt013

Beyond LATE

501

Table 1 2SLS and ICSW estimates for Green, Gerber, and Nickerson (2003)

Voter turnout in 2001 local elections
Campaign contact
Number of family members
White
Black
Voted in 2000 general election
Voted in 1999 general election
Voted in 2001 primary election
Age
Age missing
Democrat
Republican
Independent
City controls

LATE (2SLS)
(1)

ATE (ICSW)
(2)

5.6
(2.2, 8.9)
0.2
(0.8, 0.4)
9.0
(3.9, 13.7)
1.7
(7.7, 3.5)
23.0
(21.9, 24.1)
30.5
(28.5, 32.4)
48.7
(47.0, 50.5)
0.2
(0.2, 0.2)
12.7
(16.5, 44.1)
2.6
(0.6, 4.7)
3.8
(1.3, 6.2)
8.2
(5.4, 10.7)
Yes

6.7
(3.2, 10.3)
0.0
(0.6, 0.6)
9.5
(4.5, 13.9)
1.1
(6.7, 3.7)
21.0
(19.8, 22.2)
27.2
(25.1, 29.4)
51.0
(49.2, 52.9)
0.2
(0.1, 0.2)
17.7
(15.9, 50.3)
2.6
(0.7, 04.8)
3.2
(0.8, 5.8)
6.3
(3.8, 8.8)
Yes

Note. Bootstrap 95% confidence intervals in parentheses. Dependent variable is voter turnout in the 2001 general election in percentage
points. Covariates include dummy variables for turnout in the 1999 general, 2000 general, and 2001 primary elections, whether the
respondent is a Democrat, is a Republican, is an Independent, is black, is white, city of residence, and missing data on age; and
integers for the respondent’s age and the number of family members in the household

The theoretical implications of the LATE are somewhat unclear in this experiment. Which
subjects are compliers is an artifact of the way in which the intervention is deployed. For
example: if canvassers attempted to contact subjects multiple times, the contact rate would
surely have been higher. There is little theoretical reason to care about subjects who could be
contacted in the context of this particular experiment. This shortcoming of the LATE is compounded by the fact that the authors are responding to a broader literature on the determinants
of voter mobilization, citing works such as Rosenstone and Hansen (1993), Verba, Schlozman, and
Brady (1995), and Putnam (2000). These earlier works focus on the determinants of turnout in the
entire population, whereas Green, Gerber, and Nickerson (2003) estimate the determinants of
turnout in the complier population, the answer to a potentially diﬀerent question. Green,
Gerber, and Nickerson (2003, 1086) state that a central goal of their study is “to better gauge
the average treatment eﬀect of canvassing,” but the LATE provides limited information about the
ATE. For example, noncompliers may have diﬀerent education levels, incomes, interest in politics,
or other demographic characteristics than compliers, leading them to respond diﬀerently to contact.
We begin by estimating compliance scores for the sample. As recommended above, we use all
observed pretreatment covariates, which include the covariates listed in Table 1 and dummy variables for the six cities in the sample. Although the set of available covariates may or may not satisfy
the ignorability assumption, we will still recover an estimate for a population that has a covariate
proﬁle that matches that of the full population. We see that compliers are more likely to have voted
previously, be members of a major party, and identify as white (see the supplementary appendix for
a correlation matrix between the estimated compliance score and covariates). We now apply ICSW

Downloaded from https://www.cambridge.org/core. Harvard-Smithsonian Centerfor Astrophysics, on 26 Nov 2019 at 19:39:17, subject to the Cambridge Core terms of use, available at https://www.cambridge.org/core/terms. https://doi.org/10.1093/pan/mpt013

502

Peter M. Aronow and Allison Carnegie

and present the results in column (2) of Table 1. Canvassing is estimated to increase turnout in the
entire population by 6.7 percentage points with a conﬁdence interval of ð3:2, 10:3Þ, whereas it is
estimated to increase turnout among compliers by only 5.6 percentage points. The ATE is therefore
estimated to be 19% larger than the LATE.11 The estimated ATE strengthens Green, Gerber, and
Nickerson’s (2003, 1094) conclusion that “mobilization campaigns have the potential to increase
turnout substantially in local elections,” and addresses a population that more closely resembles the
population of interest.
4.2

Albertson and Lawrence (2009)

Albertson and Lawrence (2009) present ﬁndings from an experiment (n ¼ 507) in which a
representative sample of survey respondents in Orange County, California, were randomly
assigned to receive encouragement to view a Fox debate on aﬃrmative action, which would take
place on the eve of the 1996 presidential election. Shortly after the election, these respondents were
reinterviewed. The postelection questionnaire asked respondents whether they viewed the debate,
whether they supported a California proposition (209) to eliminate aﬃrmative action (coded 1 if
they supported it and 0 if not), and how informed they felt about the proposition (coded on a scale
from 1 to 4 from least to most informed). The authors use a standard IV design to address the fact
that some who were not assigned to treatment reported viewing the debate and some who were
assigned to treatment did not report viewing the debate. This two-sided noncompliance was
nontrivial: 55% of subjects assigned to watch the debate did not report viewing the debate, and
4% of subjects who were not assigned to watch the debate reported viewing it. Albertson and
Lawrence’s IV regression results show a positive relationship between program viewing and feeling
more informed about the issue and a statistically insigniﬁcant, negative relationship between
program viewing and support for the proposition among compliers. Albertson and Lawrence’s
original ﬁndings are presented in columns (1) and (3) of Table 2.12
Is the ATE or the LATE a more appropriate estimand in this case? Our estimand of interest
depends on the research question. Albertson and Lawrence (2009, 276) state that the question they
seek to answer is whether “civic-minded television ha[s] a lasting impact on those who watch,”
which responds to an existing literature that “supports the view that television can be expected to
inform viewers, make issues more salient, change viewers’ attitudes and possibly even aﬀect their
behavior.” Thus, the population of interest is deﬁned to be viewers, but leaves ambiguous which
viewers are of interest. Given the pains taken to achieve a representative sample for the original
survey, we may believe that the parameter of theoretical interest is the ATE because it addresses the
potential media eﬀects on the population as a whole. Although the ignorability assumption may not
hold, ICSW permits estimation of causal eﬀect for a population that, at a minimum, resembles the
full population on observables, thus likely better approximating the ATE. Divergence between our
estimates of the ATE and LATE implies that eﬀect heterogeneity has the potential to complicate
interpretation of the eﬀects of viewership.
We ﬁrst estimate compliance scores for the sample using the eight covariates used by Albertson
and Lawrence (see Table 2 for a description of each of the covariates). The compliance score most
strongly correlates with political interest, newspaper reading, and education (see the supplementary
appendix for a full correlation matrix). Recall that compliers are substantively unusual: compliers
would not ordinarily watch the program but watch only because they were induced by the treatment assignment.
We now estimate the ATE using ICSW; our estimates of the ATE are presented in columns (2)
and (4) of Table 2. Although Albertson and Lawrence (2009) ﬁnd that compliers are 0.28 points

11
12

The difference in coefficients, ^ATE  ^LATE , has a 95% confidence interval of (-0.2, 2.3) and a 90% confidence interval
of (0.0, 2.2).
Note that our replication of their results differs slightly from their original results due to the fact that we use IPW with
all covariates as well as the treatment assignment indicator to address missing values in the dependent variable. This
IPW step is also included in the bootstrap procedure. As Albertson and Lawrence note, missing values on the outcome
variable appear to be missing at random, at least with respect to the treatment indicator.

Downloaded from https://www.cambridge.org/core. Harvard-Smithsonian Centerfor Astrophysics, on 26 Nov 2019 at 19:39:17, subject to the Cambridge Core terms of use, available at https://www.cambridge.org/core/terms. https://doi.org/10.1093/pan/mpt013

503

Beyond LATE
Table 2 2SLS and ICSW estimates for Albertson and Lawrence (2009)

Knowledge

Watching debate
Intercept
Party ID
Political interest
Watch news
Education
Read news
Female
Income
White

Opinion

LATE (2SLS)
(1)

ATE (ICSW)
(2)

LATE (2SLS)
(3)

ATE (ICSW)
(4)

0.28
(0.04, 0.59)
1.81
(1.33, 2.26)
0.02
(0.05, 0.01)
0.25
(0.15, 0.36)
0.00
(0.05, 0.05)
0.00
(0.02, 0.03)
0.11
(0.07, 0.15)
0.05
(0.19, 0.07)
0.01
(0.04, 0.02)
0.06
(0.11, 0.24)

0.40
(0.01, 1.26)
1.90
(1.34, 2.50)
0.02
(0.06, 0.02)
0.26
(0.15, 0.38)
0.01
(0.07, 0.05)
0.00
(0.03, 0.03)
0.10
(0.05, 0.15)
0.06
(0.23, 0.10)
0.02
(0.05, 0.01)
0.03
(0.19, 0.27)

0.07
(0.25, 0.13)
1.01
(0.70, 1.30)
0.08
(0.10, 0.06)
0.03
(0.09, 0.03)
0.01
(0.02, 0.04)
0.01
(0.03, 0.00)
0.01
(0.03, 0.02)
0.02
(0.10, 0.06)
0.01
(0.01, 0.02)
0.17
(0.06, 0.29)

0.05
(0.31, 0.24)
0.99
(0.60, 1.29)
0.08
(0.10, 0.05)
0.02
(0.09, 0.06)
0.00
(0.02, 0.04)
0.01
(0.03, 0.01)
0.01
(0.03, 0.02)
0.00
(0.09, 0.12)
0.01
(0.01, 0.02)
0.14
(0.01, 0.27)

Note. Bootstrap 95% confidence intervals in parentheses. Dependent variables are knowledge (coded on a scale from 1 to 4 from least to
most informed) and opinion (coded 1 if the respondent supported the proposition and 0 otherwise). Covariates include: television news
watching habits (coded on a seven-point scale from never watches to watches every day), newspaper reading habits (coded on seven-point
scale from never reads to reads every day), interest in politics and national affairs (coded on a four-point scale from low interest to high
interest), party ID (coded on an eleven-point scale), income (coded on a scale from 1 to 11 from poorest to richest), female (coded 1 if
the respondent is female and 0 otherwise), education (coded on a thirteen-point scale from least to most educated), and white (coded 1 if
the respondent is white and 0 otherwise)

more informed after viewing the program, we ﬁnd that viewers in the entire subject population are
0.40 points more informed after viewing. We therefore estimate that the ATE is approximately 45%
larger than the LATE. Turning to our analysis of the eﬀect of program viewing on support for the
measure, we see that Albertson and Lawrence’s (2009) 2SLS estimate and our ICSW estimate are
nearly identical at 0.07 points and 0.05 points, respectively. We therefore ﬁnd that the eﬀect of
viewing the debate on support for compliers is very similar to the estimated ATE, suggesting two
possible interpretations. Since we cannot reject the null hypothesis of no treatment eﬀect for either
the LATE or the ATE, we may suspect that there is no eﬀect on attitudes resulting from the
treatment. Alternatively, if we believe there is a small treatment eﬀect, we ﬁnd no evidence that
the LATE diverges from the ATE.13
5

Conclusion

IV methods have grown in popularity in recent years, due to their ability to overcome problems of
endogeneity and selection bias. However, our results suggest that researchers should pay careful
attention to the estimand when using this popular method, as the LATE can diﬀer considerably
from the ATE. When the ATE is the target parameter, ICSW may be a more sensible estimator
than is standard IV. As the use of IV methods continues to expand, this type of recognition and
discussion of the causal quantity of interest will only grow in importance.
13

The difference in coefficients for knowledge, ^ATE  ^LATE , has a 95% confidence interval of (0.02, 0.90) and a 90%
confidence interval of (0.00, 0.52). The difference in coefficients for opinion has a 95% confidence interval of (0.12,
0.16) and a 90% confidence interval of (0.08, 0.12).

Downloaded from https://www.cambridge.org/core. Harvard-Smithsonian Centerfor Astrophysics, on 26 Nov 2019 at 19:39:17, subject to the Cambridge Core terms of use, available at https://www.cambridge.org/core/terms. https://doi.org/10.1093/pan/mpt013

504

Peter M. Aronow and Allison Carnegie

Appendix: ICSW Consistency
We derive expressions for the inverse compliance score weighted numerator (average ITT eﬀect)
and denominator (average probability of compliance) of equation (3), thus obtaining the
asymptotic value of the IV estimator after ICSW. For clarity, we remove i subscripts to denote
all units subject to any conditional probabilities articulated. As in equation (3),
ITT ¼ PrðD1 > D0 ÞEðY1  Y0 jD1 > D0 Þ, which we may express as a weighted average of the
conditional ITTs:
Z
PrðD1 > D0 jX ¼ xÞEðY1  Y0 jD1 > D0 , X ¼ xÞfðxÞdx:
ð8Þ
ITT ¼


With the equations above, we are now able to apply ICSW, multiplying by the inverse of the
1
compliance score: PrðD1 >D
. We then divide by the average weight across all units (to normalize
0 jX¼xÞ
R
1
the weight). We deﬁne the average weight wc ¼  PrðD1 >D
fðxÞdx.
0 jX¼xÞ
We can write the weighted ITT as follows:
Z
1
PrðD1 > D0 jX ¼ xÞEðY1  Y0 jD1 > D0 jX ¼ xÞ
w
ITT ¼
fðxÞdx:
ð9Þ
PrðD1 > D0 jX ¼ xÞ
wc 
Since the PrðD1 > D0 jX ¼ xÞ terms cancel, equation (9) reduces to
Z
1
EðY1  Y0 jD1 > D0 , X ¼ xÞfðxÞdx:
ð10Þ
ITTw ¼
wc 
R
Applying Assumption 1, we can rewrite equation (10) as ITTw ¼ w1c  EðY1  Y0 jX ¼ xÞfðxÞdx: By
the law of total probability, the reweighted numerator of the IV estimator is
Z
1
1
EðY1  Y0 jX ¼ xÞfðxÞdx ¼ EðY1  Y0 Þ:
ð11Þ
ITTw ¼
wc 
wc
We can now reweight the denominator of the IV estimator by expanding the deﬁnition of the
complier population, weighting, and simplifying:
Z
PrðD1 > D0 jX ¼ xÞfðxÞdx,

PrðD1 > D0 Þ ¼

ð12Þ



1
PrðD1 > D0 Þ ¼
wc
w

Z

PrðD1 > D0 jX ¼ xÞ
1
fðxÞdx ¼
wc
 PrðD1 > D0 jX ¼ xÞ

Z
fðxÞdx ¼


1
:
wc

ð13Þ

Dividing equation (11) by equation (13), we have the asymptotic value of the ICSW estimator,
1

ITTw
wc EðY1  Y0 Þ
¼ EðY1  Y0 Þ,
w ¼
1
PrðD1 > D0 Þ
wc

ð14Þ
w

which is the ATE. By Slutsky’s theorem, a consistent estimator of PrðDITT
w will be
1 >D0 Þ
!
!,
!
!,
n
n
n
n
P
P
P
P
w^ Ci Zi Yi
w^ Ci Zi 
w^ Ci ð1  Zi ÞYi
w^ Ci ð1  Zi Þ
i¼1
n
P

!,
w^ Ci Zi Di

i¼1

i¼1
n
P

i¼1

!
w^^ Ci Zi 

i¼1

n
P

!,
w^ Ci ð1  Zi ÞDi

i¼1

i¼1
n
P

!,
w^ Ci ð1  Zi Þ

i¼1

as
n
X
i¼1

!,
w^ Ci Zi Yi

n
X
i¼1

!
w^ Ci Zi 

n
X
i¼1

!,
w^ Ci ð1  Zi ÞYi

n
X
i¼1

!
w^ Ci ð1  Zi Þ !p ITTw

Downloaded from https://www.cambridge.org/core. Harvard-Smithsonian Centerfor Astrophysics, on 26 Nov 2019 at 19:39:17, subject to the Cambridge Core terms of use, available at https://www.cambridge.org/core/terms. https://doi.org/10.1093/pan/mpt013

505

Beyond LATE

and
n
X

!,
w^ Ci Zi Di

i¼1

n
X

!
w^ Ci Zi 

i¼1

n
X
i¼1

!,
w^ Ci ð1  Zi ÞDi

n
X

!
w^ Ci ð1  Zi Þ !p PrðD1 > D0 Þw

i¼1

under suitable regularity conditions.
References
Abadie, Alberto. 2002. Bootstrap tests for distributional treatment effects in instrumental variable models. Journal of the
American Statistical Association 97(457):284–92.
Albertson, Bethany, and Adria Lawrence. 2009. After the credits roll: The long-term effects of educational television on
public knowledge and attitudes. American Politics Research 37(2):275–300.
Altonji, J. G., and T. A. Dunn. 1996. The effects of family characteristics on the return to education. Review of Economics
and Statistics 78:692–704.
Angrist, Joshua D., and Guido W. Imbens. 1995. Two-stage least squares estimation of average causal effects in models
with variable treatment intensity. Journal of the American Statistical Association 90(430):431–42.
Angrist, Joshua D., Guido W. Imbens, and Donald B. Rubin. 1996. Identification of causal effects using instrumental
variables. Journal of the American Statistical Association 91:444–55.
Angrist, Joshua D., and Ivan Fernandez-Val. 2013. ExtrapoLATE-ing: External validity and overidentification in the
LATE framework. In Advances in economics and econometrics: Tenth world congress, Vol. 3, eds. Manuel
Arellano Daron Acemoglu, and Eddie Deke, 401–36. Cambridge: Cambridge University Press.
Angrist, Joshua D., and Jörn-Steffen Pischke. 2009. Mostly harmless econometrics: An empiricist’s companion. Princeton,
NJ: Princeton University Press.
Arceneaux, K., and D. W. Nickerson. 2009. Who is mobilized to vote? A re-analysis of 11 field experiments. American
Journal of Political Science 53(1):1–16.
Arceneaux, Kevin, and David W. Nickerson. 2010. Comparing negative and positive campaign messages. American
Politics Research 38(1):54–83.
Aronow, Peter M., and Allison Carnegie. 2013. Replication data for: Beyond LATE: Estimation of the average treatment
effect with an instrumental variable. Dataverse Network. http://hdl.handle.net/1902.1/21729 (accessed August 1, 2013).
Deaton, Angus. 2009. Instruments of development: Randomization in the tropics, and the search for the elusive keys to
economic development. Proceedings of the British Academy, 2008 Lectures 162:123–60.
Elliott, Michael R. 2009. Model averaging methods for weight trimming in generalized linear regression models. Journal
of Official Statistics 25(1):1–20.
Esterling, Kevin M., Michael A. Neblo, and David M. J. Lazer. 2011. Estimating treatment effects in the
presence of noncompliance and nonresponse: The generalized endogenous treatment model. Political Analysis
19(2):205–26.
Fodor, Imola.K. 2002. A survey of dimension reduction techniques. Center for Applied Scientific Computing, Lawrence
Livermore National Laboratory, Vol. 9: 1–18.
Follmann, Dean A. 2000. On the effect of treatment among would-be treatment compliers: An analysis of the multiple
risk factor intervention trial. Journal of the American Statistical Association 95(452):1101–9.
Frangakis, Constantine E., and Donald B. Rubin. 1999. Addressing complications of intention-to-treat analysis in the
combined presence of all-or-none treatment-noncompliance and subsequent missing outcomes. Biometrika 86(2):365–79.
Funk, Michele Jonsson, Daniel Westreich, Chris Wiesen, Til Strmer, M. Alan Brookhart, and Marie Davidian. 2011.
Doubly robust estimation of causal effects. American Journal of Epidemiology 173(7):761–7.
Geman, Stuart, and Chii-Ruey Hwang. 1982. Nonparametric maximum likelihood estimation by the method of sieves.
Annals of Statistics 10(2):401–14.
Green, Donald P., Alan S. Gerber, and David W. Nickerson. 2003. Getting out the vote in local elections: Results from
six door-to-door canvassing experiments. Journal of Politics 65(4):1083–96.
Heckman, James J., and Sergio Urzua. 2010. Comparing IV with structural models: What simple IV can and cannot
identify. Journal of Econometrics 156(1):27–37.
Hidalgo, F. D., S. Naidu, S. Nichter, and N. Richardson. 2010. Economic determinants of land invasions. Review of
Economics and Statistics 92(3):505–23.
Hirano, Keisuke, Guido W. Imbens, Donald B. Rubin, and Xiao-Hua Zhou. 2000. Assessing the effect of an influenza
vaccine in an encouragement design. Biostatistics 1(1):69–88.
Horvitz, D. G., and D. J. Thompson. 1952. A generalization of sampling without replacement from a finite universe.
Journal of the American Statistical Association 47(260):663–85.
Humphreys, Macartan. 2009. Bounds on least squares estimates of causal effects in the presence of heterogeneous assignment probabilities. Working paper.
Imbens, Guido W. 2009. Better LATE than nothing: Some comments on Deaton (2009) and Heckman and Urzua (2009).
NBER Working paper.
Imbens, Guido W., and Donald B. Rubin. 1997. Bayesian inference for causal effects in randomized experiments with
noncompliance. Annals of Statistics 25(1):305–27.

Downloaded from https://www.cambridge.org/core. Harvard-Smithsonian Centerfor Astrophysics, on 26 Nov 2019 at 19:39:17, subject to the Cambridge Core terms of use, available at https://www.cambridge.org/core/terms. https://doi.org/10.1093/pan/mpt013

506

Peter M. Aronow and Allison Carnegie

Joffe, Marshall M., and Colleen Brensinger. 2003. Weighting in instrumental variables and G-estimation. Statistics in
Medicine 22(1):1285–303.
Joffe, Marshall M., Thomas R. Ten Have, and Colleen Brensinger. 2003. The compliance score as a regressor in
randomized trials. Biostatistics 4(3):327–40.
Putnam, Robert C. 2000. Bowling alone: The collapse and renewal of American Community. New York: Simon and
Schuster.
Rosenstone, Steven J., and John Mark Hansen. 1993. Mobilization, participation, and democracy in America. New York:
Macmillan Publishing Company.
Roy, Jason, Joseph W. Hogan, and Bess H. Marcus. 2008. Principal stratification with predictors of compliance for
randomized trials with 2 active treatments. Biostatistics 9(2):277–89.
Rubin, Donald B. 1978. Bayesian inference for causal effects: The role of randomization. Annals of Statistics
6(1):34–58.
———. 2009. Author’s reply: Should observational studies be designed to allow lack of balance in covariate distributions
across treatment groups? Statistics in Medicine 28(9):1420–23.
Verba, Sidney, Kay Lehman Schlozman, and Henry E. Brady. 1995. Voluntarism in American Politics. Cambridge, MA:
Harvard University Press.
Wald, A. 1940. The fitting of straight lines if both variables are subject to error. Annals of Mathematical Statistics
11:284–300.
Yau, Linda H. Y., and Roderick J. Little. 2001. Inference for the complier-average causal effect from longitudinal data
subject to noncompliance and missing data, with application to a job training assessment for the unemployed. Journal
of the American Statistical Association 96:1232–44.

