Research Article
Received 25 June 2013,

Accepted 23 April 2014

Published online 14 May 2014 in Wiley Online Library

(wileyonlinelibrary.com) DOI: 10.1002/sim.6207

On regression adjustment for the
propensity score
S. Vansteelandta*‚Ä† and R. M. Danielb
Propensity scores are widely adopted in observational research because they enable adjustment for highdimensional confounders without requiring models for their association with the outcome of interest. The results
of statistical analyses based on stratification, matching or inverse weighting by the propensity score are therefore
less susceptible to model extrapolation than those based solely on outcome regression models. This is attractive
because extrapolation in outcome regression models may be alarming, yet difficult to diagnose, when the exposed
and unexposed individuals have very different covariate distributions.
Standard regression adjustment for the propensity score forms an alternative to the aforementioned propensity
score methods, but the benefits of this are less clear because it still involves modelling the outcome in addition to the propensity score. In this article, we develop novel insights into the properties of this adjustment
method. We demonstrate that standard tests of the null hypothesis of no exposure effect (based on robust variance
estimators), as well as particular standardised effects obtained from such adjusted regression models, are robust
against misspecification of the outcome model when a propensity score model is correctly specified; they are
thus not vulnerable to the aforementioned problem of extrapolation. We moreover propose efficient estimators
for these standardised effects, which retain a useful causal interpretation even when the propensity score model
is misspecified, provided the outcome regression model is correctly specified. Copyright ¬© 2014 John Wiley &
Sons, Ltd.
Keywords:

causal inference; effect measure; model misspecification; positivity; pooling; propensity score;
standardisation; strong confounding

1. Introduction
In a seminal paper in the 1980s, Rosenbaum and Rubin introduced the concept of propensity scores
and laid out their key properties [1]. For a given exposure and baseline covariate set, they defined the
propensity score for a given individual as the probability for that individual to be exposed, on the basis
of his/her covariates. They subsequently demonstrated that when the covariate set is sufficient to control
for confounding of the effect of exposure on outcome, then adjustment for the propensity score is also
sufficient. Because the propensity score is scalar, this enables the use of simple and transparent methods for confounding adjustment that would otherwise be impossible in the presence of high-dimensional
confounders [1, 2]: stratification by the propensity score [3, 4], matching on the propensity score [5]
and inverse weighting by the propensity score [6, 7]. Each of these methods relies on a model for the
propensity score, for example, a logistic regression model for a dichotomous exposure. They all avoid
reliance on outcome regression models either by making raw comparisons within strata of individuals
who are similar in terms of the propensity score or by making raw comparisons within the entire sample
after reweighting the data based on the propensity score to account for confounding bias. These propensity score approaches are therefore less vulnerable to extrapolation than standard outcome regression
approaches to adjust for confounding [4, 8]. Such extrapolation in outcome models is likely to occur
when the exposed and unexposed individuals are very different in their confounder distributions. In that
case, empirical information about the exposure effect is largely lacking, so that estimation under standard
a Department of Applied Mathematics, Computer Science and Statistics, Ghent University, Gent, Belgium
b Centre for Statistical Methodology and Department of Medical Statistics, London School of Hygiene and

Copyright ¬© 2014 John Wiley & Sons, Ltd.

Statist. Med. 2014, 33 4053‚Äì4072

4053

Tropical Medicine,
London, U.K.
*Correspondence to: S. Vansteelandt, Department of Applied Mathematics, Computer Science and Statistics, Ghent University,
Krijgslaan 281 (S9), 9000 Gent, Belgium.
‚Ä† E-mail: stijn.vansteelandt@ugent.be

S. VANSTEELANDT AND R. M. DANIEL

outcome regression approaches will almost completely rely on extrapolation of the covariate-specific
outcome mean for the exposed to the observed covariate levels for the unexposed (and vice versa). This
is worrisome as misspecification of the outcome model is probable and difficult to diagnose in such settings. Corresponding bootstrap or normal theory standard error estimators do not express the ensuing
uncertainty because of model extrapolation.
Misspecification of the propensity score model is likewise a concern, but because propensity scores
merely quantify the frequency of exposure at each covariate level, they do not enable transporting estimated associations between exposure and outcome from the unexposed to the exposed subpopulations
(or vice versa) [8]. Lack of empirical information about the exposure effect therefore gets more explicitly
(and thus more honestly) expressed in empty propensity-score-strata, lack of good matches, highly variable inverse probability weights and more generally, propensity-score-based exposure effect estimates
with large standard errors.
The key property of propensity scores as summarising all confounders also justifies regression adjustment for the propensity score as a valid strategy for confounding adjustment [1, 2]. However, the benefits
of this method are less evident because it still involves modelling the outcome. This may be the predominant reason why regression adjustment for the propensity score has not become as popular as the
aforementioned propensity score methods, in spite of its simplicity. In this article, we develop novel
insights into this adjustment method. In particular, we demonstrate that standard tests of the null hypothesis of no exposure effect (based on robust variance estimators), as well as particular standardised effects
obtained from such adjusted regression models, are not vulnerable to the aforementioned extrapolation
bias of outcome-based regression approaches. Our results shed new light on the problem of how to infer
causal effects in the presence of strong confounding.

2. Regression adjustment for the propensity score
Let A denote a dichotomous exposure of interest, Y an outcome and C a set of baseline covariates. For
example, A may denote right heart catheterization, and Y 30-day mortality. To address causal questions,
we use the counterfactual framework [9, 10]. We let Ya denote the value of the outcome that would have
been observed had the exposure A been set, possibly contrary to fact, to level a. The propensity score
[1] is defined as the probability of receiving the exposure or treatment, given the baseline covariates C,
which we denote as p(C) ‚â° P(A = 1|C). It is usually obtained as the fitted value from a logistic regression
model for the exposure, which we will refer to as the propensity score model.
Throughout, we assume the technical consistency assumption, which is generally presupposed in the
causal inference literature and described elsewhere [11]. We moreover assume that treatment assignment
is ignorable [9] (i.e. that the covariate set C is sufficient to adjust for confounding of the effect of A on Y),
which can be technically formalised as that for all a,
Ya ‚üÇ‚üÇ A|C,

(1)

where V‚üÇ‚üÇW|Z for arbitrary random variables V, W and Z denotes that V is conditionally independent
of W, given Z. The central result of Rosenbaum and Rubin [1] is then that also the propensity score is
sufficient to adjust for confounding in the sense that
Ya ‚üÇ‚üÇ A|p(C).

(2)

This result justifies adjustment for confounding because of measured covariates C by including the
propensity score along with the exposure in a model for the outcome. The resulting approach is referred
to as regression adjustment for the propensity score [2] and will be the focus of this article.
Consider first linear regression adjustment for the propensity score. In particular, consider ordinary
least squares estimation in model
E {Y|a, p(c)} = ùúÉ0 + ùúÉ1 a + ùúÉ2 p(c),

(3)

4054

where E(V|w) for arbitrary random variables V and W is shorthand notation for E(V|W
{ = w). By }the
ignorability assumption (2), ùúÉ1 in model (3) equals the conditional exposure effect E Y1 ‚àí Y0 |p(c) if
the outcome model (3) is correctly specified. In that case,
} least squares estimator of ùúÉ1 is an
{ the ordinary
unbiased estimator of the conditional exposure effect E Y1 ‚àí Y0 |p(c) as well as the population-averaged
Copyright ¬© 2014 John Wiley & Sons, Ltd.

Statist. Med. 2014, 33 4053‚Äì4072

S. VANSTEELANDT AND R. M. DANIEL

)
(
effect E Y1 ‚àí Y0 . This continues to hold in large samples when the propensity score p(c) in model (3) is
replaced by the fitted value pÃÇ (c) under a correctly specified propensity score model. Suppose however that
the outcome model (3) is misspecified (e.g. that the dependence of the outcome on the propensity score is
in fact nonlinear). Then, interestingly, the ordinary least squares estimator of ùúÉ1 in model
( (3) (with
) pÃÇ (c) in
lieu of p(c)) continues to be an unbiased estimator of the population-averaged effect E Y1 ‚àí Y0 in large
samples when the propensity
score
{
} model is correctly specified and the exposure effect is homogenous
in the sense that E Y1 ‚àí Y0 |p(c) is the same at all levels of the propensity score (see Robins, Mark
and Newey [12]; see also the derivations in Appendix A.1). Under these conditions, the ordinary least
squares estimator of ùúÉ1 in model (3) does not necessitate correct specification of model (3) and is thus
not vulnerable to extrapolation under that model.
Unfortunately, the previous results do not extend to nonlinear models. For instance, in the logistic
regression model for a binary outcome,
{
}
P {Y = 1|a, p(c)} = expit ùúÉ0 + ùúÉ1 a + ùúÉ2 p(c) ,

(4)

we still have, by analogy, that exp(ùúÉ1 ) equals the conditional exposure effect
} {
}
{
P Y1 = 1|p(c) P Y0 = 0|p(c)
{
} {
}.
P Y1 = 0|p(c) P Y0 = 1|p(c)

(5)

However, because of noncollapsibility of the odds ratio [13,14], this generally differs from the conditional
exposure effect
(
) (
)
P Y1 = 1|c P Y0 = 0|c
(
) (
),
P Y1 = 0|c P Y0 = 1|c
which is the focus of standard regression adjustment approaches. Moreover, it generally differs from the
population-averaged exposure effect
(
) (
)
P Y1 = 1 P Y 0 = 0
(
) (
),
P Y1 = 0 P Y0 = 1
which is the focus of certain propensity score approaches based on stratification, matching or inverse
weighting. Furthermore, when the outcome model (4) is misspecified, the default maximum likelihood
estimator of ùúÉ1 in model (4) is generally a biased estimator of the conditional exposure effect (5), even
when the propensity score model is known. This raises doubts over the usefulness of regression adjustment for the propensity score in nonlinear models, as it appears to demand correct specification of two
models ‚Äì an outcome model as well as a propensity score model ‚Äì instead of one. In the following sections,
we will develop novel insights into this adjustment method. In particular, we will demonstrate that the
aforementioned properties of ordinary least squares adjustment for the propensity score carry over to testing of the null hypothesis of no exposure effects and to the estimation of particular standardised effect
measures in nonlinear models.

3. Testing the causal null hypothesis
(
)
We will first consider testing of the causal null hypothesis that E Y1 ‚àí Y0 |c = 0 for all covariate
subgroups c. Consider in particular the logistic regression model for the outcome Y given by
(
)
P (Y = 1|a, c) = expit ùõΩ0 + ùõΩ1 a + ùõΩ2‚Ä≤ c .

Copyright ¬© 2014 John Wiley & Sons, Ltd.

Statist. Med. 2014, 33 4053‚Äì4072

4055

)
(
Then, a test of the causal null hypothesis that E Y1 ‚àí Y0 |c = 0 for all covariate subgroups c amounts to
the default test that ùõΩ1 = 0. A limitation of this standard testing approach is that it may be severely liberal
or conservative when this model is misspecified. This limitation is also shared by direct standardisation
or so-called G-computation
(
) approaches [14‚Äì16] based on this model. These estimate the populationaveraged effect E Y1 ‚àí Y0 as

S. VANSTEELANDT AND R. M. DANIEL

(
)
(
)}
1 ‚àë{
expit ùõΩÃÇ0 + ùõΩÃÇ1 + ùõΩÃÇ2‚Ä≤ Ci ‚àí expit ùõΩÃÇ0 + ùõΩÃÇ2‚Ä≤ Ci ,
n i=1
n

where ùõΩÃÇ0 , ùõΩÃÇ1 and ùõΩÃÇ2 are the maximum likelihood estimates of ùõΩ0 , ùõΩ1 and ùõΩ2 , and next evaluate whether
this differs systematically from zero.
In Appendix A.2, we show that this limitation of traditional regression approaches is not shared by
standard testing approaches that employ regression adjustment for the propensity score in a canonical
generalised linear model (e.g. linear, loglinear and logistic models), for example, by standard tests of
ùúÉ1 = 0 in model (4). In particular, we show that tests of the null hypothesis of no exposure effect in
such generalised linear models that adjust for the propensity score and are based on a robust variance
estimator do not falsely reject the null hypothesis more than ùõº100% of the time in large samples (with
ùõº the nominal significance level) when the propensity score model is correctly specified, even when the
outcome regression model is misspecified. They may however be mildly conservative when the outcome
model is misspecified. This can be remedied by adjusting for the uncertainty in the estimated propensity
score, as shown in Appendix A.2.
If the propensity score model is misspecified, then in general, adjustment for the estimated propensity
score will no longer suffice to control for confounding. This can be remedied by including the confounders
along with the propensity score in the outcome model, for example, by fitting model
{
}
P (Y = 1|a, c) = expit ùúÉ0 + ùúÉ1 a + ùúÉ2 p(c) + ùúÉ3‚Ä≤ c .
(
Indeed, when
the
outcome
model
is
correctly
specified
in
the
sense
that
P
=
1|a,
c)
=
expit
ùúÉ0
(Y
)
‚Ä≤
+ùúÉ1 a + ùúÉ3 c , then ùúÉ2 = 0, and thus, the choice of propensity score model does not affect the validity of
tests of the causal null hypothesis. In Appendix A.2, we show that the inclusion of covariates in the model,
alongside the propensity score, only minimally affects the precision of the estimator of ùúÉ1 when in truth
ùúÉ1 = 0 and the propensity score model is correctly specified. The inclusion of additional covariates may
however negatively impact precision when ùúÉ1 ‚â† 0 [17]; this is partly related to the fact that the adjustment also changes the meaning and magnitude of the exposure effect (Section 2). Simulation studies in
Section 6(will investigate
to what extent this adjustment also affects the precision of population-averaged
)
effects E Y1 ‚àí Y0 estimated as
(
)
(
)}
1 ‚àë{
expit ùúÉÃÇ0 + ùúÉÃÇ1 + ùúÉÃÇ2 p(Ci ) + ùúÉÃÇ3‚Ä≤ Ci ‚àí expit ùúÉÃÇ0 + ùúÉÃÇ2 p(Ci ) + ùúÉÃÇ3‚Ä≤ Ci ,
n i=1
n

(6)

where ùúÉÃÇ0 , ùúÉÃÇ1 , ùúÉÃÇ2 and ùúÉÃÇ3 are the maximum likelihood estimates of ùúÉ0 , ùúÉ1 , ùúÉ2 and ùúÉ3 .

4. Optimally weighted average exposure effects
The results of the previous section demonstrate that regression adjustment for the propensity score
insulates tests of the causal null hypothesis against misspecification of the outcome regression model,
provided that the propensity score is correctly modelled. However, this leaves unanswered the question of whether this robustness extends to certain effect size measures. As previously suggested, it does
not extend to the exposure effect in the propensity score adjusted regression model itself, for example, to the parameter ùúÉ1 in model (4). Likewise, it does not extend to the directly standardised exposure
effect obtained from such regression model, for example, to the population-averaged effect (6). In this
section, we demonstrate that it does extend to certain otherwise standardised causal effect measures on
the difference and ratio scale.
Consider the weighted exposure effect
{
}
E w(C)(Y1 ‚àí Y0 ) ,

(7)

where w(C) is the standardised weight

4056

w(C) =

Copyright ¬© 2014 John Wiley & Sons, Ltd.

p(C) {1 ‚àí p(C)}
[
].
E p(C) {1 ‚àí p(C)}

Statist. Med. 2014, 33 4053‚Äì4072

S. VANSTEELANDT AND R. M. DANIEL

This expresses the effect that would be realised in a randomised experiment in which participating individuals were randomly selected from the population with probability proportional to p(C) {1 ‚àí p(C)}.
Individuals who, on the basis of their covariate data, are equally likely to be administered treatment or
control in standard practice are thus most likely included in the study. Individuals who, on the basis of
their covariate data, are unlikely to be administered experimental or control treatment are unlikely to be
included in the study. Although in practice, such formal selection probabilities are not used to recruit
participants into an experiment (e.g. a clinical trial), note that the low and high propensity strata are composed of individuals for whom most physicians would regard either experimental or control treatment
inappropriate, and such individuals would only rarely be included in an experiment [18]. In observational
studies with strong confounding,
exposure effect (7) may therefore succeed better than the
)
( the weighted
population-averaged effect E Y1 ‚àí Y0 to reflect the effect that would be attained in a typical clinical
trial population.
The weight w(C) can be viewed as being proportional to the amount of overlap between exposed and
unexposed subjects. The data will thus in particular carry more information about the weighted effect (7)
than about the population-averaged effect E(Y1 ‚àí Y0 ) because information about the latter is weak when
there is little overlap between exposed and unexposed individuals. This is formalised{in Theorem 5.4
}
and Corollary 5.2 by Crump et al. [19], who show that of all estimands of the form E w(C)(Y1 ‚àí Y0 )
for non-negative functions w(C), the optimal one (in the sense of having the smallest semi-parametric
efficiency bound) is the one considered earlier, whenever the conditional outcome variance (given A
and C) is constant. Crump et al. [19] thus refer to the estimand (7) as an optimally weighted average
treatment effect.
When the outcome is dichotomous, the optimally weighted average exposure effect (7) can easily be
estimated by fitting the propensity score adjusted model (4) and then calculating
n
‚àë
i=1

{
}
pÃÇ (Ci ) 1 ‚àí pÃÇ (Ci )
{
(
)
(
)}
{
} expit ùúÉÃÇ0 + ùúÉÃÇ1 + ùúÉÃÇ2 pÃÇ (Ci ) ‚àí expit ùúÉÃÇ0 + ùúÉÃÇ2 pÃÇ (Ci ) .
‚àën
ÃÇ (Ci ) 1 ‚àí pÃÇ (Ci )
i=1 p

(8)

In Appendix A.3, we show that the resulting estimator has the attractive property of being unbiased
in large samples when the propensity score model is correctly specified, even if the outcome model
(4) is incorrect. This property extends to arbitrary canonical generalised linear models for the outcome
that minimally include the exposure and propensity score, possibly along with other covariates, but not
to other choices of weights in (7). We conclude that the estimator (8) shields the user from making
extrapolation under the outcome regression model (4). It does that in two ways: once via its robustness
against misspecification of the outcome model and once via the choice of weights w(C), which accentuate
parts of the data space where there is more information about the exposure effect.
Consider now the weighted exposure effect on the ratio scale:
}
{
E w(C)Y1
}.
{
E w(C)Y0

(9)

When the outcome is dichotomous, this effect can be estimated by fitting the propensity score adjusted
model (4) and then calculating
‚àën

{

}

(

ÃÇ

ÃÇ

ÃÇ

ÃÇ (Ci ) 1 ‚àí pÃÇ (Ci ) expit ùúÉ0 + ùúÉ1 + ùúÉ2 pÃÇ (Ci )
i=1 p
{
}
(
)
‚àën
ÃÇ (Ci ) 1 ‚àí pÃÇ (Ci ) expit ùúÉÃÇ0 + ùúÉÃÇ2 pÃÇ (Ci )
i=1 p

)
.

This estimator is no longer guaranteed to be unbiased when the outcome model (4) is misspecified, even
when the propensity score model is correct. In Appendix A.4, we show that this can be remedied by
including an exposure by propensity score interaction in the outcome model. In particular, consider the
propensity score adjusted model

Copyright ¬© 2014 John Wiley & Sons, Ltd.

(10)

Statist. Med. 2014, 33 4053‚Äì4072

4057

}
{
P {Y = 1|a, p(c)} = expit ùúÉ0 + ùúÉ1 a + ùúÉ2 p(c) + ùúÉ3 ap(c) ,

S. VANSTEELANDT AND R. M. DANIEL

and let ùúÉÃÇ0 , ùúÉÃÇ1 , ùúÉÃÇ2 and ùúÉÃÇ3 be the maximum likelihood estimates of ùúÉ0 , ùúÉ1 , ùúÉ2 and ùúÉ3 in this model with p(c)
substituted by pÃÇ (c). It then follows from the results in Appendix A.4 that the estimator
‚àën
i=1

{
}
(
)
pÃÇ (Ci ) 1 ‚àí pÃÇ (Ci ) expit ùúÉÃÇ0 + ùúÉÃÇ1 + (ùúÉÃÇ2 + ùúÉÃÇ3 )ÃÇp(Ci )
{
}
(
)
‚àën
ÃÇ (Ci ) 1 ‚àí pÃÇ (Ci ) expit ùúÉÃÇ0 + ùúÉÃÇ2 pÃÇ (Ci )
i=1 p

(11)

is unbiased in large samples when the propensity score model is correct, even if the outcome model (4)
is incorrect.
Confidence intervals for estimators (8) and (11) can be based on the bootstrap or sandwich standard
error estimators (see the Web Appendix for details). In the following section, we study the efficiency of
these estimators.

5. Efficient estimation of (optimally) weighted average exposure effects
It can be shown that, up to asymptotic equivalence, all estimators that are consistent for the optimally
weighted average exposure effect (7) when the propensity score model is correctly specified can be
obtained as the solution to
0=

n
‚àë
{

Ai ‚àí pÃÇ (Ci )

}{

}
{
}
Yi ‚àí ùúô(Ci ) ‚àí ùúì pÃÇ (Ci ) 1 ‚àí pÃÇ (Ci )

(12)

i=1

for some scalar function ùúô(C). For instance, the estimator given in (8) is obtained by choosing
)
(
)
(
ùúô(C) = {1 ‚àí pÃÇ (C)} expit ùúÉÃÇ0 + ùúÉÃÇ1 + ùúÉÃÇ2 p(C) + pÃÇ (C)expit ùúÉÃÇ0 + ùúÉÃÇ2 p(C) ;

(13)

}
}
(
‚àën {
‚àë {
ÃÇ (Ci ) expit ùúÉÃÇ0 + ùúÉÃÇ1 Ai
this can )be verified upon noting that ni=1 Ai ‚àí pÃÇ (Ci ) Yi =
i=1 Ai ‚àí p
+ùúÉÃÇ2 pÃÇ (Ci ) . The efficient estimator within this class of estimators that solves (12) for arbitrary ùúô(C) is
obtained upon choosing
ùúô(C) = {1 ‚àí p(C)} E(Y|A = 1, C) + p(C)E(Y|A = 0, C).

(14)

This can be seen upon noting that this expression for ùúô(C) equals the population least squares projection
of {A ‚àí p(C)} Y ‚àí ùúìp(C) {1 ‚àí p(C)} onto A ‚àí p(C) (given C).
Calculating the efficient score requires substituting p(C) and E(Y|A, C) in (14) by their fitted values
ÃÇ
pÃÇ (C) and E(Y|A,
C) under suitable models. The efficiency is therefore local: it is only attained under
a correctly specified propensity score model, when also the model for the outcome mean E(Y|A, C) is
correct. Upon plugging the expression (14) for ùúô(C) into (12), it is seen that the efficient estimator of the
optimally weighted average exposure effect (7) equals
‚àën {
i=1

}{
} ‚àën {
}
{
}
ÃÇ
ÃÇ
ÃÇ
Ai ‚àí pÃÇ (Ci ) Yi ‚àí E(Y|A
ÃÇ (Ci ) pÃÇ (Ci ) E(Y|A
i , Ci )
i = 1, Ci ) ‚àí E(Y|Ai = 0, Ci )
i=1 1 ‚àí p
+
.
{
}
{
}
‚àën
‚àën
ÃÇ (Ci ) 1 ‚àí pÃÇ (Ci )
ÃÇ (Ci ) 1 ‚àí pÃÇ (Ci )
i=1 p
i=1 p
(15)

An efficient estimator may alternatively be obtained by calculating (8) based on an outcome model that
includes all covariates in addition to the exposure and propensity score; this can be understood upon
contrasting (13) and (14).
By construction, the efficient estimator given in (15) is an unbiased estimator of the optimally weighted
average exposure effect (7) (in large samples) when the propensity score model is correctly specified.
When the propensity score model is misspecified, then as the sample size increases, the estimated propensity scores pÃÇ (C) converge to some value pÃÉ (C) that may differ from the actual propensity score. When the
outcome model for E(Y|A, C) is correctly specified, then it is readily seen from expression (15) for the
efficient estimator that it converges to

4058

]
[
E pÃÉ (C) {1 ‚àí pÃÉ (C)} (Y1 ‚àí Y0 )
.
[
]
E pÃÉ (C) {1 ‚àí pÃÉ (C)}
Copyright ¬© 2014 John Wiley & Sons, Ltd.

(16)

Statist. Med. 2014, 33 4053‚Äì4072

S. VANSTEELANDT AND R. M. DANIEL

It thus continues to be an unbiased estimator (in large samples) of a weighted average exposure effect,
although based on different weights than those given in (7). In particular, it retains a causal interpretation
when the propensity score model is misspecified, provided that the outcome model is correctly specified;
this is not the case for the estimator (8), by not relying on a separate outcome model.
A similar reasoning as in the previous paragraph shows that, up to{ asymptotic
} equivalence,
{
} all estimators that are consistent for the weighted average exposure effect E w(C)Y1 ‚àïE w(C)Y0 when the
propensity score model is correctly specified can be obtained as the solution to:

0=

n
‚àë

}
{
}
{
Ai 1 ‚àí pÃÇ (Ci ) Yi ‚àí (1 ‚àí Ai )ÃÇp(Ci )ùúìYi ‚àí ùúô(Ci ) Ai ‚àí pÃÇ (Ci )

i=1

for some scalar function ùúô(C). The (locally) efficient estimator in this class is given by
} {
} {
}
‚àën {
ÃÇ i |Ai = 1, Ci ) + 1 ‚àí pÃÇ (Ci ) pÃÇ (Ci )E(Y
ÃÇ i |Ai = 1, Ci )
ÃÇ (Ci ) Ai Yi ‚àí E(Y
i=1 1 ‚àí p
.
{
} {
}
)
‚àën (
ÃÇ i |Ai = 0, Ci ) + 1 ‚àí pÃÇ (Ci ) pÃÇ (Ci )E(Y
ÃÇ i |Ai = 0, Ci )
)
Y
‚àí
E(Y
1
‚àí
A
p
ÃÇ
(C
i
i
i
i=1
An efficient estimator may alternatively be obtained by calculating (11) based on an outcome model that
includes all covariates in addition to the exposure, propensity score and their interaction. It is an unbiased
estimator (in large samples) for the weighted average exposure effect
[
]
E pÃÉ (C) {1 ‚àí pÃÉ (C)} Y1
[
]
E pÃÉ (C) {1 ‚àí pÃÉ (C)} Y0
when the propensity score model is correct (in which case, it coincides with (9)) or when the outcome
model is correctly specified.

6. Simulation study
6.1. Design
In each simulation scenario, we simulate 1000 datasets, each of size n, following a data-generating
mechanism that slightly generalises that in St√ºrmer et al. [20] by evaluating the impact of model misspecification. The simulation is carried out in two stages. In the first stage, six independent confounders
C1 ‚ÄìC6 are simulated: C1 ‚ÄìC3 are Bernoulli random variables each with mean 0.2 and C4 ‚ÄìC6 are each standard normal. The so-called intended treatment variable, T, is then simulated from a Bernoulli distribution
with mean
(
)
P T = 1 ||C1 , ‚Ä¶ , C6 = expit(ùõº0 + ùõº1 C1 + ¬∑ ¬∑ ¬∑ + ùõº6 C6 + ùõº16 C1 C6 ).
Then, in the second stage, two further binary covariates C7 and C8 are generated. C7 is most likely
to
(= 1) when
)}the intended treatment T is least likely; it is set to 1 with probability
{ be present
(
ùõæ ‚àí P T = 1 ||C1 , ‚Ä¶ , C6 . C8 is{likely
( to be present (=
) 1) }when the intended treatment T is most
likely; it is set to 1 with probability P T = 1 ||C1 , ‚Ä¶ , C6 ‚àí ùõø . The values of ùõæ and ùõø are chosen such
that the prevalence of C7 and C8 is close to 0.1. The actual treatment A is then simulated from a Bernoulli
distribution with mean
)
(
P A = 1 ||C1 , ‚Ä¶ , C8 = expit(ùõº0 + ùõº1 C1 ¬∑ ¬∑ ¬∑ + ùõº8 C8 + ùõº16 C1 C6 ).
Finally, given C1 ‚ÄìC8 and A, the outcome Y is simulated from a Bernoulli distribution with mean

ùõΩ0 is chosen such that the prevalence of Y in each scenario is about 0.1.
Copyright ¬© 2014 John Wiley & Sons, Ltd.

Statist. Med. 2014, 33 4053‚Äì4072

4059

(
)
P Y = 1 ||C1 , ‚Ä¶ , C8 , A = expit(ùõΩ0 + ùõΩ1 C1 ¬∑ ¬∑ ¬∑ + ùõΩ8 C8 + ùõΩ16 C1 C6 + ùõΩA A);

S. VANSTEELANDT AND R. M. DANIEL

Figure 1. Simulation study: propensity score distribution for exposed (red) and unexposed (black) individuals;
dashed for good overlap and solid for poor overlap.

Different scenarios are considered by varying n, the ùõº‚Äôs and the ùõΩ‚Äôs (see Tables 1 and 2 in the Supporting
information). We look at the impact of good/poor overlap by varying the ùõº‚Äôs (Table 1 in the Supporting
information, and Figure 1), we vary the magnitude of ùõΩA , from null to weak to strong (Table 2 in the
Supporting information) and we change n from 100 to 1000, to look at the effect of sample size.
A logistic regression model for A given C1 ‚ÄìC8 is fitted for the propensity score. This model is either
correctly specified by including all main effects of C1 ‚ÄìC8 along with a product term C1 C6 or incorrectly
specified by omitting the product term. A logistic regression model is also fitted for the outcome Y, with
A as an independent variable, in addition to C1 ‚ÄìC8 (‚ÄòCov-adj‚Äô), the propensity score (‚ÄúPS-adj‚Äù) or both
C1 ‚ÄìC8 and the propensity score (‚ÄòCov-and-PS-adj‚Äô). When adjusting for C1 ‚ÄìC8 , the product term C1 C6
is either included or omitted, to look at the effect of incorrectly specifying this model. When estimating a
risk ratio, the interaction between A and the propensity score is additionally included when adjusting for
the propensity score. From each of these outcome models, we predict Y1 and Y0 for each subject, which
are then averaged, and four estimators formed: the marginal (population-averaged) risk difference/ratio
and the (optimally) weighted risk difference/ratio, as defined in Section 4.
We also consider inverse probability weighted estimators obtained by fitting a logistic regression model
for the outcome that includes only the exposure (‚ÄòIPW‚Äô) or the exposure along with covariates C1 ‚ÄìC8
and the product term C1 C6 (‚ÄòCov-adj IPW‚Äô). In both cases, we weigh each subject i‚Äôs contribution to
the estimation by Ai ‚àïÃÇp(Ci ) + (1 ‚àí Ai )‚àï{1 ‚àí pÃÇ (Ci )} based on either the correctly specified or incorrectly
specified propensity score model. Because of the anticipated poor performance of the methods based on
inverse weighting in the presence of extreme weights, we include two further estimators, (‚ÄòIPW (Pet)‚Äô
and ‚ÄòCov-adj IPW (Pet)‚Äô) which are the same as ‚ÄòIPW‚Äô and ‚ÄòCov-adj IPW‚Äô, respectively, except that the
weights are truncated at the 2.5th and 97.5th percentiles, as suggested by Petersen et al. [21].
6.2. Results
The results are displayed in Tables I‚ÄìIII, Figures 2‚Äì4, together with Tables 3‚Äì9 in the Supporting
information, and confirm what the theory set out in this paper suggests, as we now discuss.

4060

6.2.1. Testing the causal null hypothesis. Evaluation of type I error rates and power is based on Wald
tests using robust standard errors, ignoring that the propensity score is estimated. We find that adjustment
for the propensity score leads to valid tests of the null hypothesis (Table I). Looking at the first and fourth
Copyright ¬© 2014 John Wiley & Sons, Ltd.

Statist. Med. 2014, 33 4053‚Äì4072

S. VANSTEELANDT AND R. M. DANIEL

Table I. Simulation results: tests of the null hypothesis.
Both correct

PS incorrect

Cov incorrect

Both incorrect

Proportion of H0 rejected at 5%
Method
Cov-adj
PS-adj
Cov-and-PS-adj
IPW
Cov-adj IPW
Cov-adj
PS-adj
Cov-and-PS-adj
IPW
Cov-adj IPW
Cov-adj
PS-adj
Cov-and-PS-adj
IPW
Cov-adj IPW
Cov-adj
PS-adj
Cov-and-PS-adj
IPW
Cov-adj IPW
Cov-adj
PS-adj
Cov-and-PS-adj
IPW
Cov-adj IPW
Cov-adj
PS-adj
Cov-and-PS-adj
IPW
Cov-adj IPW

Overlap

Good

Good

Good

Poor

Poor

Poor

Causal

n = 100

1000

100

1000

100

1000

100

1000

Null

0.063
0.044
0.066
0.050
0.093

0.051
0.049
0.052
0.046
0.054

0.063
0.044
0.068
0.047
0.077

0.051
0.182
0.051
0.193
0.050

0.062
0.044
0.068
0.050
0.075

0.197
0.049
0.052
0.046
0.057

0.062
0.044
0.074
0.047
0.074

0.197
0.182
0.182
0.193
0.212

Weak

0.067
0.034
0.075
0.050
0.082

0.341
0.312
0.340
0.290
0.338

0.067
0.052
0.064
0.078
0.074

0.341
0.756
0.340
0.746
0.349

0.085
0.034
0.072
0.050
0.080

0.774
0.312
0.337
0.290
0.333

0.085
0.052
0.079
0.078
0.110

0.774
0.756
0.752
0.746
0.782

Strong

0.151
0.101
0.153
0.148
0.179

0.987
0.979
0.986
0.951
0.978

0.151
0.176
0.153
0.205
0.167

0.987
1.000
0.985
0.998
0.980

0.223
0.101
0.143
0.148
0.189

1.000
0.979
0.984
0.951
0.970

0.223
0.176
0.220
0.205
0.248

1.000
1.000
1.000
0.998
1.000

Null

0.056
0.058
0.083
0.104
0.142

0.050
0.035
0.043
0.106
0.109

0.056
0.054
0.081
0.129
0.125

0.050
0.087
0.039
0.228
0.100

0.064
0.058
0.085
0.104
0.142

0.127
0.035
0.045
0.106
0.116

0.064
0.054
0.088
0.129
0.153

0.127
0.087
0.106
0.228
0.256

Weak

0.073
0.063
0.095
0.133
0.155

0.292
0.242
0.264
0.329
0.302

0.073
0.068
0.089
0.159
0.139

0.292
0.464
0.273
0.566
0.307

0.080
0.063
0.086
0.133
0.166

0.592
0.242
0.254
0.329
0.314

0.080
0.068
0.103
0.159
0.182

0.592
0.464
0.485
0.566
0.563

Strong

0.126
0.085
0.125
0.239
0.204

0.923
0.868
0.896
0.753
0.783

0.126
0.128
0.124
0.294
0.195

0.923
0.978
0.900
0.883
0.787

0.160
0.085
0.118
0.239
0.223

0.989
0.868
0.885
0.753
0.772

0.160
0.128
0.150
0.294
0.249

0.989
0.978
0.972
0.883
0.910

‚ÄòBoth correct‚Äô indicates that both the model for the propensity score and for the outcome, if used, were correctly
specified. ‚ÄòPS incorrect‚Äô refers to the situation in which only the propensity score model is misspecified, ‚ÄòCov incorrect‚Äô to the situation in which only the outcome model is misspecified and ‚ÄòBoth incorrect‚Äô to the situation in which
both models are misspecified.

Copyright ¬© 2014 John Wiley & Sons, Ltd.

Statist. Med. 2014, 33 4053‚Äì4072

4061

sixths of this table (where the causal effect is null), we would expect all methods, in the absence of
model misspecification, to give tests that reject the null hypothesis in around 5% of simulated datasets.
Note, however, that when the overlap is poor, the weights in the inverse weighting approach become
extreme so that the two tests based on inverse weighting have a poor performance, even with a sample
size of 1000. Propensity score adjustment, on the other hand, does not suffer from this problem. Using
the truncated weights suggested by Petersen et al. (see Table 5 in the Supporting information) improves
the performance of inverse weighting slightly but not fully; this is likely due to a bias‚Äìvariance trade-off
discussed later.
Because we ignored the estimation of the propensity score in the estimation of the standard errors in
which these tests were based, we would expect the estimated standard errors to be slightly too large and
thus that the tests would be slightly conservative. This is seen in most but not quite all settings that rely
on the propensity score. For example, for the small sample size and when the overlap is poor, propensity
score adjustment rejects the null in 5.8% of simulations. Closer inspection (not reported here) reveals

S. VANSTEELANDT AND R. M. DANIEL

Table II. Simulation results: estimation of risk differences (given as percentages), n = 100.
Both correct
Estimand

Estimator

Causal True
Overlap effect value

Actual
SE

7.751 ‚àí0.476 7.751
1.682 7.437
6.679
1.673 6.406 ‚àí0.342 6.679
7.818 ‚àí0.502 7.626 ‚àí0.523 7.794
7.136
1.912 6.658 ‚àí0.108 7.136
8.211 ‚àí0.581 7.980
0.042 7.913

1.682
1.673
1.394
1.912
1.651

7.437
6.406
7.315
6.658
7.649

1.670
1.669
1.398

7.428
6.418
7.415

7.662 ‚àí0.280 7.662
1.750 7.381
6.420
1.354 6.294 ‚àí0.627 6.420
7.609 ‚àí0.521 7.146 ‚àí0.445 7.544
6.582
1.360 6.417 ‚àí0.402 6.582
7.878 ‚àí0.354 7.765
0.104 7.763

1.750
1.354
1.288
1.360
1.660

7.381
6.294
7.087
6.417
7.593

3.201 ‚àí0.400 7.610 ‚àí0.461 7.685
1.634 7.352
or ‚àí0.690 6.390
1.284 6.291 ‚àí0.756 6.390
3.266 ‚àí0.580 7.603 ‚àí0.608 7.296 ‚àí0.537 7.527

1.575
1.218
1.203

7.352
6.291
7.120

7.481 ‚àí0.292 7.481
1.585 7.619
6.445
0.481 6.652 ‚àí1.291 6.445
7.408 ‚àí0.914 7.230 ‚àí0.821 7.145
6.865
0.398 6.864 ‚àí1.357 6.865
7.704 ‚àí0.463 7.583 ‚àí0.063 7.590

1.585
0.481
0.723
0.398
1.422

7.619
6.652
7.405
6.864
7.790

7.983 ‚àí0.591 7.395 ‚àí0.684 7.485
1.307 7.561
or ‚àí1.506 6.457
0.309 6.666 ‚àí1.661 6.457
8.138 ‚àí0.839 7.366 ‚àí1.163 7.291 ‚àí1.018 7.122

1.147
0.154
0.467

7.557
6.666
7.449

9.591 ‚àí0.568 9.591
1.373 9.684
9.409
1.182 9.182 ‚àí0.690 9.409
10.903 ‚àí0.716 10.495 ‚àí0.703 10.524
10.866 2.885 11.008 1.136 10.866
11.583 ‚àí0.379 11.272 0.199 11.738

1.373 9.684
1.182 9.182
1.039 10.648
2.885 11.008
1.487 11.550
1.375 9.458
1.265 8.787
1.085 10.313

Bias

Cov-adj
PS-adj
Marginal Cov-and-PS-adj
IPW
Cov-adj IPW

Good

Null

‚àí0.476
‚àí0.342
0.000 ‚àí0.559
‚àí0.108
‚àí0.602

Cov-adj
PS-adj
Cov-and-PS-adj

Good

Null

‚àí0.473 7.714 ‚àí0.495 7.803
1.655 7.433
0.000 ‚àí0.315 6.641
1.669 6.418 ‚àí0.315 6.641
‚àí0.576 7.838 ‚àí0.521 7.717 ‚àí0.523 7.789

Cov-adj
PS-adj
Marginal Cov-and-PS-adj
IPW
Cov-adj IPW

Good

‚àí0.280
‚àí0.627
Weak 3.117 ‚àí0.490
‚àí0.402
‚àí0.383

Cov-adj
PS-adj
Cov-and-PS-adj

Good

Weak

Cov-adj
PS-adj
Marginal Cov-and-PS-adj
IPW
Cov-adj IPW

Good

‚àí0.292
‚àí1.291
Strong 7.777 ‚àí0.665
‚àí1.357
‚àí0.566

Cov-adj
PS-adj
Cov-and-PS-adj

Good

Strong

Opt-W

Opt-W

Opt-W

Cov-adj
PS-adj
Marginal Cov-and-PS-adj
IPW
Cov-adj IPW

Poor

Null

‚àí0.568
‚àí0.690
0.000 ‚àí0.674
1.136
‚àí0.397

Cov-adj
PS-adj
Cov-and-PS-adj

Poor

Null

‚àí0.563 9.523 ‚àí0.560 9.557
1.342 9.510
0.000 ‚àí0.498 8.948
1.265 8.787 ‚àí0.498 8.948
‚àí0.546 10.596 ‚àí0.648 10.374 ‚àí0.646 10.180

Cov-adj
PS-adj
Marginal Cov-and-PS-adj
IPW
Cov-adj IPW

Poor

‚àí0.407
‚àí1.040
Weak 3.149 ‚àí0.651
0.214
‚àí1.020

Cov-adj
PS-adj
Cov-and-PS-adj

Poor

Weak

Cov-adj
PS-adj
Marginal Cov-and-PS-adj
IPW
Cov-adj IPW

Poor

‚àí1.380
‚àí2.175
Strong 7.849 ‚àí1.801
‚àí0.957
‚àí1.647

Cov-adj
PS-adj
Cov-and-PS-adj

Poor

Strong

Opt-W

Opt-W

Opt-W

Both incorrect
Bias

Bias

Actual
SE

Cov incorrect
Actual
SE

Bias

Actual
SE

PS incorrect

9.386 ‚àí0.407 9.386
1.646 9.422
9.219
0.653 9.051 ‚àí1.040 9.219
11.033 ‚àí0.670 10.840 ‚àí0.641 10.736
10.267 1.935 10.445 0.214 10.267
11.206 ‚àí0.959 10.914 ‚àí0.183 11.307

1.646 9.422
0.653 9.051
1.136 10.971
1.935 10.445
1.011 11.237

3.324 ‚àí0.504 9.319 ‚àí0.531 9.347
1.432 9.211
or ‚àí1.092 8.721
0.514 8.591 ‚àí1.117 8.721
3.349 ‚àí0.763 10.772 ‚àí0.790 10.630 ‚àí0.780 10.333

1.407 9.176
0.489 8.591
0.934 10.524

9.425
8.733
10.802
10.186
11.040

‚àí1.380
‚àí0.674
‚àí1.657
0.461
‚àí1.544

9.425
8.892
10.315
9.836
10.687

0.592
‚àí2.175
‚àí1.762
‚àí0.957
‚àí1.007

9.825
0.592 9.825
8.733 ‚àí0.674 8.892
10.659 0.002 10.740
10.186 0.461 9.836
11.217 0.139 11.225

8.286 ‚àí1.750 9.457 ‚àí1.751 9.505
0.025 9.736
0.002 9.762
or ‚àí2.583 8.365 ‚àí1.172 8.567 ‚àí2.641 8.365 ‚àí1.230 8.567
8.344 ‚àí2.029 10.480 ‚àí1.975 10.258 ‚àí2.130 10.157 ‚àí0.528 10.469

4062

‚ÄòOpt-W‚Äô stands for ‚Äòoptimally weighted‚Äô. The description of ‚ÄòBoth correct‚Äô, ‚ÄòPS incorrect‚Äô, ‚ÄòCov incorrect‚Äô and ‚ÄòBoth
incorrect‚Äô are as given in the caption of Table I. When the propensity score model is misspecified, the weights used to
define the optimally weighted estimand are different, leading to a different true value (except under the null); the first
true value given is for the setting in which the propensity score model is correctly specified, and the alternative applies
when the propensity score model is misspecified.

Copyright ¬© 2014 John Wiley & Sons, Ltd.

Statist. Med. 2014, 33 4053‚Äì4072

S. VANSTEELANDT AND R. M. DANIEL

Table III. Simulation results: estimation of risk differences (given as percentages), n = 1000.
Both correct
Estimand

Estimator

Causal True
Overlap effect value

Bias

Actual
SE

Bias

Actual
SE
Bias

Actual
SE

1.981
1.996
1.983
2.091
2.052

0.056
2.236
0.052
2.413
0.046

1.981
1.948
1.984
1.970
2.014

2.189
0.051
0.056
0.043
0.071

1.921
1.996
1.988
2.091
2.067

2.189
2.236
2.080
2.413
2.318

1.921
1.948
1.937
1.970
1.935

2.282 2.001 2.262
0.053 2.026 2.271
0.059 2.037 2.147

1.983
1.976
1.998

1.881 ‚àí0.060 1.881 2.022 1.871 2.022
1.919 2.107 1.904 ‚àí0.045 1.919 2.107
1.892 ‚àí0.062 1.887 ‚àí0.061 1.893 1.924
2.030 2.198 1.946 ‚àí0.047 2.030 2.198
1.981 ‚àí0.048 1.933 ‚àí0.014 2.003 2.140

1.871
1.904
1.892
1.946
1.904

3.201 ‚àí0.061 1.933 ‚àí0.064 1.969 2.170 1.953 2.054
or ‚àí0.080 1.949 2.111 1.931 ‚àí0.145 1.949 2.046
3.266 ‚àí0.072 1.944 ‚àí0.066 1.974 ‚àí0.064 1.944 1.945

1.934
1.931
1.952

Null 0.000

Cov-adj
PS-adj
Good
Cov-and-PS-adj

Null 0.000

0.060 2.031
0.053 2.026
0.058 2.034

Opt-W

Cov-adj
PS-adj
Good
Cov-and-PS-adj

‚àí0.060
‚àí0.045
Weak 3.117 ‚àí0.071
‚àí0.047
‚àí0.043
Weak

Cov-adj
PS-adj
Marginal Cov-and-PS-adj Good Strong 7.777
IPW
Cov-adj IPW
Opt-W

Both incorrect

Actual
SE

0.056
0.051
0.054
0.043
0.047

Cov-adj
PS-adj
Marginal Cov-and-PS-adj Good
IPW
Cov-adj IPW

Cov incorrect

Bias

Cov-adj
PS-adj
Marginal Cov-and-PS-adj Good
IPW
Cov-adj IPW
Opt-W

PS incorrect

Cov-adj
7.983
PS-adj
Good Strong or
Cov-and-PS-adj
8.138

0.043
0.105
0.043
0.016
0.034

1.854
1.907
1.868
2.022
1.935

0.058 2.073
2.271 1.976
0.053 2.075

1.991
2.130
1.916
2.109
2.038

1.853
1.904
1.882
1.905
1.863

0.035 1.914
0.016 1.939
0.035 1.928

0.041 1.933 2.206 1.924 1.960
2.083 1.924 ‚àí0.139 1.939 1.928
0.046 1.942 0.046 1.930 1.863

1.910
1.924
1.935

0.059
1.859
0.016
3.312
0.065

2.087
1.859
1.738
3.312
2.855

2.390
2.585
2.520
5.279
3.598

1.854
1.904
1.865
1.905
1.888

Cov-adj
PS-adj
Poor
Cov-and-PS-adj

Null 0.000

0.077 2.458
0.052 2.580
0.030 2.562

0.077 2.487
1.861 2.574
0.030 2.577

2.158 2.464 2.163
0.052 2.580 1.861
0.045 2.579 1.806

2.470
2.574
2.602

Weak 3.149

0.091
0.279
0.076
0.516
0.024

0.091
2.078
0.060
3.426
0.028

2.189
0.279
0.143
0.516
0.263

2.189
2.078
1.841
3.426
2.779

2.493
2.653
2.594
5.554
3.808

2.181 2.593 2.170
0.075 2.683 1.862
0.083 2.688 1.816

2.601
2.659
2.707

2.095
0.319
0.041
0.402
0.182

2.095
2.068
1.706
2.813
2.516

2.302
2.481
2.442
4.268
3.248

8.286 ‚àí0.120 2.383 ‚àí0.084 2.401 1.965 2.408 1.956
or ‚àí0.149 2.484 1.597 2.514 ‚àí0.207 2.484 1.539
8.344 ‚àí0.143 2.491 ‚àí0.119 2.508 ‚àí0.147 2.499 1.560

2.429
2.514
2.576

Opt-W

Cov-adj
PS-adj
Poor
Cov-and-PS-adj

Cov-adj
PS-adj
Marginal Cov-and-PS-adj Poor
IPW
Cov-adj IPW
Opt-W

Cov-adj
PS-adj
Poor
Cov-and-PS-adj

Weak

3.324
or
3.349

0.094 2.625
0.101 2.683
0.084 2.686

‚àí0.065
0.319
Strong 7.849 ‚àí0.095
0.402
‚àí0.046
Strong

2.473
2.653
2.519
5.554
3.493

0.104 2.650
1.887 2.659
0.076 2.701

2.220 ‚àí0.065 2.220
2.446 2.068 2.481
2.321 ‚àí0.105 2.321
3.731 2.813 4.268
3.123 ‚àí0.008 2.917

2.390
2.598
2.506
5.387
3.657

2.493
2.678
2.588
5.470
3.794

2.302
2.446
2.391
3.731
3.218

For a more detailed explanation, see the caption for Table II.

Copyright ¬© 2014 John Wiley & Sons, Ltd.

Statist. Med. 2014, 33 4053‚Äì4072

4063

Null 0.000

2.473
2.678
2.529
5.470
3.671

2.087
0.038
0.032
0.420
0.280

1.853
1.907
1.872
2.022
1.952

0.059
0.038
0.015
0.420
0.041

Cov-adj
PS-adj
Marginal Cov-and-PS-adj Poor
IPW
Cov-adj IPW

2.343
2.585
2.427
5.279
3.375

1.991
0.105
0.056
0.016
0.065

Cov-adj
PS-adj
Marginal Cov-and-PS-adj Poor
IPW
Cov-adj IPW
Opt-W

2.343
2.598
2.442
5.387
3.555

0.043
2.130
0.053
2.109
0.044

S. VANSTEELANDT AND R. M. DANIEL

Figure 2. Box plots for the estimated risk differences over 1000 simulations. Left: estimators of the marginal
effect; right: estimators of the optimally weighted average exposure effect. The simulation scenario depicted here
is for n = 1000, poor overlap and strong causal effect. The black horizontal lines denote the true effect. The outer
limits of each box denote the 25th and 75th percentiles, the white horizontal line inside the box denotes the median,
the outer whiskers denote the lower and upper adjacent values (defined to be a distance 1.5√óthe interquartile range
below and above the 25th and 75th percentile, respectively), and the crosses beyond the whiskers are considered
to be ‚Äòoutliers‚Äô. The description of ‚ÄòBoth correct‚Äô, ‚ÄòPS incorrect‚Äô, ‚ÄòCov incorrect‚Äô and ‚ÄòBoth incorrect‚Äô are as given
in the caption for Table I.

Figure 3. This is the same as the left-hand side of Figure 2, except that the Petersen et al. truncation has been
applied to the inverse probability weights in the fourth and fifth estimators. The legend is the same as for the
left-hand side of Figure 2.

Figure 4. Box plots for the estimated log risk ratios over 1000 simulations. Left: estimators of the marginal effect;
right: estimators of the weighted exposure effect. The simulation scenario depicted here is for n = 100, good
overlap and null causal effect. The legends are the same as for those in Figure 2.

4064

that the standard errors are indeed slightly overestimated even in this scenario; because the bias in the
effect estimates is also negligible, we conclude that the slightly liberal nature of the test in this case is a
consequence of the finite sample non-normality of the test statistic.
Copyright ¬© 2014 John Wiley & Sons, Ltd.

Statist. Med. 2014, 33 4053‚Äì4072

S. VANSTEELANDT AND R. M. DANIEL

Table I also shows that tests of the null hypothesis based on both covariate and propensity score adjustment are robust to misspecification of one or the other of the two models. Away from the null, we see some
increase in power from additionally adjusting for covariates in the outcome model, compared with only
adjusting for the propensity score, even when the outcome model is misspecified; this is more pronounced
at the lower sample size.
6.2.2. Estimating marginal and (optimally) weighted exposure effects. Figures 2 (showing results for the
risk difference at the larger sample size, with poor overlap and a strong causal effect) and 4 (showing
results for the log risk ratio at the smaller sample size, with good overlap and a null causal effect) are
chosen as examples of the performance of the various methods in estimating the marginal and (optimally)
weighted exposure effects. The graphs from all other scenarios showed a similar overall picture.
First, we note that the poor performance of the tests based on inverse weighting techniques when the
overlap is poor carries through also to effect estimation. These estimators are inefficient (see the lefthand side of Figure 2) and exhibit more finite sample bias than other methods, even at a sample size of
1000 (this is more pronounced for the log risk ratio: see Tables 3 and 4 in the Supporting information).
Figure 3 shows how the left-hand side of Figure 2 changes upon truncating the weights. We see that there
is a marked decrease in the variability of the IPW estimates, as we would expect; however, this comes at
the price of also introducing a marked (upward) bias.
Both Figures 2 and 4 demonstrate the robustness property of the estimator based on both covariate and
propensity score adjustment for the (optimally) weighted average exposure effect. Only in the final quadrant of the graph does the median of the 1000 estimates deviate appreciably from the truth. This property
appears to extend to the marginal effects, which is due to the lack of heterogeneity of the causal effect
at different levels of the propensity score in these simulations. In other simulations (not presented here),
with larger heterogeneity, the robustness against misspecification of the outcome model was (slightly)
lost for the marginal effects, although remained (as theory would suggest) for the (optimally) weighted
average exposure effects. In Figure 4, we see evidence of very slight gains in efficiency from additionally adjusting for the covariates in the outcome model, compared with only adjusting for the propensity
score, even when the outcome model is misspecified. However, Tables II and III and Tables 3 and 4 in
the Supporting information show that this is not universal over all scenarios and estimands.

7. Reanalysis of data on right heart catheterization

Copyright ¬© 2014 John Wiley & Sons, Ltd.

Statist. Med. 2014, 33 4053‚Äì4072

4065

We consider a reanalysis of observational data on right heart catheterization in hospitalised adult patients
at five medical centres in the U.S.A., to infer its effect on 30-day mortality [22]. Right heart catheterization
is a diagnostic procedure used for critically ill patients. Detailed information about the study and the
nature of the variables is given by Connors et al. [22], who found (based on propensity-score-matching)
that right heart catheterization leads to lower survival rates.
Of the 5735 individuals in the study, 2184 received right heart catheterization within 24 h of admission.
Of the latter, 38.0% died within 30 days from admission versus 30.6% of those who did not receive right
heart catheterization within 24 h of admission. These results are difficult to interpret because both treatment groups differ substantially in many covariates available upon admission. As in [23], we therefore
constructed a propensity score based on a logistic model that includes all 72 available baseline covariates. Logistic regression adjustment for the propensity score resulted in a conditional treatment effect
odds ratio of 1.30 (95% confidence interval 1.14 to 1.48), corresponding with a population risk difference
of 6.46% (SE 1.34%) based on direct standardisation (i.e. estimator (6)). The benefit of these analysis
results relative to standard logistic regression adjustment is questionable because they demand correct
specification of both the propensity score model and the logistic outcome model (except for testing the
null hypothesis of no treatment effect that, by the results of Section 3, is valid when solely the propensity
score is correctly specified). We therefore translated them to an optimally weighted average exposure
effect of 6.48% (SE 1.34%), based on estimator (8). Using a logistic outcome model that includes all 72
covariates along with interactions of the significant covariates (at the 5% significance level) with right
heart catheterization, we obtained a corresponding efficient estimate of 5.79% (SE 1.33%). These results
lie close the previously obtained estimate of the population-averaged effect. This is not surprising because
the shift of the propensity score distribution by weighting by w(C) is relatively mild (Figure 5), and moreover, there is no evidence of treatment effect heterogeneity by the propensity score (P 0.74). These results

0.0

0.5

1.0

Density

1.5

2.0

2.5

S. VANSTEELANDT AND R. M. DANIEL

0.0

0.2

0.4

0.6

0.8

1.0

Propensity score

Figure 5. Data analysis. Solid: propensity score distribution for treated (red) and untreated (black) patients;
dashed: (optimally) weighted propensity score distribution for treated (red) and untreated (black) patients (i.e.
after weighting by w(C)).

express that the effect of right heart catheterization in a patient population about which treating physicians are less confident whether or not to apply right heart catheterization is to increase 30-day mortality
risk with 5.79% (95% confidence interval 3.58% to 8.00%). For comparison, the inverse probability of
treatment weighted estimator of the population-averaged effect (5.85% (SE 1.67%)) and corresponding
double-robust estimator with calibration (5.34% (SE 1.56%)) (obtained using the R-package iWeigReg
[24]) and without calibration (5.26% (SE 1.50%)) are of similar magnitude.

8. Discussion

4066

We have shown that regression adjustment for the propensity score insulates standard tests of the causal
null hypothesis in canonical generalised linear models against misspecification of the outcome model
(provided that robust variance estimators are used). We have moreover shown that this robustness property extends to specific summaries, (7) and (9), of the effects obtained from these models, either on the
difference or ratio scale. To the best of our knowledge, these results do not extend to weighted odds ratio
estimators. We do not consider this to be disadvantageous in view of the more difficult interpretation of
odds ratios and the fact that the weighted average exposure effect estimators (8) and (11) can still be
based on logistic regression models to ensure that they respect the outcome range.
Our results on testing bear connections to recent findings by Rosenblum and van der Laan [25] that
for a surprisingly large class of commonly used regression models that adjust for auxiliary covariates in
randomised trials, standard hypothesis tests of no treatment effect are guaranteed to have correct type
I error in large samples, even when the models are incorrectly specified (provided that robust variance
estimators are utilised). Our results partially generalise these findings to observational data analysis based
on regression adjustment for the propensity score.
Copyright ¬© 2014 John Wiley & Sons, Ltd.

Statist. Med. 2014, 33 4053‚Äì4072

S. VANSTEELANDT AND R. M. DANIEL

The weighted average exposure effect estimators (8) and (11) based on regression adjustment for the
propensity score inherit the simplicity as well as the properties of other propensity score approaches. The
corresponding effect measures (7) and (9) differ, however, from those targeted by other propensity score
approaches. Like other weighted effect measures (e.g. Mantel‚ÄìHaenszel risk ratios), they reduce to the
population-averaged effects E(Y1 ‚àí Y0 ) and E(Y1 )‚àïE(Y0 ), respectively, when the effects are homogenous
across strata (in the sense that E(Y1 ‚àí Y0 |L) = ùúì and E(Y1 |L)‚àïE(Y0 |L) = ùúì, respectively, for some constant ùúì), but not otherwise. Without these homogeneity assumptions, the effect measures (7) and (9) may
be considered less attractive from an interpretational point of view, because they express the treatment
effect for a population different from the one under study. In particular, they express the treatment effect
for a population obtained by eliminating individuals from the study population, who, on the basis of their
covariate data, are nearly precluded from one of both treatment options. In a similar vein, Crump et al.
[26] report effects for subpopulations of individuals who are sufficiently likely to receive both treatment
options. With these authors [19, 26], we believe that the resulting effects may be of practical interest as
they refer to a population of individuals for whom there is sufficient ambiguity about the optimal treatment
option so as to render questions about treatment effects meaningful. In particular, the reweighted population may potentially be better resembling the typical clinical trial population, which excludes patients for
whom, on the basis of their covariate data, one of both treatment options is considered unsuitable [18].
We believe that the weighted average exposure effects (7) and (9) are specifically of interest in settings
with strong confounding. This is because they summarise the effects that prevail in those individuals
in which the data carry substantial information about the exposure effect. In contrast, in such settings,
population-averaged effects may sometimes attempt to answer a nearly irrelevant and overly ambitious
causal question: how the population average outcome would look if everyone were exposed versus not
exposed. That the data carry more information about the optimally weighted average exposure effects
(7) than about the population-averaged effect was formally demonstrated by Crump et al. [19] in terms
of a reduction of the semi-parametric efficiency bound; this reduction is especially pronounced in the
presence of strong confounding.
We conclude by expressing our hope that we have developed a greater understanding of the properties of regression adjustment for propensity score and that the availability of optimally weighted average
exposure effects that can be efficiently and robustly estimated sheds new light on the analysis of observational studies with strong confounding [27]. In future work, we will extend them to the analysis of
time-varying treatments.

Appendix A
A.1. Properties of linear regression adjustment for the propensity score
It follows from results in [12] that the ordinary least squares estimator of ùúÉ1 in model (3) is given by
‚àën {

i=1 Ai
‚àën {
i=1 Ai

}
‚àí E‚àó (Ai |p(Ci )) Yi
} ,
‚àí E‚àó (Ai |p(Ci )) Ai

where E‚àó (Ai |p(Ci )) is the fitted value from a (population) least squares regression of Ai on p(Ci ). That is,
E‚àó (Ai |p(Ci )) = ùõº0 + ùõº1 p(Ci ), with ùõº0 and ùõº1 the solution to the equations
{
}
0 = E Ai ‚àí ùõº0 ‚àí ùõº1 p(Ci )
{
}]
[
0 = E p(Ci ) Ai ‚àí ùõº0 ‚àí ùõº1 p(Ci ) .
It is readily verified that when the propensity score is correctly specified, the solution to this system of
equations is given by ùõº0 = 0 and ùõº1 = 1, so that E‚àó (Ai |p(Ci )) = p(Ci ). It thus follows that the ordinary
least squares estimator of ùúÉ1 in model (3) is given by
i=1 Ai
‚àën {
i=1 Ai

Copyright ¬© 2014 John Wiley & Sons, Ltd.

}
‚àí p(Ci ) Yi
} .
‚àí p(Ci ) Ai

4067

‚àën {

Statist. Med. 2014, 33 4053‚Äì4072

S. VANSTEELANDT AND R. M. DANIEL

{
}
If E Y1 ‚àí{Y0 |p(Ci ) is a constant,
}
{ ùúì, then it follows
} from the no unmeasured confounders Assumption
(2) that E Y|A = 1, p(Ci ) ‚àí E Y|A = 0, p(Ci ) = ùúì and thus the conditional mean of the previous
estimator, given the exposures and propensity scores for all individuals, equals
} {
}
‚àën {
i=1 Ai ‚àí p(Ci ) E Y|Ai = 0, p(Ci )
+ ùúì.
}
‚àën {
i=1 Ai ‚àí p(Ci ) Ai
The numerator{of the first term} in the previous expression has mean zero, regardless of what is the true
expectation E Y|A = 0, p(Ci ) , because of its multiplication by the mean zero residual Ai ‚àí p(Ci ). One
can deduce from
{ this that the}ordinary least squares estimator of ùúÉ1 in model (3) is a consistent estimator
of ùúì when E Y1 ‚àí Y0 |p(Ci ) is constant and the propensity score is correctly specified, even when the
outcome model (3) is misspecified.
A.2. Testing the causal null hypothesis
Suppose that the propensity score model is correctly specified so that P(A = 1|c) = p(c). Let furthermore
E(Y|A, C) = m(A, C; ùúÉ ‚àó ), where m(A, C; ùúÉ) is the fitted value from a canonical generalised linear model
with intercept and main effects in A and p(C). In particular, m(A, C; ùúÉ) is thus a known function, smooth
in ùúÉ and ùúÉ ‚àó is an unknown finite-dimensional parameter; for example m(A, C; ùúÉ) = expit(ùúÉ0 + ùúÉ1 A + ùúÉ2‚Ä≤ C).
Let ùúÉ1 be the exposure effect (i.e. the coefficient of A).
Suppose first that the propensity score is known. The score equations for ùúÉ in model (4) are

0=

n ‚éõ 1 ‚éû
(
)}
{
1 ‚àë‚éú
Ai ‚éü Yi ‚àí m Ai , Ci ; ùúÉÃÇ .
n i=1 ‚éú p(C ) ‚éü
‚éù
i ‚é†

(A.1)

It can be deduced from this that in large samples, the maximum likelihood estimator ùúÉÃÇ1 for ùúÉ1 in model
(4) satisfies
n
‚àö (
}{
}
)
1 ‚àë ‚àí1 {
n ùúÉÃÇ1 ‚àí ùúÉ1‚àó = ‚àö
V
Ai ‚àí E‚àó (Ai |p(Ci )) Yi ‚àí m(Ai , Ci ; ùúÉ ‚àó ) + op (1),
n i=1

ÃÇ op (1) is a variable that converges to zero in probability,
where ùúÉ ‚àó is the probability limit of ùúÉ,
V=E

[{

}
]
Ai ‚àí E‚àó (Ai |p(Ci )) ùúà(Ai , Ci )

(
)
for ùúà(Ai , Ci ) = ùúïm Ai , Ci ; ùúÉ ‚àó ‚àïùúïùúÉ1 and where E‚àó (Ai |p(Ci )) is the fitted value from a weighted (population) least squares regression of Ai on p(Ci ). That is, E‚àó (Ai |p(Ci )) = ùõº0 + ùõº1 p(Ci ), with ùõº0 and ùõº1 the
solution to the equations
{
}]
[
0 = E ùúà(Ai , Ci ) Ai ‚àí ùõº0 ‚àí ùõº1 p(Ci )
{
}]
[
0 = E ùúà(Ai , Ci )p(Ci ) Ai ‚àí ùõº0 ‚àí ùõº1 p(Ci ) .
Under the causal null hypothesis,
{

Ai ‚àí E‚àó (Ai |p(Ci ))

}{
}
Yi ‚àí m(Ai , Ci ; ùúÉ ‚àó )

has mean zero at ùúÉ1‚àó = 0. Indeed, in that case ùúà(Ai , Ci ) = ùúà(Ci ) so that the solution to the previous system
of equations is given by ùõº0 = 0 and ùõº1 = 1; hence, E‚àó (Ai |p(Ci )) = p(Ci ). It is now easily verified that the
resulting estimating function
{
}{
}
Ai ‚àí p(Ci ) Yi ‚àí m(Ai , Ci ; ùúÉ ‚àó )

4068

indeed has mean zero, regardless of the choice of m(Ai , Ci ; ùúÉ ‚àó ) because m(Ai , Ci ; ùúÉ ‚àó ) does not involve Ai
when ùúÉ1‚àó = 0. It follows from the previous result that if the propensity score were known, then tests of
Copyright ¬© 2014 John Wiley & Sons, Ltd.

Statist. Med. 2014, 33 4053‚Äì4072

S. VANSTEELANDT AND R. M. DANIEL

the causal null hypothesis are valid in the propensity score adjusted model (4), even when the outcome
regression model is misspecified.
Consider now the more realistic case where the propensity score is unknown, but known to obey the
regression model
)
(
P(A = 1|C) = p(C; ùõæ) = expit ùõæ0 + ùõæ1‚Ä≤ C .
Suppose furthermore that this model is fitted using maximum likelihood so that an estimator ùõæÃÇ of ùõæ is
obtained by solving
)
n
n (
}
1‚àë 1 {
1‚àë
Ai ‚àí p(Ci ; ùõæÃÇ ) .
S ‚â°
0=
n i=1 ùõæ,i n i=1 Ci
Then, it follows by the usual Taylor series arguments that the asymptotic distribution of the maximum
likelihood estimator ùúÉÃÇ1 for the exposure effect ùúÉ1‚àó = 0 in model (4), with p(C) substituted by p (C; ùõæÃÇ ), is
given by
‚àö

n
}{
(
)}
1 ‚àë ‚àí1 [{
n(ùúÉÃÇ1 ‚àí 0) = ‚àö
V
Ai ‚àí p(Ci ) Yi ‚àí m Ai , Ci ; ùúÉ ‚àó
n i=1
]
[
( )‚Ä≤
]
)‚àí1
(
1
‚àó
‚àí E p(C) {1 ‚àí p(C)}
Sùõæ,i + op (1).
{Y ‚àí m (A, C; ùúÉ )} E ùúïSùõæ ‚àïùúïùõæ
C

When the outcome model is correctly specified, then
[
( )‚Ä≤
]
1
E p(C) {1 ‚àí p(C)}
{Y ‚àí m (A, C; ùúÉ ‚àó )} = 0,
C
so that the uncertainty in the estimated propensity score can be ignored for inference about the exposure
effect. When
then further insight can be developed upon defining
} { model
( is misspecified,
{ the outcome
)}
ùúëi ‚â° V ‚àí1 Ai ‚àí p(Ci ) Yi ‚àí m Ai , Ci ; ùúÉ ‚àó . With this notation, we now see that
n
‚àö
(
) (
)‚àí1
1 ‚àë
ÃÇ
n(ùúÉ1 ‚àí 0) = ‚àö
ùúëi ‚àí E ùúïùúëi ‚àïùúïùõæ E ùúïSùõæ,i ‚àïùúïùõæ
Sùõæ,i + op (1)
n i=1
n
n
(
) (
)‚àí1
‚àè(
)
1 ‚àë
1 ‚àë
‚Ä≤
‚Ä≤
ùúëi ‚àí E ùúëi Sùõæ,i
Sùõæ,i + op (1) = ‚àö
ùúëi ‚àí
=‚àö
E Sùõæ,i Sùõæ,i
ùúëi |Œõùõæ + op (1),
n i=1
n i=1

)
‚àè(
where
ùúëi |Œõùõæ is the orthogonal projection of ùúëi onto the linear span of all scores Sùõæ,i . Because the
residual from such orthogonal projection varies less than the original variable, ùúëi , we may conclude
that a conservative test of the null hypothesis is obtained if one ignores the uncertainty in the estimated
propensity score, provided that a robust (i.e. empirical) variance estimator is used. A more powerful test
than the default test that ignores the uncertainty in the estimated propensity score can thus be based on
the previous expansion of ùúÉÃÇ1 .
}
{
Consider now the extended model P (Y = 1|a, c) = expit ùúÉ0 + ùúÉ1 a + ùúÉ2 p(c) + ùúÉ3‚Ä≤ c with the propensity score assumed known. Then, by a similar reasoning as in the previous paragraph, we have that at the
causal null hypothesis,
n
‚àö
)}
}{
(
1 ‚àë ‚àí1 {
n(ùúÉÃÇ1 ‚àí 0) = ‚àö
V0 Ai ‚àí p(Ci ) Yi ‚àí m Ai , Ci ; ùúÉ ‚àó + op (1),
n i=1

(A.2)

{
}
‚Ä≤
where m(Ai , Ci ; ùúÉ ‚àó ) = m(0, Ci ; ùúÉ ‚àó ) = expit ùúÉ0‚àó + ùúÉ2‚àó p(Ci ) + ùúÉ3‚àó Ci because ùúÉ1‚àó = 0; further,
[
]
V0 = E {A ‚àí p(C)} m(0, C; ùúÉ ‚àó ) {1 ‚àí m(0, C; ùúÉ ‚àó )} A .

Copyright ¬© 2014 John Wiley & Sons, Ltd.

Statist. Med. 2014, 33 4053‚Äì4072

4069

{
}
Because the term Ai ‚àí p(Ci ) in expression (A.2) remains unchanged upon adding covariates C to the
model, the inclusion of additional covariates does not take away variation in the exposure. Because furthermore, the model-based variance of a binary outcome, that is, m(0, C; ùúÉ ‚àó ) {1 ‚àí m(0, C; ùúÉ ‚àó )}, is hardly

S. VANSTEELANDT AND R. M. DANIEL

affected by the inclusion of additional covariates, we can deduce that at the causal null hypothesis, the
inclusion of the baseline covariates in the propensity score adjusted model does not greatly affect the
precision of the exposure effect estimator ùúÉÃÇ1 , unless it affects the correct specification of the outcome
model. Indeed, under misspecification of the outcome model, it follows from (A.2) that the variance of
ùúÉÃÇ1 becomes
[
]
E p(C) {1 ‚àí p(C)} {E(Y|C) ‚àí m(0, C; ùúÉ ‚àó )}2
1
+
,
nV02
nV02
where the second term is the added variance because of model misspecification. Likewise, the variance
of the directly standardised estimator ùúì,
ÃÇ as given by (6), is expected to be only minimally affected by
the additional inclusion of the covariates C in model (4) at the causal null hypothesis. This is because at
the causal null hypothesis, the distribution of this estimator (with known propensity score) is given by
n
‚àö
)
(
)
[
)
{
}]‚àö (
1 ‚àë (
n(ùúìÃÇ ‚àí0) = ‚àö
m 1, Ci ; ùúÉ ‚àó ‚àím 0, Ci ; ùúÉ ‚àó +E m(1, Ci ; ùúÉ ‚àó ) 1‚àím(1, Ci ; ùúÉ ‚àó )
n ùúÉÃÇ1 ‚àí ùúÉ1‚àó +op (1)
n i=1

and thus only affected by the uncertainty in the estimation of ùúÉ1 .
A.3. Weighted effects on the difference scale
Suppose that the {propensity score model
is correctly specified so that P(A = 1|c) = p(c). Denote
}
m(a, c; ùúÉ) = expit ùúÉ0 + ùúÉ1 a + ùúÉ2 p(c) . The score equations for ùúÉ in the propensity score adjusted model
ÃÇ the following three restrictions
(4) are given by (A.1). We thus have that at the probability limit ùúÉ ‚àó of ùúÉ,
must hold:
[
]
0 = E{Y ‚àí m(A, C; ùúÉ ‚àó )} = E A {E(Y|A = 1, C) ‚àí m(1, C; ùúÉ ‚àó )} + (1 ‚àí A) {E(Y|A = 0, C) ‚àí m(0, C; ùúÉ ‚àó )}
]
[
= E p(C) {E(Y|A = 1, C) ‚àí m(1, C; ùúÉ ‚àó )} + (1 ‚àí p(C)) {E(Y|A = 0, C) ‚àí m(0, C; ùúÉ ‚àó )}
and
[
]
[
]
[
]
0 = E A{Y ‚àí m(A, C; ùúÉ ‚àó )} = E A{E(Y|A = 1, C) ‚àí m(1, C; ùúÉ ‚àó )} = E p(C) {E(Y|A = 1, C)‚àím(1, C; ùúÉ ‚àó )}
and
[
]
0 = E p(C) {Y ‚àí m(A, C; ùúÉ ‚àó )}
]
[
= E p(C)A {E(Y|A = 1, C) ‚àí m(1, C; ùúÉ ‚àó )} + p(C)(1 ‚àí A) {E(Y|A = 0, C) ‚àí m(0, C; ùúÉ ‚àó )}
[
]
= E p(C)2 {E(Y|A = 1, C) ‚àí m(1, C; ùúÉ ‚àó )} + (1 ‚àí p(C))p(C) {E(Y|A = 0, C) ‚àí m(0, C; ùúÉ ‚àó )} .
In particular, we thus have that
E {p(C)E(Y|A = 1, C)} = E {p(C)m(1, C; ùúÉ ‚àó )}
]
]
[
E {1 ‚àí p(C)} E(Y|A = 0, C) = E {1 ‚àí p(C)} m(0, C; ùúÉ ‚àó )
[
]
]
[
E p(C)2 {E(Y|A = 1, C) ‚àí E(Y|A = 0, C)} = E p(C)2 {m(1, C; ùúÉ ‚àó ) ‚àí m(0, C; ùúÉ ‚àó )} .
[

From these restrictions, it now follows that the large sample mean of (8) is

4070

[
] [
]
E p(C) {1 ‚àí p(C)} {m(1, C; ùúÉ ‚àó ) ‚àí m(0, C; ùúÉ ‚àó )} ‚àïE p(C) {1 ‚àí p(C)}
[
] [
]
{
}
= E p(C) {1 ‚àí p(C)} {E(Y|A = 1, C) ‚àí E(Y|A = 0, C)} ‚àïE p(C) {1 ‚àí p(C)} = E w(C)(Y1 ‚àí Y0 ) ,
even when the outcome model is misspecified.
Copyright ¬© 2014 John Wiley & Sons, Ltd.

Statist. Med. 2014, 33 4053‚Äì4072

S. VANSTEELANDT AND R. M. DANIEL

A.4. Weighted effects on the ratio scale
The score equations for ùúÉ in the propensity score adjusted model (10) now involve the additional
restriction
n
{
(
)}
1‚àë
Ai p(Ci ) Yi ‚àí m Ai , Ci ; ùúÉÃÇ ,
0=
n i=1
which implies
]
[
]
[
0 = E Ap(C) {Y ‚àí m(A, C; ùúÉ ‚àó )} = E p(C)A {E(Y|A = 1, C) ‚àí m(1, C; ùúÉ ‚àó )}
[
]
= E p(C)2 {E(Y|A = 1, C) ‚àí m(1, C; ùúÉ ‚àó )} .
We thus have
E {p(C)E(Y|A = 1, C)} = E {p(C)m(1, C; ùúÉ ‚àó )}
]
[
]
E {1 ‚àí p(C)} E(Y|A = 0, C) = E {1 ‚àí p(C)} m (0, C; ùúÉ ‚àó )
{
}
{
}
E p(C)2 E(Y|A = 1, C) = E p(C)2 m (1, C; ùúÉ ‚àó )
[

E {p(C) {1 ‚àí p(C)} E(Y|A = 0, C)} = E {p(C) {1 ‚àí p(C)} m (0, C; ùúÉ ‚àó )} .
From these restrictions, it now follows that the large sample mean of
[
] [
]
E p(C) {1 ‚àí p(C)} m (1, C; ùúÉ ‚àó ) ‚àïE p(C) {1 ‚àí p(C)}
}
[
] [
]
{
= E p(C) {1 ‚àí p(C)} E(Y|A = 1, C) ‚àïE p(C) {1 ‚àí p(C)} = E w(C)Y1 ,
even when the outcome model is misspecified and likewise.
[
] [
]
{
}
E p(C) {1 ‚àí p(C)} m (0, C; ùúÉ ‚àó ) ‚àïE p(C) {1 ‚àí p(C)} = E w(C)Y0 .

Acknowledgements
The first author acknowledges support from IAP research network grant no. P07/06 from the Belgian government
(Belgian Science Policy). The second author acknowledges support from the U.K. Medical Research Council
(Career Development Award in Biostatistics, G1002283).

References

Copyright ¬© 2014 John Wiley & Sons, Ltd.

Statist. Med. 2014, 33 4053‚Äì4072

4071

1. Rosenbaum PR, Rubin DB. The central role of the propensity score in observational studies for causal effects. Biometrika
1983; 70:41‚Äì55.
2. D‚ÄôAgostino RB. Propensity score methods for bias reduction in the comparison of a treatment to a non-randomized control
group. Statistics in Medicine 1998; 17:2265‚Äì2281.
3. Rosenbaum PR, Rubin DB. Reducing bias in observational studies using subclassification on the propensity score. Journal
of the American Statistical Association 1984; 79:516‚Äì524.
4. Rubin DB. Estimating causal effects from large data sets using propensity scores. Annals of Internal Medicine 1997;
127:757‚Äì763.
5. Rosenbaum PR, Rubin DB. Constructing a control group using multivariate matched sampling methods that incorporate
the propensity score. The American Statistician 1984; 39:33‚Äì38.
6. Robins JM. Marginal structural models. Proceedings of the Section on Bayesian Statistical Science, Alexandria, VA:
American Statistical Association, 1997, 1-10.
7. Robins JM, Hernan MA, Brumback B. Marginal structural models and causal inference in epidemiology. Epidemiology
2000; 11:550‚Äì560.
8. Tan Z. Understanding, OR, PS, and DR. Statistical Science 2008; 22:560‚Äì568.
9. Rubin DB. Formal modes of statistical inference for causal effects. Journal of Statistical Planning and Inference 1990;
25:279‚Äì292.
10. Hern√°n MA. A definition of causal effect for epidemiological research. Journal of Epidemiology and Community Health
2004; 58:265‚Äì271.
11. VanderWeele TJ. Concerning the consistency assumption in causal inference. Epidemiology 2009; 20:880‚Äì883.
12. Robins JM, Mark SD, Newey WK. Estimating exposure effects by modelling the expectation of exposure conditional on
confounders. Biometrics 1992; 48:479‚Äì495.

S. VANSTEELANDT AND R. M. DANIEL
13. Greenland S, Robins J, Pearl J. Confounding and collapsibility in causal inference. Statistical Science 1999; 14:29‚Äì46.
14. Stampf S, Graf E, Schmoor C, Schumacher M. Estimators and confidence intervals for the marginal odds ratio using logistic
regression and propensity score stratification. Statistics in Medicine 2010; 29:760‚Äì769.
15. Snowden JM, Rose S, Mortimer KM. Implementation of G-computation on a simulated data set: demonstration of a causal
inference technique. American Journal of Epidemiology 2011; 173:731‚Äì738.
16. Vansteelandt S, Keiding N. Invited commentary: G-computation ‚Äì lost in translation American Journal of Epidemiology
2011; 173:739‚Äì742.
17. Robinson L, Jewell N. Some surprising results about covariate adjustment in logistic-regression models. International
Statistical Review 1991; 59:227‚Äì240.
18. Kurth T, Walker AM, Glynn RJ, Chan KA, Gaziano JM, Berger K, Robins JM. Results of multivariable logistic regression, propensity matching, propensity adjustment, and propensity-based weighting under conditions of nonuniform effect.
American Journal of Epidemiology 2006; 163:262‚Äì270.
19. Crump RV, Hotz J, Imbens I, Mitnik O. Moving the goalposts: addressing limited overlap in the estimation of average
treatment effects by changing the estimand, Technical Report No. 330, NBER Technical Working Paper 2006.
20. St√ºrmer T, Rothman KJ, Avorn J, Glynn RJ. Treatment effects in the presence of unmeasured confounding: dealing with
observations in the tails of the propensity score distribution ‚Äì a simulation study. American Journal of Epidemiology 2010;
172:843‚Äì854.
21. Petersen ML, Porter KE, Gruber S, Wang Y, van der Laan MJ. Diagnosing and responding to violations in the positivity
assumption. Statistical Methods in Medical Research 2012; 21:31‚Äì54.
22. Connors AF, Speroff T, Dawson NV, Thomas C, Harrell FE, Wagner D, Desbiens N, Goldman L, Wu AW, Califf RM,
Fulkerson WJ, Vidaillet H, Broste S, Bellamy P, Lynn J, Knaus WA. The effectiveness of right heart catheterization in the
initial care of critically ill patients. Journal of the American Medical Association 1996; 276:889‚Äì897.
23. Hirano K, Imbens GW. Estimation of causal effects using propensity score weighting: an application to data on right heart
catheterization. Health Services and Outcome Research Methods 2001; 2:259‚Äì278.
24. Tan Z. A distributional approach for causal inference using propensity scores. Journal of the American Statistical
Association 2006; 101:1619‚Äì1637.
25. Rosenblum M, van der Laan MJ. 2009. Using regression models to analyze randomized trials: asymptotically valid
hypothesis tests despite incorrectly specified models. Biometrics 2009; 65:937-945.
26. Crump RV, Hotz J, Imbens I, Mitnik O. Dealing with limited overlap in estimation of average treatment effects. Biometrika
2009; 96:187‚Äì199.
27. Moore KL, Neugebauer R, van der Laan MJ, Tager IB. Causal inference in epidemiological studies with strong
confounding. Statistics in Medicine 2012; 31:1380‚Äì1404.

Supporting information
Additional supporting information may be found in the online version of this article at the publisher‚Äôs
web site.

4072
Copyright ¬© 2014 John Wiley & Sons, Ltd.

Statist. Med. 2014, 33 4053‚Äì4072

