Biometrika Trust

Addressing Complications of Intention-to-Treat Analysis in the Combined Presence of Allor-None Treatment-Noncompliance and Subsequent Missing Outcomes
Author(s): Constantine E. Frangakis and Donald B. Rubin
Source: Biometrika, Vol. 86, No. 2 (Jun., 1999), pp. 365-379
Published by: Oxford University Press on behalf of Biometrika Trust
Stable URL: https://www.jstor.org/stable/2673518
Accessed: 24-10-2019 21:39 UTC
JSTOR is a not-for-profit service that helps scholars, researchers, and students discover, use, and build upon a wide
range of content in a trusted digital archive. We use information technology and tools to increase productivity and
facilitate new forms of scholarship. For more information about JSTOR, please contact support@jstor.org.
Your use of the JSTOR archive indicates your acceptance of the Terms & Conditions of Use, available at
https://about.jstor.org/terms

Biometrika Trust, Oxford University Press are collaborating with JSTOR to digitize,
preserve and extend access to Biometrika

This content downloaded from 206.253.207.235 on Thu, 24 Oct 2019 21:39:53 UTC
All use subject to https://about.jstor.org/terms

Biometrika (1999), 86, 2, pp. 365-379

?) 1999 Biometrika Trust
Printed in Great Britain

Addressing complications of intention-to-treat analysis in the
combined presence of all-or-none treatment-noncompliance and
subsequent missing outcomes
BY CONSTANTINE E. FRANGAKIS AND DONALD B. RUBIN
Department of Statistics, Harvard University, 1 Oxford Street, Cambridge,

Massachusetts 02138, U.S.A.
frangaki@hustat.harvard.edu rubin@stat.harvard.edu
SUMMARY

We study the combined impact that all-or-none compliance and subsequent missing
outcomes can have on the estimation of the intention-to-treat effect of assignment in
randomised studies. In this setting, a standard analysis, which drops subjects with missing
outcomes and ignores compliance information, can be biased for the intention-to-treat
effect. To address all-or-none compliance that is followed by missing outcomes, we construct a new estimation procedure for the intention-to-treat effect that maintains good
randomisation-based properties under more plausible, nonignorable noncompliance and
nonignorable missing-outcome conditions: the 'compound exclusion restriction' on the
effect of assignment and the 'latent ignorability' of the missing data mechanism. We present

both theoretical results and a simulation study. Moreover, we show how the two key
concepts of compound exclusion and latent ignorability are relevant in more complicated
settings, such as right censoring of a time-to-event outcome.
Some key words: Compound exclusion restriction; Intention-to-treat; Latent ignorability; Noncompliance;
Nonignorability; Rubin causal model.

1. INTRODUCTION

Randomised experiments with human subjects often suffer from two major complications, namely noncompliance to treatment assignment and missing outcomes. In general,
noncompliance is selective (The Coronary Drug Project Research Group, 1980) in the
sense that noncompliers and compliers generally differ in background characteristics.
Moreover, missing outcomes, often caused by refusal or loss to follow-up, may also be
selective in the analogous sense (Farwell et al., 1990). These complications are rarely fully
within the experimenter's control, and there is currently substantial awareness among
researchers that such complications in a study compromise the ability to draw clear
conclusions.

We assume a simple two-arm randomised experiment comparing a new versus a standard treatment, with access to the new, experimental treatment only in the new treatment
arm and all-or-none compliance. A special case is the Zelen randomised single-consent
design (Zelen, 1979, 1990a), where those assigned standard treatment cannot receive the
new treatment, and those assigned the new treatment either receive it or the standard
treatment.

This content downloaded from 206.253.207.235 on Thu, 24 Oct 2019 21:39:53 UTC
All use subject to https://about.jstor.org/terms

366 CONSTANTINE E. FRANGAKIS AND DONALD B. RUBIN

For any subject whose outcome at the end of the study is known, we will say there is
a response and refer to the subject as a respondent, whereas if the outcome is missing we
will say there is nonresponse and that the subject is a nonrespondent.
The bias of using the actual treatment received as if it had been randomly assigned,
'as-treated' analysis, has been well documented in related settings (The Coronary Drug
Project Research Group, 1980; Mark & Robins, 1993; Robins & Greenland, 1994; Sheiner
& Rubin, 1995). For this reason, the standard approach to randomised trials with noncompliance has been intention-to-treat analysis, which compares the originally randomised
treatment assignment arms, thereby ignoring the observed actual treatment received. When
the outcomes of study are observed for each subject, intention-to-treat analysis is valid

for estimating the intention-to-treat treatment effect Y1 - Y0, that is, the effect of assignment
on the population averages of the outcome Y Commonly, though, observed outcomes are
not available for all subjects. Even then, a standard analysis is a respondent-based intention-to-treat analysis, that is, an analysis that is based on the respondents and ignores
compliance data, e.g. Farwell et al. (1990), Reuben et al. (1995). As we show, however,
the practice of discarding compliance data in the presence of subsequent nonresponse can
create a bias even when Y1 - Y0 is zero. Other issues that arise with intention-to-treat
analyses are discussed by Little & Yau (1996) and Kleinman, Ibrahim & Laird (1998).
We provide a framework that explicitly allows both nonignorable (Rubin, 1976, 1978)
noncompliance to the treatment assignment and nonignorable nonresponse on the outcome of study, and offer a new estimation procedure for Y1 - Y0 that maintains good
randomisation-based properties more generally than respondent-based intention-to-treat
analysis.

Our framework is developed in ? 2, where we posit two assumptions, namely 'latent
ignorability' and 'compound exclusion restriction'. Under our assumptions, we show that

respondent-based intention-to-treat analysis, although commonly used to estimate Y1
for example Lee et al. (1991), can be biased for Y1 - Y0, and that the bias can be reduced
by using compliance data. In ? 3, we discuss identifiability and construct our estimator
for Y1 - Y0, which is consistent when respondent-based intention-to-treat analysis is consistent and also when respondent-based intention-to-treat analysis is inconsistent under
our nonignorable conditions. In ?-4, we present simulation results to illustrate some
operating characteristics of our new procedure. In ? 5 we apply. these new ideas to the
problem of identifiability in right censoring of a time-to-event outcome, a survival time,
following all-or-none compliance. For the case of discrete-time survival, a related approach
is independently considered by Baker (1998). Our final section gives concluding remarks.
The Appendix provides technical details of our results.

2. FRAMEWORK
2 1. The data

In order to address better the different sources of missing information in this problem,

we first define potential outcomes separately from a sampling scheme or probabilistic
assignment mechanism, an approach dating back to Neyman (1923) in the context of
perfect randomised trials, formalised and extended to nonrandomised studies in Rubin
(1974, 1978), and referred to as the Rubin causal model (Holland, 1986). Consider a large
population of individuals {o}, each of which can potentially participate in a study and
be assigned a treatment z, with z = -1for new, 0 for standard. For each individual T, let
D(w, z) be the actual treatment received, 1 for new, 0 for standard, if that individual is

This content downloaded from 206.253.207.235 on Thu, 24 Oct 2019 21:39:53 UTC
All use subject to https://about.jstor.org/terms

Intention-to-treat analysis 367

assigned treatment z. Also let Y(w, z) and R(o, z) be, respectively, the outcome and indicator for response, equal to 1 for response, 0 for nonresponse, on outcome Y, if individual
o is assigned treatment z.

A simple random sample of n subjects from {o}, o1,.l. , On, say, comprises the par

pants in the study. Each subject is then randomly assigned treatment arm Zi, 1 for new,
0 for standard, where for simplicity Zi (i = 1, . . . , n) are essentially independent, identica
distributed Bernoulli variables. Then the observable vectors
(Zi, D(o-)i, Zi), Y(o-)i, Zi), R(o-)i, Zi))
(i= 1,.. , n) are essentially independent and identically distributed replicates with respect
to the random sampling-random assignment mechanism, and will be denoted by

(Zi, Di, Yx, Ri).
We assume that the observed data from the study include

(i) the treatment assignments {Zi };
(ii) the actual treatments received {Di }, where by assumption Di = 0 if Zi = 0; and

(iii) the indicators for whether or not outcomes are observed, {Ri}, where outcome
is observed if Ri = 1 and missing if Ri = 0.
Hence, the observed data are

I(Zi.Di.Ri):i=1,. . .,n} {Y:Ri= 1}. (2.1)

Let Yz= E{Y(oi, z)} be the expected outcome when all un
where the probability measure is the one induced by the random sampling from {O}. We
focus on estimating the intention-to-treat treatment effect on the means of Y in {O}, given
by

Y1-YO.

(2

2)

A more specific question is whether or not the intention-to-treat null hypothesis of no

effect of assignment on the outcomes, Ho: Y -YO = 0, is plausible.
The methods that we will discuss can formally be applied within the levels of other
pretreatment covariates, but, to focus on conceptual issues, we assume that no covariate
is recorded, or that we are already within a cell defined by such covariates.

2 2. Role of treatment-noncompliance with missing outcomes
Let U(o) =D(o, 1) be the received treatment for individual O when assigned the new

treatment, where Ui = U(ti) for the ith study individual wi. Since Ui = 1 if person Oi
would comply under both treatment assignments, we refer to such a person as a 'complier',
and, because Ui = 0 if person oi would never take the new treatment, no matter what the
assignment, we refer to such a person as a 'never-taker'; see the Harvard Institute of
Economic Research Discussion paper #1676 by G. W. Imbens and D. B. Rubin 'Causal
inference with instrumental variables'. By definition, the quantity U(O) is fixed for individ-

ual w, and therefore it is a covariate, the true compliance status covariate (Angrist, Imbens
& Rubin, 1996; Rubin, 1998), though it is only partially observed in the sample; Ui = Di
when Zi = 1, but Ui is unobserved when Zi = 0. Despite being missing in the standard
treatment arm, by randomisation, the covariate Ui has the same distribution in the standard treatment arm as in the new treatment arm in the study; see Fig. 1. The observed,
post-treatment compliance behaviour, DT, is completely determined by the values of the

covariate Ui and the treatment assignment Zi. Naive attempts to condition on Di, the

This content downloaded from 206.253.207.235 on Thu, 24 Oct 2019 21:39:53 UTC
All use subject to https://about.jstor.org/terms

368 CONSTANTINE E. FRANGAKIS AND DONALD B. RUBIN

observed treatment received, generally lead to biased conclusions becau
covariate.

Standard 1- eI Ud = 0 (never-taker)' ta

Zi=0 Di=0 \/
-\oI U-o1 (complier) o a
0

New ~~1U Di =0 (never-taker)
Z= 1

U D= 1 (complier)
Fig.l1. The study and the unobserved, comparable compliance groups.
Dashed lines represent unobserved information. Here, U is the proportion
of compliers. To each of the four combinations of assignment arm by
compliance covariate corresponds a rectangular array {(Y1, Ri)}.

In the presence of subsequent missingness of the outcome Yi, indicated by Ri = 0, a
strict intention-to-treat analysis cannot be done and the role of the compliance covariate

Ui is critical. To describe this role, consider for the moment an investigator who, hypot
cally, knows the compliance covariate values Ui for all subjects, that is, whether each
subject would comply with the new treatment, a complier, or not, a never-taker, under
assignment to take it. Researchers have expressed the desire to have known this information, e.g. Schechtman & Gordon (1988), and consideration of this case suggests how
to analyse the data without such information.

With Ui fully observed, the investigator would have a covariate, Ui, and therefore would
have the following main options.
Approach 1. Ignore the fully observed covariate, and compare respondents between

randomised arms. In order for this approach to be correct, response Ri should be inde

dent of outcomes Y1 before conditioning on the covariates Ui, as when the missi
values are missing completely at random (Little & Rubin, 1987, Ch. 1).

Approach 2. Do separate analyses for compliers, Ui = 1, and for never-takers, Ui = 0.
Then, combine these analyses, weighted by the proportions of compliers and never-takers

since the goal is the overall intention-to-treat effect. This approach allows for response Ri

to be ignorable (Rubin, 1976) or, essentially here, independent of outcome Yi after, b
not necessarily before, conditioning on the compliance covariates Ui.
In practice it may be that neither of the above two approaches is correct, but this is
not testable. To avoid confounding, it is general practice when confronted with missing
outcomes first to condition on important covariates before assuming independent nonresponse. For example, we assume we are already within a cell defined by all other observed
covariates, because such conditioning is standard. The clinical trials literature typically

regards the latent compliance covariate Ui to be important in the sense of being associa

with both (i) background characteristics of health related to the outcome Yi, as we

(ii) response R ; see for example The Coronary Drug Project Research Group (1980),

Schechtman & Gordon (1988), Farwell et al. (1990), Gordon & Schechtman (1990) and

This content downloaded from 206.253.207.235 on Thu, 24 Oct 2019 21:39:53 UTC
All use subject to https://about.jstor.org/terms

Intention-to-treat analysis 369

Zelen (1990b). Therefore, the investigator with
Approach 2 as more reliable than Approach 1, because Approach 2 conditions on a
potentially important covariate whereas Approach 1 does not.

Hence, to formalise this conclusion, we assume that, if Ui were fully observed, we w
accept ignorability of the missing data mechanism for Yi only after conditioning on Ui.
That is, we would accept Assumption 1.

Assumption 1: Latent ignorability. Potential outcomes and associated potential non.
response indicators are independent within each level of the latent compliance covariate:
(a) when assigned new treatment,

pr {Y(o_), 1) I U(o-i), R(o-i, 1)} = pr {Y(o_)j, 1) I U(o-)i)l;
(b) when assigned standard treatment,

pr {Y(j, 0) I U(oi), R(oi, O)} = pr {Y(o)j, O) I U(ow)}.
Assumption 1 is related to missing-data mechanisms discussed by Baker (1994) in the
context of incomplete covariates.
In the randomised trial, Assumption 1 implies that

pr(Yi, Ri I Ui, Zi) = pr(Y| Ui, Zi) pr(Ri I Ui, Zr),
where, here and in the sequel, the probability measure is the one induced by the random
sampling and random assignment mechanism of the trial.
To address complications because the true compliance covariate is missing, we also
make Assumption 2.

Assumption 2: Compound exclusion restriction for never-takers. If, for individual w,
U(o) = 0, then

LY(O),0) F Y(O), 1)
R(o, 0)] LR(o, 1)]

Since for the never-takers the treatment actually received would be the same no matter
what their treatment assignment, the intervention of assignment within the study is arguably of little relevance to them. Consequently, Assumption 2 asserts that, for the nevertakers, who are defined by the covariate U(o) = 0, there is no effect of assignment on

either their outcomes Y(o, z) or their response behaviours R(w, z). Although Assumption 2
may not be true, it is expected to hold approximately in double-blind trials or often when
the outcome is measured long after final exposure to the new treatment for the nevertakers has occurred. Assumption 2 is closely related to 'exclusion restriction' assumptions
in the traditional instrumental variables approach (Durbin, 1954; Goldberger, 1972;
Angrist et al., 1996), also used in biomedical applications, e.g. Baker & Lindeman (1994)

and Sommer & Zeger (1991), and which apply to outcomes, Y. Our use of 'compound'
implies that the exclusion restriction applies to both the values of Y and the missingness
of Y.
An immediate consequence of Assumption 2 is that, in the randomised trial,

pr{() Ui=oZi=O} =pr{(R) u ui=ozi=1}.

Under Assumptions 1 and 2, the outcomes 1 and response indicators

This content downloaded from 206.253.207.235 on Thu, 24 Oct 2019 21:39:53 UTC
All use subject to https://about.jstor.org/terms

370 CONSTANTINE E. FRANGAKIS AND DONALD B. RUBIN

correlated in the standard treatment arm because no Ui is observed there. That is, for
those units assigned standard treatment, there is no set of observed data on which to
condition to make nonresponse independent of outcome. In the terminology of Rubin

(1976), the missing outcomes {Yi: Ri = 0} are generally not missing at random, and s
nonresponse is nonignorable.

Under Assumptions 1 and 2, we next show that the respondent-based intention-to-treat

estimator for Y1 - YO is generally biased even under Ho. Consistent estimation for Y1 - YO
under Assumptions 1 and 2 will be discussed in ? 3.

2 3. Bias of respondent-based intention-to-treat estimatorfor intention-to-treat effect
From the observed data (2-1), standard respondent-based intention-to-treat analysis

disregards the actual treatment data {Di } and constructs an estimator for Y1 - Y
on the respondents within each assignment arm using
y5-bs

Yobs

(2.3)

the difference in sample average outcomes among respondents at each assignment arm:
n

n

YZ Z YiRjI(Zi = z) Z RjI(Zi = z),
i=l

i=l

where I(.) is the indicator function. For technical reasons, assume E(Y2) is finite, and let

YZV= E(Y I Ri = 1, Zi = z), the probability limit of yZobs for z = 0, 1.
Under Assumptions 1 and 2, however, estimator (2 3) is biased in our setting because,

generally, y bs - bsY Y -Yo even under Ho. To show this, let
YU Z:= E(Yj I Ui = u, Zi = z), Ru,z:= E(Ri I Ui = u, Zi = z),
the mean outcomes and response probabilities, respectively, within levels of the true com-

pliance covariate and assignment arms, and let U:= E(Uj), the proportion of complier
Finally, let Rz=E(Ri Zi=z), the marginal response rates within assignment arms. We
then have the following result.

RESULT 1. Under Assumptions 1, 2, and Ho,

Vobs -obs U(1-U)k0,1 - - Rl,o)(YUR
R1R0

Proof. Under Assumption 2, the compound exclusion restriction, there is no effect of

assignment for the never-takers, (Y0O0, R0,0) = (Yo0,1 R0o), and so we will denote

(Yo0l, R0,o) the never-taker average outcome and response probability for both treatmen
assignment arms. Under Assumption 1, latent ignorability, then

YZobs = E{E(YRi = 1, Zi = z, Ui) Ri= 1, Zi = z}

=pr(Ui=llRi=l,Zi= z)Ylz+pr(Ui=?lRi=l,Zi=z)YO,1 (24)
From Bayes' theorem, we have

pr(U> = e w R s =h H, Z = z)=r, eival, Y= = Y , (b tU) (2c 5)
With~ ~ ~ ~~~~R UR enwasm htHoi reo,euvlnly ll=Y ytecm

This content downloaded from 206.253.207.235 on Thu, 24 Oct 2019 21:39:53 UTC
All use subject to https://about.jstor.org/terms

Intention-to-treat analysis 371

pound exclusion restriction. If we use (2-5) in (2-4), and with the mixture Rz =

URj,z + (1 - U)Ro,1, Result 1 follows after some algebra. CZ

In Result 1, -Yobs- Obs is not zero unless either the response rates for
and R1,0, are the same, or the mean outcomes between compliers and n
and Y01, are the same, or R0o1 = 0 so that all never-takers are nonrespondents.
Consequently, under Assumptions 1 and 2 and the null hypothesis Ho, the respondentbased intention-to-treat estimator (2-3) is generally biased for the intention-to-treat effect.
Although intention-to-treat analysis is generally promoted, in contrast to naive and biased
'as-treated' and 'per-protocol' analyses, to avoid the heterogeneity of differential character-

istics between compliers and never-takers, it is this same heterogeneity that may render
the missing outcomes nonignorable and hence respondent-based intention-to-treat analysis incorrect. Better procedures, however, do exist. In ? 3 we construct an estimator that

is randomisation-based consistent for Y1 - YO under Assumptions 1 and 2.

3. ESTIMATION UNDER LATENT IGNORABILITY AND COMPOUND EXCLUSION
Each assignment arm comprises a mixture of never-takers and compliers, so

Y1 = (1-U)Yo01 + UY1,l Yo= (1-U)YOO + UY1,0.

Under the compound exclusion restriction, Y0j = Y0O , and therefore (2 2) can be wr
as

Yi - Yo = U(Yi,i l- Y1o), (3.1)

where Y1 - Y1,0 is the effect of assignment on the complier
In the new treatment arm, all true compliance covariates Ui are observed and equal in
value to Di. By virtue of the latent ignorability assumption, the stratified estimator

Y11:=Z YiRiDiZi/RiDiZi is then consistent for Y-11 by the law of large numbers. The
estimation of U and Y1,0 in (3 1) requires only easily estimable quantities.

The key idea in estimation is to realise first that, by randomisation, the mixing pro-

portions of never-takers, Ui = 0, and compliers, Ui = 1, are directly estimable from t
new treatment assignment arm where the covariates Ui are fully observed. Moreover,
because of the compound exclusion restriction, for never-takers response Ri is identical
under both assignment arms. Hence, in the new treatment arm, Zi = 1, the units can be
partitioned into the following: compliers with Zi = 1, Ui = 1; responding never-takers with
Zi = 1, Ui = 0 and Ri = 1; and nonresponding never-takers with Zi = 1, Ui = 0 and Ri = 0.
Thus the proportions of these three types in the population are directly estimable from
observed data in the new treatment arm. Moreover, the mean outcomes for responding

never-takers, assigned new or standard treatment, yob1s, are directly estimable in the n

treatment arm. Including latent ignorability implies that Y0,1 = Y0,1. Latent ignorab
analogously would allow direct estimation of the compliers' mean outcome Y1,0 when
assigned standard treatment if the covariates Ui were observed in that arm. Although th
specific information is not available, the mixing proportions of compliers, responding
never-takers and nonresponding never-takers along with Yo l and the observed Yobs are

enough to identify the compliers' mean outcome Y1,o.
The following lemma, proved in the Appendix, allows a method of moments estimator

to be constructed for Y1,o that can be considered an extension of the econometric instrumental variables estimator (Angrist et al., 1996).

This content downloaded from 206.253.207.235 on Thu, 24 Oct 2019 21:39:53 UTC
All use subject to https://about.jstor.org/terms

372 CONSTANTINE E. FRANGAKIS AND DONALD B. RUBIN
LEMMA 1. Under Assumptions 1, 2, and with U > 0,

Y1O= ? Y1R1(1-U) (3o2)
R - R0,1(1 -U)

The estimator Yl o we consider for Y1,o is obtained by using the sample analogues for
the quantities in the right-hand side of (3-2). Specifically, define U Z=DDiZil/Zi and

Ri(l 1-Di)Z. YjRi( 1-Di)Zi

01 (1 1-Di)Zi ' 091 E, Ri(l 1-Di)Zi 33
Ri(l - Zi) YobSRo - Yo01RO1(1 - U)
(1 - Zi) ~Ro - RO1 ( 1 - U)
Also define Vu :=var(Yi Ui = u, Zi =z), for z and u in {0, 1}, and
VObS= var(Yi I Ri = 1, Zi = 0).
The following result, proved in the Appendix using the delta method, forms a basis for

inference about Y1 - YO.
RESULT 2. Under Assumptions 1, 2 and with U > O,

(Y1 0- Y1 0)-+N (O, k
in distribution as n -+ oo, where

U(1U) Vo,1 Ro,(1 -Ro- )

Lpr(Zi= 1)' pr {ZiRi(1 -Di) 1} pr{Zi(1 -Di)= 1
Ro(l - Ro) vobs

pr(Zi = 0) pr{Ri(1 - Zi) =1
= [-R0Ro0(Yobs - YO ,)w2, -Ro,1(1 - U)w,

Ro(Yobs- Y0, 1)(1- U)w2,Ro (Yobs -Yo,1)(1 - U)w2, Row]',
w= {Ro - R10(1 - U)}'.

By standard results, n2 (Y_1 -Y1 ) >-*N(0, q) in distribution as n - oo,

V1,l/pr(ZiDiRi = 1). Furthermore, it can be shown that the two standardised
of interest, n2(Y5i0 - Yio) and n2(YIil - Y1), are asymptotically independent, b
series expansion and Slutsky's theorem. By defining V0 1, V1,1 and Vobs to b

sample estimates for V0,1, V7,1, and Voobs respectively, and with 3, v- and q the
sample analogues of 6, v and q, it is a direct consequence of Result 2 and Slutsky's theorem
that

n 2(Y1 - Y10) - (Y - Y1,0)} (q + Y Vk k) N(O, 1)
in distribution as n-+ oo. Finally, if we let Y1 - YO:= U(Yll - Y5o), it can be easily shown
using the Taylor expansion in the Appendix that
5

2

_

-I (Yi - YO) - (Y 0)} {U2q + O1(Y1, - Y, _-U31)2 + U2 v N(O, 1)
k=2 V~k

(3*4)

This content downloaded from 206.253.207.235 on Thu, 24 Oct 2019 21:39:53 UTC
All use subject to https://about.jstor.org/terms

Intention-to-treat analysis 373

in distribution as n -s oo. Therefore, if we use the estimator Yi - Yi, confidence intervals
for the intention-to-treat estimand, Y1 - Y0, can be constructed based on the normal
approximation (3 4). In the following section we examine some finite sample properties
of this estimator, and compare it with the standard intention-to-treat estimator (2-3) under
various conditions. Although under our assumptions the estimator (2 3) is theoretically
inconsistent for Y1 - Y0, we investigate the extent of this problem in finite samples, first
under hypothetical conditions that follow Assumptions 1 and 2 in ? 441, and under certaiii
deviations from Assumption 1 in ? 4 2.

4. SIMULATION STUDY

441. Numerical results under both latent ignorability and compound exclusion
In each of the 12 conditions of Table 1, n = 500 individuals are randomised to either

the standard or the new treatment arm with pr(Zi = 1) = 0 5 and, independently, compliance covariates Ui are simulated as Bernoulli random variables with probability U.
Outcomes Y1 are simulated from normal distributions with standard deviation equal to

two, conditionally on covariates Ui and treatment assignment arms Zi. The paramete
that, for simplicity, we fix across experimental conditions are
(i) the average outcomes for never-takers and compliers at the standard treatment

arm, Y0,0 = 0, which equals Yo l by Assumption 2, and Y1,0 = 3 respectively, and
(ii) their response probabilities at the new treatment arm R0,1 = R1,1 = 05, for simplicity.
The parameters that we vary are

(iii) the proportion of never-takers, that is 1 - U;

(iv) the average outcome effect for compliers, that is Yj -Y1,0 = 0 or 1;

(v) the response probability for the compliers at the standard treatment arm; that is

R1 = 0 5 gives ignorable nonresponse, i.e. missing at random, or R1,0 = 0 8, wh
gives nonignorable nonresponse, i.e. not missing at random.
In each case we report the induced value, Y1 - Y0, and the ratio of expected observable

outcome to true, marginal expected outcome in the standard treatment arm, Yobs/
a measure of overall deviation from ignorability within arm z = 0.
Table 1 reports coverage rates of nominal 95% confidence intervals for Y1 - Y0, and
mean squared errors for estimators calculated using (i) the new procedure based on the

normal approximation (3-4), labelled ITT"V because it uses a generalisation of the instrumental variables procedure as derived by Angrist et al. (1996), and (ii) the respondentbased intention-to-treat statistic (2-3) with a two-sample t confidence interval, labelled
ITTbS. For the special case where the treatment effect is zero within both never-takers and
compliers, coverage rates for the null value are also reported using the following: 'as-

treated', which compares respondents based on treatment actually received, {1'Y: DiRi =

versus { Yi: (1 -DjRi = 1}, using a two-sample t confidence interval; and 'per-prot
which only considers respondents who adhered to protocol in the study and compares

them based on treatment received, { Y: DiRi = 1} versus {Yi: ( - ZRi= 1}, using a tw
sample t confidence interval. Simulations reported in Table 1 are calculated over 10 000
datasets for each experimental condition, to ensure a standard error for the coverage rates
no larger than 0 5%.
The as-treated procedure grossly undercovers the true null values, and the per protocol
procedure is nearly as dreadful.

In the special case where the outcomes are missing at random, both ITT'V and ITTobs

This content downloaded from 206.253.207.235 on Thu, 24 Oct 2019 21:39:53 UTC
All use subject to https://about.jstor.org/terms

374 CONSTANTINE E. FRANGAKIS AND DONALD B. RUBIN

Table 1. Inferencefor Y1 - YO under latent ignorability and compound
coverage of nominal 95% intervals and mean squared error
R1= 0-5 (MAR) R1= 0-8 (NMAR)

Yl,l-Y1,o0= Yl,l-Y1,o= 1 Yl,l-Y1,o = o Yl,l-Y1,o= 1
1

-

U

02

03

04

02

03

04

02

03

04

02

03

04

Y,- YO 00 00 00 08 07 06 00 00 00 08 07 06
YOs/ YO 100 1 00 1 00 1 00 1 00 1 00 1 08 1 13 1 18 1 08 1 13 1 18
Coverage

as
per

treated
protocol

6
46

1
3

00
16

00
8

22.1

4.7

66.6

3

1

00

37.3

157

_
7

ITTobs 94.6 94 4 95 2 95.1 94 4 95.1 88.5 83.8 80 7 89 1 85 5 82.6
ITT IV 94 9 95.1 95 8 95.1 95.1 95 7 95 3 95.0 95.0 95.0 95 2 95 4
MSE

ITTobs 0 06 0 06 0 06 0 06 0 07 0 07 0 07 0 10 0.12 0 08 0 10 0.12
ITTIv 0 06 0 07 0 07 0 06 0 07 0 08 0 04 0 04 0 04 0 04 0 04 0 04

Asymptotically, the properties of the procedures are not exactly i
MAR, missing at random; NMAR, not missing at random

give good coverage. Also, since in this case noncompliance is not critically important, the
efficiency that can be gained by capitalising on the compound exclusion restriction with
our procedure trades off against the uncertainty about the various additional components
that the new procedure estimates, as the mean squared errors indicate.

When, however, the missing outcome mechanism, induced by latent ignorability, is not

ignorable, ITTobs considerably undercovers the intention-to-treat effect, even when it is
zero, with decreasing coverage as the proportion of never-takers (1 - U) increases, and is

inaccurate even with 80% compliance. In contrast, ITT'v maintains adequate coverage in
this case. Moreover, as suggested by the mean squared errors in these settings, ITTIV can
have substantially better overall accuracy relative to ITTobs under nonignorability.
4 2. Numerical results with deviationsfrom Assumption 1

In Table 2 we compare ITT'v to ITTobS with certain deviations from the latent ignorability
of Assumption 1. We only simulate results here under the null hypothesis and under

compound exclusion, so we first generate treatment assignments Zi, compliance covari

Ui and outcomes Yi conditional on Zi and Ui, as in the conditions of Table 1 for th
hypothesis. Then, response indicators Ri are generated as in the six conditions of H
Table 1, for each combination of Ui and Zi, except for the group of compliers in the
standard treatment arm. For this group, we create deviations from Assumption 1 by

generating response indicators Ri independently of outcomes Yi conditionally on a cov

ate Gi imperfectly correlated with Ui. Note that Y1(O) is a covariate in the sense t

does not change with assignment, and so, for simplicity, we choose Gi to be the indica
for whether or not Y1(0) exceeds the population average outcome for compliers at z = 0,
Y1,0. We generate Ri independently of Yi conditionally on Gi and with probabilities

pr(Rj=1jUi=1,Zj=O,Gj=k)=Pk (k=0,1).

The odds ratio r:=p(1-po)/{po(lp-Pi)} is a simple measure of deviation

Assumption 1. The values of r and R1O the marginal response rate for compliers at z =0O,
determine the probabilities Pi and Po by a simple relation. We take the parameters in

This content downloaded from 206.253.207.235 on Thu, 24 Oct 2019 21:39:53 UTC
All use subject to https://about.jstor.org/terms

Intention-to-treat analysis 375

Table 2. Inference for Y1 - YO under the deviati

coverage of nominal 95% intervals and m
1

-

U=o02

1

-

U=0

3

1

-

U=0

4

Odds ratio r Odds ratio r Odds ratio r
1
3
43
2
2
4

1

2

3

4

4
2
14
3
3
2

R1

4

3

=

2

0

5

Coverage

ITTobs 88.3 93 8 93.7 88 7 90.1 94 0 94 4 90 5 92.0 94 4 93 9 91 3

ITT1V 87 8 93 8 94 2 90 2 89.7 93 9 95 3 92 5 91 3 94 3 95 6 94 3

MSE

ITTobs 0 08 0 06 0 06 0 06 0 08 0 06 0 06 0 08 0 08 0 07 0 07 0 08
ITT1V 0 08 0 06 0 07 0 07 0 08 0 07 0 07 0 09 0 08 0 07 0 08 0 10
R1,o = 0 8

Coverage

ITTobs 93.5 910 85 0 80 9 90 3 87.4 80 3 75 9 86.5 83.8 78.2 72.6

ITT IV 93.3 94-7 94.7 93.4 93.5 94-7 94.5 94.1 94 5 94.8 95.1 94 5

MSE

ITTobs 0.05 0 06 0 08 0 10 0 07 0 08 0 11 0 13 0 09 0 10 0 13 0.15

ITTIV 0-04 0-04 0-04 0-04 0-04 0-04 0-04 0-04 0-04 0-04 0-04 0-04
Assumption 1 holds when r = 1; see Table 1.

Table 2 as in the null hypothesis of Table 1 for U, R and Yu, but with r= - - 4 and
to represent deviations ranging from half to twice the odds for response for above average

versus below average compliers at standard treatment. Sample sizes and number of replications for each condition are as in Table 1.

For conditions with R1,0 = 0 5, as with Table 1, ITT1v and ITT'bs are practically comp
able to each other, although they both experience some bias for the situations with most

extreme deviations from Assumption 1, r = 1 and r = 2.
When the compliance covariate is associated with missingness, represented by the con-

ditions with R1,0 = 0 8, we have two cases. First, values of r < 1 generate here deviatio
in the direction opposite to the bias that is apparent to an investigator who has knowledge

of the compliance covariates Ui but not of Gi. Secondly, values of r > 1 generate deviations
in the same direction as the bias generated by Ui alone. Under the small deviations of the
first type, r < 1, in Table 2, ITT'v is relatively robust, and there is some cancellation of the
bias of ITTObS relative to Table 1. Under the deviations of the second type, r > 1, the ITTobs
procedure performs notably poorly, whereas ITT'v performs quite well.
These observations also partly indicate what is expected when small deviations from
Assumption 1 exist in more than one cell defined by (U, Z). If these deviations are mostly

in one direction, the performances of ITT'v and ITTobS will either become more comparable
or will further favour ITT'V, relative to analogous cases where Assumption 1 holds. In
more likely cases, where small deviations from Assumption 1 can be in different directions
for different cells defined by (U, Z), then generally there will be a smaller overall component

of additional bias either to cancel or further increase the bias that is due to Ui alone. In
these cases, the comparisons between ITT'v and ITTobS are expected to be more analogous
to those under Assumption 1.
More generally, in practice, the comparison between ITT- and ITT-bS depends on the
unknown, underlying parameter values. In a given study, such a simulation can be con-

This content downloaded from 206.253.207.235 on Thu, 24 Oct 2019 21:39:53 UTC
All use subject to https://about.jstor.org/terms

376 CONSTANTINE E. FRANGAKIS AND DONALD B. RUBIN
ducted around plausible underlying parameters so that the comparison between the two

procedures can be more specific to the investigation in question.
5. APPLICATION TO CENSORED DATA
Often incomplete outcomes arise from censoring of a time-to-event, a survival time. In
this section we show how the ideas of ? 2 can be applied to identify the survival distri-

butions under our framework of all-or-none compliance. For the case of discrete-time
survival, Baker (1998) considers a related and independently developed approach.

Let Zi and D(wi, z) be as before. Now let
Y(oj , z), R (a), z), X(o- , z): = min { Y(o-) , z), R (a) , z)} A(O-) , z): = I {Y(O-) , z) < R (O-) , z)}
be, respectively, the survival and censoring times, their minimum and the indicator for

censoring if individual wi is assigned treatment z. Now the observed data are
{Zi, Di, Xi, Ai: i= 1, ..., n}, where Xi = X(i, Zi) and Ai = A(owi, Zi).
We focus on identifying the intention-to-treat survival curves S,(y) pr(Y > y IZi
for times y > 0 and assignment arms z = 0, 1. In this setting, intention-to-treat analysis
based on the Kaplan-Meier estimator (Kaplan & Meier, 1958) assumes independence
between censoring and survival times, e.g. Lee et al. (1991). If we argue as in ?? 2 2-2 3,
when censoring can be created by loss to follow-up or other potentially selective reasons,
it is more plausible if independent censoring is assumed only conditionally on the

compliance covariates Ui, as with latent ignorability, rather than unconditionally. This
assumption, however, renders the intention-to-treat Kaplan-Meier estimator generally
inconsistent for the survival curves. Nevertheless, under the compound exclusion restric-

tion, the survival curves Sj(y) are identifiable.
Let Su,z(y):= pr(Y > y I Ui = u, Zi = z). Under latent ignorability, we have that S0,0(
S0o(y) and
S(y) = (1- U)S01(y) + US1 0(y), S1(y) = (1 - U)S01(y) + USl (y). (5 1)

Assuming that all Su,(y) are absolutely continuous, the corresponding net hazard
AK,(y) exist. By virtue of latent ignorability, after stratification on the observ
Ui within the z = 1 arm, the Kaplan-Meier estimators for S0 1(y) and S 1l(y) are

Estimating the remaining curve of interest, S1,0(y), is more subtle because

indirect conditioning on the missing covariates Ui within the z = 0 arm. To proceed, we
express the associated hazard function, Alio(y), in terms of easily estimable quantities:

Fu,z(y):=pr(Xi<?y,Ai=1lUi =u,Zi=z), Fz(y):=pr(Xi <y,Ai=1IZi=z),
Hu,z(y) =Upr(Xi>yjUi=U, Zi=z), Hz(y):=pr(Xi > yjZi=Z),
for u, z E {0, 1}. Using the law of toYtal probability and the compound exclusion restriction,
we have

Fo(y) = (1- U)Fo 1(y) + UF1 0(y), Ho(y) = (1- U)H0 1(y) + UH1, 0(y).
By standard results, the hazard function sought, Alo(y), is

dy

{ dF.(Y) d_ -v {dFt')(1 1U) ?d Y}{Ho(y) -( 1-U)H01r(Y)} -' ( 52)

This content downloaded from 206.253.207.235 on Thu, 24 Oct 2019 21:39:53 UTC
All use subject to https://about.jstor.org/terms

Intention-to-treat analysis 377

We may now use empirical estimates for the right-hand side of (5 2) to estimate the

survival curve S1,0(y). Define the stochastic processes
Ni(y) =I(Xi_<y,Ai= 1), Qi(y) =I(Xi_>y) (i=1,. .. .,n)
and

N0,1(y):= E Ni(y)I(Ui = 0)I(Zi = 1), Qo,1(y):= E Qi(y)I(Ui = 0)I(Zi = 1),
i

i

N"bs(y):= , Ni(y)I(Zi = O), Qo(Y):= ,Qi(y)I(Zi = ).
i

i

Unde
Ft
S10(y) = exp L - J
QNo(u)/n0-Q1(u)/n1(53)

Y

where no, n1 are the numbers of individuals randomised to s
arm respectively. An outline of the proof is given in the Appendix. This result establishes

identifiability of the intention-to-treat survival curves (541) under latent ignorability and
compound exclusion even in situations where the intention-to-treat Kaplan-Meier estimators are inconsistent.

6. FINAL REMARKS

An alternative approach to the analytical methods discussed here could be to construct
bounds for the treatment effect (Robins, 1989; Manski, 1990; Balke & Pearl, 1997). The
least favourable bounds are not generally very informative, e.g. Imbens & Rubin (1997),
and some additional subject-matter constraints typically are needed to interpret the data
from such a study using this approach, e.g. Robins & Greenland (1996). A more general
approach is to study sensitivity of the results to deviations from the posited assumptions,
e.g. Rosenbaum & Rubin (1983), where the extreme results correspond to bounds.
Our methods, discussed for binary observed compliance for each subject in the new
treatment arm, can be directly extended to allow for such compliance behaviour in the
standard treatment arm as well, simply by extending Assumptions 1 and 2. For situations
where all-or-none observed compliance is not realistic, some further assumptions will be
required to address this problem. Barnard et al. (1998) describe a template for applying
the ideas presented here to a large social science dataset.

ACKNOWLEDGEMENT

The authors are grateful to Stuart Baker and Marvin Zelen for fruitful discussions, to
the editor and to anonymous referees for suggestions that improved the focus and presentation of the arguments, and to the U.S. National Science Foundation for financial support.

APPENDIX
Proofs

Proof of Lemma 1. Using (2 5) to solve (2 4) for Y1,Z, we obtain for z = 0
Vobs D_Y0 R011 - U)

1,0-R,,

This content downloaded from 206.253.207.235 on Thu, 24 Oct 2019 21:39:53 UTC
All use subject to https://about.jstor.org/terms

378 CONSTANTINE E. FRANGAKIS AND DONALD B. RUBIN

If we use Ro = R10 U + Ro 1(1 - U) to replace R1,o U, Lemma 1 follows. n
Proof of Result 2. Using the expressions in (3 2) for Y1,o and Y10o, respectively, to expand
n2(Y - o Y1,o) in a Taylor series, we obtain

n (ln~ Y1) = n2(U-U) + 62n(O, -YOl) + 3n (Ro,j - Roj)
+64n (Ro-Ro) -RY+ b5n(Yos - Ybs) + (1), (A 1)
where 6 = (61, 62, 63, 64, 65)' are as defined in Result 2. Under the definitions in ?23 and the
expressions in (3 3), it is not difficult to show that, marginally, all of

n2(U - U), n , -Y0,1), n4(RO,1 - Ro 1), n (RO - Ro) n-2(Yobs - ybs)
in (A- 1), are asymptotically normal with mean 0 and variances V = (V1, V2, V3, V4, V5)', respectively,

as defined in Result 2. Also, it can be shown that the five quantities in the last expression are

asymptotically independent, by further expanding the denominators of their defining expressions,
see ? 3, in Taylor series and using Slutsky's theorem. Result 2 then follows from (Al1). n

Outline of proof of consistency of S1,0(y) for S1,0(y). We define the empirical estimates

Ngobs( No,1 (y)Q()Qo()

Fo(y) 0 (y), F(Y)= ( IU) Ho(y) = Qo(Y) Ho,,(y) = (lu). (A 2)

Using S1, (y) = exp f- '1,0 (u) du}, and expressions (5 2) and (A 2), we obtain the estimato
of (5-3). By standard results, Ho(y) and Ho01(y) are uniformly consistent for Ho(y) and H

respectively. Then, provided there exists a fixed time Yrn such that the curves Su,(y
pr(Ri > yI Ui = u, Zi = z) are bounded away from 0 for all y in [0, y,] and u, z e {0, 1},

consistency of S1,0(y) for S1,0(y) in [0, ym] follows from Theorem 2.4.2 of Gill (1986), i.e. Le

inequality, and a triangle inequality.

REFERENCES

ANGRIST, J. D., IMBENS, G. W. & RUBIN, D. B. (1996). Identification of causal effects using instrumental

variables (with Discussion). J. Am. Statist. Assoc. 91, 444-72.
BAKER, S. G. (1994). Regression analysis of grouped survival data with incomplete covariates: nonignorable
missing data and censoring mechanisms. Biometrics 50, 821-6.
BAKER, S. G. (1998). Analysis of survival data from a randomized trial with all-or-none compliance: estimating
the cost-effectiveness of a cancer screening program. J. Am. Statist. Assoc. 93, 929-34.
BAKER, S. G. & LINDEMAN, K. S. (1994). The paired availability design: a proposal for evaluating epidural
analgesia during labor. Statist. Med. 13, 2269-78.
BALKE, A. & PEARL, J. (1997). Bounds on treatment effects from studies with imperfect compliance. J. Am.
Statist. Assoc. 92, 1171-6.
BARNARD, J., Du, J., HILL, J. & RUBIN, D. (1998). A broader template for analyzing broken randomized

experiments. Sociol. Meth. Res. 27, 285-318.
DURBIN, J. (1954). Errors in variables. Rev. Int. Statist. Inst. 22, 23-32.
FARWELL, J. R., LEE, Y., HIRTZ, D., SULZBACHER, S., ELLENBERG, J. & NELSON, K. (1990). Phenobarbital for
febrile seizures Effects on intelligence and on seizure recurrence. New Engl. J. Med. 322, 364-9.
GILL, R. D. (1986). Censoring and Stochastic Integrals, Mathematical Centre Tracts 124, 3rd ed. Amsterdam:
Mathematisch Centrum.
GOLDBERGER, A. S. (1972). Structural equation methods in the social sciences. Econometrica 40, 979-1001.
GORDON, M. E. & SCHECHTMAN, K. B. (1990). Patient compliance; a covariate in randomized clinical trials.
In Proc. Biopharm. Sect., Am. Statist. Assoc., pp. 24-33. Alexandria, VA: American Statistical Association.

HOLLAND, P. (1986). Statistics and causal inference. J. Am. Statist. Assoc. 81, 945-70.
IMBENS, G. W. & RUBIN, D. B. (1997). Bayesian inference for causal effects in randomized experiments with
noncompliance. Ann. Statist. 25, 305-27.
KAPLAN, E. L. & MEIER, P. (1958). Nonparametric estimation from incomplete observations. J. Am. Statist.
Assoc. 53, 457-81.
KLEINMAN, K. P., IBRAHIM, J. G. & LAIRD, N. M. (1998). A Bayesian framework for intent-to-treat analysis
with missing data. Biometrics 54, 265-78.

This content downloaded from 206.253.207.235 on Thu, 24 Oct 2019 21:39:53 UTC
All use subject to https://about.jstor.org/terms

Intention-to-treat analysis 379
LEE, Y. J., ELLENBERG, J. H., HIRTZ, D. G. & NELSON, K. B. (1991). Analysis of clinical trials by treatment
actually received: is it really an option? Statist. Med. 10, 1595-605.
LITTLE, R. J. A. & RUBIN, D. B. (1987). Statistical Analysis with Missing Data. New York: Wiley.
LITTLE, R. & YAU, L. (1996). Intent-to-treat analysis for longitudinal studies with drop-outs. Biometrics
52, 1324-33.

MANSKI, C. F. (1990). Non-parametric bounds on treatment effects. Am. Econ. Rev., Papers Proc. 80, 319-23.
MARK, S. D. & ROBINS, J. M. (1993). Estimating the causal effect of smoking cessation in the presence of
confounding factors using a rank preserving structural failure time model. Statist. Med. 12, 1605-28.
NEYMAN, J. (1923). On the application of probability theory to agricultural experiments: essay on principles,

Section 9. Transl. (1990) Statist. Sci. 5, 465-80.
REUBEN, D., BOROK, G., WOLDE-TSADIK, G., ERSHOFF, D., FISHMAN, L., AMBROSINI, V., Liu, Y., RUBENSTEIN, L.
& BECK, J. (1995). Randomized trial of comprehensive geriatric assessment in the care of hospitalized
patients. New Engl. J. Med. 332, 1345-50.
ROBINS, J. M. (1989). The analysis of randomized and non-randomized AIDS treatment trials using a new
approach to causal inference in longitudinal studies. In Health Service Research Methodology: A Focus on
AIDS, Ed. L. Sechrest, H. Freeman and A. Bailey, pp. 113-59. Washington, DC: National Center for Health
Services Research, U.S. Public Health Service.
ROBINS, J. M. & GREENLAND, S. (1994). Adjusting for differential rates of prophylaxis therapy for PCP in
high- versus low-dose AZT treatment arms in an AIDS randomized trial. J. Am. Statist. Assoc. 89, 737-49.
ROBINS, J. M. & GREENLAND, S. (1996). Comment on paper by J. D. Angrist, G. W. Imbens and D. B. Rubin.
J. Am. Statist. Assoc. 91, 456-8.

ROSENBAUM, P. R. & RUBIN, D. B. (1983). Assessing sensitivity to an unobserved binary covariate in an
observational study with binary outcome. J. R. Statist. Soc. B 45, 212-8.
RUBIN, D. B. (1974). Estimating causal effects of treatments in randomized and nonrandomized studies.
J. Educ. Psychol. 66, 688-701.

RUBIN, D. B. (1976). Inference and missing data. Biometrika. 63, 581-92.
RUBIN, D. B. (1978). Bayesian inference for causal effects. Ann. Statist. 6, 34-58.
RUBIN, D. B. (1998). More powerful randomization-based p-values in double-blind trials with noncompliance.
Statist. Med. 17, 371-87.
SCHECHTMAN, K. & GORDON, M. (1988). The relationship between treatment compliance and the design and
analysis of clinical trials. In Proc. Biopharm. Sect., Am. Statist. Assoc., pp. 182-7. Alexandria, VA: American
Statistical Association.
SHEINER, L. B. & RUBIN, D. B. (1995). Intentions-to-treat analysis and the goal of clinical trials. Clin.
Pharmacol. Therapy 56, 6-10.

SOMMER, A. & ZEGER, S. (1991). On estimating efficacy from clinical trials. Statist. Med. 10, 45-52.
THE CORONARY DRUG PROJECT RESEARCH GROUP (1980). Influence of adherence to treatment and response
of cholesterol on mortality in the coronary drug project. New Engl. J. Med. 303, 1038-41.
ZELEN, M. (1979). A new design for randomized clinical trials. New Engl. J. Med. 300, 1242-5.
ZELEN, M. (1990a). Randomized consent designs for clinical trials: an update. Statist. Med. 9, 645-56.

ZELEN, M. (199Gb). Discussion of presidential address: 'Biostatistical collaboration in medical research' by
J. H. Ellenberg. Biometrics 46, 28-9.

[Received July 1997. Revised November 1998]

This content downloaded from 206.253.207.235 on Thu, 24 Oct 2019 21:39:53 UTC
All use subject to https://about.jstor.org/terms

