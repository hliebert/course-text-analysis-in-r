INFERENCE WITH DIFFERENCE-IN-DIFFERENCES AND OTHER
PANEL DATA
Stephen G. Donald and Kevin Lang*
Abstract—We examine inference in panel data when the number of groups
is small, as is typically the case for difference-in-differences estimation
and when some variables are fixed within groups. In this case, standard
asymptotics based on the number of groups going to infinity provide a
poor approximation to the finite sample distribution. We show that in some
cases the t-statistic is distributed as t and propose simple two-step
estimators for these cases. We apply our analysis to two well-known
papers. We confirm our theoretical analysis with Monte Carlo simulations.

I.

Introduction

M

ANY policy analyses rely on panel data in which the
dependent variable differs across individuals, but at
least some explanatory variables, such as the policies being
studied, are constant among all members of a group. For
example, in the typical difference-in-differences model, we
regress outcomes at the individual level (for example, employment in a firm in state s in year t) on a policy that
applies to all individuals in the group (for example, the
minimum wage in state s in year t). Moulton (1990) shows
that in regression models with mixtures of individual and
grouped data, the failure to account for the presence of
common group errors can generate estimated standard errors that are biased downward dramatically.1 The differencein-differences estimator is a special case of this model.
Researchers use a number of standard techniques to
adjust for common group effects:
●

random-effects feasible GLS estimation, which under
certain conditions is asymptotically efficient,
● correcting the standard errors using the error covariance matrix based on common group errors as in
Moulton,
● correcting the standard errors using a robust covariance estimator according to a formula developed by
Liang and Zeger (1986) and more commonly known as
the Stata cluster command.
This paper makes two simple but, we believe important,
points. First, when applied to variables that are constant
Received for publication October 29, 2004. Revision accepted for
publication March 2, 2006.
* University of Texas at Austin; and Boston University and NBER,
respectively.
This paper was written in part while Lang was visiting the Massachusetts Institute of Technology. We are grateful to them for their hospitality
and to Josh Angrist, Eli Berman, George Borjas, David Card, Jon Gruber,
Larry Katz, Alan Krueger, and participants in workshops at Boston
University and MIT for helpful comments. Donald thanks the Sloan
Foundation and the National Science Foundation (SES-0196372) for
research support. Lang thanks the National Science Foundation for support under grant SES-0339149. The usual caveat applies.
1 See also Kloek (1981), who considered the bias in standard errors, as
well as the relationship between OLS and GLS in the case where only
group-level regressors are present.

within a group, the t-statistics generated using each of these
techniques for correcting for common group errors are
asymptotically normally distributed only as the number of
groups goes to infinity.
Second, under standard restrictions, the efficient estimator can be implemented by a simple two-step procedure, and
the resulting t-statistic may have, under restrictions on the
distribution of the group-level error, an asymptotic t-distribution as the number of observations per group goes to
infinity. In addition, under more restrictive assumptions,
when the same procedure is used in finite samples, the
t-statistics have a t-distribution.
Consequently, standard asymptotics cannot be applied
when the number of groups is small, as in the case where we
compare two states in two years, two cities over a small
number of years, or self-employed workers and employees
over a small number of years. In such cases, failing to take
account of the group-error structure will not only generate
underestimates of the standard errors as in Moulton, but
applying the normal distribution to corrected t-statistics will
dramatically overstate the significance of the statistics.
Standard asymptotics should apply to comparisons across
all fifty states, although other problems may arise in common time series/cross-section estimates based on states and
using long panels (see Bertrand, Duflo, & Mullainathan,
2004).2
In the next section, we first present an intuitive argument
and then formalize the conditions under which we can
derive the distribution of the t-statistic when the number of
groups is small. Readers who are not interested in the details
can skip the later part of this section and proceed to the third
section, where we discuss the common two-group/twoperiod case and also apply our approach to two influential
papers: the Gruber and Poterba (1994) paper on health
insurance and self-employment and Card’s (1990) study of
the Mariel boatlift. We show that analyzing the t-statistic,
taking into account a possible group-error component, dramatically reduces our estimate of the precision of their
results.
In the fourth section, we consider two other approaches to
common group errors, the Moulton correction and the commonly applied Stata cluster correction. In the fifth section,
we present Monte Carlo evidence regarding the distribution
of the t-statistic using a variety of estimators. Our results
indicate that the t-statistics produced by standard estimators
have distributions that differ quite substantially from both
the normal and the t-distributions. However, when the
theory predicts that they should, the two-step estimators we
2 For other recent work related to difference-in-differences methodology,
see Abadie (2005) and Athey and Imbens (2005).

The Review of Economics and Statistics, May 2007, 89(2): 221–233
© 2007 by the President and Fellows of Harvard College and the Massachusetts Institute of Technology

222

THE REVIEW OF ECONOMICS AND STATISTICS

propose produce t-statistics with approximately a t-distribution with degrees of freedom equal to number of groups
minus number of group-constant variables. Moreover, one
of the two-step estimators we consider appears to be reasonably robust to the departures from the assumptions
needed to guarantee that the t-statistic has a t-distribution.
II.

The Error Components Model with a Small Number
of Groups

We begin with a standard time series/cross-section model
of the form
Y is ⫽ a ⫹ X s ␤ ⫹ Z is ␥ ⫹ ␣ is ⫹ ε is ,

(1)

where ␣is is an error term that is correlated within group s,
and εis is an individual-specific term that is independent of
the other errors. With a single cross section, Y might be
income, X state laws, and Z characteristics of individuals. In
this case it would be natural to follow Moulton and assume
that ␣ is a state effect that does not vary among members in
a group, that is that ␣is ⫽ ⌺i␣is/Ns ⬅ ␣s. We do not require
that the error term take the Moulton structure, only that the
␴2␣ (the variance of ␣s) depend only on the number of
observations from group s and that, as group size gets large,
it converge in probability to some finite value.3
If the covariance matrix of the error term is known, GLS
estimation of equation (1) is efficient. With some regularity
conditions, feasible GLS is efficient if the covariance matrix
can be estimated consistently. Depending on the structure of
the covariance matrix, GLS can be computationally burdensome. Moreover, if the exact structure of the dependence is
unknown, GLS estimation may be infeasible.
Estimating ␤ in two stages is often computationally
simpler. In this case, we use OLS to estimate
y ⫽ Z␥ ⫹ W⌫ ⫹ ε,

(3)

We then can use the estimated ⌫ˆ in GLS estimation of
⌫ˆ s ⫽ X s ␤ ⫹ ␣ s ⫹ 共 ⌫ˆ s⫺⌫ s),

(i) if the number of observations per group is large, or
(ii) if there are no within-group varying characteristics
and the number of observations is the same for all
groups.
Second, when the error term in equation (4) is homoskedastic, by standard theorems, OLS estimation of equation
(4) is efficient. Since OLS estimation of equation (4) is
numerically equivalent to feasible GLS estimation of equation (1), we have full efficiency of estimation even when the
number of groups is small.
We begin our formal treatment with the case where all
variables are fixed within groups.
A. Only Within-Group-Constant Explanatory Variables

We begin by treating the case where Xs is a scalar and
there are no within-group varying explanatory variables
(␥ ⫽ 0), so that

(2)

where W is a set of dummy variables indicating group
membership. Note that
⌫ ⫽ X␤ ⫹ ␣.

methods for obtaining consistent estimates of the covariance
terms. If so, the equivalence is asymptotic rather than
numeric.
Our contribution is twofold. First, we can see from
equation (4) that if the number of groups is small, then it is
not possible to rely on the consistency of estimates of ␴2␣ to
justify feasible GLS estimation of equation (4). However, if
ˆ is homoskedastic and diagonal, by the usual
␴2␣I ⫹ var(⌫)
arguments, it is still possible to obtain an unbiased estimate
of the variance of the error term in equation (4). Under
normality assumptions on ␣s, the resulting t-statistic will
have a t-distribution rather than a normal distribution. We
explore circumstances under which the assumption of homoskedasticity is reasonable. In particular, the error term
will be homoskedastic under at least two circumstances:

(4)

ˆ
where the error term has variance ␴2␣I ⫹ var(⌫).
Amemiya (1978) shows that if the covariance matrices of
␣ and ε are known, then the two-step procedure and the
GLS procedure applied directly to equation (1) are numerically identical. If instead feasible GLS is used, then provided the covariance terms are estimated in the same fashion, numerical equivalence continues to hold. More
commonly, the two approaches lend themselves to different
3 Thus in a time series/cross-section context, we might have ␣ ⫽ ␳␣
t,s
t⫺1,s ⫹
␮t,s with 0 ⬍ ␳ ⬍ 1, which would satisfy this requirement.

Y is ⫽ a ⫹ X s ␤ ⫹ ␣ is ⫹ ε is .

(5)

This case provides much of the intuition for the more
general case.4
Throughout we will assume that the εis are independent of
each other and of ␣ for all i and s. We further assume that
␣is and ␣js⬘ are independent for s ⫽ s⬘, but do not assume
that ␣is and ␣js are uncorrelated.
The two-step estimator in this case has a very simple
interpretation. The first stage is equivalent to taking group
means,

d̂ s ⫽

冘

Ns
i⫽1

Ns

Y is
,

(6)

so that the second stage becomes
4 Kloek (1981) provides some analysis of this model when the residual
in the model is equicorrelated.

INFERENCE WITH DIFFERENCE-IN-DIFFERENCES

d̂ s ⫽ Y៮ s ⫽ a ⫹ X s ␤ ⫹

冘

Ns
i⫽1

Ns

␣ is
⫹

冘

Ns
i⫽1

Ns

ε is
(7)

⬅ a ⫹ X s␤ ⫹ ␣ s ⫹ ε s

(8)

⬅ a ⫹ X s␤ ⫹ ␩ s,

(9)

which is just the “between-groups” estimator of ␤.
A few points follow immediately from the equivalence of
GLS estimation of equations (5) and (9).
(i) ␤ can always be estimated efficiently by appropriate
weighted least squares estimation of equation (9) if
the weights are known or by feasible weighted least
squares if they can be estimated consistently.
(ii) If either ␩ is homoskedastic or var(␩s) is uncorrelated with Xs, then the efficient estimator is the
unweighted between estimator. Note that homoskedasticity is a natural assumption either when all
groups have the same number of observations (Ns ⫽
N,@S) or when the number of observations in each
group is large.
The latter point demonstrates that in many circumstances
unweighted between-group estimation is the most efficient
estimator5 and that this efficient estimator can be achieved
without knowledge of the exact covariance structure of ␣,
although as noted this does require that the variance of ␩s is
constant across groups.
Inference: It should be apparent that our ability to
perform inference on ␤ˆ depends primarily on S and not on
Ns. If the number of groups is large, then the standard
theorems establish that when ␩ is homoskedastic, ␤ˆ ols is
normally distributed and the t-statistic follows the normal
distribution. When ␩ is heteroskedastic, the same is true
either for feasible GLS or for appropriately calculated
standard errors.
In many cases it will be natural to treat S as large and the
error term as homoskedastic. For example, studies that use
difference in laws across states and have large samples for
all fifty states are likely to meet this requirement approximately. However, in many applications the number of
groups is small. The well-known Card and Krueger (1994)
minimum-wage study is a case in point in which there is a
large number of observations per group but only four groups
(New Jersey before and after the law and eastern Pennsylvania before and after the law). Other studies (Gruber &
Poterba, 1994; Card, 1990; Eissa & Liebman, 1996) are
based on a small number of group/year cells.
When the number of groups is small, in order to have a
standard solution for the distribution of the t-statistic, we
require that ␩ be i.i.d. normally distributed. Below, we
5

This point is made in a somewhat different context by Dickens (1990).

223

present formal sufficient conditions for this requirement to
be satisfied.
If the distribution of ␩ is i.i.d. normal, then it follows
from standard theorems that the t-statistic for ␤ˆ has a
t-distribution with S ⫺ 2 degrees of freedom. In effect,
failure to recognize that the variance of the error term is
estimated using very few observations can dramatically
overstate the significance of findings.
Why does the distribution of T̂ remain t despite the large
number of observations? The answer is quite intuitive. If we
relied on published census data to estimate a relation based
on the New England states, we would automatically assume
that the resulting t-statistic had a t-distribution. Relying on
the underlying individual data cannot help us if all of the
information in the data is included in the mean.
Somewhat more formally, rewrite equation (9) as
Ỹ s ⫽ X̃ s ␤ ⫹ ␩˜ s ,

(10)

where ˜ denotes a deviation from the mean. The usual
t-statistic for hypotheses concerning ␤ is given by
T̂ ⫽

ˆ ⫺␤
␤
␴ˆ ␩ 共

冘 X̃ 兲
2
s

s

ˆ ␩2 ⫽
␴

1/ 2 ,

冘

1 S
ˆ 2.
共Ỹ ⫺ X̃ s ␤兲
S ⫺ 2 s⫽1 s

(11)

Given this fact, we can easily see that it will be reasonable to use a t(S ⫺ 2) distribution for conducting inference
whenever ␩s is exactly or is approximately a homoskedastic
normal random variable.
Finite Sample Result: Here for the T̂ statistic to have an
exact t(S ⫺ 2) distribution it is sufficient that

␩s ⫽

冘

Ns
i⫽1

␣ is

Ns

⫹

冘

Ns
i⫽1

Ns

ε is
⬃ N共0, ␴ ␩2 兲,

where it is important that ␴2␩ is constant across s. Although
there may be a variety of conditions, the most obvious case
is where ␣is ⫽ ␣s ⬃ N (0, ␴2␣) for all i, εis ⬃ N (0, ␴ε2) and
Ns ⫽ N for all s so that ␩s ⬃ N (0, ␴2␩), where
␴ ␩2 ⫽ ␴ ␣2 ⫹

␴ ε2
.
N

(12)

This is the standard random-effects time series/cross-section
model as well as the specification used by Moulton. This
includes the possibility that there are no group-specific
effects.
Large Sample Result: For the T̂ statistic to have a
distribution that is well approximated by t(S ⫺ 2), it is
sufficient that there be large Ns and that
␩ s ˜A N共0, ␴ ␩2 兲,

(13)

224

THE REVIEW OF ECONOMICS AND STATISTICS

which requires some form of asymptotic theory regarding ␩s
with Ns 3 ⬁ but with the number of groups fixed. Here
there are at least two interesting possibilities.
(i) For each s, ␣is ⫽ ␣s ⬃ N (0, ␴2␣) for all i and εis
satisfy conditions for a Law of Large Numbers to
imply that

冘

Ns

plimN s3⬁

i⫽1

B. Variables that Vary Within Group

εis

Ns

⫽ 0.

In this instance
plimNs3⬁␩s ⫽ ␣s ⬃ N共0, ␴␣2 兲
so that condition (13) is met. This does not require that
Ns be the same in all groups, but for the approximation
to be valid we would need all groups to have large Ns
so that (14) is approximately true.
(ii) For each s, ␣is ⫽ ␣s ⬃ N(0, ␴2␣/Ns) for all i, εis satisfy
conditions for a Central Limit Theorem, and Ns/Nt 3
1 for any s ⫽ t then,
␩s ˜A N共0,共␴␣2 ⫹ ␴ε2 兲/Ns 兲,
where the variance asymptotically does not depend
on s. This case is possible under a parameter sequence that keeps ␴2␣ of the same (or smaller) order
as ␴ε2/Ns, as might be appropriate when the group
effects are relatively small. Indeed, this includes the
possibility that ␣s ⫽ 0 so that there are no groupspecific effects. Also note that in this case we do not
require normality for the εis, but for the approximation to be a good one we require that there be similar
numbers of observations per group.
There may be other possibilities in the large sample case,
although we refrain from giving more explicit conditions.
For instance, provided that one can show that if ( i ␣is)/Ns is
approximately normal (with constant variance independent
of s asymptotically) and that εis satisfy conditions for a Law
of Large Numbers, then the condition in (13) will hold and
using a t(S ⫺ 2) will provide a good approximation. There
are a variety of possible assumptions one could use to obtain
the approximate normality of ( i ␣is)/Ns that relate to the
dependence across observations within a group—the simplest case is given in (i) above, but it is apparent that the
two-stage technique can accommodate inference even when
the nature of the dependence within groups is unknown,
provided that there is no correlation of errors across groups.6
Also, as in case (ii), for this result to hold one would require
Ns to be (asymptotically) constant across groups.
It is worth noting that estimating the between-group
estimator is a matter of convenience. When Ns ⫽ N, the

冘

冘

6

between-group and OLS estimators are identical. If Ns/Nt 3
1@s, t, then OLS converges to the between-groups estimator.
Therefore, it is possible to calculate a corrected standard
error for the OLS estimate and generate a t-statistic that has
a t-distribution. The between-groups estimator is, however,
much more convenient.

For more on this see Andrews (2005) and references therein.

We consider now hybrid models in which some variables
differ across observations within groups. For simplicity we
ignore complications associated with nonconstant correlation of the group effect since they do not add to the analysis.
As was seen in the discussion without within-group varying
variables, all that is important is the variance of the mean
group error.
Thus we analyze the standard Moulton model
Y is ⫽ a ⫹ X s ␤ ⫹ Z is ␥ ⫹ ␣ s ⫹ ε is .

(15)

We assume for simplicity that Yis and Xs are scalars. The
extension to the case of more than one group-varying or
group variable is straightforward.
We further assume that
␣ s ⬃ N共0, ␴ a2 兲

for all s,

ε is ⬃ N共0, ␴ ε2 兲

for all i, s,

and that these residuals are mutually independent for all i
and s.
As before, we know that GLS estimation of equation (15)
is efficient and that if we can obtain consistent estimates of
␴2␣ and ␴ε2, feasible GLS estimation is asymptotically efficient. Finally, we know from Amemiya (1978) that if these
variance terms are estimated in the same way, feasible GLS
estimation is numerically identical to the following estimator—first use OLS to estimate the “within-group” estimate
of ␥
Y is ⫽ d s ⫹ Z is ␥ ⫹ ε is .

(16)

Then estimate ␤ by feasible GLS estimation of
Y៮ s ⫺ Z៮ s ␥៮ ⫽ d̂ s ⫽ a ⫹ ␤X s ⫹ u s ,
where
Y៮ s ⫽

冘

Ns
i⫽1

Ns

Y is
,

Z៮ s ⫽

冘

Ns
i⫽1

Ns

(17)

Z is
,

d̂s is the estimate of ds in equation (16), and
var共u兲 ⫽ ␴␣2 I ⫹ ⌺d̂ ,

冘

where d̂ is the covariance matrix of the fixed-effect parameter estimates.

INFERENCE WITH DIFFERENCE-IN-DIFFERENCES

冘

Note that estimates of d̂ can be obtained by selecting the
covariance matrix corresponding to the fixed effects. ␴2 can
be estimated by first estimating equation (17) by OLS and
then using

冘

S
i⫽1

û i2

S⫺K

⫺

冘

1 S
ˆ a,
var共d̂i 兲 ⫽ ␴
S i⫽1

where var(d̂i) is the variance of the ith fixed effect and K is
the number of explanatory variables in equation (17).
Finally, it is worth noting that since the groups are
distinct, covariance of the d̂’s arises only because ␥ is estimated
rather than known. If each ␥ˆ i is calculated from a separate
sample, the covariances will be zero. Thus, the covariance
problem can be avoided by estimating ␥ for the sth state as
␥ˆ 共s兲 ⫽ 共Z⬘s M s Z s 兲 ⫺1 Z⬘s M s Y s ,

(18)

where
M s ⫽ I N s ⫺ ␫ N s共␫⬘N s␫ N s兲 ⫺1 ␫⬘N s,
and tNs, is a vector of 1s of length Ns.
Since ␥ˆ W involves the restriction that ␥ is constant across
states, it is more efficient but less robust.7 Our focus,
however, is not on estimation of ␥ but of ␤.
When the number of groups is large, it is possible to
estimate equation (17) by feasible GLS. If the number of
groups is small, then we can still get efficient estimates and
determine the distribution of the t-statistic if the error term
in equation (17) is i.i.d. normal, except possibly for an error
term common to all groups. The following propositions
summarize conditions under which this condition holds and
the resulting t-statistic has the t-distribution.
Let T̂1 be the t-statistic using ␥ˆ w and T̂2 be the t-statistic
using ␥ˆ (s).
Proposition 1: If the εis are normally distributed,
(i) T̂1 ⬃ t(S ⫺ 2) when Ns are identical for all s and
either (a) there are no Zis or (b) Z៮ s is constant across s.
The greater robustness of the estimator using ␥ˆ (s) gives rise to an
additional issue. If ␥ˆ varies across groups, then generally d̂s and thus ␤ˆ
will not be invariant to linear reparameterization of the Z’s. ␥ˆ may vary
across groups because of (a) sampling variation, (b) differences in ␥ across
groups that are related to the policy intervention being studied, or (c)
differences in ␥ across groups that are unrelated to the policy intervention
being studied. The first problem should vanish as the number of observations per group becomes large. In the second case, it is not meaningful to
discuss a single treatment effect that is constant across groups. This is
analogous to the case where the return to schooling differs between whites
and blacks. One cannot then estimate a single black-white wage differential for all schooling groups. In the last case, we can think of ␥(s) as a
random variable. As the number of groups gets large, ␤ˆ will be independent of the parameterization, but since we are interested in the case where
the number of groups is small, invariance is a problem that can be avoided
by relying on ␥ˆ W.
7

225

(ii) T̂2 ⬃ t(S ⫺ 2) when Ns are identical for all s and
៮s (Z⬘is Ms Zs)⫺1Z៮s is
either (a) there are no Zis or (b) Z⬘
constant across s.
We can also show that the statistics will have asymptotic
t(S ⫺ 2) distributions under more general situations so that
the t(S ⫺ 2) distribution can be used quite generally.
Proposition 2: If the εis are not normally distributed and
if ␴2␣ is fixed, then T̂j ˜A t(S ⫺ 2) (for j ⫽ 1, 2) when Ns 3
⬁ for all s.
As in the case where there are no individual-specific
covariates, one can show that the statistics T̂j will be
approximately t(S ⫺ 2) when the group-specific errors are
small relative to the idiosyncratic errors.
The conditions that give rise to this are essentially asymptotic analogs of the conditions in proposition 1.
Proposition 3: If ␴2␣ is small in the sense that ␴2␣ ⫽
O(Ns⫺1/2), then regardless of the distribution of εis
(i) T̂1 ˜A t(S ⫺ 2) when Ns are asymptotically identical8
for all s and either (a) there are no Zis or (b) p lim Z៮s
is constant across s.
(ii) T̂2 ˜A t(S ⫺ 2) when Ns are asymptotically identical
៮s
for all s and either (a) there are no Zis or (b) p lim Z⬘
(Z⬘s MsZs/Ns)⫺1Z៮s is constant across s.
These situations can be stated with reference to the
residuals in the second-stage equation:
៮ s ␥ˆ ⫽ a ⫹ ␤X s ⫹ ␣ s ⫹ ε៮ s ⫹ Z⬘
៮ s 共␥ ⫺ ␥兲.
ˆ
Y៮ s ⫺ Z⬘

(19)

For the distribution of the t-statistic to be exactly t, we
require that the error term be normally distributed and i.i.d.
except possibly for a common component for all observations. When all groups have the same sample size, we can
readily check whether
Z៮s is identical across groups, in the case where we use the
within estimator to obtain ␥ˆ w: or
var(␥ˆ (s)) is identical for all groups, in the case where ␥ is
estimated separately for each group.
The t(S ⫺ 2) can be justified as an approximation based
on large Ns asymptotics under more general conditions. This
occurs because the error term in equation (19) converges to
the homoskedastic normal error ␣s as Ns 3 ⬁ because of the
consistency of ␥ˆ and the fact that ε̌៮ s 3P 0 by the usual Law
of Large Numbers. When ␴2␣ is small, as in proposition 3,
៮s (␥⫺␥ˆ )
the approximation can be justified because ε៮ s and Z⬘
are approximately normally distributed by the Central Limit
Theorem so that the error term in equation (19) is approximately normal.
8 We say that the N are asymptotically identical provided that p lim
s
Ns/Nt ⫽ 1 for all s and t.

226

THE REVIEW OF ECONOMICS AND STATISTICS

While the theory above and the Monte Carlo evidence
below suggest that using one of the two-stage estimators
will generally be preferable to using OLS, there are two
caveats that must be recognized. First, when ␴2␣ ⫽ 0, OLS
is the preferred estimator of equation (15) and the t-statistic
has the conventional distribution. If one knows that ␴2␣ ⫽ 0,
OLS is the preferred estimator. What proposition 3 tells us
is that if we proceed under the mistaken belief that ␴2␣ ⬎ 0,
two-stage estimation will still produce a statistic with a
t-distribution.
Second, the distinction between two-stage estimation and
one-stage estimation is really one of convenience. Whenever T̂1 has a t-distribution, the same statistic can be produced by relying on the OLS coefficients. For example, in
the case where there are no group-varying covariates and
each group has the same number of observations, the OLS
coefficient is identical to the between-groups (two-step)
estimator. However, it is more convenient to estimate the
standard error of the estimate using between-group estimation. Similarly, it is easy to show that when Z៮ s is identical
across groups and all groups have the same sample size,
OLS produces the same ␤ˆ as in the case where we use the
within estimator to obtain ␥ˆ w and estimate ␤ in two steps.
Again, however, estimation of the correct standard error is
much easier using the two-step estimator.
III.

Examples

In this section, we first review the two-by-two case,
which features prominently in the literature. The main
feature of this case is that we cannot calculate the standard
error of the estimate and thus must exercise considerable
caution in drawing conclusions. We then review two prominent papers that provide at least some differencein-differences estimates in which there are no covariates
that vary within group. The first case, Gruber and Poterba
(1994), shows that accounting properly for error components can dramatically reduce the implied precision of the
estimates in some specifications but that the estimate remains precise in at least one specification. In the second
case we reexamine Card’s (1990) Mariel boatlift study and
suggest that the data cannot exclude large effects of the
migration on blacks in Miami. This is consistent with the
results of Angrist and Krueger’s (1999) finding of a large
impact of the “Mariel boatlift that didn’t happen.”
A. The Two-by-Two Case

In the canonical difference-in-differences model, mean
outcomes are calculated for groups A (the treatment group)
and B (the control group) in each of periods 0 (the pretreatment period) and 1 (the posttreatment period). A standard
table shows each of these means, plus the difference between groups A and B in each period and the difference
between the pre- and posttreatment outcomes for each
group. Finally, the difference between either pair of differ-

ences is the classic difference-in-differences estimate. Classic and recent examples that include tables in this form are
Card and Krueger’s (1994) study of the minimum wage;
Eissa and Leibman’s (1996) study of the effect of the
earned-income tax credit; Meyer, Viscusi, and Durbin’s
(1995) study of workers compensation; Imbens, Rubin, and
Sacerdote’s (2001) study of lottery winners and labor supply, Eberts, Hollenbeck, and Stone’s (2002) study of merit
pay for teachers; and Finkelstein’s (2002) study of tax
subsidies and health insurance provision. Each of these
studies provides additional analysis, but in each case, the
two-by-two analysis is an important component of the study.
In a well-developed two-by-two case, the authors make a
compelling case that other than the treatment, there is no
reason to expect the outcome variable to evolve differently
for the treatment and control groups.
The statistical model is
y igt ⫽ ␣ gt ⫹ bT gt ⫹ ε igt ,

(20)

where y is the outcome being measured for individual i in
group g in year t, T is a dummy variable for the treatment
group in the posttreatment period, ␣ is a group/year error
which may be correlated over time or across groups, and ε
is an i.i.d. error term.
Without loss of generality, we can subtract the first period
from the second period and rewrite the equation as
⌬y ig ⫽ ⌬a g ⫹ b⌬T g ⫹ ε ig1 ⫺ ε ig0 .

(21)

Now ⌬T equals 1 for the treatment group and 0 for the
control group. Therefore, we can replace ⌬T with A, a
dummy variable for group A. And we can rewrite ⌬ag ⫽
c ⫹ ␣៮ A, where ␣៮ ⫽ ⌬␣A ⫺ ⌬␣B. Letting εig1 ⫺ εig0 ⫽ εig we
have
⌬y ig ⫽ c ⫹ 共␣˜ ⫹ b兲 Ag ⫹ εig .

(22)

The weighted least squares (where weights are chosen to
make the sample sizes identical) coefficient on A is the
difference-in-differences estimator and is numerically identical to taking the difference between the change in the
outcome for the treatment and control groups. It is an
unbiased estimate of ␣៮ ⫹ b. Since E(␣៮ ) ⫽ 0, it is also an
unbiased estimate of b. However, it is not consistent. No
matter how many observations from either the control or
treatment groups we add to the sample, the coefficient will
not converge in probability to b.
The variance reported by econometric packages includes
the sampling variance but not that part of the variance due
to the common error. Thus if there are any shocks that are
correlated within year/group cells, the reported t-statistic
will be too high. We will tend to find an effect of the
treatment even if none exists.
Unfortunately, if there are common errors, the two-bytwo model has zero degrees of freedom. Therefore, it is not
possible to determine the significance of any estimate solely

INFERENCE WITH DIFFERENCE-IN-DIFFERENCES

from within-sample information. It may be possible to use
information from outside the sample to get a plausible
estimate of the magnitude of common within-group errors,
but even in this case, we will not know the sampling
distribution of the resulting statistic. Thus, analysis of the
two-by-two case requires extreme caution.
B. Card (1990)

Card examines the impact of the mass migration of Cubans
to Miami during the Mariel boatlift. He compares, among other
outcomes, unemployment rates for whites, blacks, and Hispanics in Miami with unemployment rates of these groups in four
comparison cities (Atlanta, Houston, Los Angeles, and Tampa–
St. Petersburg). Surprisingly, he finds little evidence that the
mass migration significantly affected the Miami labor market.
For example, from 1979 to 1981 black unemployment in
Miami increased by 1.3 percentage points, compared with 2.6
percentage points in the comparison communities. Angrist and
Krueger (1999) replicate Card’s study for a Cuban boatlift that
was anticipated but did not occur. They find that “the Mariel
boatlift that didn’t happen” had a large adverse effect on
unemployment in Miami. Their analysis cast doubt on the
power of Card’s original finding.
Our analysis helps to explain why Card found no effect
and why it is possible to find a large effect of a nonexistent
event. To understand this, we need to examine the true
confidence interval around Card’s estimates. Because Card
provides seven years of data for both Miami and the comparison cities, we can, with auxiliary assumptions, calculate
the variance of his estimate.
We first assume that the difference between the annual
unemployment rates in Miami and the comparison cities is
subject to an i.i.d. shock. This allows for a common year
shock which may be persistent but assumes that any shocks
that are idiosyncratic to a city are not persistent. Given this
assumption, we use the data reported by Card to regress the
difference between the unemployment rate for blacks in
Miami and the control cities on a dummy for the period after
1980 on all years except 1980. The resulting coefficient is
1.4 with a standard error of 4.0. Under the assumption that
the error terms are homoskedastic and normal, and given
that we have four degrees of freedom, the confidence
interval is from ⫺9.7 to 12.1, effectively including very
large positive and negative impacts on blacks.
In sum, while the data certainly provide no support for the
view that the Mariel immigration dramatically increased
unemployment among blacks in Miami, they do not provide
much evidence against this view either. In this case, the
difference-in-differences approach lacks power.

227

TABLE 1.—AGGREGATE INSURANCE RATES: EMPLOYED
SELF-EMPLOYED WORKERS
(1982–1989)

1982
1983
1984
1985
1986
1987
1988
1989

AND

SelfEmployed

Employed

Difference

Difference-in-Differences
(relative to previous year)

68.9
72.0
68.9
68.6
70.1
76.1
73.2
73.5

88.6
88.9
88.1
88.0
88.0
86.8
86.1
84.5

⫺19.7
⫺16.9
⫺19.2
⫺19.4
⫺17.9
⫺10.7
⫺12.9
⫺11.0

—
2.8
⫺2.3
⫺0.2
1.5
7.2
⫺2.2
1.9

Source: Gruber and Poterba (1994).

C. Gruber and Poterba (1994)

someone else. They find that, comparing the period before the
tax change with the period after, purchase of health insurance
grew more rapidly among the self-employed than among other
employed workers. The difference-in-differences estimator
therefore indicates that the tax law did increase the purchase of
health insurance among the self-employed.
In the simplest version of the Gruber/Poterba model, the
authors compare the fraction of the self-employed who had
health insurance in 1985–1986 and 1988–1989 with the
fraction of employed (not self-employed) workers with
health insurance in these years.
Gruber and Poterba report a difference-in-differences estimate of 6.7 with a standard error of 0.8, indicating that the
effect of the change in tax law is quite precisely measured. To
examine the importance of common group/year effects, we
begin by examining “the tax changes that didn’t happen.” We
reproduce Gruber and Poterba’s annual data in table 1. The
fourth column shows the annual difference-in-differences
estimates.
There are a number of points to make about the differencein-differences. First, the 1986–1987 change stands out. One
would be hard-pressed to look at the fourth column of table
1 and find no evidence supporting an impact of the tax law
change on the insurance rate among the self-employed.
More significantly from the perspective of this paper, it
would be easy to look at other years and, using differencein-differences, draw strong and possibly erroneous conclusions about the impact of other policies in those years.
Based on information in Gruber and Poterba, the part of the
standard error of the difference-in-differences estimator that
is due to sampling error is approximately 1.1.9 Relying on
this standard error, for three of the six years in which no
major policy change occurred, there appears to be a statistically significant change in the relative purchase of health
insurance by the self-employed. For two of the remaining
three years, the change falls short of conventional significance levels but remains sufficiently large relative to its
“standard error” to provide support for the hypothesis of a
policy effect.

Gruber and Poterba analyze a change in the tax law that they
anticipate would increase the purchase of health insurance by
self-employed individuals but not by individuals who work for

9 The standard error reported in Gruber/Poterba is 0.8. Their differencein-differences estimator pools data from two years. The standard error for
individual years is therefore approximately 2 ⫻ 0.8, or 1.1.

冑

228

THE REVIEW OF ECONOMICS AND STATISTICS

We can get a more accurate estimate of the standard error
of the difference-in-differences estimator if we are willing
to make auxiliary assumptions about the distribution of the
group/year errors. First we assume that the difference between the employment rates for the two groups is i.i.d.
normal. We therefore regress the differences in column 3 on
a dummy variable for the period after 1986. This effectively
treats 1982–1986 as one group (but with different random
year errors) and 1987–1989 as a second group. The results
from this estimation are strikingly similar to those obtained
by Gruber and Poterba. The coefficient is 7.1 with a standard error of 0.9. Because there are only six degrees of
freedom in the second-stage regression, the confidence
interval is obtained by multiplying the standard error by
2.45 instead of the more common 1.96. Still, the cost of the
group-error structure is largely offset by the increased sample size from using all nine years of data.
If instead we assume that the difference in the differences
between the employment rates is i.i.d., in other words that
the differences are a possibly correlated, random walk and
normal, we can estimate the regression using differences.
We therefore regress the difference-in-differences on a
dummy variable for 1986–1987. This produces a differencein-differences estimate of 6.9 and a standard error of 2.3.
Using OLS and a t-distribution for the parameter estimate,
the estimated impact of the policy change has a confidence
interval ranging from 0.9 to 13.0.
Finally, since the difference-in-differences approach is
predicated on the assumption that the expected differencein-differences in nonexperimental years is 0, we reestimate
the equation without a constant term. The resulting coefficient is 7.2 with a confidence interval from 2.3 to 12.1.
While the evidence against the hypothesis of no policy
effect remains statistically significant, our confidence in its
magnitude is diminished dramatically by taking into account random year effects in two of our three specifications.
Nevertheless, the results demonstrate that it is possible to
obtain precise coefficients in at least in some specifications.
IV.

OLS and Variance Adjustment: Moulton and
Cluster

It is interesting to consider the properties of two commonly used approaches to statistical inference in the context
of the model described earlier. To make these procedures
easier to follow, we consider the special case where there
are no within-group varying variables and the covariance
across observations in the group is constant, as represented
by the model with a random group effect,
Y is ⫽ a ⫹ X s ␤ ⫹ ␣ s ⫹ ε is .

(23)

Moulton (1986) suggested that one adjust the standard
errors for OLS for the fact that the errors are correlated
within the groups because of the common group effect.
Under the assumption that all residuals are homoskedastic,

this correlation is given by ␳ ⫽ ␴2␣/(␴2␣ ⫹ ␴ε2) while the
variance of the residual is ␴2 ⫽ ␴2␣ ⫹ ␴ε2. Then using the
S
Ns ⫻ 2) regressor matrix in the
notation X for the ( s⫽1
above model (consisting of column of 1s and a column of
Xs), then as shown in Moulton (1986) the variance of OLS
has the form

冘

V ⫽ 共X⬘X兲 ⫺1 X⬘⌺X共X⬘X兲 ⫺1 ,

(24)

where ⌺ is block diagonal with blocks given by ␴2 (1 ⫺
␳)INs ⫹ ␴2 ␳␫Ns ␫⬘Ns. Moulton’s suggestion is to estimate ␴2
and ␳ and to use the estimated version of the matrix V to
compute standard errors. Given the definition of ␳ and ␴2,
this can be done as follows:
ˆ2⫽
␴

冘 冘 共Y
s

i

ˆ 2
⫺ â ⫺ X s ␤兲

is

N*

where N* ⫽

冘

冘 冘e ,
⫽
2
i is

s

N*

(25)

Ns and

s

ˆ 2ˆ␳ ⫽
共S ⫺ 2兲 ␴

冘 冘 冘 共Y
s

is

i j⫽i

⫽

ˆ
ˆ
⫺ â ⫺ X s ␤兲共Y
js ⫺ â ⫺ X s ␤兲
N s 共N s⫺1)

冘共Y៮ ⫺ â ⫺ X ␤兲ˆ

2

s

s

(26)

s

冘 冘 共Y
s

⫺

i

is

ˆ is ⫺ Y៮s 兲
⫺ â ⫺ Xs ␤兲共Y
共Ns ⫺ 1兲

where the latter is an estimator of the within-group covariance of the residuals (␴2␣) that has been pooled across the
groups.10 Also note that we have included a degrees-offreedom adjustment in the denominator of ␴ˆ 2␳ˆ .
The “cluster” adjusted standard error (as performed in
programs such as Stata) is aimed at dealing with the withingroup correlation structure but does not impose homogeneity of the variances. It takes the form

冘
冘

S

S
V̂ ⫽
S⫺1

Ns ⫺ 1
S
共X⬘X兲⫺1共 usu⬘s兲共X⬘X兲⫺1
s⫽1
Ns ⫺ 2

s⫽1
S

冘

(27)

s⫽1

冘e 冉 X1 冊 ,
Ns

us ⫽

is

i⫽1

(28)

s

where eis is the OLS residual. This procedure allows for
general within-group covariance and heteroskedasticity.
10 Moulton (1986) actually uses ␴
ˆ 2 and ␳ˆ obtained from the randomeffects MLE of the model. The formulas we have used are similar,
although they use the OLS residual rather than the residual from the
random-effects MLE.

INFERENCE WITH DIFFERENCE-IN-DIFFERENCES

It is interesting to examine the properties of inference
procedures for these approaches in the case where we have
a fixed small number of groups and where there are large
(but possibly different) numbers of observations within each
group.11 It is possible to show that the OLS estimator under
these conditions satisfies

冉冊冉冊
â
ˆ
␤

P
3

a
⫺1
␤ ⫹ 共X⬘* PX * 兲 X⬘* P␣ * ,

(29)

where X* is the S ⫻ 2 matrix consisting of a column of 1s
and a column of the different group constant variables Xs,
and where P is a diagonal matrix consisting of p(s) ⫽ p lim
Ns/N*. Thus the OLS estimator behaves under these asymptotics like a weighted least squares estimator in the model,
plim Y៮s ⫽ a ⫹ Xs ␤ ⫹ ␣s .

(30)

By contrast, the two-step estimator discussed above behaves
(asymptotically) like OLS in this model and will be more
efficient when ␣s is homoskedastic. It is also possible to
show that the t-statistic based on the “Moulton” standard
error will satisfy
t

d
3

d
3

A ⫽ diag兵a s2 其
a s ⫽ ␣ s ⫹ 共1, X s 兲共X⬘* PX * 兲 ⫺1 X⬘* P␣,
which is the (stochastic) limit of the cluster variance estimator. It is interesting to note that Ṽ is a scaled version of
the Eicker-White variance-covariance matrix in the
weighted least squares regression (30). This interpretation
leads to some conclusions. First, the only real justification
for the use of these adjusted standard errors is asymptotic in
the sense that S must be large. When S is small the
distribution will generally be unknown, and there do not
appear to be cases where the t-distribution would be a good
approximation. Moreover, it is well-known that there can be
substantial small sample downward bias in the EickerWhite standard errors, with evidence suggesting that they
lead to overrejection of true null hypotheses (see MacKinnon & White, 1985). This suggests that the cluster approach
may be quite unreliable except in the case where there are
many groups.

冑␴˜ ␣2 ⌳⬘⌳ ,
␣⬘共1 ⫺ X * 共X⬘* X * 兲 ⫺1 X⬘* 兲␣
.
S⫺2

There are a few things to note about this distribution. First,
assuming normality of ␣, it is possible to show that although
one can write the limiting random variable as a ratio of a
N(0, 1) and a ␹2(S ⫺ 2), the two random variables will not
be independent unless (I ⫺ X*(X⬘*X*)⫺1X⬘*)⌳ ⫽ 0. This
condition will occur only when the p(s) are all identical.
Thus in the case where the number of observations per
group are similar a t(S ⫺ 2) distribution will provide a good
approximation to the t-statistic using the Moulton correction. It is also worth noting that the scale adjustment
suggested for Moulton is crucial for this result—the scale
adjustment results in the estimate of ␴2␣ being asymptotically unbiased as well.12
For the approach based on the cluster correction one can
show that
t

S
共X⬘ PX 兲 ⫺1 X⬘* PAPX * 共X⬘* PX * 兲 ⫺1
S⫺1 * *

⌳⬘␣

⌳⬘ ⫽ w⬘共X⬘* PX * 兲 ⫺1 X⬘* P, w⬘ ⫽ 共0,1兲
␴˜ ␣2 ⫽

Ṽ ⫽

229

⌳⬘␣

冑Ṽ 22

,

where Ṽ22 is the (2, 2) element of
11 We note in passing that in contrast to the estimator discussed above,
test statistics based on OLS and using either the “Moulton” or “cluster”
standard errors will not have exact t-distributions under normality.
12 When the groups have different numbers of observations but normality of ␣s, it is assumed it should be possible to simulate the distribution.

V.

Monte Carlo Evidence

In this section we provide Monte Carlo estimates of the
distribution of the t-statistic for a variety of estimators used
with panel data.
Our first set of experiments addresses the four most
common estimators applied to grouped data—ordinary least
squares with conventional standard errors, OLS with EickerWhite heteroskedasticity robust standard errors for grouped
data,13 random-effects estimation,14 and two-step estimation
in which the first stage is fixed-effects estimation. We
address two-step estimation in which the first stage is
estimated separately for each group in a later experiment.
For the first set of experiments, we assume that the
underlying model is
y is ⫽ ␣ s ⫹ ε is ,
with the error terms independent normals and 100␴2␣ ⫽ ␴ε2 ⫽
1. We estimate models of the form
y is ⫽ X s B ⫹ Z is ⌫ ⫹ ␣ s ⫹ ε is
so that the true parameter values are 0. X takes on the values
1, 2, 3, and 4 with equal numbers from each group. Z is
distributed uniform on the unit interval for each of the four
groups. When B is estimated using the two-step estimator,
the second stage takes the form
˜ s.
d̂ s ⫽ a ⫹ X s B ⫹ ␣
13
14

These are obtained using the cluster option in Stata.
These are obtained using the xtreg command in Stata.

230

THE REVIEW OF ECONOMICS AND STATISTICS

For each case, we simulated 50,000 estimates. We also
experimented with including and excluding Z from the
equation.
Within this set of estimates, we experiment with two
sample sizes: 250 observations per group (1,000 total) and
2,500 observations per group (10,000 total). We note that
for the larger sample, we would expect the large N, fixed
variances, asymptotics to apply so that the asymptotic distribution of the t-statistic for the two-step estimator would
be the t-distribution. For the smaller sample, the asymptotics with ␴2␣ proportional to 冑N should apply. Since in this set
of experiments E(Z៮s) ⫽ 0.5, @s, the t-statistic should have a
t-distribution with two degrees of freedom in all cases.
Tables 2 and 3 report the results of these Monte Carlo
experiments.
The first thing to notice from the tables is that they support
the theoretical predictions regarding the distribution of the
t-statistic when two-step estimation is used. The 0.01, 0.05, and
0.1 critical values of the t-distribution with two degrees of
freedom are 9.92, 4.30, and 2.92. In all twelve cases, the Monte
Carlo estimates are close to these critical values, and the true
critical values lie within the confidence intervals.
The results for ordinary least squares with conventional
standard errors confirm Moulton’s findings. Even with a
relatively modest number of observations and a low covariance across observations within a group, using the normal
distribution to determine the significance of the t-statistic is
badly biased. In our experiments with 250 observations per
group, approximately 30% of the estimates obtained with
OLS have conventional t-statistics that would be deemed
significant at the 0.05 level. With 2,500 observations per
group, this fraction rises to 70%.
Since empirical economists have become increasingly
aware of Moulton’s critique and since robust. standard
errors accounting for group errors are available for some
statistical packages, it has become common for researchers
to present these robust standard errors in lieu of convenTABLE 2.—MONTE CARLO ESTIMATION
DISTRIBUTION OF ABSOLUTE VALUE OF T-STATISTICS
(FOUR GROUPS, 250 OBSERVATIONS PER GROUP)
99th
Percentile

95th
Percentile

90th
Percentile

% ⬎ 1.645

% ⬎ 1.96

No Z
4.83
3.65
3.06
Z
4.83
3.65
3.06
OLS (Eicker-White standard errors)

37.8
37.8

29.5
29.4

No Z
15.29
6.68
Z
14.92
6.68
Feasible GLS (random effects)

4.57
4.56

39.4
39.3

32.9
32.8

No Z
4.03
Z
4.30
Two-Step

2.82
3.05

2.22
2.44

19.0
22.6

13.5
16.7

No Z
Z

4.29
4.29

2.93
2.93

24.0
24.0

18.8
18.8

OLS (conventional standard errors)

9.75
9.74

TABLE 3.—MONTE CARLO ESTIMATION
DISTRIBUTION OF ABSOLUTE VALUE OF T-STATISTICS
(FOUR GROUPS, 2,500 OBSERVATIONS PER GROUP)
99th
Percentile

95th
Percentile

90th
Percentile

% ⬎ 1.645

% ⬎ 1.96

No Z
13.01
9.93
8.40
Z
13.01
9.93
8.40
OLS (Eicker-White standard errors)

74.5
74.5

69.8
69.9

No Z
15.56
6.74
Z
14.58
6.74
Feasible GLS (random effects)

4.58
4.58

39.6
39.6

33.0
33.0

No Z
7.34
Z
9.74
Two-Step

4.00
6.07

2.82
4.30

23.8
32.7

18.6
27.4

No Z
Z

4.28
4.28

2.92
2.92

24.1
24.1

18.9
18.9

OLS (conventional standard errors)

9.72
9.75

tional standard errors. As can be seen from tables 2 and 3,
the distribution of the t-statistic using Eicker-White standard errors has the distinct advantage of being unaffected by
the number of observations within each group. However,
applying the normal distribution can again give rise to
highly misleading inference. The t-statistic exceeds 1.96 in
about one-third of cases. In fact, the t-statistic divided by
about 1.565 seems to have a t-distribution with two degrees
of freedom. We have not yet established why the EickerWhite t-statistic should have this distribution and hence
cannot say whether it should generalize to other cases.15
Finally, random-effects estimation is asymptotically efficient as both S and N go to infinity. Therefore, it is natural
to estimate such models by feasible GLS. When the randomeffects estimator is used, the distribution of the t-statistic
depends not only on sample size, but also on whether Z is
included in the equation. Depending on whether Z is included and on the sample size, the bias from assuming that
the t-statistic is normally distributed ranges from modest
(14% significant at the 0.05 level) to quite large (27%
significant at the 0.05 level).
Having established that with two-step estimation the
t-statistic has the t-distribution in those cases where the
theory predicts that it should, we now turn to cases where
the theory does not predict that the distribution will be t. We
modify the true model so that
y is ⫽ Z is ⌫ ⫹ ␣ s ⫹ ε is .
We generate
Z is ⫽ Z៮ s ⫹ z is ,
15 Bell and McCaffrey (2002) propose an adjustment to the clustered
standard error which seems to work well even when group size is small
and there are twenty groups.

INFERENCE WITH DIFFERENCE-IN-DIFFERENCES

where zis is uniform (0,1). We consider the two cases. In the
៮ 僆 {(0, 1), (1, 3), (2, 2), (3, 0)}. In
uncorrelated case. (X, Z)
this case, the relation between X and Z៮ has been chosen so
៮
that they are uncorrelated. In the correlated case, X ⫽ Z.
We again perform 50,000 replications for each case we
consider. For each scenario, we assume four groups and
allow both 250 and 2,500 observations per group. Finally,
we perform our two-step estimation in two ways. In the first,
we follow convention and estimate fixed group effects in the
first stage and regress the fixed effects on X in the second
stage. In the other approach, we estimate the constant and
coefficient on Zi separately for each group and regress the
constants from these equations on X.
Table 4 reports the results of this estimation. When there
are only 250 observations per group, then the theoretical
analysis suggests that there is no reason to assume that the
t-distribution will be a good approximation to the distribution of the t-statistic. This is confirmed by the first part of
the table, which shows that the centiles of the simulated
distributions depart quite significantly from the critical values of the t-distribution with two degrees of freedom. Thus
the 0.05 critical value is 4.30. Except in the case where ⌫ is
allowed to vary across groups in the first-stage estimation,
the 95th percentile of the distributions are quite far from this
number. Perhaps even more disturbing, the distribution is
greatly affected by the correlation between Xs and Z៮s, at least
in the case where ⌫ is constrained to be identical across
groups.
We anticipated that with 2,500 observations per group,
the large N asymptotics would apply and that, therefore, the
t-statistic would have a t-distribution. Apparently convergence to the t-distribution is slower than we anticipated.

TABLE 4.—MONTE CARLO ESTIMATION
DISTRIBUTION OF ABSOLUTE VALUE OF t-STATISTICS
(FOUR GROUPS, Z ENTERING THE STRUCTURAL EQUATION)
99th
95th
90th
Percentile Percentile Percentile % ⬎ 1.645 % ⬎ 1.96
250 Observations/Group
Xs and ␮z(s) uncorrelated
␥ constant
across groups
6.55
2.81
1.88
␥ varies
across groups
8.10
3.69
2.56
Xs ⫽ ␮z(s)
␥ constant
across groups
22.78
9.98
6.76
␥ varies
across groups
9.09
4.15
2.94
2,500 Observations/Group
Xs and ␮z(s) uncorrelated
␥ constant
across groups
8.46
3.81
2.59
␥ varies
across groups
8.84
3.86
2.66
Xs ⫽ ␮z(s)
␥ constant
across groups
12.98
5.35
3.63
␥ varies
across groups
9.83
4.33
2.99

12.4

9.3

21.2

16.1

55.0

48.5

27.4

20.7

20.4

15.7

21.7

16.6

31.8

25.7

26.3

20.4

231

Again, except in the case where ⌫ is allowed to vary across
groups in the first-stage estimation, the 95th percentile of
the distributions are quite far from 4.30, although in each
case, it is closer than when there are only 250 observations
per group.
We note, however, that in no case does the 95th percentile
of the t-distribution significantly exceed 4.30 when ⌫ varies
across groups. Moreover, the distribution is considerably
less sensitive to the precise specification of the experiment
when ⌫ varies than when it is constant across groups. It
appears that estimating the first stage separately for each
group and using the t-distribution to assess the significance
of the second-stage coefficients is a conservative strategy.
Table 4 does not address the performance of the other
estimators evaluated in tables 2 and 3. The poor performance of the random-effects estimator and uncorrected
OLS even under the best of circumstances makes it pointless to examine them in the presence of other explanatory
variables. However, it appears from tables 2 and 3 that the
t-statistic from OLS estimation and Eicker-White standard
errors might provide, with suitable modification, a reliable
basis for inference. Unfortunately, this test statistic turns out
to be very sensitive to the inclusion of Z with a nonzero
coefficient. Indeed, in the experiment where Z៮ and X are
forced to be independent, the lowest Eicker-White statistic
(in absolute value) that we obtained in 50,000 draws was
7.56. Clearly, the Eicker-White standard errors do not provide a reliable basis for inference.
In our final Monte Carlo exercise, we draw on the
example from Gruber and Poterba to assess the power of the
two-step estimator. We assume that there are eight years of
data with 50,000 observations in each year. The first six
years are the preexperiment years and the last two the
postexperiment years. In each year, 4,000 of the observations are from members of the group that will be subject to
the experimental treatment (the self-employed). For the
nonexperimental group (employees), each observation has a
probability of 0.87 of success (being insured). For the
potential treatment group, the probability of success is 0.71
plus a normally distributed year error. The year error has a
standard deviation of 0.009, corresponding to our estimate
of the variance of the year effect in Gruber and Poterba.16
We provide three sets of estimates. In the first two cases,
we estimate linear probability models in which we regress
whether the individual is insured on a constant, a dummy for
whether the individual is self-employed, a dummy for being
in the experimental period, and an interaction term between
being self-employed and being in the experimental period.
The first estimator relies on conventional standard errors,
while the second uses Eicker-White standard errors clustered by year/group. The third set of estimates uses our
two-step estimator.
16 It is easier to assign the error to one group rather than to apportion it
between the two groups. Since we care about the variance of the difference
in the group errors, it is irrelevant how we assign the group error.

232

THE REVIEW OF ECONOMICS AND STATISTICS
TABLE 5.—MONTE CARLO ESTIMATION
DISTRIBUTION OF ABSOLUTE VALUE OF T-STATISTICS
(MIMICKING GRUBER & POTERBA, 1994)
99th Percentile
Linear probability model
Linear probability model
(clustered standard errors)
Two-stage estimation
Linear probability model
Linear probability model
(clustered standard errors)
Two-stage estimation

5.17
5.51
3.73

95th Percentile
No True Treatment Effect
3.98
3.61
2.45
Treatment Effect ⫽ 0.07

% ⬎ 1.645

% ⬎ 1.96

3.35

41.8

33.5

2.83
1.95

28.2
15.2

21.5
9.9

19.67

18.32

17.59

100.0

100.0

30.05
20.17

22.09
14.64

18.82
12.48

100.0
100.0

100.0
100.0

We check the distribution and significance of the standard
errors for two cases. In the first case, the true experimental
effect is zero. In the second case, it is 0.07, our estimate of
the effect size in Gruber and Poterba. The results in table 5
are based on 60,500 simulations.17 As would be expected
with group sizes of 46,000 and 4,000, the large N results are
quite accurate. In the case where the true effect size is zero,
using the two-step technique, the 90th, 95th, and 99th
percentiles of the t-statistic are very close to their predicted
values of 1.94, 2.45, and 3.71. In contrast, consistent with
previous results, OLS rejects way too frequently. The tstatistic exceeds 1.96 in just about one-third of cases. Using
the Stata cluster command reduces the number of rejections,
but the t-statistic still exceeds 1.96 in over one-fifth of the
simulations.
When the true effect size is 0.07, the two-step estimator
is nevertheless powerful. The null hypothesis of no effect
can be rejected at the 0.05 level in 60,449 out of 60,500
simulations and at the 0.1 level in every case.
VI.

90th Percentile

Discussion and Conclusion

This paper makes the following basic points regarding
difference-in-differences estimation, or more generally estimation with grouped data:
(i)

Moulton’s critique of estimation with grouped data
applies to difference-in-differences estimation.
(ii) When the number of groups is small, t-statistics
obtained using standard methods (OLS, OLS with
Eicker-White standard errors, feasible GLS estimation of the random-effects model, two-stage estimation) are not normally distributed.
(iii) If the number of members of each group is large,
two-step estimation is efficient and t-statistics from
two-step estimation have t-distributions if the underlying common group errors are normally distributed.

17 We inadvertently exceeded our intended 50,000 simulations and saw
no reason to throw away the extra simulations. Needless to say, the results
for the first 50,000 simulations are similar.

(iv) If the number of members of each group is small,
only under special circumstances is two-step estimation efficient and do t-statistics from two-step
estimation have t-distributions. The criticism of inference using other estimators still applies.
While it will not normally be feasible to check whether the
underlying distribution of common group errors is normally
distributed, it is relatively straightforward to verify the remaining conditions under which the t-statistic from the two-step
estimators is distributed t. When sample sizes for each group
are similar, it will frequently be the case that the standard errors
of first-stage coefficients estimated separately for each sample
will also be similar. In other cases, groups will have similar
distributions of individual-specific variables.
Our reanalysis of two studies suggests that taking these
considerations into account is important. As a practical
matter, when there are variables that vary within group, the
two-step estimator in which the first stage is estimated
separately for each group seems to us to be promising. It is
robust both in theory and in our simulations. In addition, it
is easily used with conventional software packages. However, as noted in footnote 7, in many situations it will not be
invariant to the parameterization of within-group varying
variables. In such cases constraining ␥ to be equal across
groups will generally be necessary. There are other settings,
however, in which the estimate will be invariant. For example, if we are interested in the effect of a law on the
black-white wage differential, the estimate of this differential in each year is invariant to linear reparameterizations of
the remaining variables. In such settings, estimation allowing the remaining parameters to vary across groups is likely
to be the most desirable estimator.
REFERENCES
Abadie, Alberto, “Semiparametric Difference in Difference Estimators,”
Review of Economic Studies 72 (January 2005), 1–19.
Amemiya, Takeshi, “A Note on a Random Coefficients Model,” International Economic Review 19 (October 1978), 793–796.
Andrews, Donald W. K., “Cross-Section Regression with Common
Shocks,” Econometrica 73 (September 2005), 1551–1585.
Angrist, Joshua D, and Alan B. Krueger, “Empirical Strategies in Labor
Economics” (pp. 1277–1366), in Orley E. Ashenfelter and David Card

INFERENCE WITH DIFFERENCE-IN-DIFFERENCES
(Eds.), Handbook of Labor Economics, Volume 3A (Amsterdam; New
York, and Oxford: Elsevier Science, North-Holland, 1999).
Athey, Susan, and Guido W. Imbens, “Identification and Inference in
Nonlinear Difference-in-Differences Models,” Econometrica
(2005).
Bell, Robert M., and Daniel F. McCaffrey, “Bias Reduction in Standard
Errors for Linear Regression with Multi-Stage Samples,” Survey
Methodology 28 (December 2002), 169–181.
Bertrand, Marianne, Esther Duflo, and Sendhil Mullainathan, “How Much
Should We Trust Differences-in-Differences Estimates?” Quarterly
Journal of Economics 119 (February 2004), 249–276.
Card, David, “The Impact of the Mariel Boatlift on the Miami Labor
Market,” Industrial and Labor Relations Review 43 (January
1990), 245–257.
Card, David, and Alan B. Krueger, “Minimum Wages and Employment: A
Case Study of the Fast-Food Industry in New Jersey and Pennsylvania,” American Economic Review 84 (September 1994), 772–793.
Dickens, William T., “Error Components in Grouped Data: Is It Ever
Worth Weighting?” this REVIEW 72 (May 1990), 328–333.
Eberts, Randall, Kevin Hollenbeck, and Joe Stone, “Teacher Performance
Incentives and Student Outcomes,” Journal of Human Resources
37 (Fall 2002), 913–927.
Eissa, Nada, and Jeffrey B. Liebman, “Labor Supply Response to the
Earned Income Tax Credit,” Quarterly Journal of Economics 111
(May 1996), 605–637.

233

Finkelstein, Amy, “The Effect of Tax Subsidies to Employer-Provided
Supplementary Health Insurance: Evidence from Canada,” Journal
of Public Economics 84 (June 2002), 305–339.
Gruber, Jonathan, and Jems Poterba, “Tax Incentives and the Decision to
Purchase Health Insurance: Evidence from the Self-Employed,”
Quarterly Journal of Economics 109 (August 1994), 701–734.
Imbens, Guido W., Donald B. Rubin, and Bruce I. Sacerdote, “Estimating
the Effect of Unearned Income on Labor Earnings, Savings, and
Consumption: Evidence from a Survey of Lottery Players,” American Economic Review 91 (September 2001), 778–794.
Kloek, Teun, “OLS Estimation in a Model Where a Microvariable Is
Explained by Aggregates and Contemporaneous Disturbances are
Equicorrelated,” Econometrica 49 (January 1981), 205–207.
Liang, Kung-yee, and Scott L. Zeger, “Longitudinal Data Analysis Using
Generalized Linear Models,” Biometrika 73 (March 1986), 13–22.
MacKinnon, James G., and Halbert White, “Some HeteroskedasticityConsistent Covariance Matrix Estimators with Improved Finite
Sample Properties,” Journal of Econometrics 29 (September
1985), 305–325.
Meyer, Bruce D., W. Kip Viscusi, and David L. Durbin, “Workers’
Compensation and Injury Duration: Evidence from a Natural Experiment,” American Economic Review 85 (June 1995), 322–340.
Moulton, Brent R., “Random Group Effects and the Precision of Regression
Estimates,” Journal of Econometrics 32 (August 1986), 385–397.
“An Illustration of a Pitfall in Estimating the Effects of Aggregate
Variables on Micro Units,” this REVIEW 72 (May 1990), 334–338.

This article has been cited by:
1. Jeremy R. Magruder. 2013. Can minimum wages cause a big push? Evidence from Indonesia. Journal of Development Economics
100:1, 48-62. [CrossRef]
2. Haojie Li, Daniel J. Graham, Arnab Majumdar. 2012. The effects of congestion charging on road traffic casualties: A causal
analysis using difference-in-difference estimation. Accident Analysis & Prevention 49, 366-377. [CrossRef]
3. Marco D. Huesch, Truls Østbye, Michael K. Ong. 2012. MEASURING THE EFFECT OF POLICY INTERVENTIONS AT THE
POPULATION LEVEL: SOME METHODOLOGICAL CONCERNS. Health Economics 21:10, 1234-1249. [CrossRef]
4. Taryn Dinkelman, Vimal Ranchhod. 2012. Evidence on the impact of minimum wage laws in an informal sector: Domestic workers
in South Africa. Journal of Development Economics 99:1, 27-45. [CrossRef]
5. Mikael Persson. 2012. Does Type of Education Affect Political Participation? Results from a Panel Survey of Swedish
Adolescents. Scandinavian Political Studies 35:3, 198-221. [CrossRef]
6. John T. Addison, McKinley L. Blackburn, Chad D. Cotti. 2012. The Effect of Minimum Wages on Labour Market Outcomes:
County-Level Estimates from the Restaurant-and-Bar Sector. British Journal of Industrial Relations 50:3, 412-435. [CrossRef]
7. Kevin Lang, Ana Nuevo-Chiquero. 2012. Trends in Self-reported Spontaneous Abortions: 1970–2000. Demography 49:3,
989-1009. [CrossRef]
8. Paul Collier, Benedikt Goderis. 2012. Commodity prices and growth: An empirical investigation. European Economic Review
56:6, 1241-1260. [CrossRef]
9. Chihwa Kao, Lorenzo Trapani, Giovanni Urga. 2012. Asymptotics for Panel Models with Common Shocks. Econometric Reviews
31:4, 390-439. [CrossRef]
10. Jeremy R Magruder. 2012. High Unemployment Yet Few Small Firms: The Role of Centralized Bargaining in South Africa.
American Economic Journal: Applied Economics 4:3, 138-166. [CrossRef]
11. Yijuan Chen, Juergen Meinecke. 2012. DO HEALTHCARE REPORT CARDS CAUSE PROVIDERS TO SELECT PATIENTS
AND RAISE QUALITY OF CARE?. Health Economics 21, 33-55. [CrossRef]
12. Kristy Parkinson, Joseph Price, Kosali I. Simon, Sharon Tennyson. 2012. The influence of FDA advisory information and black
box warnings on individual use of prescription antidepressants. Review of Economics of the Household . [CrossRef]
13. 2012. Fitness Memberships and Favorable Selection in Medicare Advantage Plans. New England Journal of Medicine 366:15,
1448-1450. [CrossRef]
14. Michele Campolieti, Chris Riddell. 2012. Disability policy and the labor market: Evidence from a natural experiment in Canada,
1998–2006. Journal of Public Economics 96:3-4, 306-316. [CrossRef]
15. Andreas Ammermueller. 2012. Institutional Features of Schooling Systems and Educational Inequality: Cross-Country Evidence
From PIRLS and PISA. German Economic Review n/a-n/a. [CrossRef]
16. Silvia Prina. 2012. EFFECTS OF BORDER PRICE CHANGES ON AGRICULTURAL WAGES AND EMPLOYMENT IN
MEXICO. Journal of International Development n/a-n/a. [CrossRef]
17. H. Spencer Banzhaf, Garima Bhalla. 2012. Do Households Prefer Small School Districts? A Natural Experiment. Southern
Economic Journal 78:3, 819-841. [CrossRef]
18. MARIA DE PAOLA, VINCENZO SCOPPA. 2011. THE EFFECTS OF CLASS SIZE ON THE ACHIEVEMENT OF COLLEGE
STUDENTS*. The Manchester School 79:6, 1061-1079. [CrossRef]
19. Thomas C Buchmueller, John DiNardo, Robert G Valletta. 2011. The Effect of an Employer Health Insurance Mandate on Health
Insurance Coverage and the Demand for Labor: Evidence from Hawaii. American Economic Journal: Economic Policy 3:4, 25-51.
[CrossRef]
20. Karen Glanz, James Hersey, Sheryl Cates, Mary Muth, Darryl Creel, Jill Nicholls, Victor Fulgoni, Susan Zaripheh. 2011. Effect of
a Nutrient Rich Foods Consumer Education Program: Results from the Nutrition Advice Study. Journal of the American Dietetic
Association . [CrossRef]
21. Katherine M. Kosa, Sheryl C. Cates, Sandria L. Godwin, Melanie Ball, Robert E. Harrison. 2011. Effectiveness of Educational
Interventions to Improve Food Safety Practices Among Older Adults. Journal of Nutrition in Gerontology and Geriatrics 30:4,
369-383. [CrossRef]
22. Sandra L. Decker, Frederic W. Selck. 2011. The effect of the original introduction of Medicaid on welfare participation and female
labor supply. Review of Economics of the Household . [CrossRef]
23. Moonkyung Kate Choi. 2011. The impact of Medicaid insurance coverage on dental service use. Journal of Health Economics
. [CrossRef]

24. Heiner Mikosch, Jan-Egbert Sturm. 2011. Has the EMU reduced wage growth and unemployment? Testing a model of trade union
behavior. European Journal of Political Economy . [CrossRef]
25. Yukiko Abe. 2011. A cohort analysis of male labor supply in Japan. Journal of the Japanese and International Economies .
[CrossRef]
26. Thomas Crossley, Mario Jametti. Pension Benefit Insurance and Pension Plan Portfolio Choice. Review of Economics and Statistics
0:ja. . [Abstract] [PDF] [PDF Plus]
27. Boqiang Lin, Xuehui Li. 2011. The effect of carbon tax on per capita CO2 emissions. Energy Policy . [CrossRef]
28. Benoit Dostie. 2011. Wages, Productivity and Aging. De Economist . [CrossRef]
29. Sarit Cohen-Goldner, M. Daniele Paserman. 2011. The dynamic impact of immigration on natives' labor market outcomes:
Evidence from Israel. European Economic Review . [CrossRef]
30. A. Colin Cameron, Jonah B. Gelbach, Douglas L. Miller. 2011. Robust Inference With Multiway Clustering. Journal of Business
and Economic Statistics 29:2, 238-249. [CrossRef]
31. Aya Suzuki, Lovell S. Jarvis, Richard J. Sexton. 2011. Partial Vertical Integration, Risk Shifting, and Product Rejection in the
High-value Export Supply Chain: The Ghana Pineapple Sector. World Development . [CrossRef]
32. J.J. Prescott, Jonah E. Rockoff. 2011. Do Sex Offender Registration and Notification Laws Affect Criminal Behavior?. Journal
of Law and Economics 54:1, 161-206. [CrossRef]
33. Aileen Thompson. 2011. The Effect of Hospital Mergers on Inpatient Prices: A Case Study of the New Hanover-Cape Fear
Transaction. International Journal of the Economics of Business 18:1, 91-101. [CrossRef]
34. Philip de Jong, Maarten Lindeboom, Bas van der Klaauw. 2011. SCREENING DISABILITY INSURANCE APPLICATIONS.
Journal of the European Economic Association 9:1, 106-129. [CrossRef]
35. Gautam Gowrisankaran. 2011. Estimating the Impact of a Hospital Merger Using the Difference-in-Differences of Prices.
International Journal of the Economics of Business 18:1, 83-89. [CrossRef]
36. Dhaval M Dave, Sandra L Decker, Robert Kaestner, Kosali Ilayperuma Simon. 2010. The Effect of Medicaid Expansions on the
Health Insurance Coverage of Pregnant Women: An Analysis Using Deliveries. Inquiry 47:4, 315-330. [CrossRef]
37. Rustam Ibragimov, Ulrich K. Müller. 2010. t -Statistic Based Correlation and Heterogeneity Robust Inference. Journal of Business
and Economic Statistics 28:4, 453-468. [CrossRef]
38. Katja Görlitz. 2010. The effect of subsidizing continuous training investments — Evidence from German establishment data.
Labour Economics 17:5, 789-798. [CrossRef]
39. Simon Burgess, Carol Propper, Marisa Ratto, Stephanie von Hinke Kessler Scholder, Emma Tominey. 2010. Smarter Task
Assignment or Greater Effort: The Impact of Incentives on Team Performance*. The Economic Journal 120:547, 968-989.
[CrossRef]
40. Ted N. Aranki, Yousef Daoud. 2010. Competition, substitution, or discretion: an analysis of Palestinian and foreign guest workers
in the Israeli labor market. Journal of Population Economics 23:4, 1275-1300. [CrossRef]
41. Monica Giulietti, Luigi Grossi, Michael Waterson. 2010. Price transmission in the UK electricity market: Was NETA beneficial?.
Energy Economics 32:5, 1165-1174. [CrossRef]
42. F. Andrew Hanssen. 2010. Vertical Integration during the Hollywood Studio Era. Journal of Law and Economics 53:3, 519-543.
[CrossRef]
43. Alberto Abadie. 2010. Synthetic Control Methods for Comparative Case Studies: Estimating the Effect of California’s Tobacco
Control Program. Journal of the American Statistical Association 105:490, 493-505. [CrossRef]
44. Ciro Biderman, João M P De Mello, Alexandre Schneider. 2010. Dry Laws and Homicides: Evidence from the São Paulo
Metropolitan Area. The Economic Journal 120:543, 157-182. [CrossRef]
45. J. C. Adams, S. A. Mansi, T. Nishikawa. 2010. Internal Governance Mechanisms and Operational Performance: Evidence from
Index Mutual Funds. Review of Financial Studies 23:3, 1261-1286. [CrossRef]
46. Bas Klaauw, Limin Wang. 2009. Child mortality in rural India. Journal of Population Economics . [CrossRef]
47. Sami H. Miaari, Robert M. Sauer. 2009. The labor market costs of conflict: closures, foreign workers, and Palestinian employment
and earnings. Review of Economics of the Household . [CrossRef]
48. Jonah Rockoff. 2009. Field Experiments in Class Size from the Early Twentieth Century. Journal of Economic Perspectives 23:4,
211-230. [CrossRef]
49. Joshua Angrist, Victor Lavy. 2009. The Effects of High Stakes High School Achievement Awards: Evidence from a Randomized
Trial. American Economic Review 99:4, 1384-1414. [CrossRef]

50. P. R. Zimmerman. 2009. Statistical Variability and the Deterrent Effect of the Death Penalty. American Law and Economics
Review 11:2, 370-398. [CrossRef]
51. J. DAVID BROWN, JOHN S. EARLE, SCOTT GEHLBACH. 2009. Helping Hand or Grabbing Hand? State Bureaucracy and
Privatization Effectiveness. American Political Science Review 103:02, 264. [CrossRef]
52. John A. Maluccio, John Hoddinott, Jere R. Behrman, Reynaldo Martorell, Agnes R. Quisumbing, Aryeh D. Stein. 2009. The
Impact of Improving Nutrition During Early Childhood on Education among Guatemalan Adults. The Economic Journal 119:537,
734-763. [CrossRef]
53. Guido W Imbens, Jeffrey M Wooldridge. 2009. Recent Developments in the Econometrics of Program Evaluation. Journal of
Economic Literature 47:1, 5-86. [CrossRef]
54. Esfandiar Maasoumi, Daniel L. Millimet, Dipanwita Sarkar. 2009. Who Benefits from Marriage?. Oxford Bulletin of Economics
and Statistics 71:1, 1-33. [CrossRef]
55. Ted N. Aranki, Yousef Daoud. 2009. Competition, substitution, or discretion: an analysis of Palestinian and foreign guest workers
in the Israeli labor market. Journal of Population Economics . [CrossRef]
56. Marion König, Joachim Möller. 2009. Impacts of minimum wages: a microdata analysis for the German construction sector.
International Journal of Manpower 30:7, 716-741. [CrossRef]
57. M BAKER, K MILLIGAN. 2008. Maternal employment, breastfeeding, and health: Evidence from maternity leave mandates.
Journal of Health Economics 27:4, 871-887. [CrossRef]
58. M. A. Petersen. 2008. Estimating Standard Errors in Finance Panel Data Sets: Comparing Approaches. Review of Financial Studies
22:1, 435-480. [CrossRef]
59. Jens Ludwig, Jeffrey R. Kling. 2007. Is Crime Contagious?. The Journal of Law and Economics 50:3, 491-518. [CrossRef]
60. V. Brian Viard. 2007. Do switching costs make markets more or less competitive? The case of 800-number portability. The RAND
Journal of Economics 38:1, 146-163. [CrossRef]

