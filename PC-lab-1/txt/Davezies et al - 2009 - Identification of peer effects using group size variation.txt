Econometrics Journal (2009), volume 12, pp. 397–413.
doi: 10.1111/j.1368-423X.2009.00296.x

Identification of peer effects using group size variation
L AURENT D AVEZIES † , X AVIER D’H AULTFOEUILLE †
AND D ENIS F OUG ÈRE †,‡,§ ,¶
†

‡

CREST-INSEE, 18 boulevard Gabriel Péri 92245 Malakoff Cedex, France
E-mails: laurent.davezies@insee.fr,
xavier.dhaultfoeuille@ensae.fr, fougere@ensae.fr

CNRS, Délégation Paris A, 27 Rue Paul Bert, 94204 Ivry-sur-Seine Cedex, France
§
¶

CEPR, 53-56 Great Sutton Street, London EC1V 0DG, UK

IZA, Schaumberg-Lippe-Straβe 5-9, D-53113 Bonn, Germany

First version received: November 2007; final version accepted: July 2009

Summary This paper studies the econometric properties of a linear-in-means model of
social interactions. Under a slightly more restrictive framework than Lee (2007), we show that
this model is generally identified when at least three different sizes of peer groups are observed
in the sample at hand. While unnecessary in general, homoscedasticity may be required in
special cases, for instance when endogenous and exogenous peer effects cancel each other. We
extend this analysis to the case where only binary outcomes are observed. Once more, most
parameters are semiparametrically identified under weak conditions. However, identifying all
of them requires more stringent assumptions, including a homoscedasticity condition. We also
develop a parametric estimator for the binary case, which relies on the Geweke-HajivassiliouKeane (GHK) simulator. Monte Carlo simulations illustrate the influence of group sizes on the
accuracy of the estimation, in line with the results obtained by Lee (2007).
Keywords: Linear-in-means model, Semiparametric identification, Social interactions.

1. INTRODUCTION
In a seminal paper, Manski (1993) showed that in a linear-in-expectations model with social
interactions, endogenous and exogenous peer effects cannot be separately identified. Only a
function of these two types of effects can be identified under some strong exogeneity conditions.
In the context of pupil achievement for instance, Hoxby (2000) and Ammermueller and Pischke
(2006) reach identification by assuming that variations in time or across classrooms within
the same school are random. 1 However, Lee (2007) has recently proposed a modified version
of the social interaction model, which corresponds to a linear-in-means model, and which is
shown to be identifiable without any of the previous restrictive assumptions, thanks to group size
variation.

1 Subsequently, we will often consider the example of peer effects in schools, although the model could also be applied
to other topics, like smoking (see e.g. Krauth, 2006), productivity in teams (see Rees, 2003) or retirement (Duflo and
Saez, 2003).

C The Author(s). Journal compilation 
C Royal Economic Society 2009. Published by Blackwell Publishing Ltd, 9600 Garsington Road,

Oxford OX4 2DQ, UK and 350 Main Street, Malden, MA, 02148, USA.

398

L. Davezies, X. D’Haultfoeuille and D. Fougère

The aim of our paper is three-fold. First, we re-examine the identification of this linear-inmeans model when group sizes do not depend on the sample size. 2 We believe that, in practice,
such an assumption is virtually always satisfied. For instance, there is no reason why the mean
classroom size should depend on the size of the sample. Moreover, this extra assumption enables
us to clarify the sources of identification in this model. 3 More precisely, we show that in the
linear-in-means model, the crucial assumptions for identification are (1) the knowledge of the
group sizes and (2) the fact that group sizes take at least three different values. Parametric
assumptions on the error term are not required. In general, homoscedasticity is not required
either. This last assumption is useful however when both types of peer effects cancel each other,
since in this case identification is lost without such a restriction.
Secondly, we extend these results to a model where only binary outcomes are observed.
Identification of discrete outcome models with social interactions has already been studied by e.g.
Brock (2001, 2007) and Krauth (2006). Our model is slightly different, though, as we assume that
social interactions may affect individuals through peers’ latent variables rather than through their
observable outcomes. This is convenient when only binary outcomes are observable because
of data limitation. This model is close to spatial discrete choice models (see e.g. Case, 1992,
McMillen, 1992, Pinkse, 1998, Beron, 2004, or Klier, 2008). The difference is that we allow
here for exogenous peer effects and for fixed group effects simultaneously. The attractive feature
of our result is that it does not rely on any functional assumption concerning the errors. Once
more, the exogenous peer effects can be identified through group size variation. On the other
hand, due to the loss of information, endogenous peer effects cannot be identified without further
restrictions. We show that a homoscedasticity condition is sufficient for this purpose.
Thirdly, we develop a parametric estimation of the binary model, complementing the methods
proposed by Lee (2007) for the model with a continuous outcome. We show that under a
normality assumption on the residuals and a linear specification à la Mundlak (1961) on the
fixed effect, a simulated maximum likelihood estimator can be implemented by using the GHK
algorithm (Geweke, 1989, Keane, 1994, and Hajivassiliou et al., 1996). Thus, this estimator is
close to Beron and Vijverberg’s (2004) one on spatial probit models. We investigate its finite
sample properties through Monte Carlo simulations. The results stress the determining effect of
average group size for the accuracy of the inference, in line with Lee’s (2007) result concerning
the linear model.
The paper is organized as follows. In the next section, we present the theoretical model of
social interactions. In Section 3, we study the identification of the model, both for the continuous
and the discrete cases. The fourth section discusses the parametric estimation method of the
discrete model. Section 5 displays Monte Carlo simulations. Section 6 concludes. Proofs are
given in the Appendix.

2. A THEORETICAL MODEL OF SOCIAL INTERACTIONS
We consider the issue of individual choices in the presence of social interactions within groups.
Let ei denote the continuous choice variable of an individual i who belongs to a group of size

2

This is approximately the scenario with small group interactions proposed by Lee (2007).
Under his more general setting, Lee (2007) provides sufficient conditions for identification, but they are rather difficult
to interpret (see his assumptions 6.1 and 6.2).
3


C The Author(s). Journal compilation 
C Royal Economic Society 2009.

Identification of peer effects using group size variation

399

m, xi be her exogenous covariates, and εi her (random) individual-specific characteristic. We
suppose that her utility when choosing ei , while the other persons in the group choose (ej )j =i ,
takes the following form:
⎛
⎡
⎞
m

1
ej ⎠ λ0
Ui (ei , (ej )j =i ) = ei ⎣xi β10 + ⎝
m − 1 j =1, j =i
⎛
⎞
⎤
m

1
1
+ ⎝
xj ⎠ β20 + α + εi ⎦ − ei2 .
m − 1 j =1, j =i
2
In this framework, the marginal returns of individual i depend on her own characteristics xi ,
her peers’ choices (ej )j =i , their observable (exogenous) characteristics (xj )j =i and a group fixed
effect α. In a classroom, for instance, the utility of a student depends on her effort ei and on the
efforts of others because of spillovers in the learning process. Like Cooley (2007) and CalvóArmengol et al. (2008), among others, we also allow the utility of each individual to depend on
the observable characteristics of her peers. Indeed, there is some empirical evidence about the
influence of peers’ race, gender or parental education on student achievement (see e.g. Hoxby,
2000, or Cooley, 2007). A plausible explanation is that the marginal effect of ei on achievement
(which is positively correlated with the student’s utility) depends on these characteristics. 4 Lastly,
the outcome may depend on a classroom-specific effect, because of the teacher’s quality, for
instance. This model is close to the one considered by Calvó-Armengol et al. (2008) who
study the effect of peers on individual achievement at school. An important difference is that
they consider the network of friends, whereas our model is better suited when all classmates
potentially affect the student’s achievement.
Assuming that α and the (xi , εi )1≤i≤m are observed by all the individuals in the group, the
Nash equilibrium of the game (ỹ1 , . . . , ỹm ) satisfies
⎛
⎛
⎞
⎞
m
m


1
1
ỹj ⎠ λ0 + ⎝
xj ⎠ β20 + α + εi .
(2.1)
ỹi = xi β10 + ⎝
m − 1 j =1,j =i
m − 1 j =1,j =i
This model is identical to Lee’s (2007) model of social interactions. Following the
terminology introduced by Manski (1993), the second term in the right-hand side corresponds
to the endogenous peer effect, the third refers to the exogenous peer effect and α is a contextual
(group-specific) effect. This model departs from the one considered by Manski (1993) or by
Graham and Hahn (2005) by replacing, on the right-hand side, the expectations relative to the
whole group by the means of outcomes and covariates in the group of peers. 5 Interestingly, one
can show that Manski’s model is actually the Bayesian Nash equilibrium of the game when
player i does not observe the characteristics (xj , εj )j =i of her peers, the (εi )1≤i≤m being mutually
independent and independent of (x1 , . . . , xm , α, m). This framework seems more realistic in large
groups, whereas the hypothesis that the characteristics of other persons in the group are observed
is likely to hold in small ones.

4 For instance, girls may less disrupt classrooms than boys, all things being equal (see Lazear, 2001). In this case, the
marginal effect of effort increases for everyone in the classroom.
5 Graham and Hahn (2005) make the further restriction that β = 0, i.e. that there are no exogenous peer effects.
20

C The Author(s). Journal compilation 
C Royal Economic Society 2009.

400

L. Davezies, X. D’Haultfoeuille and D. Fougère

3. IDENTIFICATION
We now turn to the identification of model (2.1). First, as a benchmark, we suppose that the
outcomes ỹi are directly observed. This case corresponds to Lee’s (2007) framework, but we
investigate it under a slightly different approach in Section 3.1. In Section 3.2, we study the
situation where only rough measures of the outcomes, namely yi = 1{ỹi ≥ 0}, are available. In
both cases, we implicitly assume that the econometrician knows the group of interactions for each
individual. In the previous example, this assumption is mild if students really interact within the
classroom, since the classroom identifier is usually known. It can be restrictive otherwise, but to
our best knowledge, this assumption is also maintained in all papers studying identification of
peer effects, including those by Manski (1993), Brock and Durlauf (2001), Lee (2007), Graham
(2008) and Bramoullé et al. (2009). This stems from the fact that, in Manski’s model at least,
very little can be inferred from the data and from the model if the peer group is not known (see
Manski, 1993, subsection 2.5).

3.1. The benchmark: the linear model
In this section, we clarify the results obtained by Lee (2007), in the case where the size m of the
group does not depend on the size of the sample. 6 We believe that such an assumption is virtually
always satisfied in practice. For instance, there is no reason why the mean classroom size should
depend on the size of the sample. Moreover, this restriction enables us to show what is identified
from the usual exogeneity condition (see Assumption 3.4 below) and when homoscedasticity is
required (see Theorem 3.2 below).
It is quite common to observe some but not all members in each group, and we take this
into account for identification. On the other hand, we maintain the assumption that the size of
the group is observed. 7 Let n denote the number of sampled individuals in the group (n ≤ m).
We denote by Ỹ (respectively, X) the vector of outcomes ỹi (respectively, of covariates) of the
individuals sampled in the group. Let Fm,n denote the distribution function of (m, n) and FỸ ,X | m,n
denote the conditional distribution of (Ỹ , X) given (m, n). Lastly, we denote by Supp(T ) the
support of a random variable T. We rely on the following definition of identification.
D EFINITION 3.1. (β10 , β20 , λ0 ) is identified if there exists a function ϕ such that

(β10 , β20 , λ0 ) = ϕ FỸ ,X | m=m∗ ,n=n∗ (m∗ ,n∗ )∈Supp(m,n) , Fm,n .
This definition states that the structural parameters are identified if they can be obtained
through the distribution of the data. Implicit in the definition is the fact that our asymptotic is
in the number of groups, as is the case in standard panel data models. 8 Now, the key point for
identification of the parameters when the ỹi are observed is to focus on the within-group equation,

6

This is approximately the scenario with small group interactions considered by Lee (2007).
This assumption is realistic in our leading example. In French panels of students, for instance, classroom sizes are
observed while only a fraction of pupils within classrooms is sampled.
8 Indeed, when the number of groups tend to infinity, we are able to estimate consistently
(FỸ ,X | m=m∗ ,n=n∗ )(m∗ ,n∗ )∈Supp(m,n) as well as Fm,n .
7


C The Author(s). Journal compilation 
C Royal Economic Society 2009.

Identification of peer effects using group size variation

which may be written as:
Wn Ỹ = Wn X



(m − 1)β10 − β20
m − 1 + λ0


+ Wn

U
,
1 + λ0 /(m − 1)

401

(3.1)

where U is the vector of unobserved residuals ε for individuals sampled in the group, and Wn
denotes the within-group matrix of size n, that is to say the matrix with (1 − 1/n) on the diagonal
and (−1/n) elsewhere. To identify the structural parameters, we use the variation in the slope
coefficient β(m) = ((m − 1)β10 − β20 )/(m − 1 + λ0 ). For this purpose, we make the following
assumptions:
A SSUMPTION 3.1. Pr(n ≥ 2) > 0.
A SSUMPTION 3.2. Supp(m) contains at least three values.
A SSUMPTION 3.3. For all 1 ≤ i, j ≤ m, E[xi εj | m, n] = 0.
A SSUMPTION 3.4. E[X Wn X | m, n] is almost surely non-singular.
A SSUMPTION 3.5. 1 > λ0 > 1 − min(Supp(m)).
Assumption 3.1 simply states that the within-group approach is feasible. Assumption 3.2,
which is the cornerstone of our approach, ensures that there is sufficient variation in group sizes.
Assumptions 3.1, 3.3 and 3.4 are standard in linear panel data models, except that conditional
expectations depend here both on the number of observed individuals in each group and on the
group size. Conditioning by n does not cause any trouble if, for instance, the observed individuals
are drawn randomly in each group. Finally, Assumption 3.5 ensures that β(m∗ ) exists for all
m∗ ∈ Supp(m). 9
T HEOREM 3.1. Under Assumptions 3.1–3.5, β10 is identified. Moreover,
(a) if β20 =
 −λ0 β10 , then λ0 and β20 are identified;
(b) if β20 = −λ0 β10 , then λ0 is not identified and β20 is identified only up to scale.
Theorem 3.1 states that all parameters are generally identified, provided that there is sufficient
variation in the group sizes. As a notable exception, identification is lost in the absence
of endogenous and exogenous peer effects, since then β20 = −λ0 β10 = 0. One can always

= −λ0 β10 . Using the first conditional moment
rationalize such a model with any λ0 = 0 and β20
of Ỹ alone, one cannot distinguish the case with both exogenous and endogenous peer effects
(which cancel out in this case) from the case with no peer effects. Below, we provide a method
which yields identification in this case, but it relies on a stronger assumption of homoscedasticity.
In any case, one can check whether identification is lost or not, since this amounts to test whether
β(·) is constant or not.
Contrary to the reduced form approach, we do not need to know the mean (x̄r )1≤r≤R in each
group to identify the parameters. Thus, the problem of measurement error on x̄r , which appears
when some individuals in the group are unobserved, does not arise in our framework. Here, the
crucial assumption is the knowledge of the group size. If it is unknown but can be estimated, the
9 Theorem 3.1 would remain valid if Assumption 3.5 were replaced by the weaker condition λ ∈
0 / −Supp(m − 1).
However, Assumption 3.5 is required under this form in Theorems 3.2, 3.3, 3.4 and in Lemma 3.1.


C The Author(s). Journal compilation 
C Royal Economic Society 2009.

402

L. Davezies, X. D’Haultfoeuille and D. Fougère

measurement error problem comes back in a non-linear way. The issue of identification in this
case is left for future research. 10
The nature of the group size effect provides another identifying assumption. Indeed, m
may be correlated with α in a general way, but we cannot add interaction terms between the
indicators 1{m = m∗ } (with m∗ ∈ Supp(m)) and the covariates to the list of regressors, since
then Assumption 3.4 would fail. To see this, let us remark that, if β10 and β20 depend on m in
an unspecified way, then we can still identify β(m) but not the structural parameters. On the
other hand, identification of these structural parameters can be achieved if the dependence of
β10 and β20 with respect to m takes a parametric form. 11 Of course, in this case, identification
requires that m takes more than three different values. This also implies that the basic model
where β10 , β20 and λ0 are constant across group sizes is overidentified as soon as we observe at
least four different group sizes. A simple way to test this restriction is to estimate β(·) by using a
within-group estimator for each group size, and then to implement the overidentification test for
minimum distance estimators (see e.g. Wooldridge, 2002, p. 444).
If β20 = −λ0 β10 , then λ0 and β20 cannot be identified without further restriction. To recover
them, one can use the residual variance variation, under a homoscedasticity condition (see our
Assumption 3.6 below). More precisely, the conditional variance of the residuals should not
depend on the group size. This hypothesis is quite weak since it does not restrict the relationship
between the residuals εri and the covariates xri . Moreover, under Assumption 3.6, one needs
less variation across group sizes than previously, and we can replace Assumption 3.2 by
Assumption 3.2 .
A SSUMPTION 3.2 . Supp(m) contains at least two values.
A SSUMPTION 3.6. V (U | n, m) = σ 2 In where In is the identity matrix of size n.
T HEOREM 3.2. Under Assumptions 3.1, 3.2 and 3.3–3.6, (β10 , λ0 , β20 ) are identified.
The idea of using second-order moments to identify peer effects has already been exploited
by Glaeser et al. (1996) and Graham (2008). In particular, Graham (2008) develops a framework
where composite peer effects can be identified through such a restriction. In his model, however,
endogenous peer effects are not identified.
3.2. The binary model
We now investigate whether the parameters are still identified when one cannot observe directly
the outcome variable ỹi but only a rough binary measure of it, namely yi = 1{ỹi ≥ 0}. 12 For
instance, when studying peer effects in the classroom, the analyst could observe only grade
retention decisions rather than students’ efforts. Similarly, in criminal studies, the violence level
chosen by an individual may depend on the violence level chosen by her peers. The level chosen
in equilibrium is a continuous variable. However, the econometrician may only be able to observe
10 Following Schennach (2004), the model would still be identified if two independent measures of m were available.
The remaining issue is whether the model is identified with only one measure, as it is in a linear model (see e.g. Lewbel,
1997).
11 For instance, we can write these parameters as affine transformations of m. This is equivalent to adding interaction
terms between X and m.
12 The definition of identification that we use here is similar to the one introduced in Definition 3.1, except that Ỹ has
to be replaced by Y, the vector of outcomes yi observed for the individuals sampled in the group.

C The Author(s). Journal compilation 
C Royal Economic Society 2009.

Identification of peer effects using group size variation

403

a rough measure of this violence level, through criminal acts. This fits within our framework as
long as doing criminal acts corresponds to being above a given threshold of violence.
The binary model we consider is not a discrete choice model but rather a continuous choice
model with imperfect observations of the choice. In discrete choice models, the econometrician
observes the choice ỹi ∈ {1, . . . , p} of i. This choice depends on (ỹj )j =i , as in equation (2.1),
but in a non-linear way. Such models have been studied by Brock and Durlauf (2001, 2007),
Tamer (2003), Krauth (2006) and Bayer and Timmins (2007). The main challenge when making
inference on these models is that, in general, multiple equilibria arise. This is not a concern here,
as ỹi is uniquely defined by equation (2.1).
When the outcome is a binary variable, the reduced-form equation (3.1) is useless for
identification since Wn Ỹ has no observational counterpart. Instead, we rely on equation (3.2)
below.
L EMMA 3.1. Suppose that yi = 1{ỹi ≥ 0}, where ỹi satisfies equation (2.1), and that Assumption
3.5 holds. Then the model is observationally equivalent to the model generated by the following
equation:
 

 


m
β20
β10 + β20
+ x̄
β20 +
yi = 1 xi β10 −
λ0 + α(1 + λ0 (m))
m−1
m−1
1 − λ0

+ ε̄ λ0 (m) + εi ≥ 0 ,
(3.2)
where λ0 (m) = mλ0 /((m − 1)(1 − λ0 )).
The term in brackets is a fixed group effect. Thus, we are led back to a binary model for panel
data. Identification of such a model has been considered, among others, by Manski (1987), and
our analysis relies on his paper. In the following, we denote by xjk the kth covariate of individual
j. The following assumptions are needed for identification.
A SSUMPTION 3.7. (ε1 , . . . , εm ) are exchangeable conditional on (m, x1 , . . . , xm , α). The
support of ε1 + λ0 (m)ε̄ conditional on (m, x1 , . . . , xm , α) is R, almost surely.
A SSUMPTION 3.8. Let z = x2 − x1 . 13 The support of z is not contained in any proper linear
subspace of RK , where K denotes the dimension of xi .
A SSUMPTION 3.9. There exists k0 such that zk0 has everywhere a positive Lebesgue conditional
k0
= 1. Without loss of generality,
density given (m, z1 , . . . , zk0 −1 , zk0 +1 , . . . , zK ) and such that β10
we set k0 = 1.
The first part of Assumption 3.7 holds for instance if, conditional on m and α, the
residuals (εi )1≤i≤m are exchangeable and independent of the covariates (xi )1≤i≤m . In particular,
Assumption 3.7 is satisfied if the (εi )1≤i≤m are i.i.d. and independent of (x1 , . . . , xm , m, α). The
second part of Assumption 3.7 is a technical condition, which is identical to the second part of
assumption 1 set forth by Manski (1987). Assumption 3.8 ensures that z varies enough within a
group. As usually in binary models, one parameter must be normalized, and this is the purpose of
Assumption 3.9. However, a small difficulty arises here, because the reduced form does not allow

13

Without loss of generality, we assume here that individuals 1 and 2 are observed.


C The Author(s). Journal compilation 
C Royal Economic Society 2009.

404

L. Davezies, X. D’Haultfoeuille and D. Fougère

us to identify the sign of the structural parameters. A sufficient condition is to fix one parameter
1
= 1. 14
(and not only its absolute value): thus we set β10
T HEOREM 3.3. Suppose that Assumptions 3.1–3.2, 3.5 and 3.7–3.9 hold. Then β10 is identified.
Moreover,
1
(a) if β20 =
 β20
β10 , then β20 is identified,
k
1
1
1
β10 , β20
is not identified and the other parameters β20
are identified up to β20
.
(b) if β20 = β20

On the other hand, λ0 is not identified.
If fewer parameters (i.e. fewer than those included in model (2.1)) are identified, Theorem 3.3
shows that the main attractive features of the method remain. Without any exclusion restriction
and even if only two members of the groups are observed, β10 and β20 are generally identified.
Similarly to the result set forth in Theorem 3.1, identification of β20 is lost when there is no
1
β10 = 0. The non-identifiability of λ0 is
exogenous peer effect, because in this case β20 = β20
not surprising since this parameter only appears in the fixed effect and in the residuals (see
equation (3.2)). Heuristically, without any assumption imposed on these terms, any λ0 can be
rationalized by changing accordingly α and the residuals (εi )1≤i≤m .
Thus, stronger assumptions are needed for identifying λ0 . One possibility is to observe x̄
and to restrict the dependence between the residuals and the covariates through the following
assumptions:
A SSUMPTION 3.2 . The support of m given x̄ has at least three elements with positive
probability.
A SSUMPTION 3.10. x̄ is observed.
A SSUMPTION 3.11. (ε1 , . . . , εm , α) ⊥⊥ (x1 , . . . , xm ) | m, x̄.


0
V (ε1 | x̄)Im
A SSUMPTION 3.12. V (ε1 , . . . , εm , α | x̄, m) =
.
0
V (α | x̄)



 
β20
β20
A SSUMPTION 3.13. Given (x̄, m), the support of x1 β10 −
, x2 β10 −
is
m−1
m−1
R2 .
Assumption 3.2 is slightly more restrictive than Assumption 3.2, but should hold most of
the time. For instance, it is satisfied for a multinomial logit (or probit) model generating the
conditional distribution of m given x̄. As mentioned above, Assumption 3.10 is a restrictive
condition as it imposes either to observe all individuals in the group or to consider only covariates
whose means are known. Assumption 3.11 is in the same spirit as Assumption 3.7. It restricts
the dependence between α and the covariates to a dependence on the mean. Assumption 3.12 is
the assumption of homoscedasticity in m; it is very similar to Assumption 3.6. The difference
between both assumptions stems from the identifying equation we use in both cases. In the
discrete model, α remains in equation (3.2), and thus its variance must be modelled as well as
its covariance with the residuals (εi )1≤i≤m . 15 Finally, Assumption 3.13 is a condition of large
1 = −1.
Obviously, Theorem 3.3 also holds with β10
The assumption of no covariance is not restrictive. Indeed, if there is a correlation between εi and α which does not
depend on i, one can always reparametrize the model in order to make them uncorrelated.
14
15


C The Author(s). Journal compilation 
C Royal Economic Society 2009.

Identification of peer effects using group size variation

405

support. In particular, it implies that m ≥ 3. Otherwise, indeed, the two variables belong to a line
in R2 .
1
β10 , λ0 is also
T HEOREM 3.4. Under Assumptions 3.1, 3.2 , 3.5 and 3.7–3.13, and if β20 = β20
identified.

4. ESTIMATION
In this section, we restrict the analysis to the case where only 1{ỹi ≥ 0} is observed, since the
continuous case is analysed in full detail by Lee (2007). We also restrict ourselves to a parametric
setting with homoscedasticity that is characterized by the following assumptions:
A SSUMPTION 4.1. The residuals (εi )1≤i≤m are i.i.d. and εi ∼ N (0, 1).
A SSUMPTION 4.2. α | x̄, m ∼ N (γ0 (m) + δ0 (m)x̄, σ02 ).
Assumption 4.1 imposes the normality of the residuals. This assumption is also imposed
by Lee (2007) when he develops his conditional maximum likelihood estimator, or by
McMillen (1992) and Beron and Vijverberg (2004), among others, when studying spatially
dependent discrete choice models. Contrary to the previous section, we adopt here the usual
normalization by supposing that the variance of the residuals is equal to one. Assumption 4.2
has two consequences. First, it strengthens Assumptions 3.11 and 3.12 by introducing a linear
dependence à la Mundlak (1961) between α and x̄, conditional on m. Note that the dependence
between α and m remains very flexible. Secondly, Assumption 4.2 imposes the normality of the
residual term, in a similar way to the standard random effect probit.
Under these conditions, the model is fully identified, as in Theorem 3.4 but in a more direct
way. Indeed, β10 and β20 can be identified through group size variations. Moreover, the model
can be written in this case as




β20
+ x̄ δ0 (m) − vi ≥ 0 ,
(4.1)
yi = 1 γ0 (m) + xi β10 −
m−1
where γ0 (m) and δ0 (m) depend on γ0 (m), δ0 (m) and on the parameters of the model, the error
term vi being a combination of (εi )1≤i≤m with the residual α − γ0 (m) − δ0 (m)x̄. Conditional on
m, the vector (vi )1≤i≤m is normally distributed and exchangeable, with


1
2
2
,
V (vi | m) = 1 + σ0 + λ0 (m)(2 + λ0 (m)) σ0 +
m


1
Cov(vi , vj | m) = σ02 + λ0 (m)(2 + λ0 (m)) σ02 +
,
∀ i = j .
m
One can show that when m varies, it is possible to separate λ0 from σ02 in the covariances (or in
the variance).
Now, let us suppose that we observe a sample of R groups where, for the sake of simplicity,
all members in each group are observed (even if we only need to observe x̄). Hence, for group r,
we observe its size mr , the vector of outcomes Yr = (yr1 , . . . , yrmr ) and the vector of covariates
Xr = (xr1 , . . . , xrmr ). We suppose that the sizes (mr )1≤r≤R are i.i.d., and that (Xr , αr , Vr )1≤r≤R
are independent and distributed according to FX,α,V | m,n , where V is the vector of unobserved

C The Author(s). Journal compilation 
C Royal Economic Society 2009.

406

L. Davezies, X. D’Haultfoeuille and D. Fougère

shocks (v1 , . . . , vm ). In the previous example of peer effects in the classroom, this condition
imposes that there is no spillover between classrooms.
Let θ = (β1 , β2 , λ, σ 2 , (γ  (m∗ ), δ  (m∗ ))m∗ ∈Supp(m) ) denote the vector of all parameters. Under
the previous i.i.d. assumption, the likelihood of the whole sample satisfies
L(Y1 , . . . , YR | m1 , . . . , mR , X1 , . . . XR , θ ) =

R


L(Yr | mr , Xr , θ ),

r=1

where L(Yr | mr , Xr , θ ) denotes the likelihood for group r. Moreover, by using (4.1), we can
write this likelihood as:
L(Yr | mr , Xr , θ )





β2


+ x̄r δ (mr ) , . . . ,
= Pr (2yr1 − 1)vr1 ≤ (2yr1 − 1) γ (mr ) + xr1 β1 −
mr − 1




β2
(2yrmr − 1)vrmr ≤ (2yrmr − 1) γ  (mr ) + xrmr β1 −
+ x̄r δ  (mr ) .
mr − 1
This is the probability that a multivariate normal vector belongs to a hyper-rectangle in Rmr .
Such a probability can be estimated, for instance, by the GHK algorithm (Geweke, 1989, Keane,
1994, and Hajivassiliou et al., 1996). Thus, the model can be estimated by simulated maximum
likelihood.

5. MONTE CARLO SIMULATIONS
In this section, we investigate the finite sample performance of our estimator. The sample data are
generated with one regressor xri ∼ N (0, 4), the (xri )r,i being independent for all r and i. The true
parameters are β10 = 1, β20 = 1, λ = 0.2, σ02 = 0.5, γ (m) = 0 for all m, and δ(m) = 0.1 for all
m. As Lee (2007), we consider a case where the average size group is small, and another where it
is relatively large. In the first case, the group sizes vary from 3 to 8, the number of groups of each
size being the same. In the relatively large case, they range from 15 to 25. The first case could
be realistic for groups of good friends or roommates for instance, whereas the second one could
correspond to groups of students in a classroom. In each case, we consider different sample sizes
from 330 to 21,120. In the GHK algorithm, we use Halton sequences instead of standard uniform
random numbers as they improve, on average, the accuracy of the integral estimation (see e.g.
Sándor and András, 2004). In the small group case where the dimension of the integral is low,
we rely on 25 replications, whereas we utilize 50 replications in the large group case.
Table 1 displays our results. The first striking point is that sample sizes must be quite large
to obtain satisfactory results. If we compare the results of our small groups scenario with the
one considered by Lee (see Lee, 2007, Table 1, Model SG-SX), it seems that, observing a binary
measure of ỹi instead of ỹi itself leads to rather large biases for even moderately large sample
sizes. 16 In particular, the bias on λ0 is systematically negative for small and moderately large
sample sizes. The second striking result is the influence of the group sizes. The accuracy of the
16 Note that it is difficult to compare our large group scenario with the one studied by Lee, since he considers a model
1 = 0), while x affects y
with two independent covariates x1i and x2i such that x1i has only a direct effect on yi (i.e. β20
2i
i
2 = 0).
only through exogenous peer effects (so that β10

C The Author(s). Journal compilation 
C Royal Economic Society 2009.

407

Identification of peer effects using group size variation

Sample
size

Table 1. Results of the Monte Carlo simulations.
Small groups

Large groups

Parameter

Mean

Std. err.

Mean

Std. err.

660

β10
β20
λ0

0.9975
0.8956
−0.0304

0.2254
0.8877
0.5688

1.0128
1.4445
−0.3801

0.1658
2.7601
0.6600

1320

β10
β20

1.0029
0.9823

0.1198
0.4885

1.0025
0.9780

0.0865
1.4712

2640

λ0
β10
β20

0.1158
0.9936
0.9378

0.3458
0.0951
0.3739

−0.0026
0.9978
1.0761

0.3093
0.0678
0.8625

5280

λ0
β10
β20

0.1831
0.9904
0.9744

0.1405
0.0664
0.2425

0.1247
1.0001
1.0264

0.1833
0.0419
0.5747

10,560

λ0
β10

0.1927
0.9914

0.0678
0.0451

0.1620
1.0014

0.1167
0.0285

21,120

β20
λ0
β10

0.9708
0.2000
0.9911

0.1690
0.0389
0.0295

1.0240
0.1788
0.9984

0.4303
0.0513
0.0180

β20
λ0

0.9872
0.1897

0.1065
0.0284

0.9777
0.1950

0.2847
0.0311

Notes: The small groups scenario corresponds to a sample composed of groups whose size goes from 3 to 8, the number
of groups of different sizes being equal. The large groups scenario corresponds to a sample of groups whose size goes
from 15 to 25, the number of groups of different sizes being still equal.

estimator of β20 in large groups is approximately the same as the one in small groups, but with
a sample four times larger. This is not surprising, since identification of peer effects becomes
weak as the sample size increases (see Lee, 2007). The parameter λ0 is also better estimated with
small groups, but the difference between the two designs seems to decrease when the sample
size grows. On the other hand, and quite surprisingly, the estimator of β10 is more precise in
large groups.

6. CONCLUSION
This paper considers identification and estimation of social interaction models using group size
variation. Provided that the sizes of the groups are known and vary sufficiently, endogenous and
exogenous peer effects can be identified without any exclusion restriction in the linear-in-means
model. The result can be extended to a binary outcome model. In this case, exogenous peer
effects are also identified under weak assumptions. Identification of endogenous peer effects is
more stringent, as it requires a homoscedasticity condition and restrictions on the dependence
between fixed group effects and covariates.
Our paper has two main limitations. First, the size of each group is assumed to be known.
However, as emphasized by Manski (2000), it is often difficult to define groups a priori. This

C The Author(s). Journal compilation 
C Royal Economic Society 2009.

408

L. Davezies, X. D’Haultfoeuille and D. Fougère

criticism is common to all models of social interactions, but may be especially problematic here.
Indeed, ignoring the boundaries of the group leads (among other difficulties) to measurement
errors on the group size, which could prevent identification. Secondly, we do not consider a fully
non-parametric regression. The issue of whether group size variation has an identifying power in
this general case should be examined in future research.

ACKNOWLEDGMENTS
We would like to thank the editor, two anonymous referees, Stéphane Grégoir, Steve Machin,
Amine Ouazad, as well as the participants in the CEPR Summer School on ‘The Economics of
Education and Education Policy in Europe’ (Padova) and in the CREST seminar (Paris) for their
useful comments.

REFERENCES
Ammermueller, A. and J. S. Pischke (2006). Peer effects in European primary schools: evidence from
PIRLS. IZA Discussion Paper No. 2077, Institute for the Study of Labor (IZA).
Bayer, P. and C. Timmins (2007). Estimating equilibrium models of sorting across location. Economic
Journal 117, 353–74.
Beron, K. J. and W. P. M. Vijverberg (2004). Probit in a spatial context: a Monte Carlo analysis. In
L. Anselin, R. J. G. M. Florax and S. J. Rey (Eds.), Advances in Spatial Econometrics: Methodology,
Tools and Applications, 169–96. Berlin: Springer-Verlag.
Bramoullé, Y., H. Djebbari and B. Fortin (2009). Identification of peer effects through social networks.
Journal of Econometrics 50, 41–55.
Brock, W. A. and S. M. Durlauf (2001). Discrete choice with social interactions. Review of Economic
Studies 68, 235–60.
Brock, W. A. and S. M. Durlauf (2007). Identification of binary choice models with social interactions.
Journal of Econometrics 140, 52–75.
Calvó-Armengol, J., E. Pattacchini and Y. Zenou (2008). Peer effects and social networks in education.
Forthcoming in Review of Economic Studies.
Case, A. (1992). Neighborhood influence and technological change. Regional Science and Urban
Economics 22, 491–508.
Cooley, J. (2007). Desegregation and the achievement gap: do diverse peers help? Working paper, Duke
University.
Duflo, E. and E. Saez (2003). The role of information and social interactions in retirement plan decisions:
evidence from a randomized experiment. Quarterly Journal of Economics 118, 815–42.
Geweke, J. (1989). Bayesian inference in econometric models using Monte Carlo integration. Econometrica
57, 1317–39.
Graham, B. S. (2008). Identifying social interactions through excess variance contrasts. Econometrica 76,
643–60.
Graham, B. S. and J. Hahn (2005). Identification and estimation of the linear-in-means model of social
interactions. Economics Letters 88, 1–6.
Hajivassiliou, V. A., D. McFadden and P. Ruud (1996). Simulation of multivariate normal rectangle
probabilities and their derivatives: theoretical and computational results. Journal of Econometrics 72,
85–134.

C The Author(s). Journal compilation 
C Royal Economic Society 2009.

Identification of peer effects using group size variation

409

Hoxby, C. (2000). Peer effects in the classroom: learning from gender and race variation. NBER Working
Paper No. 7867, National Bureau of Economic Research.
Keane, M. (1994). A computationally practical simulation estimator for panel data. Econometrica 62, 95–
116.
Klier, T. and D. P. McMillen (2008). Clustering of auto supplier plants in the United States: generalized
method of moments spatial logit for large samples. Journal of Business and Economic Statistics 26,
460–71.
Krauth, B. V. (2006). Simulation-based estimation of peer effects. Journal of Econometrics 133, 243–71.
Lazear, E. (2001). Educational production. Quarterly Journal of Economics 116, 777–803.
Lee, L. F. (2007). Identification and estimation of econometric models with group interactions, contextual
factors and fixed effects. Journal of Econometrics 140, 333–74.
Lewbel, A. (1997). Constructing instruments for regressions with measurement error when no additional
data are available, with an application to patents and R&D. Econometrica 65, 1201–13.
Manski, C. F. (1987). Semiparametric analysis of random effects linear models from binary panel data.
Econometrica 55, 357–62.
Manski, C. F. (1993). Identification of endogenous social effects: the reflection problem. Review of
Economic Studies 60, 531–42.
Manski, C. F. (2000). Economic analysis of social interactions. Journal of Economic Perspectives 14, 115–
36.
McMillen, D. P. (1992). Probit with spatial autocorrelation. Journal of Regional Science 32, 335–48.
Mundlak, Y. (1961). Empirical production function free of management bias. Journal of Farm Economics
43, 44–56.
Pinkse, J. and M. E. Slade (1998). Contracting in space: an application of spatial statistics to discrete-choice
models. Journal of Econometrics 85, 125–54.
Rees, D. I., J. S. Zax and J. Herries (2003). Interdependence in worker productivity. Journal of Applied
Econometrics 18, 585–604.
Sándor, Z. and P. András (2004). Alternative sampling methods for estimating multivariate normal
probabilities. Journal of Econometrics 120, 207–34.
Schennach, S. M. (2004). Estimation of non-linear models with measurement error. Econometrica 72, 33–
75.
Tamer, E. (2003). Incomplete simultaneous discrete response models with multiple equilibria. Review of
Economic Studies 70, 147–65.
Wooldridge, J. M. (2002). The Econometrics of Cross-Section and Panel Data. Cambridge, MA: MIT Press.

APPENDIX A: PROOFS
In all the proofs, t ∗ denotes a possible value of the random variable t.
Proof of Theorem 3.1: First, under Assumption 3.3, E(X  Wn U | n, m) = 0. Thus, by Assumption 3.4,
β(m∗ ) is identified for all m∗ ∈ Supp(m). We now prove that the knowledge of m∗ → β(m∗ ) allows in
general to identify the structural parameters.
Let (m∗1 , m∗2 ) ∈ Supp(m)2 . Then
m∗1 − 1 β10 − β20
m∗2 − 1 β10 − β20
=
∗
m1 − 1 + λ0
m∗2 − 1 + λ0
is equivalent to
(β10 λ0 + β20 ) m∗1 − m∗2 = 0.

C The Author(s). Journal compilation 
C Royal Economic Society 2009.

410

L. Davezies, X. D’Haultfoeuille and D. Fougère

Hence, if β20 = −λ0 β10 , β(·) is constant. In the opposite case, β(·) is a one-to-one mapping. In the first case,
β(m∗ ) = β10 for all m∗ . Thus β10 is identified, but λ0 cannot be identified by β(·). Since β20 = −λ0 β10 , β20
is identified up to a constant.
Now suppose that β20 = −λ0 β10 . Let (m∗0 , m∗1 , m∗2 ) be three different values in Supp(m). We will prove
that the knowledge of β(m∗0 ), β(m∗1 ) and β(m∗2 ) allows to identify (β10 , λ0 , β20 ). This amounts to show that
the system
⎧
β m∗0 λ0 − m∗0 − 1 β10 + β20 = −β m∗0 m∗0 − 1
⎪
⎨
β m∗1 λ0 − m∗1 − 1 β10 + β20 = −β m∗1 m∗1 − 1
⎪
⎩
β m∗2 λ0 − m∗2 − 1 β10 + β20 = −β m∗2 m∗2 − 1
has a unique solution. Using the matrix form, we can rewrite the system as Aζ0 = B where ζ0 =
(λ0 , β10 , β20 ) . If det(A) = 0, ζ0 is identified. Suppose that det(A) = 0. Then com(A) B = 0 where com(A)
denotes the comatrix of A. By using the first line of this equation and the expression of det(A), we get:
⎧
⎨ m∗2 − m∗1 β m∗0 + m∗0 − m∗2 β m∗1 + m∗1 − m∗0 β m∗2 = 0
⎩ m∗ − 1 m∗ − m∗ β m∗ + m∗ − 1 m∗ − m∗ β m∗ + m∗ − 1 m∗ − m∗ β m∗ = 0.
0
2
1
0
1
0
2
1
2
1
0
2
Hence,


m∗2 − m∗1 β m∗0 + m∗0 − m∗2 β m∗1 + m∗1 − m∗0 β m∗2 = 0
m∗0 m∗2 − m∗1 β m∗0 + m∗1 m∗0 − m∗2 β m∗1 + m∗2 m∗1 − m∗0 β m∗2 = 0.

Thus,


m∗2 − m∗1 β m∗0 + m∗0 − m∗2 β m∗1 + m∗1 − m∗0 β m∗2 = 0
m∗0 − m∗2

m∗2 − m∗1 β m∗0 + m∗0 − m∗2

m∗1 − m∗2 β m∗1 = 0.

Because m∗1 = m∗2 and m∗0 = m∗2 , this implies that β(m∗1 ) = β(m∗0 ), which is in contradiction with the

fact that β(·) is a one-to-one mapping. Thus, det(A) = 0 and ζ0 is identified.



Wn U 
∗
∗
is known. Thus, under
Proof of Theorem 3.2: Because m → β(m ) is identified, V
λ0  n, m
1+ m−1
Assumption 3.6,



Wn U 
σ2
n,
m
=
V
Wn .

λ0 
2
1 + m−1
1 + λ0
m−1

Hence, for all

m∗1

=

m∗2

∈ Supp(m) ,
2



1+
C≡ 
1+

λ0
m∗1 −1
λ0
m∗2 −1

2
2

is identified. Under Assumption 3.5, 1 + λ0 /(m∗ − 1) > 0 for all m∗ ∈ Supp(m). Thus,
 √

√
1
C
−
λ0 = 1 − C.
m∗1 − 1 m∗2 − 1
√

C
−
It is clear that ( m∗ −1
1
identified.

1
)
m∗2 −1

= 0. Otherwise, C = 1 and m∗1 = m∗2 , which is a contradiction. Thus, λ0 is


C The Author(s). Journal compilation 
C Royal Economic Society 2009.

411

Identification of peer effects using group size variation

Then, because m∗ → β(m∗ ) is identified, β10 − β20 /(m∗ − 1) is known for all m∗ ∈ Supp(m). Taking

two different values for m∗ allows to identify β20 and thus β10 .
Proof of Lemma 3.1: Taking the mean in both sides of equation (2.1) leads to


α
ε̄
β10 + β20
+
+
,
ỹ¯ = x̄
1 − λ0
1 − λ0
1 − λ0
since 1/(1 − λ0 ) exists, according to Assumption 3.5. Because j =i ỹj = mỹ¯ − ỹi and
xi , equation (2.1) is then equivalent to






m
λ0
β20
β10 + β20
= xi β10 −
+ x̄
β20 +
ỹi 1 +
λ0
m−1
m−1
m−1
1 − λ0


λ0
λ0
m
m
+ ε̄
+ εi .
+α 1 +
m − 1 1 − λ0
m − 1 1 − λ0

j =i

xj = mx̄ −

Now, under Assumption 3.5, 1 + λ0 /(m − 1) > 0, so that ỹi ≥ 0 if and only if ỹi (1 + λ0 /(m − 1)) ≥ 0.
Thus, under Assumption 3.5, yi = 1{ỹi ≥ 0}, where ỹi satisfies equation (2.1), is observationally equivalent

to yi satisfying equation (3.2).
Proof of Theorem 3.3: Assumption 3.7 implies that the conditional distribution of εi + λ0 (m)ε̄ is identical
for every i. Thus assumption 1 in Manski (1987) is satisfied and, using our Assumptions 3.8 and 3.9, we can
1
|. The first term of the vector,
apply directly Manski’s result to identify ((m − 1)β10 − β20 )/|m − 1 − β20
1
1
1
((m − 1)β10 − β20 )/|m − 1 − β20 |, is also identified. By Assumption 3.9,
(m−1)β10 −β20

β̃(m) ≡

1
(m − 1)β10 − β20
|m−1−β20
|
=
,
1
1
1
(m−1)β10 −β20
m − 1 − β20
1
|m−1−β20 |

so that β̃(m) is identified as the ratio of two known terms. The rest of the proof for the identification of
1
.
(β10 , β20 ) follows the same development as the one used for Theorem 3.1, λ0 being replaced by −β20

However, λ0 cannot be identified. Indeed, let λ0 = λ0 , and define
εi = εi + ε̄

m(λ0 − λ0 )
.
(m − 1 + λ0 )(1 − λ0 )

Finally, let
α =

mx̄(β10 + β20 )(λ0 − λ0 ) + α(m − 1 + λ0 )(1 − λ0 )
.
(m − 1 + λ0 )(1 − λ0 )

Then the parameters (λ0 , α  , ε1 , . . . , εm ) are observationally equivalent to those characterizing the initial
model. Indeed, we can check that they lead to equation (3.2) as well. Moreover, conditioning on
(m, x1 , . . . , xm , α  ) is equivalent to conditioning on (m, x1 , . . . , xm , α), and conditional exchangeability of
(ε1 , . . . , εm ) implies conditional exchangeability of (ε1 , . . . , εm ). Furthermore, letting λ0 (m) = mλ0 /((m −
1)(1 − λ0 )), we get
Fε1 +ε¯ λ0 (m) | m=m∗ ,x1 =x1∗ ,...,xm =xm∗ ,α =α ∗ = Fε1 +ε̄λ0 (m) | m=m∗ ,x1 =x1∗ ,...,xm =xm∗ ,α=α∗ ,
where
α∗ =

(m − 1 + λ0 )(1 − λ0 )α ∗ − mx̄ ∗ (β10 + β20 )(λ0 − λ0 )
(m − 1 + λ0 )(1 − λ0 )


C The Author(s). Journal compilation 
C Royal Economic Society 2009.

412

L. Davezies, X. D’Haultfoeuille and D. Fougère

and x̄ ∗ = (1/m) i xi∗ . Thus, the second part of Assumption 3.7 also holds with (λ0 , α  , ε1 , . . . , εm ). This

shows that λ0 is not identified.
Proof of Theorem 3.4: Let θ0 = λ0 /(1 − λ0 ) and



m
m
m
νi = x̄
[β20 + θ0 (β10 + β20 )] + α 1 +
θ0 + ε̄
θ0 + εi .
m−1
m−1
m−1
Note that Fν1 ,...,νm | x1 ,...,xm ,m = Fν1 ,...,νm | x̄,m . Indeed
Fν1 ,...,νm | x1 ,...,xm ,m ν1∗ , . . . , νm∗ | x1∗ , . . . , xm∗ , m∗
!
= Fν1 ,...,νm | x1 ,...,xm ,m,α ν1∗ , . . . , νm∗ | x1∗ , . . . , xm∗ , m∗ , α ∗ dFα | x1 ,...,xm ,m α ∗ | x1∗ , . . . , xm∗ , m∗
!
= Fν1 ,...,νm | x̄,α,m ν1∗ , . . . , νm∗ | x̄ ∗ , α ∗ , m∗ dFα | x̄,m (α ∗ | x̄ ∗ , m)
= Fν1 ,...,νm | x̄,m ν1∗ , . . . , νm∗ | x̄ ∗ , m∗ ,
where the third line is derived from Assumption 3.11 and the fact that, given (x1 , . . . , xm , m, α),
(ν1 , . . . , νm ) is a deterministic function of (ε1 , . . . , εm ). Moreover,
Pr y1 = 0, y2 = 0 | x1 = x1∗ , x2 = x2∗ , x̄ = x, m = m∗







β20
β20
x1 = x ∗ , x2 = x ∗ , x̄ = x, m = m∗
, ν2 ≤ −x2∗ β10 −
= Pr ν1 ≤ −x1∗ β10 −
1
2
m−1
m−1 







β20
β20
x, m∗ .
, −x2∗ β10 − ∗
= Fν1 ,ν2 | x̄,m −x1∗ β10 − ∗
m −1
m −1 
Since Theorem 3.3 implies that (β10 , β20 ) is identified, x1∗ (β10 − β20 /(m∗ − 1)) and x2∗ (β10 − β20 /(m∗ − 1))
are known. Moreover, x̄ is observed so that the first term is identified on the whole support of (x1 , x2 )
conditional on (x̄, m). Thus, by Assumption 3.13, making (x1 , x2 ) vary allows us to identify the whole
conditional distribution of (ν1 , ν2 ) given x̄ and m.
Now, by Assumption 3.12,


m
θ0 + ε1 , ε1 − ε2 | x̄, m = V (ε1 | x̄),
Cov(ν1 , ν1 − ν2 | x̄, m) = Cov ε̄
m−1
so that the right-hand-side term is identified. Moreover, a little algebra shows that
#
"
(m − 1)2 Cov(ν1 , ν2 | x̄, m) = m2 (1 + θ0 )2 V (α | x̄) + m [−2(1 + θ0 )V (α | x̄)
+ θ0 (2 + θ0 )V (ε1 | x̄)] + [V (α | x̄) − 2θ0 V (ε1 | x̄)] .
Conditional on x̄, this is a regression of the (known) left term on (m2 , m, 1). By Assumption 3.2 , there
exists a set A of positive probability such that m can take three different values with positive probability,
given that x̄ = x ∗ for all x ∗ ∈ A. Thus, the coefficients (a, b, c) of this regression can be identified. These
coefficients depend on x̄ but, for the sake of simplicity, this dependence is let implicit in the following. We
show now that the knowledge of these coefficients implies that θ0 is identified. The conclusion follows since
θ0 is in a one-to-one relationship with λ0 .
First, we set φ0 = 1 + θ0 and ρ0 = V (α | x̄)/V (ε1 | x̄). We also define a  = a/V (ε1 | x̄), b =
b/V (ε1 | x̄) + 1 and c = c/V (ε1 | x̄) − 2. Then a  , b and c are identified, and
⎧
φ02 ρ0 = a 
⎪
⎨
−2φ0 ρ0 + φ02 = b
⎪
⎩
ρ0 − 2φ0 = c .

C The Author(s). Journal compilation 
C Royal Economic Society 2009.

Identification of peer effects using group size variation
Replacing ρ0 by c + 2φ0 in the first and second equations leads to
⎧


⎪
φ 3 + c2 φ02 − a2 = 0
⎪
⎨ 0


φ02 + 2c3 φ0 + b3 = 0
⎪
⎪
⎩
ρ − 2φ = c .
0

413

(A.1)

0

This system admits at most two solutions in terms of (ρ, φ). Suppose that there exist two different solutions,
and let (ρ1 , φ1 ) denote the second one. Then we can write the polynomial of the first equation as a product
in which one factor is the polynomial of the second equation. Hence, there exists x such that, for all φ ∈ R,


c
a
2c 2 b
= φ2 +
φ +
(φ + x).
φ3 + φ2 −
2
2
3
3
Thus, x = −c /6 and 2c x = −b , which implies that c2 = 3b . Replacing b and c by their values in terms
of φi and ρi (i ∈ {0, 1}), we obtain, for i ∈ {0, 1},
3 −2φi ρi + φi2 − (ρi − 2φi )2 = 0.
This equation is equivalent to φi + ρi = 0. Replacing ρi by −φi in c yields φ0 = φ1 = −c /3 and thus also
ρ0 = ρ1 . This contradicts our assumption that (ρ0 , φ0 ) = (ρ1 , φ1 ). Thus φ0 is identified by system (A.1),
and the conclusion follows.



C The Author(s). Journal compilation 
C Royal Economic Society 2009.

