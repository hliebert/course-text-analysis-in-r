NBER WORKING PAPER SERIES

IDENTIFICATION IN DIFFERENTIATED PRODUCTS MARKETS
Steven T. Berry
Philip Haile
Working Paper 21500
http://www.nber.org/papers/w21500

NATIONAL BUREAU OF ECONOMIC RESEARCH
1050 Massachusetts Avenue
Cambridge, MA 02138
August 2015

The views expressed herein are those of the authors and do not necessarily reflect the views of the
National Bureau of Economic Research.
NBER working papers are circulated for discussion and comment purposes. They have not been peerreviewed or been subject to the review by the NBER Board of Directors that accompanies official
NBER publications.
¬© 2015 by Steven T. Berry and Philip Haile. All rights reserved. Short sections of text, not to exceed
two paragraphs, may be quoted without explicit permission provided that full credit, including ¬© notice,
is given to the source.

Identification in Differentiated Products Markets
Steven T. Berry and Philip Haile
NBER Working Paper No. 21500
August 2015
JEL No. C3,C35,C36,C52,C57,D12,D22,D43,L13
ABSTRACT
Empirical models of demand for‚Äìand, often, supply of‚Äìdifferentiated products are widely used in practice,
typically employing parametric functional forms and distributions of consumer heterogeneity. We
review some recent work studying identification in a broad class of such models. This work shows
that parametric functional forms and distributional assumptions are not essential for identification.
Rather, identification relies primarily on the standard requirement that instruments be available for
the endogenous variables‚Äìhere, typically, prices and quantities. We discuss the kinds of instruments
needed for identification and how the reliance on instruments can be reduced by nonparametric functional
form restrictions or better data. We also discuss results on discrimination between alternative models
of oligopoly competition.

Steven T. Berry
Yale University Department of Economics
Box 208264
37 Hillhouse Avenue
New Haven, CT 06520-8264
and NBER
steven.berry@yale.edu
Philip Haile
Department of Economics
Yale University
37 Hillhouse Avenue
P.O. Box 208264
New Haven, CT 06520
and NBER
philip.haile@yale.edu

1

Introduction

Over the last twenty years there has been an explosion of empirical work using models of differentiated products demand and supply that build on Berry
et al. (1995) (‚ÄúBLP‚Äù). Initially this work focused on traditional topics in industrial organization such as market power, mergers, or the introduction of
new goods. But as Table 1 suggests, these models are being applied to an
increasingly broad range of markets and questions in economics. Of course,
a quantitative understanding of demand and/or supply is essential to answering many positive and normative questions in a wide range of markets, and
most markets involve differentiated goods. Empirical models following BLP
are particularly attractive for such applications because they allow for both
heterogeneity in consumer preferences and product-level unobservables. The
former is essential for accurately capturing consumer ‚Äúsubstitution paterns‚Äù
(own- and cross-price demand elasticities) while the latter makes explicit the
source of the endogeneity problems that we know arise in even the most elementary supply and demand settings.
Table 1: Example Markets and Topics

Topic

Example Papers

transportation demand
market power
mergers
welfare from new goods
network effects
product promotions
environmental policy
vertical contracting
equilibrium product quality
media bias
asymmetric info & insurance
trade policy
residential sorting
voting
school choice

McFadden et al. (1977)
Berry et al. (1995), Nevo (2001)
Nevo (2000), Capps et al. (2003)), citeFan
Petrin (2002), Eizenberg (2011)
Rysman (2004), Nair et al. (2004)
Chintagunta & HonoreÃÅ (1996), Allenby & Rossi (1999)
Goldberg (1998)
Villas-Boas (2007), Ho (2009)
Fan (2013)
Gentzkow & Shapiro (2010))
Cardon & Hendel (2001), Bundorf et al. (2012), Lustig (2010)
Goldberg (1995), Berry et al. (1999), Goldberg & Verboven (2001)
Bayer et al. (2007)
Gordon & Hartmann (2013)
Hastings et al. (2010), Neilson (2013)

Until recently, however, identification of BLP-type models was not well understood. One often encountered informal speculation‚Äîeither that the models
were identified only through functional form restrictions, or that certain model
parameters were identified by certain moments of the data. But there was no
formal analysis applicable to this class of models. Here we discuss some recent work on this topic, focusing primarily on results presented in Berry et al.
1

(2013), Berry & Haile (2014), and Berry & Haile (2010).1 This work considers
nonparametric generalizations of the BLP model and provides sufficient conditions for identification of demand, identification of firms‚Äô marginal costs and
cost functions, and discrimination between alternative models of firm behavior.
Broadly speaking, these papers show that when it comes to identification,
there is nothing special about BLP-type models. Even in a fully nonparametric specification, the primary requirement for identification is the availability
of instruments providing sufficient exogenous variation in prices and quantities. These results both provide comfort‚Äîthat the functional forms and
distributional assumptions used for approximation in finite samples are not
essential‚Äîand clarify which kinds of instrumental variables can suffice.
In this review we give an overview of some key ideas and results from this
recent work. We also discuss practical implications for applied work, focusing
in particular on the types of instruments yielding identification of the most
flexible models, as well as tradeoffs between the flexibility of the model (e.g.,
between alternative weak separability restrictions), the types of data available
(e.g., market-level vs. individual-level), and the demands on instrumental
variables.

1.1

A Starting Point: The BLP Demand Model

On the demand side, BLP builds on classic models of demand with endogenous
prices, on the rich literature discussing discrete choice models of demand (as
in McFadden (1981)) as well as on a few earlier pioneering empirical works
on differentiated product markets in equilibrium, especially Bresnahan (1981,
1987). One variation of this model (see Berry et al. (1999)) posits that consumer i‚Äôs conditional indirect utility for good j in market t can be written
as
vijt = xjt Œ≤it ‚àí Œ±it pjt + Œæjt + ijt .
(1)
Here the vector xjt represents observed exogenous product characteristics, Œæjt
is an unobserved product/market characteristic, and pjt is the endogenous
characteristic price.2
In addition to an i.i.d. idiosyncratic product/consumer ‚Äúmatch value‚Äù ijt ,
there are two types of unobservables in (1), both essential. One is the vector
(Œ≤it , Œ±it ) of random coefficients on xjt and pjt . These random coefficients allow
heterogeneity in preferences that can explain why consumers tend to substitute
1

We will also make some use of a recent literature on the identification of simultaneous
equations, as represented by Matzkin (2008), Matzkin (2015) and Berry & Haile (2015).
2

For simplicity we discuss only the usual case in which price is the (only) endogenous
product attribute. The arguments extend to the case of other endogenous attributes, although when there is more than one endogenous characteristic per good, the number of
instruments required will be greater.

2

among ‚Äúsimilar‚Äù products (those close in (xt , pt )-space) when prices or other
attributes of the choice set change. The second is the product/market-level
unobservable Œæjt . The presence of these demand shocks is not only realistic
(typically we don‚Äôt observe all relevant attributes a product or market) but
also generates the familiar problem of price endogeneity. That is, the price of
a good in a given market will typically be correlated with the latent demand
shocks (those associated with all goods) in that market. Such correlation
is implied, for example, by standard oligopoly models when firms know the
realizations of these shocks or, more generally, the elasticities of the demand
system. It is this combination of rich consumer heterogeneity through latent
taste shocks and endogeneity through product/market-specific demand shocks
that distinguishes the BLP framework, and upon which the nonparametric
models of Berry & Haile (2014) and Berry & Haile (2010) build.
The parametric BLP model already raises a number of difficult questions
about identification. One is how to handle the problem of price endogeneity. Instrumental variables will typically be needed. Classic instruments for
prices are exogenous cost shifters. Berry et al. (1995) made limited use of
cost shifters, combining these with instruments (characteristics of competing
products‚Äîthe so-called ‚ÄúBLP instruments‚Äù) that economic theory tells us will
shift equilibrium markups (in addition to shifting market shares conditional
on prices). Following Hausman (1996), Nevo (2001) emphasized proxies for
cost shifters (prices of the same good in other markets), while Berry et al.
(1999) added a range of cost shifters like exchange rates. A more subtle point
involves identification of the ‚Äúsubstitution‚Äù parameters‚Äîthose governing the
distribution of the random coefficients. Intuition suggest that these parameters would be identified by exogenous changes in choice sets (e.g., additions
and removals of choices), since these would directly reveal the extent to which
consumers tend to substitute to ‚Äúsimilar‚Äù goods. But such exogenous variation often is limited if present at all. So can more continuous changes in choice
sets‚Äîsay, variation in prices of a fixed set of goods‚Äîdo the job? Are the kinds
of instruments used in practice sufficient to identify these parameters without
relying on distributional assumptions? What about models with less parametric structure on consumer preferences? Can anything be gained by combining
the supply and demand model in a single system (see, e.g., Bresnahan (1987),
Berry et al. (1995))? Does consumer-level demand data help? Although there
are many empirical papers that follow on the BLP parametric form, these
identification questions remained without a formal answer for many years.

1.2

Related Literatures

We have already mentioned some key papers that motivate the work we review,
but we pause here to highlight a few others. A huge literature on applied
discrete choice demand goes back at least to McFadden (1974), with many
3

later contributions. On the supply side, the idea of estimating marginal costs
by using first-order conditions for imperfectly competitive firms goes back to
Rosse (1970), continues through the ‚ÄúNew Empirical IO‚Äù literature of the 1980s
(see Bresnahan (1989)) and has become a standard tool of the empirical IO
(and auctions) literatures. The literature on discriminating between different
modes of oligopoly competition dates at least to Bresnahan (1982) and Lau
(1982).
In addition, there is an extensive pre-existing literature on the identification
of semi/nonparametric discrete choice models. Perhaps surprisingly, these
papers do not cover models with the key features (consumer heterogeneity and
endogeneity through product-level unobservables) of the BLP framework. A
number of papers consider rich taste heterogeneity, but without endogeneity.
Examples include Ichimura & Thompson (1998) and Briesch et al. (2010).
Other papers on the nonparametric identification of discrete choice models
without endogeneity concerns include Manski (1985), Manski (1987), Manski
(1988), Matzkin (1992), Matzkin (1993), Magnac & Maurin (2007), and Fox
& Gandhi (2011).
Another set of papers (e.g., Blundell & Powell (2004)) discuss control function techniques for dealing with endogeneity. However, control function techniques apply to triangular (or recursive) systems of equations, not to a fully
simultaneous system that arises in a model of differentiated products supply
and demand (see also Blundell & Matzkin (2014)).
Yet another set of papers considers endogeneity involving correlation between a choice characteristic and unobservables at the individual (‚Äúconsumer‚Äù
or ‚Äúworker‚Äù) level. One example here is Lewbel (2000), who models a conditional indirect utility function along the lines of
ij ‚àº F (¬∑|xij )

vij = xij Œ≤ + ij

(2)

Here, observed x variables can shift the distribution of  at the consumer
level. However, the typical counterfactual of interest in a differentiated products context involves holding both market-level unobservables and consumer
tastes fixed while letting the distribution of utilities change with the value of
an observed endogenous variable (e.g. price). This requires a different framework. Other papers that consider endogeneity in discrete choice models, but in
a framework different from the differentiated products framework we discuss
include (among others) HonoreÃÅ & Lewbel (2002), Hong & Tamer (2003), Altonji & Matzkin (2005), Lewbel (2006), Hoderlein (2009) and Petrin & Gandhi
(2011).

1.3

The Path Ahead

Looking ahead to the remainder of the paper, we first review some familiar
parametric demand models in order to motivate key ideas behind our ap4

proach. We then discuss identification of demand when one has only market
level data, as in the original BLP paper. This is followed by a discussion of the
gains that can be obtained from observing individual-level(‚Äúmicro‚Äù) data. Micro data does not eliminate the endogeneity problem, but it can substantially
reduce the number of instruments required for identification. We then turn to
identification of the supply side, including results that demonstrate constructive joint identification of marginal costs and demand, as well as results on
discrimination between alternative static oligopoly models.

2

Insights from Parametric Models

Our approach to the nonparametric identification problem builds on insights
from familiar parametric models. Consider a standard multinomial logit model
(incorporating product-specific unobservables) where consumer i‚Äôs conditional
indirect utility from product j > 0 in market t is
vijt = xjt Œ≤ ‚àí Œ±pjt + Œæjt + ijt

(3)

and the conditional indirect utility from the outside good (‚Äúgood 0‚Äù) is normalized to vi0t = i0t . Letting
Œ≥jt = xjt Œ≤ ‚àí Œ±pjt + Œæjt ,
choice probabilities (or ‚Äúmarket shares‚Äù) are given by the well known formula
sjt =

1+

eŒ≥jt
P

k

eŒ≥kt

.

(4)

While each share depends on the entire vector (Œ≥1t , . . . , Œ≥Jt ), the share of good
j is strictly increasing in Œ≥jt . Thus, the ‚Äúmean utility‚Äù Œ≥jt has the flavor of a
‚Äúquality index‚Äù that has both an observed and unobserved component.
As is well known, the relationship (4) can be inverted to express each index
as a function of the market share vector: Œ≥jt = ln(sjt ) ‚àí ln(s0t ). Remembering
the definition of the index Œ≥jt , we have
ln(sjt ) ‚àí ln(s0t ) = xjt Œ≤ ‚àí Œ±pjt + Œæjt .
As noted in Berry (1994), this now looks like a regression model with an
endogenous covariate pjt . To identify the model parameters (Œ±, Œ≤) one needs
an instrument
 for price. To look even more like what we do later, partition xjt
(1)

(2)

as xjt , xjt

(1)

(2)

where xjt is a scalar. Then condition on xjt and rewrite (2) as
Œ±
1
(1)
xjt + ŒæÀújt = (ln(sjt ) ‚àí ln(s0t )) + pjt ,
Œ≤
Œ≤
5

(5)

with ŒæÀújt = Œæjt /Œ≤. Note that the right-hand side of this expression is a tightly
parameterized function of shares and prices while the left-hand side is just a
(1)
linear index of xjt and the (rescaled) unobserved characteristic.
More complicated models yield this same general form, only with less restrictive functions of shares and prices on the right-hand side. For example, if
we follow the same steps for the two-level nested logit model one can obtain
(see Berry (1994)) the equation
ln(sjt ) ‚àí ln(s0t ) = xjt Œ≤ ‚àí Œ±pjt + (1 ‚àí Œª) ln(sj|g,t ) + Œæjt .
where sj|g,t denotes the share of good j within its nest (or ‚Äúgroup‚Äù) g. This
again looks like a regression model, but now identification requires instruments not only for pjt but also for the endogenous share ln(sj|g,t ). Loosely
speaking, the need for this ‚Äúextra‚Äù instrument reflects the new parameter Œª,
which (compared to the multinomial logit) gives more flexibility to the pat(2)
terns of substitution permitted by the model. Again, fix xjt and rewrite this
as
 Œ±
1
(1)
(6)
ln(sjt ) ‚àí ln(s0t ) ‚àí (1 ‚àí Œª) ln(sj/g,t ) + pjt ,
xjt + ŒæÀújt =
Œ≤
Œ≤
yielding a linear index on the left and a more complicated function of price
and shares on the right.
Finally, consider the BLP model and assume that there is one element of
(1)
the product characteristic vector, xjt , that does not have a random coefficient.
Then the model can once again be rewritten with a non-random linear index
(1) (1)
xjt Œ≤ÃÑ0 + ŒæÀújt for each product. Although there is no longer a closed form for the
inverse of the system of market shares, BLP show that such an inverse exists
(and provide a computational algorithm). To make a connection to equations
(5) and (6), we can write this inverse as


1
(2)
(1)
(7)
xjt + ŒæÀújt = (1) Œ¥ÃÉj st , pt , xt , Œ∏ .
Œ≤ÃÑ0
Compared to (5) and (6), the right-hand side of (7) is now a more complicated
function of prices and market shares, all of which are endogenous. For identification of the parameters in this equation, one needs instruments for prices,
and additional instruments for the market shares that appear in the inverse
function Œ¥ÃÑj . In the literature, the latter set of instruments are often described
loosely as instruments identifying the ‚Äúnonlinear‚Äù parameters of the model‚Äî
those determining how the random coefficients affect substitution patterns.
Our discussion of each of these examples featured three key components:
1. an index of each good‚Äôs unobserved characteristic and an observed characteristic,
2. an inversion mapping observed market shares to each index, and
6

3. a set of instrumental variables for the prices and market shares appearing
in the inverse function.
Our approach to nonparametric identification will make use of this same sequence of features.

3

Identification of Demand From Market Level
Data

3.1

Demand Model

We begin by sketching the discrete choice demand model of Berry & Haile
(2014). In each market t there is a continuum of consumers. In practice
markets are typically defined by time and/or geography, although one can use
observed consumer characteristics to define markets more narrowly. Formally,
a market is defined by {Jt , œát }, where Jt denotes the number of ‚Äúinside goods‚Äù
available. The ‚Äúoutside good‚Äù‚Äîthe option to purchase none of the modeled
goods‚Äîis always available as well and indexed as ‚Äúgood 0.‚Äù The matrix œát
describes all product and market characteristics (observed and unobserved).3
We henceforth condition on the number of goods available, setting Jt = J for
all t. In each market, each consumer i chooses one good j ‚àà {0, 1, . . . , J}.
Following the BLP notation above,
‚Ä¢ xjt ‚àà RK is a vector of exogenous observables,
‚Ä¢ pjt ‚àà R is a vector endogenous observables (prices), and
‚Ä¢ Œæjt ‚àà R is a market/choice-specific unobservable.
We let xt = (x1t , . . . , xJt ) , pt = (p1t , . . . , pJt ) and Œæt = (Œæ1t , . . . , ŒæJt ). Thus, the
characteristics of the market are œát = (xt , pt , Œæt ) .
Demand is derived from a random utility model. Each consumer i in market
t has preferences characterized by a vector of conditional indirect utilities
(henceforth ‚Äúutilities‚Äù) for the available goods:
vi0t , vi1t, . . . , viJt .
The utility vi0t of the outside good is normalized to zero. From the econometrician‚Äôs perspective, for each consumer i, (vi1t, . . . , viJt ) is a vector of random
variables drawn from a joint distribution Fv (¬∑|œát ).
Thus far the model is extremely general, placing no restriction on how
Fv (¬∑|œát ) depends on œát . Implicitly we have imposed one significant assumption
3

We use the terms ‚Äúgood,‚Äù ‚Äúproduct,‚Äù and ‚Äúchoice‚Äù interchangeably.

7

on the demand model by restricting the jt-level unobservable Œæjt to be a scalar.
This is standard in practice and appears difficult to relax without data on
multiple decisions (e.g., panel data, ranked data, or repeated choice data) or
distinct sub-markets (subpopulations of consumers) assumed to share the same
demand shocks (see, e.g., Athey & Imbens (2007)).
We further restrict the model with an index structure. In particular,
we
 the exogenous observed characteristics into two parts, xjt =
 partition
(1)

(2)

(1)

xjt , xjt , with xjt ‚àà R. For each good j we then define an index


(1)
Œ¥jt = Œ¥j xjt , Œæjt ,

(8)

for some (possibly unknown) function Œ¥j that is strictly increasing in Œæjt . We
(1)
will require that the joint distribution Fv (¬∑|œát ) depend on xjt and Œæjt only
through the index Œ¥jt ; i.e., letting Œ¥t = {Œ¥1t , . . . , Œ¥Jt },
(2)

Fv (¬∑|œát ) = Fv (¬∑|Œ¥t , xt , pt ).

(9)

This is a weak separability condition. Although it places no restriction on how
(2)
(Œ¥t , xt , pt ) together alter the joint distribution of utilities, it requires that the
(2)
(1)
marginal rate of substitution between xjt and Œæjt be invariant to (xt , pt ).
This condition is satisfied in all of our empirical examples. However, whereas
those examples specified utilities that are separable in the index, this is not
required by (9).
(2)
Henceforth we condition on xt , suppress it in the notation when possible,
(2)
(1)
and let xjt denote xjt . The model is then completely general in xt . For the
results of this section, we will also assume that each Œ¥j is linear:
(1)

Œ¥jt = xjt Œ≤j + Œæjt ,

(10)

with each Œ≤j normalized to one without loss (this merely defines the units of
Œæjt ). Berry & Haile (2014) discuss identification with a nonseparable index,
and we discuss the case of a nonlinear but separable index below.
As usual, market level demand is derived from the conditional (on œát )
distribution of random utilities. Each consumer chooses the product giving
the highest utility, yielding choice probabilities (market shares)


sjt = œÉj (œát ) = œÉj (Œ¥t , pt ) = Pr arg max vijt = j|Œ¥t , pt
j = 1, . . . , J. (11)
j‚ààJ

The functions œÉj fully characterize the demand system. We observe (st , xt , pt ).
If we also observed each Œæjt we would directly observe the demand functions
(œÉ1 , . . . , œÉJ ); i.e., identification of demand would be trivial. Thus, the main
challenge to nonparametric identification of demand is endogeneity arising
8

through the unobservables Œæjt . In fact, the challenge here is more complex
than in many familiar economic settings because each of the endogenous
variables pjt and sjt (price and quantity) depends on all J demand shocks
(Œæ1t , . . . , ŒæJt ). Standard IV and control function approaches cannot be applied here because prices and quantities are determined in a fully simultaneous
system. Our approach to overcoming these challenges builds on the ‚Äúindexinverse-instruments‚Äù intuition developed above for the parametric examples.
We have already described the index restriction. We next discuss the inversion
of market shares.

3.2

Inversion

The goal of the inversion step is to show that, given any vector of prices and
nonzero market shares, there is a unique vector of indices Œ¥t that can rationalize
this observation with the demand system (11). Berry et al. (2013) demonstrate
this invertibility under a condition they call ‚Äúconnected substitutes.‚Äù4 This
condition has two parts. The first is that all goods are weak gross substitutes
with respect to the indices; i.e., for k 6= j, œÉk (Œ¥t , pt ) is weakly decreasing in
Œ¥jt for all (Œ¥t , pt ) ‚àà R2J . This is little more than a monotonicity assumption
implying that Œ¥jt is ‚Äúgood‚Äù (e.g., an index of product ‚Äúquality‚Äù) at least on
average across consumers. A sufficient condition is that, as in the parametric
examples, higher values of Œ¥jt raise the utility of good j without affecting the
utilities of other goods.
The second part of the Berry et al. (2013) connected substitutes condition
is ‚Äúconnected strict substitution.‚Äù This condition requires that starting from
any good j there be a chain of substitution leading to the outside good. In
a multinomial logit model (or any discrete choice model like the BLP model
where additive shocks to utilities have full support) all goods strictly substitute
directly to the outside good (all else equal, an increase in the quality of good
j causes the market share of the outside good to fall), so the condition is
satisfied. In a classic model of pure vertical differentiation, each good strictly
substitutes only with its immediate neighbors in the quality hierarchy, but
those goods substitute to their neighbors and so forth. Starting from any
good j > 0, there will therefore be a path from one neighbor to the next
that eventually links j to the outside good. Thus, in the vertical model, the
connected strict substitution requirement is again satisfied.
Formally, a good j substitutes to good k at (Œ¥t , pt ) if œÉk (Œ¥t , pt ) is strictly
decreasing in Œ¥jt . We represent the pattern of strict substitution with a matrix
Œ£ (Œ¥t , pt ) that has entries

1 {good j substitutes to good k at x} j > 0
Œ£j+1,k+1 =
0
j = 0.
4

Their result applies outside the discrete choice framework studied here as well.

9

The second part of the connected substitutes condition is that for all (Œ¥t , pt )
in their support, the directed graph of Œ£ (Œ¥t , pt ) has, from every node k 6= 0, a
directed path to node 0.5
Berry et al. (2013) discuss a range of examples and point out that when
Œ¥jt is a quality index, it is extremely hard to break the connected substitutes
assumption in a discrete choice setting. Weak substitutes is a direct implication of weak monotonicity in a discrete choice model, and connected strict
substitution then requires only that there is no strict subset of the goods that
substitute only among themselves. That is to say, all the goods must ‚Äúbelong‚Äù
in one demand system.
Given connected substitutes, Berry et al. (2013) prove existence of the
inverse market share function. That is, for all j there is a function œÉj‚àí1 such
that
Œ¥jt = œÉj‚àí1 (st , pt )
(12)
for all (st , pt ) in their support.
We will not discuss the proof, but point out that this result offers an
alternative to the classic invertibility results of Gale & Nikaido (1965) or Palais
(1959), which can be difficult to apply to demand systems. Because Berry et
al‚Äôs result can be applied outside the discrete choice setting considered here,
an interesting question is whether this can be used as the starting point for
studying identification of demand in other settings as well.
Unlike the inversion results for the parametric examples, the invertibility
result of Berry et al. (2013) is not a characterization (or computational algorithm) for the inverse. Nonetheless, having established that the inverse exists,
we can move on to its identification using instrumental variables. Note that
once the inverse is known, so is the value of each index Œ¥jt and, therefore, each
demand shock Œæjt . Thus, once we demonstrate identification of the inverse, it
is as if there were no unobservables‚Äîa situation in which (as discussed above)
identification of the demand system is trivial.

3.3

Instruments: Identifying the Inverse Demand System

The final step of the argument involves using instrumental variables to identify
the inverse market share functions. Recalling that we have let
Œ¥ij = xjt + Œæjt
we can rewrite (12) as
xjt = œÉj‚àí1 (st , pt ) ‚àí Œæjt .
5

(13)

One can of course define the connected substitutes condition in terms of substitution in
response to changes in a product characteristic other than the index‚Äîfor example, price.

10

This equation bears close resemblance to the standard nonparametric regression model studied by Newey & Powell (2003). They considered identification
of the model
yi = Œì (xi ) + i ,
(14)
using instrumental variables wi that satisfy a standard exclusion restriction
that E [i |wi ] = 0 a.s. They show that the analog of the classic rank condition
for identification of a linear regression model is a standard ‚Äúcompleteness‚Äù
condition (Lehmann & Scheffe (1950, 1955)), namely that if B(¬∑) is a function with finite expectation satisfying E [B (xi ) |wi ] = 0 almost surely, then
B (xi ) = 0 almost surely. Like the classic rank condition, completeness requires that the instruments shift the endogenous variables around ‚Äúenough;‚Äù
further, like the rank condition, completeness is not only sufficient but also
necessary for identification of the unknown regression function Œì.
Equations (13) and (14) are not quite equivalent. Whereas the endogenous
variable Yi appears alone on the left in (14), in (13) all endogenous variables
enter through the unknown function œÉj . Further, in (13) the exogenous observable xjt ‚Äîwhich we will see is an essential instrument‚Äîis not excluded.
Nonetheless, Berry & Haile (2014) show that the proof used by Newey &
Powell (2003) can be used to establish identification of (14) under analogous
exclusion and completeness conditions. In particular, let wt now denote a set
of observables and suppose that (i) E[Œæjt |xt , wt ] = 0 a.s., and (ii) for all functions B (st , pt ) with finite expectation,6 if E [B (st , pt ) |xt , wt ] = 0 a.s. then
B (st , pt ) = 0 a.s. Then each of the inverse functions œÉj (¬∑) is identified. Given
(13) each unobserved product characteristic Œæjt is then identified, and identification of the demand system (11) follows immediately.
We discuss the availability of instruments below. However, it is worth
pausing to observe that this result provides a reassuringly ‚Äúdull‚Äù answer to
the question of what ensures identification of demand in a BLP-type model:
instruments for the endogenous variables. Because the model involves discrete
choice, rich consumer heterogeneity, and a simultaneous system (e.g., all prices
and quantities depend on all J demand shocks), the best possible hope is
that identification would be obtained under same IV conditions needed for
identification of a homogeneous regression model with a separable scalar error.
This is what is shown by Berry & Haile (2014).

3.4
3.4.1

Discussion
Demand versus Utility

The demand functions œÉj are the main features of interest on the consumer
side of the model. These functions determine all demand counterfactuals (up
6

Other types of completeness assumptions (see, e.g., Andrews (2011)) can also suffice.

11

to extrapolation/interpolation, as usual). Demand is the input from the consumer model needed to estimate marginal costs, to test models of supply, to
simulate a merger, and so forth. However, demand is not necessarily enough to
identify changes in consumer welfare. As usual, valid notions of aggregate welfare changes can be obtained under an additional assumption of quasilinearity.
Welfare changes (changes in consumer surplus) are then identified whenever
demand is.
Berry-Haile-market also show how to extend identification of demand to
identification of the joint distribution of random utilities, Fv (¬∑|œát ) under standard quasi-linearity and support conditions. However, given identification of
demand and consumer surplus, there is often little gain from identifying a
particular distribution of random utilities consistent with demand.
3.4.2

Instrumental Variables

Although it is encouraging that essentially ‚Äúall‚Äù one needs for identification
is a suitable set of instruments, this leads to the important question of what
kinds of observables can play the role of these instruments in practice. One
important observation is that for the completeness condition above to hold the
instruments must have dimension no less than 2J‚Äîi.e., instruments for all 2J
endogenous variables (st , pt ) are needed. This should not be surprising given
the discussion of the parametric examples. Except in the most restrictive
of these models, we required instruments not only for prices but for some
quantities (market shares) as well. Formally, this requirement reflects the fact
that in a multi-good setting the quantity demanded of a given good depends
on the endogenous prices of all goods as well as the demand shocks associated
with all goods.7 Inverting the demand system is a valuable ‚Äútrick‚Äù producing a
system with only one structural error (demand shock) per equation (see (13)).
But in general the resulting inverted demand equations each depend on all
prices and quantities. Identification of the inverse demand function requires
independent exogenous variation in each of these variables.
Excluded cost shifters (e.g., input prices) are the classic instruments for
identifying demand. Proxies for cost shifters or for marginal costs themselves
(if these proxies are properly excluded from demand) can of course substitute.
Hausman (1996) proposed a particular type of proxy for the marginal cost of
good j in market t: the prices of good j in other markets t0 (see also Nevo
(2000)). Another type of candidate instrument is an excluded shifter of firm
markups. One possibility involves demographics of other markets falling in the
same ‚Äúpricing zone‚Äù (see, e.g., Gentzkow & Shapiro (2010) or Fan (2013)). The
availability and suitability of these different types of instruments varies across
7

Contrast this with a classical supply and demand model, where the quantity demanded
depends on only one endogenous price and one demand shock.

12

applications. Excluded cost shifters are sometimes available, either at the firm
or product level. ‚ÄúHausman instruments‚Äù can always be constructed from a
market-level data set but have been controversial: in some applications the
exclusion restriction may be difficult to defend, and in others the instruments
may have little cross-market variation. Instruments based on demographics of
other markets require at least market-level demographic data and a supplyside connection (like zonal pricing) between the price in one market and the
demographics of another.
But even when one has suitable instruments in one or more of these classes,
the analysis above reveals something important: such instruments cannot suffice on their own in the model above. This is because costs and markups affect
the endogenous variables (st , pt ) only through prices.
This point may become more clear by considering the identification problem when all price variation is exogenous (mean independent of Œæt ). With
(2)
exogenous prices, pt can be treated as an element of xt and held fixed for the
purposes of studying identification. The inverted demand equations then take
the form (cf. (13))
xjt = œÉj‚àí1 (st ) ‚àí Œæjt .
(15)
Each of these equations involves the J-dimensional endogenous variable st .
Identification can still be obtained following the argument above, but this
requires instruments for st . Excluded shifters of costs or markups cannot do
the job because they only alter shares through prices (which are fixed).
This raises the question of what remaining instruments, excluded from the
inverse market share function, can shift st in (13). The exogenous product
characteristics xt are the only available instruments, and they are of the correct dimension. Thus, our result on the identification of demand requires J
dimensional instruments wt affecting prices (costs or markups), plus the product characteristics that enter the demand indices Œ¥jt . Strictly speaking, the
identification result provides sufficient conditions; however, given the presence
of 2J endogenous variables, it seems unlikely that one could avoid the need
for exogenous variation of dimension 2J without additional data or structure.
Some intuition about the role of the instruments xt can be seen by first
recalling that we have inverted the market share function, placing the shares
on the right-hand side instead of the indices Œ¥t . Holding prices fixed (with
other instruments for prices), by the implicit function theorem the derivative
matrix of market shares with respect to the quality indices is the (matrix)
inverse of the inverse market share functions with respect to shares. Thus,
identifying the effect of shares in the inverse demand system (13) is equivalent
to identifying the effect of the ‚Äúquality‚Äù index Œ¥t on market shares. The xt
vector directly shifts the indices Œ¥t , so it is not surprising that these are appropriate instruments for market shares in the inverse demand function. Further,
without the index structure that links the effects of Œæjt to the effects of xjt , it
13

is not clear how one could quantify the effects that a changes in unobservables
have on demand. With the linear index structure this link is particularly clear:
a unit increase in Œæjt has the same effects as a unit increase in xjt .
This analysis also clears up some possible confusion about the excludability
of the BLP instruments. On one hand, it natural to ask how (whether) demand
shifters could be properly excluded from demand. On the other hand, it is clear
that characteristics of goods k 6= j are excluded from the utility of good j, and
the parametric examples suggest that perhaps this is enough. We can see in
the analysis above that it is the index restriction which makes the exogenous
(2)
variables xt available as instruments (rather than being fixed like xt ) and
which yields a system of inverse demand equations in which each xjt appears
in only one equation. Thus, as suggested above, the index restriction and the
BLP instruments are both central to the identification result above.
We also see that the BLP instruments are not sufficient on their own in this
model. They provide the required independent variation in st , but something
else must provide the independent exogenous variation in pt .8 This requires additional instruments for costs or markups. The importance of combining both
types of variation has been recognized in much of the applied literature. For
example, Berry et al. (1995) utilized both the ‚ÄúBLP instruments‚Äù and proxies
for marginal cost, and Berry et al. (1999) added further cost instruments. The
importance of having both types of instruments, even in a parametric setting,
is supported by recent simulations in Reynaert & Verboven (2014). The results
of Berry & Haile (2014) may explain why: both types of instruments appear
to be essential, at least without additional data or structure.
3.4.3

Nonparametric Functional Form Restrictions

We saw in the parametric examples that the instrumental variables requirements were milder than those for the fully nonparametric case. In fact, the
parametric structure not only reduced a completeness condition to a standard
rank condition, but also cut the number of instruments required. This suggests
a potentially important role for functional form restrictions in substituting for
sources of exogenous variation. This may be a concern in some applications,
where one suspects that functional form, rather than exogenous variation, is
pinning down demand parameters. But this tradeoff may be advantageous in
other cases: it is sometimes difficult to find J-dimensional cost shifters (or
proxies) that can be excluded from demand, and further exploration reveals
that even fairly modest restrictions on the demand system can yield substantial
reductions in the instrumental variables requirements.
8

cf. Armstrong (2015). The vector xt typically will alter elasticities and therefore
markups (prices). However, our formal argument relies on the direct effect of xt on shares,
holding prices fixed.

14

To illustrate one such possibility, consider a stronger weak separability
(1)
requirement where price is included in the index Œ¥jt along with xjt (i.e., xjt )
and Œæjt :
Œ¥jt = xjt Œ≤ ‚àí Œ±pjt + Œæjt .
(16)
This specification substantially generalizes versions of the BLP model in which,
as often assumed in applied work, price and at least one exogenous observable
enter the utility function without a random coefficient. Without loss of generality, we can choose the units of Œæjt by setting Œ± = 1. The equations of the
inverse demand system then have the form
xjt Œ≤ ‚àí pjt + Œæjt = œÉj‚àí1 (st )
or
pjt = ‚àíœÉj‚àí1 (st ) + xjt Œ≤ ‚àí Œæjt .
This takes the form of a classic inverse demand function with price on the
left hand side and quantities (here, shares) on the right. In this case, because
shares are the only endogenous variables on the right, the BLP instruments
x‚àíjt can suffice alone: instruments for costs or markups would still be useful
in practice but would not be necessary for identification.
There are many other possibilities for imposing functional form restrictions
that reduce the instrumental variable requirements. These include a variety of
nonparametric restrictions such as symmetry (exchangeability), various nesting structures, etc., that can often be motivated by economics or features of
the market being studied.

4

Gains from Micro Data

Better data can also relax the instrumental variables requirements. Here we
consider ‚Äúmicro data‚Äù that matches individual choices to consumer/choicespecific observables
zit = (zi1t , . . . , ziJt ) ,
where each zijt ‚àà R.9 Often these consumer/choice-specific variables will involve interactions between consumer attributes (say dit ) and product attributes
(1)
(xt or x(2) in the notation of the previous section.) For example, many applications have utilized interactions of consumer and choice locations to create
measures of consumer√óproduct-specific distances
9

Other consumer-level observables can be accommodated in a fully flexible way by treating these as characteristics (elements of xt ) of distinct markets. This would permit a different
vector of unobservables Œæt for consumers with different observable characteristics. For example, an unobserved product characteristic viewed as desirable by one demographic group
could be viewed as undesirable by another.

15

‚Ä¢ to different modes of transport (McFadden et al. (1977)),
‚Ä¢ to different hospitals (Capps et al. (2003)),
‚Ä¢ to different schools (Hastings et al. (2010)), and
‚Ä¢ to different retailers (Burda et al. (2008)).
Other examples of observables that might play the role of zit include
‚Ä¢ exposure to product-specific advertising (Ackerberg (2003)),
‚Ä¢ family size√ócar size (Goldberg (1995), BLP),
‚Ä¢ consumer-newspaper political match (Gentzkow & Shapiro (2010)),
‚Ä¢ household-neighborhood demographic match (Bayer & Timmins (2007)).
As before, Berry & Haile (2010) start from an extremely flexible random
utility model where
(vi1t , . . . , viJt ) ‚àº Fv (¬∑|œáit ) ,
(17)
and now
œáit = (zit , xt , pt , Œæt ) .

(18)

Consumer utility maximization yields choice probabilities
œÉj (œáit ) = œÉj (zit , xt , pt , Œæt )

j = 1, . . . , J.

(19)

Let œÉ (zit , xt , pt , Œæt ) = (œÉ1 (zit , xt , pt , Œæt ) , . . . , œÉJ (zit , xt , pt , Œæt )).
Within a given market, (xt , pt , Œæt ) are fixed, but choice probabilities vary
with the value of zit . Let Zt denote the support of zit in market t. For
each zÃÇ ‚àà Zt we observe the conditional choice probability vector st (zÃÇ) =
(s1t (zÃÇ), . . . , sJt (zÃÇ)), where each
sjt (zÃÇ) = œÉj (zÃÇ, xt , pt , Œæt )
gives the market share of good j among zÃÇ-type consumers, given the true value
of the vector (xt , pt , Œæt ) in market t. Let
St = st (Zt ) .
denote the set of all conditional choice probabilities in market t generated by
some zÃÇ ‚àà Zt . Of course, for every s ‚àà St , there is at least one vector zt‚àó (s) ‚àà Zt
such that
st (zt‚àó (s)) = s.
(20)
The identification arguments in Berry & Haile (2010) rely heavily on the
within-market variation in choice probabilities that results from variation in
16

the consumer characteristics zit . Just as in the case of market-level data, the
primary challenge is uncovering the value of the latent demand shocks Œæjt ;
once the demand shocks are known, identification of demand is trivial. Berry
& Haile (2010) obtain identification using two different approaches (applied to
slightly different models), each proceeding in two steps. First, within-market
variation in zit is used to construct, for each jt combination, a scalar variable
that is a function of prices and the scalar unobservable Œæjt . Second, standard
instrumental variables arguments are applied to obtain identification of this
function and, therefore the value of each structural error Œæjt . Both approaches
lead to results allowing identification of demand with weaker instrumental
variables requirements than those we required without micro data.

4.1
4.1.1

Identification with a Common Choice Probability
Index and Inversion

The first approach utilizes an index restriction very similar to that used in the
case of market-level data. Let
Œªijt = gj (zijt ) + Œæjt ,
where gj is an unknown strictly increasing function. Assume now that zit and
Œæt affect the joint distribution of utilities only through the indices; i.e., letting
Œªit = (Œªi1t , . . . , ŒªiJt ), assume
Fv (¬∑|œáit ) = Fv (¬∑|Œªit , xt , pt , ) .
With this restriction, we can write the components of the demand system (19)
as
œÉj (Œªit , xt , pt ) j = 1. . . . , J.
For the remainder of this section, we condition on xt ‚Äîtreating this in a com(2)
pletely general fashion as we did xt in the previous section‚Äîand drop it from
the notation.
Berry & Haile (2010) require sufficient variation in zit to generate a common
choice probability vector sÃÑ. That is, they require that there be some choice
probability vector sÃÑ such that
sÃÑ ‚àà St

‚àÄt.

(21)

Because choice probabilities conditional on zit are observable, this assumption
is directly verifiable from data. Further, full support for zit is not required
unless the support of the unobservable Œæt is itself RJ . In many industries,
unobserved tastes vary across markets but not to an extreme degree, so the
variation in zit required need not be extreme. In particular, zit need only
17

move the choice probabilities to the common vector sÃÑ in every market; no
probability needs to be driven to zero or to one, in contrast to the requirements
of ‚Äúidentification at infinity‚Äù arguments. Indeed, such arguments typically
use assumptions implying that every sÃÑ in the J-simplex is a common choice
probability (i.e., all such sÃÑ satisfy (21)).
A key insight underlying Berry & Haile‚Äôs first approach is that variation
in the value of zt‚àó (sÃÑ) (recall (20)) across markets can be linked precisely to
variation in the vector of demand shocks Œæt . Assuming that the demand system
satisfies connected substitutes (now with respect to the indices Œªijt instead of
Œ¥jt ), the demand system can be inverted: for any choice probability vector s
and any price vector pt there is at most one vector of indices Œªit such that
œÉj (Œªit , pt ) = sj for all j. Of particular interest is the inverse at the common
choice probability sÃÑ. Since sÃÑ ‚àà St for every market t, the invertibility result of
Berry et al. (2013) ensures that for each market there is a unique zt‚àó (sÃÑ) ‚àà Zt
such that st (zt‚àó (sÃÑ)) = sÃÑ. Thus, we may write

‚àó
gj zjt
(sÃÑ) + Œæjt = œÉj‚àí1 (sÃÑ, pt ).
(22)
4.1.2

Instruments

Berry & Haile (2010) provide conditions ensuring that each function gj is
identified. For simplicity we take this as given for the remainder of this section.
This is equivalent to focusing on the case of a linear index structure
Œªijt = zijt Œ≤j + Œæjt ,
where each Œ≤j can be normalized to one without loss (setting the scale of the
unobservable Œæjt ). This allows us to rewrite (22) as
‚àó
zjt
(sÃÑ) = œÉj‚àí1 (sÃÑ, pt ) ‚àí Œæjt .

(23)

This equation takes exactly the form of the Newey-Powell nonparametric re‚àó
gression model (14), with zjt
(sÃÑ) playing the role of the dependent variable,
‚àí1
œÉj (sÃÑ, pt ) the unknown regression function, and Œæjt the error term that is
correlated with the endogenous vector pt . Using this insight and now exploiting cross-market variation, identification of each function œÉj‚àí1 (¬∑) (and therefore
each structural error Œæjt ) follows immediately from the result of Newey & Powell (2003) discussed above, given excluded instruments wt for pt that satisfy
the standard completeness condition. With each Œæjt known, identification of
demand is immediate.
Here, as in the case of market-level data, we require instruments for pt .
However, we no longer need instruments for st , which is held fixed at sÃÑ in
(23). To suggest why, remember that in the case of market-level data we
relied on instruments that provided variation in quantities (shares) even when
18

the structural errors Œæt and prices pt were held fixed. We avoid this need by
exploiting within-market variation in zit . Within a market, Œæt and pt are held
fixed by construction while variation in zit provides variation in quantities.
Thus, only instruments for pt are needed when we move to arguments that
rely on cross-market variation.
Cost shifters and proxies are, as usual, important candidate instruments
for pt . In addition, in this micro data context, one could also use features of
the market-level distribution of zt as instruments for price. For example, if a
market as a whole features unusually many high-income consumers, prices in
this market may be unusually high. This type of instrument is a variant of
the ‚Äúcharacteristics of nearby markets‚Äù discussed in the case of market data,
although here ‚Äúnearby consumers‚Äù can replace ‚Äúnearby markets.‚Äù Berry &
Haile (2010) call these ‚ÄúWaldfogel‚Äù instruments, after the insight in Waldfogel
(2003) that choice sets (including prices) naturally vary with the local distribution of consumer types. To see why such instruments may be excludable,
recall that with micro data the observed choice probabilities already condition
on the consumer‚Äôs own zit . So the exclusion restriction is a requirement that
there be no demand spillovers (or sorting affects) that would require putting
‚Äúattributes of other consumers in the market‚Äù in the micro-level demand system.
Note that the BLP instruments are not available as instruments here: we
have conditioned on the entire xt . Indeed, we have not imposed any condition
requiring that ‚Äúrival characteristics‚Äù x‚àíjt be excluded from the shifters of
vijt . Such a restriction can restore the availability of the BLP instruments,
and other functional form restrictions can reduce the number of instruments
required even further.
To illustrate this, first suppose that we add pt to the index Œªjt (z), so that
Œªijt (z) = zijt ‚àí Œ±pjt + Œæjt .

(24)

In this case, equation (23) becomes
‚àó
zjt
(sÃÑ) = œÉj‚àí1 (sÃÑ, ) + Œ±pjt ‚àí Œæjt .

(25)

The first term œÉj‚àí1 (sÃÑ, ) on the right is a constant; thus, we have a regression
model with just one endogenous variable. Alternatively, we could put xt (or
(1)
(2)
some subset of (xt , xt )) into the index:
Œªijt (z) = zijt + xjt Œ≤ + Œæjt .
This which would make the ‚Äúcharacteristics of other products‚Äù (the BLP instruments) available as instruments for price, at the cost of imposing restrictions on the way that at least some of the xt ‚Äôs shift the distribution of utilities.
19

4.2

Utility Linear in z with Large Support

Berry & Haile (2010) consider a second approach using a slightly different specification in which (zi1t , . . . , ziJt ) serve as a ‚Äúspecial regressors‚Äù (e.g., Lewbel
(1998, 2000)). This approach requires that (zi1t , . . . , ziJt ) have large support
(sufficient support to move choice probabilities to all points on the simplex).
This is a strong assumption, but special regressors with large support have
been used at least since Manski (1975, 1985) as a useful way to explore how
far exogenous variation in covariates can go toward eliminating the need for
distributional assumptions in discrete choice models. Berry & Haile (2010)
take the same approach in order to explore how far variation in the demand
shifters zit can go in reducing the need for excluded instruments.
In the simplest version of this second approach,10 Berry & Haile (2010)
assume that utilities take the form
vijt = Œªijt + ¬µijt

j = 1, . . . , J.

(26)

Here
Œªijt = zijt + Œæjt

(27)

as before, and the random variables (¬µi1t , . . . , ¬µi1t ) have a joint distribution
that does not depend on Œªt :11
F¬µ (¬∑|œát ) = F¬µ (¬∑|xt , pt ) .

(28)

In addition, Berry & Haile (2010) impose the standard condition that the
utility from good j is unaffected by the observed characteristics of other goods.
With (28) this implies
P r(¬µijt < c |xt , pt , Œæt ) = P r(¬µijt < c |xjt , pjt )

(29)

This specification is a nonparametric generalization of standard random coefficients models, where the utility from a good is a random function of its
characteristics and price.12
Under the large support assumption
supp zit | (xt , pt , Œæt ) = RJ ,

(30)

10

As above, this version can be generalized to allow each zijt to enter through an unknown
monotonic function gj (¬∑). Below we discuss another variation that treats Œæt more flexibly.
11

If F¬µ depended freely on Œªt , what appears to be an additive separability restriction in
(26) would actually have no content: the distribution of vit could still change freely with Œªt .
12

For example, one obtains this structure by assuming that vijt = zijt + v(xjt , pjt , Œæjt , Œ∏it )
for all j where Œ∏j is an infinite-dimensional random parameter whose distribution does not
depend on œáit .

20

identification can be shown in two simple steps. First, by standard arguments, within-market variation in zit traces out the joint distribution of (¬µi1t +
Œæ1t , . . . , ¬µiJt + ŒæJt ) separately for each market. This joint distribution also reveals, for each j, the marginal distribution of ¬µijt + Œæjt in each market t. The
second step then treats a functional of this distribution as the dependent variable in a nonparametric IV regression model. For example, by (29), for a given
j the mean (or any quantile) of this marginal distribution takes the form
Œ¥jt = hj (xjt , pjt ) + Œæjt

(31)

where hj is an unknown function. Once again, we can condition on xjt without
loss, yielding an equation taking the form of the regression model studied by
Newey & Powell (2003). Since the ‚Äúdependent variable‚Äù Œ¥jt can be treated as
observed (by the first step), identification of the function hj (and, then, the
residuals Œæjt ) requires instruments satisfying a standard completeness condition. Because there is now only one price entering hj , identification can be
obtained with only a single instrument. Further, in this case all the instrument types discussed above are candidates; in particular, the BLP instruments
x‚àíjt were not fixed in the derivation of (31), so they are available as instruments. In addition, since (31) requires only one instrument at a time, a single
market-level instrument (e.g., a single ‚ÄúWaldfogel instrument‚Äù) could potentially suffice.
The model above can be generalized by dropping the requirement that
utilities be separable in the demand shocks Œæjt . Consider the specification
vijt = zijt Œ≤ + ¬µÃÉijt
with the joint distribution of ¬µÃÉit now permitted to depend on Œæt :
F¬µ (¬∑|œát ) = F¬µ (¬∑|xt , pt , Œæt )
Under an appropriate monotonicity condition‚Äîfor example, let ¬µijt be stochastically increasing in Œækt when j = k but independent of Œækt otherwise‚Äîrepeating
the analysis above yields an equation taking the form of a nonparametric IV
regression with a nonseparable error. For example, Berry & Haile (2010) shows
that under appropriate assumptions the mean of the marginal distribution of
¬µÃÉijt would take the form
Œ¥jt = hj (xjt , pjt , Œæjt )
(32)
where hj is strictly increasing Œæjt . Chernozhukov & Hansen (2005) have consider identification of such a nonseparable nonparametric regression model
under modified ‚Äúcompleteness‚Äù conditions that (at least in the case of a continuous endogenous dependent variable) are somewhat harder to interpret than
the standard completeness condition of Newey & Powell (2003) that suffices for
(31). However, whether we use the model with separable Œæjt leading to (31) or
21

the more general model leading to (32), this second class of (‚Äúseparable in z‚Äù)
models studied in Berry & Haile (2010) has the advantage of minimizing the
number of instruments required while maximizing the availability of candidate
instruments.

5

Supply

Many positive and normative questions regarding differentiated products markets require a quantitative understanding of ‚Äúsupply‚Äù as well as demand.
In a static oligopoly context, the primitives of a supply model are marginal
cost functions and a specification of oligopoly competition. Because reliable
marginal cost data are seldom available, there is a long tradition in the empirical industrial organization literature of estimating marginal costs using firm
first-order conditions.
A very early example is Rosse (1970), which considered a model of monopoly
newspaper publishers, and the key insight of this literature is particularly
transparent in the case of monopoly. Marginal revenue is a function of observed
quantity, observed price, and the slope of demand. If the slope of demand is
already known, marginal cost is revealed directly as equal to marginal revenue. Rosse (1970) considered joint estimation of demand and marginal cost
parameters from a combination of demand equations and monopoly first-order
conditions. Elements of this approach are carried over to oligopoly models in
the ‚ÄúNew Empirical Industrial Organization‚Äù literature (see, e.g., Bresnahan
(1981, 1989)). That literature also asks whether the hypothesis of a particular
form of oligopoly competition is falsifiable. The widely used approach of BLP
involves combining estimates of demand parameters with first-order conditions
characterizing equilibrium in a given oligopoly model (typically multi-product
oligopoly price setting) to solve for marginal costs and parameters of marginal
cost functions.
Below we discuss nonparametric identification results that build on these
earlier insights.13 We discuss identification of marginal costs, identification
of marginal cost functions, and discrimination between particular models of
oligopoly competition. For the remainder of this section we do this treating
demand as known, reflecting the results above on identification of demand.
However, in the following section we discuss results obtained by treating demand and supply explicitly as a fully simultaneous system.
13

There are important questions about identification when firms make discrete supply
decisions‚Äîe.g., entry or introduction of new products‚Äîas well as identification of dynamic
oligopoly models. These are beyond the scope of this review.

22

5.1

Identification of Marginal Costs with a Known Oligopoly
Model

When the model of oligopoly competition is known, identification of equilibrium marginal costs follows almost immediately from identification of demand.
Let mcjt denote the equilibrium marginal cost of good j in market t.14 Given
the connected substitutes condition on demand (now with respect to prices),
Berry & Haile (2014) point out that for a wide variety of static oligopoly
models there exists a known function œàj such that in equilibrium
mcjt = œàj (st , Mt , Dt (st , pt ), pt ) ,

(33)

k
. Here Mt is the scalar
where Dt (st , pt ) is the matrix of partial derivatives ‚àÇœÉ
‚àÇp`
number of potential consumers in market t (‚Äúmarket size‚Äù), so that the level
of demand is qjt = Mt sjt .
If the function œàj is known, then mcjt is directly identified from (33) once
the demand derivatives Dt are identified. Since most standard oligopoly models imply a known functional form for œàj , identification of the level of marginal
cost then follows directly from the identification of demand.
In the simple case of monopoly, œàj is just the standard marginal revenue
function. More generally, the function œàj can be interpreted as a ‚Äúgeneralized
product-specific marginal revenue‚Äù function. For example, in the case of singleproduct firms setting prices in a static Nash equilibrium, firm j‚Äôs first-order
condition can be written
1
Mt sjt .
(34)
mcjt = pjt +
‚àÇsjt /‚àÇpjt

The right hand side of (34) is the marginal revenue that stems from a price
decrease sufficient to increase quantity by one unit, holding constant the prices
of other products. With multi-product firms and simultaneous price setting
(as in BLP), each function œàj is obtained by solving a simultaneous system of
first-order conditions. The vector of marginal costs for all goods in market t
is given by
mct = pt + ‚àÜ‚àí1
(35)
t st ,
where ‚àÜt is a matrix with (j, k)-entry equal to ‚àÇskt /‚àÇpjt when goods j and k
are produced by the same firm, and zero otherwise.

5.2

Identification of Marginal Cost Functions

Equation (33) yields the immediate identification of the level of market costs
mcjt whenever the right-hand side of the equation is known. However, un14

In general this is the marginal cost of good j in market t conditional on the observed
values of all relevant quantities.

23

less marginal costs are constant, many counterfactuals of interest will require
knowing how costs vary with output.
Typically one might specify a marginal cost function of the form
mcjt = cj (qjt , wjt ) + œâjt

(36)

where wjt and œâjt are observed and unobserved cost shifters, respectively. With
the values of mcjt known, equation (36) takes the form of a standard separable
nonparametric regression, as in Newey & Powell (2003). Identification of the
unknown function cj requires an instrument for the endogenous variables in
(36). A natural assumption is that the cost shifters of all the firms are mean
independent of each œâjt . In that case, a single excluded instrument‚Äîfor the
endogenous quantity qjt ‚Äîcan suffice.
Natural instruments for qjt include the exogenous cost shifters w‚àíjt of other
goods. Other potential instruments are also likely to be available as well. Demand shifters of own and rival products or firms are all possible instruments,
if they are properly excluded from own-product marginal costs. Market-level
factors that influence the level of demand (like total population and the population of various demographic groups) are other possible instruments.
Note that, given identification of demand, the problem of finding an appropriate number of instruments is much easier on the cost side than on the
demand side. In the simplest case, there is only one endogenous variable in
the marginal cost function but possibly many available cost and demand instruments. This availability of instruments means that richer specifications of
the marginal cost functions may be accommodated. For example, in some applications one may wish to allow production spillovers across goods produced
by the same firm. This could introduce the entire vector Qj of a firm‚Äôs own
quantities (all endogenous) as arguments of the marginal cost function cj . But
in many cases there will be excluded instruments available of dimension even
larger than that of Qj .

5.3

Identifying Cost Shocks with an Unknown Oligopoly
Model

Berry & Haile (2014) show that one need not specify the oligopoly model in
order to identify the latent shocks to marginal costs, œâjt . This can be directly
useful because it allows identification of a reduced form for equilibrium prices
that can be used to answer some kinds of counterfactual questions without
specifying the form of oligopoly competition. Identification of the latent cost
shocks also leads to the most straightforward and powerful of their results on
discrimination between alternative oligopoly models, a topic we take up in the
following section.
Here we continue to assume that equation (34) holds but allow the form
of the function œàj to be unknown. Thus, we relax the assumption of a known
24

oligopoly model and require only that some relation of the form (34) exist. To
allow this relaxation, we will require an index structure on the marginal cost
15
function similar to 
one exploited
 previously on the demand side. Partition
(1)
(1)
(2)
the cost shifters as wjt , wjt , with wjt ‚àà R, and define the cost indices
(1)

Œ∫jt = wjt Œ≥j + œâjt

j = 1, . . . , J

(37)

where each parameter Œ≥j may be normalized to one without loss. Suppose
(1)
now that the cost shifter wjt and the cost shock œâjt enter marginal costs only
through the index. In particular, assume that each marginal cost function
cj (qjt , wjt , œâjt ) can be rewritten as


(2)
cj qjt , Œ∫jt , wjt
where cj is strictly increasing in Œ∫jt .
(1)
(2)
Now fix wjt for all jt, drop it from the notation, and let wjt represent wjt .
Berry & Haile (2014) show that the supply side first-order conditions can be
inverted to obtain relations of the form
Œ∫jt = œÄj‚àí1 (st , pt ) ,

(38)

where each œÄj‚àí1 is an unknown function.16 Rewriting this as
wjt = œÄj‚àí1 (st , pt ) ‚àí œâjt

(39)

we obtain an equation taking exactly the form of the inverted demand equations (13) above. Identification (of the functions œÄj‚àí1 and, therefore, each œâjt )
can thus be obtained using the same extension of Newey & Powell (2003) relied
on in section 3.3, now with (xt , wt ) as the instruments.
(2)
(2)
Because here we have fixed not only xt but also wt , the instrumental
variables requirement is more demanding than that for the parallel result on
(1)
identification of demand. In particular, the demand shifters xt (i.e., xt ) must
now be excluded from marginal costs. In some applications product characteristics will vary without affecting firm costs due to technological constraints
(e.g., satellite television reception in Goolsbee & Petrin (2004)) or other exogenous market-specific factors (climate, topography, transportation network).
15

This structure is also used below when we discuss identification of demand and supply
within a single simultaneous system.
16

This function is the composition of the inverse (with respect to Œ∫jt ) of the marginal cost
function and the ‚Äúgeneralized product-specific marginal revenue‚Äù function œàj appearing in
the first-order condition for good j. We use the notation œÄ ‚àí1 as a reminder that this relation
is obtained by inverting the equilibrium map to express the cost index Œ∫jt in terms of the
market outcomes (st , pt ).

25

In other cases, product characteristics that shift demand may alter fixed costs
rather than marginal costs‚Äî-for example, quality produced through research
and development, a product‚Äôs geographic location, or product-specific advertising (e.g., Goeree (2008)). Other examples of instruments that can play the role
of xt here involve interactions between market and product characteristics. For
example, BLP point out that conditional on the product characteristic ‚Äúmiles
per gallon‚Äù (which might affect marginal cost) , ‚Äúmiles per dollar‚Äù is a demand
shifter that is properly excluded from the marginal cost function.
Note that given identification of the inverted demand functions œÉj‚àí1 and
the functions œÄj‚àí1 , total differentiation of the system
xjt + Œæjt = œÉj‚àí1 (st , pt )

‚àÄj,

wjt + œâjt = œÄj‚àí1 (st , pt )

‚àÄj

(40)

will reveal the response of quantities and prices to the exogenous shifters
(xt , wt ). This is true even when the interpretation of œÄj‚àí1 is not yet established via appeal to some particular oligopoly model. In section 6 we will return to this system of simultaneous equations to consider a different approach
to identification.

5.4

Discrimination Between Models of Firm ‚ÄúConduct‚Äù

An important early literature in industrial organization explored discrimination between alternative models of firm ‚Äúconduct‚Äù (see, e.g., Bresnahan (1989)
and references therein). This literature was developed on the important insight
in Bresnahan (1982) that ‚Äúrotations of demand‚Äù (changes in market conditions
that alter the slope of demand but leave the equilibrium quantity unchanged)
can alter equilibrium markups differently in different models of supply. Thus,
the price response to such rotations might be used to infer the true model. A
formalization of this intuition was developed in Lau (1982), although the result
was limited to ‚Äúconjectural variations‚Äù models with nonstochastic demand and
cost, homogeneous goods, and symmetric firms. Berry & Haile (2014) showed
that none of these limitations is essential, and that Bresnahan‚Äôs intuition can
be generalized to provide an approach for discriminating between alternative
models in a much less restrictive setting. Moreover, in the differentiated products context, there are many different types of variation that can be exploited,
not just the rotations of market demand considered by Bresnahan (1982) and
Lau (1982).
The simplest results of this type in Berry & Haile (2014) take advantage
of the results in the previous section. Suppose that we have already identified
each cost index Œ∫jt as well as the demand derivatives in each market. Consider
again the first-order condition
cj (qjt , Œ∫jt ) = œàj (st , Mt , Dt (st , pt ) , pt )
26

(41)

For a the function œàj implied by a hypothesized model of oligopoly competition. An implication of this hypothesis is that all observations (jt combinations) with the same values of qjt and Œ∫jt must have the same value for
the right-hand side of equation (41) as well. If we misspecify the model, this
restriction will often fail: different values of marginal cost will be required to
rationalize the data, even though all shifters of marginal costs have be held
fixed. Such a finding will falsify a misspecified oligopoly model.
As the simplest example, suppose that there is a single producer setting
prices and quantities as a profit-maximizing monopolist. If we mistakenly
hypothesize that the firm prices at marginal cost, this would imply the model
cj (qjt , Œ∫jt ) = pjt

(42)

(i.e., œàj (st , Mt , Dt (st , pt ) , pt ) = pjt ). This hypothesis would be falsified if
(for example) there are two markets with the same (qjt , Œ∫jt , pjt ) but different
demand derivatives‚Äîi.e., if there is a rotation in demand. However, rotations of demand just one example of the kind of variation that can reveal
misspecification of the oligopoly model. In general a model can be falsified
whenever there is variation between two markets t and t0 or products j and
j 0 that (i) leaves the relation between quantities and marginal cost unchanged
(i.e., cj (¬∑, Œ∫jt ) = cj 0 (¬∑, Œ∫j 0 t0 ) , (ii) yields qjt = qj 0 t0 , but (iii) would imply a
change in at least one of these equilibrium quantities under the false model.
Even if preferences and market size do not change (demand is fixed), one can
obtain a contradiction under a misspecified model from variation in the number of competing firms, the set of competing goods, observed or unobserved
characteristics of competing products, or observed/unobserved cost shifters of
competitors. Berry & Haile (2014) provide several examples. They also show
how the insights described here can be generalized to apply without requiring
identification of the marginal cost shocks and, therefore, without the cost-side
index structure relied on in section 5.3.

6

Identification in a Simultaneous System

Although the main challenge to identification in differentiated products markets is the simultaneous determination of prices and quantities, our approach
in the identification results presented above was sequential. We began by
demonstrating identification of demand without specifying a model of supply;
then, given knowledge of demand, we showed how the primitives of supply
could be identified. An alternative is to directly consider identification of the
fully simultaneous model of differentiated products demand and supply.
Berry & Haile (2014) explore such an approach, using the same kind of
index structure (on both the demand and cost sides) relied on in section 5.3
above. In particular, they consider identification of the system of 2J equations
27

in (40). These equations exhibit what Berry & Haile (2015) call a ‚Äúresidual
index structure,‚Äù as each structural error enters the model through an index
that also depends on an equation-specific observable. This class of models was
introduced by Matzkin (2008) and is also studied by Matzkin (2015) and in
Berry & Haile (2014, 2011).
The results in this literature show a tradeoff between [i] support conditions
on the instruments (here xt , wt )) and [ii] shape restrictions on the joint density
of the unobservables (here (xit , œât )). At one extreme, Berry & Haile (2014,
2015) show identification of the system of equations (40) under an assumption
that the instruments have large support, but with no restriction on the density
of unobservables. At the other extreme, Berry & Haile (2015) shows that even
with arbitrarily small support for the instruments, failure of identification
occurs only under strong restrictions on the joint density of unobservables.
These results can be extended, appealing to results from Matzkin (2008) or
Berry & Haile (2015), to models of the form
gj (xjt ) + Œæjt = œÉj‚àí1 (st , pt )
hj (wjt ) + œâjt =

œÄj‚àí1

(st , pt )

‚àÄj
‚àÄjv

where the functions gj and hj are unknown strictly increasing functions.
The simultaneous equations approach contrasts with the approaches in the
previous sections that rely on completeness conditions to establish identification. A disadvantage of identification results relying on completeness conditions is a lack of transparency about the kinds of assumptions on economic
primitives that will generate completeness. A related point is that identification proofs relying on completeness conditions provide little insight about how
the observables uniquely determine the primitives; formally, identification is
proved by contradiction. In contrast, the results from the simultaneous equations literature rely on explicit conditions on the primitives of the supply and
demand model and permit constructive identification proofs.

7

Conclusion

We have reviewed recent nonparametric identification results for models of
discrete choice demand and oligopoly supply that are widely used in empirical
economics. Our results show that identification of these models relies primarily on the presence of sufficient exogenous sources of variation in prices and
quantities‚Äîi.e., on the standard requirement of adequate instruments. With
market-level data, these results require instruments for all prices and quantities: exogenous shifters of costs or markups as well as the ‚ÄúBLP instruments‚Äù
that, besides altering markups, shift market shares conditional on prices. Consumer level ‚Äúmicro data‚Äù can eliminate the need for market share instruments,
28

and some special cases require only a single exogenous price shifter to identify demand. Given identification of demand, identification of marginal costs
requires no additional instruments, and identification of firms‚Äô marginal cost
functions can be attained with as few as one excluded instrument that shifts
equilibrium quantities across markets. We also show that the standard practice of specifying a form of competition on the supply side generally leads to
falsifiable restrictions that can be used to discriminate between alternative
models of firm conduct. Finally, a simultaneous equations approach to supply and demand allows for constructive proofs of identification under various
combinations of support and density conditions.
We believe these nonparametric identification results are of use to applied
researchers regardless of whether they use nonparametric estimation techniques. Economists have long recognized the distinction between identifiability
of (‚Äúwithin‚Äù) a model and properties of any particular estimator (e.g., Koopmans (1945, 1950), Hurwicz (1950), Koopmans & Reiersol (1950)). Because
economic theory typically delivers few implications regarding functional forms
or distributions of unobservables, it seems unambiguously good that identification hold without such assumptions (see, e.g., Matzkin (2013)). On the
other hand, because every data set is finite, going beyond mere description of
the data requires reliance on approximation techniques. Indeed, in practice
the difference between parametric and nonparametric estimators is frequently
not a matter of whether one estimates a finite set of parameters but of how
one constructs standard errors (see, e.g., Horowitz (2011, 2014)). Even when
estimation relies on parsimonious parametric specifications, a nonparametric
identification result limits the essential role of functional form and distributional assumptions to the unavoidable jobs of approximation, extrapolation,
and compensation for the gap between the exogenous variation available in
practice and the idealized variation that would allow one to definitively distinguish between all nonparametric structures permitted by the model.
The primary message of the results reviewed here is that identification holds
under precisely the kinds of instrumental variables conditions required for
more familiar (e.g., regression) models. Thus, as usual, the key identification
question in applied work concerns the availability of suitable instruments. The
differentiated products setting points to a variety of potential instruments, and
our results clarify the types of instruments that suffice in different settings.
They also reveal some tradeoffs between instrumental variables requirements,
the flexibility of the underlying model, and the kind of consumer-level data
relied upon.

29

References
Ackerberg D. 2003. Advertising learning and customer choice in experience
good markets: A structural empirical examination. International Economic
Review 44:1007‚Äì1040
Allenby GM, Rossi PE. 1999. Marketing models of consumer heterogeneity.
Journal of Econometrics 89:57‚Äì78
Altonji J, Matzkin RL. 2005. Cross-section and panel data estimators for nonseparable models with endogenous regressors. Econometrica 73:1053‚Äì1102
Andrews DWK. 2011. Examples of l2 -complete and boundedly complete distributions. Discussion Paper 1801, Cowles Foundation, Yale University
Armstrong TB. 2015. Large market asymptotics for differentiated product demand estimators with economic models of supply. Tech. rep., Yale University
Athey S, Imbens GW. 2007. Discrete choice models with multiple unobserved
choice characteristics. International Economic Review 48:1159‚Äì1192
Bayer P, Ferreira F, McMillan R. 2007. A unified framework for measuring
preferences for schools and neighborhoods. Journal of Political Economy
115:588‚Äì638
Bayer P, Timmins C. 2007. Estimating equilibrium models of sorting across
locations. The Economic Journal 117:353‚Äì374
Berry S. 1994. Estimating discrete choice models of product differentiation.
RAND Journal of Economics 23:242‚Äì262
Berry S, Levinsohn J, Pakes A. 1995. Automobile prices in market equilibrium.
Econometrica 60:889‚Äì917
Berry S, Levinsohn J, Pakes A. 1999. Voluntary export restraints on automobiles: Evaluating a strategic trade policy. American Economic Review
89:189‚Äì211
Berry ST, Gandhi A, Haile PA. 2013. Connected substitutes and invertibility
of demand. Econometrica 81:2087‚Äì2111
Berry ST, Haile PA. 2010. Nonparametric identification of multinomial choice
demand models with heterogeneous consumers. Discussion Paper 1718,
Cowles Foundation, Yale University
Berry ST, Haile PA. 2011. Identification in a class of nonparametric simultaneous equations models. Discussion Paper 1787R, Cowles Foundation at
Yale
30

Berry ST, Haile PA. 2014. Identification in differentiated products markets
using market level data. Econometrica 82:1749‚Äì1797
Berry ST, Haile PA. 2015. Nonparametric identification of simultaneous equations models with a residual index structure. Tech. rep., Yale University
Blundell R, Matzkin RL. 2014. Control functions in nonseparable simultaneous
equations models. Quantitative Economics 5:271‚Äì295
Blundell RW, Powell JL. 2004. Endogeneity in semiparametric binary response
models. Review of Economic Studies 71:655‚Äì679
Bresnahan T. 1981. Departures from marginal cost pricing in the american
automobile industry. Journal of Econometrics 17:201‚Äì227
Bresnahan T. 1982. The oligopoly solution concept is identified. Economics
Letters 10:82‚Äì97
Bresnahan T. 1987. Competition and collusion in the american automobile
oligopoly: The 1955 price war. Journal of Industrial Economics 35:457‚Äì482
Bresnahan T. 1989. Empirical studies of industries with market power, In The
Handbook of Industrial Organization, eds. R Schamlensee, R Willig, no. 10
in Handbooks in Economics. North-Holland
Briesch RA, Chintagunta PK, Matzkin RL. 2010. Nonparametric discrete
choice models with unobserved heterogeneity. Journal of Business and Economic Statistics 28:291‚Äì307
Bundorf K, Levin J, Mahoney N. 2012. Pricing and welfare in health plan
choice. American Economic Review 102:3214‚Äì3248
Burda M, Harding M, Hausman J. 2008. A bayesian mixed logit-probit model
for multinomial choice. Tech. rep., M.I.T.
Capps C, Dranove D, Satterthwaite M. 2003. Competition and market power
in option demand markets. RAND Journal of Economics 34:737‚Äì763
Cardon J, Hendel I. 2001. Asymmetric information in health care and health
insurance markets‚Äù evidence from the national medical expenditure survery.
RAND Journal of Economics 32:408‚Äì427
Chernozhukov V, Hansen C. 2005. An iv model of quantile treatment effects.
Econometrica 73:245‚Äì261
Chintagunta PK, HonoreÃÅ BE. 1996. Investigating the effects of marketing variables and unobserved heterogeneity in a multinomial probit model. International Journal of Marketing Research 13:1‚Äì15
31

Eizenberg A. 2011. Upstream innovation and product variety in the united
states home pc market. Tech. rep., Hebrew University
Fan Y. 2013. Ownership consolidation and product characteristics: A study of
the u.s. daily newspaper market. American Economic Review 103:1598‚Äì1628
Fox J, Gandhi A. 2011. Identifying demand with multi-dimensional unobservables: A random functions approach. Tech. rep., University of Wisconsin
Gale D, Nikaido H. 1965. The jacobian matrix and global univalence of mappings. Mathematische Annalen 159:81‚Äì93
Gentzkow M, Shapiro J. 2010. What drives media slant? evidence from u.s.
newspapers. Econometrica 78:35‚Äì71
Goeree MS. 2008. Limited information and advertising in the us personal computer industry. Econometrica 76:1017‚Äì1074
Goldberg P. 1998. The effects of the corporate average fuel economy standards
in the automobile industry. Journal of Industrial Economics 46:1‚Äì33
Goldberg P, Verboven F. 2001. The evolution of price dispersion in the european car market. The Review of Economics Studies 68:811‚Äì848
Goldberg PK. 1995. Product differentiation and oligopoly in international markets: The case of the u.s. automobile industry. Econometrica 63:891‚Äì951
Goolsbee A, Petrin A. 2004. The consumer gains from direct broadcast satellites and the competition with cable tv. Econometrica 72:351‚Äì381
Gordon B, Hartmann WR. 2013. Advertising effects in presidential elections.
Marketing Science 32:19‚Äì35
Hastings J, Kane T, Staiger D. 2010. Heterogeneous preferences and the efficacy of public school choice. Tech. rep., Brown University
Hausman JA. 1996. Valuation of new goods under perfect and imperfect competitioin. In The Economics of New Goods, eds. TF Bresnahan, RJ Gordon,
chap. 5. Chicago: University of Chicago Press, 209‚Äì248
Ho K. 2009. Insurer-provider networks in the medical care market. American
Economic Review 99:393‚Äì430
Hoderlein S. 2009. Endogenous semiparametric binary choice models with heteroskedasticity. Working Paper 747, Boston College
Hong H, Tamer E. 2003. Endogenous binary choice model with median restrictions. Economics Letters 80:219‚Äì225
32

HonoreÃÅ BE, Lewbel A. 2002. Semiparametric binary choice panel data models
without strictly exogenous regressors. Econometrica 70:2053‚Äì2063
Horowitz JL. 2011. Applied nonparametric instrumental variables estimation.
Econometrica 79:347‚Äì394
Horowitz JL. 2014. Ill-posed inverse problems in economics. Annual Review of
Ecnomics 6:21‚Äì51
Hurwicz L. 1950. Generalization of the concept of identification. In Statistical
Inference in Dynamic Economic Models, Cowles Commission Monograph
10, ed. TC Koopmans. New York: John Wiley and Sons, 245‚Äì257
Ichimura H, Thompson TS. 1998. Maximum likelihood estimation of a binary
choice model with random coefficients of unknown distribution. Journal of
Econometrics 86:269‚Äì95
Koopmans TC. 1945. Statistical estimation of simultaneous economic relations. Journal of the American Statistical Association 40:448‚Äì466
Koopmans TC, ed. 1950. Statistical inference in dynamic economic models,
cowles commission monograph 10. New York: John Wiley and Sons
Koopmans TC, Reiersol O. 1950. The identification of structural characteristics. The Annals of Mathematical Statistics 21:165‚Äì181
Lau L. 1982. On identifying the degree of competitiveness from industry price
and output data. Economics Letters 10:93‚Äì99
Lehmann EL, Scheffe H. 1950. Completeness, similar regions, and unbiased
estimation. Sankhya 10:305‚Äì340
Lehmann EL, Scheffe H. 1955. Completeness, similar regions, and unbiased
estimation. Sankhya 15:219‚Äì236
Lewbel A. 1998. Semiparametric latent variable model estimation with endogenous or mismeasured regressors. Econometrica 66:105‚Äì121
Lewbel A. 2000. Semiparametric qualitative response model estimation with
unknown heteroscedasticity or instrumental variables. Journal of Econometrics 97:145‚Äì177
Lewbel A. 2006. Simple endogenous binary choice and selection panel model
estimators. Working Paper 613, Boston College
Lustig J. 2010. The welfare effects of adverse selection in privatized medicare.
Tech. rep., Boston University
33

Magnac T, Maurin E. 2007. Identification and information in monotone binary
models. Journal of Econometrics 139:76‚Äì104
Manski CF. 1975. Maximum score estimation of the stochastic utility model
of choice. Journal of Econometrics 3:205‚Äì228
Manski CF. 1985. Semiparametric analysis of discrete response: Asymptotic properties of the maximum score estimator. Journal of Econometrics
27:313‚Äì333
Manski CF. 1987. Semiparametric analysis of random effects linear models
from binary panel data. Econometrica 55:357‚Äì362
Manski CF. 1988. Identification of binary response models. Journal of the
American Statitical Association 83:729‚Äì738
Matzkin RL. 1992. Nonparametric and distribution-free estimation of the binary choice and threshold crossing models. Econometrica 60:239‚Äì270
Matzkin RL. 1993. Nonparametric identification and estimation of polychotomous choice models. Journal of Econometrics 58:137‚Äì168
Matzkin RL. 2008. Identification in nonparametric simultaneous equations.
Econometrica 76:945‚Äì978
Matzkin RL. 2013. Nonparametric identification in structural economic models. Annual Review of Economics 5:457‚Äì486
Matzkin RL. 2015. Estimation of nonparametric models with simultaneity.
Econometrica 83:1‚Äì66
McFadden D. 1974. Conditional logit analysis of qualitative choice behavior.
In Frontiers of Econometrics, ed. P Zarembka. New York: Academic Press
McFadden D. 1981. Econometric models of probabilistic choice. In Structural
Analysis of Discrete Data with Econometric Applications, eds. C Manski,
D McFadden. Cambridge, MA: MIT Press
McFadden D, Talvitie A, Associates. 1977. Demand model estimation and
validation. Berkeley CA: Institute of Transportation Studies
Nair H, Chintagunta P, Dube JP. 2004. Empirical analysis of indirect network
effects in the market for personal digital assistants. Quantitative Marketing
and Economics 2:23‚Äì58
Neilson C. 2013. Targeted vouchers, competition among schools, and the academic achievement of poor students. Tech. rep., Yale University
34

Nevo A. 2000. Mergers with differentiated products: The case of the ready-toeat cereal industry. RAND Journal ofEconomics 31:395‚Äì421
Nevo A. 2001. Measuring market power in the ready-to-eat cereal industry.
Econometrica 69:307‚Äì42
Newey WK, Powell JL. 2003. Instrumental variable estimation in nonparametric models. Econometrica 71:1565‚Äì1578
Palais RS. 1959. Natural operations on differential forms. Transactions of the
American Mathematical Society 92:125‚Äì141
Petrin A. 2002. Quantifying the benefits of new products: The case of the
minivan. JPE 110:705‚Äì729
Petrin A, Gandhi A. 2011. Identification and estimation in discrete choice
demand models when endogeneous variables interact with the error. Tech.
rep., University of Minnesota
Reynaert M, Verboven F. 2014. Improving the performance of random coefficients demand models: The role of optimal instruments. Journal of Econometrics 179:83 ‚Äì 98
Rosse JN. 1970. Estimating cost function parameters without using cost function data: An illustrated methodology. Econometrica 38:256‚Äì275
Rysman M. 2004. Competition between networks: A study of the market for
yellow pages. Review of Economic Studies 71:483‚Äì512
Villas-Boas SB. 2007. Vertical relationships between manufacturers and retailers: Inference with limited data. Review of Economic Studies 74:625‚Äì652
Waldfogel J. 2003. Preference externalities: An empirical study of who benefits whom in differentiated-product markets. RAND Journal of Economics
34:557‚Äì68

35

