Econometrica, Vol. 85, No. 3 (May, 2017), 693–734

EARNINGS AND CONSUMPTION DYNAMICS: A NONLINEAR PANEL
DATA FRAMEWORK
BY MANUEL ARELLANO, RICHARD BLUNDELL, AND STÉPHANE BONHOMME1
We develop a new quantile-based panel data framework to study the nature of income persistence and the transmission of income shocks to consumption. Log-earnings
are the sum of a general Markovian persistent component and a transitory innovation. The persistence of past shocks to earnings is allowed to vary according to the
size and sign of the current shock. Consumption is modeled as an age-dependent nonlinear function of assets, unobservable tastes, and the two earnings components. We
establish the nonparametric identification of the nonlinear earnings process and of the
consumption policy rule. Exploiting the enhanced consumption and asset data in recent waves of the Panel Study of Income Dynamics, we find that the earnings process
features nonlinear persistence and conditional skewness. We confirm these results using population register data from Norway. We then show that the impact of earnings
shocks varies substantially across earnings histories, and that this nonlinearity drives
heterogeneous consumption responses. The framework provides new empirical measures of partial insurance in which the transmission of income shocks to consumption
varies systematically with assets, the level of the shock, and the history of past shocks.
KEYWORDS: Earnings dynamics, consumption, nonlinear persistence, partial insurance, panel data, quantile regression, latent variables.

1. INTRODUCTION
CONSUMPTION DECISIONS AND EARNINGS DYNAMICS are intricately linked. Together with
the net value of assets, the size and durability of any income shock dictates how much consumption will need to adjust to ensure a reasonable standard of living in future periods of
the life-cycle.2 Understanding the persistence of earnings is therefore of key interest not
only because it affects the permanent or transitory nature of inequality, but also because it
drives much of the variation in consumption.3 The precise nature of labor income dynamics and the distribution of idiosyncratic shocks also plays a central role in the design of
optimal social insurance and taxation.4 This paper proposes a new nonlinear framework
to study the persistence of earnings and the impact of earnings shocks on consumption.
1
This paper was the basis for Arellano’s Presidential Address to the Econometric Society in 2014. We are
grateful to the co-editor and three anonymous referees for detailed comments. We also thank participants in
regional meetings and seminars, especially Xiaohong Chen, Mariacristina De Nardi, Jordi Gali, Fatih Guvenen, Lars Hansen, Jim Heckman, Yingyao Hu, Josep Pijoan, Enrique Sentana, and Kjetil Storesletten for their
comments. We are particularly grateful to Luigi Pistaferri and Itay Saporta-Eksten for help with the PSID data,
Magne Mogstad and Michael Graber for providing the estimations using the Norwegian population register
data as part of the project on ‘Labour Income Dynamics and the Insurance from Taxes, Transfers and the
Family’, and Ran Gu and Raffaele Saggio for excellent research assistance. Arellano acknowledges research
funding from the Ministerio de Economía y Competitividad, Grant ECO2011-26342. Blundell would like to
thank the ESRC Centre CPP at IFS and the ERC MicroConLab project for financial assistance. Bonhomme
acknowledges support from the European Research Council/ERC Grant agreement n0 263107.
2
See, for example, Jappelli and Pistaferri (2010) and references therein.
3
See Deaton and Paxson (1994) for key initial insights on consumption inequality, and the subsequent literature reviewed in Blundell (2014).
4
Golosov and Tsyvinski (2015) provided a recent review. In a dynamic Mirrlees tax design setting, optimal
labor distortions for unexpectedly high shocks are determined mainly by the need to provide intertemporal
insurance. Golosov, Troshkin, and Tsyvinski (2016) showed that deviations from log normality can have serious
repercussions for optimal capital and labor taxation.

© 2017 The Econometric Society

DOI: 10.3982/ECTA13795

694

M. ARELLANO, R. BLUNDELL, AND S. BONHOMME

With some notable exceptions (see the discussion and references in Meghir and
Pistaferri (2011)), the literature on earnings dynamics has focused on linear models.
The random-walk permanent/transitory model is a popular example (Abowd and Card
(1989)). Linear models have the property that all shocks are associated with the same
persistence, irrespective of the household’s earnings history. Linearity is a convenient
assumption, as it allows one to study identification and estimation using standard covariance techniques. However, by definition, linear models rule out nonlinear transmission of
shocks, while nonlinearities in income dynamics are likely to have a first-order impact on
consumption and saving choices.
The existing literature on earnings shocks and consumption follows two main approaches. One approach is to take a stand on the precise mechanisms that households use
to smooth consumption, for example saving and borrowing or labor supply, and to take a
fully-specified life-cycle model to the data; see Gourinchas and Parker (2002), Guvenen
and Smith (2014), or Kaplan and Violante (2014), for example. Except in very special
cases (as in Hall and Mishkin (1982)), the consumption function is generally a complex
nonlinear function of earnings components.5 Another approach is to estimate the degree
of “partial insurance” from the data without precisely specifying the insurance mechanisms; see Blundell, Pistaferri, and Preston (2008), for example. Linear approximations
to optimality conditions from the optimization problem deliver tractable estimating equations. However, linear approximations may not always be accurate (Kaplan and Violante
(2010)). Moreover, some aspects of consumption smoothing, such as precautionary savings or asset accumulation in the presence of borrowing constraints and nonlinear persistence, are complex in nature, making a linear framework less attractive. In this paper,
we develop a comprehensive new approach to study the nonlinear relationship between
shocks to household earnings and consumption over the life-cycle.
Our first contribution is to specify and estimate a nonlinear earnings process. In this
framework, log-earnings are the sum of a general Markovian persistent component and
a transitory innovation. Our interest mainly centers on the conditional distribution of the
persistent component given its past. This is a comprehensive measure of the earnings risk
faced by households. Conditional (or predictive) earnings distributions are a main feature
of many models of consumption responses to income shocks, as in Kaplan and Violante
(2014), for example, and also play a central role in the optimal design of social insurance,
as in Golosov, Troshkin, and Tsyvinski (2016). Using quantile methods on both U.S. and
Norwegian data, we show that the conditional distribution of the persistent component of
earnings exhibits important asymmetries. Our setup provides a tractable framework for
incorporating such properties into structural decision models.
Our modeling approach to earnings dynamics captures the intuition that, unlike in linear models, different shocks may be associated with different persistence. The notion of
persistence we propose is one of persistence of histories. In a Markovian setup, this is conveniently summarized using a derivative effect which measures by how much earnings at
period t vary with the earnings component at t −1, when hit by a particular shock at time t.
This approach provides a new dimension of persistence where the impact of past shocks
on current earnings may be altered by the size and sign of new shocks. For example, our
framework allows for “unusual” shocks to wipe out the memory of past shocks.
Allowing for nonlinear persistence, and more generally for flexible models of conditional earnings distributions given past earnings, has both theoretical and empirical appeal. The main features of our nonlinear framework for earnings dynamics relate directly
5
Interesting recent exceptions are Heathcote, Storesletten, and Violante (2014) and the semi-structural
approach in Alan, Browning, and Ejrnaes (2014).

EARNINGS AND CONSUMPTION DYNAMICS

695

to existing structural labor market models. Consider a worker who accumulates occupational or industry-specific skills, and these skills are permanently learned, perhaps with
a small decay rate, if used in the same occupation. A change of occupation or industry
where such skills are unused makes them less valuable and, possibly, makes them depreciate much faster. In job ladder models, earnings risk is asymmetric, job-loss risk affecting
workers at the top of the ladder while workers at the bottom face opportunities to move up
(Lise (2013)). In a recent model of earnings losses upon displacement, Huckfeldt (2016)
included an unskilled sector that tends to absorb laid-off workers. With low probability,
workers have the opportunity to escape this sector and move to the skilled sector that
features a job ladder. The escape from the unskilled sector is the event that wipes out the
memory of the past bad shocks. From an empirical perspective, “unusual” shocks could
correspond to job losses, changes of career, or health shocks. If such life-changing events
are occasionally experienced by households, one would expect their predictive probability
distributions over future income to feature nonlinear dynamic asymmetries.
Consider large, negative “unusual” income shocks, which not only have a direct effect
but also cancel out the persistence of a good income history. For example, a worker hit by
an adverse occupation-specific shock might find her skills less valuable. In that case, her
previous earnings history may matter much less after the shock. Using a parallel with the
macroeconomic literature on disaster risk, these shocks could be called “microeconomic
disasters.” While macroeconomic disasters could have potentially large effects on saving
behavior (Rietz (1988), Barro (2006)), they are so unlikely that they are statistically elusive events. In contrast, disasters at the micro level happen all the time to some individuals
and therefore their dynamic consequences may have clear-cut empirical content.6
Such features are prominent in the empirical results that we report in this paper, and
they are all at odds with linear models commonly used in the earnings dynamics literature.
Moreover, despite recent advances on models of distributional earnings dynamics (e.g.,
Meghir and Pistaferri (2004) or Botosaru and Sasaki (2015)), existing models do not seem
well-suited to capture the nonlinear transmission of income shocks that we uncover.
Our second contribution is to develop an estimation framework to assess how consumption responds to earnings shocks in the data. In the baseline analysis, we model the consumption policy rule as an age-dependent nonlinear function of assets, unobserved tastes,
and the persistent and transitory earnings components. We motivate our specification using a standard life-cycle model of consumption and saving with incomplete markets (as
in Huggett (1993), e.g.). In this model, as we illustrate through a small simulation exercise, a nonlinear earnings process with dynamic skewness of the type we uncover in our
conditional quantile analysis will have qualitatively different implications for the level
and distribution of consumption and assets over the life-cycle in comparison to a linear
earnings model.
The empirical consumption rule we develop is nonlinear, thus allowing for age-specific
interactions between asset holdings and the earnings components. However, unlike fully
specified structural approaches, we model the consumption rule nonparametrically, leaving functional forms unrestricted. This modeling approach allows capturing an array of response coefficients that provides a rich picture of the extent of consumption insurance in
the data. Moreover, there is no need for approximation arguments as we directly estimate
6
The notion of “micro disasters” is also related to Castañeda, Díaz-Giménez, and Ríos-Rull (2003), who
argued that allowing for a substantial probability of downward risk for high-income households may help
explain wealth inequality. See also Constandinides and Gosh (2017) and Schmidt (2015), who emphasized the
asset pricing implications of income risk asymmetries.

696

M. ARELLANO, R. BLUNDELL, AND S. BONHOMME

the nonlinear consumption rule. Our consumption rule allows for unobserved household
heterogeneity. We also show how to extend the framework to allow for advance information on earnings shocks and habits in consumption.
A virtue of our consumption framework is its ability to produce new empirical quantities, such as nonparametric marginal propensities to consume, that narrow the gap between policy-relevant evidence and structural modeling. At the same time, in the absence
of further assumptions, the model can be thought of as semi-structural and cannot generally be used to perform policy counterfactuals. As an example, in order to assess the
impact of a change in the earnings process on consumption dynamics, one would need
to take a precise stand on preferences and expectations, among other factors. Although,
given our goal to document nonlinear effects, we do not impose such assumptions in this
paper, economic structure and/or measured expectations could be added to our framework in order to conduct policy evaluation exercises.
Beyond the traditional covariance methods that have dominated the literature, new
econometric techniques are needed to study our nonlinear model of earnings and consumption. Nonparametric identification can be established in our setup by building on a
recent literature on nonlinear models with latent variables. Identification of the earnings
process follows Hu and Schennach (2008) and Wilhelm (2015).7 Identification of the consumption rule relies on novel arguments, which extend standard instrumental-variables
methods (as in Blundell, Pistaferri, and Preston (2008), e.g.) to our nonparametric setup.
To devise a tractable estimation strategy, we rely on the approach introduced by
Arellano and Bonhomme (2016), adapted to a setup with time-varying latent variables.
Wei and Carroll (2009) introduced a related estimation strategy in a cross-sectional context. The approach combines quantile regression methods, which are well-suited to capture nonlinear effects of earnings shocks, with regression methods on bases of functions,
which are well-suited to flexibly model conditional distributions.8 To deal with the presence of the latent earnings components, we use a sequential estimation algorithm that
consists in iterating between quantile regression estimation, and draws from the posterior
distribution of the latent persistent components of earnings.
We take the earnings and consumption model to data from the Panel Study of Income
Dynamics (PSID) for 1999–2009 and focus on working-age families. Unlike earlier waves
of the PSID, these data contain enhanced information on asset holdings and consumption
expenditures in addition to labor earnings; see Blundell, Pistaferri, and Saporta-Eksten
(2016), for example. This is the first household panel to include detailed information on
consumption and assets across the life-cycle for a representative sample of households.
Although we abstract from labor supply, our modeling and estimation approach makes
full use of the availability of panel information on earnings, consumption, and assets.
In addition, the quantile regression specifications that we use allow us to obtain rather
precise estimates, despite the flexibility of the model and the moderate sample size.
Our empirical results show that the impact of earnings shocks varies substantially across
households’ earnings histories, and that this nonlinearity is a driver of heterogeneous
consumption responses. Earnings data show the presence of nonlinear persistence, where
“unusual” positive shocks for low earnings households, and negative shocks for high earnings households, are associated with lower persistence than other shocks. That is, such
shocks have a higher propensity to wipe out the impact of the previous earnings history.
7
Lochner and Shin (2014) relied on related techniques to establish identification of a different nonlinear
model of earnings.
8
Misra and Surico (2014) used quantile methods to document the consumption responses associated with
tax rebates.

EARNINGS AND CONSUMPTION DYNAMICS

697

Related to this, we find that conditional log-earnings distributions are asymmetric, skewed
to the right (respectively, left) for households at the bottom (resp., top) of the income
distribution. Although most of our results are based on PSID data, we show that similar
empirical patterns hold in Norwegian administrative earnings data.
Regarding consumption, we find a significant degree of insurability of shocks to the
persistent earnings components. We also uncover asymmetries in consumption responses
to earnings shocks that hit households at different points of the income distribution. Last,
we find that assets play a role in the insurability of earnings shocks.
The literature on earnings dynamics is vast. Recent work has focused on nonGaussianity (Geweke and Keane (2000), Bonhomme and Robin (2010)) and heterogeneity (Browning, Ejrnaes, and Alvarez (2010)). The nonlinear earnings persistence that we
uncover is consistent with findings on U.S. administrative tax records, such as Guvenen,
Ozcan, and Song (2014) and especially recent independent work by Guvenen, Karahan,
Ozcan, and Song (2015). Relative to this growing body of research, the fact that our
quantile-based methods are able to uncover previously unknown results in PSID survey data, and that these results also hold in administrative “big data” sets, is important
because PSID uniquely provides joint longitudinal data on wealth, income, and expenditures at household level. This allows us to conduct a joint empirical analysis of earnings
and consumption patterns.9
The outline of the paper is as follows: In the next section, we describe the earnings process and develop our measure of nonlinear persistence. Section 3 lays out the consumption model and defines a general representation of partial insurance to earnings shocks.
In Section 4, we establish identification of the model. Section 5 describes our estimation
strategy and the panel data set. In Section 6, we present our empirical results. Section 7
concludes with a summary and some directions for future research. The Supplemental
Material (Arellano, Blundell, and Bonhomme (2017)) contains additional results.
2. MODEL (I): EARNINGS PROCESS
We start by describing our nonlinear model of earnings dynamics. In the next section,
we will present the consumption model.
2.1. The Model
We consider a cohort of households, i = 1     N, and denote as t the age of the household head (relative to t = 1). Let Yit be the pre-tax labor earnings of household i at age t,
and let yit denote log-Yit , net of a full set of age dummies. We decompose yit as follows:10
yit = ηit + εit 

i = 1     N t = 1     T

(1)

where the probability distributions of η’s and ε’s are absolutely continuous.
The first, persistent component ηit is assumed to follow a general first-order Markov
process. We denote the τth conditional quantile of ηit given ηit−1 as Qt (ηit−1  τ), for
9
Our nonlinear earnings model featuring asymmetric persistence is also related to time-series regimeswitching models that are popular to analyze business-cycle dynamics; see, for example, Evans and Wachtel’s
(1993) model of inflation uncertainty and Teräsvirta (1994) on smooth transition autoregressive models.
10
Model (1) is additive in η and ε. Given our nonlinear approach, it is in principle possible to allow for
interactions between the two earnings components, for example in yit = Ht (ηit  εit ), where identification could
be established along the lines of Hu and Shum (2012).

698

M. ARELLANO, R. BLUNDELL, AND S. BONHOMME

each τ ∈ (0 1). The following representation is then without loss of generality:
ηit = Qt (ηit−1  uit )

(uit |ηit−1  ηit−2    ) ∼ Uniform(0 1)

t = 2     T

(2)

The dependence structure of the η process is not restricted beyond the first-order Markov
assumption. The identification assumptions will only require η’s to be dependent over
time, without specifying a particular (parametric) form of dependence.
The second, transitory component εit is assumed to have zero mean, to be independent
over time and independent of ηis for all s. Even though more general moving average
representations are commonly used in the literature, the biennial nature of the PSID data
makes this assumption more plausible. Model (1)–(2) is intended as a representation of
the uncertainty about persistent and transitory labor income in future periods that households face when deciding how much to spend and save. Our approach can be extended to
allow for a higher-order Markov η process or a moving average ε component, provided
additional time periods are available, and for an unobserved time-invariant householdspecific effect in addition to the two latent time-varying components η and ε (as done in
the Supplemental Material).
Survey data like the PSID are often contaminated with errors (Bound, Brown, and
Mathiowetz (2001)). In the absence of additional information, it is not possible to disentangle the transitory innovation from classical measurement error. Thus, an interpretation
of our estimated distribution of εit is that it represents a mixture of transitory shocks and
measurement error.11
Both earnings components are assumed mean independent of age t. However, the conditional quantile functions Qt , and the marginal distributions of εit , may all depend on t.
For a given cohort of households, age and calendar time are perfectly collinear, so this
dependence may capture age effects as well as aggregate shocks. The distribution of the
initial condition ηi1 is left unrestricted.
An important special case of model (1)–(2) is obtained when
yit = ηit + εit 

ηit = ηit−1 + vit 

(3)

that is, when ηit follows a random walk. When vit is independent of ηit−1 and has cumulative distribution function Ft , (2) becomes: ηit = ηit−1 + Ft−1 (uit ). We will refer to the
random walk plus independent shock as the canonical model of earnings dynamics.
2.2. Nonlinear Dynamics
Model (1)–(2) allows for nonlinear dynamics of earnings. Here we focus on the ability
of this specification to capture nonlinear persistence, and general forms of conditional
heteroscedasticity.
Nonlinear Persistence. We introduce the following quantities:


∂Qt (ηit−1  τ)
∂Qt (ηit−1  τ)

ρt (τ) = E

(4)
ρt (ηit−1  τ) =
∂η
∂η
where ∂Qt /∂η denotes the partial derivative of Qt with respect to its first argument and
the expectation is taken with respect to the distribution of ηit−1 .
11

If additional information were available and the marginal distribution of a classical measurement error
were known, one could recover the distribution of εit using a deconvolution argument. The estimation algorithm can be modified to deal with this case.

EARNINGS AND CONSUMPTION DYNAMICS

699

The ρ’s in (4) are measures of nonlinear persistence of the η component.12 ρt (ηit−1  τ)
measures the persistence of ηit−1 when it is hit by a current shock uit that has rank τ. This
quantity depends on the lagged component ηit−1 , and on the percentile of the shock τ.
Average persistence across η values is ρt (τ). Note that, while the shocks uit are i.i.d. by
construction, they may greatly differ in the earnings persistence associated with them. The
ρ’s are thus measures of persistence of earnings histories.
In the canonical model of earnings dynamics (3) where ηit is a random walk,
ρt (ηit−1  τ) = 1 irrespective of ηit−1 and τ. In contrast, in model (2), the persistence
of ηit−1 may depend on the magnitude and direction of the shock uit . As a result, the
persistence of a shock to ηit−1 depends on the size and sign of current and future shocks
uit , uit+1 , . . . In particular, our model allows particular shocks to wipe out the memory of
past shocks. As reviewed in the Introduction, labor market models of the job ladder and
occupational mobility can involve workers facing an increasing risk of a large fall in earnings, while those recently laid off have a small probability of a positive shock that takes
them into a skilled job where they can advance along the ladder. The interaction between
the shock uit and the lagged persistent component ηit−1 is a central feature of our nonlinear approach and, as we show below, it has substantive implications for consumption
decisions.
It is useful to consider the following specification of the quantile function:
Qt (ηit−1  τ) = αt (τ) + βt (τ) h(ηit−1 )

(5)

where h is a multi-valued function. Our empirical specification will be based on (5), taking
the components of h in a polynomial basis of functions. Persistence and average persistence in (5) are, respectively,
∂h(ηit−1 )

ρt (ηit−1  τ) = βt (τ)
∂η



∂h(ηit−1 )
ρt (τ) = βt (τ) E

∂η




thus allowing shocks to affect the persistence of ηit−1 in a flexible way. This measure is
related to quantile autoregression parameters, as in Koenker and Xiao (2006).
Conditional Heteroscedasticity. As model (2) does not restrict the form of the conditional distribution of ηit given ηit−1 , it allows for general forms of heteroscedasticity.
In particular, a measure of period-t uncertainty generated by the presence of shocks to
the persistent earnings component is, for some τ ∈ (1/2 1), σt (ηit−1  τ) = Qt (ηit−1  τ) −
Qt (ηit−1  1 − τ). For example, in the canonical model (3) with vit ∼ N (0 σv2t ), we have
σt (ηit−1  τ) = 2σvt −1 (τ).13
In addition, the model allows for conditional skewness and kurtosis in ηit . Along the
lines of the skewness measure proposed by Kim and White (2004), one can consider, for
12

Note that ρt (ηit−1  τ) may be positive or negative, and may exceed 1 in absolute value. As a simple illustration, if ln(ηit ) is a random walk with standard Gaussian innovations, ηit itself is a multiplicative random
walk, for which derivative measures of persistence in (4) do not vary with lagged η but vary with the value of
the shock. For example, at the median shock the derivative is 1, but at the bottom quartile shock the derivative
is around 05, and at the top quartile it is around 2.
13
The shock uit is a rank. A persistent shock of a magnitude comparable to ηit can be constructed, among
other ways, as ζit = Qt (mt  uit ) where mt is the median of ηit .

700

M. ARELLANO, R. BLUNDELL, AND S. BONHOMME

FIGURE 1.—Quantile autoregressions of log-earnings. Note: Residuals yit of log pre-tax household labor
earnings, Age 25–60 1999–2009 (U.S.), Age 25–60 2005–2006 (Norway). See Section 6 and Appendix C for the
list of controls. Estimates of the average derivative of the conditional quantile function of yit given yit−1 with
respect to yit−1 . Quantile functions are specified as third-order Hermite polynomials. Source: The Norwegian
results are part of the project on ‘Labour Income Dynamics and the Insurance from Taxes, Transfers and the
Family’. See Appendix C.

some τ ∈ (1/2 1),14



1
Qt (ηit−1  τ) + Qt (ηit−1  1 − τ) − 2Qt ηit−1 
2

skt (ηit−1  τ) =
Qt (ηit−1  τ) − Qt (ηit−1  1 − τ)

(6)

The empirical estimates below suggest that conditional skewness is a feature of the earnings process.
Preliminary Evidence on Nonlinear Persistence. Suggestive evidence of nonlinearity in
the persistence of earnings can be seen from Figure 1. This figure plots estimates of the
average derivative, with respect to last period income yit−1 , of the conditional quantile
function of current income yit given yit−1 . This average derivative effect is a measure
of persistence analogous to ρt in (4), except that here we use residuals yit of log pre-tax
household labor earnings on a set of demographics (including education and a polynomial
in the age of the household head) as outcome variables. Given the nature of the PSID
sample, panel (a) features biennial persistence estimates. On the two horizontal axes, we
report the percentile of yit−1 (“τinit ”), and the percentile of the innovation of the quantile
process (“τshock ”). For estimation, we use a series quantile specification, as in (5), based
on a third-order Hermite polynomial.
This simple descriptive analysis not only shows the similarity in the patterns of the
nonlinearity of household earnings in both the PSID household panel survey data and
14

Similarly, a measure of conditional kurtosis is, for some α < 1 − τ,
kurt (ηit−1  τ α) =

Qt (ηit−1  1 − α) − Qt (ηit−1  α)

Qt (ηit−1  τ) − Qt (ηit−1  1 − τ)

EARNINGS AND CONSUMPTION DYNAMICS

701

in the annual population register data from Norway; it also suggests differences in the
impact of an innovation to the quantile process (τshock ) according to both the direction
and magnitude of τshock and the percentile of the past level of income τinit . Persistence
of earnings history is highest when high-earnings households (i.e., high τinit ) are hit by a
good shock (high τshock ), and when low-earnings households (i.e., low τinit ) are hit by a bad
shock (low τshock ). In both cases, estimated persistence is close to 0.9–1. In contrast, bad
shocks hitting high-earnings households, and good shocks hitting low-earnings ones, are
associated with much lower persistence of earnings history, as low as 0.3–0.4. In Section 6,
we will see that our nonlinear model that separates transitory shocks from the persistent
component reproduces the nonlinear persistence patterns of Figure 1 for the PSID panel
survey data and the Norwegian population register data.
3. MODEL (II): CONSUMPTION RULE
In order to motivate our empirical specification of the consumption function, we start
by describing a standard stochastic life-cycle consumption model. We then use this setup
to derive the form of the policy rule for household consumption, and describe the empirical consumption model that we will take to the data.
3.1. The Consumption Rule in a Simple Life-Cycle Model
We consider a theoretical framework where households act as single agents. Throughout their lifetime, households have access to a single risk-free, one-period bond whose
constant return is 1 + r, and, at age t, face a period-to-period budget constraint
Ait = (1 + r)Ait−1 + Yit−1 − Cit−1 

(7)

where Ait , Yit , and Cit denote assets, income, and consumption, respectively. Family logearnings are given by ln Yit = κt + ηit + εit , where κt is a deterministic age profile, and ηit
and εit are persistent and transitory earnings components, respectively. At age t, agents
know ηit , εit and their past values, but not ηit+1 or εit+1 , so there is no advance information. All distributions are known to households, and there is no aggregate uncertainty. In
each period t in the life-cycle, the optimization problem is represented by the Bellman
equation


(8)
Vt (Ait  ηit  εit ) = max u(Cit ) + βEt Vt+1 (Ait+1  ηit+1  εit+1 ) 
Cit

where u(·) is agents’ utility, and β is the discount factor. An important element in (8) is
the conditional distribution of the Markov component ηit+1 given ηit , which enters the
expectation.
In a nonlinear earnings model such as (1)–(2), the presence of “unusual” shocks to
earnings may lead to precautionary motives that induce high-income households to save
more than they would do under a linear earnings model. Even with certainty equivalent preferences, under model (1)–(2) the discounting applied to persistent shocks will be
state-dependent. In Section S1 of the Supplemental Material, we illustrate these theoretical mechanisms in a two-period version of the model. In Section S2, we report the results
of a simulation exercise based on the life-cycle model. We compare the canonical linear
earnings model with an earnings model that features the presence of positive and negative
“unusual” shocks. In the simulated economy, we find that an implication of the nonlinear

702

M. ARELLANO, R. BLUNDELL, AND S. BONHOMME

earnings process is to reduce consumption among households on higher incomes. In particular, a negative shock for those on higher incomes reduces the persistence of the past
and consequently is more damaging in terms of expected future incomes, thus inducing
higher saving, higher wealth accumulation, and lower consumption.15
In such a life-cycle model with uncertainty, the consumption rule will have the form
Cit = Gt (Ait  ηit  εit )

(9)

for some age-dependent function Gt . We will base our empirical specification on (9). The
consumption rule at age t will be of this nonparametric form where the state variables at
t are period-t assets and the latent earnings components.16
In documenting dynamic patterns of consumption and earnings, one strategy is to take
a stand on the functional form of the utility function and the distributions of the shocks,
and to calibrate or estimate the model’s parameters by comparing the model’s predictions with the data. Another strategy is to linearize the Euler equation, with the help of
the budget constraint; with a linear approximated problem at hand, standard covariancebased methods may be used for estimation. Our approach differs from those strategies
as we directly estimate the nonlinear consumption rule (9). Doing so, we avoid linearized
first-order conditions, and we estimate a flexible rule that is consistent with the above
life-cycle consumption model. This approach allows documenting a rich set of derivative
effects, thus shedding light on the patterns of consumption responses in the data.
3.2. Empirical Consumption Rule
Consider a cohort of households. Let cit denote log-consumption net of age dummies.
Similarly, let ait denote log-assets net of age dummies. Our empirical specifications are
based on
cit = gt (ait  ηit  εit  νit )

t = 1     T

(10)

The νit are unobserved arguments of the consumption function, in addition to assets and
the latent earnings components. In the specification without unobserved individual heterogeneity, νit are independent across periods and independent of (ait  ηit  εit ), and gt
is monotone in ν. An economic interpretation for ν is as a taste shifter that increases
marginal utility. In the single-asset life-cycle model of Section 3.1, monotonicity is implied
)
by the Bellman equation, provided ∂u(Cν
> ∂u(Cν)
for all C if ν  > ν, where the house∂C
∂C
hold’s utility function is u(C ν). Without loss of generality, we normalize the marginal
distribution of νit to be standard uniform in each period. From an empirical perspective,
the presence of the taste shifters νit in the consumption rule (10) may also partly capture
measurement error in consumption expenditures. In the specification with unobserved
individual heterogeneity, νit comprises two components: a time-invariant latent household factor, and an i.i.d. uniform component independent of the latter. Consumption is
monotone in the second component, while being fully nonlinear in the first.
15
In addition, in Section S2 of the Supplemental Material, we report simulation results based on the same
life-cycle model, using as input the earnings process we estimate on the PSID.
16
Our approach may be extended to allow for habits or advance information, through simple modifications
of the vector of state variables. There could also be additional borrowing constraints in each period. In that
case, the nonparametric consumption rule in (9) would no longer be differentiable. The derivative effects
defined below require differentiability of gt .

EARNINGS AND CONSUMPTION DYNAMICS

703

Clearly, the net assets variable ait is not exogenous. In order to ensure identification,
it suffices to specify ait as sequentially exogenous (or “predetermined”). We will specify assets as a function of lagged assets, consumption, earnings, the persistent earnings
component η, and age, as follows:
ait = ht (ait−1  cit−1  yit−1  ηit−1  υit )

(11)

where ht is an age-specific function which is increasing in its last argument, and υit are
i.i.d. uniform independent of the other arguments. Note that the standard linear asset rule
(7) is a special case of (11), so imposing (7) is not needed for identification or estimation.
Taking a stand on the budget constraint will, however, be required in order to simulate
the impact of earnings shocks over the life-cycle.
Derivative Effects. Average consumption, for given values of asset holdings and earnings
components, is


E[cit |ait = a ηit = η εit = ε] = E gt (a η ε νit ) 
Our framework allows us to document how average consumption varies as a function of
assets and the two earnings components, and over the life-cycle. In particular, the average
derivative of consumption with respect to η is


∂gt (a η ε νit )
φt (a η ε) = E

(12)
∂η
The parameter φt (a η ε) reflects the degree of insurability of shocks to the persistent
earnings component.17 We will document how this new measure of partial insurance varies
over the life-cycle, and how it depends on households’ asset holdings, by reporting estimates of the average derivative effect φt (a) = E[φt (a ηit  εit )]. The quantity 1 − φt (a) is
then a general measure of the degree of consumption insurability of shocks to the persistent earnings component, as a function of age and assets.
Dynamic Effects of Earnings Shocks on Consumption. Other measures of interest are
the effects of an earnings shock uit to the η component on the consumption profile cit+s ,
s ≥ 0. For example, the contemporaneous effect can be computed, using the chain rule
and equation (12), as

 
∂ 
∂Qt (η τ)

E
gt a Qt (η u) ε νit = φt a Qt (η τ) ε

∂u u=τ
∂u
This derivative effect depends on η through the insurance coefficient φt , but also through
(ητ)
the quantity ∂Qt∂u
as the earnings model allows for general forms of conditional het(ητ)
measures the responsiveness of earneroscedasticity and skewness. The quantity ∂Qt∂u
(ητ)
,
ings to a shock uit on impact. Note that its derivative with respect to η is equal to ∂ρt ∂τ
where ρt (η τ) is our persistence measure. In the empirical analysis, we will report finitedifference counterparts to these derivative effects (“impulse responses”), and find an
asymmetric impact of earnings shocks at different points of the income distribution.
Multiple Assets. Our approach can be generalized to represent the consumption policy function of a model with multiple assets differing in the stochastic properties of their
returns. An example is a model that distinguishes between a risky asset and a risk-free
17

it )
Likewise, the average derivative with respect to ε is ψt (a η ε) = E[ ∂gt (aηεν
].
∂ε

704

M. ARELLANO, R. BLUNDELL, AND S. BONHOMME

asset, as often used in studies of household portfolios (e.g., Alan (2012)). A version of the
consumption rule (10) with two assets would be consistent with this type of model as long
as excess returns of the risky asset are not heterogeneous across households. In the presence of kinks induced by participation or transaction costs, our empirical consumption
rule would capture a smoothed approximation.
The consumption rule (10) can also be extended to the Kaplan and Violante (2014)
model of wealthy “hand-to-mouth” consumers. In that framework, the consumption policy rule is a nonlinear function of assets disaggregated into liquid and illiquid parts. Access to the illiquid, higher return asset involves a transaction cost. The separate assets
interact in nonlinear ways with earnings. In this dynamic choice environment, the nonlinearity in the consumption model (10) incorporating the two separate assets can provide
a smoothed approximation to the complex paths involved in the Kaplan and Violante
(2014) composite consumption function.18
4. IDENTIFICATION
The earnings and consumption models take the form of nonlinear state-space models.
A series of recent papers (notably Hu and Schennach (2008), and Hu and Shum (2012))
has established conditions under which nonlinear models with latent variables are nonparametrically identified under conditional independence restrictions. Techniques developed in this literature can be used in order to establish identification of the models we
consider.
4.1. Earnings Process
Consider model (1)–(2), where ηit is a Markovian persistent component and εit are
independent over time and independent of the η’s. We assume that the data contain T
consecutive periods, t = 1     T . So, for a given cohort of households, t = 1 corresponds
to the age at which the household head enters the sample, and t = T corresponds to the
last period of observation.19 For that cohort, our aim is to identify the joint distributions
of (ηi1      ηiT ) and (εi1      εiT ) given i.i.d. data from (yi1      yiT ). Four periods are
needed in order to identify at least one Markov transition Qt .
Conditions for the nonparametric identification of the earnings process are direct consequences of the analysis in Hu and Schennach (2008) and Wilhelm (2015). We provide
such conditions in Appendix A. Identification is derived under several high-level assumptions. In particular, the distributions of (yit |yit−1 ) and (ηit |yit−1 ) both need to satisfy completeness conditions. For example, the first condition requires that the only function h
(in a suitable functional space) satisfying E[h(yit )|yit−1 ] = 0 be h = 0. This requires that
ηit−1 and ηit be statistically dependent, albeit without specifying the form of that dependence. An intuition for this is that if η’s were independent over time, there would be no
way to distinguish them from the transitory ε’s. Completeness is commonly assumed in
nonparametric instrumental variables problems (Newey and Powell (2003)).
18

A separate question of interest, but one that is beyond the scope of this paper, concerns the identification
of the latent consumption policy functions associated with the agent’s accessing or not accessing the illiquid
asset. Such a question could be posed if we observed a time-varying indicator of whether or not consumers
access their illiquid assets.
19
We consider a balanced panel for simplicity, but our arguments can be extended to unbalanced panels.

EARNINGS AND CONSUMPTION DYNAMICS

705

4.2. Consumption Rule
Let us now turn to the identification of the consumption rule (10), starting with the case
without unobserved heterogeneity. We make the following assumptions, where we denote
zit = (zi1      zit ).
ASSUMPTION 1: For all t ≥ 1,
(i) uit+s and εit+s , for all s ≥ 0, are independent of ati , ηit−1 , and yit−1 . εi1 is independent
of ai1 and ηi1 .
(ii) ait+1 is independent of (ait−1  cit−1  yit−1  ηit−1 ) conditional on (ait  cit  yit  ηit ).
(iii) The taste shifter νit in (10) is independent of ηi1 , (uis  εis ) for all s, νis for all s = t,
and ati .
Part (i) in Assumption 1 requires current and future earnings shocks, which are independent of past components of earnings, to be independent of current and past asset
holdings as well. At the same time, we let ηi1 and ai1 be arbitrarily dependent. This is important, because asset accumulation upon entry in the sample may be correlated with past
earnings shocks. Part (ii) is a first-order Markov condition on asset accumulation. It is satisfied in a standard life-cycle model with one single risk-less asset; see equation (7). The
assumption also holds in such a model when the interest rate rt is time-varying and known
to households. More generally, the assumption allows the latent components of earnings
ηit and εit to affect asset holdings separately, as in (11). Last, part (iii) requires taste
shifters to be independent over time, independent of earnings components, and independent of current and past assets. In particular, this rules out the presence of unobserved
heterogeneity in consumption. We will relax this condition in the next subsection.
The identification argument proceeds in a sequential way. Starting with the first period,
letting yi = (yi1      yiT ), and using f as a generic notation for a density function, we have
f (a1 |y) =

f (a1 |η1 )f (η1 |y) dη1 

(13)

where we have used that, by Assumption 1(i), f (a1 |η1  y) and f (a1 |η1 ) coincide. We can
rewrite (13) as


(14)
f (a1 |y) = E f (a1 |ηi1 )|yi = y 
where the expectation is taken with respect to the density of ηi1 given yi , for a fixed
value a1 . Hence, provided the distribution of (ηi1 |yi ) (which is identified from the earnings process; see above) is complete, the density f (a1 |η1 ) is identified from (14).20 Note
that the density f (a1  η1 |y) = f (a1 |η1 )f (η1 |y) is also identified.
We then have, using the consumption rule and Assumption 1(iii),
f (c1 |a1  y) =

f (c1 |a1  η1  y1 )f (η1 |a1  y) dη1 

(15)

or equivalently,


f (c1 |a1  y) = E f (c1 |ai1  ηi1  yi1 )|ai1 = a1  yi = y 

(16)

20
In fact, given that we are working with bounded density functions, it is sufficient that the distribution of
(ηi1 |yi ) be boundedly complete; see Blundell, Chen, and Kristensen (2007) for analysis and discussion.

706

M. ARELLANO, R. BLUNDELL, AND S. BONHOMME

where the conditional expectation is taken at fixed c1 . Under completeness in (yi2      yiT )
of the distribution of (ηi1 |ai1  yi ) (which is identified from the previous paragraph),21 the
densities f (c1 |a1  η1  y1 ) and f (c1  η1 |a1  y) are thus identified. Identification of the consumption function (10) for t = 1 follows since g1 is the conditional quantile function of c1
given a1 , η1 , and ε1 = y1 − η1 .
Second Period’s Assets. Turning to period 2, we have, using Assumption 1(i) and (iii),
f (a2 |c1  a1  y) =

f (a2 |c1  a1  η1  y1 )f (η1 |c1  a1  y) dη1 

(17)

from which it follows that the density f (a2 |c1  a1  η1  y1 ) is identified, provided the distribution of (ηi1 |ci1  ai1  yi ) (which is identified from above) is complete in (yi2      yiT ).
In addition, using Bayes’s rule and Assumption 1(i) and (iii),
f (η2 |a2  c1  a1  y) =

f (y|η1  η2  y1 )f (η1  η2 |a2  c1  a1  y1 )
dη1 
f (y|a2  c1  a1  y1 )

So, as the density f (η1 |a2  c1  a1  y1 ) is identified from above, and by Assumption 1
f (η1  η2 |a2  c1  a1  y1 ) = f (η1 |a2  c1  a1  y1 )f (η2 |η1 )
it follows that f (η2 |a2  c1  a1  y) is identified.
Subsequent Periods. To see how the argument extends to subsequent periods, consider
second period’s consumption. We have, using Assumption 1(iii),
f (c2 |a2  c1  a1  y) =

f (c2 |a2  η2  y2 )f (η2 |a2  c1  a1  y) dη2 

(18)

Provided the distribution of (ηi2 |ai2  ci1  ai1  yi ) (which is identified from the previous
paragraph) is complete in (ci1  ai1  yi1  yi3      yiT ), the density f (c2 |a2  η2  y2 ) is identified.
By induction, using in addition Assumption 1(ii) from the third period onward,
the joint density of η’s, consumption, assets, and earnings is identified provided,
for all t ≥ 1, the distributions of (ηit |cit  ati  yi ) and (ηit |cit−1  ati  yi ) are complete in
(cit−1  ait−1  yit−1  yit+1      yiT ).
Discussion. The identification arguments depend on completeness conditions, which relate to the relevance, in a nonparametric sense, of the instruments. To illustrate this, consider the completeness of the distribution of (ηi1 |yi ) in (yi2      yiT ), which we use to show
the identification of the consumption rule in the first period; see (16). Here we abstract
from assets for simplicity. The completeness condition then depends on the properties
of the earnings process. As an example, consider the case where T = 2, and (ηi1  yi1  yi2 )
follows a multivariate normal distribution with zero mean. Then ηi1 = αyi1 + βyi2 + ζi ,
where ζi is normal (0 σ 2 ), independent of (yi1  yi2 ). It can be easily shown that β = 0 if
Cov(ηi1  ηi2 ) = 0, in which case the distribution of (ηi1 |yi1  yi2 ) is complete in yi2 . As in
the identification of the earnings process, identification of the consumption rule thus relies on η’s being dependent over time. Beyond the settings studied so far in the literature
Here, by completeness in yi2 of the distribution of (yi1 |yi2  xi ) we mean that the only solution to
E[h(yi1  xi )|yi2  xi ] = 0 is h = 0. This is the same as (yi1  xi )|(yi2  xi ) being complete. Note that, similarly as
before, the weaker condition of bounded completeness suffices.
21

EARNINGS AND CONSUMPTION DYNAMICS

707

(such as in D’Haultfoeuille (2011), Andrews (2011), or Hu and Shiu (2012)), it would be
of great interest to provide primitive conditions for completeness in the nonlinear models
we focus on here.
An intuitive explanation for the identification argument comes from the link to nonparametric instrumental variables (NPIV). In period 1, for a fixed a1 , (14) is analogous
to an NPIV problem where ηi1 is the endogenous regressor and yi = (yi1      yiT ) is the
vector of instruments. Likewise, conditional on (ai1  yi1 ), (yi2      yiT ) are the “excluded
instruments” for ηi1 in (16). In subsequent periods, lagged consumption and assets are
used as instruments, together with lags and leads of earnings. Using leads of log-earnings
for identifying consumption responses is a common strategy in linear models; see, for
example, Hall and Mishkin (1982) and Blundell, Pistaferri, and Preston (2008).
4.3. Household Unobserved Heterogeneity
Accounting for unobserved heterogeneity in preferences or discounting, for example,
may be empirically important. Heterogeneity in discount factors is also a popular mechanism in quantitative macroeconomic models to generate realistic wealth inequality; see,
for example, Krusell and Smith (1998) and Krueger, Mitman, and Perri (2015). With unobserved heterogeneity, the consumption rule takes the form
cit = gt (ait  ηit  εit  ξi  νit )

t = 1     T

(19)

where ξi is a household-specific effect and νit are i.i.d. standard uniform. The distribution
of (ξi  ηi1  ai1 ) is left unrestricted. Therefore, ξi is treated as a “fixed effect.” Even if a
fully unstructured distinction between unobserved heterogeneity and individual dynamics
in a finite horizon panel is not possible, finite-dimensional fixed effects can be included
nonparametrically in the consumption (and earnings) equations as long as T is sufficiently
large. In Appendix A, we provide conditions for identification of this model, by relying on
results from Hu and Schennach (2008). For simplicity, we consider scalar heterogeneity ξi .
Depending on the number of available time periods, a vector of unobserved heterogeneity
could be allowed for.
Last, in Section S3 of the Supplemental Material, we consider several extensions of
the model. We show how to allow for unobserved heterogeneity in earnings, as in the
following specification that we will take to the data:
yit = ηit + ζi + εit 

(20)

where ηit = Qt (ηit−1  uit ) is first-order Markov. We also describe how to allow for dependence in transitory shocks, advance earnings information, and consumption habits.
5. ESTIMATION STRATEGY
5.1. Empirical Specification
Earnings Components. The earnings model depends on the Markovian transitions of the
persistent component Qt (· ·), the marginal distributions of εit , and the marginal distribution of the initial persistent component ηi1 . We now explain how we empirically specify
these three components.

708

M. ARELLANO, R. BLUNDELL, AND S. BONHOMME

Let ϕk , for k = 0 1    , denote a dictionary of bivariate functions, with ϕ0 = 1. Letting
ageit denote the age of the head of household i in period t, we specify
Qt (ηit−1  τ) = Q(ηit−1  ageit  τ)

(21)

K

=

aQk (τ)ϕk (ηit−1  ageit )
k=0

In practice, we use low-order products of Hermite polynomials for ϕk . We specify the
quantile function of εit (for t = 1     T ) given ageit , and that of ηi1 given age at the start
of the period agei1 , in a similar way. Specifically, we set
K

Qε (ageit  τ) =

aεk (τ)ϕk (ageit )
k=0
K
η

Qη1 (agei1  τ) =

ak 1 (τ)ϕk (agei1 )
k=0

with outcome-specific choices for K and ϕk .
The quantile model (21) provides a flexible specification of the conditional distribution
of ηit given ηit−1 and age. Similarly, our quantile specifications flexibly model how εit
and ηi1 depend on age, at every quantile. We include the age of the household head as
a control, while ruling out dependence on calendar time. This choice is motivated by our
desire to model life-cycle evolution, as well as by the relative stationarity of the earnings
distributions (conditional on age) during the 1999–2009 period and the relatively small
sample size. On larger samples, an interesting avenue will be to allow for variation in
both age and calendar time within our framework.22
Consumption Rule. Following from Section 3.2, we specify the conditional distribution
of consumption given current assets and earnings components as follows:
gt (ait  ηit  εit  τ) = g(ait  ηit  εit  ageit  τ)

(22)

K
g

=

g

bk ϕk (ait  ηit  εit  ageit ) + b0 (τ)
k=1

where ϕk is a dictionary of functions (in practice, another product of Hermite polynomials).
Equation (22) is a nonlinear regression model. In contrast with (21), the consumption
g
model is additive in τ. It would be conceptually straightforward to let all coefficients bk
depend on τ, although this would lead to a less parsimonious specification. Below we
augment the consumption function to also depend nonlinearly on a household-specific
effect.
22
The functional form in (21) does not enforce monotonicity in τ, but our estimation method will produce
an automatic rearrangement of quantiles if needed.

EARNINGS AND CONSUMPTION DYNAMICS

709

Assets Evolution. We specify the distribution of initial assets ai1 conditional on the initial
persistent component ηi1 and the age at the start of the period agei1 as
K

Qa (ηi1  agei1  τ) =

bak (τ)ϕk (ηi1  agei1 )

(23)

k=0

for different choices for K and ϕk . We then specify how assets evolve as a function of
lagged assets, consumption, earnings, the persistent earnings component η, and age, using
(11), where
ht (ait−1  cit−1  yit−1  ηit−1  τ) = h(ait−1  cit−1  yit−1  ηit−1  ageit  τ)

(24)

K

bhk ϕk (ait−1  cit−1  yit−1  ηit−1  ageit ) + bh0 (τ)

=
k=1

for some K and ϕk .23
η
Implementation. The functions aQk , aεk , and ak 1 are indexed by a finite-dimensional pag
rameter vector θ. Likewise, the functions b0 , bh0 , and bak are indexed by a parameter vecg
g
tor μ that also contains b1      bK  bh1      bhK . We base our implementation on Wei and
Carroll (2009) and Arellano and Bonhomme (2016). As in these papers, we model the
functions aQk as piecewise-polynomial interpolating splines on a grid [τ1  τ2 ], [τ2  τ3 ], . . . ,
[τL−1  τL ], contained in the unit interval. We extend the specification of the intercept coefficient aQ0 on (0 τ1 ] and [τL  1) using a parametric model indexed by λQ . All aQk for
k ≥ 1 are constant on [0 τ1 ] and [τL  1], respectively. Hence, denoting aQk = aQk (τ ), the
functions aQk depend on {aQ11      aQKL  λQ }.
Unlike in an ordinary quantile regression, the dependence of the parameters on the
percentiles τ needs to be specified because some of our regressors are latent variables. In
practice, we take L = 11 and τ = /(L + 1). The functions aQk are taken as piecewiselinear on [τ1  τL ]. An advantage of this specification is that the likelihood function is
available in closed form. In addition, we specify aQ0 as the quantile of an exponential
distribution on (0 τ1 ] (with parameter λQ− ) and [τL  1) (with parameter λQ+ ).24
η
We proceed similarly to model aεk , ak 1 , and bak . Moreover, as our data show little evig
dence against consumption being log-normal, we set b0 (τ) to α + σ −1 (τ), where (α σ)
are parameters to be estimated. We proceed similarly for bh0 (τ). We also estimated two
g
different versions of the model with more flexible specifications for b0 (τ) and bh0 (τ): based
on quantiles on a grid with L = 11 knots, and allowing for an age effect in the variance
of the consumption innovation. In both cases, we found very similar results to the ones
23
In a previous version of the paper, we estimated the model imposing that ηit−1 does not enter (24), which is
still consistent with the budget constraint (7) and avoids the need to model predetermined assets. We obtained
qualitatively similar empirical results.
24
As a result, we have

aQ
0 (τ) =



Q
L−1 
aQ
τ
k+1 − ak
(τ − τ ) 1{τ ≤ τ < τ+1 }
1{0 < τ < τ1 } +
aQ
k +
τ1
τ+1 − τ
=1


1−τ
1
1{τL ≤ τ < 1}
− Q log
1 − τL
λ+
1

λQ
−



log

710

M. ARELLANO, R. BLUNDELL, AND S. BONHOMME

we report below. We use tensor products of Hermite polynomials for ϕk and ϕk , each
component of the product taking as argument a standardized variable.25
Household Unobserved Heterogeneity. When allowing for household unobserved heterogeneity in consumption/assets, we model log-consumption as
cit = g(ait  ηit  εit  ageit  ξi  νit )

(25)

g

which we specify similarly as in (22), with parameters bk . To fix the scale of the function,
we impose that
K
g

bk ϕk (0 0 0 age ξ) = ξ

for all ξ

(26)

k=1

where age denotes the mean value of age in the sample. Likewise, we model assets as
ait = h(ait−1  cit−1  yit−1  ηit−1  ageit  ξi  υit )

(27)

with a similar specification as in (24). Last, we specify ξi = q(ai1  ηi1  agei1  ωi ), with ωi
uniform on (0 1), using a quantile modeling as in (23).26
5.2. Overview of the Estimation Algorithm
The algorithm is an adaptation of techniques developed in Arellano and Bonhomme
(2016) to a setting with time-varying latent variables. The first estimation step recovers estimates of the earnings parameters θ. The second step recovers estimates of the consumption and assets parameters μ, given a previous estimate of θ. Our choice of a sequential
estimation strategy, rather than joint estimation of (θ μ), is motivated by the fact that θ
is identified from the earnings process alone. In contrast, in a joint estimation approach,
estimates of the earnings process would be partly driven by the consumption model. Here
we describe the estimation of the earnings parameters θ. Estimation of the consumption
parameters μ is similar. The model’s restrictions are described in detail in Appendix B.
A compact notation for the restrictions implied by the earnings model is


θ = argmin E
R(yi  η; θ)fi (η; θ) dη 
θ

where R is a known function, θ denotes the true value of θ, and fi (·; θ) = f (·|yiT  ageTi ; θ)
denotes the posterior density of (ηi1      ηiT ) given the earnings data. The estimation algorithm is closely related to the “stochastic EM” algorithm (Celeux and Diebolt (1993)).
Stochastic EM is a simulated version of the classical EM algorithm of Dempster, Laird,
and Rubin (1977), where new draws from η are computed in every iteration of the algorithm. One difference is that, unlike in EM, our problem is not likelihood-based. Instead,
we exploit the computational convenience of quantile regression and replace likelihood
maximization by a sequence of quantile regressions in each M-step of the algorithm.
Starting with a parameter vector 
θ(0) , we iterate the following two steps on s = 0 1 2   
(s)

until convergence of the θ process:
25
For example, at /std(a), ηt /std(y), εt /std(y), and (aget − mean(age))/std(age) are used as arguments of
the consumption rule.
26
We proceed analogously when allowing for an additive household-specific effect ζi in log-earnings yit =
ηit + ζi + εit , where ηit is given by (2). There we allow for flexible dependence between ηi1 , ζi , and agei1
through another series quantile model.

711

EARNINGS AND CONSUMPTION DYNAMICS
(m)
(s)
1. Stochastic E-step: Draw η(m)
= (η(m)
i
i1      ηiT ) for m = 1     M from fi (·; θ ).
2. M-step: Compute
N


θ(s+1) = argmin
θ

M

R yi  η(m)
i ;θ 
i=1 m=1

Note that, as the likelihood function is available in closed form, the E-step is straightforward. In practice, we use a random-walk Metropolis–Hastings sampler for this purpose,
targeting an acceptance rate of approximately 30%. The M-step consists of a number of
quantile regressions. For example, the parameters aQk are updated as
N

T

M

min

Q

Q

(a0 aK ) i=1 t=2 m=1





K
(m)
it

ρτ η

−

Q
k

(m)
it−1

a ϕk η

 ageit



 = 1     L

k=0

where ρτ (u) = u(τ − 1{u ≤ 0}) is the “check” function. This is a set of standard quantile
regressions, associated with convex objective functions. We proceed in a similar way to
update all other parameters; see Appendix B for details.
In practice, we first estimate the effect of age on mean log-earnings by regressing them
on a quartic in age. We then impose in each iteration of the algorithm that εit and age
are uncorrelated (although we allow for age effects on the variance and quantiles of εit ).
We take M = 1, stop the chain after a large number of iterations, and report an average
S
across the last S values 
θ = S1 s=S−S+1 
θ(s) , and similarly for consumption-related parame27
ters 
μ. The results for the earnings parameters are based on S = 500 iterations, with 200
Metropolis–Hastings draws in each iteration. Consumption-related parameters are estimated using 200 iterations with 200 draws per iteration. In both cases, we take S = S/2. In
our experiments, we observed that the algorithm may get “stuck” on what appears to be a
local regime of the Markov chain. We started the algorithm from a large number of initial
parameter values, and selected the estimates yielding the highest average log-likelihood
over iterations. The non-selected values tended to give very similar pictures to the ones
we report below.
Properties. Nielsen (2000) studied the statistical properties of the stochastic EM algorithm in a likelihood case. He provided conditions under which the Markov chain 
θ(s) is
ergodic, for a fixed sample size. He also characterized the asymptotic distribution of 
θ
as the sample size N tends to infinity. Arellano and Bonhomme (2016) characterized the
asymptotic distribution of 
θ in a case where the optimization step is not likelihood-based
but relies on quantile-based estimating equations. The estimator 
θ is root-N consistent
and asymptotically normal under correct specification of the parametric model, for K and
L fixed. Note that an alternative, nonparametric approach would be to let K and L increase with N at an appropriate rate so as to let the approximation bias tend to zero.28
Studying inference in our problem as (N K L) jointly tend to infinity is an interesting
avenue for future work.
As an alternative to taking a large M, taking M = 1 and averaging the parameter draws is computationally
convenient in our setting.
28
See Belloni, Chernozhukov, Chetverikov, and Fernández-Val (2016) for an analysis of inference for series
quantile regression, and Arellano and Bonhomme (2016) for a consistency analysis in a panel data model
closely related to the one we consider here.
27

712

M. ARELLANO, R. BLUNDELL, AND S. BONHOMME

6. EMPIRICAL RESULTS ON EARNINGS AND CONSUMPTION
In this section, we present our empirical results. We start by describing our main data
source, the Panel Study of Income Dynamics (PSID). We then show how earnings and
consumption respond to income shocks. We also corroborate our findings for the nonlinear earnings process using administrative data on household earnings from the Norwegian
population register. Finally, we report simulation exercises based on the estimated model.
6.1. Panel Data
Panel data on household consumption, income, and assets are rare. The PSID began
the collection of detailed data on consumption expenditures and asset holdings in 1999,
in addition to household earnings and demographics. An annual wave is available every
other year. We use data for the 1999–2009 period (six waves).
Earnings Yit are total pre-tax household labor earnings. We construct yit as residuals
from regressing log household earnings on a set of demographics, which include cohort
interacted with education categories for both household members, race, state, and largecity dummies, a family size indicator, number of kids, a dummy for income recipient other
than husband and wife, and a dummy for kids out of the household. Controls for family
size and composition are included so as to equivalize household earnings (likewise for
consumption and assets below). Education, race, and geographic dummies are included
in an attempt to capture individual heterogeneity beyond cohort effects and the initial
persistent component of earnings ηi1 . Removing demographic-specific means in a preliminary step has been the standard practice in the empirical analysis of earnings dynamics.
A more satisfactory approach would integrate both steps, especially given our emphasis
on nonlinearities. However, except for age, we did not attempt a richer conditioning in
light of sample size.
We use data on consumption Cit of nondurables and services. The panel data contain
information on health expenditures, utilities, car-related expenditures and transportation,
education, child care, and food expenditures. Recreation, alcohol, tobacco, and clothing
(the latter available from 2005) are the main missing items. Rent information is available
for renters, but not for home owners. We follow Blundell, Pistaferri, and Saporta-Eksten
(2016) and impute rent expenditures for home owners.29 In total, approximately 67% of
consumption expenditures on nondurables and services are covered. We construct cit as
residuals of log total consumption on the same set of demographics as for earnings.
Asset holdings Ait are constructed as the sum of financial assets (including cash, stocks,
and bonds), real estate value, pension funds, and car value, net of mortgages and other
debt. We construct residuals ait by regressing log-assets on the same set of demographics
as for earnings and consumption. These log-assets residuals will enter as arguments of the
nonlinear consumption rule (10).
To select the sample, we follow Blundell, Pistaferri, and Saporta-Eksten (2016) and focus on a sample of participating and married male heads aged between 25 and 60. We
drop all observations for which data on earnings, consumption, or assets, either in levels
or log-residuals, are missing. See Appendix C for further details. In the analysis, we focus
on a balanced subsample of N = 792 households. Table C.I in Appendix C shows mean
total earnings, consumption, and asset holdings, by year. Compared to Blundell, Pistaferri, and Saporta-Eksten (2016), households in our balanced sample have higher assets,
29
Note that, as a result, consumption responds automatically to variations in house prices. An alternative
would be to exclude rents and imputed rents from consumption expenditures.

EARNINGS AND CONSUMPTION DYNAMICS

713

and to a lesser extent higher earnings and consumption. The table also shows a large and
increasing dispersion of assets across households. The evolution of assets may partly reflect the housing boom and bust, including the effect of the Great Recession at the end of
the sample. Although our framework could be used to document distributional dynamics
along the business-cycle, we abstract from business-cycle effects in this paper.
Last, the sample that we use is relatively homogeneous. Including households with
less stable employment histories would be interesting, but it would require extending our
framework. We return to this point in the conclusion.
6.2. Earnings
We next comment on the empirical estimates of the earnings process. Figure 2(a) reproduces Figure 1(a). It shows estimates of the average derivative of the conditional quantile
function of log-earnings residuals yit given yit−1 with respect to yit−1 in the PSID sample. The figure suggests the presence of nonlinear persistence, which depends on both
the percentile of past income (τinit ) and the percentile of the quantile innovation (τshock ).
This empirical pattern is also present for male wages; see Figure S1 of the Supplemental
Material. We then estimate the earnings model,30 and, given the estimated parameters,
we simulate the model.31 Figure 2(b), which is based on simulated data, shows that our
nonlinear model reproduces the patterns of nonlinear persistence well. In contrast, standard models have difficulty fitting this empirical pattern. For example, we estimated a
simple version of the canonical earnings dynamics model (3) with a random-walk component and independent transitory shocks.32 Figure 2(c) shows that the average derivative
of the quantile function is nearly constant (up to simulation error) with respect to τshock
and τinit . This linear specification without interaction effects between earnings shocks and
past earnings components stands in contrast with the data.33
Figure 2(d) then shows the estimated persistence of the earnings component ηit . Specifically, the graph shows ρt (ηit−1  τ) from equation (4), evaluated at percentiles τinit and
τshock and at the mean age in the sample (475 years).34 Persistence in η’s is higher than
persistence in log-earnings residuals, consistently with the fact that Figure 2(d) is net
of transitory shocks. Persistence is close to 1 for high-earnings households hit by good
shocks, and for low-earnings households hit by bad shocks. At the same time, persistence
is lower, down to 0.6–0.8, when bad shocks hit high-earnings households or good shocks
hit low-earnings ones.
Densities and Moments. Figure 3 shows estimates of the marginal distributions of the
persistent and transitory earnings components at mean age. While the persistent component ηit shows relatively small departures from Gaussianity, the density of εit is clearly
30

We use tensor products of Hermite polynomials of degrees (3 2) for the conditional quantile function of
ηit given ηit−1 and age, and second-order polynomials for εit and ηi1 as a function of age.
31
We draw 20 earnings values per household. In the simulation, we impose that the support of simulated η
draws be less than three times the empirical support of log-earnings residuals. This affects very few observations.
32
Estimation is based on equally-weighted minimum distance using the covariance structure predicted by
the canonical model.
33
In order to assess the sensitivity to the polynomial functional form that we use, in Figure S2 of the Supplemental Material, we report persistence estimates based on piecewise-linear specifications based on 9 or 25
pieces. The characteristic shape of Figure 2(a) remains present.
34
The estimated persistence is similar when averaging over age; see Figure S3 of the Supplemental Material.

714

M. ARELLANO, R. BLUNDELL, AND S. BONHOMME

FIGURE 2.—Nonlinear persistence. Note: Graphs (a), (b), and (c) show estimates of the average derivative
of the conditional quantile function of yit given yit−1 with respect to yit−1 , evaluated at percentile τshock and at
a value of yit−1 that corresponds to the τinit percentile of the distribution of yit−1 . Graph (a) is based on the
PSID data, graph (b) is based on data simulated according to our nonlinear earnings model with parameters
set to their estimated values, and graph (c) is based on data simulated according to the canonical random-walk
earnings model (3). Graph (d) shows estimates of the average derivative of the conditional quantile function
of ηit on ηit−1 with respect to ηit−1 , based on estimates from the nonlinear earnings model.

non-normal and presents high kurtosis and fat tails. These results are qualitatively consistent with empirical estimates of non-Gaussian linear models in Horowitz and Markatou
(1996) and Bonhomme and Robin (2010).
In Figure 4, we report the measure of conditional skewness in (6), for τ = 11/12, for
both log-earnings residuals (left graph) and the η component (right). Panel (b) shows that
ηit is positively skewed for low values of ηit−1 , and negatively skewed for high values of
ηit−1 . This is in line with the nonlinear persistence reported in Figure 2(d): when low-η
households are hit by an unusually positive shock, dependence of ηit on ηit−1 is low with
the result that they have a relatively large probability of outcomes far to the right from
the central part of the distribution. Likewise, high-η households have a relatively large
probability of getting outcomes far to the left of their distribution associated with low

EARNINGS AND CONSUMPTION DYNAMICS

715

FIGURE 3.—Densities of persistent and transitory earnings components. Note: Nonparametric estimates of
densities based on simulated data according to the nonlinear model, using a Gaussian kernel.

persistence episodes. Panel (a) similarly suggests the presence of conditional asymmetry
in log-earnings residuals, although the evidence seems less strong than for η.
In addition, in Figures S4 to S8 of the Supplemental Material, we report several measures of fit of the model. We show quantile-based estimates of conditional dispersion and
conditional skewness. We also report estimates of the skewness, kurtosis, and densities
of log-earnings residuals growth at various horizons, from 2 to 10 years. The data suggest the presence of ARCH effects (as in Meghir and Pistaferri (2004)). It also shows
that log-earnings growth is non-Gaussian, displaying negative skewness and high kurtosis. Guvenen et al. (2015) documented similar features on U.S. administrative data. This
shows both the qualitative similarity between the PSID and the administrative U.S. data

FIGURE 4.—Conditional skewness of log-earnings residuals and η component. Note: Conditional skewness
sk(y τ) and sk(η τ), see equation (6), for τ = 11/12. Log-earnings residuals (data, left) and η component
(right). The x-axis shows the conditioning variable; the y-axis shows the corresponding value of the conditional
skewness measure.

716

M. ARELLANO, R. BLUNDELL, AND S. BONHOMME

in terms of higher moments of log-earnings growth, and the ability of our nonlinear model
to fit these features. Note that, in our model, skewness and excess kurtosis of log-earnings
growth at long horizons are mostly due to the non-Gaussianity of the transitory component ε.
Confidence Bands. We compare two different methods to compute confidence intervals
for these estimates. The first method is the nonparametric bootstrap, clustered at the
household level. The second method is the parametric bootstrap. While the latter requires
correct specification of the parametric model, the former may still be consistent under
misspecification and allows for unrestricted serial correlation (however, we are not aware
of a formal justification for it in this setting). In Figures S9 to S14 of the Supplemental
Material, we report pointwise 95% confidence bands based on both methods, and we also
show uniform confidence bands based on the nonparametric bootstrap. In all cases, the
main findings on nonlinear persistence and conditional skewness seem rather precisely
estimated. At the same time, the uniform confidence bands are wider, especially for the
η component.
Household Unobserved Heterogeneity. In Figure S15 of the Supplemental Material, we
report the nonlinear persistence and conditional skewness of the η component in model
(20), which allows, in addition, for an additive household-specific effect. Compared to
Figure 2, allowing for a household effect reduces persistence. Moreover, the nonlinear
pattern is more pronounced than in the homogeneous case. Persistence is close to 1 for
values of τinit and τshock that are close to each other, but it is substantially lower when
a large positive (respectively, negative) shock hits a low-earnings (resp., high-earnings)
household.
Norwegian Population Register Data. The above results suggest that nonlinear persistence and conditional skewness are features of earnings processes in the PSID. In order
to corroborate these findings using a different, larger data set, we estimated the earnings
process using a balanced subsample of 2873 households from the 2000–2005 Norwegian
administrative data, see Appendix C. The estimates are shown in Figures S16 to S19 of the
Supplemental Material. Like the PSID, the Norwegian population register data present
a similar pattern of conditional skewness. Moreover, the Norwegian data show similar
nonlinear persistence in the persistent component η as the PSID. At the same time, the
dispersion of the transitory component ε is much smaller in the Norwegian data, suggesting either the presence of large measurement error in the PSID or smaller true transitory
innovations in Norway. In order to shed more light on the differences, it would be very
interesting to also estimate our nonlinear model on a large administrative data set for the
United States.
6.3. Consumption
We next turn to consumption. We estimated two main specifications: with and without
household unobserved heterogeneity. Since, due to the small sample size in the PSID,
allowing for unobserved heterogeneity is somewhat challenging on these data, here we
focus on the results without unobserved heterogeneity. The results with unobserved heterogeneity are reported in the Supplemental Material.
Figure 5(a) shows estimates of the average derivative, with respect to yit , of the conditional mean of cit given yit , ait , and ageit . The function is evaluated at percentiles of
log-assets and age (τassets and τage , respectively), and averaged over yit .35 The derivative
35
We use tensor products of Hermite polynomials with degrees (2 2 1) in the estimation of the consumption
rule.

EARNINGS AND CONSUMPTION DYNAMICS

717

FIGURE 5.—Consumption responses to earnings shocks, by assets and age, model without household-specific unobserved heterogeneity. Note: Graphs (a) and (b) show estimates of the average derivative of the conditional mean of cit , with respect to yit , given yit , ait , and ageit , evaluated at values of ait and ageit that correspond
to their τassets and τage percentiles, and averaged over the values of yit . Graph (a) is based on the PSID data, and
graph (b) is based on data simulated according to our nonlinear model with parameters set to their estimated
values. Graph (c) shows estimates of the average consumption responses φt (a) to variations in ηit , evaluated
at τassets and τage .

effects lie between 0.2 and 0.3. Moreover, the results indicate that consumption of older
households, and of households with higher assets, is less correlated to variations in earnings. Figure 5(b) shows the same response surface based on simulated data from our full
nonlinear model of earnings and consumption. The fit of the model, though not perfect,
seems reasonable. In particular, the model reproduces the main pattern of correlation
with age and assets.3637
Figure 5(c) shows estimates of the average consumption response φt (a) to variations
in the persistent component of earnings. As described in Section 3, 1 − φt (a) can be regarded as a measure of the degree of consumption insurability of shocks to the persistent
earnings component, as a function of age and assets. On average, the estimated φt (a)
parameter lies between 0.3 and 0.4, suggesting that more than half of pre-tax household
earnings fluctuations is effectively insured. Moreover, variation in assets and age suggests
the presence of an interaction effect. In particular, older households with high assets seem
better insured against earnings fluctuations.38
In Figures S22 and S23 of the Supplemental Material, we report 95% confidence bands
for φt (a) based on both parametric bootstrap and nonparametric bootstrap. The findings
on insurability of shocks to the persistent earnings component seem quite precisely estimated. In Figure S24 of the Supplemental Material, we report estimates of the model
with household unobserved heterogeneity in consumption; see (19). Estimated consump36

In Figure S20 of the Supplemental Material, we show that the model fit to the density of log-consumption
is also good.
37
While the covariances between log-earnings and log-consumption residuals are well reproduced, the baseline model does not perform as well in fitting the dynamics of consumption, as it systematically underestimates
the autocorrelations between log-consumption residuals. The specification with household unobserved heterogeneity improves the fit to consumption dynamics.
38
Consumption responses to transitory shocks are shown in Figure S21 of the Supplemental Material.

718

M. ARELLANO, R. BLUNDELL, AND S. BONHOMME

FIGURE 6.—Consumption responses to assets. Note: Estimates of the average derivative of the conditional
mean of cit , with respect to ait , given yit (respectively, given ηit and εit in graph (c)), ait , and ageit , evaluated
at values of ait and ageit that correspond to their τassets and τage percentiles, and averaged over the values of yit
(resp., over the values of ηit and εit in graph (c)). Model without unobserved heterogeneity.

tion responses are quite similar to the ones without unobserved heterogeneity, although
the nonlinearity with respect to assets and age seems more pronounced.
Consumption Responses to Assets. In addition to consumption responses to earnings
shocks, our nonlinear framework can be used to document derivative effects with respect
to assets. Such quantities are often of great interest, for example when studying the implications of tax reforms. Graph (c) in Figure 6 shows estimated average derivatives, in
a model without unobserved heterogeneity in consumption.39 The quantile polynomial
specifications are the same as in Figure 5. We see that the responses range between 0.05
and 0.2, and that the derivative effects seem to increase with age and assets.
6.4. Simulating the Impact of Persistent Earnings Shocks
In this last subsection, we simulate life-cycle earnings and consumption according to our
nonlinear model, and show the evolution of earnings and consumption following a persistent earnings shock. In Figure 7, we report the difference between the age-specific medians of log-earnings of two types of households: households that are hit, at the same age
37, by either a large negative shock to the persistent earnings component (τshock = 010),
or by a large positive shock (τshock = 090), and households that are hit by a median shock
τ = 050 to the persistent component.40 We report age-specific medians across 100,000
simulations of the model. At the start of the simulation (i.e., age 35), all households
have the same persistent component indicated by the percentile τinit . With some abuse
of terminology, we refer to the resulting earnings and consumption paths as “impulse
responses.”41
39
Graphs (a) and (b) in Figure 6 show that the model replicates well the empirical relationship between
consumption and assets conditional on earnings and age. See Figure S25 of the Supplemental Material for the
results in a model with unobserved heterogeneity.
40
Note that such positive or negative shocks being “large” are relative statements, given that they correspond
to ranks of different conditional distributions.
41
See, for example, Gallant, Rossi, and Tauchen (1993) and Koop, Pesaran, and Potter (1996) for work on
impulse response functions in nonlinear models.

EARNINGS AND CONSUMPTION DYNAMICS

719

FIGURE 7.—Impulse responses, earnings. Note: Persistent component at percentile τinit at age 35. The
graphs show the difference between a household hit by a shock τshock at age 37, and a household hit by a
0.5 shock at the same age. Age-specific medians across 100,000 simulations. Graphs (a) to (f) correspond to
the nonlinear model. Graphs (g) and (h) correspond to the canonical model (3) of earnings dynamics.

720

M. ARELLANO, R. BLUNDELL, AND S. BONHOMME

Earnings responses reported in Figure 7 are consistent with the presence of interaction effects between the rank in the distribution of earnings component (τinit ) and the
sign and size of the shock to the persistent component (τshock ). While a large negative
shock (τshock = 010) is associated with a 7% drop in earnings for low-earnings households (τinit = 010), a similar shock is associated with a 19% drop for high-earnings households (τinit = 090). We also find interaction effects in the response to large positive shocks
(τshock = 090). This suggests the presence of asymmetries in the persistence of earnings
histories, depending on the previous earnings history of the household and the size and
magnitude of the shock. Moreover, the long-run impact of these shocks over the life-cycle
also depends on the initial condition. For example, Figure 7(e) shows a very slow recovery
from a negative earnings shock when starting from a high-earnings position, while graph
(a) shows a quicker recovery.
These earnings impulse responses on impact are in line with the shape of the persistence function shown in Figure 2(d). In Figure 7, moving from panel (a) to panel (c)
shows little difference in the impact of a shock, while moving to panel (e) shows a larger
impact. This is consistent with the persistence function ρt (ηit−1  τ) being steeper in τ for
high-income households who receive a large negative shock, compared to other households hit by such shock. Conversely, the earnings response is quite similar when moving
between panels (f) and (d), while it is higher in panel (b), again in line with the shape of
the persistence function.
In graphs (g) and (h) of Figure 7, we report results based on the “canonical model” of
earnings dynamics where η is a random walk; see equation (3). In this model, there are,
by assumption, no interaction effects between income shocks and the ranks of households
in the income distribution. The implications of the nonlinear earnings model thus differ
markedly from those of standard linear models.
In Figure 8, we report the results of a similar exercise to Figure 7, but we now focus
on consumption responses in a model without unobserved heterogeneity in consumption.
In order to simulate consumption paths, one needs to take a stand on the rule of assets
accumulation. We use the linear assets accumulation rule (7), with a constant (biennial)
interest rate r = 3%. In the simulation, we impose that ait ≥ 0. We observed little sensitivity to varying the floor on assets.
We see that the nonlinearities observed in the earnings response matter for consumption, too. For example, while a large negative shock (τshock = 010) is associated with a
2% drop in consumption for low-earnings households, it is associated with an 8% drop
for high-earnings households. Conversely, a large positive shock is associated with a 5%
increase in consumption for high-earnings households, and with an 11% increase for lowearnings households. In Figures S26 to S29 of the Supplemental Material, we report bootstrap confidence bands for earnings and consumption responses, which suggest that the
results are relatively precisely estimated. In addition, graphs (g) and (h) of Figure 8 report
results based on the canonical earnings model with a linear log-consumption rule.42 The
fact that the canonical model assumes away the presence of interaction effects between
income shocks and households’ positions in the income distribution appears at odds with
the data.
The results with unobserved heterogeneity in consumption are reported in Figure S30
of the Supplemental Material. They show smaller consumption responses to variations in
earnings compared to the case without unobserved heterogeneity. For example, a large
42
Specifically, cit is modeled as a linear function of ηit , εit , and an independent additive error term i.i.d. over
time. The model is estimated by equally-weighted minimum distance based on covariance restrictions.

EARNINGS AND CONSUMPTION DYNAMICS

721

FIGURE 8.—Impulse responses, consumption. Note: See notes to Figure 7. Graphs (a) to (f) correspond
to the nonlinear model. Graphs (g) and (h) correspond to the canonical model of earnings dynamics (3) and
a linear consumption rule. Linear assets accumulation rule (7), r = 3%. ait ≥ 0. Model without household
unobserved heterogeneity in consumption.

722

M. ARELLANO, R. BLUNDELL, AND S. BONHOMME

FIGURE 9.—Impulse responses by age and initial assets. Note: See notes to Figure 8. Initial assets at age
35 (for “young” households) or 51 (for “old” households) are at percentile 010 (dashed curves) and 090
(solid curves). Linear assets accumulation rule (7), r = 3%. ait ≥ 0. Model without household unobserved
heterogeneity in consumption.

positive shock (τshock = 090) is now associated with a 7% increase in consumption for
low-earnings households. In addition, effects on consumption seem to revert more quickly
towards the median in the model with heterogeneity.43
In Figure 9, we perform similar exercises, while varying the timing of shocks and the
asset holdings that households possess. Graphs (a) to (d) suggest that a negative shock
(τshock = 010) for high-earnings households has a higher impact on earnings at later ages:
the earnings drop is 40% when the shock hits at age 53, compared to 20% when a similar
shock hits at age 37. The impact of a positive shock on low-earnings individuals seems
to vary less with age. Graphs (e) to (h) in Figure 9 show the consumption responses in
the model without heterogeneity. The results suggest that, while the presence of asset
holdings does not seem to affect the insurability of positive earnings shocks, it does seem
to attenuate the consumption response to negative shocks, particularly for households
who are hit later in the life-cycle. Figure S33 of the Supplemental Material shows similar
patterns when allowing for unobserved heterogeneity.44
43
In Figures S31 and S32 of the Supplemental Material, we show the results from the nonlinear assets rule
we have estimated; see (11). The results do not differ markedly compared to the baseline specification.
44
The results for the estimated nonlinear assets rule reported in Figure S34 of the Supplemental Material
show some differences compared to Figure 9, particularly for the responses to positive earnings shocks.

EARNINGS AND CONSUMPTION DYNAMICS

723

7. CONCLUSION
In this paper, we have developed a nonlinear framework for modeling persistence that
sheds new light on the nonlinear transmission of income shocks and the nature of consumption insurance. In this framework, household income is the sum of a first-order
Markov persistent component and a transitory component. The consumption policy rule
is an age-dependent, nonlinear function of assets, unobserved heterogeneity, persistent
income, and transitory income. The model reveals asymmetric persistence patterns, where
“unusual” earnings shocks are associated with a drop in persistence. It also leads to new
empirical measures of partial insurance.
We provide conditions under which the model is nonparametrically identified, and we
develop a tractable simulation-based sequential quantile regression method for estimation. These methods open the way to identify and estimate nonlinear models of earnings
and consumption dynamics. They also provide new tools to assess the suitability of existing
life-cycle models of consumption and savings, and potentially help guide the development
of new structural models.
Our results suggest that nonlinear persistence and conditional skewness are important
features of earnings processes. These features, which are present in both the PSID and
the Norwegian population register data, are not easy to capture using existing models of
earnings dynamics, motivating the use of new econometric methods to document distributional dynamics. Estimating models that allow for persistent and transitory components
of income on a relatively homogeneous sample of households from the PSID, we find the
presence of nonlinear persistence and conditional asymmetries in earnings.
The nonlinearities observed in the earnings responses are shown to impact consumption choices. For example, we found that while a large negative shock is associated with
a relatively small drop in consumption for low-earnings households, it is associated with
a sizable drop for high-earnings households. We also identified differences in persistence
across different demographic groups. The results suggest that, while the presence of asset holdings seems not to affect the insurability of positive earnings shocks, it appears
to attenuate consumption responses to negative shocks, particularly for households who
are hit later in the life-cycle. Standard linear models, which assume away the presence
of interaction effects between income shocks and the position in the income distribution,
deliver qualitatively different predictions that appear at odds with the data.
A natural next step is to combine the framework introduced in this paper with more
structural approaches. It is in fact easy to take our estimated Markovian earnings components to simulate or estimate fully-specified life-cycle models of consumption and savings.
We provide an illustration of a simple life-cycle simulation model using the nonlinear dynamic quantile specification for earnings in Section S2 of the Supplemental Material.
Moreover, the nonlinear model can be generalized to allow for other states and choices.
For example, we could extend the analysis to incorporate intensive and extensive margins
of labor supply, as in Low, Meghir, and Pistaferri (2010), and family labor supply, as in
Blundell, Pistaferri, and Saporta-Eksten (2016).
Last, in this paper we have abstracted from the role of business-cycle fluctuations. In
a recent paper on U.S. Social Security Data for 1978–2010, Guvenen, Ozcan, and Song
(2014) found that the left-skewness of earnings shocks is countercyclical. In future work,
it will be interesting to apply our framework to document distributional dynamics over
the business-cycle.

724

M. ARELLANO, R. BLUNDELL, AND S. BONHOMME

APPENDIX A: IDENTIFICATION
A.1. Earnings Process
In the following, all conditional and marginal densities are assumed to be bounded away
from zero and infinity on their supports. With some abuse of notation, in the absence of
ambiguity we use f (a|b) as a generic notation for the conditional density fA|B (a|b), and
for simplicity we omit the i index in density arguments.
Operator Injectivity. The identification arguments below rely on the concept of operator
injectivity, which we now formally define. A linear operator L is a linear mapping from
a functional space H1 to another functional space H2 . L is injective if the only solution
h ∈ H1 to the equation Lh = 0 is h = 0.
One special case of operator injectivity (“deconvolution”)
obtains when Yi2 = Yi1 + i1 ,

with Yi1 independent of i1 , and [Lh](y2 ) = h(y1 )f1 (y2 − y1 ) dy1 . L is then injective
if the characteristic function of i1 has no zeros on the real line. The normal and many
other standard distributions satisfy this property.45 If the marginal distributions fY2 and f1
are
 known, injectivity implies that h = fY1 is the only solution to the functional equation
h(y1 )f1 (y2 − y1 ) dy1 = fY2 (y2 ). In other words, fY1 is identified from the knowledge of
fY2 and f1 .
Another, important special case of operator injectivity (“completeness”) is obtained
when L is the conditional expectation operator associated with the distribution of
(Yi1 |Yi2 ), in which case [Lh](y2 ) = E[h(Yi1 ) | Yi2 = y2 ]. L being injective is then equivalent to the distribution of (Yi1 |Yi2 ) being complete.
Building Block for Identification. To establish nonparametric identification of the earnings process, we rely on results from Hu and Schennach (2008) and Wilhelm (2015). In
the context of a panel data model with measurement error, Wilhelm (2015) provided conditions under which the marginal distribution of εi2 is identified, given three periods of
observations (yi1  yi2  yi3 ). We provide a brief summary of the identification argument used
by Wilhelm in Section S4 of the Supplemental Material.
The key condition that underlies identification in this context is the fact that, in the
earnings model with T = 3, log-earnings (yi1  yi2  yi3 ) are conditionally independent given
ηi2 .46 This “Hidden Markov” structure fits into the general setup considered in Hu and
Schennach (2008). Hu (2015) provided a recent survey of applications of this line of work.
Identification of the Earnings Process. Returning to the earnings dynamics model (1)–
(2), let now T ≥ 3. Suppose that the conditions in Wilhelm (2015) are satisfied on each
of the three-year subpanels t ∈ {1 2 3} to t ∈ {T − 2 T − 1 T }. It follows from Wilhelm’s
result that the marginal distributions of εit are identified for all t ∈ {2 3     T − 1}. By
serial independence of the ε’s, the joint distribution of (εi2  εi3      εiT −1 ) is thus also
identified.
Hence, if the characteristic functions of εit do not vanish on the real line, then by a
deconvolution argument, the joint distribution of (ηi2  ηi3      ηiT −1 ) is identified. As a
result, all Markov transitions fηt |ηt−1 are identified for t = 3     T − 1, and the marginal
distribution of ηi2 is identified as well (so we need T ≥ 4 to identify at least one Markov
transition). Moreover, it is easy to show that the conditional distributions of ηi2 |yi1 and
yiT |ηiT −1 are identified.47
45
Injectivity also holds if the zeros of the characteristic function of i1 are isolated. See Evdokimov and
White (2012).
46
Indeed, f (y1  y2  y3 |η2 ) = f (y1 |η2 )f (y2 |η2  y1 )f (y3 |η2  y2  y1 ) = f (y1 |η2 )f (y2 |η2 )f (y3 |η2 ).
47
Indeed, we have fy2 |y1 (y2 |y1 ) = fε2 (y2 − η2 )fη2 |y1 (η2 |y1 ) dη2 . Hence, since the characteristic function
of εi2 is non-vanishing, fη2 |y1 (·|y1 ) is identified for given y1 . A similar argument shows that fyT |ηT −1 (yT |·) is
identified for given yT .

EARNINGS AND CONSUMPTION DYNAMICS

725

Note that, in the case where εi1      εiT have the same marginal distribution, then the
distributions of the initial and terminal components εi1 , ηi1 , and εiT , ηiT are also identified. However, the first- and last-period distributions are generally not identified in a fully
non-stationary setting. In the empirical analysis, we impose time-stationarity restrictions,
and pool different cohorts of households together in order to identify the distributions of
η’s and ε’s at all ages.48
A.2. Consumption Rule With Unobserved Heterogeneity
We make the following assumption.
ASSUMPTION A.1:
(i) uit+s and εit+s , for all s ≥ 0, are independent of ati , ηit−1 , yit−1 , and ξi . εi1 is independent of ai1 , ηi1 , and ξi .
(ii) ait+1 is independent of (ait−1  cit−1  yit−1  ηit−1 ) conditional on (ait  cit  yit  ηit  ξi ).
(iii) The taste shifter νit in (19) is independent of ηi1 , (uis  εis ) for all s, νis for all s = t, ati ,
and ξi .
The identification strategy proceeds in two steps. First we have, by Assumption A.1(i)
and (iii), for all t ≥ 1,
f c t  at |y =
or, equivalently,

f c t  at |ηt  y t f ηt |y dηt 



f c t  at |y = E f c t  at |ηti  yit | yi = y 

where the expectation is taken for fixed (c t  at ). Let t = 3. f (c 3  a3 |η3  y 3 ) is thus identified, provided the distribution of (η3i |yi ) is boundedly complete in (yi4      yiT ). In particular, this argument requires that T ≥ 6.
For the second step, we note that, by Assumption A.1,
f c 3  a3 |η3  y 3 =

f (a1  c1  a2 |η1  y1  ξ)f (c2  a3 |a2  η2  y2  ξ)
× f (c3 |a3  η3  y3  ξ)f ξ|η3  y 3 dξ

(A.1)

For fixed (a3  η3  y 3 ), equation (A.1) is formally analogous to the nonlinear instrumental
variables setup of Hu and Schennach (2008). Hence the consumption rules, the asset
evolution distributions, and the distribution of the latent heterogeneous component ξi ,
will all be nonparametrically identified under the conditions of Hu and Schennach’s main
theorem. These conditions include injectivity/completeness conditions analogous to the
ones we have used in the baseline model, as well as a “scaling” condition. For example,
in a consumption model that is additive in νit (as in our empirical application), a possible
48
Specifically, the above arguments allow to nonparametrically recover, for each cohort entering the sample
at age j, the distributions of ε at ages j + 2, j + 4, j + 6, and j + 8 (based on biennial data). In our data set,
j belongs to {25     50}. Pooling across cohorts, we obtain that the distributions of ε are nonparametrically
identified at all ages between 27 and 58 years. In turn, the joint distribution of η’s is nonparametrically identified in this age range. Identification at ages 25, 26 and 59, 60 intuitively comes from parametric extrapolation
using the quantile models.

726

M. ARELLANO, R. BLUNDELL, AND S. BONHOMME

scaling condition (and the one we use) is that the mean of ci3 , conditional on ξi and some
values of (ai3  ηi3  yi3 ), is increasing in ξi . In that case, identification is to be understood
up to an increasing transformation of ξi .49 Consumption rules and asset distributions for
t ≥ 4 can then be identified by relying on additional periods or, alternatively, under timestationarity assumptions by pooling information from different cohorts.
APPENDIX B: ESTIMATION
B.1. Model’s Restrictions
Let ρτ (u) = u(τ − 1{u ≤ 0}) denote the “check” function of quantile regression
(Koenker and Bassett (1978)). Let also θ denote the true value of θ, and let
fi ηTi ; θ = f ηTi |yiT  ageTi ; θ
denote the posterior density of ηTi = (ηi1      ηiT ) given the earnings data. As the earnings model is fully specified, fi is a known function of θ.
We start by noting that, for all  ∈ {1     L},




T

E

aQ0      aQK = argmin

ρτ ηit −

Q
Q
(a0 aK ) t=2



K

aQk ϕk (ηit−1  ageit )
k=0

(B.1)



× fi ηTi ; θ dηTi 
where aQk denotes the true value of aQk = aQk (τ ), and the expectation is taken with respect
to the distribution of (yiT  ageTi ). To see that (B.1) holds, note that the objective function
is smooth (due to the presence of the integrals) and convex (because of the “check” function). The first-order conditions of (B.1) are satisfied at true parameter values as, by (21),
for all k ∈ {0     K},  ∈ {1     L}, and t ≥ 2,
 

K

E 1 ηit ≤



 t−1
T

a ϕk (ηit−1  ageit ) ηi  agei = τ 
Q
k

k=0

Likewise, we have, for all ,
ε
K

a a

= argmin

(aε0 aεK ) t=1





T
ε
0

E

ρτ yit − ηit −




K
ε
k

a ϕk (ageit )
k=0

(B.2)

× fi ηTi ; θ dηTi 

49
Arellano and Bonhomme (2016) applied Hu and Schennach’s (2008) results to a class of nonlinear panel
data models.

727

EARNINGS AND CONSUMPTION DYNAMICS

and, for all ,





η1
0

η1
K

a a

= argmin E
η

η1
k

ρτ ηi1 −

η

1)
(a01 aK





K

a ϕk (agei1 ) fi ηTi ; θ dηTi 

(B.3)

k=0

In addition to (B.1), (B.2), and (B.3), the model implies other restrictions on the tail
parameters λ, which are given in the next subsection. All the restrictions depend on the
posterior density fi . Given the use of piecewise-linear interpolating splines, the joint likelihood function of (ηTi  yiT |ageTi ; θ) is available in closed form, and we provide an explicit
expression in the next subsection. In practice, this means that it is easy to simulate from fi .
We take advantage of this feature in our estimation algorithm.
Turning to consumption, we have
 
2
K
T
g

g

E

α b1      bK = argmin

g
g
(αb1 bK ) t=1

g

cit − α −

bk ϕk (ait  ηit  yit − ηit  ageit )
k=1



× gi ηTi ; θ μ dηTi 
where
gi ηTi ; θ μ = f ηTi |ciT  aTi  yiT  ageTi ; θ μ
denotes the posterior density of (ηi1      ηiT ) given the earnings, consumption, and asset
data.
Moreover, the variance of taste shifters satisfies
 
2
T
K
g
1
2
σ =
E
cit − α −
bk ϕk (ait  ηit  yit − ηit  ageit )
T t=1
k=1
(B.4)

× gi ηTi ; θ μ dηTi 
Likewise, for assets we have
h

 

T

h

α  b1      bK = argmin
h

E

ait − αh

h
(αh bh
1 bK ) t=2

−



2

K
h
k

b ϕk (ait−1  cit−1  yit−1  ηit−1  ageit )

gi η ; θ μ dη
T
i

T
i



k=1

with a similar expression for the variance of bh0 (υit ) as in (B.4).
Last, we have, for all ,



K
a

a

b0      bK = argmin E
(ba0 baK )

ρτ ai1 −



b ϕk (ηi1  agei1 ) gi η ; θ μ dη
a
k

T
i

T
i



k=0

with additional restrictions characterizing tail parameters given in the next subsection.

728

M. ARELLANO, R. BLUNDELL, AND S. BONHOMME

B.2. Estimation Algorithm
Additional Model Restrictions. The tail parameters λ satisfy simple moment restrictions.
For example, we have


T

E
Q

λ− = −

t=2
K

 

T

E

ηit −

t=2





K



Q

T
ak1 ϕk (ηit−1  ageit ) fi ηT
i ; θ dηi

1 ηit ≤
k=0

 

Q
ak1 ϕk (ηit−1  ageit ) 1 ηit ≤

k=0



K



Q
T
ak1 ϕk (ηit−1  ageit ) fi ηT
i ; θ dηi

k=0

(B.5)
and


T

E
Q
λ+ =
T

 
E

t=2

t=2
K

ηit −





K



Q
T
akL ϕk (ηit−1  ageit ) fi ηT
i ; θ dηi

1 ηit ≥
k=0

 

Q
akL ϕk (ηit−1  ageit ) 1 ηit ≥

k=0

K





Q
T
akL ϕk (ηit−1  ageit ) fi ηT
i ; θ dηi

k=0

(B.6)
with similar equations for the other tail parameters.
Likelihood Function. The likelihood function is (omitting the conditioning on age for
conciseness)
f yiT  ciT  aTi  ηTi ; θ μ =

T


f (yit |ηit ; θ)

t=1

×

T


f (cit |ait  ηit  yit ; μ)

t=1
T


f (ait |ait−1  yit−1  cit−1  ηit−1 ; μ)

(B.7)

t=2

×

T


f (ηit |ηit−1 ; θ)f (ai1 |ηi1 ; μ)f (ηi1 ; θ)

t=2

The likelihood function is fully specified and available in closed form. For example, we
have




f (yit |ηit ; θ) = 1 yit − ηit < Aεit (1) τ1 λε− exp λε− yit − ηit − Aεit (1)
L−1

+
=1



1 Aεit () ≤ yit − ηit < Aεit ( + 1)

τ+1 − τ
A ( + 1) − Aεit ()
ε
it





+ 1 Aεit (L) ≤ yit − ηit (1 − τL )λε+ exp −λε+ yit − ηit − Aεit (L) 
K
where Aεit () ≡ k=0 aεk ϕk (ageit ) for all (i t ). Note that the likelihood function is nonnegative by construction. In particular, drawing from the posterior density of η automati-

729

EARNINGS AND CONSUMPTION DYNAMICS

cally produces rearrangement of the various quantile curves (Chernozhukov, FernándezVal, and Galichon (2010)).
Estimation Algorithm: Earnings. Start with 
θ(0) . Iterate on s = 0 1 2    the two following steps:
(m)
= (η(m)
Stochastic E-step: Draw M values η(m)
i
i1      ηiT ) from
θ(s) ∝
f ηTi |yiT ; 

T


f yit |ηit ; 
θ(s) f ηi1 ; 
θ(s)

T


t=1

f ηit |ηit−1 ; 
θ(s) 

t=2

where a ∝ b means that a and b are equal up to a proportionality factor independent of η.
M-step: Compute,50 for  = 1     L,
T

N


a

Q(s+1)
0

Q(s+1)
K

    
a

Q
Q
(a0 aK ) i=1


a

ε(s+1)
K

    
a


a

η1 (s+1)
K

    
a

T

a ϕk η(m)
it−1  ageit



(aε0 aεK ) i=1 t=1 m=1
M

= argmin



K

ρτ yit − η

(m)
it

−

ε
k

a ϕk (ageit ) 
k=0



K
(m)
i1

ρτ η

η



k=0

M

= argmin

η

Q
k

t=2 m=1

N
η1 (s+1)
0



K

ρτ η(m)
it −

= argmin
N

ε(s+1)
0



M

1)
(a01 aK
i=1 m=1



η1
k

−

a ϕk (agei1 ) 
k=0

and compute
T

N


λQ(s+1)
=−
−

M



Q(s+1)
1 η(m)
it ≤ Aitm

i=1 t=2 m=1
N

T

M
(m)
it

η


−A

Q(s+1)
itm



Q(s+1)
1 η(m)
it ≤ Aitm



i=1 t=2 m=1

where
Q(s+1)
≡
A
itm

K


aQ(s+1)
ϕk η(m)
it−1  ageit 
k1
k=0

η (s+1)
η (s+1)
with similar updating rules for 
λQ(s+1)
,
λε(s+1)
,
λε(s+1)
,
λ−1
, and 
λ+1
.
−
+
+
In practice, we start the algorithm with different choices for 
θ(0) . For example, for the
initial values of the quantile parameters in ηit , we run quantile regressions of log-earnings
on lagged log-earnings and age. We proceed similarly to set other starting parameter
values. We experimented with a number of other choices, and selected the parameter
values corresponding to the highest average log-likelihood over iterations. We observed
some effect of starting values on estimates of tail parameters, although most results were
stable.

50
In practice, we used gradient descent algorithms in all M-step computations. This provided the fastest
alternative in our repeated estimation, without any noticeable loss in accuracy.

730

M. ARELLANO, R. BLUNDELL, AND S. BONHOMME

Estimation Algorithm: Consumption. Similar to the earnings case. One difference is that
from
in the stochastic E-step we draw η(m)
i
f ηTi |yiT  ciT  aTi ; 
θ 
μ(s) ∝

T


f (yit |ηit ; 
θ)f (ηi1 ; 
θ)

t=1

T


f (ηit |ηit−1 ; 
θ)

t=2

× f ai1 |ηi1 ; 
μ(s)

T


f ait |ait−1  cit−1  yit−1  ηit−1 ; 
μ(s)

t=2

×

T


f cit |ait  ηit  yit ; 
μ(s) 

t=1

APPENDIX C: DATA APPENDIX
C.1. PSID Data
We use the 1999–2009 Panel Study of Income Dynamics (PSID) to estimate the model.
The PSID started in 1968 collecting information on a sample of roughly 5000 households.
Of these, about 3000 were representative of the U.S. population as a whole (the core
sample), and about 2000 were low-income families (the Census Bureau’s SEO sample).
Thereafter, both the original families and their split-offs (children of the original family
forming a family of their own) have been followed. The PSID data were collected annually until 1996 and biennially starting in 1997. A great advantage of PSID after 1999 is
that, in addition to income data and demographics, it collects data about detailed asset
holdings and consumption expenditures in each wave. To the best of our knowledge, this
makes the PSID the only representative large-scale U.S. panel to include income, hours,
consumption, and assets data. Since we need both consumption and assets data, we focus
on the 1999–2009 sample period.
We focus on non-SEO households with participating and married male household
heads aged between 25 and 60, and with non-missing information on key demographics
(age, education, and state of residence). To reduce the influence of measurement error,
we also drop observations with extremely high asset values (20 millions or more), as well
as observations with total transfers more than twice the size of total household earnings.
When calculating the relevant consumption, hourly wage, and earnings moments, we do
not use data displaying extreme “jumps” from one year to the next (most likely due to
measurement error). Furthermore, we do not use earnings and wage data when the implied hourly wage is below one-half the state minimum wage. See Blundell, Pistaferri, and
Saporta-Eksten (2016) for further details of the sample selection.
C.2. Norwegian Population Register Data
Sample Selection. The Norwegian results are provided as part of the Blundell, Graber,
and Mogstad project on “Labour Income Dynamics and the Insurance from Taxes, Transfers and the Family’; see Blundell, Graber, and Mogstad (2015) for details. For Figure 1,
we use Norwegian register data provided under that project for the years 2005 and 2006
only.
We select a balanced panel of households where the male head is Norwegian, resident
in Norway. We restrict the sample to include male, non-immigrant residents between the
age 30 and 60 and their spouse (if they have one), with non-missing information on all

731

EARNINGS AND CONSUMPTION DYNAMICS
TABLE C.I
DESCRIPTIVE STATISTICSa
1999

2001

2003

2005

2007

2009

Mean
10%
25%
50%
75%
90%

87,120
34,863
50,709
73,423
102,211
145,789

93,777
37,532
53,000
77,000
106,000
152,000

Earnings
96,289
36,278
52,975
76,576
105,292
150,280

98,475
35,005
54,696
78,944
109,391
154,971

103,442
35,533
53,813
80,292
113,604
171,688

102,893
31,992
52,451
79,181
112,607
163,879

Mean
10%
25%
50%
75%
90%

30,761
15,804
20,263
26,864
36,887
48,977

34,784
17,477
21,786
29,366
41,030
53,870

Consumption
37,553
43,199
18,026
20,365
22,834
26,322
31,924
37,381
45,071
51,529
62,864
73,338

44,511
21,634
28,341
38,704
53,239
73,715

40,598
20,008
26,167
34,570
47,300
67,012

Mean
10%
25%
50%
75%
90%

224,127
19,016
48,095
114,096
248,000
535,827

283,539
26,100
59,600
137,500
301,750
586,000

Net worth
311,664
387,830
28,494
38,287
69,397
83,137
159,230
191,663
345,549
413,955
654,437
830,462

447,323
41,854
101,005
217,599
489,224
939,583

406,290
33,592
85,179
188,354
384,625
867,786

a Balanced subsample from PSID, 1999–2009. N = 792, T = 6. In 2001 dollars.

key demographic variables. We choose a balanced panel of continuously married males,
where household disposable income (i.e., pooled labor income after tax and transfers
of the spouses) is above the threshold of substantial gainful activity (one basic amount,
14,000 USD in 2014) and where the total income from self-employment is below one basic
amount.
The residual income measure is obtained by regressing the log of household disposable
income on a set of demographics including cohort interacted with education category of
both spouses, dummies for children and region. Our measure of household disposable
income pools the individual disposable income of the spouses (if the male has a spouse).
In each year, we regress the log of household disposable income on dummies for region,
marital status, number of children, education, and a fourth-order polynomial in age and
the interaction of the latter two to obtain the residual income. To produce Figure 1, we
use an equidistant grid of 11 quantiles and a third-order Hermite polynomial.
REFERENCES
ABOWD, J., AND D. CARD (1989): “On the Covariance Structure of Earnings and Hours Changes,” Econometrica, 57 (2), 411–445. [694]
ALAN, S. (2012): “Do Disaster Expectations Explain Household Portfolios?” Quantitative Economics, 3, 1–28.
[704]
ALAN, S., M. BROWNING, AND M. EJRNAES (2014): “Income and Consumption: A Micro Semi-Structural
Analysis With Pervasive Heterogeneity,” Report, University of Essex. [694]
ANDREWS, D. (2011): “Examples of L2 -Complete and Boundedly-Complete Distributions,” Unpublished
Manuscript. [707]

732

M. ARELLANO, R. BLUNDELL, AND S. BONHOMME

ARELLANO, M., S. BONHOMME (2016): “Nonlinear Panel Data Estimation via Quantile Regressions,” Econometrics Journal, 19, C61–C94. [696,709-711,726]
ARELLANO, M., R. BLUNDELL, AND S. BONHOMME (2017): “Supplement to ‘Earnings and Consumption Dynamics: A Nonlinear Panel Data Framework’,” Econometrica Supplemental Material, 85, http://dx.doi.org/10.
3982/ECTA13795. [697]
BARRO, R. (2006): “Rare Disasters and Asset Markets in the Twentieth Century,” Quarterly Journal of Economics, 121 (3), 823–866. [695]
BELLONI, A., V. CHERNOZHUKOV, D. CHETVERIKOV, AND I. FERNÁNDEZ-VAL (2016): “Conditional Quantile
Processes Based on Series or Many Regressors,” Unpublished Manuscript. [711]
BLUNDELL, R. (2014): “Income Dynamics and Life-Cycle Inequality: Mechanisms and Controversies,” Economic Journal, 124 (2), 289–318. [693]
BLUNDELL, R., X. CHEN, AND D. KRISTENSEN (2007): “Semi-Nonparametric IV Estimation of ShapeInvariant Engel Curves,” Econometrica, 75 (6), 1613–1669. [705]
BLUNDELL, R., M. GRABER, AND M. MOGSTAD (2015): “Labor Income Dynamics and the Insurance From
Taxes, Transfers, and the Family,” Journal of Public Economics, 127, 58–73. [730]
BLUNDELL, R., L. PISTAFERRI, AND I. PRESTON (2008): “Consumption Inequality and Partial Insurance,”
American Economic Review, 98 (5), 1887–1921. [694,696,707]
BLUNDELL, R., L. PISTAFERRI, AND I. SAPORTA-EKSTEN (2016): “Consumption Smoothing and Family Labor
Supply,” American Economic Review, 106 (2), 387–435. [696,712,723,730]
BONHOMME, S., AND J. M. ROBIN (2010): “Generalized Nonparametric Deconvolution With an Application
to Earnings Dynamics,” Review of Economic Studies, 77 (2), 491–533. [697,714]
BOTOSARU, I., AND Y. SASAKI (2015): “Nonparametric Heteroskedasticity in Persistent Panel Processes: An
Application to Earnings Dynamics,” Unpublished Manuscript. [695]
BOUND, J., C. BROWN, AND N. MATHIOWETZ (2001): “Measurement Error in Survey Data,” in Handbook of
Econometrics, Vol. 5, ed. by J. Heckman and E. Leamer. Amsterdam: North-Holland. [698]
BROWNING, M., M. EJRNAES, AND J. ALVAREZ (2010): “Modelling Income Processes With Lots of Heterogeneity,” Review of Economic Studies, 77 (4), 1353–1381. [697]
CASTAÑEDA, A., J. DÍAZ-GIMÉNEZ, AND J. V. RÍOS-RULL (2003): “Accounting for the U.S. Earnings and
Wealth Inequality,” Journal of Political Economy, 111 (4), 818–857. [695]
CELEUX, G., AND J. DIEBOLT (1993): “Asymptotic Properties of a Stochastic EM Algorithm for Estimating
Mixing Proportions,” Communications in Statistics. Stochastic Models, 9, 599–613. [710]
CHERNOZHUKOV, V., I. FERNÁNDEZ-VAL, AND A. GALICHON (2010): “Quantile and Probability Curves Without Crossing,” Econometrica, 78 (3), 1093–1125. [729]
CONSTANDINIDES, G., AND A. GOSH (2017): “Asset Pricing With Countercyclical Household Consumption
Risk,” Journal of Finance, 72 (1), 415–460. [695]
DEATON, A., AND C. PAXSON (1994): “Intertemporal Choice and Inequality,” Journal of Political Economy, 102
(3), 437–467. [693]
DEMPSTER, A. P., N. M. LAIRD, AND D. B. RUBIN (1977): “Maximum Likelihood From Incomplete Data via
the EM Algorithm,” Journal of the Royal Statistical Society, Series B, 39, 1–38. [710]
D’HAULTFOEUILLE, X. (2011): “On the Completeness Condition for Nonparametric Instrumental Problems,”
Econometric Theory, 27, 460–471. [707]
EVANS, M., AND P. WACHTEL (1993): “Inflation Regimes and the Sources of Inflation Uncertainty,” Journal of
Money, Credit, and Banking, 25, 475–511. [697]
EVDOKIMOV, K., AND H. WHITE (2012): “Some Extensions of a Lemma of Kotlarski,” Econometric Theory, 4,
925–932. [724]
GALLANT, A. R., P. E. ROSSI, AND G. TAUCHEN (1993): “Nonlinear Dynamic Structures,” Econometrica, 61
(4), 871–907. [718]
GEWEKE, J., AND M. KEANE (2000): “An Empirical Analysis of Earnings Dynamics Among Men in the PSID:
1968–1989,” Journal of Econometrics, 96 (2), 293–356. [697]
GOLOSOV, M., AND A. TSYVINSKI (2015): “Policy Implications of Dynamic Public Finance,” Annual Reviews
of Economics, 7, 147–171. [693]
GOLOSOV, M., M. TROSHKIN, AND A. TSYVINSKI (2016): “Redistribution and Social Insurance,” American
Economic Review, 106 (2), 359–386. [693,694]
GOURINCHAS, P. O., AND J. A. PARKER (2002): “Consumption Over the Life Cycle,” Econometrica, 70, 47–91.
[694]
GUVENEN, F., AND A. SMITH (2014): “Inferring Labor Income Risk From Economic Choices: An Indirect
Inference Approach,” Econometrica, 82 (6), 2085–2129. [694]
GUVENEN, F., F. KARAHAN, S. OZCAN, AND J. SONG (2015): “What Do Data on Millions of U.S. Workers
Reveal About Life-Cycle Earnings Risk?” Report, University of Minnesota. [697,715]

EARNINGS AND CONSUMPTION DYNAMICS

733

GUVENEN, F., S. OZCAN, AND J. SONG (2014): “The Nature of Countercyclical Income Risk,” Journal of Political Economy, 122 (3), 621–660. [697,723]
HALL, R., AND F. MISHKIN (1982): “The Sensitivity of Consumption to Transitory Income: Estimates From
Panel Data of Households,” Econometrica, 50 (2), 261–281. [694,707]
HEATHCOTE, J., K. STORESLETTEN, AND G. VIOLANTE (2014): “Consumption and Labor Supply With Partial
Insurance: An Analytical Framework,” American Economic Review, 104 (7), 2075–2126. [694]
HOROWITZ, J. L., AND M. MARKATOU (1996): “Semiparametric Estimation of Regression Models for Panel
Data,” Review of Economic Studies, 63, 145–168. [714]
HU, Y. (2015): “Microeconomic Models With Latent Variables: Applications of Measurement Error Models
in Empirical Industrial Organization and Labor Economics,” Technical Report, Cemmap Working Paper
CWP03/15. [724]
HU, Y., AND S. M. SCHENNACH (2008): “Instrumental Variable Treatment of Nonclassical Measurement Error
Models,” Econometrica, 76, 195–216. [696,704,707,724-726]
HU, Y., AND J.-L. SHIU (2012): “Nonparametric Identification Using Instrumental Variables: Sufficient Conditions for Completeness,” Unpublished Manuscript. [707]
HU, Y., AND M. SHUM (2012): “Nonparametric Identification of Dynamic Models With Unobserved State
Variables,” Journal of Econometrics, 171, 32–44. [697,704]
HUCKFELDT, C. (2016): “Understanding the Scarring Effect of Recessions,” Report, Economics Department,
Cornell University. [695]
HUGGETT, M. (1993): “The Risk-Free Rate in Heterogeneous-Agent Incomplete-Insurance Economies,” Journal of Economic Dynamics and Control, 17, 953–969. [695]
JAPPELLI, T., AND L. PISTAFERRI (2010): “The Consumption Response to Income Changes,” Annual Reviews
in Economics, 2, 479–506. [693]
KAPLAN, G., AND G. VIOLANTE (2010): “How Much Consumption Insurance Beyond Self-Insurance,” American Economic Journal, 2 (4), 53–87. [694]
(2014): “A Model of the Consumption Response to Fiscal Stimulus Payments,” Econometrica, 82 (4),
1199–1239. [694,704]
KIM, T. H., AND H. WHITE (2004): “On More Robust Estimation of Skewness and Kurtosis,” Finance Research
Letters, 1, 56–73. [699]
KOENKER, R., AND G. J. BASSETT (1978): “Regression Quantiles,” Econometrica, 46, 33–50. [726]
KOENKER, R., AND Z. XIAO (2006): “Quantile Autoregression,” Journal of the American Statistical Association,
101 (475), 980–990. [699]
KOOP, G., M. H. PESARAN, AND S. M. POTTER (1996): “Impulse Response Analysis in Nonlinear Multivariate
Models,” Journal of Econometrics, 74 (1), 119–147. [718]
KRUEGER, D., K. MITMAN, AND F. PERRI (2015): “Macroeconomics and Heterogeneity, Including Inequality,”
Unpublished Manuscript. [707]
KRUSELL, P., AND A. SMITH (1998): “Income and Wealth Heterogeneity in the Macroeconomy,” Journal of
Political Economy, 106, 867–896. [707]
LISE, J. (2013): “On-the-Job Search and Precautionary Savings,” Review of Economic Studies, 80 (3), 1086–
1113. [695]
LOCHNER, L., AND Y. SHIN (2014): “Understanding Earnings Dynamics: Identifying and Estimating the
Changing Roles of Unobserved Ability, Permanent and Transitory Shocks,” Unpublished Manuscript. [696]
LOW, H. L., C. MEGHIR, AND L. PISTAFERRI (2010): “Wage Risk and Employment Risk Over the Life-Cycle,”
American Economic Review, 100, 1432–1467. [723]
MEGHIR, C., AND L. PISTAFERRI (2004): “Income Variance Dynamics and Heterogeneity,” Econometrica, 72
(1), 1–32. [695,715]
(2011): “Earnings, Consumption and Life Cycle Choices,” in Handbook of Labor Economics, Vol. 4B.
Amsterdam: Elsevier, 773–854. [694]
MISRA, K., AND P. SURICO (2014): “Consumption, Income Changes, and Heterogeneity: Evidence From Two
Fiscal Stimulus Programs,” American Economic Journal: Macroeconomics, 6 (4), 84–106. [696]
NEWEY, W., AND J. POWELL (2003): “Instrumental Variable Estimation of Nonparametric Models,” Econometrica, 71 (5), 1565–1578. [704]
NIELSEN, S. F. (2000): “The Stochastic EM Algorithm: Estimation and Asymptotic Results,” Bernoulli, 6 (3),
457–489. [711]
RIETZ, T. (1988): “The Equity Risk Premium: A Solution,” Journal of Monetary Economics, 22 (1), 117–131.
[695]
SCHMIDT, L. (2015): “Climbing and Falling off the Ladder: Asset Pricing Implications of Labor Market Event
Risk,” Unpublished Manuscript. [695]

734

M. ARELLANO, R. BLUNDELL, AND S. BONHOMME

TERÄSVIRTA, T. (1994): “Specification, Estimation, and Evaluation of Smooth Transition Autoregressive Models,” Journal of the American Statistical Association, 89, 208–218. [697]
WEI, Y., AND R. J. CARROLL (2009): “Quantile Regression With Measurement Error,” Journal of the American
Statistical Association, 104, 1129–1143. [696,709]
WILHELM, D. (2015): “Identification and Estimation of Nonparametric Panel Data Regressions With Measurement Error,” Cemmap Working Paper CWP34/15. [696,704,724]

CEMFI, Casado del Alisal, 5, Madrid 28014, Spain; arellano@cemfi.es,
University College London, Gower Street, London WC1E 6BT, U.K. and Institute for Fiscal
Studies, 7 Ridgmount Street, London WC1E 7AE, U.K.; r.blundell@ucl.ac.uk,
and
Dept. of Economics, University of Chicago, 1126 East 59th Street, Chicago, IL 60637,
U.S.A.; sbonhomme@uchicago.edu.
Co-editor Giovanni L. Violante handled this manuscript, which is based on a Presidential Address.
Manuscript received 8 September, 2015; final version accepted 30 January, 2017; available
online 2 February, 2017.

