Understanding Instrumental Variables in Models with Essential Heterogeneity Author(s): James J. Heckman, Sergio Urzua and Edward Vytlacil Source: The Review of Economics and Statistics, Vol. 88, No. 3 (Aug., 2006), pp. 389-432 Published by: The MIT Press Stable URL: https://www.jstor.org/stable/40043006 Accessed: 17-10-2019 16:02 UTC
JSTOR is a not-for-profit service that helps scholars, researchers, and students discover, use, and build upon a wide range of content in a trusted digital archive. We use information technology and tools to increase productivity and facilitate new forms of scholarship. For more information about JSTOR, please contact support@jstor.org. Your use of the JSTOR archive indicates your acceptance of the Terms & Conditions of Use, available at https://about.jstor.org/terms
The MIT Press is collaborating with JSTOR to digitize, preserve and extend access to The Review of Economics and Statistics
This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

The Review of Economics and Statistics
Vol. LXXXVIII August 2006 Number 3

UNDERSTANDING INSTRUMENTAL VARIABLES IN MODELS WITH ESSENTIAL HETEROGENEITY
James J. Heckman, Sergio Urzua, and Edward Vytlacil*

Abstract - This paper exapom se Yi\ n inte o is ts mteah n ge ivenpXr , \o lx p (X)e , ar ndtitis e des viatio onffrominstr r (Ie V s)po ap np se lised totionm ter od ve en lstiw on it thsh e maeae r n,s eUsx.e h Wn e e ct t aniem aralko e h g a sie e mn t ilae redr o eco ou mg s poe sia tn ion nefd iortYy ao:g ,et nh ta s
(participate in programs) with at least partial knowledg
cratic response. We analyYzxe= fJtLw ,(X)o + - Uuoutcome and multipl
yo = (iOW + i/o. (1) including ordered and unordered choice models. We all
specific and general instruments. We generalize pre developing weights for treatment effects for genera
develop a simple test for Ittm hae y hp apr peenstehn at c coento rof lline g sfs oretn hetXia , Ylx h - Yeotie s r t the asymmetry of the model of essential heterogen choices are heterogeneou fosr ailn l couantg riees.nTe hir s iaslthw e caasy e o;f hcoh mo ogiec nee ouss tarr e choices and outcomes areefp feectr s m givientt X.eMdoretlo ikeb lye , cosuy ntrm iesm vare ytinrtihcea irlr
the method of IV breaks td o o thw e pn olicf y o evreneafstt erim conatrtoilln ing g fotrrXe. atmen

Figure 1 plots the distribution of Yx - Yo for a benc

I. Introduction

X. We explain the various parameters mentioned figure later on. The special case of homogeneity arise

the distribution collapses to its mean. It would be ide

SItUPhPaOsSbEeaenpotlirciyedis ipnrooptohsedr fcoorunadtorpiteisonanind awceouknntoryw. could estimate the distribution of Yx - Yo given X, a

outcomes there. We also know outcomes in countries where has sometimes been done.1 More often, economists f

it was not adopted. From the historical record, what can wseome mean of the distribution displayed in Figure 1

conclude about the likely effectiveness of the policy ian regression framework to interpret the data. To tur

countries that have not implemented it?

tion (1) into a regression model, it is conventional

To answer this question, we build a model of counterfac-switching regression framework. Define D = 1 if a co

tuals. Let Yo be the outcome (for example, the GDP) of aadopts a policy; D = 0 if it does not. The observed out

country under a no-policy regime. Yx is the outcome if theY, is Y = DYX + (1 - D)Y0. Substituting equation ( policy is implemented. Yx - Yo is the treatment effect of thtehis expression, and keeping all X implicit, we obt

policy. It may vary among countries. We observe character- Y=Y0+(Yl-Y0)D

istics X of various countries (level of democracy, level of

(2)

population literacy, and so on). It is convenient to decom- = fx0 + (»ii - |x0 + J7, - U0)D + Uo.

Received for publication December 20, 2004. Revision accepted Ufosring conventional regression notation,

publication January 26, 2006.

*University of Chicago, University College Dublin, and the American Y=a + pD + e, (3)
Bar Foundation; University of Chicago; and Columbia University, respec-

tively.
This project was supported by NSF grants 0241858, 0099195, and 9709873; NIH grant R01-HD04341 1; and a grant from the American Bar

where a = jjl0, (3 = (Yx £ = Uo. The coefficient

Foundation. An early version of this paper was presented as the Review of Economics and Statistics Lecture at Harvard, April 2001; at Princeton University, December 2004; at a workshop on Causality in Economics,

case where (3 is the sam conventionally assumed

Oxford University, August 2005; and at the World Congress of the

that (3 depends on X and

Econometric Society, August 2005. We thank audience participants at those seminars as well as students in Economics 350 at the University of Chicago in Winter Quarter 2005 for stimulating comments, and our

The case where (3 varies called the random-coeffi

discussants at the 2001 seminar, Larry Katz and Robert Moffitt, for helpful

effect case. A great deal of

comments. We have received additional helpful comments from the editor, Jim Stock, and an anonymous referee. Bo Honore, Derek Neal, Weera-

case in recent decades.

chart Kilenthong, Sergey Mityakov, Rodrigo Pinto, Jean-Marc Robin, and

Jora Stixrud provided helpful comments on various drafts. Supplementary

1 See Carneiro, Hansen, and Heckman (2001, 2003), Cunha, Heckman,

material for this paper is available at the Web site jenni.uchicago.edu/
underiv.

and Navarro (2005, 2006), and the survey in Heckman, Lochner, and Todd (2006).

The Review of Economics and Statistics, August 2006, 88(3): 389^32 © 2006 by the President and Fellows of Harvard College and the Massachusetts Institute of Technology

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

390 THE REVIEW OF ECONOMICS AND STATISTICS

Figure 1. - Distribution of Gains: The Roy Economy
The Model Outcomes Choice Model

D = 0) is possibly subject to a selection bias. Countries that adopt the policy may be atypical in their Yo (= a + e). Thus, if the countries that would have done well in terms of
unobservable 8 (= Uo) even in the absence of the policy are the ones that adopt the policy, then (3 estimated from OLS (or its nonparametric version - matching) is upward biased because Cov(D, e) > 0.
Two main approaches have been adopted to solve this problem: (a) selection models (Gronau, 1974; Heckman, 1974, 1976a,b, 1979; Heckman and Robb, 1985, 1986; Powell, 1994) and (b) instrumental variable models (Heckman and Robb, 1985, 1986; Imbens and Angrist, 1994; Angrist and Imbens, 1995; Manski and Pepper, 2000; Heckman and Vytlacil, 1999, 2000, 2005).2 This paper focuses on the instrumental variable (IV) approach and establishes the relationship between the selection and the IV approach using a prototypical economic model. The selection approach models levels of conditional means. The IV approach models the slopes of the conditional means. IV does not identify the constants estimated in selection models. In the general case with heterogeneity, when IV is used to identify the same level parameters that are identified by control function or selection methods, it is necessary to make the same assumptions about levels outcomes in limit sets ("identification at infinity")
as are made in selection models.
For the case with homogeneous responses, if there is an instrument Z with the properties that
Cov(Z,D) * 0, (4)

Cov(Z,£) = 0, (5)

Yo = no + Uo = a + Uo

then standard IV identifi

General Case

Cov(Z,y)

(Ui -U0)XD ATE ^TT^ TUT

plim &v = cM^j = p'

If other instruments exist, each identifies (3. The instrument

The Researcher Observes (Y, £>, C)

Z produces a controlled variation in D relative to e. Randomization of assignment with full compliance with exper-

Y = a + (3D + Uo where p = Y1-Y0

imental protocols is an example of an instrument. From the instrumental variable estimator, we can identify the effect of

adopting the policy in any country, since all countries

Parameterization

2 Matching is also used. It is a form of nonparametric least squares that

a = 0.67 (l/i,tfo)~JV(O,E) £>* = Yi - YQ - C

assumes that all relevant unobservables are accurately proxied by the

observables X that the analyst happens to have at his or her disposal, so

0 = 0.2 S = [_J9 -J-9] C=1.5

(Y0,Yl)JLD\X (alternatively, (e, p) JL D \ X), where A _IL B \ C means that A is independent of B given C. See Heckman and Navarro (2004) for

a discussion of matching.

3 The proof is straightforward. Under general conditions (see, tor exam-

ple, White, 1984),
The case where (3 (given X) is the same for every country

is the familiar one, and we develop it first. A least squares

Cov(Z,e)

regression of Y on D (equivalently, a mean difference in pHmPlv = P + Co^D)'

outcomes between countries with D = 1 and countries with and the second term on the right-hand side vanishes.

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

MODELS WITH ESSENTIAL HETEROGENEITY 391

respond to the policy in the slaa mteio wn ay. , H coo nw tre olv lie ng r,fotrhis rul

their X.

metric strategy for iden

If (3 (= Y\ - y0) varies in th tere paot pm ulaetn iotn p ev aernam afe tetrers.
controlling for X, then the respon It iss eresmah rkaabv le ethenathdatiusntderr icebrtuaintcioondnitiotnshImabtens

cannot in general be summarized and bAnygrisat (1s9i9n 4) g estlaeblisn h tuham t inbteherm. odEelvweitn h essential

if we are interested in the mean heteorofgenteih tyestadndiasrdtIrVicbanuidtenitoifny ,an aintn erperw etable pa-

phenomenon distinct from selecratmieoten r. Tb heipaarsamm eterigthh eytideanr tifiysies .a dTischreitse apipsroxi-

the problem of sorting on the gmaatiionn ,to w thehmiacrghinaligsaindpiasratmien tercitntrfodrucoedm by Bjork-

sorting on the level. If (5 varieslunedvanednMoafffittt e(19r87)c. Tohn osetarutoholrlsidnemgonsftroatre how to

X, there may be sorting on thuese agsaeliecntion(C mo odvel(t(o3id,enDtif)y =th£e m0ar)g.inT al h gaiinsto is the model of essential heterpeorsg ones n indeuictedyin.to a treatment status by a marginal

The application of instrumenchtaangle iv n athre cioastbolfetrseattmoent.tImhbienss acndaAsnegriists(1994)

more problematic. Suppose thashtowwhoew taouidgenm tifyen a dtiscrteh te eappsrtoxaimnatdioanrtodthis

instrumental variable assumptpairoamnetser u(s4in)g IaV.nd (5) by the fol-

lowing assumption:

They assume the existence of an instrument Z that takes

two or more distinct values. This is implicit in equation (4). If
Cov(Z,(3) = 0. (6) Z assumed only one value, the covariance would be 0.

Strengthening the covariance conditions of equations (5) and

Can we identify the (6)m , theyeasa sumn e thatoZ f is indY epen\ dent o-f (3 (Y = Yxo- You ) ans d Jio-ng IV

we cannot.4

Let JL denote independence. Denote by D(z) the random

To see why, let (3 = jjvalriiable-indi|cx atin0 g recb eipe t of t treh atmeent m wheneZ a is n set tot z. reatm (the mean of the distr (D(zi) b = 1u if t trieao tmn ent isirn eceivef d; iD(g z) =u0 r otheerw1 ise.)) .TheThen

where U\ - Uo = t|. ImW bens- r Angirt ist e indepe endq encu e asa sumtptiioo n cn an be w(r3 itte)n asin ter

parameter:

IV-1: ZJL (Y0,Yh{D(z)}zsz) (Independence)

y=a + J3D + (e +wheT re Z|isD the)se.t of possible values of Z.

The error term of th Theyis also ae ssuq meutha at tion (e + r\D) co

components. By assumption, Z is uncorrelated w But to identify (3, we IVn -2:ePre (Dd = 1 \Zt) h depe endsIoV n Z (Rt ano k). be uncorre

e+ If

r p|o Dl.ic Ty haatdr oepqtuiiorn eTssthaiinsds Z iasrda IsVm ttaanso dsaura mdpb d rtiaone ne kwciotu nhw dwin thioaintc .t tTho heh yeyr caso lr ul papu e "lm emlt oneanottt ok tnhe ice-n d ow wi

(= U\ - Uo), the idiosy ityn " ac ssur ma ptt ioni. c It isg a caonidn itiontaco rossp perosolnis.c Thy is ado

controlling for the obasssue mpr tiov n maaib ntaline s tsha,t ift Z h is fie xen d first t a|t onae n andd thenD are

independent and hence at thu e on thec r oof r twr o de istlina cttvae lued s, ,Z = a z an nd d Z = zI', V then ident

however, policy adoption is made with partial o

all persons respond to the change in Z in the same way. In

edge of T|, then IV does not identify (3, because E(i)\D = 1, Z) Pr(D = oulr|pZ olic)y ada optn iond exampilef , it stsateo s tr hatta mion vemg ent fo romn th

gain T] occurs, the fir z ts o zt' caut sesear ll cm ountrieissto mn ovo e tt owar0 d (.or aS gaiinm st) ilar c

show that IV does notadopitid on e of n thetpoilicf y by eing t stuh diede . If sm ome e adoa ptn , otheg rs ain to

s tu rm iem s atrh yat traed at om pt entthp de oManoor trp edarfoo om prmtlhaeie llpyc ot ,liy lce eyttr iinns gr(esDE .p{6 o(zn()seb$W etot\ htheh eD insade micet a= tcohh ran(g=e 1 e.1r )if)

or
r\(=

correlated with D depae don ptedd ; =s0 ifonon t) fortah dope tion q ofu a pa olilcyit if y Z = z o forf the

able to the empiricacoluntre y ic , to henn foroanm y distiins ct t val, ues zaann d z\d Imbencs aandnnot Angrist (1994) assume
priori. The conservative position is to allow for

IV-3: Dt(z) > Diz') for all i or Dt(z) < D,(z') for all /,

4 This point was made by Heckman and Robb (1985, 1986). See also

Heckman (1997).

/ = 1, . . . , / (Monotonicity or Uniformity).

5 Proof:

A _ Cov(Z,£ + T\D) plimfrv A = P+ _ Var(DZ) .

The content in this assumption is not in the order for any person. Rather, the responses have to be uniform across

But Cov(Z,e + T\D) = Cov(Z,e) + Cov(Z,j\D) and Cov(Z,t)D) = people for a given choice of z and z'. One possibility

E{Zy\D) - E(Z) E(t)D), E(t)D) = 0, by the assumed independence. Alsaollowed under IV-3 is the existence of three values z<z' <

E(Zr\D) = E(t)) E(ZD) by the assumed E(Zt)D) = 0, because £(-n) = 0.

independence,

and

hence

z"

such

that,

for

all

i,

D{(z)

^

Diz')

but

Diz')

<

Dt(z").

The

6 See Heckman and Robb (1985, 1986), Heckman (1997), or Heckmanstandard usage of the term monotonicity rules out this

and Vytlacil (1999).

possibility by requiring that one of the following hold for all

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

392 THE REVIEW OF ECONOMICS AND STATISTICS

i: (a) z < z' componentwise imPrp(Dl(zi')e) =s0.7DItti(sza)lso^notAth(eze'f)feoctrof ftrlea>tm ) ent on the

z < z1 componentwise implies D tr,e{atze)d ^(E(YDXt-(zY'o).\ O D f= 1c) =ou £(r(3s|De=, 1i))funless the

the Di(z) are monotonic in the ansatlyastnhdasaacrcedss tuo sanadguese,s otnehoer y moraervaelues of z such

monotonic in the sense of Imbensthaatn Prd (D(zA ) =n1g ) =r1i.st.

For any value of zf in the domainLAoTfE ddepeefnidn s ointitohenpaortficuZla,r ifnr storum ment used.8 The

IV-1 and IV-2 and the definitiopan ramoetfer D is (dzef),ine(dYboy ,a hYypuothDet(izca'l))mainsipulation of

independent of Z For any two vailnustersumoenfts.tIh f emoinnotsotnirciutym(ueninfotrmZity=) is violated, IV

z and Z = z\ we may write

estimates an average response of those induced to switch

E(Y\Z = z)-E(Y\Z = z')

into the program and those induced to switch out of the program by the change in the instrument, because both

=

E(Y0

+

D(Yl-Y0)\Z

=

z)terIm f sthine

(7) are present.9 analyst is interested

in

knowing

the

average

re-

-E(Y0 + D(Yl-Y0)\Z =spzonfse)(P), the effect of the policy on the outcomes of
countries that adopt it (£((3 \ D = 1)) or the effect of the

= E(D(YX - Y0)\Z = z)

policy if a particular country adopts it, there is no guarantee

that the IV estimator comes any closer to the desired target
-E(D(Yl-Y0)\Z = z'). than the OLS estimator, and indeed, it may be more biased

than OLS. Because different instruments define different From the independence conditiopn aram(eItV ers-,1ha)viangnadweatlthh eof d difefferiennt isttrioongninstruments
of D(z) and D{z'), we may writedoteh s niost iemxpp rorveetshseiporn ecisiaosn oEf (t{hYe X estim-ate of any Jo) [D(z) ~ D(z')]). Using the lawparotifculairtpearraamteetedr. Tehxispiseinctstaartkiocon ntsr,ast with the
we have
traditional model with (3 _IL D. In that case, all valid

E(Y\Z = z)-E(Y\Z = zf)

instruments identify (3. The Durbin (1954)-Wu (1973)Hausman (1978) test for the validity of extra instruments

= E(YX - Y0\D(z) - D(z') = 1)

applies to the traditional model. In the more general case with essential heterogeneity, because different instruments

X Pr(D(z) - D(z') = 1) (7)

estimate different parameters, no clear inference emerges from these specification tests.

- E(YX - Y0\D(z) - D(z') = W-he1n )dealing with more than two distinct values of Z,
Imbens and Angrist (1994) draw on the analysis of Yitzhaki

X Pr(D(z) - D(z') = ~ 1).

(1989), which was refined in Yitzhaki (1996) and Yitzhaki and Schechtman (2004), to produce a weighted average of

By the monotonicity condition (IV-3), we eliminate onepairwise LATE parameters where the scalar Zs are ordered

or the other term in this final expression. Suppose thatto define the LATE parameter. In this case IV is a weighted

Pr(D(z) - D(z') = -1) = 0; then

average of LATE parameters with nonnegative weights.10

Imbens and Angrist generalize this result to the case of

E(Y\Z = z)-E(Y\Z = zf)

vector Z, assuming that instruments are monotonic func-

= E{YX - Y0\D(z) ~ D(z') = 1) XPr(D(z)-D(z')=0.

tions of the probability of selection. This paper and our previous analysis build on the pio-
neering work of Yitzhaki and of Imbens and Angrist.11 We make the following contributions to this literature:

Dividing by Pr(D(z) - D{z') = 1) = Pr(D = 1 | Z = z) -

Pr(D = 1 | Z = z') for values of z and z1 tha7 tSucphrvoaludeus ocfeZ produce "identification at infinity," or, more accu-

distinct

propensity

scores,

we

obtain

the

lorca8atelDlyeap,evlniemdreintacgpeoeoirnttshwe hesetriemPa(nzd) s=

1 and on the

P(z') = 0. choices or

IV

used

to

estimate

treatment effect,

models with essential heterogeneity was first noted in Heckman and Robb

(1985, 1986).

E(Y\Z = z)~ E(Y\Z = z')

9 Angrist, Imbens, and Rubin (1996) consider the case or two-way flows for the special case of a scalar instrument when the monotonicity assump-

LATE - pr(D =l^z = z)_ pr(D = j|Z = z>) ^ tion is violated. Their analysis is a version of Yitzhaki's (1989, 1996) analysis. He analyzes the net effect, whereas they break the net effect into

= E(Yl-Y0\D(z)-D(z') = l).

two components corresponding to the two-way flows. IU We have placed Yitzhakrs (iy»y) unpublisned paper on our weo site
and summarize his essential ideas in section III B and appendix C. He

This is the mean gain to those induced to switch from 0 toshows that two-stage least squares estimators of Y on P(Z) = E(D | Z)

1 by a change in Z from z' to z.

identify weighted averages of terms like the second terms in equation (8) with positive weights. See also Yitzhaki (1996) and Yitzhaki and Schecht-

This is not the mean of Yx - Yo (average treatment effectm) an (2004).

unless Z assumes values (z, z') such that Pr(D(z)) = 1 and11 See Heckman and Vytlacil (1999, 2001c, 2005).

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

MODELS WITH ESSENTIAL HETEROGENEITY 393

1 . We relate the LATE-IV apprwoiallicnghnests-oto-peacy opan raomm eteriscor canhswoeirscteo well-

models. Using a choice-theoreticdefp ineadrchaom ice eprtobelerms.(tWh e peresm entaanre-conomically

ginal treatment effect, or MTinEter)prien tabtlerdeocodmpuosciteiod n ofisn tantdo ard tIVhineto willing-

literature on selection models bny ess-tBo-jpoayrcokmlpu onn entds foarn ped rsonM s atowfel-l-defined mar-

fitt (1987), it is possible to ggeinn s oef r chaoicte.eWeaslhlowthorwetoaitdem ntifeynthtese compo-

effects as different weightedneantvs ferr omadgatea sandohofw tM o coT nsE trucot trhe woef ights. We

LATE. Standard linear IV can ainltsrooducebteransiitniont-espr ecipficriensttreumdentas.sWeageneralize

weighted average of MTE or thLisA anT alyE sis.toUansuinn ordgeredtch hoeice meocdeol.-

nomic model, MTE is a limit form of LATE, and

7. We show the fundamental asymmetry in the recent IV

LATE in turn is a discrete approximation to MTE,

literature for models with heterogeneous outcomes.

which is the marginal gain function of Bjorklund and Moffitt (1987). A local version of instrumental vari-

Responses to treatment are permitted to be heteroge-
neous in a general way. Responses of choices to

ables (LIV), distinct from the standard IV approach,
identifies the MTE. These theoretical constructs can

instruments are not. When heterogeneity in choice is allowed for in a general way, IV and local IV do not

be defined independently of the data.

estimate interpretable treatment parameters.

2. We establish the central role of the propensity score

(Pr(D = 1 | Z = z) = P(z)) in both selection and TIVhe paper is organized as follows. Section II discusses

models.12

the IV approach to estimating choice models. Section III

3. We show that with vector Z, and a scalar instrumeinnttroduces a general model with essential heterogeneity and

constructed from Z (7(Z)), the weights on the LATEparnedsents its implications. Section IV compares selection and MTE that are implicit in standard IV are not guaranItVeemdodels and shows that LIV estimates the derivative of a to be nonnegative. Thus IV can be negative even thosueglehction model. Section V presents theoretical and empirall pairwise LATEs and pointwise MTEs are positicivale.examples of the model with essential heterogeneity. Certain instruments produce positive weights and avSeocitdion VI extends the analysis to multiple outcome models. this interpretive problem. Our analysis generalizes tShecattion VII allows choice responses to be heterogeneous in of Yitzhaki and of Imbens and Angrist, who analyzea tgheeneral way. Section VIII concludes.

case with positive weights.

4. We show the special status of P(z) as an instrument. It

II. IV in Choice Models

always produces nonnegative weights for the MTE and LATE. It enables analysts to identify the MTE W ore adjoin a choice equation to outcome equations (1) an LATE. With knowledge of P(z\ and the MTE(2o).r A standard binary threshold crossing model for D is

iLnAtToEi,dewneticfainabdleecMomTEpsos(eatanpyoinsttasn) dorarLdAITVEess(toivmearteD = l[D*>0], (9)

intervals) and identifiable weights on MTE or LATE, where
where the weights can be constructed from data. Twhisies). ability to decompose IV into interpretable compAo-familiar case is nents allows analysts to determine the response to

1[-]

is

an

indicator

treatment of persons at different served factors that determine treatment

levels status.

of

the

unob-

D*

=

yZ-

V,

(10)

5. We present a simple test for essential heterogeneity ((3 dependent on D) that allows analysts to determine

where (VJL Z) | propensity score,

X (V is ind or choice p

whether or not they can avoid the complexities that

arise in the more general model with heterogeneity in response to treatments.

P(z) = Pr(D =\\Z = z) = P

6. We extend the analysis of IV to models with more than where Fv is the distribution

two outcomes. Angrist and Imbens (1995) analyze an continuous. In terms of the g

ordered choice model with a scalar instrument that af-

is the cost of participation

fects choices at all margins. They show that in an C> 0]. For a separable mode

ordered model with multiple outcomes, IV identifies a C=ixc (W) + Uc, we have Z

"causal parameter." Their causal parameter is a weighted |x0 (X) - vciWl V = - ([/,

average of parameters that are difficult to interpret as examples, we use a special

this version the extended Roy 12 Rosenbaum and Rubin (19e8v 3)er es,taab plp islhietsheto cen m tr oarl erogleen of ert
pensity score in matching models. Heckman and Robb (1985, 1
Heckman (1980) establish the central role of the propensity s selection models. See also Ah1n 3 a Tn hd e P go en weerla l li(1 ze 9d 93R ) oay nd mP oo dw elea llll

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

394 THE REVIEW OF ECONOMICS AND STATISTICS

In the case where p (given X)ofiZsaffaectcs bootn h aspptroaacnhets touidn entd ifiecatrion.ITV his-is a1new

and IV-2, it is not necessary to sppheencomif eny on itn h moedelcs h witohihceeterom genoeodusepl. Wteonow

identify (3. We show that in a geren vieewrsoamle rm esultos desteabllishw ediitn h the phreecetdiengrlioteg rateur-e

neous responses, the specificatithoatnforom fthe P pla(tzfo)rmaon n wdhichitwesbur ilde. lation-

ship with the instrument play crucial roles. To see this, study

the covariance between Z and y\DIId I. AisGcenuersasl MeoddeliwnithtEh sseentiialnHtetreroogdenueitcy-

tion. By the law of iterated expectations, lettiinnOgutcZ omeds enote the

mean of Z, we have

We now exposit the selection model developed in Heck-

Cov(Z,tiD) = £((Z-Z)Dti)

man and Vytlacil (1999, 2001b, 2005). Their model for counterfactuals (potential outcomes) is more general than

= E((Z - Z)t)\D = l)Pr(£>= 1)

equation (1) and allows for nonseparable errors:

= E((Z - Z)i\\yZ > V) Pr(7Z> V).

Yx = MX.t/O,

Yo=ilo(X9Uo), °2) Thus, even if Z and t] are independent, they are not

independent conditional on Uo) is dependent on V (that

D=1 is, if

[yZ the

d>eVci]siiofn-rm\ a(k=eUrxha-ws here

X

are

observed

and

(UX,UO)

are

unobse

partial knowledge of t) and acts on it). Selection modelasnalyst. The X may be dependent on Uo and Ux

allow for this dependence (see Heckman and Robb, 1985w , ay. This model is designed to evaluate polic

1986; Ahn
implicit and

and Powell, 1993;
assuming that

Powell,

1994).

KeepingX aXn1d4

not to extrapolate to new environments The observed outcome is produced by

cha eq

Choices are generated by a standard disc

(£/,,I/0,V) JLZ (11)

model. We generalize the choice model (9) and
a latent utility,15

(alternatively,
z) = E(Y0 | D

that
= 0,

(8,
Z=

tz\D)*)J ==L \lZ a d{)Z,)+ -VwE ane(dU Dob 0 = t 1[a |Di*y n > z 0E ]. (< (1Y 3)\ VD),=w0h

can be written as

|xD(Z) - V can be interpreted as a net utility for a person

E(Y\D = 0,Z=z) = a + K0(P(z)),

with characteristics (Z,V). If it is positive, D = 1 and the person selects into treatment; otherwise D = 0. Section VII

where the functional form of Ko is produced from thediscusses the important role played by additive separability

distribution of (f/0> K)- (This representation is derived inin the recent IV literature on essential heterogeneity.

Heckman, 1980; Heckman and Robb, 1985, 1986; Ahn and In terms of the notation used in section I, (3 = Yx - Yo =

Powell, 1993; and Powell, 1994.)

|Xi(X,£/i) - |xo(X,£/o). A special case that links our analysis

Similarly,

to standard models in econometrics is when Y\ = X|3i + U\
and Yo = X(30 + U^ so (3 = X ((3, - (30) + (Ux - Uo). In

E(Y\D= \,Z = z) = E(Yx\D = \,Z=z) = a + $ + E(Ul\yz>V)

the case of separable outcomes, heterogeneity in (3 arises because in general Ux =£ Uo and people differ in their X.16
Following Heckman and Vytlacil (2005), we assume:

= a + p + Kx(P(z))9
where K0(P(z)) and Ki(P(z)) are control functions in the sense of Heckman and Robb_(1985, 1986). Under standard conditions, we can identify (3. Powell (1994) discusses semiparametric identification. Because we condition on Z = z (or P(z)\ correct specification of Z plays an important role in econometric selection methods. This sensitivity to the full set of instruments in Z appears to be absent from the IV method.
If (3 is a constant (given X), or if t] (= (3 - (3) is
independent of V, only one instrument from the vector Z needs to be used. Missing instruments play no role in identifying the mean responses but may affect the efficiency of the IV estimation. We establish that in a model where (3 is variable and not independent of V, misspecification of Z plays an important role in interpreting what IV estimates, analogous to its role in selection models. Misspecification

A-l: (Uo, Uu V) are independent of Z conditional on X (Independence Condition for IV).
A-2: The distribution of |xD(Z) conditional on X is nondegenerate (Rank Condition for IV)}1
A-3: The distribution of V is continuous.18
A-4: E\YX\ < oo and £|F0| < °° (Finite Means).
14 See Heckman and Vytlacil (2005, 2007b) for a study of exogeneity requirements on X in answering different policy questions.
15 A large class of latent index, threshold crossing models will have this representation. See Vytlacil (2006a).
16 In nonseparable cases, heterogeneity arises conditional on X even if Ui = Uo= U.
jxD( · ) is assumed to be a measurable Junction ot Z given A. 18 The distribution is absolutely continuous with respect to Lebesgue
measure.

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

MODELS WITH ESSENTIAL HETEROGENEITY 395

A-5: 1 > Pr(D = 1 | X) > 0 (F AMoTrE(x,euDa)c=h E(YXX-,Y0a\X t= rx,eUDat= m uD) ent group and a comparison group exist).
= E(£\X = x,V = v)9

A-6: Let Xo denote the coun fotr e(3r=fYxac- tYu o aanld vv a=lFuye\uo D)f, wX herte h weatuse both would have been observed if genD eral w noteatrioen ansdetthe treogre0ss.ionD -speef cifiin c neotaX tion\inter-
analogously. Thus Xd = X for d chan=ge0ab,ly1to(aTnchheor X ourdanaarlyesisibnotvhair n itahn e ttreatment to counterf actual manipulatioefnfesct).literature and in conventional econometrics. To sim-

plify the notation, we keep the conditioning on X implicit

A-l and A-2 generalize IV- 1 an exd ceptIV wh-e2 n clrareitsypoef cextpiov siteiolnyd.ictA ate-s 3othiesrwaise. Betechnical condition made focr ausecPo(Zn ) isva emn onioeton niccteranasfn ord matiiosn oef athseimly ean net
relaxed at some notational cost. A-4 is needed to use utility |jld(Z), and UD is a monotonic function of V, when we

standard integration theorems and to have the meaenvalturaetaetA- MTE(wD) at the value P(z) = uD, it is the marginal ment effect parameters well defined. A-5 is a rsettaunrdnatrodagents with characteristics Z = z who are just requirement for any evaluation estimator: thatinfdoirffeearcenht between sector 1 and sector 0. In other words, at

value of X, there be some who are treated and somtehiws hpooinatreof evaluation, Amte(md) is the gross gain of going not. A-6 is the requirement that receipt of treatfm roemnt0 ntoot1 for agents who are indifferent between the

affect the realized value X, so we identify a full trseecattomrsenwthen their mean utility given Z = z is |uld(z) = v, so effect when we condition on X instead of a treatment effect
&d(z) - v = 0, which is equivalent to the event that P(z) = that conditions on variables affected by treatment. ThiFsv (|Xd (z)) - Fy(v) = uD. When Y\ and Yo are denominated

assumption can be relaxed by redefining the treatment to bine value units, the MTE is a willingness-to-pay measure for

a set of outcomes corresponding to each state Xd.

persons with characteristics Z = z at the specified margin.

The separability between V and |xD(Z) in the choice Under assumptions A-l to A-5, Heckman and Vytlacil

equation is conventional. It plays a instrumental variable estimators in

crucial models

role with

ienssjeunsttiiaflying(1999,

2005)

show

that

all

treatment

parameters,

matching

estimators, IV estimators based on a scalar function J(Z) of Z,

heterogeneity. It implies the monotonicity (uniformity) acnodn-OLS estimators can be written as weighted averages of the dition IV-3 from the choice equation (13). Fixing Z atMtTwE.o Table 1 summarizes their results for characterizing different values moves D(Z) in the same direction ftroeratment effects and estimators and the weights given data on everyone. Vytlacil (2002) shows that under independPe(nZ)c,eD, , and the instrument J(Z). We discuss the weights for the rank condition, and some regularity conditions, moInVoi-n the next subsection. We show how to construct these

tonicity IV-3 implies the existence of a V in the reprweesiegnh-ts on our Web site, where software for doing so is tation (13). Thus the IV model for the general case anadvatilhabele.20 Heckman and Vytlacil (2001b, 2007b) show that

economic choice model turn out to have identical represtehnes-e weights can be constructed and the relationships among

tations. The independence assumption A-l producesthteheparameters shown in table 1 hold even if a nonseparable

condition that everywhere Z enters the model only thrcohuogihce model, instead of equation (13), is used and even if

P(Z). This is called index sufficiency.

assumption A-2 is weakened. We discuss this result in section VII.

Without any loss of generality, following the same argNu-otice that when AMTE does not depend on uD, all of the

ment surrounding equations (9) and (10), we may write ttrheeatment effects are the same, and that, under our assump-

model for D using the distribution of V, Fv, as

tions, IV estimates all of them. In this case, AMTE can be

taken outside the integral and the weights all integrate to 1 .
D = 1[Fv(ild(Z)) > FV(V)] = l[P(Z) > UD\ (14) Thus, E(YX - Yo | X = x) = ATE(jc) = E(YX - Yo | X = x,

D = 1) = TT(jc) = MTE(jc), and we are back to the where UD = Fv (V) and P (Z) = Fv ([iD(Z)) = Pr(D = 1 | Zco),nventional model of homogeneous responses. This includes the propensity score. Because Fv is assumed to be a continutohues case where r\ is nondegenerate but independent of D. distribution, Fv is a strictly monotonic transformation thatThe parameters MTE and LATE are closely related. preserves the information in the original inequality. Note tUhsaitng the definition of D(z) in IV-3, let Z(x) denote the
UD is uniformly distributed by construction (UD ~ Unif [0,s1u])p. port of the distribution of Z conditional on X = x. For

any (z, z') G Z(x) XZ(x) such that P(z) > P(z'\ under

A. The Local Average Treatment Effect, the Marginal

IV-3 and independence (A-l), the LATE is

Treatment Effect, and Instrumental Variables

ALATE(z',z) = E(YX - Y0\D(z) = hD(z') = 0), (15a)

To understand what IV estimates in the model with that is, the mean outcome in terms of Yx - Yo for persons
general heterogeneity in response to treatment, we dwehfoinweould be induced to switch from D = 0 to D = 1 if Z the MTE conditional on X and UD:19

of a parametric normal generalized Roy selection model by Bjorklund and

19 As previously noted, the concept of the marginal treatment effectMaonfdfitt (1987).

the limit form of LATE were first introduced in the literature in the context

20 See jenni.uchicago.edu/underiv/.

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

396 THE REVIEW OF ECONOMICS AND STATISTICS
Table 1 A. - Treatment Effects and Estimands as Weighted Averages of the Marginal Treatment Effect

ATE(x) = E(Y1-Y0\X = x) = J^ AMTE(x, uD) duD TT(x) = E(Yl-YQ\X = x,D = \) = £ AMTE(x, uD) u>TT(x, uD) duD TUT(x) = E (Ki - Yo | X = x, D = 0) = £ AMTE (x, uD) uTVT (x, uD) duD
Policy Relevant Treatment Effect (x) = E {Ya, \ X = x) - E (Ya \ X = x) = /,, AMTE (x, uD) wPrTe (a;, uD) duD for two policies a and a' that affect the 2" but not the X
IVj(x) = Jo Amte(x,ud)ljiV(x, uo)duD, given instrument J OLS(x) = £ AMTE(x, uD) wols(x, ud) duz?
Table IB.- Weights
Uatv{x,ud) = 1
-tt(x, «D) = [/:d /(p i x = x)dP] E{Pl1x=x)
WTUT (X, UD) = [ft* f (P\X = X) dp] £?((1_p)|X = a.)
wpRTEia;, «d) = -
^(x,uD) = [X!D(J(^
«oU(x,«D) - 1 +
^-o)=[Cf(p\X
M*, no) = [jr HP
Source: Heckman and

were manip whu ere l uDa = t Pr(De (zd ) = 1) =e Prx (D =\t \Ze = zr ) = n P(z

of Vytlacil Pr' (Ds fe') =(12 | Z 0 = z'0 ) = P2 r(D) (zf) =t 1)h = P(e z')-2o 1

limit, as u'D - » md, LATE converges to MTE.

E(YY

-

Y0 Imbe\ ns andD Angr( istz (199) 4) def= ine the LL ATE pD ara

from hypothetical manipulations of an instrumen
= E(Y{-Y0\ufD<UD<uD) (15b)

= ALATE(MD,My,

21 Assumption A-l implies that Pr (D (z) = 1) = Pr(D = 1 | Z
Pr (D(z') = 1) = Pr(D= 1 |Z = z').

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

MODELS WITH ESSENTIAL HETEROGENEITY 397

man and Vytlacil (1999, 2005) ddartaaw . Oonne u ch seofiucle etm hp eoirriy calan stdrategy is

define the parameters in term ussinogfthtehevag rieenty eroaflitzeesdtsRdoey veloped in t

model. Their link helps to underdsettaenrd miw nh e aw t hIeVtheesrtitm haetaedsdain tidonal compl relates IV to choice models. We work with the definition the model of essential heterogeneity is w

(15b) throughout the rest of this paper. It enables us U tosing the formulae presented in table

identify the margin of UD selected by instruments, somtei-onal treatment parameters as well as th

thing currently not possible in results in the previous liPte(rZ- ) as an instrument can be identifie

ature on IV.

ages of AMTE (uD) if P(Z) has full suppor

The MTE can be identified by taking derivatives obfe constructed from data. If P(Z) does

E(Y \ Z = z) with respect to P(z) (see Heckman andport, simple tight bounds on these par Vytlacil, 1999).22 This derivative is called the local in-structed.23

strumental variable (LIV). For the model of general

heterogeneity, under assumptions A-l to A-5), we cBa.nUnderstanding What IV Estimates

write (keeping the conditioning on X = x implicit)

Standard IV based on J (Z), a scalar function of a vector

E(Y\Z = z) = E(Y\P(Z)=p),

Z, can be written as

E(Y\P(Z) = p) = E{DYX + (1 - D)Y0\P(Z) = p) = E(Y0) + E(D(YX - Y0)\P(Z) = p)

Aiv= d^(uD)i4i(uD)duD, (lg)
Jo

= E(Y0) + E{YX - Y0\D = \)p

where

= E(Y0) + P E(Y, - Y0\UD = uD) duD.
Jo

J( x E(J(Z) - E(J(Z))\P(Z) > ud)Pt(P(Z) > uD)
"M J( x ~ Cov(/(Z),D) '

As a consequence,

(19) In this expression uD is a number between 0 and 1. This

^ E(Y\P(Z) =p) = E{YX - Y0\UD = p). (16)

weight depends on the choice probability P(Z). For a derivation see appendix A. The derivation does not impose

any assumptions on the distribution of J(Z) or P(Z). Notice

This expression shows how the derivative of E(Y \ Z = z),

that J(Z) and P(Z) do not have to be continuous random

which is the LIV estimand of Heckman and Vytlacil (1999),

variables, and that the functional forms of P(Z) and J(Z) are

identifies the marginal treatment effect (the right-hand side

general.24

of this expression) over the support of P(Z). Observe that a

For ease of exposition, we initially assume that J(Z) and

high value of P(Z) = p identifies the MTE at a value of

P(Z) are both continuous. This assumption plays no essen-

UD = uD that is high - that is associated with nonparticipa-

tial role in any of the results of this paper, and we develop

tion. It takes a high p to compensate for the high UD = uD

the discrete case after developing the continuous case. The

and bring the agent to indifference (see equation (14)). Thus

weights defined in equation (19) can be written as

high p values identify returns to persons whose unobserv-

ables make them less likely to participate in the program. Software for estimating the MTE using local linear regres-

\J-E(J(Z))]\ fjMt)dtdj

sion is described in appendix B and is available online at

jenni.uchicago.edu/underiv.
Under the special case where (3 JL D (no essential

«M =

heterogeneity), Y is linear in P(Z):

where fJ>P is the j

E(Y\Z) = a + 6P(Z), (17)

implicitly condition positive. Observe th

integrate to I,25 so ev where b = AMTE = AATE = A77. T ih n istre epr rev sea ntlas ti, on iht oldm s ust b whether or not Yx and Yo are st eph are abr leeiniU s\ o ann d e Uoi , nstrume respectively (see Heckman and Vtyo tlacA il,-25 001abr , e 200s 7ba)t . isfied, t Thus, a test of the linearity of the conditional expectation of

Y in terms of P{Z) is a test of whether the conventional
23 See Heckman and Vyt model or the model of essential hetZ er4 ogeM neo itr yegep ner raetc esis th eely, / (Z) a
are absolutely continuous

22 See also Heckman 2 an 5 dJV Sy (jt -l E ac(i7 l ((Z 2» 0)05 f,] 2 f0j0 .P 7 UD

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

398 THE REVIEW OF ECONOMICS AND STATISTICS

that J(Z) is a monotonic functiwoen igho t ofn tthh e LeATsEcfaolratrhe Z inteIrnvalt(h, is+c1a). sInethis

J(Z) and P(Z) have the samenotadtioin,stribution and fJP (j, t)

collapses to a univariate distribution. The possibility of

negative weights arises when J(Z) is not a monotonic function of P{Z). It can also arA*ivs=e\E(Yw 1 -hY0e\UnD = tuDh Wwe(urD)eduDare two or

more instruments, and the analyst computes estimates with

only one instrument or a combinatiK on~1of C thpetZ+-iinsjtruments
that is not a monotonic functio=nSxoJfE(PY(,Z-)Y , os\oUDt=huaDt) J(Z) and
P(Z) are not perfectly dependent. If=;th JepienPsttr+uim ~Pe<nt is P(Z)
(so J(Z) = P(Z)), then the weights are everywhere nonnega-
tive, because from equation (K 1-l 9) E(P(Z) \ P(Z) > uD) -

E(P(Z)) > 0. In this case the density of (P(Z), J(Z))

collapses to the density of P(Z). For any scalar Z we can

i=l

define J(Z) and P(Z) so that they are perfectly dependent, provided J(Z) and P(Z) are monotonic in Z. More generallyL,et ji be the ith smallest value of the support of the weight (19) is positive if E(J(Z) | P(Z) > uD) is weakldyiscrete version of equation (19) is

monotonic in uD. Nonmonotonicity of this conditional expectation can produce negative weights.26
Observe that the weights can be constructed from data on

/

K

2

[ji-E

(/, P, D). Data on (/(Z), P(Z)) pairs and (J(Z), D) pairs (for each X value) are all that is required. We can use a smoothed

Xe

=

sample frequency to estimate the joint density fJ>P. Thus, given our maintained assumptions, any property of the weight, including its positivity at any point (x,uD), can be examined with data. We present examples of this approach in section V.

where

f(j

probabilit

that

high

P(Z).

J(Z)

As is evident from table 1, the weights on AMTE (uD) or

negativ

generating AIV are different from the weights on AMTE (uD) vector.

In

that generate the average treatment effect, which is widely monotoni

regarded as an important policy parameter (see, for exam- and

P(Z).

I

ple, Imbens, 2004) or from the weights associated with the to

a

univa

policy-relevant treatment parameter, which answers well- exactly

as

posed policy questions (Heckman and Vytlacil, 1999, expressio

2001b, 2005, 2007b). It is not obvious why the weighted expression

average of AMTE (uD) produced by IV is of any economic their

analy

interest. Because the weights can be negative for some where

J(

values of uD, AMTE (uD) can be positive everywhere in uD, is

a

mon

but

IV

can

be

negative.

Thus,

IV

may

not

estimatesuam

weights to 1 over the .

ca

treatment effect for any person. Therefore, a basic question

is why estimate the model with IV at all, given the lack oMf onotonicity or uniformity is a property needed with just

any

clear

economic

interpretation

of

the

IV

estimator

in

tethswetiomvataelsueastroefatZm,eZnt=efzf\ecatn. dWZith=

z2> to guarantee that
more than two values of

IV

general case.

Our analysis can be extended to allow for discrete instruZ- we need to weight the LATEs and MTEs. If the instrument

ments, /(Z). Consider the case where the distributionJo(fZ) shifts P(Z) in the same way for everyone, it shifts D in

P(Z) (conditional on X) is discrete. The support of tthhee same way for everyone since D = 1[P(Z) > UD] and Z distribution of P(Z) contains a finite number of values px i<s independent of UD. If J(Z) is not monotonic in P(Z), it

p2< · · - < pK, and the support of the instrument J(Z) is almsoay shift P(Z) in different ways for different people. Neg-

discrete, taking / distinct values, where / and K may abteive weights are a tip-off of two-way flows. distinct. E(J(Z)\P(Z) > uD) is constant in uD for uD withinAn alternative and in some ways more illuminating way any interval (p^, Pt + i) and Pr(P(Z) > uD) is constant in tuoDderive the weights is to follow Yitzhaki (1989, 1996) and for uD within any interval (p^, p^ + 0, and thus o)^v (uD) isYitzhaki and Schechtman (2004), who prove for a general

constant in uD over any interval (p^, pe + \). Let X^ denote the
27 The condition for positive weights is weak monotonicity of X^ in . If

X is monotone increasing in , the numerator and the denominator are

26 If it is weakly monotonically increasing, the claim is evident fbrootmh positive. If \ is monotone decreasing, the numerator and the

equation (19). If it is decreasing, the signs of the numerator anddetnhoeminator are both negative and the weights are positive.

denominator are both negative, so the weight is nonnegative.

28 In their case I = K and/ (jh pt) = 0 Vi ± t.

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

MODELS WITH ESSENTIAL HETEROGENEITY 399

regression function E(Y \ P(Z spo)ns=e hp om)ogtenheiatyt. Inathlaitnsim eaplr er frraemgewroerks, saniyoin nstru-

of Y on P estimates

ment will identify juli (X) - |jl0 (X), and the choice of a

particular instrument affects efficiency but not identifiabil-

f1 \ dE(Y\P(Z) = p)]
P.,p = \ [ dE(Y\P(Z) dp p)] \ co(p) dp, (23)

ity. One can be casual about the choice model in the
traditional setup, but not in the model of choice of treatment with essential heterogeneity. Thus, unlike the application of

where

IV to traditional models, IV applied in the model of essential heterogeneity depends on (a) the choice of the instru-

SI [t - E(P)] dFP(t)

ment /(Z), (b) its dependence on F(Z), the true propensity score or choice probability, and (c) the specification of the

^P) =

propensity score (that is, what variables go into Z). Using

the propensity score, one can identify LIV and LATE and which is exactlty he margt inah l rete urns aw t valuee s oi f tg he uh nobst erved (UD1 . 9) Thus we can interpret equat

dE(Y\P(Z) = p)l D. d Monp otonicitw y, Unih forme ityn , and Cot nditw ional o Instr- ums entt s a on P(Z) as the instrument is used

of D on Y Und The e mr onotoniu city n or uniiff ormio ty cr ondim tion IV-i3 t is a y con- , E(YX - Y0\UDditio= n on cu ountD erfac)tuals= for thA e samM e persoT ns aE nd is(nw ot

derivation, wh testi abc le. Ih t rules i ous t genea raln heteroa genr eousg resu ponsm es to e

parts, in appentrd eatm iex nt choC ices . in reO sponu se tr o chana gesn in ZaThley reces nt i

of Yitzhaki (1l9 iter8 atur9 e on)in, strumIenm tal varib ablese win th hes terogea neon us red -

and Imbens (19s9 pon5 ses)is thiun s asymt meh trica . Ot utcomw e eque ationa s calnlbo e

not monotonic heterof geneu ous n in a c gent eraliwo ay, n whers eas cho oicef equatiP ons (

is more generca annlot bet . Ifh \xD a (Z) n = yZ, wht ereh 7 is a a cot mmono coef fficienI t m

that he does no sht ared bi y m everyop ne,o thes n te he chu oicen modielf sato isfir es tm he

Our simple tes unt iformf ityo pror perty.t Onh thee otherahab nd,s if e 7 isn a rac ndoe m

based on the lci oefn ficiee nt a (thar t isi , ht as ay nondego enef rate disF tribi utn ion) thaP t

applies to the c canatas ke e both no egaf tive anL d poA sitiveT valuE es, andf theo re ar re twoa

equivalent test or morie s variabt les o in Z wc ith h nonde egec nerk ate coeft fich ientsa 7, t

same over thethensua nifm ormityp canlbee violats ed.u Difp ferep nt po eoplr e cat n re- o

spond to changes in Z differently, so we have nonuniformity.

C. The CentralThe R unifoo rml itye condo itionf can bt e vh iolate ed eveP n whr en o all p

components of 7 are of the same sign if Z is a vector and 7
Observe that is a nob ndego enert ateh randome varq iableu .31 ations counterparts f Chao nginr g one L coorA dinateT of ZE , ho, ldinge theq othu er ca oort di- i expressions innv ates o at dl iffv ereni t vn aluesg acrosst peoh ple, ie s not tp he er xpero imep nt
ability of selectt hatideo finn es monoi ton nicitt y oo r unifot rmr ity.e Cha angt ingm one coe m- n
it is a monoton poi nec nt of f Z, au llown ing tc he t othiero coon rdinato es tf o varyt acrh oss e
ILD(Z). The propp eope le, dn oes s notint ecey ssarily s proc duco e ur nifoe rm flp owsl toa wary d models as a determinant of control functions in selection or against participation in the treatment status. For example, models (see Heckman and Robb, 1985, 1986), as noteledtin[iD (z) = 70 + yiZ\ + 72^2 + 73^2, where 70, 71, 72, and section II. In matching models, it provides a computa7t3ioanr-e constants, and consider changing z\ from a common ally convenient way to condition on Z (see, for exabmaspeles,tate while holding z2 fixed at different values across Rosenbaum and Rubin, 1983; Heckman and Navarro, people. If 73 < 0, then \ld{z) does not necessarily satisfy the 2004). For the IV weight to be correctly constructed anudniformity condition. If we move (zi, Z2) as a pair from the interpreted, we need to know the correct model for Ps(Za)m, e base values to the same destination values z', unifor-
that is, we need to know exactly which Z determine P(mZ)i.ty is satisfied even if 73 < 0, although \ld (z) is not a As previously noted, this feature is not required in tm heonotonic function of z.32
traditional model for instrumental variables based on re-

31 Thus if y > 0 for each component and some components of Z are

29 Yitzhaki's weights are used by Angrist and Imbens (1995) to ipnotseirtpivreetand others are negative, changes from z' to z can increase yZ for

what TSLS estimates in the model of equation (23). Yitzhaksiom(1e98an9)d decrease yZ for others, because 7 differs among persons.

derives the finite-sample weights used by Imbens and Angrist3(2seAeshsoicsiated with Z = z is the counterf actual random variable D(z).

paper posted at our Web site). See also the refinement in YitzAhsaskoiciantedd with the scalar random variable J (Z) constructed from Z is a

Schechtman (2004).

counterfactual random variable D(j(z)), which is in general different from

30 Note that it is possible that E(Y\Z) is linear in P(Z) only overD(cze).rtTahine random variable D(z) is constructed from equation (13) using

intervals of UD, so there can be local dependence and local indeitple^nDd(ezn) c-ey\- Here V assumes individual-specific values, which remain fixed

of (UD, Uo, Ux).

as we set different z values. From A-l, Pr(D(z) = 1) = Pr(D = l|Z = z).

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

400 THE REVIEW OF ECONOMICS AND STATISTICS

Positive weights and uniformitIyn asruemdmisatriyn,cn t oitshsu inegs.3in3 the economic

Under uniformity and assumptiongsuaAr-alnttoeeAs-5t,htahteif weZigihstschanged from

on MTE for any particular instrruesm poen nd t im natyhebesap moesidtirveectoiron to the ch

negative. The weights for MTE useix npgrP es(Z si)om n u(7s)t. b Tehepocsointidviet,ion that people as we have shown, so the propein nstih tye sacm oree dhiarsecatisopnecfiaolr a common status as an instrument. Negativ peeow pleeigdhotess anso sotciim atp edlywtihth at D(z) is mo

the use of J(Z) as an instrumenp ted rsoon noitn ntehceesussaurailly maim thpelm yatical usage

failure of uniformity in Z. Even iftounnicifitoy rm . IiftyD(izs) siastm isfoineodtofn oric in the usua
Z, it is not necessarily satisfiedafnodrr7e(sZp)o.nCsoesndariteioin n tIh Ve-3saim s e direction
an assumption about a vector. Fitxhieng "moonneotcoon micbiitnya"tioorn"u on f if Zormity" con (when J is a function of Z) or onseatcioso fireddi.nate of Z does not
guarantee uniformity in J even ifIfonreeshpaosnusensiftoorm a citoy mim noZn change of Z The flow created by changing ohneetecrooogrednin eoautes ionf aZ gcean nerbael way, we o reversed by the flow created bythoethgeernceorm alpcoanseen . tVsyotflaZciilf 's (2002) the there is negative dependence am anodngIVcocam np noon t ebnetesx , perveesn sedifin terms of ceteris paribus all components ooff Z LAaT fE fetcetrD msin . Ntohneestahm eleess, Yitzhaki direction. We present some exam thpeleIsVineqsueacttiioon n V (2.3) as described in a
The issues of positive weighvtasliadn , dantdhteheexwiesitgehntcseon ofdE(Y\P = p)/d one-way flows in response to an itnhteersvaem nteiofnorarm e caosntch epetu w-eights obtain ally distinct. Even with two valueLsAfToE r) awsh caeln artZh,efm loownsom toanyicity condit

be two-way (see equation (7)). If we satisfy IV-3 for a

vector, so uniformity applies, theEn. TwreeiagthmtesnftorEfafepcatrstivceurlasrus Policy Effe

instrument may be negative for certain intervals of UD (that Even if the uniformity condition I
is, for some of the LATE paramaentesw rse).r relevant policy questions. By Y If we condition on Z2 = z2> · · I>VZokr=TZSkLSuseisntgim Zxataess aan weighted av
instrument, then a uniform flow condition is satisfied. We responses, which may be pointwise po
call this conditional uniformity. B atyivceo.nP doitliiocn ieisngm , awye ienfdfu ecc-e some peopl tively convert the problem back toothtehrast toofsawsitccah larouin t sotfruc-hoices, as is ev ment where the weights must (b7e). pTohseisteivnee.t Iefffuencitfsoarrm e iotfyinterest in m holds for Zb fixing the other ZTh atusc,om sum bsoid nizveadluheos,ustihnegnin a region one-dimensional LATE/MTE anatlayxseiss m apapylieast.trCalcetarsloym , ethteo migrate to weights also have to be defined octohnedristtioonlaelalvye.. The net effect on earnin
The concept of conditioning oalnl tohtahteirs irneqsturiruem d etontpsertfoorm cost-bene

produce positive weights for thpeolsicey lecotnedouitncsotm ru esm . Iefntthies haousing subs

new one, not yet appreciated in tahnedetm hp e in riectalefIf Vecltiteorfatth ueres,ubsidy is the

and has no counterpart in the ttrhad e iitsisouneaol fIVmm onoodteoln. iIcnity thies a red herri

conventional model, the choice ofex a ovgaelindoiunssltyruim mepnotseadf,feIV ctsestimates th

efficiency, but not the definitionpooflicty heon pam raem an eteorustcaosmitesd. oOen s ly if the ef

in the more general case.34

earnings induced by the subsidy on out

of interest, and not the effect of the sub

The random variable D(j) is defined by theemfeolrlogw ein ag s tah nouig nhtterex ep sterin im gencto.ndition. For each possible realization j of 7(Z), define DO) by setting D(j) =

D(Z(j)), where Z(j) is a random draw from the distribution of Z condi-

tional on 7(Z) that draw of

= Z

j. Set D(j) equal (j). Thus D(j) is

taoftuhnectcih oo niIcoV ef.t(hZCat(oym w ),op uuD lad)r. biAn esg m loan Sdgeelg aesicvw tenieon

and

Loc

draw Z UD) JL

(j) Z,

randomly so D(j) JL

Z(a.nTdhteh reusarin e doetpheenrdW p en oestsly inboloew fcZos)nh ,sow tw reuchttahivoaentstlhooafctatl(h ZIe(V j\

identifies

t

counterfactual D(j\ since there are diffesreen letcptoisosinblemdoisdtreilb.utM ioank s ifnrogmthe X explic

which Z can be drawn, apart from thseelaeccttuiaolndim stroidbeult,ioinf otfhZe TUhxe and Uo are
advantage of this construction is that it equates the counterfactual prob-
ability that D{j) = 1 given J(Z) = j with tahbelepsoptuhlaattion arperoabdadbiitliitvye. lIyf tsheeparable in th
value of Z were uncertain to the agent, tYhx is w =ou|lX d !b(eXa)ra+tioU na{l eaxnpedctaY- o = |xo(X)

tions assumption. See the further discusfsiuon ncin tiaopnpeanpdipxrIoI apcohstecdon atdtihteions on Z and
Web site for this paper.

33 When they analyze the vector case, Imbens and Angnst (19^4)

analyze instruments that are monotonictfhuencstaim ones poafrP am (Z)e. tOeu rraasnPal(y Zs).isIn is the general

more general and recognizes that in thiedevnecttifoiredcaasree, IdVifw feerig en htt.s Rmeapylacbieng P(Z) by a li

negative or positive.

mation of it (for example, E (D | Z) = ttZ = J

34 In the conventional model with hopm roodguecn e epoousistirveesp woen igshetss, faolrinAeM arTE (x,uD) or ALAT

probability approximation to P(Z) used atshaenwinesig trhutm s b en asted woounldthideen cotrifry ectly specified P

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

MODELS WITH ESSENTIAL HETEROGENEITY 401

of index sufficiency this is eq|Xu](iXv) farloemnKtX(Xt,Po(Z)c), own hicdhimtaiyocnonitn aingcoonsn tants and

P(Z) and D:

functions of X that do not interact with P(Z) (see Heckman,

1990). A parallel argument for Yo shows that we require a
E(Y\X9D9Z) = ilo(X) + [jjl,(liX mi)t se-t fiorloZ (gX iven)]XDsuch that Ko (X,P(Z)) = 0. Selection

+ KX(P(Z),X)D + K0(P(Z)9X)(l -D),
where the control functions are

models operate by identifying the components of equations (25a) and (25b) and generating the treatment parameters from these components. Thus they work with levels of the Y.
The local IV method works with derivatives of equation

KX{P(Z)9X) = E(UX\D = 19X9P(Z))9

(24) and not levels, and cannot directly recover the constant terms in equations (25a) and (25b). Using our analysis of

K0(P(Z),X) = £(I/0|D = 0,X,P(Z)).

LIV but applied to YD = YXD and Y(l - D) = Yo(\ - D\
it is straightforward to use LIV to estimate the components

The IV approach does not condition on D. It works withof the MTE separately. Thus we can identify

E(Y\X9Z) = (io(X) + [^(X) - \lo(X)]P(Z)

ji1(X) + £(t/I|X,I/D = MD)

+ KX(P(Z),X)P(Z) (24) and
+ ATO(P(Z),X)[1-/>(Z)],
[l0(X)+E(U0\XMd = Ud)
the population mean outcome given X,Z
From index sufficiency, E(F|X,Zsep)ar=atelEy.(TYhi\s cX orr,ePsp(oZnd)s)t.o wThhat eis estimated from MTE is the derivative of this expretsaksinigotnhe w deriitvahtivers eofstpheeecxtpretssoions (25a) and (25b) P(Z), which we have defined as LIV:m3u5ltiplied by P(Z) and 1 - P(Z), respectively:38

dE(Y\X9P(Z)) dP(Z) j-7- p{z)=p

P(Z)E(Yl\X9Z9D= 1) = P(Z)ilx(X) + P(Z)KX(X9P(Z))

The distribution of P(Z) andandthe relationship between 7(Z) and P(Z) determine the weight on MTE.36 Under assump-

tions A-l (Heckman

taond A-R5o,bablo , n1g 98w 5;itHhe[lc-rPka(Zm n )]£k (aron |Xa,,n Z,1 Dd9 = 9 lOi)0m ),itonceoncd an itiiodn en s -

tify ^(X), jxo(X), KX(P(Z)X\ a=n [1d- PK (Z)W0X{P ) +(Z [1 )-JP(L Z)])K.0(X,P(Z)).

The selection (control function) estimator identifies the

conditional means

Thus the control function method works with levels,

whereas the LIV approach works with slopes. Constants that
E(YX\X9P(Z)9D = 1) = MX) + KX(X,P(Z)) (25dao)not depend on P(Z) disappear from the estimates of the

and

model. The level parameters are obtained by integration

using the formulas in table IB.

E(Y0\X,P(Z),D = 0) = MX) + K0(X9P(Z)). (25b)Misspecification of P(Z) (either its functional form or its
arguments) and hence of KX(P(Z)X) and K0(P(Z)JC) in

These can be identified from nonparametric regressions ofgeneral produces biased estimates of the parameters of the Y\ and Yo on X,Z in each population. To decompose themseodel under the control function approach even if semipameans and separate jii(X) from KX{X,P(Z)) without invorka-metric methods are used to estimate |x0, |xb Ko, and Kx. To ing functional form or curvature assumptions, it is necessarimy plement the method, we need to know all of the arguto have an exclusion (a Z not in X).37 In addition, there mumstents of Z The quantities KX(P(Z)JC) and K0(P(Z)J() can
exist a limit set for Z given X such that KX(X,P(Z)) = 0 forbe nonparametrically estimated, so it is only necessary to Z in that limit set. Otherwise, without functional form orknow P(Z) up to a monotonic transformation.39 The distri-
curvature assumptions, it is not possible to disentangbleutions of U\9 U09 and V do not need to be specified to estimate control function models (see Powell, 1994).

35Bj6rklund and Moffitt (1987) analyze this marginal effect for a These problems with control function models have their

parametric generalized Roy model.

counterparts in IV models. If we use a misspecified P(Z) to

3b Because LIV does not condition on £>, it discards information. Lost inidentify the MTE or its components, in general we do not
taking derivatives are the constants in the model that do not interact with

P(Z) in equation (24).

37 See Heckman and Navarro (2006) for use of semiparametric curvature 38 Bjorklund and Moffitt (1987) use the derivative of a selection model

restrictions in identification analysis that do not require functional formin levels to define the marginal treatment effect.

assumptions.

39 See Heckman et al. (1998a).

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

402 THE REVIEW OF ECONOMICS AND STATISTICS

identify the MTE or its componeE(n YXts- .Y0M \Di*s=s0p) e=cEi{YfXic-aYtOi\oYn X -Yo0f=C) = C. P(Z) plagues both approaches.
One common criticism of selection models is that without Figure 1 presents the standard treatment parameters for the

invoking functional form assumptions, identification ovfalues of the outcome and choice parameters presented at the

fXi(X) and |xo(X) requires that P(Z) - > 1 and P(Z) -> 0 ibnase of the figure. Countries that adopt the policy are above limit sets.40 Identification in limit sets is sometimes calledaverage. In a model where the cost varies (the generalized Roy

"identification at infinity." In order to identify ATE m= odel with Uc =£ 0), and C is negatively correlated with the

E(YX - Y0\X)9 IV methods also require that P(Z) -+ 1 angdain, adopting countries could be below average.42

P(Z) - » 0 in limit sets, so an identification-at-infinity

argument is implicit when IV is used to identify this paramA-. Discrete Instruments and the Weights for LATE eter.41 The LATE parameter avoids this problem by moving the goal posts and redefining the parameter of interest away Consider what instrumental variables identify in the model from a level parameter like ATE or TT to a slope parameterof choice and outcomes described at the bottom of figure 2. Let like LATE, which differences out the unidentified constanttsh. e cost C = yZ, where the instrument Z = (Zb Zq). Higher

Alternatively, if we define the parameter of interest to bevalues of Z reduce the probability of adopting the policy if y > LATE or MTE, we can use the selection model without 0, component by component. Consider the "standard" case

invoking identification at infinity.

depicted in figure 2A. Increasing both components of discrete-

The IV estimator is model-dependent, just like the selec- valued Z raises costs and hence raises the return observed for

tion estimator, but in application, the model does not have tothe country at the margin by eliminating adoption in low-return

be fully specified to obtain AIV using Z (or 7(Z)). However, countries. In general, a different country is at the margin when the distribution of P(Z) and the relationship between P(Z)different instruments are used.

and 7(Z) generates the weights. The interpretation placed on Figure 3A plots the weights and figure 3B the compo-

AIV in terms of weights on AMTE depends crucially on the nents of the weights for the LATE values using P(Z) as an specification of P(Z). In both control function and IVinstrument for the distribution of Z shown at the base of the

approaches for the general model of heterogeneous re- figure. Figure 3C presents the LATE parameter derived

sponses, P(Z) plays a central role.

using P(Z) as the instrument. The weights are positive as

Two economists using the same instrument will obtainpredicted from equation (22) when 7(Z) = P(Z). Thus the

the same point estimate using the same data. Their inter-monotonicity condition for the weights in terms of uD is

pretation of that estimate will differ depending on how theysatisfied. The outcome and choice parameters are the same

specify the arguments in P(Z), even if neither uses P(Z) asas those used to generate figures 1 and 2. There are four

an instrument. By conditioning on P(Z), the control func-LATE values corresponding to the five distinct values of the

tion approach makes the dependence of estimates on thepropensity score for this example. The LATEs exhibit the

specification of P(Z) explicit. The IV approach is lessdeclining pattern with uD predicted by the Roy model.

explicit and masks the assumptions required to economi- A more interesting case is that depicted in figure 2B. In

cally interpret the empirical output of an IV estimation. Wethat graph, the same Z are used to generate choices as in

now turn to some examples that demonstrate the mainfigures 2 A and 3. In this case, however, the analyst uses Zx

points of this paper.

as the instrument, Zx and Z2 are negatively dependent, and

E(Zx\P(Z)>uD) is not monotonic in uD. This nonmonotonic-

V. Examples Based on Choice Theory

ity is evident in figure 4B. This produces the pattern of negative weights shown in figure 4A. These are associ-

ated with two-way flows. Increasing Zb controlling for

Return to the policy adoption example presented inZs2e,c-reduces the probability of country policy adoption.

tion I. The cost of adopting the policy C is the same acroHssowever, we do not condition on Z2 in constructing this

all countries. Suppose that countries choose to adoptftighuere. It is floating. Two-way flows are induced by

policy if D* > 0, where D* is the net benefit of adoptuionnco: ntrolled variation in Z2. For some units, the strength

D* = Yx - Yo - CandATE = £((3) = E(YX - Yo) = ^ - of the associated variation in Z2 offsets the increase in Zb

|x0, while treatment on the treated is E ((3 | D = 1) =and for other units it does not. Observe that the LATE

E (Yx - Y0\D = 1) = ^ - jio + E(UX - U0\D = 1). parameters defined using P(Z) are the same in both

In this margin is

setting, C:

the

gross

return

to

the

country

at

theexamples. They are just weighted differently. We the random-coefficient-choice model generating

discuss figure

2C in section VII.

40 See Imbens and identification in the

Angrist (1994). limit argument

fHoerckAmTEanin(1s9e9le0c)teiosntabmliosdheelTss. htSheeee IV

estimator

does

not

identify

ATE,

TT,

or

TUT

Heckman and Navarro (2006) for a generalization to multiple-oguitvceonmaet the bottom of figure 3. Conditioning on Z2 produces

models.

positive weights, as shown in the weights in table 2 that

41 Thus if the support of P(Z) is not full, we cannot identify the treatment

on the treated or the average treatment effect. We can construct bounds.

See Heckman and Vytlacil (1999, 2001a,b, 2007b).

42 See, for example, Heckman (1976a,b).

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

MODELS WITH ESSENTIAL HETEROGENEITY 403
Figure 2. - Monotonicity: The Extended Roy Economy
Outcomes Choice Model
Yi-a + 0 + U! \0 if Fx-Fo-7^^0 Y0 = a + U0 with 7Z = 71 Zx + 72Z2 Parameterization (Ui , t/0) ~ N (0, E) ,[_E-u=.y fo 1* jo ~^'9 , a = 0.67, 0 = 0.2, 7 = (0.5, 0.5) (except in Case C)
Zi = {-1, 0, 1} and Z2 = {-1,0,1}
A. Standard Case B. Changing Zi without Controlling for Z2 C. Random Coefficient Case
z - > 2;' 2 - > zr or 2 -  z" z - > z'
z = (0, 1) and z' = (1, 1) 2 = (0, 1), 2' - (1, 1) and z" - (1, -1) z = (0, 1) and z' = (1, 1)
7 is a random vector
7 = (0.5,0^5) and ^ = (-0.5,0.5)
where 7 and 7 are two realizations of 7
£>(7*) > D(jz') D(<yz) > D(-yzf) or D(jz) < D(-yz") D 0?z) > L> ^z') and D (yz) < D (yzf)
For all individuals Depending on the value of zf or z" Depending on value of 7
condition on Z2. Conditioning on Z2 effectively converOttshtehrewise it is just a weighted average of ordered (by p) problem back into one with a scalar instrument, anedstitmheators consistent with two-way flows. weights must be positive for that case.
By Yitzhaki's result (23), for any sample size, a regres-
B. Continuous Instruments
sion of Y on P identifies a weighted average of slopes based
on ordered regressors [E(Y\pe) - E(Yt-i\p-i)]/(pe - pe-\F)o, r the case of continuous Z, we present a parallel where pe>pe-\ and where the weights are the posiatnivaleysis for the weights associated with the MTE. Figure Yitzhaki weights derived in appendix C, in Yitzhaki 5(1p9l8o9t,s E(Y\P(Z)) and MTE for the models generated by 1996), or in Yitzhaki and Schechtman (2004). The wtehigehptsarameters displayed at the base of the figure. In are positive whether or not monotonicity (IV-3) hocldas.esIfI and II, (3 JL D. In case I, this is trivial, bemonotonicity holds, IV is a weighted average of LcAaTusEes.P is a constant. In case II, (3 is random, but
This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

404 THE REVIEW OF ECONOMICS AND STATISTICS Figure 3. - IV Weight and Its Components under Discrete Instruments when P(Z) Is the Instrument: The Extended Roy Economy

The model is the same as the one presented below Figure 2.
K-l
ATE = 0.2, TT = 0.5942, TUT = -0.4823 and A$Z) = ]T ALATE (pe,pe+i) \i = -
t=\

alate {p£ } = E(Y\P(Z)=pe+l)-E(Y\P(Z)=pe) _^(pw-P) + gi/1-^(0(^-1(l-P^i))-^(^1(l-P)))

Efe-^(P(^)))E/fe,Pt) t(Pt-E(P(Z)))f(pt)

\e = (mi-p,)^

(joint

Joint Probability Distribution of (Zi, Z2) and probabilities in ordinary type (Pr(Zt = z\, Z2 =
II Zi\z2 1 -1 0 r=== -1 0.02 0.02 0.36
(?.7^<? 0.^0^ ^5^5
0 0.3 0.01 0.03
0.6402 0.5409 0.4388
1 0.2 0.05 0.01

the Pr z2)); p

Cov(Zi,Z2) = -0.5468

selection into D does not dependthoenrpig.hCt apsaeneIIlI(fiisgutrhee 5B). It is a constant f model with essential heterogeneity(f(l(a3t JMLTD E)),. T buhte dleefctli-ning in UD = P(Z) fo hand side (figure 5A) depicts E(Ys\ elPec(Zti)o)nfoonr tthheegtaihnr. eAe simple test for linea cases. Cases I and II make E(Y\P(Zth))e loiuntecaormeineqPu(aZti)on (sereeveals whether or not equation (17)). Case III is nonlineacrasiens IPa(Zn)d. T IIh(ips JarLisDe)sor case III (p X D). when (J JL D. The derivative of E(k Ye\ePp(Zc)o)nidsitpiron esin engtoend X inimplicit.

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

MODELS WITH ESSENTIAL HETEROGENEITY 405 Figure 4. - IV Weight and Its Components under Discrete Instruments when Z\ Is the Instrument: The Extended Roy Economy

The model is the same as the one presented below Figure 2. The values of the treatment parameters are the same as the ones presented below Figure 3.

A£ = E ALATE (w.Pm-i) A< = 0.1833
e=i

I

K

^(«M-B

Xt = {Pf+l - Pt) -

(joint

Joint Probability Distribution of (Z\,Z<2) and probabilities in ordinary type (Pr(Zi = z\, Z2 = 2
Zi\Z2 1-10 1 11
-1 0.02 0.02 0.36
0.7309 0.6402 0.5409
0 0.3 0.01 0.03
0.6402 0.5409 0.4388
1 0.2 0.05 0.01

Cov(Zi,Z2) = -0.5468

The MTE gives the mean marginEa(Y l {re-tY u0r\ nDfo=r1p , ePr(sZo)n=s p), declines in/? who have utility P(Z) = uD (P(Z)d=eculiD neiss in thueDm ). aTrhgein effoefct of treatment

indifference). Those with low uD valguievs ehnavep,hiA ghTMrTet(upr)n=s. E{YX - Y0\D = Those with high uD values havedleocw linresetiunrpn.sO . bFsiegruvreet5hat
highlights that the MTE (and the LATE) identify average

LATE(p,//) = p,_p P returns for persons at the
levels of the mean utility

m fuanrcgtin ionofPi(n Zd ).ifferen^c(epa't)pd'if~fer^eTnTt (p)p

Figure 6A plots MTE and LATE for different intervals of

uD using the model generating figure 5. LATE is the chord

of E(Y\P(Z)) evaluated at different points. The relationship

MTE = -&-' between LATE and MTE is depicted in the right panel of
figure 6. LATE is the integral under the MTE curve divided

by the difference between the upper and lower limits. The treatment parameters assocW iateecdanwigtehnecrasaeteIIaIllaroef the treatment p
plotted in figure 7. The MTE is tA he^Osa?m ). e as that pres-

ented in figure 5. ATE has the sam Meatvcahliuneg foonrPal=l pp.(w Thhiech is equivalent to

effect of treatment on the treateld easftorsqPu(aZr)e=s,pg,ivAe1n7^P) == p) produces a bia

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

406 THE REVIEW OF ECONOMICS AND STATISTICS
Table 2. - The Conditional Instrumental Variable Estimator (Ajjz, = -,) and C (ALATE(p^, Pt+\\Z2 = Zl)) WHEN Z\ IS THE INSTRUMENT (GIVEN Z2 = Zl): THE Z2 = -1 Z2 = 0 Z2 = 1
P(-l,Z2)=p3 0.7309 0.6402 0.5409 P(0,Z2)=P2 0.6402 0.5409 0.4388 P(l,Z2)=pi 0.5409 0.4388 0.3408
Ai 0.8418 0.5384 0.2860 A2 0.1582 0.4616 0.7140
ALATE(pi,p2) -0.2475 0.2497 0.7470 ALATE(p2,p3) -0.7448 -0.2475 0.2497
A7l\z2=Z2 -0.3262 0.0202 0.3920
The model is the same as the one presented below Figure 2

/-I

7-1

Az[|z,=«

=

E

A"TM Pe+i - Pe

ii

i

fe

^

\ / \ i=l t>£
Mz>=z. \ = (Pt+i / - Pd \

(

\

t>£

Probability Distribut

~zx I Pr(Zi
-1 0.0385 0.25 0.9

=

zx\Z2

0 0.5769 0.125 0.075

1

I

TT(p). duceM s a model witha continut ous instc rumentsh , where in

margin E(J(Z)\a P(Z) >l uD) (withr J(Z) = e J(Z) - t E{J{Z))u ) need nr ot

A17^)
observables alike makes the unobservables dissimilar. Hold-

be i monotn onic in uD. Such aa data-generatinm g process for tho e instrument could arise from an ecological model in which

ing p constant across treatment and control groups under-two different populations are mixed (for example, rural and

states TT(p) for low p and overstates it for high p.

urban populations).44

We now present additional examples with continuouslyAt our Web appendix, we derive explicit instrumental

distributed instruments. See figure 8. Instrument Z is vaasr- iable weights on AMTE when Z\ (the first element of Z) is sumed to be a random vector with a distribution function used as the instrument, that is, J(Z) = Z\ for this case. For

given by a mixture of two normals:

simplicity we assume that there are no X regressors. The

Z-PiMk1,21) + P2Mk2,22),

probability of selection is generated by |xD (Z) = yZ. The joint distribution of (Zb yZ) is normal within each group.

where Pi is the proportion in population 1, P2 is the In our example, the dependence between Zx and

proportion in population 2, and P\ + P2 = 1. This pro- yZ (= Fyiyz) = P(Z)) is negative in one population and

43 See Heckman and Vytlacil (2005, 2007b).

44 Observe that E(Z) = P,k, + P2k2.

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

MODELS WITH ESSENTIAL HETEROGENEITY 407 Figure 5. - Conditional Expectation of Y on P(Z) and the Marginal Treatment Effect (MTE): The Extended Roy Economy

Outcomes Choice Model
v .*.rr n / lifD* >0
Yo = a + Uo Case I 1 Case II I Case III
Ui=U0 Ux-UoALD _ Ui-UqXD
(5 =ATE=TT=TUT=IV 0 =ATE=TT=TUT=IV (3 =ATE^TT^TUT^IV
Parameterization
Cases I, II and III I Cases II and HI 1 Case III a = 0.67 (t/i,t/o)~N(O,£) D* =Y1-Y0--yZ
^ = 0.2 withE = [_Jg "J-9] Z~N(vz^z) 1Mz7= -(2(0,--25)a,n0d.E5z=) [^2 "g2]

positive in another. Thus in one populatioTnh,eads iZsxcrientcerecahsoeisc,e equation is a conventional

P(Z) increases. In the other population atsheZxotihnecrreeaxsaem s, pPl(eZs). The outcome equations are

decreases. If this second population is sufm fiaclieenqtuly atiboings(.PTi hisus AMTE(t;) = E(YX - Y0\V =

small) or the negative dependence in theinsevc:ond population

is sufficiently big, the weights can become negative because

E(J(Z)\P(Z) > uD) is not monotonic in uD.

Cov(t/, - £/0,V)

We present examples for a conventional normal outcome
E(YX - Y0\V=v) = 1^,-^0 +
model generated by the parameters at the bottom of figure 8.

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

408 THE REVIEW OF ECONOMICS AND STATISTICS
Figure 6. - The Local Average Treatment Effect: The Extended Roy Economy

Pe+i
f AMTE(uD)duD AA alatea , l [Pa i,t Pie +i),n x = [Pi,Pi+i) n x =
Pe+i-Pe Pt+i-pt
ALATE(0.6,0.9) = -1.17 ALATE(0.1,0.35) = 1.71

Outcomes Choice Model

K-. + J +
Y0 = a + U0 with D* =Y1-Y0- jZ
Parameterization
(C/i, Uo) ~ N (0, S) and Z ~ N {nz, Sz)

W

"'{l^

s=[-S.9 -;-9]'^=(2'-2)ands^[-2 "92]
a = 0.67,^ = 0.2,7 = (0.5,0.5)

At the bottom of the figure, we define P = |Xi - |x0 eafnfdecat =of treatment on the treated (E(YX - Y0\D = 1)), that of

|x0. The average treatment effects are the same tfroeratmalelnt on the untreated (E(Yi - Y0\D = 0)), and the average

distributions of the Z

treatment effect (E{YX - Yo)) produced by our model.

In each of the following examples, we show results for In standard IV analysis, the distribution of Z does not

models with vector Z that satisfies IV- 1 and IV-2 and with affect the probability limit of the IV estimator. It only

7 > 0 componentwise, where 7 is the coefficient on Z aifnfects its sampling distribution. Figure 8A shows three

the cost equation. We vary the weights and means of twheeights corresponding to the perturbations of the vari-

instruments. Ceteris paribus, an increase in each compoa-nce of the instruments in the second component popu-

nent of Z increases Pr(D = 1 | Z = z). Table 3 presents thlaetion 22 and the means (ki, k2) shown in table 3. The

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

MODELS WITH ESSENTIAL HETEROGENEITY 409 Figure 7. - Treatment Parameters and OLS/Matching as a Function of P(Z) = p

Parameter Definition Under Assumptions (*) Marginal Treatment Effect E [Yi - Y0\D* = 0, P(Z) = p] 0 + a^-u^'1^ - p)
Average Treatment Effect E [Yx - Y0\P(Z) = p] ~0
Treatment on the Treated E [Yi - Y0\D* > 0, P(Z) = p] 0 + ^ Treatment on the Untreated E [Yx - Y0\D* < 0, P(Z) = p] 0 - <T
OLS/Matching on P{Z) E[YX\D* > 0,P(Z) = p] -E[Yo\D* < 0,P(Z)=p] 0
Note: $ (·) and 0 (·) represent the cdf and pdf of a standard normal distribution, respectively. $~1 (*): The model in this case is the same as the one presented below Figure 6.

MTE used in all of our examples is ptlivoetatned dsomin etimfeisgnuegrateive8, aBnd. oscillates wildly in

The MTE has the familiar shape, repmoargntiteudde dienpenH dinegcokn m theadnistribution of the instru-

(2001) and Heckman, Tobias, and Vmyenttsl. aThceielsti(m2at0ed0"3ef)f,ectt" h is oaftten way off the mark

returns are highest for those with vafolruaensy doefsirevd ttrh eatamtenm t paarkameeter. These examples

them more likely to get treatment s(htoh w ahotw iunsi,forlmoiw ty invZadlouesensot translate into unifor-

oft;).

mity in J(Z) (Z\ in this example). This sensitivity is a

The weights o>! and a>3 correspond to the case where

phenomenon that does not appear in the conventional

E(Z\ - E(Z\) | P(Z) > uD) is not monotonic in uD. In these

homogeneous response model but is a central feature of a

cases the relationship between Z\ and P(Z) is not the same

model with essential heterogeneity.46

in the two subpopulations. The IV estimates range all over

the place, even though the parameters of the outcome and

C. Empirical Example: Using IV to Estimate the "Effect"

choice model are the same.45 Only the distributions of the

of High School Graduation on Wages

instruments are different.
Different distributions of Z critically affect the probability limit of the IV estimator in the model of essential heterogeneity. The model of outcomes and choices is the same across all of these examples. The MTE and ATE parameters are the same. Only the distribution of the

The previous examples demonstrate logical possibilities. This subsection shows that these logical possibilities arise in real data. We study the effects of graduating from high school on wages, using data from the National Longitudinal Survey of Youth 1979 (NLSY79). This survey gathers

instrument differs. The IV estimand is sometimes posi-
45 Because TT and TUT depend on the distribution of P(Z), they are not invariant to changes is the distribution of the Z

46 We note parenthetically that if we assume that P, = 0 (or P2 = 0), the weights are always positive even if we use only Zx as an instrument and Zx and Z2 are negatively correlated. This follows from the monotonicity of E(R\S > c) in c for vector R. See Heckman and Honore" (1990).

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

410 THE REVIEW OF ECONOMICS AND STATISTICS Figure 8. - Marginal Treatment Effect and IV Weights using Zx as the Instrum for Different Values of 22
Outcomes Choice Model
V  O , TT n f 1 if D*>0 Y1=a V +  fi O + , U1 TT D=| n q 1 if .f ^q D Yo = a + C/o £>* = Yi - r0 - lZ and V = - (Ui - Uo)
Parameterization
(£/i,tfo)~W(O,E), S = f Jg "J'9l, a = 0.67, ^ = 0.2
Z = (Zi, Z2) ~ PiN{ku Ex) + p2iV(«2, E2)
Pi - 0.45, p2 - 0.55 ; Ei = [ J^ J^ 1
Cov(Zi,7Z)=7E}=0.98 ; 7 -(0.2, 1.4)
Table 3. IV estimator and Co\{Z2^Z) associated with each value of £2
Weights] E2 I *i I k2 I IV I ATE 1 TT | TUT | Cov(Z2,7Z) = 7E^
o;i -0.5-0.°5n60,.6~j°.L5 J 0.6L [J00] L J [00] L J 0.434 0.2 1.401 -1.175 uj2 0 10 6 [ ° ° ] [ ° ° ] °-078 °-2 1-378 -1-145 °-26
lj3 °n6- o U "°..o 3 [UL.D0 L -1j jl ]j [01] l j -2.261 0.2 1.310 -0.859 -0.30
information at mulm tio pt le he pro's ing tr s aid n ua tt im ion e o st n activities for men aw ne dig w ho tm s o en L bA or T n E iu nsitn hg e
We estimate LATE bausseid ngon log eqh uo au tr io ly n w (2a the outcome measu pr oe s.itF iv oleloaw nid ng neagl aa tr iv ge (see Mare, 1980), in wse tru usm e etn hte an re um bo b te h r
This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

MODELS WITH ESSENTIAL HETEROGENEITY 411
Figure 9. - IV Weights: The Effect of Graduating from High School: Sample of High School Dropouts and High School Graduates: White Males- NLSY79

Y = Log per-hour wage at age 30, Z\ = Number of Siblings in 1979, Z2 = Mother is a High Sch
n ~ _ f 1 if High School Graduate ~ \ 0 if High School Dropout
IV Estimates
(bootstrap std. errors in parenthesis - 100 replications)
Instrument Value
Number of Siblings in 1979 0.115 (0.695)
Propensity Score 0.316

Joint

Probabi

(joint

probabilitie

"JT\Zi 1 0 1 1 I 2 1 3 1 4 11

0 0.07 0.03 0.47 0.121 0.06

1 0.039 0.139 0.165 0.266 0.121

Cov(Zi, Z2) = -0.066 - Number of Observations = 1, 702

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

412 THE REVIEW OF ECONOMICS AND STATISTICS

using P(Z) as an instrument arTehepweoigshtistairevpeos,itivae,sbutt, h as enoy ted m by Aungsrtist abnde,

following the analysis of Yitzh Imabek ns,ip.ersT onshcaen betcow untoed mIuV ltipleetsimtesiim n foarmtinegs

differ from each other because tth heeweiw ghtes. iWgheh n tthesy gaenrerealizd e tihf eirfanealryseisn totm.ultT iplh e- e

overall IV estimate is a crude svu alum ed inm struamreny ts, thoeyfusetthhe Yeitzhuakn i (1d98e9) rweligyhtis.ng

component LATEs, which are ofWtheeren as thleawreigghtes inaen quad tionp(26o) scanitbeicvonestruoctred

large and negative.

empirically, the quantities in braces cannot be identified by

We next turn to an extensionanyostfandaorduIVrprom ceduore.dWee lpretsenot dem comu poslittioinp s wliteh

outcomes.

components that are recoverable, whose weights can be

VI. Extensions to More than Two Outcomes

estimated from the data and that are economically interpretable.
We generalize LATE to a multiple-outcome case where

Angrist and Imbens (1995) extend their analysis owfe cLanAiTdeEntify agents at different well-defined margins of

to an ordered choice model with outcomes generchatoiecde. Sbpyecifaically, we (1) analyze both ordered and unor-

scalar instrument that can assume multiple valudeerse.dFcrhooim ce models, (2) analyze outcomes associated with

their analysis of the effect of schooling on earncihnoigcses, aittviasrious well-defined margins, and (3) develop

unclear, even under a strengthened "monotonicitmyod"elcs ownitdhim- ultiple instruments that can affect different

tion, whether IV estimates the effect of a change mofarsgcinhsooofl-choice differently. With our methods, we can

ing on earnings for a well-defined margin of dcehfioniecaen.d Tesotimate a variety of economically interpretable

summarize their analysis, let S be the number opfarapmoestesrisb, lwehereas the Angrist-Imbens analysis produces a outcome states with associated outcomes Ys andsincghleo"iccauesal parameter" (26) that does not answer any

indicators Ds, s = 1, . . . , S. The s in their analywseilsl-dceofrinreed-policy question. We first consider an explicit

spond to different levels of schooling. For any twooridnersetdruch-oice model and decompose the IV into policy-

ment values Z = z,- and Z = z,- with z,- > z,-, we caunsefduel,fiidnenetifiable components.

associated indicators {Avfe)}f=i and {D5(z/)}f=i, where

Ds(zi) = 1 if a person assigned instrument value zA,.-Acnhalyosoiss eosf an Ordered Choice Model state s. As in the two outcome model, the instrument Z is

assumed to be independent of the potential ouOtrdceoremd cehsoice models arise in many settings. In school-

{y^}^, as well as the associated indicator functioninsg dmeofdeilns,etdhere are multiple grades. One has to complete

by fixing Z at z/ and z,-. Observed schooling for tghreadeinss-t1ruto-proceed to grade s. The ordered choice model

ment Zj is S(zj)= 2s=i sDs(zj). Observed outcomeshwasibtehentwhidisely used to fit data on schooling transitions

instrument are Y(zj)= 2s=i YsDs(zj). Angrist and(HIam rmbonenansd Walker, 1999; Cameron and Heckman, 1998).

show that IV (with Z = z, and zj) applied to S in a tIwtson-osntpaagraemetric identifiability has been studied (Carneiro,
least squares regression of Y on S identifiesHaans"ecna, uansdalHeckman, 2003; Cunha, Heckman, and Na-

parameter"

varro, 2007). It can also be used as a duration model for

dynamic treatment effects with associated outcomes, as in

5

Cunha, Heckman, and Navarro (2007). It also represents the

A1V = 2) {E(YS - Ys^\S(Zi) ^ s > S(zj))}
5=2

"vertical" model of the choice of product quality (Prescott and Visscher, 1977; Shaked and Sutton, 1982; Bresnahan,

x X Pr(S(Zi)^s>S(zj)) (26)

1987). Our analysis generalizes the preceding analysis for the

x X S!=2 Pr(S(z,) > s > S(zj))'

binary model in a parallel way. Write potential outcomes as

This parameter is a weighted average of the gross return from going from s - 1 to s for persons induced by the change in the instrument to move from any schooling level below s to any schooling level s or above. Thus the conditioning set defining the s component of IV includes people who have schooling below s - 1 at instrument value Z = z7 and people who have schooling above level s at instrument value Z = z,. In this sum, the average return experienced by some of the people in the conditioning set for each component conditional expectation does not correspond to the average outcome corresponding to the gain in the argument of the expectation. In the case where 5 = 2, agents face only two choices and the margin of choice is well defined. Agents in each conditioning set are at different margins of choice.

Ys=ils(X9Us), 5= 1,...,5.
The S could be different schooling levels or product qual ties. We define latent variables D5* = |xD(Z) - V where
D5 = l[Cs-x(Ws-i) < [iD(Z) - V< Cs(Ws)l
s = 1, . . . , 5,
and the cutoff values satisfy
C5.,(^-i) ^ CS(WS), C0(W0) and Q(W§) = ».

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

MODELS WITH ESSENTIAL HETEROGENEITY 413

The cutoffs used to define the intervals are allowed to to estimate the MTE in the analysis of the two-outcome depend on observed (by the economist) regressorsmWodse.l. In

appendix D we extend the analysis to allow the cutofTfhsetaonalysis of Angrist and Imbens (1995) discussed in

depend on unobserved regressors as well, followingthsetrinutcr-oduction to this section makes independence and

tural analysis along these lines by Carneiro, Hansemno,naontodnicity assumptions that generalize their earlier work.

Heckman (2003) and Cunha, Heckman, and Navarro They do not consider estimation of transition-specific pa-
(2007). The observed outcomes are Y = Sf=1 YSDS. Thraemeters as we do, or even transition-specific LATE. We
components of Z shift the index generally; those of Ws affepcrtesent a different decomposition of the IV estimator where s-specific transitions. Thus, in a schooling example, Z couldeach component can be recovered from the data, and where include family background variables, while Ws could int-he transition-specific MTEs answer well-defined and ecoclude college tuition or opportunity wages for unskillnedomically interpretable policy evaluation questions.50 labor.47 Collect the Ws into W = (IV,, . . . , W~s\ and the Us The probability of Ds = 1 given X, Z, and W is generated into U = (f/i, . . . , Us). Larger values of CS(WS) make biyt an ordered choice model:

more likely that Ds = 1 . The inequality restrictions on the Pr(D, = l|W,Z,X) = PS(Z,W,X) functions CS(WS) play a critical role in defining the model

and producing its statistical implications. Analogous to the assumptions made for the binary out-

= pkc,-,^-,) < jiD(z) - v< cs(ws)\x).

come model, we assume

Analogous to the binary case, we can define UD = Fy(V\X = x),

so UD ~ Unif[0,l] under our assumption that the distribu-

OC-1: (t/5, V) _IL (Z,W)\X, s = 1, . . . , S (conditional tion of V is absolutely continuous with respect to Lebesgue

independence of the instruments).

measure. The probability integral transformation used ex-

tensively in the binary choice model is somewhat less useful

OC-2: |ULz)(Z) is a nondegenerate random variable con- for analyzing ordered choices, so we work with both UD and

ditional on X and W (rank condition).

V in this section of the paper. Monotonic transformations of

V induce monotonic transformations of jxD(Z) - CS(WS), but

OC-3: The distribution of V is continuous.48

one is not free to form arbitrary monotonic transformations

of |xD(Z) and CS(WS) separately. Using the probability inte-

OC-4: E(\YS\) <TM,s = 1, . . . , S (finite means).

gral transformation, the expression for choice s is Ds = 1 [Fyi^Z) - C-,0^-,)) > UD > Fy(MZ) - CS(WM

OC-5: 0 < ?r(Ds = l\X) < 1 for s = 1, . . . , 5 for alKl eeping the conditioning on X implicit, we define PS(Z,W) =

X (In large samples, there are some persons in each treatF-^D(Z) ~ CS.X(WS.X)) - Fy(iiD(Z) - CS(WS)). It is con-

ment state).

venient to work with the probability that S > s, irs (Z, Ws) =

OC-6: For s = 1, . . . , S - 1, the distribution of_C, (Ws) conditional on X, Z and the other C/W,), j = 1, . . . , S, j ' ± s, is nondegenerate and continuous.49

Fy(^D(Z) - CS(WS)) = Pr(2sj=s+] Dj = 1|Z,^), TTs(Z,Ws) = 0, TT0(Z,W0) = 1, andPs(Z,W) = -ns-x(Z,Ws-x) - t:s(Z,Ws).
The transition-specific AMTE for the transition from s to s + 1 is defined in terms of UD:

Assumptions OC-1 to OC-5 play roles analogous to their counterparts in the two-outcome model, A-l to A-5. OC-6 is

A^.U uD) = E(Ys+l - YS\X = x,UD = uD\

a new condition that is key to identification of the AMTE defined below for each transition. It assumes that we can

j=1

vary the choice sets of agents at different margins of Alternatively, schooling choice without affecting other margins of choice. the analysis of A necessary condition for OC-6 to hold is that at least one set uD = tts(Z,W element of Ws is nondegenerate and continuous conditional indifferent bet

on X, Z, and Cj(Wj) for j ^ s. Intuitively, one needs an instrument (or source of variability) for each transition. The In this notation continuity of the regressor allows us to differentiate with conditional on
respect to CS(WS), as we differentiated with respect to P(Z) conditional on e being in each st

47 Many of the instruments studied
Card (2001) are t 5r 0aV ns y it tlia o c n il -s (p 20 e0 ci 6f bi)c sufficiently richct oo nd m it ai k o e nt shie m d p is ly tin (a c and Navarro (200 o6 r)da en re d d C cu hn oh ica e, m Ho ed ck e general models omf an, LaLos ndec , anh d Smio th (1o 999)l , Ci arnn eiro,g Hansen,t andh Hecka mant ma
48 Absolutely co (20n 03), at nd i Cunn ha, Hu eckmo an,u ands Navarw ro (200i 7) t and h is analyzr ed inespe 49 Absolutely co appn endixt D. inuous with respe

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

414 THE REVIEW OF ECONOMICS AND STATISTICS

5
E(Y\Z,W) = E E(YS\DS = \,Z,W)Pr(Ds = l|Z,W) 5=1 *

additive in functions of (tts, tt5_i), so there are no interactions between tt5 and tts> if |s - s'\ > 1, that is,

s r^-,(z,w,-,) (27)
= 1 E(Y\UD = uD)duD,

a2E(rhr(z,w) = Tr)
O7TsdTTs'

s=l KS(Z,WS)

Observe that if UD JL Us for 5 = 1, . . . , 5,

where we use the conditional independence assumption

OC-1 to obtain the final expression. Analogous to the result

for the binary outcome model, we obtain the index

£(y|ir(Z,W0 = it) = £ £(y,)(ir,_, - ir,) 5=1

sufficiency restriction E(Y\Z,W) = E(Y\tt(Z,W)\ where

ir(Z,W) = [irrfZW),..., irS-i(Z;Ws-i)]- The choice

5-1

probabilities encode all of the influence of (Z,W) on= E[£(y,+ i)~£(l',)]ir, + £(J',). 5=1
outcomes.

We can identify tts(z,ws) for (z,w5) in the support of the distribution of (Z,WS) from the relationshDipeftintisn(zg,w E(Ys)s+=l) - E(YS) = A5AJ^,, we have E(Y\tt(Z,W)=tt)
= ^SSZ\ A^j tts H- ^Fj). Thus, underfill independence, we Pr(25=j+1 Dj = \\Z = z, Ws = ws). Thus E(Y \obttta(iZn,lW in)ea=ritiyt)of the conditional mean of Y in the tt/s. This

is identified for all it in the support of tt(Z, Wr).esAulstsugm enpertailoizness the test for the presence of essential hetero-
OC-1, OC-3, and OC-4 imply that E(Y\ttg(Zen,eWity) =preiste)ntiesd in section IKA to the ordered case. We can differentiate in it. So d£(r|ir(Z, W) = iri)g/ndoirre tihsewcoemllplexity induced by the model of essential

defined.51 Thus, analogous to the result obhteatienreodgenineittyhief E(Y\ir(Z,W)= it) is linear in the it's and can

binary case, we have

use conventional IV estimators to identify well-defined treat-

ment effects.52

dE(Y\*(Z,W) = tt) _
T~ - &s,S+1\Ud _ - Its)
dlTs (2g)

What Do Instruments Identify in the Ordered Choice Model? We now characterize what scalar instrument

= £(r,+1-Jr (Z,W5) i|de£ ntif/ ies. W D hen Y= is logO earn.ings, it is common

practice to regress Y on D, the completed years of schooling, Equation (28) is the anb d ca allsthiescoeff ficio enr t on Did a rae te n of rtetiurf n.5i3 c Weast eekiao n n
specific MTE from exprd essia on t foratheo IV n estima(toY r of,tZ he , efX fect )of.D on Y in the From index suffic ordi eree d cn hoicc e my odel, : we can express

5
E(Y\it(Z,W) = <ir) = 2 E(Ys\tts <Ud< tt^OK-, - ir,) 5=1

Cov(7(Z,H0,r)
Cov(7(Z,W),D)' ( ^

5-1

where D = S^=1 sDs the number of

= S [£(J;+ik+I ^ C/D < tts) - ^yjir, < t/D < irs_,a)t]Ttrasinment. We keep the conditioning on 5=1 present the weights for IV. Their full de

+ £(F1|ir1<t/D<l) (29)

in appendix E. Define Ks(v) = E(J(Z,W)\[xD(Z) - cs(W

s-i

CS(W) > v\ where J(Z,W) = J(Z,W)

= E [ms+1(7r5+1,7r,) - m^ir,,^-!)]^ 5=1

+ £(ri|ir, ^UD< 1),

ay _ ay Aw _ CovUiQ Cov(7,D) (31)

where m5(7r5, ir5_i) = E(Ys\irs ^UD< tts-{). In general this5-. r
expression is a nonlinear function of (tts,tts-\). This model = 1 E(Ys+l - Ys\V=v)u(s,v)fv(v) d
has a testable restriction of index sufficiency in the general s=l J
case: E(Y\tt(Z,W) = it) is a nonlinear function that is
where

51 For almost all it that are limit points of the support of distribution of tt(Z,W). We use the Lebesgue theorem for the derivative of an integral. Under assumption OC-6, all points in the support of the distribution of
tt(Z,W) will be limit points of that support, and we thus have that
dE(Y\Tr(Z, W) = TT)/aiT is well defined and is identified for (a.e.) it.

52 Notice that if UD X Us for some s, then we obtain an expression with nonlinearities in ir5, irs-\ in equation (29).
5S Heckman, Lochner, and Todd (2006) present conditions under wnicn
this economic interpretation is valid.

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

MODELS WITH ESSENTIAL HETEROGENEITY 415

of ATM with the decomposition (26), we see that ours corre-

<o(j,v)

=

sponds to weighting up marginal outcomes across well-defined

S%,and adjacent s boundary values experie[ nced by aK gents having s-
their instruments manipulated, whereas the Angrist-Imbens

Ks{v)

decomposition corresponds to outcomes not experienced by some of the persons whose instruments are being manipulated.

From equation (33), the IV estimator using J(Z,W) as an

2:1, Ks(v)Mv) dv

instrument satisfies the following properties: (a) The numerator
of the weights on A^^up) is nonnegative for all uD if

and clearly 25"1 f u>(s,v)fv(v) dv = 1, a>(0,v) = 0, and
(o(5, v) = 0. We can rewrite this result in terms of the MTE, expressed in terms of uD:

E(J(Z>Ws)\tts((Z,Ws) ^ Tig) is weakly monotonic in ir5. For example, if Cov(tt5(Z Ws), D) > 0, setting J(Z,W) = tts(Z,Ws) will lead to nonnegative weights on A^x(uD), though it may lead to negative weights on other transitions. A second property

A^(iid) = E(Ys+l - YS\UD = uD\
so that
Cov(7,y) 5"! f aMTE
Cov(7P)=jr{ A5;-Tl(WD)w(5,MD)rfMD, aMTE
where

(b) is that the support of the weights on A^ using tts(Z, Ws) as the instrument is (ttJ4 in, nf ax), where -rrf n and irf1* are the minimum and maximum values in the support of tts(Z,Ws), respectively, and the support of the weights on Aj^, using any other instrument is a subset of (ttJ4 m, ir^*). A third property (c) is that the weights on AJJ^ implied by using J(Z,W) as an instrument are the same as the weights on AJJS implied by using E(J(Z,W)\tts(Z,W)) as the instrument.
Suppose that the distributions of Ws s = 1, . . . , 5, are

W(J,MD)

=

degenerate, so that the Cs are constants satisfying C\ < · · · < Q_i. This is the classical ordered choice model. In this case,

2ss=l >nss (Z,Ws) = Fv(\xD(Z\ ) - O for any s = 1, [ . . . , 5.K For this s.{

h

(32) special case, using J as an instrument will lead to nonnegative

Ks(uD)

weights on all transitions if J(Z, Ws) is a monotonic function of jxD(Z). For example, note that \ld(Z) - Cs > v can be written

2ssl\ Ks(uD)duD

as |xD(Z) > Cs + F^l(uD). Using |xD(Z) as the instrument leads
to weights on Aj^?, (uD) of the form specified above with
Ks{uD) = [E(tiD(Z) I ^(Z) > Fj\uD) + Q - £(MZ))]

and

X Pr(jjLD(Z) > I\\uD) + Q. Clearly, these weights will be

nonnegative for all points of evaluation and will be strictly

Ks(uD) = £(J(Z,W)K(Z,Hg > iid)
X Pr(iT5(Z,W5) > nD).

positive for any evaluation point uD such that 1 > Pr(|xD(Z) > F^l(uD) + Cs) > 0. We now present some examples of the weights for IV.

Compare equations (32) and (33) for the ordered choice model with equations (19) and (20) for the binary choice model. The numerator of the weights for the AMTE for a particular transition in the ordered choice model is exactly the numerator of the weights implied for the binary choice model, substituting us(ZfWs) = Pr(D > s\Z,Ws) for P(Z) = Pr(D = l|Z). The numerator for the weights for IV in the binary choice model is driven by the connection between the instrument and P(Z). The numerator for the weights for IV in the ordered choice model for a particular transition is driven by the connection between the instrument and tts(Z,Ws). The denominator of the weights is the covariance between the instrument and D for both the binary and ordered cases. However, in the binary case the covariance between the instrument and D is completely determined by the covariance between the instrument and P(Z), whereas in the ordered choice case the covariance depends on the relationship between the instrument and the full vector [tti(Z, WO, . . . , tts-\(Z> Ws-i)]. Comparing our decomposition

Examples of Weights for IV Figures 10 and 11 plot the transition-specific MTEs and the IV weights for the models and distributions of the data at the bottom of each of the figures. We work with a normal V and U^ so we get MTEs linear in V from standard normal regression theory. The IV
estimates using Z and W\ as instruments are reported transition by transition, along with the overall decomposition of the IV representation (31) into its transition-specific components.54
54 In particular, when J(Z) is used as the instrument, we decompose hTMja) as
5-1 r
Aiv,(Z, = |J E(Ys+i _ Ys\V=vW{z\s,v)fv(v)d
5-1 r
~s-\
_ V AlVy,Z) ~ _ Zj as,s+\'
s=l

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

416 THE REVIEW OF ECONOMICS AND STATISTICS
Figure 10. - Treatment Parameters and IV: The Generalized Ordered Choice Roy Model under Normality: Case I
Outcomes Choice Model
Yi^a + fa+Ui D. = l\W.-i<-rZ-V£W.] Y2=a + 02 + U2 s = 1,2,3 Y3=a + 03 + U3
Parameterization
(Ui, U2, U3, V)~N (0, Suv) , (Z, WX,W2) ~ N (jiZW, Ezw) and Wo = -oo; W3 = oo.
°TM 1 0.16 0.2 -0.3 j f 0.1 0 0 I
*vv= °TM S"S °'i16 °n? ,/*zw = (-0.6,-1.08,0.08) and EZwr= 0 0.1 -0
[ -L -ol -J.4 i \ ,/*zw L ° -009 °-25 Cov(t/2 -Ui,V) = -0.02 Cov(U3 -U2,V) = -0.08 Pi = 0; ft = 0.025; ft = 0.3; 7 = 1 IV Estimates and Their Components* Parameter Value A1V* 0.1489 A1^* 0.0JJ7 A^z 0.1372 A1Vvvi 0.0017 A^1 -0.0308 Treatment Parameters and Their Values ATEl2 = E(Y2-Yi) ATE23 = E(YS-Y2) 0.275 TT12 = E(Y2- Yl\D2 = 1) 0.0271 TT23 = E(Y3- Y2\D3 = 1) 0.1871 TUT12 = E(Y2-Y1\D1 = 1) 0.0047 TUT23 = E(Y3- Y2\D2 = 1) 0.2854
*AIVz is decomposed as:
AIV* = f E(Y2- Yi\V = v)uz (l,v)fv (v)dv+ f E(Y3- Y2\V = v)uz (2,v)/v (v)dv = A^z + A^z
An analogous decomposition applies to A wi .
This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

MODELS WITH ESSENTIAL HETEROGENEITY 417
Figure 11. - Treatment Parameters and IV: The Generalized Ordered Choice Roy Model under Normality: Case II
Outcomes Choice Model
Y1 = a + ft + tfi Ds = l[Wa.x <yZ-V^Ws] Y2 = a + p2 + U2 s = l,2,3
Y3 = ol + 03 + U3
Parameterization
(tfi,t/2,£/3,V0~AT(0,£W), (Z,Wi,W2)-^(Mzw,SZwr) and Wo = -oo; W3 = oo.
nifi S'S n°i2R Tn0^! [ 0.1 0.092 -0.036]
*uv= 09 nifi 1 -0 4 ' **zw = (-0.6,-1.08,0.08) and Ezvy= 0.092 0.1 -0.09
-0.3 09 -0.32 nifi -0.4 1 -0 1 4 J ' l "0.036 -0.09 0.25 J Cov(U2 -UUV) = -0.02 Cov(U3 -U2,V) = -0.08 px = 0; 02 = 0.025; /?3 = 0.3; 7 = 1
IV Estimates and Their Components*
Parameter Value
~EF^ -1.8091
Aj2Z 0.2866
ATMz -2.0957
A1Vvvi -0.4284
ATMWl 0.0909 A2V3W> -0.5193
Treatment Parameters and Their Values Parameter Value
ATEi2 = £>(y2-^i) 0.025
ATE23 = ^(V3-y2) 0.275
TT12 = E{Y2-Y1\D2 = 1) 0.0283 TT23 = E(Y3- Y2\D3 = 1) 0.1754 TUTi2 = E(Y2-Yl\D1 = 1) 0.0025 TUT23 = E (Y3 - y2l^2 = 1) 0.2898
+ See the footnote below Figure 10 for details of the decomposition of AIVz . An analogous decomposition is used for AIVvvi .
This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

418 THE REVIEW OF ECONOMICS AND STATISTICS

The IV weights are defined by feinqitue antumioben r osf e(l3em2e)ntsa. n Thde re(w3ar3d)(.psT ych hiceand mone-

bottom table presents the transitiotan ry-) sop f echcoiofsiincg jtErJe"aits ment param-

eters.

In figure 10, the IV weights based on Z and W\ are very Rj(Zj) = *j(Zj) - Vj9 (34)

different. So, correspondingly, are the IV estimates produced from each instrument, which are far off the mark ofwhere Z7 are the agent's observed char
the standard treatment parameters shown at the bottom of the utility from choosing choice j, and the table. Observe that the IV weight for W\ in the second shock to the agent's utility from choic transition is negative for an interval of values. This accountsrandom vector containing all unique for the dramatically lower IV estimate based on W{ as thethat is, Z is the union of {Zj}jej. We wr instrument. Figure 11 shows a different configuration ofleaving implicit that Rj( · ) only depend
(Z,W\,W2). This produces negative weights for Z for bothof Z that are contained in Zj. Let transitions and a negative weight for W\ in the secondvariable for whether the agent wou transition. For both instruments, the IV is negative evenconfronted with choice set J7:51

though both MTEs are positive throughout most of their

range. IV provides a misleading summary of the underlying marginal treatment effects. In digesting figures 10 and 11, it is important to recall that both are based on the same

D =fl if Rj^Rk VfcEj:
[o otherwise.

structural model. Both have the same MTE and average Let Ij denote the choice that would be m

treatment effects. But the IV estimates are very different, confronted with the choice set J\

solely as a consequence of the differences in the distribu-Yj be the outcome variable that woul

tions of instruments across examples.

agent faced the choice set J, It is

These simulations show a rich variety of shapes and signs for the weights. They illustrate a main point of this paper -

Yj= IDjjYj, (35)

that standard IV methods are not guaranteed to weight

marginal treatment effects positively or to produce estimates

close to any of the standard treatment effects. Estimators based on LIV and its extension to the ordered model (28)

where Yj is
is chosen.

the potential outco
This expression

identify AMTE for each transition and answer policy-relevantassume that Yj is determined b

questions.

We

now

turn

to

development

of

a

more

generualnaobsv erveedcratndoomrveco torf . LettXh deneote

agent's observe the random vector

unordered model.

containing all unique elements of {Xj}jEj, that is, X is the

B. Extension to Multiple Treatments That Are Unordered union of {Xj}jeJ. We assume that (Z, X, Ij, Yj) is ob-
served.58 Define Rj as the maximum obtainable value given In this subsection, we develop a framework for multipclhe oice set J\

treatments with a choice equation that is based on a non-

parametric version of the classical multinomial choice Rj=max{Rj}= 2 Djjtj.
model.55 Within this framework, treatment effects can be

defined as the difference in the counterfactual outcomes that

would have been observed if the agent had faced differenWt e obtain the traditional representation of the decision

choice sets, that is, the effect of the individual being forpcreodcess that if choice j is optimal, choice; is better than the

to choose from one choice set instead of another.

next best option:

We analyze the return to the agent of choosing between
option j and the next best option. The analysis of this caseIj = je>Rj^Rj\j,

is very similar to the analysis presented in section III in thwaht ere J\j means J'with the yth element removed. More it converts a multiple choice problem to a binary choicgeenerally, a choice with K optimal means that the highest problem. Exclusion restrictions allow analysts to identifvaylue obtainable from choices in 7Cis higher than the highest generalizations of the LATE parameter and MTE paramvea-lue that can be obtained from choices outside that set: ters corresponding to the effect of one choice versus the next

best alternative. This identification analysis does not require
56 More consistently with the notation used in the previous section, we

large support assumptions.

could define Rj (Zj) = D*. A more precise, but tedious notation would use

Consider the following model with multiple outcomRej (Zj, Vj\ but we use the simpler notation.

states. Let J denote the agent's choice set, containing a57 We will impose conditions such that ties {Rj = Rk \orj =£ k) occur with
probability 0.

58 One possible extension is to the case where one does not observe

55 Heckman and Navarro (2006) and Heckman and Vytlacil (20w07haic)h choice was made, but only whether one particular choice was made,

present a semiparametric analysis of identification for the multinomtihaal t is, one observes DJ>0 but not Ij. The analysis of Thompson (1989)

choice model.

suggests that this extension should be possible.

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

MODELS WITH ESSENTIAL HETEROGENEITY 419

lj E K&RK>RJXK.

imposes an exclusion restriction, that for any jzJ, Z

contains an element such that (i) it is contained in Zp (ii) it

is not contained in any Zk for k ¥= j, and (iii) fy( · ) is a As we will show, this well-known representation, usnedonbtryivial function of that element conditional on all other

Lee (1983), Dahl (2002) and others, is key for undersrteagnrde-ssors. Assumption B-2b strengthens B-2a by adding a

ing how nonparametric instrumental variables estimatessmthoeothness assumption. A necessary condition for B-2b is

effect of a given choice versus the next best alternativet.hat the excluded variable has a density with respect to

Analogously to our definition of Rj, we define Rj{Lze)bteosgue measure conditional on all other regressors and

be the maximum attainable value given the choicfeorseftt/ · ) to be a continuous and nontrivial function of the

^Jwhen instruments are fixed at Z = z,

excluded variable.61 Assumption B-2a is used to identify a

Rj{z) = max{Rj(z)}.

generalization of the LATE parameter. Assumption B-2b will be used to identify a generalization of the MTE param-

eter. We will strengthen B-2b to a large-support assumption

Thus, for example, a choice from /C is optimal when intsotriud-entify ATE, though that strengthening will not be

ments are fixed at Z = z if Rk(z) - Rj\k(z)-

required for most of our analysis. Assumptions B-2a and

We make the following assumptions, which generBal-i2zbe mirror A-2 and are analogous to OC-2 and OC-6 in an

assumptions A- 1 to A-5 for the multiple-treatment casoerdaenrded choice setting.

are presented in a parallel fashion (B-2 is stated below): Definition of Treatment. Treatment effects are defined

B- 1 : { ( Vj, Uj) }jEj is independent of Z conditional onas Xth. e difference in the counterfactual outcomes that would

have been observed if the agent faced different choice sets. B-3: The distribution of ({ V,}7 G j) is absolutely Fcoorn-any two choice sets /C, C C J, define AKC = YK~ Yc, tinuous with respect to Lebesgue measure on UjsJ M.the effect of the individual being forced to choose from

B-4: E\Yj\ < oo for all; Gj.

choice set K, rather than choice set C. The conventional treatment effect is defined as the difference in potential

B-5: Pr(Ij = j\X) > 0 for all j E J.

outcomes between two specified states,

Assumptions B-l and B-3 imply that Rj i=- Rk w.p. 1 forA*, =Yk- y,

j =£ k, so that argmax {Rj} is unique w.p. 1. Assumption B-4

is required for the mean treatment parameters to bewhwieclhl is nested within this framework by taking K= {k},

defined.59 Assumption B-5 requires that at least some inCd=i-{(,}. It is the effect for the individual of having no

viduals participate in each program for all X.

choice except to choose state k rather than having no choice

Definitions of the treatment parameters only requireexacs-ept to choose state .

sumptions B-l and B-3 to B-5. However, we use exclusiAo/nc,£ will be 0 for agents who make the same choice

restrictions to secure identification. Let Z^ denote the ywthhen confronted with choice set K, and choice set C . Thus,

component of Z Let Z[~j] denote all elements of Z exIckep~tIc implies AKC = 0, and we have

for the y'th. We will work with two alternative assumptions for the exclusion restriction:60

A/cx = 1(1 c * 1k)&K\cx

B-2a: For eachy E J, their exists at least one element of Z, say Zw, such that Z^ is not an element of Zh k =£ y, and such that the distribution of fy(Z;) conditional on (X, Z[~->])

= 1(IC±IK)( SDkaA (36) \jGK\C I

is nondegenerate.

Two cases will be of particular importance for our anal-

B-2b: For eachy E J, their exists at least one elemeynstiso.fFirst, consider the choice set K = {k} versus choice Z, say Z^\ such that Z^'1 is not an element of Zh k =£ js,eatnCd = J\ {k}. In this case, A^j^t is the difference between
the agent's potential outcome in state k versus the outcome such that the distribution of fy (Zj) conditional on (X, tZh[~aJt ]w) ould have been observed if he or she had not been is absolutely continuous with respect to Lebesgue measure.
allowed to choose state k. If Ij = k, then ^k,j\k is the

Assumption B-2a requires that the analyst be abldeiftfoerence between the outcome in the agent's preferred

independently vary the index for the given value functisotna.teItand the outcome in the agent's next best state. Second,

59 It allows us to integrate to the limit.

61 B-2b can be easily relaxed to the weaker assumption that the support

w We work here with exclusion restrictions for ease of exposition. Boyf ftj{Zj) conditional on (X, Z[~e]) contains an open interval, or further

adapting the analysis of Cameron and Heckman (1998) and Heckman anwdeakened to the assumption that the conditional support contains at least

Navarro (2006), one can modify our analysis to encompass the case of onnoe limit point. In these cases, the analysis of this section goes through

exclusion restrictions if Z contains a sufficient number of continuous

without change for points within the open interval or more generally for

variables and there is sufficient variation in the ftk function acrosasnky. limit point.

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

420 THE REVIEW OF ECONOMICS AND STATISTICS

consider the choice set /C = J versus the choice set C = general be dependent on Z conditional on X.62 In other wor
J\{k}. In this case, Aj-^ is the difference between tehven though Z is conditionally independent of each individu agent's observed outcome and what his or her outcompeotential outcome, it is correlated with which choice is optim
would have been if state k had not been available. Note that within the sets 7C and C and thus is related to YK - YC-

^J,j\k = ^j,k^k,j\k- Thus, there is a trivial connection

between the two parameters Ajj^ and A*^ This paperIdentification: Effect of Option j versus Next Best Altern

focuses on A*^, the effect of being forced to choose optiotnive. We now establish identification of treatment para

k versus being denied option k. However, one can expleotiters corresponding to averages of Ay j\7, the effect

equation (36) to use the results for A* tj& to obtain resultcs hoosing option j versus the preferred option in Jifj w

for AJtJSk.

not available.63 Recall that Z^ is the vector of elements of

Zj that do not enter any other choice index, and that Z[~j] Treatment Parameters. The conventional definition of a vector of all elements of Z not in Z^. The Z^ thus act as

the ATE parameter is Affi (x,z) = E(AU\X = x, sZhi=ftezr),s attracting people into or out of j, but not affecting

which immediately generalizes to the class of paramtheetveralsuations in the arguments of the other choice func-

just discussed: Ajgl (x,z) = E(AKX\X = x, Z = z)t.ioTnhs.eWe can develop a parallel analysis to the binary case

conventional definition of the parameter for the effect doefvetlhoeped earlier in this paper if we condition on Z[~A We

treatment on the treated (TT) is AJJ (jc,z) = E(Ake\X = oxb,taZin= monotonicity or uniformity in this model if the

z, Ij = fe), which generalizes to Ajcj(x,z) = E(Ajcj\Xm=ovxem, ents among states induced by Z^ are the same for all

Z = z.IjSK).

persons conditional on Z[~j] = z[~j] and X = x. For example,

We generalize the MTE parameter to be tcheteeraisvpearraibgues, if Z^] = z^] increases, then RfiZj) increases

effect conditional on being indifferent betwebeunt tthhe eRkb(Zeks)tare not affected, so the flow is toward state/

option among choice set K versus the best optioLnet aDm jj boenagn indicator variable denoting whether option

choice set C at some fixed value of the instrumejnitsss,elZec=tezd::

AJEcte) = E(AKX\X = x,Z = z, RK(z) = Rc(Dzj)j)=. 1(3(R7j()Zj) > max{J?(Z)})

We generalize the LATE parameter to be the average ef=felc(ttij(Zj) => Vj + max{*(Z)}) (39)
for someone for whom the optimal choice in choice set 7C is

preferred to the optimal choice in choice set C at Z = z, but
who prefers the optimal choice in choice set C t=ol(tdh,.(eZy.) > V,),

optimal choice in choice set 7C at Z = z:

where V, = V, + max^7 {R( (Z^)}. Thus we obtain Djj =

\{Pj (Zj) > UDjX where UDj = Ff/Vy + max,*,) [R (Z,)} | Zl-fl = zl~j\ where Fy. is the cdf of V, given Z^] = z{~J\ In E(AKX \X = x,ZE {z,f}, RK(z) 2* RAz\ Rc(za)f^orRmKat(zp)a)r.allel to the binary model, we write

(38) Y=DjjYj + (l-Djj)Yjy9 (40)

An

important

special

case

of

this

parameter

arisejw s w whheeerrneezn Y=oj\tj

is the outcome that available. This case is

would just a

be ob versio

z except choices

for elements that in K and not for

enter the index any choice in

Cfu.nIcntidtocehnfasainstoeensthplydeecMefiTov aErleasloped

in

previous

sections

of

th

case, the expression (38) simplifies to

a£2Um) =

E(Yj - Yj y\X = x9Z = z^j(zj) - Vj = R^j(z)).

Recall that we have to condition on Z = z because the
E(AKX | X = x, Z 6 {z,z}, RK(z) s> Rc(z) ^chRoicKe (szet)s) are defined over the maximum of elements in

J\j (see equation (39)).

because Rc(z) = Rc(z) in this special case.

We now show that our identification strategies presented in

We have defined each of these parameters asthceopnrdecietdiionng aplart of this paper extend naturally to the identi-

not only on X but also on the "instruments" ZficIantiogneonfetrraela,tment parameters for A^. In particular, it is

the parameters will depend on the Z evaluationpospsiobilne tto. rFeocorver LATE and MTE parameters for Ajtj\j by

example, A^ (x, z) will in general depenudse oofnditschreete-zchange IV methods and LIV methods, respec-

evaluation point. To see this, note that YK = 2*eic DKkYk

and Yc = ^eecDceY. By the independence assumption
62 An exception is if K = {k}, C = (}, that is, both sets are singletons.
B-l, we have that ZJL{Yj}jEJ\ X, but DKk and63DHcec,kemw an ialnld Vytlacil (2007b) consider the identification of other

be dependent on Z conditional on X, and thus YKpa-ramYecterws iinllthiengeneral unordered case.

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

MODELS WITH ESSENTIAL HETEROGENEITY 421

tively. Averages of the effect of2. AosspumteioB-nl, Bj-3 vtoeBr-5s,uansd Bt-h 2b.eThneneMxft[V(xb, ez)s=t
alternative are the easiest effects to^}%s(xt,uz)d . y using IV methods and
are natural generalizations of our two-outcome analysis.64

Consider identification of trPeroaoft: Sm ee aeppnentdixpF.arameters corre-

sponding to averages of &j,j\Thpe inteuiitit onh une derrlyinu g tsheipn roog f is saimpd le. iUsndcerrB-el, te-
change, Wald form for the BI-V 3 to eB-s5,taindm B-a2anwedcanocr onveurtstihn e pg robltemhoef LIV estimand.65 The discrete-chacon mpgarieng tIhV e outceomsetunidm er j awin th d the ow utcoimlelunadelr lthoe w us to recover a version of the nL extA besTt oEptiop n. aThris aism an IVetvee rsiron.o6f 6the L seleecttion Z[~j] denote the excluded variablemofdeolinrg anoalpystisioof n Dahlj(20w 02).iAtj^h - (jcp , zr , zo ) ip s teherties assumed in B-2a. We let z = [azvelra'gJ e e\ ffeczt o® f sw]itcahn ingdto sztate=j fr[o& m s~taJ te \ Ijy f& or ]] be two values of Z, and we only indim viduaalsnwihp o wuoullad tcheoosZ e l^jV]} .at D Z =ezfbuitnweould

A7a!dUz[-7UM,z°])

choose j at Z = f. A^/jc, z) is the average effect of
switching to state j from state Ijy (the best option besides

E(Y\X = x,Z = z) ~ E(Y\X state = j) forxind,ivZidual= s whozar)e indifferent between state j

= (Pr(Djj=\\X
[ -Pr(Djj=l\X = x9Z = z))

= x,Z = z) V and Ijy at the given values of the selection indices (at Z = z, that is, at {$k(Zk) = ftk(zk)}k e j\

The mean outcome in state j versus state Ijy (the next

where for notational convenience we assume that Z^ is thebleassttoption) is a weighted average over k E J\j of the

component of Z Without loss of generality, we assume thefaftect of state j versus state k, conditional on k being the next fy(z) > ftj{z). The LIV estimand introduced in Heckmbaenst option, weighted by the probability that k is the next (1997) and developed further in Heckman and Vytlacil (19b9e9st, option. For example, for the LATE parameter we have

2001b) allows us to recover a version of the MTE parameter.

Impose B-2b, and let Z^ denote the excluded variable for option j with properties assumed in B-2b. Our results are

/ X = x, ZG{z,£}, 1

invariant to which particular variable satisfying B-2b is used if

there are more than one variable with those properties. Define





^T]E(Y\X = x,Z = z)
Aj-IVUz) ^ -

Afw(x, z) is thus the limit form
zfA approaches z^. Given ou x r prev
. \ ^ = k I. easily show that this limit exi
following identification theorem

Theorem 1.

where we use the fact that Rj\j(z) = Rj\

except for one component, which only ente

1. Assume B-l, B-3 to B-5, and B-2a. Then the yth option. How heavily each option is w

A/ald (jc, z[->\ zuK zW) = Affl (x, z, £), wavheerreazg=e depends on (z^\ z«).

Pr(/^v = k\Z G {z, zlRj(zj) ^ Rk(zk) > Rj
64 Heckman and Navarro (2006) consider identification of other param-

eters, but they use identification-at-infinity arguments not required for

standard IV. See the comprehensive discussw ioh n iicnhHiencktm urann adnedpVen ytdlsacoiln {fyfaOhej-y/. The

(2007b). 65 The estimand is the

population

version ofhothlde ienstgimtahtoer.other

indices

constant,

the

la

66 We use Z directly in the following manigpiuvlaetniontso in ststaetaed kofam s atnhipeub- ase state.

lating the {-9y(Zy)} indices. One can modifyTthhee LfoIV llow anindg W anaally dsiessttoimands depend on t

directly use { ft/Zy) } , with {ft/Z;)} (for example, by an

tidheendtiisfaidcvatainotna-gaetp-oifonifrneinqtui.tiy rAinlatg regirudn m enaettniiftvi)ceabltuy ito,nwooin fthe

can

define

average

the advantage of being able to follow thLeIV anaalnydsisWoafldCaem steirm onanadnsd that will recover av

Heckman (1998), Chen, Heckman, and Vytolafcilth (1e99M 8,T1E99a9n ), danLdAHTeEck-parameters,67
man and Navarro (2006) in not requiring an exclusion restriction if Z

contains a sufficient number of continuous variables and there is sufficient

variation in the function $k across k. See H6e7ckW meaanssaunmde Vthyattlatchiel (s2u0p0p7obrt) of Z[~J] conditional on

for a more general analysis.

as the support of Z^ conditional on (Z^, X).

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

422 THE REVIEW OF ECONOMICS AND STATISTICS

£[/,] _ £(/;])|/>.(z) > uDj]
lin X Pr(Pj(Z) > uDj\*-n = *-»)
Co,(^\Djj) ' (43)

I X = X' \

\

I

where uD. is defined at the beginning of this section an where we keep the conditioning on X = x implicit.
Note that from theorem 1 we obtain that
pi
W] E[Y\X = X>Z=Z'] dE[Y\X = x9Z = z]
dPj(z) ~ dPj(z)
dz[j]

and

= E[Yj - Yjy\X = x,Z=z, $j(Zj) - Vj = R^j(Z)l

so we obtain that LIV identifies MTE and linear IV is a

^lv(x9z)dFz(z)= \A^(x,z)dFz(z)

weighted average of LIV with the weights summing to 1 . These results mirror the results established in the binary

case.

= E(Aj^X = x,Rj(Z) = Rj,j(Z)).
Thus far, we have only considered identification of LATE and MTE, and not of the more standard treatment parameters ATE and TT. However, following Heckman and Vytlacil (1999), LATE can approximate ATE or TT arbitrarily well given the appropriate support conditions. Theorem 1 shows that we can use Wald estimands to identify LATE for A, ^ and we can thus adapt Heckman and Vytlacil (1999) to identify ATE or TT for Ay j\7. With suitable modification of the weights, their analysis, summarized in section III, goes through as before. Suppose that Z^ satisfies the properties assumed in B-2a, and suppose that: (i) the support of the distribution of Z^ conditional on all other elements of Z is
the full real line; (ii) ft/z,) - > °° as z^] - > °°, and ft/z,) - » -°° as ZU\ -» -oo. Then A*^(jc, z) and A,late(jc, z[~J\ z^\ &]) are arbitrarily close when evaluated at a sufficiently large value
of £0 and a sufficiently small value of z^]. Following Heckman and Vytlacil (1999), A^/jc, z) and A,LATE(;t, z[~j\
z w, z17'1) are arbitrarily close for sufficiently small z®. Our discussion has focused on the Wald estimands. Alternatively we could also follow Heckman and Vytlacil (1999, 2001b, 2005) in expressing ATE and TT as integrated versions of MTE. By theorem 1, we can use LIV to identify MTE and can thus express ATE and TT as integrated versions of the LIV estimand.

In the literature on the effects of schooli ^jEjjDjj) on earnings (Yj), it is conventional t
ment S. Our Web site presents an analysis of this the general unordered case,
Cov(M Yj) Ajln~ Cov(MS)
can be decomposed into economically interpretab nents where the weights can be identified but t being weighted cannot be identified using local ins variables or LATE without making large suppor tions. However, the components can be identifi structural model.68
The trick we have used in this section, compa comes in j with the next best option, converts unordered multiple-outcome model into a two setup. This effectively partitions Yjinto two comp in equation (40). Thus we write
Yj=DJJYj + (l-DJJ)YJ,j
where
^^Y-^XICD,,*!).

For a general instrument J (Zw, Z[~j]) constructed from

(Z^, Z[~j]), which we denote as fi] , we can obtain a paraIllnel the more general unordered case with thre

construction to the characterization of standard IV given icnhoices, to analyze IV estimates of the effect of 5

equation (18):

must work with Yj = LkejDj^Yb and make

comparisons across potential outcomes. This req

AlJn = ' Amte(jc, z, uDy^J\uD) duDp (426)8 See Heckman and Vytlacil (2007a) and Heckman and Na for analyses of semiparametric identification of structural m

identify all treatment effects and the components of the IV

tions. See Heckman and Vytlacil (2007b) and Heckman and

where

for further analyses of this case.

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

MODELS WITH ESSENTIAL HETEROGENEITY 423

move outside the LATE/LIV frIanm theewadodrik tiv, ew lyhseipcahrabisle icn ashe,etrh-e MTE has

ently based on binary compeaqruiisvo aln enst.6in9teW rpreetn atoiow ns: c(io) n UsDi(d=eFry(V)) is th

models that do not impose ad undoibtseirvvaebleseinptahre afb iristl-istty age idnecisciohnoriuclee, and the

equation (13). This includes athgeean veerr agaelefrfaecn t d ofotm rea-tcmoenetfgfiviecniethnetunobserved

model.

acteristics in the decision rule (UD = uD)\ (ii) the MTE

average effect of treatment given that the individual

VII. Relaxing Additive Sepabre ainbdiiflfietry ent ibnetwteh enetrC eathmoenict eand no treatment if

Equation and Allowing foruDR, awnhd eroem P(Z-)Cisoaef mfeainciuetn ilitty function; (iii) the

Choice Models

an average effect conditional on the additive error term

the first-stage choice model. Under all interpretations

The analysis of this paper and of the entire recent M litTerEa,- and under the assumptions A-l to A-5, the M

ture on IV estimators for models with essential heterbogeenide-entified by LIV. The MTE does not depend on

ity relies critically on the assumption that the trehatemnecnet it is invariant to policies that shift Z Th

choice equation can be represented in the additivelyinsteepgar-ates up to generate all treatment effects, policy e

rable form (13). The implied uniformity condition imapnadrItVs estimands.

an asymmetry to the entire IV enterprise. Uniformity Tahlseo three definitions are not the same in the general

underlies conventional selection models.

nonseparable case (44). Heckman and Vytlacil (2001b,

Responses are permitted to be heterogeneous in a gener2a0l05, 2007b) extend the MTE to the nonseparable case. LIV

way, but choices of treatment are not. In the absenceisoaf weighted average of the MTE with possibly negative

additive separability, or uniformity, the IV identificawtieoinghts and does not identify the MTE. Thus, if uniformity strategy breaks down. Parameters can be defineddaoses not hold, the definition of the MTE allows one to

weighted averages of an MTE, but the MTE and the deriviendtegrate it up to obtain all of the treatment effects. Howparameters cannot be identified using any IV strategy (seeever, the IV estimator does not identify LATE or MTE. Heckman and Vytlacil, 2001b, 2005, 2007b). This point

applies to models with two or more potential outcomes. FAo.rFailure of Index Sufficiency in General simplicity of exposition, we only analyze the two-outcome Nonseparable Models
case.

One natural benchmark nonseparable modeFloirsanayrvaenrsdioonmof- the nonseparable model, except those

coefficient model of choice D = l[yZ >th0at],canwbhe etrranesf7orm isedato separability, index sufficiency

random coefficient vector and 7 _IL (Z, ffa/il0s.»ToUs\e)e. tIhfis 7moisst adirectly, assume that |xD (Z,V) is a
random coefficient with a nondegeneratecodnitsitnruiobuustriaonndoamndvariable.71 Define Cl(z) = {v : with components that take both positivejxaDnd(z,nv)eg> a0t}.ivIne tvhael-additively separable case, P(z) = ues, uniformity ("monotonicity") can be viPorlat(Ded=. F1igI uZr=e Z2C) = Pr(V G H (z)), P(z) = P{z') <^>
illustrates this violation. Uniformity can aflsl(oz)b=e(lv(zifo)l.aTtehdis ipfroduces index sufficiency, so the

we change one coordinate of Z but fapilrotpoensciotyntscroorle ofrodrers the unobservables generating

movements in the other coordinates. See ficghouircees.2IBn .the more general case (44), it is possible to have
To consider a more general case, relax (tz,hze') sveapluaersabsuiclihtythat P(z) = P(z') and fl(z) * H(z'), so

assumption of equation (13) to consider itnhdeexlsautfefnictiencchyodiocees not hold. The Z's enter the model

index

more generally, and the propensity score no longer plays the

central role it plays in separable models.

D* = lxD(Z,V), D = l[£>*>0], (44)

B. The Support of the Propensity Score

where |xD (Z, V) is not necessarily and V, and V is not necessarily

aadsdciatliavrel.yIPns(ZeTt)ph.haeFreonarobrnelaxseneapm idanropalm Zbe,le-comnosdideel rcaannaolrsomrael srtarnicdtomth-ecoseufpfpiocrietnotf

coefficient example, V = 7. We maintain assumptions A-l

to A-5, with A-3 suitably modified fosrtrictthly eincrreaasningdion m its f-irst argument; and V is a scalar. For any V, then,

coefficient case.70

we can write equation (44) in the same form as equation (13):

D = l(e(Z)> V), 69 If we partition Yj into two components based on general sets /C, C, each with two or more elements, the choice equation in general iws hneore V = ^ (0, V) and VJLZ | X, and the inverse function is expressed longer characterized by the assumption of additive separability inwtithhe respect to the first argument. See Vytlacil (2006a), who considers the error, discussed in Heckman and Vytlacil (2005) and in the next sectivoenc,tor V case. Vytlacil (2002) shows that any model that does not satisfy that is required to justify application of LATE and LIV to identifyuntihfeormity (or "monotonicity") will not have a representation in this form. MTE. The ordered case previously analyzed has a local propertyInthtahte random-coefficient case where Z = (1, Z,) with Z, a scalar, and 7 = compares adjacent choices and effectively makes binary comparison(7so. * 7i) if 7i > 0 for all realizations, we can write the choice rule in the /u In special cases, equation (44) can be expressed in additively sepafrao-rm of equation (13): 7,Z, > -70 => Z > -70/71 and V = -70/71. ble form. Suppose, for example, that D* is weakly separable in Z andHVow\ ever, this trick does not work in the general case. D* = |xD(G(Z), V), where 0 (Z) is a scalar function and fjiD(0(Z), V7)1isAbsolutely continuous with respect to Lebesgue measure.

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

424 THE REVIEW OF ECONOMICS AND STATISTICS

choice model with a scalar reg byrcoemspsaroingrest(iZ mate=s fr(o1m,difZfex ren)t).insA trusmsenutsm , is ienap-

7o ~ AT (0, og), 71 ~ N (7b <*?pr)o.priaatn e. d 7o-U- 7i- Then

In the model with essential heterogeneity, the specifica-

tion of the choice equation (Pr(D = 1 | Z)) affects the

\ Vo-o + o-fzf/

interpretation of any IV estimator. This feature is absent in the classical model, where specification of the full instru-

where <J> is the cumulative distmrenitbliu st tanidochnoiceomfodelais sirtrealevnand t tao rthd e intnero prr etam tional.

If the support of Z{ is R, in tofhwheat IsVtesatimnatdes.aTr wodeconaomdisd ts iustinigvthee samm e voalid d el

(v\ = 0), P (zj) has support [0,1 ins]tr.umW ent h andetn he sa<mje ]out>com0e e,quattioh nsebutsmuainptap ininogrt

is strictly within the unit interdviffaerle.n7t 2 modIeln s oftechoneomisc p choeicce iwailllinctearpsreet thw e sh amee n

Oq = 0, the support is one popoiin nt etstim(aPte(dziff)ere=ntly3. S>o wi(ll7twio/ecoon"omii)st)s.usiW ng tehe

cannot, in general, identify ATEsa,meTinT str,umoenrt anad n theysamte rZ evaaritabm les ien n P(Zt) buet f usifngect

requiring the endpoints 0 or 1 duistsriibn utig ons oIfVZ thoatrare cdioffn eretntr. Tohela-gnfosuticnancdtroibousn t

strategies.73 In addition, the IVfeaw tureesiogf h IV tinsitspclrasseicsalesentttineg d disapipnear sineacmtodieol n
III no longer apply. IV now failswithasesseantiam l heteertoghenoeitdy. Wfe oderveloep sa stimipm le parotceidn ureg interpretable causal effects an thad t cantbre aeppalietdm to teestnwhtetheerf , infaegicvetn sda.ta sO et,tthhe er approaches to estimation musatnalybstehasatodwoorp rytabeoudt thie f compalicaftiounslrlesy ultinsg y from m metric model of heterogeneity esissentiealnhetteerorgetneaitiynorewdh.ether they can be ignored in

identifying treatment parameters.

C. Violations of Uniformity

We clarify the concept of monotonicity introduced by

Imbens and Angrist (1994) and note that uniformity is a The uniformity or monotonicbiettty er tearmssfou r tm heirpcotnciepot.nAddcitiaonn ally,bwee shv owitoha-t this lated for any vector Z. One soucroncceept io s nfot tv heiso amleaasttiho at n of s"moinsotonniciotyn " usseed p in ath-e rability between Z and V in equation (44). The random-
literature to define positive IV weights on treatment effects. coefficient model is one intuitive model where separability fails. Even if equation (44) is sIVewpeiaghrtsacb anlbee noinnposiZ tiveaevnendwhV en unuifn ormif ityoir s -
satisfied for a vector Z, if an instrument other than P(Z) (or mity may fail in the case of vector Z, where we use only one function of Z as the instrument and do not condition on the a function of P(Z)) is used. Uniformity plus conditioning on

remaining sources of variation in Z - as we demonstrated byunused instruments is required to produce positive weights examples in section V. If we condition appropriately, wein the case of vector Z. We demonstrate these points with

retain monotonicity but get a new form of IV estimator thatboth theoretical and empirical examples.

is sensitive to the specification of the Z not used as an Positivity of weights is required to interpret IV estimates

instrument.

as treatment effects. We argue, however, that many inter-

esting policy questions do not require treatment effects.

VIII. Summary and Conclusions

Policy effects and treatment effects are distinct. We develop new software for estimating the MTE and the weights for

This paper considers the application of the method ofthe two-outcome model.

instrumental variables to models where responses to treat- We also compare the method of IV with the method of

ment are heterogeneous, agents make treatment choicescontrol functions. In the more general setting studied here,

based in part on this heterogeneity, and some components ofthe method of control functions is explicit in formulating its

heterogeneity are unobserved by the economist. We call this identifying assumptions and recovers interpretable paramea model with essential heterogeneity. Intuitions about IVters. We establish a strong relationship between LIV, LATE, that are valid for the homogeneous model are often applied and control function models. LIV and LATE estimate the

inappropriately to the model of essential heterogeneity. In a derivatives (differences) of the level functions identified by
model with essential heterogeneity, different instruments the control function approach. When we use IV and its satisfying the traditional definition of an IV define differentextensions to answer the traditional questions addressed by economic parameters. This is not the case in the classical IV the control function method, the same large-sample support literature that assumes that responses to treatment are ho- assumptions are required to identify model intercepts. mogeneous. Because different instruments identify different We highlight the central role of the propensity score in IV parameters, the traditional emphasis in the econometric and control function methods. Using the propensity score theory literature of efficiently combining instruments, or and the distributions of X and Z, we can generate instrumentusing Durbin-Wu-Hausman tests to check for endogeneityinvariant parameters and weights for any instrument from a

common set of parameters. The propensity score or choice

72 The interval is [<D( - kl/a,), $ (hj/a,)]. 73 The random-coefficient model for choice

may

explain

the

suppoprrtobability

is

more

than

a

computational

device,

as

it

is

in

problems for P(Z) noted by many analysts. See Heckman et al. (1998ma).atching. It shows up as a fundamental feature of both IV

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

MODELS WITH ESSENTIAL HETEROGENEITY 425

and control function models heterogeneity.
We develop both ordered and unordered choice models with associated outcomes that extend the binary choice model for essential heterogeneity. The unordered model extends the two-outcome model in a natural way. The

in the presence of essential
Models with Stochastic Cutoffs, forthcoming (2007).
Dahl, G. B., "Mobility and the Retu with Multiple Markets," Econo
Durbin, J., "Errors in Variables," R Institute 22, (1954) 23-32.
Fan, J., and I. Gijbels, Local Poly

ordered model places some special structure on it. In the context of the ordered model, we define transition-specific treatment parameters A^Cm). We show how to estimate

(New York: Chapman and Hall, Gronau, R., "Wage Comparisons -
cal Economy 82:6 (1974), 1119 Harmon, C, and I. Walker, "Th

these parameters using transition-specific instruments. These instruments identify parameters that can be linked to specific choice models.

Schooling in the UK, European
879-887.
Hausman, J. A., "Specification Tests in Econometrics," Econometrica 46:6 (November 1978), 1251-1272.

We explain why the model of essential heterogeneity as currently formulated in the recent literature on instrumental

Heckman, J. J., "Shadow Prices, Market Wages, and Labor Supply,"
Econometrica 42:4 H974). 679-694.

variables is asymmetric. It features heterogeneity (nonuniformity) of responses to treatment, but assumes uniformity in response to the variables generating the choice of treat-

Sample Selection and Limited Depend Estimator for Such Models," Anna Measurement 5:4 (1976a), 475^92.

ment. We present new results for a random-coefficient model that allows for nonuniformity in responses of choices to instruments and responses of outcomes to treatment.

crete Endogenous Variables with and without
Equations," (pp. 235-272) in S. Goldfeld
Studies in Nonlinear Estimation (Cambrid lishing Company, 1976b).

REFERENCES

47:1 (1979), 153-162.

Ahn, H., and J. Powell, "Semiparametric Estimation of CensoredES.eleSct- romsdorfer and G. Farkas (Eds.), tion Models with a Nonparametric Selection Mechanism," JouA rnn al nual, Volume 5 (Beverly Hills, CA:

of Econometrics 58:1-2 (1993), 3-29. Angrist, J. D., and G. W. Imbens, "Two-Stage Least Squares Estimat(i1on9o9f 0), 313-318.

Average Causal Effects in Models with Variable Treatment Inten-

sity," Journal of the American Statistical Association 9t0i:4o3n0 s Used in Making Program Evaluations,"

(1995), 431-442.

Resources 32:3 (1997), 441-462. Addendum,

Angrist, J. D., G. W. Imbens, and D. Rubin, Identification of Causal

Effects Using Instrumental Variables," Journal of the AmeNriocabnel Lecture," Journal of Political Econom

Statistical Association 91:434 (1996), 444-455.

748.

Bjorklund, A., and R. Moffitt, "The Estimation of Wage GainsHanedcW kem lfaarn e , J. J., and B. E. Honore, "The Empiric Gains in Self-Selection," this review, 69:1 (1987), A2-A9. Model," Econometrica 58:5 (1990), 1121-11
Bresnahan, T. E, "Competition and Collusion in the AmericanHAeutcok mm obilaen, J. J., H. Ichimura, J. Smith, and P

Industry: The 1955 Price War," Journal of Industrial EconSom eliecsction Bias in Evaluating Social Programs: A

35:4(1987), 457^82.

Conventional Measures and Evidence on the Effectiveness of

Cameron, S. V, and J. J. Heckman, "Life Cycle Schooling and Dynamic Matching as a Program Evaluation Method," Proceedings of the

Selection Bias: Models and Evidence for Five Cohorts of American

National Academy of Sciences 93:23 (1996), 13416-13420.

Males," Journal of Political Economy 106:2 (1998), 262-333.

Card, D., "Estimating the Return to Schooling: Progress on Some Persis-

Econometrica 66:5 (1998a), 1017-1098

tent Econometric Problems," Econometrica 69:5 (2001), 1 127-Heckman, J. J., H. Ichimura, and P. E. Todd

1160.

Evaluation Estimator," Review of

Carneiro, P., K. Hansen, and J. J. Heckman, "Removing the Veil of

(1998b), 261-294.

Ignorance in Assessing the Distributional Impacts of Social Poli- Heckman, J. J., R. J. LaLonde, and J. A

cies," Swedish Economic Policy Review 8:2 (2001), 273-301.

Econometrics of Active Labor Market P

1865-2097), in O. Ashenfelter and D.

tion to the Returns to Schooling and MeasuL ream beonrt E ofcotn heom Efficecst,s V ofolume 3 A (New Yo

Uncertainty on College Choice," InteH rneactk iom naalnE,coJn.om J.i,c L R.evJie.wLochner, and P. h.

44:2 (2003), 361-422.

Rates of Return: The Mincer Equatio

Chen, X., J. J. Heckman, and E. J. Vytlacil, "N Hoann/u Sesm hiepk araam nedtrF ic. IdW ene-lch (Eds.), Handb

tification and Estimation of a Dynamic E Didsu crceattei-oTnim(A e D missctreertd e-am: North-Holland

Choice Models with Unobserved HeteH roegceknm eiatn y,,"JU. nJiv.,erasnitdySo.fNavarro, "Using Mat

Chicago, Department of Economics, workainndg C paopnetrr(o1l99F8u).nctions to Estimate Econ review, 86:1 (2004), 30-57.

parametric Panel Data Models with Binary Dependent Variables

and a Latent Factor," University of ChJ icoau gor,nD alepoafrtEm coen notm ofetErcioc-s, in press (2006)

nomics, working paper (1999).

Heckman, J. J., and R. Robb, Alternative M

Cunha, F., J. J. Heckman, and S. Navarro, "ISm eppar acattinogf UIn ncteerrtvaiennttyiofn rosm " (pp. 156-245)

Heterogeneity in Life Cycle Earnings,Stin hg e e2r00(E 4dHs.i)c,kL s oLneg ctituurd e,i"nal Analysis of L Oxford Economic Papers 57:2 (2005), u1m 91e-21601.(New York: Cambridge Universit

(chapter 4), in S. L. Morgan, D. B. GirnusEkvy al,uaatnid ngGt.hSe. IFm iepladcst (oEfdsT.r ),eatments on

Mobility and Inequality: Frontiers 1o0f7)R , ein seaHr. cW h aiin neSro(cEido.l)o , gDy raawnin dg Inference

Economics (Palo Alto: Stanford UnivSeam rspitleys P (Nreew ss,Y2 or0k 0:6)S,pp ripn.g2e9r0 - -Verlag, 1986

348.

rence Erlbaum Associates, 2000).

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

426 THE REVIEW OF ECONOMICS AND STATISTICS

Heckman, J. J., J. L. Tobias, and E. J. Vytlacil, "Simple Estimators for

Treatment Parameters in a Latent VariBaubsleinFer ssam aned woErck on ,"om thiics Srtea-tistics 14:4 (1996

view, 85:3 (2003), 748-754.

Yitzhaki, S., and E. Schechtman, "The Gini Instr

Heckman, J. J., and S. Urzua, "Interpreting'DIV ouEbslteim InasttersuomfetnhtealEV ffareciatbolef' estimator,"

Schooling on Earnings," University of 287-C 313h. icago, Department of

Economics, manuscript (2006).

Heckman, J. J., and E. J. Vytlacil, "Local InstrumeAnPPtEaNlDIV X aAriables and Latent Variable Models for Identifying and Bounding Treatment

Effects," Proceedings of the National Academy of Sciences 96

(1999), 4730-4734.

Deriving the IV Weights on the MTE

Variable Framework," Economics LeWtetecornssid6e6r :i1nst(r2u0m0e0n)t,al 3va3r-ia3b9le.s conditional on X = x using general function of Z as an instrument. Let J(Z) be any function of Z su
the Average Treatment Effect" (p thpat. C1ov-1(75(Z)),, Din | X M = jc.) L #e0c. h Connseidreratn hedpoFpu.lation analog of the Pfeiffer (Eds.), Econometric Evaluaesttimiaoton r, of Labour Market Policies (New York: Center for European Economic Research, 2001a).
Cov(/(z), y|x = jc)

Morimune, and J. L. Powell (EdCsov.)(7,(Z),N D|Xo=n jc)l' inear Statistical Model-
ing: Proceedings of the Thirteenth International Symposium in Economic Theory and EconomeFirtstrcoinscidser:theEnusmseraatoy r osf thiisn exprH essioon,nor of Takeshi Amemiya (New York: Cambridge University Press, 2001b).

91:2 (2001c), 107-111.

Cov(/(Z),y|X = x) = E([J(Z) - E(J(Z)\X = x)]Y\X = x)

= E([J(Z) - E(J(Z)\X = x)][Y0 + D(K, - Y0)]\X = x) Evaluation," Econometrica 73:3 (2005), 669-738.

= E([J(Z) - E(J(Z)\X = x)]D(Yl - Y0)\X = x)t

Models, Structural Models and Econometric Policy Evaluation, in

J. Heckman and E. Learner (wEhed re sth.e)se,conH d eqa ualn ityd combesofro omksubstoituftingE in ctheodn efinoitim on ofeYtrics, Volume 6 (Amsterdam: Elsevaine d tr he,thir2d e0qu0 alit7 y faol)lo.ws from the assumption of conditional inde-

pendence A-2. Define J(Z) s J(Z) - E(J(Z) \ X = x). Then

Marginal Treatment Effect to Organize Alternative Economic Es-

timators to Evaluate Social ProgramCsov(a7(n Z),d y|X t= ox) Forecast Their Effects in New Environments," In J. Heckman and E. Learner (Eds.),

Handbook of Econometrics, Volume 6 (Amsterdam: Elsevier, 2007b).

= E(J(Z)1[UD < P(Z)](K1 - Y0)\X = x)

Imbens, G. W, "Nonparametric Estimation of Average Treatment Effects under Exogeneity: A Review," this review, 86: 1 (2004), 4-29.

= E(J(Z)1[UD < P(Z)]E(y, - Y0\X = x, Z, UD)\X = x)

Imbens, G. W., and J. D. Angrist, "Identification and Estimation of Local Average Treatment Effects," Econometrica 62:2 (1994), 467^75.

= E(J(Z)1[UD < P(Z)]E(YX - Y0\X = jc, UD)\X = x)

Lee, L.-F., "Generalized Econometric Models with Selectivity," Econo-

metrica 51:2 (1983), 507-512.

= E(E[J(Z)1[UD ^ P(Z)] | X = jc, UD]E(Y, - Y0\X = x,UD)\X = x)

Manski, C. F., and J. V. Pepper, "Monotone Instrumental Variables: With

an Application to the Returns to Schooling," Econometrica 68:4, (2000) 997-1010.

= S{E(J(Z)\X = x, P(Z) > uD) Pr(P(Z) > uD\X = x)

Mare, R. D., "Social Background and School Continuation Decisions,"

X E{YX - Y0\X = x,UD = uD)} duD

Journal of the American Statistical Association 75:370 (1980), 295305.
Powell, J. L., "Estimation of Semiparametnc Models (pp. 2443-2521), in

= JA^U uD)E(J(Z) | X = x, P{2) > uD) Pr(P(Z) > uD\X = x) duD,

R. Engle and D. McFadden (Eds.), Handbook of Econometrics, Volume (Amsterdam: Elsevier, 1994). Prescott, E. C, and M. Visscher, "Sequential Location among Firms with Foresight," Bell Journal of Economics 8:2 (1977), 378-893. Rosenbaum, P. R., and D. B. Rubin, "The Central Role of the Propensity Score in Observational Studies for Causal Effects," Biometrika
10:1,(1983), 41-55.

where the first equality follows from plugging in the model for D; the second equality follows from the law of iterated expectations with the inside expectation conditional on (X = x, Z, UD)\ the third equality follows from the conditional independence assumption A-2; the fourth equality follows from Fubini's theorem and the law of iterated expectations with
the inside expectation conditional on (X = x, UD = uD); the fifth equality follows from the normalization that UD is distributed uniformly [0, 1]

Snaked, A., and J. Sutton, "Relaxing Price Competition through Product conditional on X; and the final equality follows from plugging in the Differentiation," Review of Economic Studies 49:1 (1982), 3-13. definition of AMTE. Next consider the denominator of the IV estimand.

Thompson, T. S., "Identification of Semiparametric Discrete ChoiceObserve that by iterated expectations Models," University of Minnesota Center for Economic Research

discussion paper, no. 249 (1989). Vytlacil, b. J., Independence, Monotonicity, ana Latent index Models:

Cov(7(Z),D|X = x) = Cov(/(Z),P(Z)|X = jc).

An Equivalence Result," Econometrica 70:1 (2002), 331-341. Thus, the population analog of the IV estimator is given by

Binary Choice: Representation Results," Oxford Bulletin of Eco-
nomics and Statistics, forthcomin Ag mt(2 e(0jc0,6m a).d)o)(jc, uD) duD, (Al)

equivalence, and Representation Results," this review (2006b).

White, H., Asymptotic Theory forwE hecroe nometricians (Orlando, FL: Academic Press, 1984).

Wu, D., "Alternative Tests of Independence between Stochastic Regres-
sors and Disturbances," Econometr, i,caE(4J1(:Z4)\(1X97=3)j,c,7P 33 (Z-)75 >0u. D) Pr(P(Z) > uD

Yitzhaki, S., "On Using Linear Regrew ss(^io,n, = m Welfare Economics, De-

partment of Economics, Hebrew University, working paper, no.

217 (1989).

where by assumption Cov(/(Z), P(Z) | X = j

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

MODELS WITH ESSENTIAL HETEROGENEITY 427

If J(Z) and P(Z) are continuous ranUd sinogm the sv amaerarigaum belnetssp,restenhteed n in seactisoneIcII,owne d can show that

interpretation of the weight can be derived from equation (A2) by noting

that

E(Y\X = x,P(Z) = p) = a + poJC + [(p, - po)jc]p + K(p), (B2)

[j - E(J(Z)\X = jc)] fPJ(t, j\X = x)dt dj

where P(Z) represents the propensity score or probability of selection
(Pr(D = l|Z)), p is a particular evaluation value of the propensity score,
and

= [j - E(J(Z)\X = x)]fj(j\X = x)

K(p) = <pp + E(UX - U0\D = \,P(Z) = p)p. (B3)
Equations (B2) and (B3) are closely related to the control function approach (see section IV).

x fPlJAt\Az)=j,x = x)dtdj.

1. The Estimation of the Propensity Score and the Identification of the Relevant Support

Write
I fP\jAt\J(z)=j,x = x)dt
= 1 " Fp1jA»d\AZ) =j,X = x) = SPUiZhX(uD\J(Z) =j,X = x),
where SP\JX (uD | J(Z) = j, X = x) is the probability of P (Z) > uD given J (Z) = j and X = x. Likewise, Pr(P(Z) > UD | 7(Z), X) = SP\lx (UD \ J(Z), X). Using these results, we may write the weight as
- _ Cov(7(Z), SP\JtX(uD\J(Z\ X = x)\X = x) o>(x,uD) - _ Cov(y(zx Splj.x(UD\J(Z), X = x)\X = jc)'
For fixed uD and x evaluation points, SP\JX (uD \ J(Z), X = x) is a function of the random variable J(Z). The numerator of the preceding expression is the covariance between J(Z) and the probability that the random variable P(Z) is greater than the evaluation point uD conditional on J(Z).
For a fixed evaluation point jc, Sp\jx (Ud | 7(Z), X = jc) is a given function of the random variables UD and 7(Z). The denominator of the above expression is the covariance between J(Z) and the probability that the random variable P(Z) is greater than the random variable UD conditional on J(Z) and X = x.
Thus, it is clear that if the covariance between J(Z) and the conditional probability that (P(Z) > uD) given J (Z) is positive for all uD, then the weights are positive. The condition is trivially satisfied if 7(Z) = P(Z), so the weights are positive and IV estimates a gross treatment effect.
If the J(Z) and P(Z) are discrete valued, we obtain the expressions (21) and (22) in the main text.

The first step in the computation of the MTE is to estimate the probability of participation, or propensity score, Pr(D = 1 \Z = z) = P(z). This probability can be estimated using different methods. In this appendix, we assume V ~ #(0, 1) and thus estimate P(z) using a probit model. Let 7 denote the estimated value of 7 in equation (Bl). The predicted value of the propensity score (conditional on Z = z), P(z), is then computed as P(z) = PK7Z > V\Z = z) = <J>(7z), where 4> represents the
cumulative distribution function of a standard normal random variable. The predicted values of the propensity score allow us to define the
values of uD over which the MTE can be identified. In particular, as shown by Heckman and Vytlacil (2001b), identification of the MTE depends critically on the support of the propensity score.74 The larger the support of the propensity score, the bigger the set over which the MTE can be identified.
In order to define the relevant support, we first estimate the frequencies of the predicted propensity scores in the samples of treated (D = 1) and untreated (D = 0) individuals. These frequencies can be computed using smoothed sample histograms. In both subsamples the grid F of values of
P(z) specifies the number of points at which the histogram is to be
evaluated.
Let &< denote the set of evaluation points (coming from the grid) such that
&t = {pE F|e < Pr(P(z) = p\D = )} with £ = 0, 1 and e > 0,
so Sfy represents the set of values of p for which we compute frequencies in the range (e, 1] using the subsample of individuals reporting D = £ ( = 0, 1). Notice that the extreme value 0 is excluded from <3>e. Finally, if we denote by 2P the set of evaluation points used to define the relevant support of the propensity score, we have that
9 = 0>o fl 9>, = {p G T |c < min (Pr(P(z) =p\D = 0)y
Pr(P(z)=p\D=\))}

for e > 0. Therefore, the MTE is defined only for those evaluations of P(z)

APPENDIX B

for which we obtain positive frequencies for both subsamples. In practice, after identifying the relevant or common support of the

propensity score, it is necessary to adjust the sample. In particular, the

Computational Aspects: Estimating the M TE, the Trobesaetrm vaetinotns for which P(z) is contained in the common support are kept.

Parameters, and the Weights

The rest of the sample is dropped. From this point on, our analysis refers

to the resulting sample.

We illustrate the computational aspects of this paper using the linear

and separable version of the model of essential heterogeneity2i.nStermodipuacreadmetric Estimation of the Marginal Treatment

in section III. More precisely, we consider the following framework:

Effect in Practice

Yl = a + <p + p,X + £/,, Yo = a + poX + Uo,

Before presenting the steps used in computing the semiparametric estimate of the MTE, recall equation ( 1 6) and make the conditioning on X explicit:

I = yZ-V, (Bl)

°P p=un

_fl if />0,
D~l0 if /<0,

74 Heckman et al. (1998a, 1996), an

(1998b) also discuss the importance of

where (Uo, Uh V) are independent of Z conditional on X, but Uo, Uu eanm d pirical evidence that failure of th

V are not independent (even conditioning on X).

source of evaluation bias.

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

428 THE REVIEW OF ECONOMICS AND STATISTICS

This expression indicates that in general theeXkc(Jo) m = *kpU)u~ t*AaJt) wio ithnk =o1f , . . t. ,h2nex. MTE
involves the estimation of the partial derivative of the expectation of the

outcome Y (conditional on X = x and P(Z) = p) with respect to p. This

is the method of local instrumental variables introduced in Heckman and

We denote by eXk the vector of residuals (eXk(\), ex(2),...,

Vytlacil (2001b). However, because we are considering the linear and separable version of the model of essential heterogeneity, we can use

eXk(N))\ and by ex the matrix of residuals such that its kin column contains the vector eXk-

equations (B2) and (B3) to show that

Step 3. As in the standard double residual regression procedure, we

also need to estimate a LLR of Y on P(z). The same procedure

as the one described in step 1 is used in this case. Let ? (j)

9W-XPiZ>d -pp )\ dpp p== uuoo=(pC |_f pop ), +p^) C=fpu pD = uD . (B4)

denote the resulting predicted value of outcome Y for the jth individual.

Thus, in order to compute the StepM 4. WTithEt(j)w in heandn , wee e genderatte tohe reessidt ualiam ssociaatt edewitv h alues Po and dK(p)/dp. Notice that withoo utu comte Yafod r ed achit peirso onn j, al assumptions, the

tion of this last quantity requires the utilization of nonparametr

niques.

eY(j) = Y(j) - t(j).

Different approaches can be used in the estimation of equation (B4).

The following steps describe a semiparametric one.75

Following the notation used before, we denote by eY the vector

Step 1. We first estimate the coefficients p0 a°d Pi - Po m equation (B2), using a nonparametric version of the double residual regression procedure.76 In order to do so, we start by fitting a local linear regression (LLR) of each regressor in equation (B2) on the predicted propensity score P(z). Notice that if nx represents the number of variables in X, this step involves the estimation of 2nx local linear regressions. This is because equation (B2) also contains terms of the form XkP(z) for k = 1, ...,%. We use the kth regressor in equation (B2), Xk, to illustrate the LLR procedure. Let Xk(j) and P(z(j)) denote the values of the kth regressor and the predicted propensity score for the yth individual, respectively, the latter evaluated at the Z(j) that is observed for the individual. The estimation of the LLR of Xk on P(z) requires obtaining the values of { %(p), Q\(p)} for a set of values of p contained in the support of P(z)
such that

of residuals (iy(l)
Step 5. Finally, we can estimate the v equation (B2) from a regression of eY
[0o,pT^Po] =[exexT][exeyl
Heckman et al. (1998a) use a similar sion argument to characterize the sele rametric setup that arises from using Step 6. From equation (B4) we observe th mated value of p] - Po, only dK (p)/ dp r However, with the estimated values of this quantity can be estimated using s techniques. To see why, notice that we c

{eo(p).e,(p)}

Y = K(P(Z)) + 5, (B5)

where ^( · ) and h represent the kernel function and the bandwidth, respectively, and where 60 and 0i are parameters.77 In practice, we can use the set of all values of P(z) to define the set of evaluation points p in the LLR. This allows us to estimate the predicted value of Xk for each individual in the
sample.78 Let kk(j) denote the predicted value of Xk for the 7th individual. This procedure is repeated for each of the 2nx regressors in the outcome equations.
Step 2. Given the predicted values of the 2nx regressors &k (k = 1 , . . . , 2nx)y we now generate the residual for each regressor k and person j,

where Y = Y - PqX - ((ST^Pi)* P
assume E (v\P(z\ X) = 0. Then, it i that the problem reduces to the est where K (P(z)) can be interpreted a tion E (Y\P(Z) = P(z)). Let ft, (p) d estimator of dK(p)/dp. Notice that w a function of p instead of P(z). This of the LLR estimators described in s of values of P(z) to define the set estimator is evaluated. In particular, this set of evaluation points. As sho values of P(z) for which we obtain p the D = 0 and D = 1 samples. Thu

75 A Fortran code implementing this routine is available at jenni.uchicago.edu/underiv.
76 In the textbook case Y = \XXX + X2X2 + e, where e is assumed independent of X, and X2, a double residual regression procedure estimates X2 using two stages. In the first stage, the estimated residuals of regres-
sions of Y on X2 and Xx on X2 are computed. Let eY and eX] denote these estimated residuals. In the second stage, \2 is estimated from the regres-
sion Of y On v .
77 The selection of optimal bandwidth is extensively studied in the nonparametric literature. In the code available on our Web site, two procedures computing optimal bandwidth in the context of local regressions are implemented. The first one is the standard leave-one-out crossvalidation procedure. The second is the refined bandwidth selector described in section 4.6 of Fan and Gijbels (1996). Our code allows the utilization of three different kernel functions: Epanechnikov, Gaussian, and biweight.
78 An alternative could be to use P as the set or evaluation points. In this
case, in order to compute the predicted value of Xk for each individual, it would be necessary to replace its value of the predicted propensity scores by the closest value in P.

{Up)Mp)} = argmm £
where, as before, W (·) and h represe the bandwidth, respectively.79 Step 7. The LIV estimator of the MTE
ALIVU uD) = (pT^Po)'-* + ^\P = Ul> = MTEU, uD)
and is evaluated over the set of /?'s contained in (3i.
79 The code posted on our Web site allows the utilization of local polynomials of higher order to approximate K(p)y and so the derivative is computed according to the selected order. It also includes the alternative of using E(Y\P(Z) = P(z)) to compute a discrete version of the derivative. Furthermore, it allows the estimation of the MTE under the assumption of
joint normality of the error terms.

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

MODELS WITH ESSENTIAL HETEROGENEITY 429

3. The IV Weights

Likewise,

Let J be the instrument. For simplicity we assume that J is a scalar. The extension to the vector case is trivial. Then, as we have shown in equation (19) in the main text, the IV weight is Att(jc) = MTE(jc,MD)a)TT(jc,MD) duD,

«^^

( E(J\P(Z) >
{ ( -E(J\X
=

uD, X
uD, =

=x)x))\MPw{Z her)e>Au^jD c) r\epX resen=ts

txhe)TT

estimator

conditional

on

X

=

x.

Similar

expressions exist for the other treatment parameters. Therefore, provided

with Aliv(jc,md) and the estimated values for the weights, we can compute

AyVU) and A^jc). These estimators depend on the particular value of X In order to compuct onse ideredt . Inh orde er to w compue te i thg eir uh ncont dit:ional estimated values, we

need to integrate X out. More precisely, we need to compute Step 1 . We approximate £(J\X = x) usi

we assume J = \'X + V, where E(V\ x) = \'x.
AJV= I ti/(x)dEx(X) Step 2. For each value of uD we gen

function \(P(Z) >

the function is true and 0 otherwise.

and

Step 3. We use linear projections to estimate E(J\X = x, P(Z) > uD).

wD),

which

is

equal

More precisely, we use OLS to estimate the equation J(uD) =

K{uD)X + V using only the observations for which
1(P(Z) > uD) = 1. Because we assume E(V\X = x, P(Z) > A^J ATT(x)dFm=l(x).
uD) = 0, then £(J\X = x, P(Z) > uD) = K'J{Ud)x.

Step 4. Because Pr(P(Z) > uD\X = x) = Pr(l(P(Z) > uD) = \\X = jc), we use a probit model (for each value of uD) to estimate thisIn practice we replace Fx( · ) and Fx\d=i( ' ) by their empirical analogs probability. Let Pr(P(Z) > uD\X = jc) denote the estimatePdxi · ) and Px\d=i( ' )» leading to

probability.

Step 5. We repeat steps 2, 3, and 4 for each value of uD.

Step 6. With £{J\X = x), %J\X = x,P(Z) > uD), and Pr(P(Z) > uD\X = x) AJV= J A7W^x(jc),
in hand, we can compute the numerator of equation (B6). In order to get the denominator, we use the fact that

a>/vU, ud) duD

ATT= I AnWrfx|D=lW.

1
" Cov(/,D|X = jc)
f ((E(J\P(Z) >uD,X = x)~ E(J\X = x))\ _ X J\ X Pr(P(Z) > uD\X = x) )dUD ~ _ l '
so with the numerator in hand, it is straightforward to obtain the value of the covariance (conditional on X).
4. The Treatment Parameter Weights We use the treatment-on-the-treated (TT) parameter to illustrate the computation of the treatment parameter weights. The TT weight is
. , Pr(P(Z) > uD\X = x)
I Pr(P(Z) > uD\X = x) duD

APPENDIX C
Yitzhaki's Theorem (Yitzhaki, 1989) Assume (Y, X) i.i.d., E(\Y\) < oo, E(\X\) < «>, E(Y\X) = g(X), g'(X) exists and E(\g'(x)\) < oo. Let [ly = E(Y) and |x* = E(X).
Then
Cov(y,X) fx -VaK«" = J/'Ww(r)*'
where
i f-

and consequently, we can use Pr(P(Z) > uD\X = jc) to estimate (OttOcm^). As in the case of ca/v(jc, md), with the estimated value of Pr(P(Z) > uD\X = jc) in hand, we can directly obtain the value for J Pr(P(Z) > uD\X = x) duD, using the fact / coxxC^Hp) duD = 1 .

= y^j E(X - \lx\X > t) Pr(X > t).
Proof:

5. The IV and Treatment Parameter Estimators

Cov(y, X) = Cov(£(y|X), X) = Cov(g(X), X) The MTE and the weights can be used to construct the different

estimators. In particular, if AyV (jc) denotes the IV estimator obtained by

using the instrument J, we know that

= J g(t)(t-Vx)fx(t)dt.

AJVU) = MTE(jc, KdMv.U «d) duD.

Integration by parts implies that

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

430 THE REVIEW OF ECONOMICS AND STATISTICS

Heckman (2003) and Cunha, Heckman, and Navarro (2007). In this

= g(t)\ (x-v.x)Mx)dx
J _30 -*

appendix, we present the main properties of this more general model. The thresholds are now written as Qs + CS(WS) in place of CS(WS\

where Qs is a random variable. In addition to the order on the CS(WS) in the

text, we impose the order Qs + CS(WS) > &_, + C.-KW,-,), 5 = 2,...,

S - 1. We impose the requirement that & = °° and Qo = - °°. The latent
-J g'(t)\ (x-lLx)fx(xind)exdDf x is asddeftined in the text, but now

= I g'(t) I (x-iix)fx(x)dDx s =d 1[CtS_,, (W,.,) + &_, < MZ) - V*C,(WM) + fij
= lfo-^ZW..) - ft_, > V> ts(Z,Ws) - Qsl

because E (X Therefore,

-

|xx)

=

0

and

the

firwshetre t5e (Z,rWm s) = \iln d(Z) -tCh S(WeS).fUisir ngstthe feacxt tphart e £Ss(Zs,WiSo) n - Qs v < anishe

,_,(Z;Wrs_i) - &_i, we obtain

Cov(r, X) = I g'(t) E(X - ixx\XW>i-.wt.),)P-ra-(.X > v>>t 5()z,dwtj -. a]

Thus

= i[v+a-i<c(z,^_,)]

-i[v+ft=^(z,wy].
i»{t) = ^^)E(X-[Lx\X>t)Vr{X>i). 

Notice that:

The nonparametric identifiability of this choice model is established Carneiro, Hansen, and Heckman (2003) and Cunha, Heckman, and Na

(i) The weights are nonnegativ vaerro(e (20o0(7O ). W> e re0ta)i.n assumptions OC-2 to OC-6, but alter OC-1 to

(ii) They integrate to 1 (use integration by parts).
(iii) They are = 0 at t = -<», ooOC. -1': (Qs,Us,V) JL (Z,W)|X, s = 1, . . . , S.

Vytlacil (2006b) shows that this model with no transition-specific
We get the formula in the textinw struhmeennts (iwn ith p Wls adecge eneo raf te fX or eaw ch es) iu mpsliees aPnd(Zis)imapn lieddbytth h domain of P(Z) is suitably definienddep.endence and monotonicity conditions of Angrist and Imbens (1995
We apply Yitzhaki's result to thfeortar n eoradterm ed emnodtel.eDfeffineecQt= m (ft,o.d. e . ,lft). Redefine tts(Z,Ws) =

Y = a + PD + e,

Fv+Q (|xD(Z) + CS(WS)\ and define tt(Z,W) = [irrfZW)
irs-ifeWs-,)]. Redefine UDtS = Fv+Q$ (V

E(Y\P(Z)) = a + E(p|D = 1,P(Z))/>(Z)

= a + £(p|P(Z)>MD,P(Z))P(Z)

= g{P{Z)).

By the law of iterated expectations, we eliminate the conditioning on D = 1. Using our previous results for OLS, we have
cov(r,p(z)) f IV = Cov(D,P(Z)) = J^(fM^
a[E(PlP=i,p(z))]p(z)
8it) =
J [<p - E(P(Z))]/,(<p)</<p
ttW = " Cov(P(Z),D) *

i, (E(1[V+ ft., < <I.I(Z,WI-I)] " ^ \ - £(1[V + ft < es(Z,Ws)
s=l
I f es-i(z,ws-i) \
. E{YS\V+Qs.x = t) dFv+Q,_M
^ f (Az,ws) 5=1 - E(Ys\V+Qs = t)dFv+Ql(t)
\ J-« / ' fir.-itZ.W,-,) \

Under assumptions A-2 to A-5 and separability, we have g'(t) = AMTE(f) but g'(t) = LIV, for P(Z) as an instrument.
APPENDIX D

_v°
5=1 - £(^1^ = 0^
\ Jo I

Generalized Ordered Choice Model with Stochastic Thresholds

We thus have the index s

E(Y\tt(Z,W)\ and in the ge

The ordered choice model presented in the text with parameterizeE d, (buY t s+i - Ys | UDs = tts). Also nonstochastic, thresholds is analyzed by Cameron and Heckman d (199V 8), dirs d>ns- [E{Y | tt(Z,W

who establish its nonparametric identifiability under the conditionisn thd ey ependence between Us and V

specify. Treating the Ws (or components of it) as unobservables, wed obe tainnce for the more general

the generalized ordered choice model analyzed in Carneiro, HanseE n, a(nY d \tt(Z,W) = it) in it.

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

MODELS WITH ESSENTIAL HETEROGENEITY 431

Define

APPENDIX E

A^.U ii) = E(Ys+l - YS\X = jc, UD,DSer=iva«ti)o,n of the Weights for IV in the Ordered Choice Model

so that our result above can be rewritten as
/- E(Y\tt(Z, W) = tt) = A5m7+.U it,).

We first derive Cov (J(Z,W),Y). Its derivation is typical of the ot terms needed to form equation (30) in the main text. Definin J(Z,W)=J(Z,W)-E(J(Z,W)), we obtain, because Co\(J(Z,W),Y)= E(J(Z,W)Y),

Because Tt(Z,Ws) can be nonparametrically identified immediately from
TTs(Z,Ws)=Pr(Lsj=s+i Dj= 1 1 Z,W5) we have that the above offset equality immediately implies identification of MTE for all evaluation points within the appropriate support.
The policy relevant treatment effect is defined analogously. Recall that H"s is defined as the cumulative distribution function of |xD(Z) - CS{WS). We have that

E(J(Z,W)Y)
\es(z,ws) 1 1
[* J(ZlW)S1l-v<r..1^..1)f1'JVH \es(z,ws)
i, r K(z,uy l ]

Ea(Ya) = £fl(£(y|V,eZW))

where the first equality comes from the definition iterated expectations, and the second equality follow expectations and the independence assumption OC H"s( - ) for a equal to the policy that characterizes th is, Hs( · ) is the cumulative distribution function of

Has(t) = Pr(s(Z,Hy < t)

5
= £ (Ea(E(Ys\V,Q){H°(V + Q.) - H-..,(V + &_,)})) 5=1
i, f (E(Ys\V=v,Q = q) \
= ^J {mv+qs)-H°s_l(v+<!s-,)})dFve(v'q)

= Pr(MZ) - CS(WS) < t).
Using the law of iterated expectations, we obtain
s
E(J(Z,W)V) = X e[e(j(Z,W)(i[V<s_1(Z,Ws-1)]

If \

-i[vs,(z,w,)])|v)£(yjv)]

- E(Ys\V+Qs = t)H*,(t)dFv

=5
- £(K\ ,|V + &_, = f)«JJ -,W dFy+a..,®

I

= S [£(r,|v=w){A:1_I(w)-*:,(v)}]/v(w)rf«'
5=1 J

s-i r

where K fi, ente=rE [a E(d Ysd +l i - t Ysi\v V=e v)l Ky s(v, )}]f
5=1 J
A^ = £,,(« - Ea(Y)

where AT^v) = E (J(Z,W) | 5(Z, W,) > v) [1 - //5(w)] and we use the fact that Kgv) = K0(v) = 0.
Now consider the denominator of the IV estimand,

Alternatively, E(DJ(Z,w W)) = eI Je (Z, WO Jc £ sl[ta s(Z,Wn s) < V < ^.(Ze .W,-,x )] press

\ 5=1
If \
- E(Ys\UD,s = t)H 5 as(t)dt

/

Ea{Ya) = X

= X jEC^z.woit^tz.w,) < v< c.Cz,^,)])

5=1 I - E(Ys\UD^i = t)H%l(t)dti

5=1

\JI

5

so that

= ^ 5£(£(J(Z,W){1[V<5_1(Z,W5_I)]
5=1

AaPI?E = Ea\Y) ~-i[vE <5a (z,^{ )]}Y |v) )

5-1 r
= E («^+. - nl^D, = t){Has(t) - Has\t)=}5)=^1 sdJ\t[Ks-M-Ks(v)]Mv)dv 5=1 J

5-1 r

where //? is the cumulative distribution function of the random variable
\>d(Z) " CS(WS)).

= E K,(v)Mv) dv.
5=1 J

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

432 THE REVIEW OF ECONOMICS AND STATISTICS

Collecting results, we obtain an expression for the IV estimand (30):

Cov(7,y) 5^ f

^-} Pr(DSJ = 1 \X = x, Z = Z) = [^ nz^AHz^x,^),

Cov(7tD) = ^ E(Ys+x ~ rJV= vMs>v)Mv)<l* 5=1 ·>

where /( · 'jc,z[~j]) is the density of Rj\j(zl~j]) - Vj conditional on X = jc. Consider

where

E(Y\X = x, Z = z)

Ks(v)
u(s,v)

=

= E(Yj,j\X = x,Z=z) + E(Dj,j(Yj - Yjy)\X = x,Z= z).

^_( I [/^ As a consequence of B-l, B-2b, B-3, and B-4, we have that E (Yj^X = x, Z = z) does not depend on z[j]. Using the assumptions and the law of

K£v)

iterated expectations, we may write

E(Dj,J(Yj-Yj,j)\X = xZ = z)

E'"1 KM(v)Mv)dv 5=1 J

and clearly

X o)(s,v)fv(v) dv = 1, o>(0,u) = 0, and <o(S,v) = 0.

5=1 J

J -x

APPENDIX F

Thus,

Proof of Theorem 1

^0]E(Y\X = x,Z=z)

Proof: The basic idea is that we can bring the model back to a

two-choice setup of the second assertion,

~ _ j versus the next best option. We prove the result f~or_
that AyLIV (x,z) recovers the marginal treatment effect

(EY\^YX' Y=^

xR, j2(zf)-»=

=Rzj,[-j(Jz\) \)

parameter. The first assertion, that AyWald (x, z["^, zm, z°]) recovers a LATE parameter, follows from a trivial modification to the same proof strategy.

Recall that Rjy(z) = max/Gt7V {/?,(z)} and that Ij\j = argmax,G47V (/?,(Z)).

We may write Y = Yjy + Djj(YrYj\j). We have

Combining results, we have

Pt(Djj = \\X = jc, Z = z) = Pt(Rj(zj) > Rjm(z)\X = x,Z = z)

= Pr(fl,(z,) > Rjy(z) - Vj\X = x,Z = z).

^0]E(Y\X = x,Z=z)

Using the independence assumption B-l, Rj\j(z)-Vj is independent of Z

conditional on X, so that

^-]?r(DJ,= \\X = x,Z = z)

PrCD^,,. = \\x = x,Z=z) = Pr($j(Zj) ^ Rjy(z) ~ V,\X = x).

= E(Yj - Yjy\X = x,£-j] = z[-j\Rj(z) = Rjyiz)).

ftk( - ) does not depend on zV] for k # j by assumption B-2b, anFdinatlhlyu, snoting that

Rj\j(z) does not depend on z^\ and we will therefore (with an abuse of notation) write Rj\j(z[~j]) for Rj\j(z). Write F( · ; x, z[~j]) for the distribEu(Y-j - Yj,j\X = x£~j] = z[~J\Rj(z) = Rjy(z))

tion function of Rj\j(z[~n) - V, conditional on X = x. Then

= E(Yj - Yj,j\X = jc,Z = z,Rj(z) = Rjy(z))

Pr(D^,; = 1|X = jc,Z = z) = F(tij(zj);xJ-j])
and

provides the stated result. The proof for the LATE result follows from a
parallel argument using discrete changes in the instrument. 

This content downloaded from 206.253.207.235 on Thu, 17 Oct 2019 16:02:59 UTC All use subject to https://about.jstor.org/terms

