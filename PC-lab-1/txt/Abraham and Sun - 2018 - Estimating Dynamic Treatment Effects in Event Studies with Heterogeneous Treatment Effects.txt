Estimating Dynamic Treatment Effects in Event Studies with

arXiv:1804.05785v1 [econ.EM] 16 Apr 2018

Heterogeneous Treatment Effects
Sarah Abraham and Liyang Sun∗
April 17, 2018

Abstract
Event studies are frequently used to estimate average treatment effects on the treated (ATT). In
estimating the ATT, researchers commonly use fixed effects models that implicitly assume constant
treatment effects across cohorts. We show that this is not an innocuous assumption. In fixed effect
models where the sole regressor is treatment status, the OLS coefficient is a non-convex average of the
heterogeneous cohort-specific ATTs. When regressors containing lags and leads of treatment are added,
the OLS coefficient corresponding to a given lead or lag picks up spurious terms consisting of treatment
effects from other periods. Therefore, estimates from these commonly used models are not causally
interpretable. We propose alternative estimators that identify certain convex averages of the cohortspecific ATTs, hence allowing for causal interpretation even under heterogeneous treatment effects. To
illustrate the empirical content of our results, we show that the fixed effects estimators and our proposed
estimators differ substantially in an application to the economic consequences of hospitalization.

1

Introduction

Rich panel data has encouraged a growing literature of empirical work using difference-in-differences (DID)
designs to estimate the average treatment effects among units that receive the treatment (AT T ) in the
treatment period. The key identifying assumption is that in the absence of treatment, treated units would
have experienced the same trends in average outcomes as the control units (i.e. a parallel trends assumption).
An extension to DID, frequently called an “event study”, exploits variation in the timing of a unit’s treatment
to estimate the AT T . Examples of treatments include adverse health shocks to individuals, and policies being
rolled out to different states.
∗ Email

lsun20@mit.edu. We are grateful to Isaiah Andrews, Amy Finkelstein, Anna Mikusheva, and Heidi Williams for

their guidance and support. We thank Alberto Abadie, Peter Hull, Kevin Kainan Li, Whitney Newey, and James Poterba for
helpful comments. This research was supported by the National Institute on Aging, Grant Number T32-AG000186. This draft
is a work in progress and should not be cited without prior approval. Replication code is available on http://economics.mit.
edu/grad/lsun20/ Comments are welcome; all errors are our own.

1

Event study differs from DID design in that treatment is no longer uniquely characterized by a binary
variable. In event studies (where treatment is an absorbing state), treatment is uniquely characterized by
the timing of treatment, and we can categorize treated units into cohorts based on when they first receive
the treatment. For each cohort, we can define relative time as the time relative to the initial treatment.
Within a cohort, calendar time and relative time are collinear, so we cannot identify dynamic treatment
effects in the presence of time trends. However, with multiple cohorts, as in DID, we can separate these two
effects by comparing the trends in average outcomes between treated cohorts and cohorts yet to be treated
(given a parallel trends assumption). As a result, we can identify causal treatment effects for a given cohort
at many different relative times, provided that this cohort is treated for more than one period. We call
these cohort-specific average treatment effects on the treated CAT T s. Researchers are often interested in
some weighted averages of CAT T s, and their estimates are typically obtained from a linear two-way fixed
effects (F E) regression, with both unit fixed effects and time fixed effects. To estimate dynamic treatment
effects, researchers add lags of treatment to the regression and interpret the coefficient on a specific lag as a
weighted average of CAT T s from the given lag. To gauge whether the parallel trends assumption is plausible,
researchers add leads of treatment to the regression and take the coefficients on these leads as evidence for
lack of or existence of pre-trends.1
In this paper, we make the following three contributions. First, we cast event studies in a potential
outcome framework to discipline possible forms of heterogeneity in CAT T s. Second, we examine the behavior
of the linear two-way fixed effects regressions for event studies when CAT T s are allowed to differ across
cohorts. We show that the F E estimators can be non-convex averages of CAT T s, and thus not causally
interpretable. Lastly, we propose alternative estimators that are guaranteed to estimate convex averages of
CAT T s. We close with an empirical example that demonstrates both how and why F E estimators can be
misleading in comparison to our suggested alternative estimators.
We begin by providing a potential outcome framework for event studies, and clarify the notion of treatment effects heterogeneity in a dynamic setting, which is specific to event studies. We define the underlying
causal parameter of interest as the cohort-specific average treatment effect on the treated (CAT T ). Since
cohorts are the level used to identify time trends separately from dynamic treatment effects, they are also the
key level of concern for confounding heterogeneity. We can categorize a single cohort’s effects as either static
or dynamic and the overall effects as either stationary or non-stationary. A cohort has “static” treatment
effects when the CAT T is constant over time; in contrast, it is “dynamic” when the treatment effect evolves
over time. Treatment effects are “stationary” when the the CAT T is the same across all cohorts for a given
relative time; otherwise the effects are said to be non-stationary, which can be interpreted as heterogeneity
1 Such

practice can be considered as an extension to the Granger causality model popular in DID designs.

2

in a dynamic setting.
Building on the potential outcome framework, we derive the estimands for conventionally used F E
estimators and find that they do not necessarily identify convex averages of CAT T s, and therefore do not
identify an interpretable causal effect. These two-way fixed effects models come in two varieties: static and
dynamic. In the static model, the only regressor other than fixed effects is an indicator for a unit being
treated at time t. Similar to Borusyak and Jaravel (2017) and de Chaisemartin and D’Haultfœuille (2018),
we find that while this F E estimator estimates a weighted average of CAT T s across all cohorts and relative
times, the weights can be non-convex and thus do not correspond to an overall causal effect.
In the dynamic model, researchers include leads and lags of the treatment indicator. When treatment
effects are dynamic and heterogenous, we find the dynamic model also does not return interpretable estimates
of causal effects. The estimator associated with a particular lead (or lag) l, does not necessarily estimate a
weighted average of CAT T s associated with l; instead, it may pick up spurious terms consisting of treatment
effects from periods other than l.2 This cautions against interpreting the lead coefficient estimates as (lack of)
a pre-trend, and the lag coefficient estimates as lagged treatment effects. We propose an alternative estimator
that is guaranteed to estimate a convex average of CAT T s from the corresponding relative time l. These
estimators are based on an interacted model that is saturated in relative time and cohort indicators which
is first used to estimate CAT T s. Then we pick the CAT T s associated with l to form a weighted average,
with weights equal to the share of each cohort. These alternative estimates are thus causally interpretable.
To our knowledge, the negative results regarding the dynamic model have not been documented.
We demonstrate the empirical relevance of our negative finding regarding the dynamic F E model by reestimating the economic consequences of hospitalization seen in Dobkin et al. (2018) for an elderly sample.
We study hospitalization in a subsample of the Health and Retirement Survey (HRS), consisting of 2,813
patients across five waves of survey (roughly 2004-2012, biennially), and estimate the effect of hospitalization
on out-of-pocket medical spending and on labor earnings. In this context we think stationarity might be
violated because individuals gradually age into Medicare and retirement, thus we expect the treatment effect
may change over time. Using our alternative estimator we find that hospitalization increases out-of-pocket
medical spending and decreases labor earnings, similar to the results of Dobkin et al. (2018). In contrast, we
show that the FE estimator gives results of the opposite sign, suggesting hospitalization decreases medical
spending and increases labor earnings. This example illustrates how F E estimates can lead to misleading
results in the presence of dynamic and heterogeneous treatment effects.
2 Hull (2017) discusses identification of mover average treatment effects in mover regressions. Similar to the dynamic model we
consider, mover regressions are two-way fixed effects models using multiple treatment indicators as regressors. Each treatment
indicator corresponds to a unique treatment, unlike the present setting where the relevant “treatments” are lags and leads of
the current treatment. Hull also finds the multi-valued treatment coefficients identify a linear combination of mover treatment
effects and a set of non-causal terms.

3

In the next section, we relate our findings to the previous literatures on estimating treatment effects of a
time-varying treatment. Section 2 introduces the potential outcome framework for event studies. Following
that, we derive the asymptotic behavior of the F E estimators and present the negative results on them.
Section 4 develops our alternative estimators. Section 5 discusses applications of our results and Section 6
concludes.

Literature
Our results relate to a number of previous literatures. The literature on estimating treatment effects of
a time-varying treatment starts with the marginal structural models developed by Hernán et al. (2001).
They take a selection-on-observables approach, by assuming sequential randomization conditional on timevarying observable confounders. Event studies typically allow for unobserved time-invariant and separable
confounders. By assuming the timing of treatment is exogenous to the growth in outcome if never treated,
the timing can depend on unobserved time-invariant confounders in an unrestricted form, as long as they
are separable and can be differenced out.3
Our analysis contributes to the literature analyzing linear two-way fixed effects models (de Chaisemartin
and D’Haultfœuille, 2018 and Kim and Imai, 2017). de Chaisemartin and D’Haultfœuille (2018) focus on
a setting where treatment groups are defined by the evolution of treatment rate. For example, the treated
group experiences a larger increase in treatment rate than the control group between two time periods. They
find that the F E estimator estimates a weighted average of local average treatment effects (LAT E) in each
treatment group, under the assumption that treatment effects are not dynamic. That is, they assume the
LAT E for each treatment group does not vary after treatment.

Kim and Imai (2017) focus on a setting

where treatment groups are defined by their treatment history. Under the assumption that treatment has no
lasting effect beyond the period of initial treatment, they find that the F E estimator estimates a weighted
average of average treatment effects in each treatment group. While we show similar results that the F E
estimator estimates a weighted average of average treatment effects in each cohort, due to the structure of
event studies, we are able to relax their assumptions on treatment effects.
In event studies, we are able to identify average treatment effects on the treated in each cohort (CAT T ) instead of LAT E because cohorts experience sharp increases in treatment rate. Cohorts that receive treatment
in the future serve as control group for cohorts that have already received treatment. Unlike de Chaisemartin
and D’Haultfœuille (2018), we are thus able to allow for dynamic treatment effects, meaning treatment effects can vary with time since treatment. We can also allow for lasting treatment effects. Kim and Imai
3 Chernozhukov et al. (2013) studies the case with non-separable unobserved time-invariant confounders. Our results can be
extended to non-separable models under the assumption of no time effects or a restricted form of time effects.

4

(2017) requires that past treatment cannot affect current outcome because it is difficult to adjust for all
treatment history and time-invariant unobserved confounders at the same time. To adjust for time-invariant
unobserved and separable confounders, we compare treated and control observations across different time
periods within the same unit. Had past treatment affected current outcome, then observations in control
status of current period might not have the outcome as if the unit is never treated, if the unit was treated in
the past. In the absence of lasting treatment effects, conditioning on the contemporaneous treatment status
is sufficient for the comparison. Event studies are an exception because treatment is an absorbing state
and treatment status changes only once from the control to treatment condition. Observations in control
status of current period thus have the outcome as if the unit is never treated (under the assumption of no
anticipatory behavior, as we discuss in Section 2. We can thus estimate CAT T s at lagged time periods. We
think allowing for dynamic and lasting treatment effects is important in event studies, and particularly for
our application.
Borusyak and Jaravel (2017) focus on event studies and find that when treatment effects are dynamic but
homogeneous across cohorts, the F E estimator in the static model could weight long-run treatment effects
negatively when no leads or lags of treatment are included in the specification. We show a similar result
when treatment effects are allowed to be heterogeneous, and our negative results extend to the specification
with leads and lags of treatment. The F E estimators for pre-trends are likely to assign non-zero weight
on treatment effects post-treatment, which can yield non-zero pre-trends estimates even though there are
no pre-trends. The F E estimators for l lags to treatment are likely to be a non-convex average of CAT T s
from l periods after initial treatment, as well as CAT T s from other periods, which can yield an estimate
with the opposite sign to any CAT T s from l periods after initial treatment. These negative results have not
been documented to our knowledge, and we illustrate their relevance using both a simulation example and
an empirical application.

2

Event studies in a potential outcome framework

We assume a balanced panel of N units and T + 1 time periods with no missing data. We also assume a
simple random sampling of units with T fixed. For each unit i = 1, . . . , N at time t = 0, . . . , T , we observe
an outcome variable Yi,t and a binary treatment status variable Di,t ∈ {0, 1}: Di,t = 0 if i has not been
treated by period t and Di,t = 1 if i has been treated by period t.
T

For each unit we observe a treatment path {Di,t }t=0 . In event studies, treatment is an absorbing state
and the treatment path is a non-decreasing sequence of zeros and then ones. Thus, the treatment path of
a unit can be uniquely characterized by the time period of the initial treatment, identified with the scalar

5

random variable Ei = min {t : Di,t = 1}. We call this random variable Ei “event time” as it refers to the
onset of the treatment. In our notation, cohort e is the set of units for which Ei = e. Denote Ei = ∞ for
units never treated.
We assume that in this panel, Ei is supported on {1, 2, 3, . . . , T }, so no units are treated in the first
period (t = 0) and all units are treated by the last period (t = T ). We assume P r {Ei = 0} = 0 since we
cannot apply DID estimators for Ei = 0 as we see later.4 Our results extend to the case where we observe
units never treated in the panel (possibly treated after the panel Ei > T , or a pure control group that is
never treated Ei = ∞).
Potential outcomes describe realizations of the outcome variable Yi,t that arise in response to a hypoe
thetical treatment path e. We denote the potential outcome in period t under treatment path e by Yi,t
. In
∞
particular, Yi,t
is the potential outcome if unit i never receives treatment, which we call “baseline outcome”.

We observe each unit under only a single treatment path Ei = e, so the observed outcome for unit i is
∞
Yi,t = Yi,t
+

X


e
∞
Yi,t
− Yi,t
· 1 {Ei = e}

(1)

1≤e≤T

2.1

Identifying assumptions

We maintain the following assumption which makes growth in baseline outcome mean independent of the
event time Ei .
 ∞

∞
Assumption 1. (Parallel trends in baseline outcome.) E Yi,t
− Yi,s
|Ei = e is the same for all e ∈
 ∞

∞
supp (Ei ) ∀s, t and in particular, equal to E Yi,t
− Yi,s
.
Another assumption necessary for identification of the causal parameters we are interested in precludes
treatment from influencing outcomes before treatment takes place.
e
∞
Assumption 2. (No anticipatory behavior.) Yi,t
= Yi,t
for all t < e. In other words, potential outcomes
e
∞
before treatment happens are equal to the baseline outcome. Equivalently, Yi,e+l
= Yi,e+l
for all l < 0.

This assumption is plausible if the full treatment paths are not known to units, so that future treatment
cannot affect current potential outcome. However, if the full treatment path is known to the units, then the
potential outcome prior to treatment may be affected by future treatments.5
We maintain both Assumption 1 and Assumption 2 throughout our analysis.
4 Intuitively,

if a cohort is treated in all periods we cannot identify dynamic treatment effects separately from time effects.
example is consumption smoothing. Let Yi,t be consumption and Di,t be an indicator of increase in sales tax. Future
1 and we cannot assume Y 1 equals Y ∞ . Malani and
increase in sales tax Di,1 = 1 may lower current level of consumption Yi,0
i,0
i,0
Reif (2015) also gave an example of anticipated tort reforms impacting physicians supply before the adoption of these reforms.
5 An

6

h
i
e
∞
Under these two assumptions, we can identify causal parameters CAT Te,l := E Yi,e+l
− Yi,e+l
| Ei = e ,
the cohort-specific average treatment effects on the treated l periods relative to the initial treatment for
cohort e as shown later in Proposition 3. For cohort e, l ranges from −e to T − e because at most we observe
e periods before initial treatment and T − e periods after initial treatment. Note that we cannot identify
Ei
∞
unit treatment effect Yi,E
as in Chernozhukov et al. (2013) without further assumptions.6
− Yi,E
i +l
i +l

This assumption also implies no pre-trends since CAT Te,l = 0 for all l < 0.

2.2

Additional assumptions on potential outcomes

We state two additional assumptions that may be imposed on potential outcomes. As we show later, these
additional assumptions are necessary for the F E estimators to yield interpretable estimates.
Assumption 3. Static treatment effects. If CAT Te,l = CAT Te,l0 for all l 6= l0 , l, l0 ≥ 0, then we say
treatment effect for cohort e is static; in contrast, if CAT Te,l 6= CAT Te,l0 for any l 6= l0 , l, l0 ≥ 0, then we
say treatment effect for cohort e is dynamic.
Within a cohort, we can categorize treatment effects as static or dynamic. Static effects impact units
immediately upon treatment and on average, persist at the same level for all treated periods. We call the
opposite of static effects dynamic. Treatment effects are likely to be dynamic when the treatment of interest
is a transient shock (like an adverse health shock which we will explore in our application) or when there is
learning from and adaptation to the treatment over time (like switching to a new firm).
Assumption 4. Stationary treatment effects. If CAT T for all l ≥ 0 depends only on l and not on e, then
we say treatment effects are stationary; in contrast, if for any l ≥ 0, CAT Te,l varies by e, then we say
treatment effects are non-stationary.
We can categorize the overall treatment effects as stationary or non-stationary. Stationary effects mean
that on average, each cohort experiences the same effects at any given relative time period. We call the
opposite of stationary effects non-stationary, which reflects heterogeneity across cohorts. In an event study,
this sort of heterogeneity across cohorts could be driven by time-varying effect. An example of this, which we
explore in our application, is that aging into Medicare and retirement could mean the same adverse health
shock has a different impact on spending and labor earnings in later waves of the HRS panel.
6 Chernozhukov et al. (2013) shows that when outcomes with and without treatment have the same distribution in each
time
h period, iwe can identify unit treatment effect. This assumption would further restrict trends in baseline outcomes
∞ − Y ∞ = 0∀s, t and treatment effects to be static (see Assumption 3 below).
E Yi,t
i,s

7

3

Linear two-way FE regression models for event studies

Treatment effects in event studies are often estimated by a linear regression with two-way fixed effects
containing unit and time fixed effects. There are two common specifications: static and dynamic. The static
specification is
Yi,t = αi + λt + γDi,t + ξi,t

(2)

where Di,t is the treatment indicator in time period t. The regression coefficient estimator γ
b is commonly
interpreted as an estimator for some weighted average of CAT Te,l ’s across all cohorts and all lagged time
periods. The other common specification, which we refer to as the dynamic specification, adds leads and
lags of treatment to the above specification

Yi,t = αi + λt + D|i,t µ + υi,t .

(3)

l
l
Here Di,t is a column vector collecting Di,t
for −T ≤ l ≤ T − 1, where Di,t
is an indicator for being l

time periods relative to i’s initial treatment (l = 0 is the year of initial treatment).7 The lagged coefficient
estimator µ
bl for some l ≥ 0 is commonly interpreted as an estimator for some weighted average of CAT Te,l ’s
across all cohorts e that experience at least l periods of treatment. The regression coefficient estimators µ
bl
for l < 0 are commonly interpreted as estimators for pre-trends.
Below we show that while these F E estimators do estimate weighted averages of causal parameters
CAT Te,l ’s, the weights are in general unreasonable and need not be positive without additional assumptions
that restrict treatment effects to be static or stationary. These negative results caution us against always
interpreting the F E estimates as estimates for some convex averages of CAT Te,l ’s. We first focus on the
static F E estimator and present a result similar to Borusyak and Jaravel (2017) and de Chaisemartin and
D’Haultfœuille (2018).
Proposition 1. (Probability limit of the static FE estimator). Denote D̄·,e+l = P r {Ei ≤ e + l}, D̄e,· =
and D̄ =

T −E[Ei ]
T +1 .

T −e
T +1

Under Assumption 1 and 2, the regression coefficient estimator γ
b from (2) converges in

probability to

γ
b →p

T
X

X

ωe,l AT ETe,l

e=1 0≤l≤T −e

where the weight is ωe,l := P r {Ei = e}

(1−D̄·,e+l −D̄e,· +D̄)
PT
and these weights sum up to one.
2
t=0 E [D̈i,t ]

7 Even though we sum l over its possible range, we actually need to exclude at least two relative time indicators due to
multicolinearities.

8

Proposition 1 reveals that, while the static F E estimator converges to a weighted average of CAT Te,l ’s,
the weights generally do not coincide with sample frequencies. The numerator of the weight, 1 − D̄·,e+l −
D̄e,· + D̄, is the residual from predicting treatment status Di,t with unit and time fixed effects. It thus
downweights (to the point of potentially negatively weighting) the long-run treatment effects (large l) for
cohorts with an early onset of treatment (small e) because the fixed effects would overpredict their treatment
probability.
As a concrete example, if all units are treated at some time within the panel, some weights will necessarily
be negative. Since all units have been treated by the final period, we have D̄·,T = 1. Furthermore, D̄e,· > D̄
for cohorts treated in the early half of the panel (e < E[Ei ]). So the weights associated with CAT Te,T −e ’s for
these cohorts in the last period are all negative. γ
b would then estimate a non-convex average of CAT Te,l ’s.
Its probability limit will be further from a convex average when the CAT Te,l ’s associated with negative
weights are of large magnitude, and can even drive the the sign of γ
b to be the opposite to the majority of
CAT Te,l ’s.
Special Case: Static and Stationary Treatment Effects. From Proposition 1, we can also see that
when treatment effects are static and stationary for all cohorts, the F E estimator γ
b will estimate the causal
effect of interest. With those strict assumptions, the CAT Te,l does not depend on e nor l so we can move it
outside of the summation and we know the weights sum to one; thus the static F E estimator would give a
reasonable result as it converges to a constant CAT T .
Next we present the probability limits of dynamic F E estimators without any restriction on treatment
effects. To our knowledge, no paper has yet to study the dynamic specification when treatment effects are
dynamic and heterogenous.
Proposition 2. (Probability limits of the dynamic FE estimators). Under Assumption 1 and 2, the lagged
FE estimator µ
bl for some l ≥ 0 converges in probability to a weighted average of post-treatment CAT Te,l0
for all l0 6= l,
µ
bl →p

X

l
ωe,l
CAT Te,l +

1≤e≤T −l

where

P

−l≤e≤T −l

l
ωe,l
= 1 and for each l0 6= l,

X

X

l0 6=l

1≤e≤T −l0

P

−l0 ≤e≤T −l0

l
ωe,l
0 CAT Te,l0 ,

l
ωu,l
bl for some
0 = 0. The lead FE estimator µ

l < 0 converges in probability to a linear combination of post-treatment CAT Te,l0 for all l0 ≥ 0,

µ
bl →p

X

X

l
ωe,l
0 CAT Te,l0 ,

l0 ≥0 1≤e≤T −l0

l
1 {Ei = e} · Di,t

0

l0
l
l
ωe,l
0 = 0. The weight ωe,l0 is the projection coefficient of Di,t from regressing
n 0o
l
on the rest of relative time indicators in (3) i.e. Di,t
and two-way fixed effects.

where for each l0 ,

P

−l0 ≤e≤T −l0

l0 6=l

9

The above proposition yields two negative results. First, Proposition 2 shows that the lagged F E estimators µ
bl for l ≥ 0 average treatment effects across cohorts from multiple times periods: CAT Te,l ’s as well
as CAT Te,l0 ’s for l0 6= l. Therefore, µ
bl is not isolating the average treatment effects l periods after initial
treatment, but rather estimating an affine combination of effects from multiple periods.
Second, lead F E estimators µ
bl for l < 0 do not converge to zero even when there are no pre-trends by
assumption. Due to the influence of post-treatment CAT Te,l0 ’s for l0 ≥ 0, µ
bl does not necessarily converge to
zero even though under the no anticipation assumption, CAT Te,l = 0 for all l < 0 and all e so any weighted
average of CAT Te,l ’s should be zero.
We demonstrate the negative result on lead F E estimators µ
bl for l < 0 through simulation.8 We estimate
(3) on 1000 simulated panel datasets with T = 3 and uniformly distributed Ei ∈ {1, 2, 3}. We exclude
Ei
∞
anticipatory behavior by setting Yi,t
= Yi,t
for all t < Ei . We set post-treatment treatment effects to be all

positive and grow in time. Even though pre-treatment treatment effect is set to zero, the estimates µ̂−1 ’s
are usually negative as shown in Figure 1, which would suggest a negative pre-trend. Even though here we
l
picked an extreme case where both post-treatment CAT Te,l ’s and ωu,l
are set to be large to illustrate the
0
l
negative result, we show that in our application, ωu,l
are large as well and cannot be ignored.
0

100
0

50

Frequency

150

Figure 1: Simulation example

−3.2

−3.0

−2.8

−2.6

^ −1
µ

Notes: This figure plots the histogram of µ̂−1 , the F E estimate for the effect of treatment one period before
treatment, across 1000 simulated samples.

Special Case: Stationary Treatment Effects. In the special case of stationary effects, CAT Te,l is
constant across e for a given l. The F E dynamic estimators thus recover causally interpretable estimates: the
lagged F E estimators µ
bl for l ≥ 0 converges to CAT Te,l and the lead F E estimators µ
bl for l < 0 converges
l
to zero. Otherwise, it is problematic to interpret a non-zero estimates on Di,t
for l < 0 as (lack of) evidence

for pre-trends because non-zero post-treatment CAT Te,l can affect the lead F E estimators.
8 See

Appendix B for more details on the simulation design.

10

4

Alternative method for estimating dynamic treatment effects

We propose a new specification for estimating the dynamic treatment effects in event studies as an alternative
to Regression (3). Unlike the dynamic FE estimators, these alternative estimators are weighted averages of
CAT Te,l ’s with reasonable weights.
Recall that Proposition (2) implies that under stationary treatment effects when CAT Te,l ’s are constant
for a given l, Regression (3) is the correct specification and µ
bl consistently estimates CAT Te,l . Without
stationarity when CAT Te,l varies by e, the error term i,t involves the difference between CAT Te,l and
CAT Te0 ,l for e 6= e0 , which is correlated with the unit fixed effects. This hints at using an interacted model,
l
saturated in relative time indicators Di,t
and cohort indicators 1 {Ei = e}, to estimate each of the CAT Te,l ’s;

the resulting CAT Te,l ’s are averaged to provide the final estimate. Following Gibbons et al. (2018), we call
these estimators “interaction-weighted” (IW ) estimators.
Before introducing the IW estimators formally, we define the DID estimator for CAT Te,l as
EN [(Yi,e+l − Yi,s ) · 1 {Ei = e}] EN [(Yi,e+l − Yi,s ) · 1 {Ei ∈ C}]
δbe,l =
−
EN [1 {Ei = e}]
EN [1 {Ei ∈ C}]
|
{z
} |
{z
}

(4)

g
b∞

g
bl

for some s < e and C ⊆ {c : e + l < c ≤ T }. Here we use the notion EN to abbreviate the symbol

1
N

PN

i=1 .

This estimator is the difference between the average change in outcomes for cohort e, which is exactly l
periods relative to treatment, and average change in outcomes for cohorts that have not been treated by
t = e + l. We refer to this set of cohorts as the control cohorts.9
The DID estimator is an unbiased and consistent estimator for CAT Te,l , a fact that we build on in
showing the probability limit of the IW estimator. We state this in the following proposition.
Proposition 3. Under Assumption 1 and 2, the DID estimator is an unbiased and consistent estimator for
CAT Te,l .
Proof. Provided that the conditional expectations exist, the DID estimator is an unbiased and consistent
estimator for E[Yi,e+l −Yi,s | Ei = e]−E[Yi,e+l −Yi,s | Ei ∈ C]. To show that it is an unbiased and consistent
estimator for CAT Te,l , we show E[Yi,e+l − Yi,s | Ei = e] − E[Yi,e+l − Yi,s | Ei ∈ C] = CAT Te,l .
∞ |E ] for t = T or E = T using DID estimators because
we do not observe Ei = ∞, we cannot estimate E[Yi,t − Yi,t
i
i
∞ |E = 0] using DID estimators
everyone is treated in the last period and C = ∅. Similarly, we cannot estimate E[Yi,t − Yi,t
i
because we do not observe s < 0.
9 When

11

Since s < e and c > e + l, we have

E[Yi,e+l − Yi,s | Ei = e] − E[Yi,e+l − Yi,s | Ei ∈ C]
X
e
e
c
c
=E[Yi,e+l
− Yi,s
| Ei = e] −
P r {Ei = c | Ei ∈ C} E[Yi,e+l
− Yi,s
| Ei = c]
c∈C
e
∞
=E[Yi,e+l
− Yi,s
| Ei = e] −

X

∞
∞
P r {Ei = c | Ei ∈ C} E[Yi,e+l
− Yi,s
| Ei = c]

c∈C
e
∞
∞
∞
=E[Yi,e+l
− Yi,e+l
| Ei = e] + E[Yi,e+l
− Yi,s
| Ei = e] −

X

∞
∞
P r {Ei = c | Ei ∈ C} E[Yi,e+l
− Yi,s
| Ei = c]

c∈C
e
=E[Yi,e+l

−

∞
Yi,e+l
|Ei

= e] +

∞
E[Yi,e+l

−

∞
Yi,s
]

−

∞
E[Yi,e+l

∞
− Yi,s
]

e
∞
=E[Yi,e+l
− Yi,e+l
|Ei = e]

where the second equality follows from Assumption 2 and the fourth equality follows from Assumption 1.
Note that under Assumption 2, Assumption 1 has many testable implications. There are more than one
DID estimators for CAT Te,l since we can set different s < e and take subsets of {c : e + l < c ≤ T } as the
control cohorts. One can thus form an omnibus test for the validity of these two assumptions. See Callaway
and Sant’Anna (2018) for one such test.
It is also possible to relax the parallel trends assumption to allow the timing of treatment to depend
on covariates. We state the conditional parallel trends assumption in Appendix C, and present the doubly
robust scores for estimating CAT Te,l consistently and efficiently as an extension to the inverse propensity
score reweighted estimator proposed by Abadie (2005) and Callaway and Sant’Anna (2018).

4.1

Interaction-weighted estimators

Definition 1. The dynamic interaction-weighted (IW ) estimator for a weighted average of CAT Te,l ’s is
found by first estimating the following specification

Yi,t = αu + λt + B|i,t δ + i,t

(5)

l
on t = 0, . . . , T − 1.10 Here Bi,t is a column vector collecting 1{Ei = e} · Di,t
, for 1 ≤ e ≤ T − 1 and for
l
each e, 1 − e ≤ l ≤ T − e. Similarly, δ is a column vector collecting the coefficients δe,l on 1{Ei = e} · Di,t
.

The IW estimator is given by a weighted average of the estimates δbe,l ’s:

νbl :=

TX
−1−l
e=1

10 We

Ne
PT −1−l
e=1

Ne

 |
b
δbe,l = vec b
fl δ

need to drop time period T because CAT Te,T ’s are not identified. See footnote 9 for more details.

12



th
Ne
where b
f l is a matrix with its (t, e) entry equal to Pbt,e . Here Pbt,e = 1 {t − e = l} PT −1−l
and Ne =
Ne
e=1
PN
i=1 1 {Ei = e}. For example, for T = 3 and l = 0,


b
f0 = 



N1
N1 +N2

0

0

N2
N1 +N2






 P r {Ei = 1|1 ≤ Ei ≤ 2}
0
 →p f = 
0

0
P r {Ei = 2|1 ≤ Ei ≤ 2}


.

|
b which converges
b = (b
Lastly, we collect all vectorized b
f l ’s in b
f . We can thus write ν
ν1−T , . . . , νbT −1 ) = b
f | δ,

to ν = f | δ.
Proposition 4. (Probability of the IW estimators for dynamic treatment effects). Under Assumption 1 and
2, the IW estimator converges in probability to

νbl →p

T
−1
X

P r {Ei = e | 1 ≤ Ei ≤ T − 1 − l} CAT Te,l

e=1

Note that δbe,l from Regression (5) is in essence a DID estimator for CAT Te,l in the form of (4) with s = 0
and C = {T }, which is consistent. Thus, νbl is consistent for a weighted average of CAT Te,l with weights
equal to the share of cohort e across cohorts that have experienced at least l periods of treatment. These
weights are guaranteed to be convex and have a reasonable interpretation.
∞
Among all possible DID estimators for CAT Te,l , δbe,l might not be the most efficient one: suppose Yi,t

follows an AR(1) process with positive correlation, then a possibly more efficient DID estimator sets s = u−1,
C = {c, u + l < c}, and weights each cohort c by their precision.11 That said, we recognize that Regression
(5) is easy to implement compared to other more efficient estimators.
We can similarly form an estimator alternative to the static F E estimator from Regression (2) by

κ
b :=

T
−1
X
e=1

Ne
PT −1
e=1

X
Ne

0≤l≤T −1−e

1 b
δ e,l .
T −e

This estimator consistently estimates a weighted average of CAT Te,l ’s, with weights proportional to the
representativeness of each CAT Te,l , a result stated in the following proposition.
Proposition 5. (Probability of the IW estimator for overall treatment effects). Under Assumption 1 and
2, the IW estimator converges in probability to

κ
b →p

T
−1
X

P r {Ei = e | Ei ≤ T − 1}

X
0≤l≤T −1−e

e=1

1
CAT Te,l
T −e

random sampling, the variance of the DID estimator is the sum of variance of g
bl and g
b∞ . Note that the variance of
∞ − Y ∞ decrease in |t − s|, which suggests we set s = u − 1. Suppose the variance of Y ∞ − Y ∞ differs across cohorts, then
Yi,t
i,s
i,t
i,s
the variance of g
b∞ is minimized when we weight each cohort c by the inverse of its variance.
11 Under

13

Finally, we derive the asymptotic distribution for the dynamic F E and IW estimators. For simplicity,
we assume that like Regression (5), Regression (3) is also estimated on t = 0, . . . , T − 1.
Proposition 6. (Asymptotic distribution of the dynamic FE and IW estimators). Under standard assumptions, the asymptotic distribution of the estimators is

√





 µ̂ − µ 
 ΣF E
N
 →d N 0, 
Σ|12
ν̂ − ν






Σ12



ΣIW

(6)

where

V D̈ =

T
−1
X

h
i
E D̈|i,t D̈i,t

!
V B̈ =

T
−1
X

t=0

ΣF E = V

−1
D̈

E

h

B̈|i,t B̈i,t

i

!

t=0
T
−1
X

E

h

2
D̈|i,t ϋi,t
D̈i,t

i

!
V D̈

|

ΣIW = f V

−1
B̈

t=0

T
−1
X

E

h

B̈|i,t ¨2i,t B̈i,t

i

!
V B̈ f

t=0

Σ12 = V −1
D̈

T
−1
X

E

h

D̈|i,t ϋi,t ¨i,t B̈i,t

!
i

V B̈ f

t=0

We use the notation Ẍi,t to denote Xi,t − X i,· − X ·,t + X, where X i,· =
PT −1
X = T1 t=0 E [Xi,t ].

1
T

PT −1
t=0

Xi,t , X ·,t = E [Xi,t ] and

In the presence of non-stationary treatment effects, the saturated specification (5) may reduce standard
errors of residuals due to better fit. The IW estimators may thus be more precise. Under stationary treatment
effects when both the dynamic F E and IW estimators are consistent for CAT Te,l , which are constant across e
for a given l. The dynamic F E estimator might have smaller variance because specification (3) estimates less
coefficients. There is established efficiency gain when specification (3) is a “grouped” version of specification
(5) and errors are homoskedastic and serially uncorrelated. Specification (3) is a “grouped” version if all
PT −1−l
l
l
l
l
included Di,t
can be written as Di,t
= e≥1 1{Ei = e} · Di,t
, and all such 1{Ei = e} · Di,t
are included in
specification (5). In this case, Di,t is a linear transformation of Bi,t . To construct such specifications, note
l
that if there is no pre-trends, then we only need to include lags of treatments in (3) and 1{Ei = e} · Di,t

for l ≥ 0 can all be included in the saturated model. If further error terms are homoskedastic and serially
uncorrelated, then by Gauss-Markov theorem the dynamic F E estimators are more efficient.

5

Applications

We illustrate the empirical importance of our findings by extending the analysis by Dobkin et al. (2018).
We use both F E and IW estimators to estimate the impact of hospital admissions on out-of-pocket medical
14

spending and labor earnings using a subsample of respondents from the Health and Retirement Survey
(HRS). We show that the F E estimators produces statistically insignificant results with point estimates of
the “wrong” sign; the F E estimates suggest that hospital admissions may decrease out-of-pocket medical
spending and increase earnings for the elderly. In contrast, we show that estimates of CAT Te,l ’s are of
the expected signs and consequently the IW estimator recovers that hospitalization increases out-of-pocket
medical spending right after hospitalization and decreases long-run labor earnings.

5.1

Settings

Our sample selection follows Dobkin et al. (2018) but we include a cursory explanation here for completeness.
Our primary source of data is the biennial Health and Retirement Survey (HRS). We identify the sample
of individuals who appear in two sequential waves of surveys and newly report having a hospital admission
over the last two years (the “index” admission) at the second survey. To focus on health “shocks”, we
restrict attention to non-pregnancy-related hospital admissions. We restrict our analysis to a subsample
of these individuals who appear throughout waves 7-11 (roughly 2004-2012) to maintain a balanced panel
with a reasonable sample size.12 Our sample of analysis therefore includes HRS respondents with index
hospitalization during wave 8-11. Here i naturally indexes individual, and t indexes survey wave (T = 4)
and is normalized to zero for wave 7, the first wave in our sample.
The treatment status Di,t is thus an indicator for whether a respondent has had an unexpected hospitalization by wave t. We think hospitalization is an absorbing state because it approximates the start of a
sick state (as opposed to a healthy state). Thus, event study is an appropriate research design as it allows
for lasting treatment effect of hospitalization.

Our outcomes of interest Yi,t include out-of-pocket medical

spending and labor earnings. They are derived from self-reports, adjusted to 2005 real dollar value and
censored at the 99.95th percentile.
In our terminology, we categorize individuals into cohorts based on Ei , which is defined as the survey
wave of their index hospitalization. Since we restrict the sample to individuals who were ever hospitalized
between wave 8-11, Ei ∈ {1, 2, 3, 4}.
Parallel trend assumption Hospitalization is likely to be earlier among sicker individuals with high
out-of-pocket medical spending and low labor earnings, even when restricted to individuals who were ever
∞
hospitalized. Thus, it is not plausible that the baseline outcome Yi,t
is mean independent of the timing of

hospitalization. Parallel trends assumption is more plausible as it allows the timing to depend on unobserved
time-invariant characteristics such as chronic disease.
12 For their main results, Dobkin et al. (2018) focus on adults with health insurance who are hospitalized at ages 50-59. We
include adults of all ages.

15

No anticipation assumption Given that the treatment is restricted to be unexpected hospitalization,
it is also plausible that there is no anticipatory behavior.
Potential treatment effects heterogeneity The effect on out-of-pocket medical spending is largely
determined by generosity of health insurance, which has possibly decreased as individuals age into Medicare.
The effect on labor earnings is affected by the labor market: for example, individuals hospitalized during
the financial crisis may find it more difficult to return to the labor force, and suffer a more grave decrease in
earnings. We suspect these sources of non-stationarity may be exacerbated in this sample because the elderly
population has experienced the especially rapid change in healthcare spending and labor participation over
time.
Summary Statistic Table 1 presents basic summary statistics for our analysis sample before hospitalization. By design, our sample is older than that of Dobkin et al. (2018) because Dobkin et al. (2018) restricts
to non-elderly adults with ages 50-59 at the time of index hospitalization. Other demographic differences
between our sample and that of Dobkin et al. (2018) align with expectations based on the differences in age.
We have a slightly lower fraction of men in our sample, as well as a higher fraction white and lower fraction
black. Many individuals have also aged into Medicare coverage (for which the qualifying age is 65).
In panel D, we compare means of the cross-sectional distributions of outcomes for individuals who have
not been hospitalized by each wave. The number of respondents hospitalized in each cohort is N1 = 833,
N2 = 711, N3 = 733, and N4 = 536. Thus, the size of the sample conditional on not having been hospitalized strictly decreases each wave. There are apparent time trends in our outcomes of interest prior to
hospitalization as we observe distributional changes across waves. Out-of-pocket medical spendings decrease
first on average, possibly due to coverage by Medicare, but eventually increase. Earnings decrease each wave
on average as more individuals are retired each wave.

16

Table 1: Sample characteristics
N

Mean

Std. Dev

Panel A. Demographics
Age at admission
Male
Year of admission

2,813
2,813
2,813

68
0.425
2,007

9
0.494
2

Panel B. Race/ethnicity
Hispanic
Black
White
Other race

2,813
2,813
2,813
2,813

0.097
0.126
0.817
0.057

0.296
0.332
0.387
0.232

Panel C. Index hospitalization
Medicaid
Private
Medicare

2,813
2,813
2,813

0.057
0.508
0.57

0.232
0.5
0.495

Panel D. Pre-hospitalization outcome
Out-of-pocket medical spending
Wave 7
Wave 8
Wave 9
Wave 10

2,813
1,980
1,269
536

3,143
2,339
1,858
2,412

8,797
5,767
2,746
4,105

Earnings
Wave 7
Wave 8
Wave 9
Wave 10

2,813
1,980
1,269
536

23,656
20,539
17,723
14,773

49,163
43,201
40,486
39,246

We estimate the following two specifications without survey weights. For the linear two-way F E regression
in the spirit of equation (3), we estimate
3
X

Yi,t = αi + λt +

l
Di,t
+ υi,t

(7)

l=−2

for t = 0, . . . , 4. For the saturated model in the spirit of (5), we estimate

Yi,t = αi + λt +

X

T
−e
X

l
νe,l 1{Ei = e} · Di,t
+ i,t

(8)

e∈{1,2,3} l=1−e

for t = 0, . . . , 3. We drop t = 4 from (8) because everyone has had hospitalization by t = 4 , and CAT Te,l ’s
in t = 4 are not identified. We estimate the above specifications with Yi,t equal to out-of-pocket medical
spending as well as labor earnings.

17

5.2

Results and Discussion

Figure 2 compares the dynamic F E estimates of the impact of hospitalization with the IW estimates for
two outcomes: out-of-pocket medical spending and labor earnings. The IW estimates show qualitatively
similar results to Dobkin et al. (2018). The effect on out-of-pocket spending is significant and positive for
l = 0 (roughly 1 year after hospitalization). The effect on earnings becomes significantly negative starting
in l = 1 (roughly 3 years after hospitalization) and remains large for l = 2. In contrast, the dynamic
F E estimates are all statistically insignificant, even though the underlying CAT Te,l ’s are mostly precisely
estimated. Furthermore, the F E point estimates are of the opposite signs of the IW estimates, which are
unreasonable as they suggest that out-of-pocket medical spending decrease while earnings increase after
hospitalization.

−2

−1

0
1
Relative Wave
FE

2

−20000

−6000

−4000

−10000

Estimate
0

Estimate
−2000
0

10000

2000

4000

20000

Figure 2: F E vs IW Estimates of the Effect of Hospitalization on Outcomes

3

−2

−1

0
1
Relative Wave

IW

FE

(a) Out-of-pocket Medical Spending

2

3

IW

(b) Labor Earnings

Notes: Each figure plots F E estimates µ
bl (from (7)) in maroon triangles and IW estimates νbl (from (8))
in blue circles against relative time l, with their respective 95% confidence intervals. Recall that νbl are
constructed as the weighted average of δbe,l ’s. The outcome variable is out-of-pocket medical spending in
Panel A and labor earnings in panel B.

In Table 2, we report the F E estimates µ
bl and the IW estimates νbl , as well as the underlying CAT Te,l
estimates δbe,l . While not reported, we fail to reject the joint hypothesis of parallel trends and no anticipation
based on a Wald test for H0 : µ−2 = µ−1 = 0 or H0 : δ3,−2 = δ3,−1 = δ2,−1 = 0.
The IW estimates νbl are weighted averages of estimates for CAT Te,l , with weights equal to the share of
cohort e across cohorts that experience at least l periods of treatment. Therefore by construction, the IW
estimate falls within the convex hull of the CAT Te,l estimates and has an interpretation as an average effect
of the treatment l periods after initial treatment. In contrast, the F E estimates are not within the convex
hull of the CAT Te,l estimates and thus do not have a causal interpretation.

18

Table 2: Estimates for the Effect of Hospitalization on Outcomes
(a) Out-of-pocket Medical Spending

l wave relative to
index hospitalization
-2

F E estimates
µ
bl
-630
(571)
-1,122
(907)
160
(1255)
-1,396
(1644)
-1,706
(2010)
-1,775
(2394)

-1
0
1
2
3

IW estimates
νbl
-592
(572)
-614
(394)
1,297
(365)
224
(379)
251
(468)
-

Estimates for CAT Te,l
δb1,l
δb2,l
δb3,l
-592
(572)
-605
-613
(509)
(478)
676 1,691
1,619
(506) (533)
(513)
35
445
(404) (536)
251
(468)
-

(b) Labor Earnings

l wave relative to
index hospitalization
-2
-1
0
1
2
3

F E estimates
µ
bl
1,600
(1743)
2,475
(2953)
2,221
(4268)
1,352
(5609)
773
(6965)
2,434
(8396)

IW estimates
νbl
2,165
(1766)
605
(1519)
-527
(1449)
-3,337
(1663)
-5,375
(2229)
-

Estimates for CAT Te,l
δb1,l
δb2,l
δb3,l
2,165
(1766)
1,879
-620
(1888) (1811)
-557
439 -1,429
(1866) (2147) (1981)
-3,518 -3,124
(2015) (2188)
-5,375
(2229)
-

Notes: This table reports three different sets of estimates for the dynamic effects of hospitalization on outof-pocket medical spending (panel A) and labor earnings (panel B). The first column reports estimates from
the F E estimator µ
bl as in (7). Columns 3-5 report the estimates for CAT Te,l from δbe,l as in (8). Column 2
reports the IW estimates which are constructed as the weighted average of δbe,l across cohorts e who have
experienced l periods of treatment. Standard errors (clustered on the individual) are shown in parentheses.

The reason for the dynamic specification to produce wrong-signed and imprecise estimates is that µ̂l ’s
are sensitive to effects from other time periods. Recall by Proposition (2), the probability limit of µ̂l is

µ̂l →p

X

l
ωe,l
CAT Te,l +

X

X

l
ωe,l
0 CAT Te,l0

(9)

l0 6=l −l0 ≤e≤T −l0

1≤e≤T −l

0
and the point estimate µ̂l is the sample analog of (9). For l = 0, we can estimate the weights ωe,l
by

3
l
l
regressing 1 {Ei = e} · Di,t
on the relative time indicators in (7) i.e. Di,t
and two-way fixed effects.
l=−2
0
0
0
The regression coefficient estimator of Di,t
,ω
be,l
, consistently estimates ωe,l
. The point estimate µ̂0 is thus

19

0
the inner product of these estimated weights ω
be,l
and δbe,l . Figure 3 plots these estimated weights. The

weights are large for leads of treatments (negative relative waves), which suggest that the point estimate
µ
b0 is particularly sensitive to estimates of pre-trends, and does not isolate the contemporaneous effect of
hospitalizations.13 While we just showed that there is likely no anticipation and in the limit, µ̂0 is not
affected by pre-trends since all pre-trends CAT Te,l = 0 ∀l < 0, in finite samples, their estimates δbe,l ∀l < 0
are not necessarily zero and can influence µ̂0 if their weights are non-negligible as shown in Figure 3.

−2

−1

Weights
0
1

2

3

0
Figure 3: Weights ω
be,l
on cohort specific effect estimates δbe,l in forming point estimate µ
b0

−4

−3

−2

−1
0
Relative Wave

Weights on 1st cohort CATT
Weights on 3rd cohort CATT

1

2

3

Weights on 2nd cohort CATT
Weights on 4th cohort CATT

Notes: (9) implies that µ
b0 is a weighted average of δbe,l , estimates for CAT Te,l . This figure plots these weights
0
ω
be,l in forming the F E estimate µ
b0 .

6

Conclusions

Linear two-way fixed effects (F E) regressions are commonly used to estimate dynamic treatment effects in
event studies. Their behavior has not been closely studied when treatment effects are non-stationary, i.e.
there is heterogeneity in treatment effects across cohorts. The main goal of this paper is to analyze the
13 To

see this, note the DID estimator δb4,l and δbe,−e are all normalized to zero. While δbe,T −3 are not shown in Table 2 above,
0 from Figure 3 and δ
be,l
they receive small weights in forming µ̂0 . Thus, one can take the inner product of weight estimates ω
be,l
b
b
b
from Table 2 to confirm that the result is similar to µ̂0 . In particularly, δ3,−2 , δ2,−1 and δ2,−1 receive positive weights, and
δb1,1 and δb2,1 receive negative weights, which explains why µ̂0 are likely to have signs closer to the pre-trends estimates and to
the negative of estimates of long-run effects.

20

behavior of F E estimators under heterogeneous treatment effects. We first cast event studies in a potential
outcome framework and show the causal parameters, cohort-specific average treatment effects on the treated
(CAT Te,l ), are identified under parallel trends and no anticipation assumptions. We clarify the notion of
heterogeneity in a dynamic setting: CAT Te,l ’s evolves differently across cohorts, such that at a given lag,
CAT Te,l varies by e.
Building on the potential outcome framework, we derive asymptotic distribution of F E estimators and
show they converge to weighted averages of CAT Te,l ’s. The weights sum to one but need not be positive.
This means when treatment effects are dynamic or heterogenous, the static F E estimate may not correspond
to a causal effect as its estimand may fall outside the convex hull of CAT Te,l ’s. In the dynamic specification,
the situation is even worse: under heterogeneous treatment effects, in addition to non-convex weights, the
F E estimator associated with l periods relative to initial treatment may pick up spurious terms consisting
of treatment effects form periods other than l. Researchers can easily verify the robustness of their F E
estimators by estimating these underlying weights.
Given the negative results on F E estimators, we propose “interaction-weighted” (IW ) estimators for
estimating dynamic treatment effects in event studies. These estimators are formed by first estimating
CAT Te,l ’s with a regression saturated in cohort and relative time indicators, and then average estimates
of CAT Te,l ’s across e at different l’s. These estimators are easy to implement and robust to heterogenous
treatment effects: the IW estimator associated with relative time l is guaranteed to estimate a convex
average of CAT Te,l ’s, with weighting being share of each cohort e.
Finally, we illustrate the empirical relevance of our results by estimating the economic consequence of
hospitalization on the elderly using the Health and Retirement Survey. We compare F E estimates with IW
estimates of the dynamic effects of hospitalization. We find that IW estimates are of the correct sign and
more precise relative to F E estimates. We estimate the weights in forming F E estimates and show they are
non-convex. As an example, the F E estimate of contemporaneous effects is sensitive to pre-trends estimates
and negatively influenced by long-run effects, which makes it causally uninterpretable.

21

References
Abadie, Alberto, “Semiparametric Difference-in-Differences Estimators,” The Review of Economic Studies,
2005, 72 (1), 1–19.
Borusyak, Kirill and Xavier Jaravel, “Revisiting Event Study Designs,” Working Paper, Harvard University May 2017.
Callaway, Brantly and Pedro H. C. Sant’Anna, “Difference-in-Differences With Multiple Time Periods
and an Application on the Minimum Wage and Employment,” March 2018.
Chernozhukov, Victor, Denis Chetverikov, Mert Demirer, Esther Duflo, Christian Hansen,
and Whitney Newey, “Double/Debiased/Neyman Machine Learning of Treatment Effects,” American
Economic Review, May 2017, 107 (5), 261–65.
, Ivan Fernandez-Val, Jinyong Hahn, and Whitney Newey, “Average and Quantile Effects in
Nonseparable Panel Models,” Econometrica, 2013, 81 (2), 535–580.
de Chaisemartin, Clément and Xavier D’Haultfœuille, “Two-way fixed effects estimators with heterogeneous treatment effects,” Working Paper, UCSB April 2018.
Dobkin, Carlos, Amy Finkelstein, Raymond Kluender, and Matthew J. Notowidigdo, “The
Economic Consequences of Hospital Admissions,” American Economic Review, February 2018, 108 (2),
308–52.
Gibbons, Charles E., Juan Carlos Suárez Serrato, and Michael B. Urbancic., “Broken or Fixed
Effects?,” Journal of Econometric Methods, 2018, forthcoming.
Heckman, James, Hidehiko Ichimura, and Petra E. Todd, “Matching As An Econometric Evaluation
Estimator: Evidence from Evaluating a Job Training Programme,” Review of Economic Studies, 1997, 64
(4), 605–654.
Hernán, Miguel A, Babette Brumback, and James M Robins, “Marginal Structural Models to
Estimate the Joint Causal Effect of Nonrandomized Treatments,” Journal of the American Statistical
Association, 2001, 96 (454), 440–448.
Hull, Peter, “Estimating Treatment Effects in Mover Designs,” Working Paper, Microsoft Research October
2017.

22

Kim, In Song and Kosuke Imai, “When Should We Use Fixed Effects Regression Models for Causal
Inference with Longitudinal Data?,” Working Paper, Princeton University 2017.
Malani, Anup and Julian Reif, “Interpreting pre-trends as anticipation: Impact on estimated treatment
effects from tort reform,” Journal of Public Economics, 2015, 124, 1 – 17.

23

A

Proofs

Proof of Proposition 1
Proof. Partialling out the unit and time fixed effects, Regression (2) is

Ÿi,t = γ D̈i,t + i,t

where Ẍi,t is time- and cross-sectional demeaned version of Xi,t i.e. Ẍi,t = Xi,t − X̄·,t − X̄i,· + X̄, and
PT
PT
1
1
X̄·,t = E [Xi,t ], X̄i,· = T +1
t=0 Xi,t , X̄ = T +1
t=0 E [Xi,t ]. It is easy to see that for Ẍi,t and Z̈i,t ,
h
i
h
i
h
i
demeaned versions of Xi,t and Zi,t respectively, we have E Ẍi,t Z̈i,t = E Xi,t Z̈i,t = E Ẍi,t Zi,t . The
projection coefficient on Di,t from (2), i.e. the probability of the coefficient estimator γ
b, is then
h
i
h
i
h h
ii
PT
PT
Ÿ
D̈
E
E
Y
D̈
E
E
(Y
−
Y
)
D̈
|
E
i,t
i,t
i,t
i,t
i,t
i,0
i,t
i
t=0
t=0
t=0
h
i=P
h
i=
h
i
γ=
PT
PT
T
1
E
D̈
D̈
E
D
D̈
E
D
D̈
i,t i,t
i,t i,t
i,t i,t
t=0
t=0
t=0
T +1
1
T +1

PT

(10)

Note that D̈i,t is a function of Ei . Conditioning on Ei = e, D̈i,t = Di,t − D̄·,t − D̄u,· + D̄ is non-random:
when t ≥ e,Di,t = 1 and when t < e, Di,t = 0 ; D̄·,t = P r {Di,t = 1} = P r {Ei ≤ t} is the share of treated
units at time t; D̄e,· =

T −e
T +1

is the share of treated periods; and D̄ =

T −E[Ei ]
T +1

is fixed for all i. We thus have

h
h
ii
Ei
Ei
E
D̈
E
Y
−
Y
|
E
i,t
i
i,t
i,0
t=0
h
i
PT
E
D
D̈
i,t
i,t
t=0

PT
γ=

=P

T
t=0

+

X

1
h
i
E Di,t D̈i,t

T
X
X
t=0

e
∞
=E [Yi,t
−Yi,0
|Ei =e]
}|
{
z  e
e
P r {Ei = e} 1 − D̄·,t − D̄e,· + D̄ E Yi,t − Yi,0 | Ei = e, Di,t = 1

(11)

e≤t

∞
∞
=E [Yi,t
−Yi,0
]
}|
{
z  e
e
P r {Ei = e} 0 − D̄·,t − D̄e,· + D̄ E Yi,t − Yi,0 | Ei = e, Di,t = 0

(12)

e>t

The equality inside the braces of (11) follows from no anticipation (Assumption 2). The equality inside the
braces of (12) follows from parallel trends and no anticipation (Assumption 1 and 2).
Furthermore, we have
X

 X

P r {Ei = e} 1 − D̄·,t − D̄e,· + D̄ +
P r {Ei = e} 0 − D̄·,t − D̄e,· + D̄
e>t

e≤t

= P r {Di,t = 1} − D̄·,t −

X

D̄e,· + D̄ = D̄·,t − D̄·,t − D̄ + D̄ = 0

e

24

 ∞

∞
With this, we can distribute E Yi,t
− Yi,0
across the treated units and obtain the following expression:
T

XX

 e

 ∞

1
∞
∞
h
i
P r {Ei = e} 1 − D̄·,t − D̄e,· + D̄ E Yi,t
− Yi,0
| Ei = e − E Yi,t
− Yi,0
PT
e≤t
t=0 E Di,t D̈i,t t=0

(13)
T T
−e
X
X
 e

P r {Ei = e} 1 − D̄·,e+l − D̄e,· + D̄
∞
h
i
E Yi,t
− Yi,t
|Ei = e
PT
e=1 l=0
t=0 E Di,t D̈i,t
|
{z
}



=

=:ωe,l

To see that the weights sum up to one, note that the denominator of the weights can be written as
T
X

T X
h
i X

E Di,t D̈i,t =
P r {Ei = e} 1 − D̄·,t − D̄e,· + D̄

t=0

t=0 e≤t

=

T T
−e
X
X

P r {Ei = e} 1 − D̄·,e+l − D̄e,· + D̄



e=1 l=0

Proof of Proposition 2
Proof. Following a similar argument in the proof for Proposition 1, the projection coefficients µl ’s from
regression (3) are:
(µl )−T ≤l≤T −1 =

T
X

E

h

D̈i,t D|i,t

t=0


where D̈i,t



=



−T
D̈i,t
..
.

!
i −1

T
X

h

E D̈i,t Yi,t

i

!

t=0




 and again, Ẍi,t is time- and cross-sectional demeaned version of Xi,t .14



T −1
D̈i,t
To further develop the expression for the projection coefficients µl ’s, we note that

PT −1
l
14 Note that
l
Another multicollinearity is
l=−T D̈i,t = 0 and we need to drop one D̈i,t due to multicollinearity.
PT −1
0 ) D̈ l
0 the excluded relative time indicator variable. For simplicity, suppose that the excluded D̈ l
(l
−
l
=
0
for
l
i,t
i,t
l=−T
are two lead indicators i.e. l < 0.

25

T
X

T
T
h
i X
h
i X
h
i
E D̈i,t Yi,t =
E D̈i,t (Yi,t − Yi,0 ) =
E D̈i,t E [Yi,t − Yi,0 |Ei ]

t=0

t=0

T
X

h

T
X

h

t=0

T
i X
h
i 

∞
=
E D̈i,t E [Yi,t − Yi,0 |Ei ] −
E D̈i,t E Yi,t
− Yi,0
{z
}
t=0
t=0 |
=0

=

E D̈i,t

 ∞
i
E [Yi,t − Yi,0 |Ei ] − E Yi,t
− Yi,0

t=0

 ∞

 ∞

Under the parallel trends and no anticipation assumptions, we have E Yi,t
− Yi,0 |Ei = E Yi,t
− Yi,0 .
Thus the expression for projection coefficients µl ’s now simplifies to

T
X

h
i
E D̈i,t D|i,t

!−1

t=0

T
X

h


i
∞
|Ei
E D̈i,t E Yi,t − Yi,t

!

t=0

Furthermore, we can write


−T
Di,t
..
.






 

∞
0
E Yi,t − Yi,t |Ei =  Di,t


..

.


T −1
Di,t

−T
 Di,t

..

.



0
=  Di,t


..

.


T −1
Di,t
{z
|
Di,t

| 


























| 

























}|



∞
|Ei
E Yi,Ei −T − Yi,E
i −T
..
.


∞
E Yi,Ei − Yi,E
|Ei
i
..
.


∞
E Yi,Ei +T −1 − Yi,E
|Ei
i +T −1

0


..

.



CAT TEi ,0 


..

.


CAT TEi ,T −1
{z
}















f (Ei )





∞
∞
We can set E Yi,Ei −T − Yi,E
|Ei through E Yi,Ei −1 − Yi,E
|Ei to zero by the no anticipation asi −T
i −1
h
i
∞
sumption. For index that is out of range e.g. e + l < 0 or e + l > T , even though E Yi,e+l − Yi,e+l
|Ei = e
l
is undefined, the above expression is well-defined because the corresponding Di,t
= 0 for all t. Using this

26

expression, the expression for projection coefficients µl ’s simplifies to
T
X

E

h

D̈i,t D|i,t

i

!−1

T
X

t=0

E

h

D̈i,t D|i,t f

i
(Ei )

!

t=0

While Di,t D|i,t is a diagonal matrix with diagonal entries equal to one for t = Ei + l and zero otherwise,
D̈i,t D|i,t is not a diagonal matrix. This means that treatment effects at lags not equal to l might affect the
l
l
is a weighted average of CAT Te,l for
. This proves that the projection coefficient on Di,t
coefficient on Di,t

1 ≤ e ≤ T and all l0 6= l.
Specifically, we can write µl as an affine average
X

l
ωe,l
CAT Te,l +

P

−l0 ≤e≤T −l0

X

l
ωe,l
0 CAT Te,l0 ,

l0 6=l 1≤e≤T −l0

1≤e≤T −l

where

X

l
ωe,l
= 1 and for each l0 6= l,

P

−l0 ≤e≤T −l0

l
ωu,l
0 = 0. To see that

P

−l≤e≤T −l

l
ωe,l
= 1,

note that the sum of weights for CAT Te,l across 1 ≤ e ≤ T − l in µl is
T
X

h

E D̈i,t D|i,t

i

!−1 
X



h
i
l
 e|
E D̈i,t Di,e+l
l

1≤e≤T −l

t=0


! 
T
h
h
i
i −1
X
X
l

 e|
=
E D̈i,t D|i,t
E D̈i,t Di,t
l
t=0

0≤t≤T

l
where el is a column vector with 1 in the entry corresponding to the entry of Di,t
in Di,t , and 0 otherwise.
l
l
That is, the above expression is the projection coefficient on Di,t
from regressing Di,t
on Di,t and the unit

and time fixed effects, which is just one. Similarly, for each l0 6= l, the sum of weights for CAT Te,l0 across
0

l
l
1 ≤ e ≤ T − l0 in µl is projection coefficient on Di,t
from regressing Di,t
on Di,t and the unit and time fixed

effects, which is zero.

B

Simulation design

We generate 1000 simulated datasets with N = 1000 and T = 3 according to the following DGP

Yi,t = i + t +

3 T
−e
X
X

l
δe,l 1{Ei = e} · Di,t
+ i,t

e=1 l=1−e

For each simulation, we draw Ei uniformly from {1, 2, 3}. We analyze the case where the DGP is a model of
dynamic and non-stationary treatment effects. In particular, we set δ1,0 = 2, δ1,1 = 18, δ1,2 = 19, δ2,0 = 3,

27

δ2,1 = 4, δ3,0 = 4, δe,l<0 = 0 ∀e and i,t ∼ N (0, 1). For each simulation, we estimate

Yi,t = αi + λt +

2
X

l
µl Di,t
+ i,t

l=−1

While δu,−1 = 0 ∀u and hence CAT Te,−1 = 0 for all e, the estimates µ̂−1 ’s are usually negative as shown in
Figure 1, which would suggest a negative pre-trend.

C

Including covariates and doubly robust scores for event studies

When there are covariate-specific time trends, we need to modify the unconditional parallel trends assumption
to the following one. Denote the confounding covariates by Xi,t .
 ∞

∞
Assumption 5. Conditional parallel trends in baseline outcome. E Yi,t
− Yi,s
|Ei = e, Xi,t is the same
 ∞

∞
for all e, i.e., equal to E Yi,t
− Yi,s
|Xi,t .
We maintain the no anticipation assumption, but again allow the treatment effects to be dynamic for all
cohorts and heterogenous i.e. non-stationary.
The causal parameter of interest is still

θ0 := CAT Te,l
 ∞

∞
Suppose we know the covariate-specific time trends g0∞ (Xi,t ) := E Yi,t
− Yi,0
| Xi,t . Then we can form
a consistent estimator for θ0 by EN [Yi,t − Yi,0 − g ∞ (Xi,t ) | Ei = t − l]. This estimator is an extension to
Heckman et al. (1997).
Suppose we know the probability of being in cohort e = t − l conditional on Xi,t , denoted by m0 (Xi,t ) :=
P r {Ei = t − l|Xi,t }, and the probability of not having received treatment by time t conditional on Xi,t ,
denoted by n0 (Xi,t ) := P r {Ei > t|Xi,t }, as well as the share of cohort e, m0 := P r {Ei = t − l} . Then we
can form a consistent estimator for θ0 by

EN


1 {Ei > t} m0 (Xi,t )
1 {Ei = t − l}
(Yi,t − Yi,0 ) −
(Yi,t − Yi,0 )
m0
m0 · n0 (Xi,t )

This inverse propensity score reweighted estimator is an extension to Abadie (2005). A similar version has
been proposed by Callaway and Sant’Anna (2018).

28

Collect
 ∞

|
∞
η0 (Xi,t ) := E Yi,t
− Yi,0
| Xi,t , P r {Ei = t − l|Xi,t } , P r {Ei > t|Xi,t } , P r {Ei = t − l}
|

Let η (Xi,t ) := (g ∞ (Xi,t ) , m (Xi,t ) , n (Xi,t ) , m) denote the nuisance parameter with true value η0 (Xi,t ).
In practice, it is likely that we make mistakes in estimating η (Xi,t ). We may employ the following doubly
robust score as an extension to the doubly robust score derived for cross-sectional models. Define

ψ (Wi , θ, η) :=

1 {Ei > t} m (Xi,t )
1 {Ei = t − l}
1 {Ei = t − l}
(Yi,t − Yi,0 − g ∞ (Xi,t ))−
(Yi,t − Yi,0 − g ∞ (Xi,t ))−θ
m
m · n (Xi,t )
m

where Wi := (Yi,t , Yi,0 , Xi,t ).
We can show that the score satisfies the identification condition E [ψ (Wi , θ0 , η0 )] = 0 and the Neyman
orthogonality condition ∂η E [ψ (Wi , θ0 , η)]

= 0 . This score is robust to small mistakes in η (Xi,t ). The
η=η0

estimation can be done by K-fold cross-fitting as described in Chernozhukov et al. (2017).
For Xi,t = 1, we are back to the unconditional parallel trends assumption. The DID estimator with s = 0
and C = {c : t < c} is the root θ of the above doubly robust score in the sample, EN [ψ (Wi , θ, ηb)] = 0, where
ηb is the sample analog of η0 .

29

