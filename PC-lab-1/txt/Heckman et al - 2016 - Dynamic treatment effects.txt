Journal of Econometrics 191 (2016) 276–292

Contents lists available at ScienceDirect

Journal of Econometrics
journal homepage: www.elsevier.com/locate/jeconom

Dynamic treatment effects✩
James J. Heckman a,b,∗ , John Eric Humphries a,1 , Gregory Veramendi c,2
a

Department of Economics, University of Chicago, 1126 East 59th Street, Chicago, IL 60637, United States

b

The American Bar Foundation, 750 North Lake Shore Drive, Chicago, IL, 60611-4403, United States

c

Arizona State University, 501 East Orange Street, CPCOM 412A, Tempe, AZ, 85287-9801, United States

article

info

Article history:
Available online 29 December 2015
JEL classification:
C32
C38
D03
I12
I14
I21
Keywords:
Choice theory
Dynamic treatment effects
Factor models
Marginal treatment effects
Regret
Conditional independence
Matching on mismeasured variables
Instrumental variables
Ordered choice models
Unordered choice models

abstract
This paper develops robust models for estimating and interpreting treatment effects arising from both
ordered and unordered multi-stage decision problems. Identification is secured through instrumental
variables and/or conditional independence (matching) assumptions. We decompose treatment effects
into direct effects and continuation values associated with moving to the next stage of a decision problem.
Using our framework, we decompose the IV estimator, showing that IV generally does not estimate
economically interpretable or policy-relevant parameters in prototypical dynamic discrete choice models,
unless policy variables are instruments. Continuation values are an empirically important component of
estimated total treatment effects of education. We use our analysis to estimate the components of what
LATE estimates in a dynamic discrete choice model.
© 2015 Elsevier B.V. All rights reserved.

1. Introduction
This paper develops a robust empirical framework for estimating treatment effects arising from multi-stage decision models and
interpreting them using economic theory. The bulk of the empirical
treatment effect literature estimates models for binary choices. Al-

✩ We thank the editor, Esfandiar Massoumi, and two anonymous reviewers
for helpful comments. This research was supported in part by the American Bar
Foundation, the Pritzker Children’s Initiative, NIH grants NICHD R37HD065072,
NICHD R01HD54702, and NIA R24AG048081. The views expressed in this paper are
those of the authors and not necessarily those of the funders or persons named here
or the official views of the National Institutes of Health. The Web Appendix for this
paper is https://heckman.uchicago.edu/dyn-treat-effects.
∗ Corresponding author at: Department of Economics, University of Chicago,
1126 East 59th Street, Chicago, IL 60637, United States. Tel.: +1 773 702 0634; fax:
+1 773 702 8490.
E-mail addresses: jjh@uchicago.edu (J.J. Heckman), johneric@uchicago.edu
(J.E. Humphries), gregory.veramendi@asu.edu (G. Veramendi).
1 Tel.: +1 773 980 6575.

2 Tel.: +1 480 965 0894.
http://dx.doi.org/10.1016/j.jeconom.2015.12.001
0304-4076/© 2015 Elsevier B.V. All rights reserved.

though there is research on treatment effects for multiple choices,3
little analysis has been done for models of dynamic treatment effects.4 Yet, much of economics is about dynamic choices and their
consequences.
Fig. 1 presents a schematic for one simple multi-stage choice
model we analyze. It is in the form of the ordered choice model
that is implicit in the multi-stage analysis of Angrist and Imbens
(1995).5 The stages could correspond to a sequence of educational
choices. All agents start at stage ‘‘0’’. Some transit to ‘‘1’’, while
others stay at ‘‘0’’ forever, and some of those who go to ‘‘1’’

3 See Heckman and Vytlacil (2007b) and Heckman and Pinto (2015a).
4 See, however, Murphy (2003) and Heckman and Navarro (2007). This paper
builds on the analysis reported in the latter reference. Angrist and Imbens (1995)
develop a statistical model for multiple treatment effects that can be applied to a
dynamic choice setting. Their paper identifies a LATE for an ordered choice model.
(See Vytlacil, 2006a,b.) We identify a more general range of parameters for both
ordered and unordered models.
5 See Vytlacil (2006a,b) who establishes the equivalence between the two
representations.

J.J. Heckman et al. / Journal of Econometrics 191 (2016) 276–292

Fig. 1. An ordered multi-stage dynamic decision model.

stop there while others go on, etc. At each stage, agents update
their information sets and decide whether or not to transit to the
next stage. Associated with each final stage is a set of potential
outcomes. After we analyze this simple ordered model, we analyze
a more general unordered model.
A large econometric literature analyzes dynamic discrete
choice.6 These models tightly parameterize agent decision rules
using the Bellman equation and generally rely on strong functional form assumptions and computationally intensive methods
to secure their estimates.7 The complexity of the computational
methods employed often makes replication and sensitivity analyses with these models difficult. In many applications, the sources of
identification are not clear.8 Rust (1994) shows that an important
class of these models is nonparametrically non-identified.9 Blevins
(2014) shows how adding continuous state variables aids in securing nonparametric identification.
This paper steps back from the structural literature and presents
a computationally tractable yet economically interpretable framework that enables analysts to identify their models, conduct
sensitivity analyses, and test some of the key assumptions maintained in the dynamic discrete choice literature. At the same time,
it extends the treatment effect literature by considering dynamic
treatment regimes, and by introducing choice-theoretic underpinnings.
This paper builds on and extends the literature on the Marginal
Treatment Effect (MTE) that unifies the treatment effect literature with economics without imposing strong functional form assumptions or assumptions about specific decision rules adopted by
agents.10 Empirical applications of the MTE focus on binary choices.
Extensions of IV to ordered choice models and more general unordered multi-state choice models demonstrate the need to incorporate explicit choice theory into analyses in order to identify a
range of economically interpretable treatment effects beyond LATE
parameters.11 Previous analyses based on MTE and LATE rely exclusively on instrumental variables to identify parameters.
This paper extends the literature by using conditional independence assumptions as well as instrumental variable assumptions
as possible sources of identification. Conditional independence assumptions are used extensively in the dynamic discrete choice literature (see, e.g., Rust, 1994 and Blevins, 2014) and the matching

6 See e.g. Rust (1994), Keane and Wolpin (1997), Cameron and Heckman
(1998), Heckman and Navarro (2007), Cunha et al. (2007), Aguirregabiria (2010),
and Blevins (2014).
7 See Adda and Cooper (2003) and Keane et al. (2011).
8 However, Taber (2000) and Blevins (2014) present nonparametric identification
analyses under separability and conditional independence assumptions.
9 Magnac and Thesmar (2002) clarify and extend his analysis.
10 See Heckman and Vytlacil (1999, 2005, 2007a,b), Carneiro et al. (2010), and
Eisenhauer et al. (2015b).
11 Heckman et al. (2006, 2008) and Heckman and Pinto (2015a).

277

literature (see, e.g., Rosenbaum and Rubin, 1983). They are especially well motivated if analysts have rich data on the determinants of choices. We extend the matching literature by considering
models with mismeasured match variables on which analysts have
multiple measurements.
This paper also builds on previous analyses of dynamic
treatment effects presented in Cunha et al. (2007) and Heckman
and Navarro (2007). We implement and extend the ordered choice
model of Cunha et al. (2007) to allow for general stage-specific
cost and preference shocks associated with learning as well as
dynamically inconsistent preferences (see, e.g., Laibson, 2003)
and for an unordered choice model. Using our model we can
test for the empirical relevance of ex-post regret. We extend
the work of Heckman and Navarro (2007) by building a more
explicit economic framework of dynamic treatment effects which
decomposes them into direct effects and continuation values for
both ordered and unordered models. Additionally, we link their
work to the matching literature, and draw on recent advances in
identifying factor models.
Our analysis links treatment effect models to state space models
where analysts can proxy unobservables. The proxies can be the
true values of variables measured with error as in factor models
(see Schennach, 2013).
This paper proceeds in the following way. Section 2 presents
models for ordered and unordered choice, and distinguishes the
approach pursued in this paper from that pursued in the previous
literature. Section 3 defines dynamic treatment effects and their
decomposition into direct effects and continuation values as well
as a variety of other economically interpretable treatment parameters. Section 4 discusses some identification criteria for these models. Section 5 uses these models to interpret what instrumental
variables estimate. Section 6 presents empirical estimates of the
causal effects of schooling on earnings, decomposing them into direct and continuation value components. It tests and rejects some
key maintained assumptions in dynamic discrete choice theory,
and compares estimates of economically interpretable parameters
with LATE. We use our analysis to estimate what LATE can and cannot estimate in dynamic discrete choice models. When possible,
we resolve LATE into economically interpretable components. Section 7 concludes.
2. Models for ordered and unordered dynamic discrete choice
and associated outcomes
This paper develops a multi-stage ordered sequential choice
model with transitions at the nodes shown in Fig. 1. For specificity,
it is useful to think of the nodes as corresponding to specific
schooling levels through which individuals can transit or at which
they can stop. An unordered model is analyzed after we analyze
the ordered model depicted in Fig. 1. Let J denote an ordered set of
possible terminal states. At each node there are only two possible
choices: remain at j or transit to j + 1. Dj = 0 if a person at j does
not stop there and goes on to j + 1. Dj = 1 if the person stops at j.
Dj ∈ D, the set of possible transition decisions that can be taken by
the individual over the decision horizon. Let S = {0, . . . , s} denote
the finite and bounded set of stopping states with S = s if the
agent stops at s ∈ S , so Ds = 1. Define s as the highest attainable
element in S . We assume that the environment is time-stationary
and decisions are irreversible.12
Qj = 1 indicates that an agent gets to decision node j. Qj = 0
if the person never gets there. The history of nodes visited by an
agent can be described by the collection of the Qj such that Qj = 1.

12 This model is also analyzed in Cunha et al. (2007) and in Heckman and Navarro
(2007).

278

J.J. Heckman et al. / Journal of Econometrics 191 (2016) 276–292

Observe that Ds = 1 and Ds−1 = 0 are equivalent to S = s and
Ds = 1, respectively, if Dj = 0, ∀ j < s.13
2.1. A sequential decision model
The decision process at each node is assumed to be characterized by an index threshold-crossing property:
0 if Ij ≥ 0,
1 otherwise,


Dj =

j ∈ J = {0, . . . , s − 1}



Unobserved
by analyst

for Qj = 1, j ∈ {0, . . . , s − 1}

(1)

where Ij is the perceived value at node j of going on to j + 1 for
a person at node j, where J = S \ {s} is the set of possible
transition nodes. To ensure consistent notation, we define Q0 :=
1. The requirement Qj = 1 ensures that agents are able to
make the transition from j to j + 1. Unlike the literature on
discrete dynamic choice, we do not take a position on the precise
content of the information sets and preferences governing agent
choices at different nodes or the exact decision rules used. In
principle, agents could make irrational choices and their choices
could be governed by behavioral anomalies. Agents face stagespecific cost and/or preference shocks that they may or may not
anticipate before they reach the stage. Thus, this model does
not rule out dynamic inconsistency as featured in behavioral
economics (Laibson, 2003), or in adolescent psychology (Steinberg,
2014) where agent preferences evolve, and ex-post, agents regret
irreversible decisions made at previous stages.
Associated with each final state s ∈ S = {0, . . . , s} is a set of Ks
potential outcomes for each agent with indices k ∈ Ks . Define Ỹsk
as latent variables that map into potential outcomes Ysk :
Ysk =



Ỹsk
1(Ỹsk ≥ 0)

if Ysk is continuous,
if Ysk is a binary outcome,



k ∈ Ks , s ∈ S .
(2)

Using the switching regression framework of 
Quandt (1958, 1972),
the observed outcome Y k for a k common to s∈S Ks is
Yk =



Ds Ysk ,

k ∈ Ks .

(3)

s∈S

2.2. Parameterizations of the decision rules and potential outcomes
for final states
Following a well-established tradition in the discrete choice
literature, we represent Ij using a separable model:
Unobserved
by analyst

  
Ij = φj (Z ) + θ ′ αj − νj ,
   
Observed
by analyst

j ∈ {0, . . . , s − 1}

literature.14 A separable representation of choice equations also
underlies the LATE literature (Vytlacil, 2002, 2006a,b).
With this representation we can test implications of more
tightly specified versions of dynamic discrete choice models.
Endowments θ are not directly observed by the econometrician
but are proxied by a measurement system discussed below. Array
the νj , j ∈ J , into a vector ν = (ν0 , ν1 , . . . , νs−1 ) and the ηj into
η = (η0 , . . . , ηs−1 ).
Outcomes are also represented by a separable model:

(4)

−ηj

where φj (Z ) is a function of a vector of variables, Z , observed by the
analyst, components of which determine the transition decisions
of the agent at different stages and θ is a finite dimensional
vector of unobserved (by the economist) endowments. νj is
an idiosyncratic transition-specific innovation. It is notationally
useful to consolidate the unobservables into scalar ηj := −[θ ′ αj −
νj ]. Separability is a cornerstone of the dynamic discrete choice

13 For notational convenience, we assign D = 0 for all j > s. Using alternative
j
notation, we assign Dj = 0 when Qj = 0.

  
Ỹsk = τsk (X ) + θ ′ αks + ωsk ,
   
Observed
by analyst

k ∈ Ks , s ∈ S ,

(5)

Usk

where τsk (X ) is a function of a vector of observed determinants of
outcomes and θ is the vector of unobserved endowments. The Z can
include all variables in X . When instrumental variable methods are
used to identify components of the model, it is assumed that there
are some variables in Z not in X .
ωsk represents an idiosyncratic error term for the kth outcome in
state s. Array the ωsk into a vector ωs = (ωs1 , . . . , ωsKs ). Notationally,
it is useful to consolidate the unobservables of (5) into a term
Usk = θ ′ αks + ωsk . Array the Usk into vector Us = (Us1 , . . . , UsKs ) and
array the Us into U = (U0 , . . . , Us̄ ).
θ is assumed to capture all sources of dependence across
transitions apart from X and Z . It plays an important role in our
analysis and links the structural model to the matching literature.
Along with the observed variables, it generates the dependence
between choices and outcomes.
Letting ‘‘y’’ denote statistical independence, we assume that
conditional on X

νj y νl ∀l ̸= j l, j ∈ {0, . . . , s − 1}

(A-1a)

ω yω

(A-1b)

k
s

k
s′

∀s ̸= s

′

∀k and s, s ∈ S
′

ω s y ν ∀s ∈ S
θyZ
(ωs , ν) y (θ, Z ) ∀s ∈ S .

(A-1c)
(A-1d)
(A-1e)

Assumption (A-1a) maintains independence of the shocks
affecting transitions; (A-1b) independence of shocks across all
states; (A-1c) independence of the shocks to transitions and
the outcomes; (A-1d) independence of θ with respect to the
observables; and (A-1e) independence of the shocks with the
factors and the observed variables. Versions of assumptions
(A-1d) and (A-1e) play fundamental roles in the structural dynamic
discrete choice literature. For example, the widely-used ‘‘types’’
assumption of Keane and Wolpin (1997) postulates conditional
independence between choices and outcomes conditional on types
(θ) that operate through the initial conditions of their model.
2.3. A measurement system for unobserved factors θ
A substantial body of the literature estimating causal effects
develops strategies for eliminating the effect of θ in producing
spurious relationships between the final states selected and
outcomes.15 A principal approach to identification adopted in this
paper is to model θ and its relationship to the choice equations

14 See, e.g., Heckman (1981), Cameron and Heckman (unpublished working paper,
2001), Eckstein and Wolpin (1989), Geweke and Keane (2001), Heckman and
Navarro (2007), Arcidiacono and Ellickson (2011), and Blevins (2014).
15 See, e.g., Heckman (2008) for a review of alternative approaches in the
literature.

J.J. Heckman et al. / Journal of Econometrics 191 (2016) 276–292

and associated outcomes. We adjoin a measurement system to the
system of choice and outcome equations, as in state space models.
We proxy θ to identify the interpretable sources of omitted variable
bias and to determine how unobservables mediate causal effects.
This enables us to apply our analysis to an emerging literature in
economics and personality psychology that investigates the role
of cognitive and non-cognitive skills in shaping choices and final
outcomes.16
If θ were observed, one could condition on (θ, X , Z ) and identify
selection-bias-free estimates of a variety of causal effects. This is
equivalent to matching on θ, X , and Z .17 Both matching and the
dynamic discrete choice literature assume that conditional on θ, X ,
and Z , outcomes and choices are statistically independent.
The structural literature treats the θ as nuisance variables,
invokes conditional independence assumptions, and integrates out
the unobservables using random effect procedures (see, e.g., Keane
and Wolpin, 1997, Rust, 1994, Adda and Cooper, 2003, and Blevins,
2014). In this paper we proxy θ with multiple measurements and
correct for the effects of measurement error on the proxy.
Let M be a vector of NM measurements of θ . They may consist
of lagged or future values of the outcome variables or additional
measurements.18 The system of equations determining M is:
M = Φ (X , θ, e),

(6)

where X are observed variables, θ are the endowments, and


Φ1 (X , θ, e1 )
 .  

..
M =  ..  = 

.
MNM
ΦNM (X , θ, eNM )


M1





where we array the ej into e = (e1 , . . . , eNM ). We assume, in
addition to the previous assumptions, that conditional on X
ej y el ,

j ̸= l, j, l ∈ {1, . . . , NM }

and e y (Z , θ, ν, ω).

(A-1f)
(A-1g)

We assume that (e, ν, ω), conditional on X , is a vector of absolutely
continuous variables. Let (e, ν, ω) and (e, ν, ω) be the vector of
upper and lower limits of (e, ν, ω), respectively.
2.4. An unordered dynamic discrete choice model
The ordered model just analyzed is traditional in the literature
on the economic returns to schooling that assumes that some
measure of years of schooling captures exposure to education.19
Yet there are many forms of education that cannot be directly
summarized by a years-of-schooling equivalent.20 Examples are
GED certificates,21 post-school training programs, vocational
degrees, and the like. There is no natural order on these measures
of educational attainment.

16 The recent literature establishes that both cognitive and non-cognitive skills
can be shaped by interventions and are effective avenues for social policy. See,
e.g., Borghans et al. (2008), Almlund et al. (2011), Heckman et al. (2014a), Heckman
et al. (2013), and Heckman and Kautz (2014). See Heckman et al. (2014b) for such
an application.
17 Matching is a version of selection on observables. See Carneiro et al. (2003)
and Abbring and Heckman (2007). See also Heckman and Vytlacil (2007a,b)
and Heckman et al. (2011).
18 See, e.g., Abbring and Heckman (2007) and Schennach et al. (2012).
19 The Mincer model (1974) is the leading example.
20 However, equivalents might be formed using some outcome metrics such as
earnings or occupation. These would give tautological explanations of outcomes.
21 The GED is an exam whose proponents claim that successful examinees are
the equivalents of high school graduates. For strong evidence to the contrary,
see Heckman et al. (2014a).

279

Fig. 2. Unordered dynamic model.

To focus on a simple case that describes the data analyzed in
this paper, we analyze a model with the GED. Adding it to Fig. 1
produces a new path from the node ‘‘drops out of high school’’
described in Fig. 2. Interpreting node ‘‘0’’ as being in high school
but not graduating, the path ‘‘remain at 0’’ corresponds to being
a dropout from high school. However, the GED creates a new path
from the dropout state: get a GED. We assume that GED attainment
is a terminal state. In truth, many GEDs attempt college although
few graduate.22 In the samples we analyze there are too few GEDs
going on to college to estimate a stable model for that transition.
Research shows that there is no natural years of schooling to
assign to GEDs.23 Fig. 2 adds a branch to the lower portion of Fig. 1.
The upper portion is as before except we now give specificity to
the nodes and transitions. The decision tree depicted in Fig. 2 is
more typical of discrete dynamic decision processes estimated in
the literature.24
To conserve on notation, for agents for whom D0 = 0, we define
the set of attainable nodes as before. However, we now change
slightly the interpretation of D0 = 1. Dropping out opens a new
branch of the decision tree. For D0 = 1, we define the attainable
set as {0, G}. Thus, a person may remain a dropout or may exam
certify. QG = 1 if the agent drops out of high school and confronts
the GED option. Thus, in the upper branch, (D0 = 0) and the Dj for
j ≥ 1 are the same as before. In the lower branch (D0 = 1), agents
can terminate as a dropout (D0 = 1, DG = 1) with outcome Y0 or
as a dropout who exam certifies (D0 = 1, DG = 0) with outcome
YG .
As before, outcomes at each terminal node may be discrete or
continuous (see Eq. (2)). The terminal state space S is amended
to include G, i.e., S = {G, 0, . . . , s}. For the kth outcome, the
k
Quandt switching
 regression representation for observed Y for a
k common to s∈S Ks is






k

Y =

Ds Ysk



(1 − D0 ) + Y0k DG + YGk (1 − DG ) D0 .

(7)

S \{0,G}

The decision model is now characterized by two branches. The
origin node (drop out of school) is characterized as before:


D0 =

0
1

if I0 ≥ 0
otherwise.

22 Heckman et al. (2014a).
23 Heckman et al. (2014a).
24 See, e.g., Rust (1994).

280

J.J. Heckman et al. / Journal of Econometrics 191 (2016) 276–292

For the upper path, given D0 = 0,



0
1

Dj =

if Ij ≥ 0, j = 1, . . . , s − 1
otherwise.



For Qj = 1, j ∈ {1, . . . , s − 1}.
For the lower path, given D0 = 1,


DG =

0
1



if IG ≥ 0
otherwise

for QG = 1.

The parameterization of the index functions is as before with an
obvious change of notation.
3. Dynamic treatment effects
The treatment effects defined in this paper take into account
the direct effect of transiting to the next node in a decision
tree, plus the benefits associated with the options opened up by
the additional choices made possible by such transitions. Under
autonomy, different treatment effects can be identified by fixing
treatment assignment variables for different sub-populations.
Dynamic discrete choice models greatly facilitate the interpretation of intertemporal choices and their consequences. As an
example, consider a dynamic human capital model analyzed by
Keane and Wolpin (1997). Assume risk-neutral agents who have
a finite choice set with N alternatives over a finite decision horizon (a, a). Let Bn (a) = 1 if alternative n is chosen at age a and zero
otherwise. Let Rn (a) be the current flow reward at age a from alternative n.25 The current reward per period at any age a is
R(a) =

N

n=1

R n ( a)

B n ( a)

  

  

per
period
reward
from
choice n

.

indicator
of choice n at a

Denote an individual’s state at age a by H (a). Assume a discount
factor δ . The value function is


V (H (a), a) =

max

Bn (t )∈B(a)

E

a

t =a

δ

t −a

N



Rn (t )Bn (t ) | H (a)

n=1

where B(a) is the set of feasible current and future choices at age a.
The alternative-specific functions, Vn (H (a), a), can be written as

impose specific functional forms, decision models, or assumptions
about distributions of unobservables.
In the rest of this section, we analyze treatment effects
associated with the ordered model of Fig. 1 and note the
modifications required, if any, for the more general unordered
model of Fig. 2. While it is possible to define a variety of treatment
effects consistent with the model, many would be empirically
implausible.
Many empirical economists would not find estimates of the
effect of fixing Dj = 0 if Qj = 0 credible (i.e., the person for whom
we fix Dj = 0 is not at the decision node to take the transition).28
In this spirit, we define treatment effects associated with fixing
Dj = 0 conditioning on Qj = 1. (For the lower branch of the
unordered model we require QG = 1 in analyzing the effect of
fixing DG .)
The person-specific treatment effect Tjk for outcome

k ∈ s∈S Ks for an individual selected from the population Qj = 1
with characteristics X = x, Z = z , θ = θ , making a decision at
node j between going on to j + 1 or stopping at j is the difference for
the individual between the individual’s outcomes under the two
actions:
Tjk [Y k |X = x, Z = z , θ = θ]

:= (Y k |X = x, Z = z , θ = θ, Qj = 1, Fix Dj = 0)
− (Y k |X = x, Z = z , θ = θ, Qj = 1, Fix Dj = 1),

where the random variable (Y |X = x, Z = z , θ = θ, Qj =
1, Fix Dj = 0) is the value of Y k at node j for a person with
characteristics X = x, Z = z , θ = θ from the population that
attains node j (or higher), Qj = 1, and for whom we fix Dj = 0 so
that agents are forced to go on to the next node. Random variable
(Y k |X = x, Z = z , θ = θ, Qj = 1, Fix Dj = 1) is defined for the
same individual but forces the person with these characteristics
not to transit to the next node. (For the unordered model we
account for the conditioning on branch membership, i.e., D0 = 0
or D0 = 1, by conditioning on Qj .)
The person-specific treatment effect can be decomposed into
two components: the Direct Effect of going from j to j + 1: DEjk =
Yjk+1 − Yjk , and the Continuation Value of going beyond j + 1:
s−(j+1)

Cjk+1

Vn (H (a), a) = Rn (H (a), a)

+ δ E [V (H (a + 1), a + 1) | H (a), Bn (a) = 1]



Continuation Value

for a < a, where Vn (H (a), a) = Rn (H (a), a), the reward in state n
at age a for a person with history H (a). The decision rule is Bn (a) =
1 if n = argmaxj∈{1,...,N } {Vj (H (a), a)}; Bn (a) = 0 otherwise.
Fully specified dynamic discrete choice models postulate agent
preferences, constraints, and information sets, and can recover
continuation values associated with each choice as well as option
values that arise from moving through decision trees like those
of Figs. 1 and 2.26 These benefits come at a price and many
empirical economists reject the strong assumptions invoked in
using dynamic economic models.27
This paper takes a more agnostic and data-sensitive approach.
We estimate a dynamic treatment effect model that captures some
essential features of dynamic discrete choice models, but does not

25 Alternative sets may vary.
26 See, e.g., Eisenhauer et al. (2015a) for estimates of a structural model of
schooling with option values and continuation values.
27 See, e.g., Angrist and Pischke (2010).

(8)

k

=




r


r =1

l=1


(1 − Dj+l ) (Yjk+r +1 − Yjk+r ).

(9)

In the unordered model, the continuation value for the upper
branch is defined as before (conditioning on D0 = 0) and for the
lower branch it is defined for the attainable set {0, G}. Essentially,
G is the only option available to a high school dropout in our model.
At the individual level, the Total Effect of fixing Dj = 0 on Y k is
decomposed into
Tjk = DEjk + Cjk+1 .

(10)

The associated population level average treatment effect conditional on Qj = 1 is
ATEjk


:=


···

E [Tjk (Y k |X = x, Z = z , θ = θ)]

· dFX ,Z ,θ (x, z , θ | Qj = 1).

(11)

28 The distinction between fixing and conditioning traces back to Haavelmo
(1943). White and Chalak (2009) use the terminology ‘‘setting’’ for the same
notation. For a recent analysis of this crucial distinction, see Heckman and Pinto
(2015b).

J.J. Heckman et al. / Journal of Econometrics 191 (2016) 276–292

Integrating over X , Z , θ , conditioning on Qj = 1, the population
continuation value at j + 1 is

(

EX ,Z ,θ Cjk+1

) = EX ,Z ,θ


s−1 

E (Ylk+1 − Ylk |X = x, Z = z ,

l=j+1

θ = θ, Ql+1 = 1, Fix Qj+1 = 1)
· Pr (Ql+1 = 1|Fix Qj+1 = 1, X = x, Z = z ,


θ = θ, Qj = 1) |Qj = 1

(12)

where Qs = 1 if S = s.
We can also specify population distributions of total effects as
in Heckman et al. (1997):29
Pr (Tjk < tjk |X = x, Z = z , θ = θ, Qj = 1)

(13)

with population distribution counterpart
EX ,Z ,θ Pr (Tjk < tjk |Qj = 1)





(14)

which can be decomposed into the distribution of direct effects
and continuation values. (The modifications for the unordered case
require that we define these terms over the admissible options
available for D0 = 1 or D0 = 0.)
We thus approximate the treatment effects that could be
obtained from a fully specified dynamic discrete choice model.
However, we abstract from age-specific rewards and consider only
stage-specific rewards (which may be discounted return streams
associated with each choice).30 Because we do not specify or
attempt to identify choice-node-specific agent information sets,
we only analyze ex-post treatment effects, and cannot identify
option values associated with choices.
Since our framework does not impose specific decision rules, it
is consistent with irrationality, regret, and mistakes in decisionmaking associated with agent maturation and acquisition of
information. In the context of a schooling model, with our
framework we can identify the proportion of agents with ex-post
regret about their educational decisions (if they are maximizing
the present value of earnings) and can identify the characteristics
of the population with regret. We can also test predictions of
fully specified dynamic discrete choice models, i.e., that expected
later-stage costs and rewards should affect agent transitions at
earlier stages. Our framework thus enables analysts to examine the
validity of key assumptions maintained in the structural discrete
choice literature.
Many different treatment effects can be defined depending on
the populations and margins targeted. We now present two that
are not standard in the statistical treatment effect literature but
that answer interesting economic and policy questions.
3.1. Average marginal treatment effects
The Average Marginal Treatment Effect (AMTE)31 is the average
effect of transiting to the next stage for individuals at the margin
of indifference between the two stages:
AMTEkj :=



...







E Tjk Y k |X = x, Z = z , θ = θ, |Ij | ≤ ε

· dFX ,Z ,θ (x, z , θ̄ | Qj = 1, |Ij | ≤ ε),

29 See Abbring and Heckman (2007) for a review of the literature.
30 See, e.g., Heckman and Navarro (2007).
31 See Carneiro et al. (2010, 2011).



281

where ε is an arbitrarily small neighborhood around the margin
of indifference. AMTE defines causal effects at well-defined and
empirically identified margins of choice. It is the proper measure
of marginal gross benefits for evaluating the gains of moving from
one stage of the decision node to the next for those at that margin
of choice, and in general is distinct from LATE.32 The population
distribution counterpart of AMTE is defined over the set of agents
for whom |Ij | ≤ ε , which can be generated from our model:
Pr (Tjk < tjk |Qj = 1, |Ij | ≤ ε).33 This definition, with modification
for the branch of Fig. 2 analyzed, also applies to the unordered case.
3.2. Policy-relevant treatment effects
The policy-relevant treatment effect (PRTE) is the average
treatment effect for those induced to change their choices in
response to a particular policy intervention. Let Y k (p) be the
aggregate outcome under policy p for outcome k. Let S (p) be the
final state selected by an agent under policy p. The policy-relevant
treatment effect from implementing policy p compared to policy p′
for outcome k is:
PRTEkp,p′ :=




···

E (Y k (p) − Y k (p′ )|X = x, Z = z , θ = θ,

S (p) ̸= S (p′ ))dFX ,Z ,θ (x, z , θ|S (p) ̸= S (p′ )),

(16)

where S (p) ̸= S (p ) denotes the set of the characteristics of
people for whom attained states differ under the two policies. It
is different from AMTE because different agents affected by the
policy can be at different margins of choice. PRTE is often confused
with LATE. In general, they are different unless the policy change
coincides with the instrument used to define LATE. The differences
between the two can be substantial.34
Proceeding in a similar fashion, we can define conventional
treatment effects, e.g., ATE, TT, TUT defined for different populations. Again, population distribution counterparts can be defined
for the distribution of the gains for any sub-population with positive probability. The modifications required for the unordered case
are straightforward. One needs to specify the options available for
the branches of Fig. 2 on which agents operate.
′

4. Identification
The structural approach to econometrics estimates the full
set of equations and distributions of the unobservables specified
in Eqs. (1)–(6) under the assumptions postulated in Section 2.
Access to these equations enables analysts to generate all of
the treatment effects discussed in Section 3 and more. This
approach has great appeal. At issue is the credibility of the
resulting estimates. The appeal of the treatment effect approach
is that identification of parameters demands fewer and often more
transparent assumptions. The downside of the approach is that the
treatment effects so generated often have unknown economic or
policy relevance. The approach in this paper offers a compromise
between these two approaches.
This section gives sufficient conditions for identification of the
full model of Section 2. It then considers some simpler criteria
useful for identifying some of the treatment effects defined in
Section 3.

(15)
32 See, e.g., Heckman and Vytlacil (2007a) and Carneiro et al. (2010).
33 Because we keep the interval ε fixed and finite, we avoid the non-uniqueness
of limits for the limits of AMTE discussed in Carneiro et al. (2010), although there
are different estimates for different ε .
34 See Carneiro et al. (2011) for an example.

282

J.J. Heckman et al. / Journal of Econometrics 191 (2016) 276–292

4.1. Identification of the full structural model: the ordered case
One approach to identifying the full structural model builds
on the analyses of Heckman and Navarro (2007) as refined
in Abbring and Heckman (2007).35 These authors exploit variation
in the Z of Eq. (4) across transitions as well as restrictions on
φj (Z ). Such variation can arise from exclusion restrictions in IV
analysis or from functional form restrictions across determinants
of transition equations. After developing this approach, we develop
an approach based on conditional independence assumptions as
used in matching and in the structural literature on dynamic
discrete choice.
Heckman and Navarro (2007) analyze the identifiability of a
single spell discrete time duration model with an associated vector
of potential outcomes at each stopping time. The time periods in
their model correspond to the stages in Fig. 1. Their decision model
corresponds to our Eq. (1).
Their Theorem 1 does not invoke any factor structure assumption, and works directly with the ηj . It applies to the linear-inparameters specification of the choice index
Ij (Z ) = Zj′ γ j − ηj

j ∈ J = {0, . . . , s − 1}.

(17)

We consider a more general specification after we consider
the analysis of a linear-in-parameters model which serves to fix
ideas. The Zj are assumed to satisfy Assumptions (A-1d) and (A-1e).
Assume access to a random sample of data on D and Z and assume
no censoring of transition histories on individuals. It is convenient
to introduce the following notation. Let Z = (Z0 , . . . , Zs−1 ) and
η = (η0 , . . . , ηs−1 ). Define Z j = (Z0 , . . . , Zj ) and ηj = (η0 , . . . , ηj )
for j ∈ {0, . . . , s − 1}. Analogously, define γ j = (γ 0 , . . . , γ j ) and
Dj = (D0 , . . . , Dj ) for j ∈ {0, . . . , s − 1}. Let η = (η0 , . . . , ηs−1 )
and η = (η , . . . , η ) denote the upper and lower limits of the
0

s−1

support of η, with ηj and ηj defined comparably for ηj .

(i) Z j y ηj (implied by (A-1d) and (A-1e)).
(ii) η is absolutely continuous with respect to Lebesgue measure
j
defined on the support l=0 (η , ηl ).
l
(iii) Full rank: For all l ∈ {0, . . . , j}, Zl is a Wl dimensional
vector. There exists no proper linear subspace of RWl having
probability 1 under FZl , the cdf of Zl . There exists a ğ j =
(ğ0 , . . . , ğj ), a vector of constants, such that for almost all g j =

j

(ηl , ηl ) with g j ≥ ğ j component-wise,
there exists no proper linear subspace of RW0 × RW1 ×· · ·× RWj
l =0

having probability 1 under FZ ′ |Z ′ γ 0 >g0 ,...,Z ′ γ j−1 >gj−1 .
j 0
j−1
(iv) Inclusion of supports:
Supp(Zj′ γ j |Z0′ γ 0 = g0 , . . . , Zj′−1 γ j−1 = gj−1 ) ⊇ (η , ηj )
j

Theorem 4.2. Assume data on (Yj , Dj , X , Z ) given Qj = 1 from
a random sample across individuals. Assume that φj (Z ) belong to
the class of Matzkin functions and array them in vector φ j (Z ) =
(φ0 (Z ), . . . , φj (Z )), j ∈ {0, . . . , s − 1}. Assume further that:
(i) (Uj , ηj ) are absolutely continuous random variables with zero
means, finite variances and support Supp(Uj ) × Supp(ηj ) with
upper and lower limits (U j , ηj ) and (U j , ηj ) respectively with
similar conditions holding for each subvector.
(ii) (U , ηj ) y [Z | X ], j ∈ J , an implication of Eqs. (A-1e) and
(A-1d)
j
(iii) Supp(τ j (X ), φj (Z )) = Supp(τ j (X )) × l=1 Supp(φj (Z ))
j
(iv) Supp(φj (Z )) ⊇ Supp(η ).
Then τ j (X ), φj (Z ), Fηj ,Uj are identified up to scale if the Matzkin
functions for the discrete components are specified up to scale, and
are exactly identified if a specific normalization is used for those
components.
Proof. Heckman and Navarro (2007), Theorem 2.

Theorem 4.1. Under the following assumptions, conditional on X ,

(g0 , . . . , gj ) g j ∈

restrictions, provided that the coefficients arrayed in γ j =
(γ 0 , . . . , γ j ) are linearly independent and there are at least j
continuous (with respect to Lebesgue measure) components of
each of the Z j .
Heckman and Navarro (2007) extend Theorem 4.1 in two
important ways. First, they consider a class of general functional
forms for Ij (Z ) = φj (Z ) − ηj that satisfy the Matzkin (1994)
conditions.36 , 37 The Matzkin class includes the linear in the
parameters model (Eq. (17)) as a special case. Second, to the
discrete choice model of Eqs. (1) and (4) they adjoin a vector of
outcomes Yj , j ∈ J which may be discrete or continuous, but if
discrete, are generated by dichotomizations of continuous latent
variables where Yj is defined as the vector of outcomes associated
with Dj = 1 and where Ds = 1 if S = s.38
They prove the following theorem, which we adapt to our case.

(18)

where the boundary points (η , ηl ) are not functions of γj . Then,
l

Theorem 4.2 does not identify the joint distribution of
Y0 , . . . , Yj because analysts observe only one of these vector outcomes for any person. Observe that we do not require strict exclusion restrictions in the arguments of the treatment choice equation
to identify the model. We require independent variation of arguments that might be achieved by instrumental variable exclusion
conditions but that can also be obtained by other functional restrictions such as those previously discussed for the linear model of
Theorem 4.1.39 Note further that it is possible to identify the τ j (X )
(up to constants) without any limit set argument.40
As a by-product of Theorem 4.2, under autonomy (i.e., structural
invariance), we can construct the distributions of Yj for a variety of
counterfactual histories up through j
Pr (Yj ≤ yj |D0 = d0 , . . . , Dj = dj )



The independent variation requirements of Assumption (iii)
and the inclusion of supports condition of Assumption (iv) can be
stringent in applications. In empirical work these conditions are
sometimes difficult to satisfy, although, as we show in Section E
of the Web Appendix, they are satisfied in our data. Corollary 1
of Heckman and Navarro (2007) ensures identification (up to the
usual scale and location normalizations) without any exclusion

(19)

for dl ∈ {0, 1}, l ∈ {0, . . . , j}. The condition Qj = 1 in (1) imposes
the requirement that

Fηj and γ j are identified up to a scale and location normalization.
Proof. Heckman and Navarro (2007), Theorem 1.



0≤

j


Dl ≤ 1

for all j ∈ {0, . . . , s}.

(C-1)

l =0

36 For convenience of the reader, we reproduce these conditions in Web Appendix
A.1.
37 They can relax the independence assumption (Z y η ) provided that in each Z ,
j

Theorem 1 in Heckman and Navarro (2007).
39 For examples, see Cameron and Heckman (1998) and Carneiro et al. (2003).
35 Taber (2000) presents a different approach for a two stage version of this model.

j

one regressor satisfies the special regressor assumptions of Lewbel (2000). See the
Web Appendix of Heckman and Navarro (2007).
38 This can be readily extended to variables with multiple discrete outcomes using

40 See the discussion in Heckman and Navarro (2007).

J.J. Heckman et al. / Journal of Econometrics 191 (2016) 276–292

Otherwise, event sequences with probabilities greater than one
might characterize the counterfactual world.
Note that the counterfactuals, that are identified by fixing Dj at
different values, have an asymmetric aspect. One can generate the
Yj distributions for persons who terminate their transitions in state
j or before.
The source of this asymmetry is the generality of the model.
At each node j, agents acquire a new random variable ηj which
can have arbitrary dependence with Yj and Yj′ for all j and j′ .
From Theorem 4.2, we can identify the dependence between ηj
and Yj′ if j′ ≥ j. We cannot identify the dependence between
ηj and Yj′ for j′ < j without imposing further structure on the
unobservables, which we do in the next subsection. Thus, for
example, we can identify the distribution of college outcomes
for high school graduates who do not go on to college and can
compare these with their distribution of high school outcomes.
Thus from Theorem 4.2 we can identify the parameter ‘‘treatment
on the untreated’’. However, we cannot identify the distribution of
high school outcomes for college graduates (e.g., treatment on the
treated parameters) without imposing further structure.41
Note that Theorem 4.2 does not invoke the factor structure assumptions postulated in Section 3. Nonetheless, from Theorem 4.2
we can construct all marginal and joint probabilities of D =
(D0 , . . . , Ds−1 ). Observe that Dl = 0 ⇒ Ql+1 = 1. We can construct Pr (Ql = 1|Qj = 1) in expression (12) for all l as well as
E (Yl+1 − Yl |Ql = 1, Qj = 1) provided Pr (Dl = 1) ̸= 1. (Otherwise it is not well defined.) Hence, over the relevant supports we
can identify expected continuation value E (Cj+1 ). However, without further restrictions, we cannot identify
E (Yj |Dj+l = dj+l , . . . , Dj = dj , . . . , D0 = d0 )

l ≥ 1.

(20)

Hence, we cannot identify treatment on the treated parameters
or (without further assumptions) any of the distributional
treatment effects.42 We can get distributional treatment effects
under rank invariance of outcomes (across the j) or invoking some
other known relationship among quantiles of outcomes across
successive j. Invoking a factor structure assumption also facilitates
identification of these counterfactuals and provides an alternative
way to identify versions of the model of Section 2.

4.1.1. The unordered case
The analysis for the unordered case is a straightforward
extension of the analysis of Heckman and Navarro (2007) and is
omitted for the sake of brevity. It entails applying the conditions
of Theorems 1 and 2 to the different decision branches of Fig. 2.
We can identify Pr (D0 = 1|Z ) under the conditions of Theorems
1 and 2. We can then apply the conditions of Theorems 1 and 2
which use identification at infinity to achieve limit sets in which
Pr (D0 = 1) = 1 and Pr (D0 = 0) = 1, analyze the two branches
separately, and proceed as before.

41 It is straightforward to establish identification (for all admissible histories up
to j) of (a) Average treatment effects for all final state attainment levels, s ∈ S ; (b)
Average effects of treatment on the untreated; (c) The AMTE; (d) The Total Effect,
the Average Direct Effect, and the Average Continuation Values for counterfactuals
satisfying (C-1). Consider E (Yj |D0 = d0 , . . . , Dj = dj ). Under the full support
condition of Theorem 4.2, we can construct the entire sequence of counterfactuals
E (Yj |D0 = d0 , . . . , Dj−1 = dj−1 ), . . . , E (Yj |D0 = d0 ), E (Yj ). We can do this for all
j ∈ J . Hence, we can form all of the listed mean treatment effects by taking suitable
limit operations. For the sake of brevity, we do not provide the proofs, which exploit
the linear properties of means and the continuity of the η.
42 See Heckman et al. (1997).

283

4.2. Identification using a factor structure
Factor models make possible identification of a broader class of
counterfactuals (see Carneiro et al., 2003, Abbring and Heckman
(2007), and Heckman and Navarro, 2007). They exploit the
dependence across choices and outcomes generated by θ . With
sufficient numbers of measurements M , one can identify the
joint distribution of θ and bring that to the table to identify the
structural model of Section 2. Knowledge of θ secured from M can
enable analysts to identify the joint distributions of counterfactuals
and choices (D, Y ) even though they do not observe all of
the components of Y across final schooling states for anyone.
Thus, knowledge of the dependence across measurements can
compensate for the lack of knowledge of the dependence across
counterfactuals.43
This knowledge provides an alternative to the exclusive
use of instrumental variable models for identifying structural
or treatment effect parameters. The dynamic discrete choice
literature invokes conditional independence assumptions (see,
e.g., Rust, 1994, Magnac and Thesmar, 2002, or Blevins, 2014), as
does the matching literature.
Factor structure models enhance the interpretability of estimated treatment effects. When the factors can be related to interpretable measurements, analysts can interpret the sources of the
unobservables that give rise to treatment effects and how they are
related to the determinants of the choice equations. In the context
of analyses of the effects of education on earnings, factor models
facilitate investigations of the sources of ability bias and its empirical importance. Dynamic factor structure models have been used
to identify the sources of skill development. (See Cunha et al., 2010
and Heckman et al., 2013.) We consider a variety of cases, starting
with the simplest. All of the analysis applies, in a straightforward
way, to both the ordered and unordered cases with a suitable modification of notation.
4.2.1. Known θ
Under the assumptions of Section 2, if analysts know θ , they can
condition on it and identify all of the treatment effects previously
defined, including treatment on the treated and distributional
treatment effects, over the available support of X , Z , θ . This is true
for both the ordered and unordered model. If these conditions
apply, additive separability can be relaxed and standard results
in matching and nonparametric econometrics can be invoked to
identify parameters under well-known conditions.44
4.2.2. Unknown but proxied θ
The more challenging case arises when θ is measured with error
but can be proxied by measurements which may include lagged
or future values of outcomes and choices.45 Schennach (2013)
provides a valuable survey of the literature.
Identification of factor models is inherently controversial.
Without an associated measurement system, factor models lack
interpretability. In our approach, the adjoined measurement
system M facilitates interpretability. But, as is well-known from
linear factor models, and is true in the general nonlinear system
of Eq. (6), many alternative sets of identifying conditions can
rationalize a given set of measurements due to classical rotation
and scaling problems.

43 Abbring and Heckman (2007) provide a variety of simple examples showing
how measurements and panel data on outcomes with each state, s ∈ {0, . . . , s} can
identify the full distribution of (D, Y ).
44 See, e.g., Pagan and Ullah (1999).
45 See Abbring and Heckman (2007).

284

J.J. Heckman et al. / Journal of Econometrics 191 (2016) 276–292

If the goal of a study is to identify the counterfactual choice and
outcome equations, but not to interpret the effects of θ , it is not
necessary to solve these rotation and scale problems (see Heckman
et al., 2011, revised 2014). Any measure-preserving transformation
of the random variables that span θ can be used as conditioning
variables. One can bypass discussions of identifiability of the
measurement equations (6).
One particularly simple case, applied in Heckman et al.
(2013), Gensowski (2014), and Kautz and Zanoni (unpublished
manuscript), extracts factor scores from a linear measurement
system M , and uses the estimated factor scores as Bartlett (1937)
regressors. It corrects for measurement error in estimating the θ
using the analyses of Skrondal and Laake (2001). Measurement
error arises from the fact that Bartlett scores are only estimates
of θ . Unlike traditional measurement error problems, from the
factor system it is possible to estimate the distribution of the
measurement error. Armed with this knowledge, it is possible
to correct for the measurement error in estimating treatment
effects and structural equations. The analysis is particularly simple
when the outcome and choice equations are linear functions of
the factors and the measurements are continuous. With linear
measurements and nonlinear choice and outcome equations,
a variety of methods for analyzing nonlinear models with
mismeasured conditioning variables but known distributions of
measurement error are available to estimate model parameters.
Using the analyses of Hu and Schennach (2008), Cunha et al.
(2010), and Freyberger (2014), it is possible to identify the
distributions of factors even when the measurement equations (6)
are nonlinear, and to apply the methods just discussed. As noted
in the survey by Schennach (2013), there has been considerable
progress in identifying factor models using information on higher
moments and using nonlinearities intrinsic to the general factor
model.46 A full account of the specific application of these various
methods is outside the scope of this paper.
The analysis of Freyberger (2014) is immediately applicable
to this paper and we draw on it. He analyzes the nonparametric
identification and estimation of a measurement system M (in our
notation) with a linear factor structure:
Mj = Φj (X ) + λ′j θ + ej
j = 1, . . . , NM . Under his conditions, which for the sake of brevity
we do not present here, it is possible to identify nonparametrically
the Φj (X ), the λj , the distribution of θ , and the distribution of
e = (e1 , . . . , em ) over the population support.
Armed with this result and the analysis of Theorem 4.2, and
in particular knowledge of the distribution of (η0 , . . . , ηs−1 ), and
recalling that

ηl = [θ ′ αl − νl ],

l ∈ {0, . . . , s − 1}

and arraying the αl , l = 0, . . . , s − 1 into an s × s matrix A,

Σ η = A′ Σ θ A + Σ ν ,
where Σ ν is an s × s diagonal matrix of uniquenesses and Σ θ is the
variance–covariance matrix of θ .
With knowledge of Σ η we can identify Σ ν . From knowledge of
Σ θ , we can identify A (up to standard normalizations).47 Since we
know the distribution of θ , we know the distribution of θ ′ αl and
by deconvolution we can identify the distribution of ν. Applying
the same type of argument to the outcome equations, we achieve
identification of the full model and we can construct the full joint
distribution of counterfactuals.48

46 See, e.g., Bonhomme and Robin (2009).
47 See, e.g., Anderson and Rubin (1956).
48 Indeed, drawing on the analyses of Abbring and Heckman (2007) and Freyberger (2014), it appears possible to identify the full joint distribution of policy

5. Understanding what instrumental variables estimate
This section uses our model to interpret what IV estimates. IV
has a prominent place in the recent literature in applied economics.
A variety of ‘‘causal effects’’ are offered in that literature, often
without any clear economic motivation. We relate our analysis
to the MTE of Heckman and Vytlacil (1999, 2005) which, in the
binary case, links a theoretical IV literature with economically
interpretable and policy-relevant treatment effects. We consider
IV in both the ordered and unordered model. The simplicity and
tractability of the MTE in the case of binary choices is compromised
because of the complex conditioning that arises from dynamic
choices. In this section, we analyze what is estimated by: (1) local
instrumental variables, (2) Wald IV, and (3) instrumental variables
with a continuous instrument.
To focus ideas, and to anchor our analysis in the conventional
literature, it is useful to have as a touchstone a prototypical
model in labor economics that has been a focus of much of
the recent literature on instrumental variables.49 The bulk of
the empirical literature on the returns to schooling is based on
linear instrumental variables estimates of a version of the Mincer
equation for person i:50
‘‘rate
of
return’’



ln y = αi + βi

i

log earnings

S

i


.

(21)

schooling

βi is the causal effect of schooling on earnings and is often called a
‘‘rate of return’’ to schooling.51 It is assumed that, contrary to the
model underlying Fig. 2, education is captured by a scalar years-ofschooling variable. When βi is the same constant for all i, and yi and
Si are measured without error, the only source of bias in estimating
the model is the dependence between αi and Si (ability bias). When
βi is correlated with Si , there is also selection on gains.
This specification combines years of schooling into a linear
aggregator and ignores any dynamics associated with continuation
values. When βi = β or βi y Si , one valid instrument identifies the
(mean) return across all schooling levels. In a companion paper
(Heckman et al., unpublished manuscript), we test for and reject
the linear specification (21) within the upper branch of Fig. 2. There
is selection on gains (βi ) at higher schooling levels but not at lower
levels.
We consider what IV estimates when the dynamic sequential structural model analyzed in this paper generates choices and
outcomes.52 Dynamic models are known to pose challenges for
standard instrumental variable procedures. If agents (even partially) anticipate instruments that affect future choice decisions,
the anticipated values of those instruments are arguments of the
choice equations preceding those decisions through the Bellman
relationship, compromising standard IV exclusion and exogeneity

counterfactuals using a sufficiently rich set of outcomes and choice data without using any measurement system. We do not develop that analysis in this paper. We note, in addition, that using the application of the analyses of Madansky
(1964), Chamberlain (1977), and Pudney (1982) by Freyberger, we can relax the requirements that Z y θ|X .
49 See, e.g., Angrist and Imbens (1995) and Angrist and Pischke (2009).
50 See Card (1999), Heckman et al. (2006), Lochner (2011), Mincer (1974),
and McMahon (2014).
51 It is under the special conditions discussed in Heckman et al. (2006).
52 Heckman and Urzúa (2010) consider this question in the context of a
static multinomial discrete choice model. New phenomena arise in the model
investigated in this paper.

J.J. Heckman et al. / Journal of Econometrics 191 (2016) 276–292

restrictions.53 We investigate another source of IV exclusion restrictions, arising from the effects of lagged instruments, in affecting, the conditioning sets of agents making current decisions.
Instruments from previous transitions determine the conditions
leading up to any current choice set.
In the notation of our model, for the ordered case
s
Y =
j=0 Dj Yj , and


E (Y |Z ) =

s



E Dj Yj |Z

where Yj is the support of Yj and
E (S |Z = z ) = q0

+

=

E (Yj |Dj = 1, Z )E (Dj |Z )

qj Dj

where Pr (S = qj |Z ) = Pr (Dj = 1|Z ) and
E (S |Z ) =

qj E (Dj |Z ).

(23)

Explicit expressions for these component terms are useful for
understanding what IV estimates in the ordered model. Because
s
terminal states are mutually exclusive, j=0 Dj = 1. Substituting
for D0 in the preceding expressions, we obtain some useful
representations:
s
s


Dl
(Yj − Yj−1 )
j=1

l =j

s


s


(24)

and
S = q0 +

(qj − qj−1 )

Dl .

(25)

l =j

j =1

Applying the model of Section 2 and keeping the X implicit, we
obtain the following expression:
E (Y |Z = z ) =


qj

ηj
φj (z )

...




y0
Y0

+

η0
φ0 (z )

s −1 

j=1


Yj

ηs−1

η0

fηj ,ηj−1 ,...,η0

ηj



5.1. The unordered case
There is no counterpart to Eq. (23) in the unordered case
unless an arbitrary number is assigned to G. Counterparts to (24)
and (25) are straightforward to derive when we condition on
D0 = 0 or D0 = 1. For the sake of brevity we do not develop
these expressions. The entire recent IV literature based on LATE
implicitly assumes the ordered case of Fig. 1. (See Vytlacil, 2006a,b
and Heckman and Pinto, 2015a.)

This section analyzes what is estimated by Local Instrumental
Variables (LIV, see Heckman and Vytlacil, 1999, 2005) in the
context of the ordered model. It is evident from Eq. (26) that any
LIV derived from it will depend on the path of instruments up
to a transition node. Variation in an instrument that appears in
multiple nodes will affect Y through multiple channels.
To begin, consider the simplified case where an instrument
only affects the final schooling transition. Let Z be a continuous
instrument that only affects the argument φs−1 (Z ) of transition
s − 1 (the final transition). Consider a scalar component of this
instrument, say Zsn−1 . Then under the conditions of Theorem 4.2
and assuming finite means, for an outcome m with φs−1 (Z )
continuously differentiable in Zsn−1 ,


∂ E (Y |Z )
∂φs−1 (Z )
=
·
E
Ys − Ys−1 |ηs−1 = φs−1 (Z ),
∂ Zsn−1
∂ Zsn−1

φs−2 (Z ) ≥ ηs−2 , . . . , φ0 (Z ) ≥ η0
· fηs−1 (φs−1 (Z )|ηs−2 < φs−2 (Z ), . . . , η0 < φ0 (Z ))

φj ( z )

η0

(27)

where

φ0 (z )

···

η0

· Pr (ηs−2 < φs−2 (Z ), . . . , η0 < φ0 (Z ))

fyj ,ηj ,...,η0

E (Ys − Ys−1 |ηs−1 = φs−1 (Z ), φs−2 (Z ) ≥ ηs−2 , . . . , φ0 (Z ) ≥ η )
0

= MTEs,s−1 (ηs−1 = φs−1 (Z ), Ds−2 (Z ) = 0, . . . , D0 (Z ) = 0)

· (yj , ηj , . . . , η0 ) dηj . . . dη0 dyj
 φ0 (z )

 φs−1 (z )
+
ys
...
fys ,ηs−1 ,...,η0
Ys

φ0 (z )

Note that Z only enters through the limits of the integrals because
of independence assumption (A-1e).

fy0 ,η0 (y0 , η0 )dy0 dη0

yj



5.2. Local instrumental variables

j =0

Y = Y0 +

s −1


fη0 (η0 )dη0

· (ηs−1 , . . . , η0 )dηs−1 . . . dη0 .

(22)

j=0

s


φ0 (z )

ηs−1

where, by definition, Dj = 0, ∀j ≤ s implies Ds = 1. (The
corresponding term for the unordered case applies the law of
iterated expectations to Eq. (7).)
To relate our general model to the conventional literature on the
returns to schooling based on (21), let qj be the years of schooling
assigned to level j. qj need not equal j or be any affine function of
the j, but qj−1 < qj , for all jϵ{0, s}.54 In this notation, in the ordered
model, schooling is
s


η0

· (ηj , . . . , η0 )dηj . . . dη0
 φs−1 (z )
 φ0 ( z )
+ qs
...
fηs−1 ,...,η0




j=0

S=



j=1

j =0
s


285

η0

· (ys , ηs−1 , . . . , η0 )dηs−1 . . . dη0 dys ,

(26)

53 See, e.g., Hansen and Sargent (1980). As shown there, innovations to the
instruments remain valid exclusion restrictions.
54 Thus, persons enrolling in college but not completing it spend roughly 2.4 years
there (so q3 = 14.4), while college graduates spend (typically) 4 years (so q4 = 16).

is the mean gain for outcome Y from going from s − 1 to s for a
person with ηs−1 = φs−1 (Z ) for whom Ds−2 (Z ) = 0, . . . , D0 (Z ) =
0. It is the sequential dynamic counterpart to the MTE parameter
introduced in Heckman and Vytlacil (1999, 2005).
The comparable expression for E (S |Z ) is

∂ E (S |Z )
∂φs−1 (Z )
=
· (qs − qs−1 )
n
∂ Zs−1
∂ Zsn−1

(28)

· fηs−1 (φs−1 (Z )|ηs−2 < φs−2 (Z ), . . . , η0 < φ0 (Z ))
· Pr (ηs−2 < φs−2 (Z ), . . . , η0 < φ0 (Z )).

(29)

286

J.J. Heckman et al. / Journal of Econometrics 191 (2016) 276–292

LIV(m, Zsn−1 ) is obtained as the ratio of the first expression over
the second expression:
LIV =



E Ys − Ys−1 |η

φ0 (Z ) ≥ η0

= φs−1 (Z ), φs−2 (Z ) ≥ ηs−2 , . . . ,

1
,
qs − qs−1

s−1



assuming that (28) is nonzero. Observe that the entire history of
instruments s − 1 also enter this expression, unlike its counterpart
in the binary case. Such conditioning on instruments is not
standard in the IV literature and in its recent counterparts for
binary choice models, but is a feature of models with multiple
choices.55
This case is very special because it only considers variations
that affect the final transition. We now develop the general case.
In this case, even if an instrument only affects the argument of
one transition (say the lth, φl (Z )), the instrument affects multiple
outcomes as it percolates over the entire dynamic process.
To develop the general case, consider a continuous component
Z n that may appear in multiple arguments of the functions
determining transitions φl (Z ), l ∈ {0, . . . , s − 1}. Straightforward
calculations establish that


{j,s−1} 
s min
∂ E (Y |Z ) 
∂φl (Z )
=
(j, l)56
n
∂Zn
∂
Z
j =0
l =0

(30)

Eq. (30) gives the sum of the marginal effects on Y of variation
in the instrument as it affects selection into different stages of the
decision tree in Fig. 1. Such effects do not arise in the traditional
binary choice LATE literature where the path leading up to a
transition is not an issue. Notice that values of Z n that affect the
probability of being at transition l (Pr (Ql = 1|Z )) affect outcomes,
even if Z n is not an argument of φl (Z ).58 Locally, the components
of (j, l) for which φl (Z ) does not depend on Z n do not affect the
calculation.
By a parallel argument,
{j,s−1}
s min
∂ E (S |Z ) 
qj
=
∂Zn
j =0
l =0




∂φl (Z )
˜ (j, l),

∂Zn

(36)

˜ (j, l), j ̸= s are
where 
fηl (φl (Z )|ηj > φj (Z ), ηj−1 < φj−1 (Z ), . . . , ηl+1
< φl+1 (Z ), ηl−1 < φl−1 (Z ), . . . , η0 < φ0 (Z ))

· Pr (ηj > φj (Z ), ηj−1 < φj−1 (Z ), . . . , ηl+1
< φl+1 (Z ), ηl−1 < φl−1 (Z ), . . . , η0 < φ0 (Z )),

(37)

where the corresponding term for j = s is

˜ (s, l) = fηl (φl (Z )|ηj−1 < φj−1 (Z ), . . . , η0 < φ0 (Z ))

· Pr (ηj−1 < φj−1 (Z ), . . . , η0 < φ0 (Z )),

(38)

and the corresponding term for j = 0 is

where

fη0 (φ0 (Z )).

(j, l) = E (Yj |φ0 (Z ) ≥ η0 , . . . , φl−1 (Z ) ≥ ηl−1 ,
ηl = φl (Z ), φl+1 (Z ) ≥ ηl+1 , . . . , φj (Z ) < ηj )

· fηl (φl (Z )|ηj > φj (Z ), ηj−1 < φj−1 (Z ), . . . ,

Collecting results
∂ E ( Y |Z )

for j ∈ {0, . . . , s − 1} and l ̸= j, and where the term in braces on
the right hand side of (31) (a weight) is the conditional density of
ηl evaluated at φl (Z ), given that Dk = 0, k ∈ {0, . . . , l − 1, l +
1, . . . , j − 1} and Dj = 1. This expression exists given the assumed
absolute continuity of the η0 , . . . , ηj .57
For l = j and j < s,


×1

∂Zn

∂ E (S |Z )
∂Zn




̸= 0 .

(40)

Note that the Z n can affect multiple margins. Note further that
∂ E (S |Z )
even if each φl (Z ) is monotonic in Z n , the term ∂ Z n can be 0 and
can switch signs over the support of Z . LIV is a weighted average of
derivatives of marginal valuation functions.
5.2.1. The unordered case for local instrumental variables
There is no counterpart of the analysis of this section for the
unordered case because there is no counterpart to (28). For an
analysis of what IV identifies in this case, see Heckman and Urzúa
(2010) and Heckman (2010).

(32)
5.3. Wald IV
(33)

The corresponding term for j = s is

(s, l) = E (Ys |φ0 (Z ) ≥ η0 , φl (Z ) = ηl , . . . , φs−1 (Z ) ≥ ηs−1 ) (34)

· fηl (φl (Z )|ηs−1 < φs−1 (Z ), . . . , ηl+1 < φl+1 (Z ), ηl−1

< φl−1 (Z ), . . . , η0 < φ0 (Z ))
· Pr (ηs−1 < φs−1 (Z ), . . . , ηl+1 < φl+1 (Z ),

ηl−1 < φl−1 (Z ), . . . , η0 < φ0 (Z )) .

LIV(Z n ) = ∂ E∂(ZS |Z )
n

ηl+1 < φl+1 (Z ), ηl−1 < φl−1 (Z ), . . . , η0 < φ0 (Z ))
· Pr (ηj > φj (Z ), ηj−1 < φj−1 (Z ), . . . , ηl+1 < φl+1 (Z ),

ηl−1 < φl−1 (Z ), . . . , η0 < φ0 (Z ))
(31)

(j, j) = −E (Yj |φ0 (Z ) > η0 , . . . , φj−1 (Z )
> ηj−1 , . . . , φj (Z ) = ηj )

· fηj (φj (Z )|ηj−1 < φj−1 (Z ), . . . , η0 < φ0 (Z ))

· Pr (ηj−1 < φj−1 (Z ), . . . , η0 < φ0 (Z )) .

(39)

(35)

55 See Heckman (2010).
56 Intermediate calculations useful for establishing this result are presented in
Appendix A.2.
57 For the explicit expression, see Web Appendix A.2.

This section decomposes the Wald estimator into underlying
economically interpretable components. We find that, in the
ordered case, the estimator is a weighted average across many subpopulations and many margins. For the analysis of the unordered
case, see Heckman and Urzúa (2010). The Angrist–Imbens analysis
of multiple choices (1995) only applies to ordered models
(see Vytlacil, 2006a,b and Heckman and Pinto, 2015a).
Under standard independence assumptions that are implied by
the model of Section 2,59 for an instrument vector Z set at two
different values Z = z1 and Z = z2 , assuming S (z2 ) ̸= S (z1 ),
where S (zk ) is the random variable when Z is fixed at zk and for
specificity that S (z2 ) > S (z1 ), the probability limit of the Wald IV

58 Heckman et al. (2008) report related results in a model of discrete choice. See
also Heckman and Urzúa (2010).
59 In particular, (Y , . . . , Y ) y Z .
0

s

J.J. Heckman et al. / Journal of Econometrics 191 (2016) 276–292

for Eq. (21) featured in the recent literature60 for a scalar outcome
in the ordered model is
Wald IV (z1 , z2 )
s

j =1

=

s


in an unordered model, see Heckman and Urzúa (2010). For
simplicity, we continue to consider the case where Y is scalar. The
IV estimator is
COV (Y , Z n )

IV (Z n ) =

E (Yj − Yj−1 |S (z2 ) ≥ qj > S (z1 ))Pr (S (z2 ) ≥ qj > S (z1 ))

,
(qj − qj−1 )Pr (S (z2 ) ≥ qj > S (z1 ))

COV (S , Z n )

where

Yj −Yj−1
qj −qj−1

= β for all j = 1, . . . , s in the Mincer model (21).

E

s



s


E Yj − Yj−1 |S (z2 ) = ql , S (z1 ) < qj

.

Dj Z Yj

(43)

j =0

Consider the jth term and observe that Dj = 1(φj (z ) ≤ ηj ,
φj−1 (z ) ≥ ηj−1 , . . . , φ0 (z ) ≥ η0 ), j ∈ {0, . . . , s − 1}, and Ds =
1{φs−1 (z ) ≥ ηs−1 , . . . , φ0 (z ) ≥ η0 }.
We assume that vector (Z n , φ0 (Z ), . . . , φj (Z )) is absolutely
continuous with respect to Lebesgue measure with density
fZ n ,φ0 (Z ),...,φj (Z ) (z n , φ0 (z ), . . . , φj (z )), and we further postulate
that Yj is absolutely continuous with respect to Lebesgue
measure conditional on Z , φ0 (Z ), . . . , φj (Z ). Define the support of
φ0 (Z )×, . . . , ×φj (Z ) as Ψ j (Z ).
Then, for j ∈ {1, . . . , s − 1},
E (Dj Z Yj ) =
n

 





φ0 (z )



ηj

···
Yj

Zn

Ψ j (z )

η0

φj (z )

yj z n

· fyj ,η0 ,...,ηj ,Z n ,φ0 (Z ),...,φj (Z ) (yj , z n , η0 , . . . , ηj , φ0 (z ), . . . , φj (z ))
n

(44)

n

where Z is the support of Z . For j = 0, the expression is

l =j
s 
s

 

(42)


n

· dyj dη0 , . . . , dηj dz n dφ0 (z ) . . . dφj (z )

s

(Dl (z1 ) − Dl (z2 ))
(Yj − Yj−1 )

j =1

=

COV (Y , Z ) = E
n

61

This estimand identifies the change in the aggregate outcome
resulting from changes in schooling induced by the instrument.
E (Yj − Yj−1 |S (Z2 ) ≥ qj > S (Z1 )) is a ‘‘causal effect’’ and is often
contrasted with clearly interpretable economic causal effect β .62
This parameter is the mean gain of going from j − 1 to j for a set
of people who pass through qj , even though they may end up far
above qj and start far below qj . It may differ across j because the
distributions of the returns (β ) are different across conditioning
sets or because of nonlinearity in the returns.
To interpret the Wald estimand using the ordered model of this
paper, we use the counterfactual notation of Imbens and Angrist
(1994), where Dl (zk ) is the random variable Dl when Z is fixed at
zk . In this expression, assuming that S (z2 ) > S (z1 ), the numerator
of (41) is

· 1(COV (S , Z n ) ̸= 0).

We assume that Z n is centered around its mean. First, consider
s
the numerator of this expression. From Y =
j=0 Dj Yj ,

j =1

(41)

287








zn

y0

Ψ 0 (z )

Zn

Y0



η0
φ0 (z )

fyj ,z n ,η0 (yj , z n , φ0 (z ), η0 )dyj dz n dη0 .
(45)

j =1 l =j

· Pr (Sl (z2 ) = ql |S (z1 ) < qj ) · Pr (S (z1 ) < qj )

j −1 
s 
s 

=
E (Yj − Yj−1 |S (z2 ) = ql , S (z1 ) = qk )
j=1 l=j k=0

· Pr (S (z2 ) = ql , S (z1 ) = qk ).
The term in braces in the immediately preceding expression is the
mean change in the outcome of going from j − 1 to j for persons
who at Z = z2 , would stop at ql years if schooling (l ≥ j), but who
at Z = z1 would stop at qk years of schooling (k ≤ j − 1). The final
term on the right hand side of this expression is the proportion of
this population in the indicated category.
The probability term in the expression can be identified
nonparametrically. However, IV does not separately identify the
terms in braces. Our structural approach allows us estimate each
of the components in this expression and their dependence on the
entire Z process to interpret IV.
5.4. Characterizing what IV identifies
We now consider what IV estimates in an ordered model when
Z n is a continuous variable. For an analysis of what IV estimates

60 See, e.g., Angrist and Pischke (2009).
61 We use a scalar Y only to conform to the empirical literature.
62 Referring to the version of our Eq. (21) that is in their paper, Angrist and Imbens
write ‘‘[The Mincer equation] is a structural relationship derived from assumptions
about human behavior, but it is not necessarily a causal relationship in the Rubin
(1974) sense’’. (Angrist and Imbens, 1995, p. 433). Expression (41) is closely related
to an expression for the causal effect of schooling reported in Angrist and Imbens
(1995), who, in our notation, assume that qj − qj−1 = 1.

Recalling that Yl y Z , l ∈ {0, . . . , s} and Z y η, interchanging
φj (Z ) and ηj , integrating by parts, and invoking Fubini’s theorem,
it follows that
E (Dj Z n Yj )



ηj

=
ηj





Ψ j (z )



MTE-like parameter



E (Yj |ηj , φj−1 (z ) ≥ ηj−1 , . . . , φ0 (z ) ≥ η0 )

· f (ηj |φj−1 (z ) ≥ ηj−1 , . . . , φ0 (z ) ≥ η0 )
· Pr (φj−1 (z ) ≥ ηj−1 , . . . , φ0 (z ) ≥ η0 )

·
z n fZ n ,φj (z ),...,φ0 (z ) (z n , φj (z ), . . . ,
Zn


φ0 (z ))dz n dφ0 (z ) · · · dφj−1 (z ) dηj


(46)

where
E (Yj |ηj , φj−1 (z ) ≥ ηj−1 , . . . , φ0 (z ) ≥ η0 )
plays a role analogous to each component of the MTE in the analysis
of Heckman and Vytlacil (1999, 2005). For j = s, the corresponding
expression for the analogous MTE component is
E (Ys |ηs−1 , φs−2 (z ) > ηs−2 , . . . , φ0 (z ) ≥ η0 ),

(47)

and E (Ds Z Ys ) is defined in an analogous expression.
The denominator of the expression for IV is obtained by a similar
argument using
n

E (SZ n ) =

s

j =0

qj E (Z n Dj ).

(48)

288

J.J. Heckman et al. / Journal of Econometrics 191 (2016) 276–292

Focusing on the jth component, we investigate
E (Z Dj ) = E (Z 1(φj (z ) < ηj , φj−1 (z ) ≥ ηj−1 , . . .))
n

n



ηj







φj−1 (z )

=
Zn

Ψ j (z )

φj (z )

ηj−1

...



φ0 (z )
η0

(49)

z n Pr (φj (z ) ≤ ηj ,

φj−1 (z ) ≥ ηj−1 , . . . , φ0 (z ) ≥ η0 )
·f

Z n ,φj (Z ),...,φ0 (Z )

(Z , φj (z ), . . . , φ0 (z ))dηj · · · dη0
n

dz n dφj (z ) · · · dφ0 (z ),


(50)

j = {1, . . . , s − 1}, with an obvious modification to produce the
sth term, and the term for j = 0. Because of the dynamics of
the model, the simplicity of the MTE framework of Heckman and
Vytlacil (1999, 2005) vanishes.
6. Empirical estimates
This section illustrates the power of our methodology for
understanding the causal benefits of education on earnings. As we
have just shown, expressions for interpreting what IV estimates
can be very complex. But, with our model, it is possible to generate
all of the treatment effects discussed in Section 3 for both ordered
and unordered cases.
The standard approach to identifying the causal effect of
education on earnings relies on Eq. (21), which imposes linearity
of log earnings in terms of total number of years of schooling
(Card, 1999). It ignores the continuation value of schooling (see
the discussion in Heckman et al., 2006). With our approach,
we can investigate returns by educational level and identify the
empirical importance of ex-post continuation values. We estimate
the general ordered model.
We use data for a sample of males from the NLSY79 that is
described in detail in Web Appendix B. We do not exploit the full
generality of our approach in our parameterization of estimating
equations. We use linear-in-parameters specifications of the
estimating equations and mixtures of normals representations
to approximate the distributions of the unobservables. We use
the identification criteria of Williams (2012) to characterize the
measurement equations used in this paper. See Web Appendix C.1
for details.
We show that (a) there are substantial but heterogeneous
benefits to graduating from high school, though not to GED
certification; (b) some people benefit from enrolling in and
graduating from college and there is selection on these gains;
(c) continuation values – largely neglected in empirical research
on the returns to schooling – are empirically substantial;63
(d) the estimated local average treatment effects are different
from the economically interpretable average marginal treatment
effects; (e) standard assumptions imposed in the dynamic discrete
choice literature that publicly available future costs affect current
decisions are rejected in our data; (f) in the ordered case, the Wald
estimator is a weighted combination of gains from heterogeneous
sub-populations affected across multiple decisions; and (g) a
considerable fraction of the population would continue on to
obtain further education if forced to continue past their terminal
schooling level.
6.1. Returns to educational choices
Table 1 displays the average treatment effect, average marginal
treatment effect, average effect of treatment on the treated, and

63 Altonji (1993) presents estimates of internal rates of return adjusted for
continuation values. Cameron and Heckman (1993) present OLS-based estimates
of continuation values of schooling.

average effect of treatment on the untreated for log wages at
age 30 for each educational transition. There is little evidence
of selection on gains in the first two educational transitions, but
there is a substantial selection on later transitions.64 , 65 We find no
statistically significant benefits to GED certification.
The local average treatment effect (LATE) is commonly said
to estimate ‘‘the effect’’ of schooling for individuals near the
margin of indifference for a particular educational choice. The last
two rows of Table 1 report the local average treatment effect
estimated by two-stage least squares (IV) and the average marginal
treatment effect (AMTE). The AMTE and IV estimates are quite
different. This result might be thought to be due in part to the
weakness of our instruments. For some of the transitions, the
instruments for the nodes associated with the decision to graduate
from high school and the decision to graduate from college are
not statistically significant in the first stage, resulting in large
standard errors and unstable point estimates (see Heckman et al.
unpublished manuscript). In Web Appendix G, we conduct a
simulation experiment that documents the poor performance of
IV in identifying economically interpretable treatment parameters,
even when instruments are manufactured to be strong.
The node associated with the choice to enroll in college has two
statistically significant instruments—local tuition costs and the
presence of a four-year college in the county. For estimates at this
node, the IV estimates are statistically significant and substantially
larger than the AMTE estimates (as well as the other treatment
effects). While it is common in the applied literature to claim
that LATE is estimating an economically interpretable parameter
like AMTE, this is certainly not the case in this example. This
supports our claim that, in the context of our dynamic schooling
model, IV estimates a difficult-to-interpret treatment effect of little
economic or policy relevance.
6.2. Continuation values
One benefit of schooling is access to further schooling.66
Specifically, the choice to graduate from high school gives the
option to go to college, and the choice to enroll in college gives
the option of attaining a four-year college degree. The direct
effect of an educational choice is the direct gain from choosing to
attain the next level of schooling, while the continuation value of
an educational choice is the probability of continuing education
times the benefits of that additional education. For example, the
continuation value for enrolling in college is the probability of
attaining a four-year degree times the benefit of the degree. For
high-ability individuals, the benefits of college are large, and the
probability of attending is close to 1. For such individuals, the
continuation value constitutes the bulk of the return to graduating
from college. For others, the continuation value is much lower.
Table 1 shows the total effect and the direct effect, and the
percentage of the total effect arising from continuation values.
The continuation value is small for those who are indifferent
to graduating from high school. The direct effect and the total
effect are nearly the same. However, the continuation value is an
important component of the average effects (ATE) and is especially
important for those choosing to graduate from high school (TT).
A similar pattern holds for the college enrollment decision, where
the continuation value is larger for those who choose to enroll than
those who are indifferent or decide not to enroll.

64 We test this by comparing the differences between treatment on the treated and
treatment on the untreated. Under the null of no selection bias, these parameters
should be the same.
65 For details on the construction of treatment effects, see Section 3. We report
dynamic treatment effects as defined by Eq. (11).
66 See Weisbrod (1962) and Comay et al. (1973).

J.J. Heckman et al. / Journal of Econometrics 191 (2016) 276–292

289

Table 1
The effects of education on log wages (age 30).
Estimate

Graduate high school

Enroll in college

Coef.

Coef.

Std. Err.
*

Graduate college
Std. Err.

**

Coef.

Earn GED
Std. Err.

Coef.

Std. Err.

**

(0.037)

0.059

(0.052)

ATE
(Dir)
(% Cont Val.)

0.094
0.036
73%

(0.056)
(0.056)

0.134
0.085**
25%

(0.025)
(0.029)

0.114

TT
(Dir)
(% Cont Val.)

0.093
0.021
77%

(0.072)
(0.068)

0.140**
0.062
56%

(0.031)
(0.040)

0.141**

(0.042)

0.063

(0.053)

TUT
(Dir)
(% Cont Val.)

0.100**
0.089**
11%

(0.029)
(0.031)

0.128**
0.109**
15%

(0.026)
(0.030)

0.079**

(0.036)

0.055

(0.055)

AMTE
(Dir)
(% Cont Val.)

0.093**
0.087**
7%

(0.028)
(0.032)

0.101**
0.077**
24%

(0.023)
(0.028)

0.110**

(0.034)

0.057

(0.051)

IV

−0.761

(0.807)

0.511*

(0.207)

0.025

(0.852)

0.130

(0.552)

Notes: Standard errors (in parenthesis). All standard errors calculated with 200 bootstrap samples. Each column presents the average effect of an educational decision. Total
effects are reported on top of the ‘‘direct’’ component. Each schooling level provides the option to pursue higher schooling levels, while final schooling levels do not provide
such an option. ‘‘DIR’’ represents the direct effect of attaining the schooling level and stopping there. The direct effect is the same as the total effect for terminal nodes. ‘‘%
Cont Val.’’ reports the percentage of the total effect that is generated by access to future educational decisions and resulting continuation values. The TT row presents the
average effect for those who chose a higher level of schooling (Dj = 0), and TUT presents the average effect for those who do not choose the next stage of schooling (Dj = 1).
AMTE presents the average effect for those who are indifferent between choosing a higher level of schooling or not. The table also presents the estimated treatment effect
from two-stage least squares controlling for family background variables, factors, and decision-specific instruments by educational choice (‘‘IV’’). For graduating from high
school, the instruments are long-run local unemployment rate and current local unemployment rate at 17. The choice to earn a GED additionally includes, as an instrument,
the state-wide passing difficulty of the GED. The choice to enroll in college includes long-run local unemployment rate, current local unemployment rate at 17, presence of
a 4-year college in the county, and local college tuition. The choice to graduate from college includes local long-run unemployment at age 22, current local unemployment
at age 22, and local college tuition at age 22. The IV models include background controls and factor scores. For exact formulations of the treatment effects, see Section 3. The
difference between TT and TUT is statistically, significantly different from 0 at the 5% level for the decision to graduate from college.
*
Significance level at p < 0.05.
**
Significance level at p < 0.01.

6.3. Are agents forward-looking?
When publicly available variables that are estimated to be
empirically important in determining later educational choices
are used as possible determinants of earlier educational choices,
they are all found to be statistically insignificant. For example,
two instruments that are found to be statistically significant in
determining the college enrollment decision – local college tuition
and the presence of a four-year college in the county – are found
to be statistically insignificant in determining the decision to
graduate from high school.67 This evidence is consistent either
with the claim that agents are not forward-looking or that agent
abilities to process publicly available information are weak.68 The
implicit assumption in many Bellman-equation-based models of
educational decisions and their consequences is thus called into
question.
6.4. Introducing colleges into localities: Interpreting what IV estimates
This section uses simulations from our model to decompose
LATE into its underlying components, as presented in Section 5.3
for the ordered model. The instrument that we use (availability
of college) only affects college enrollment decisions and not
high school enrollment decisions. So, it is meaningful to apply
the ordered model for the analysis we report here because it
characterizes transitions beyond high school graduation. Let S (z )
denote the final level of schooling selected when Z = z. As before,
qj is the years of schooling associated with attainment at node j.

67 See Heckman et al. (unpublished manuscript) for details.
68 Taber (2000) reports that for his estimated model, the presence of college in
the vicinity has no effect on college enrollment and has a similar discussion on why
the estimated effect is weak. Unlike our analysis, he constrains the effect of having
a college in the vicinity on high school graduation to be zero.

We consider a binary valued instrument (Z ∈ {z1 , z2 }) and assume
that S (z2 ) > S (z1 ).
As shown in Section 5.3, for the ordered case, LATE (Zj−1 , Zj )
includes the mean gain of going from j − 1 to j for people who
pass through j even though they may end up far above j and start
far below it. It may differ across j because the distributions of the
returns are different across conditioning sets and because of the
intrinsic nonlinearity in the returns.
Consider the college-in-county indicator used in the IV analysis
of Kling (2001). Let Z = z1 when no college is present in the county
and Z = z2 when a college is present.69 We assume this instrument
affects college enrollment and college graduation decisions.70 For
a binary instrument that affects only the final two educational
choices, three different sub-populations are affected: (1) those who
are induced to enroll in college but do not graduate; (2) those
induced to enroll in college and who go on to graduate; and (3)
those who previously enrolled in college and who would not have
graduated who are induced to graduate by the policy.
Simulating our model, we decompose the Wald estimator for
the effect of schooling on log wages into the expected gains at each
transition for each sub-population as well as the weights Wj , j =
2, . . . , s. LATE is not the return to any particular population at any
particular margin, but rather a weighted average of the returns to
a year of schooling for each of the affected sub-populations across
different transitions. It weights the expected gains differentially
and depends on which sub-populations are induced to change
schooling levels. Even if an instrument affects choice at only one
margin, individuals induced to change at that margin may still
go on to complete additional education, again making LATE a
weighted average of returns. Table 2 shows how the returns differ
by margin and sub-population. The sub-populations induced to

69 Oreopoulos and Salvanes (2011) present a summary of papers using presence
of a local college in a county as an instrument.
70 See Section 6.3 for discussion on why we do not allow the instrument to affect
the high school graduation decision.

290

J.J. Heckman et al. / Journal of Econometrics 191 (2016) 276–292

Table 2
Decomposing the LATE estimator of the effect of education on log wages.
Group

Return

S (z1 )
S (z1 )
S (z1 )
S (z1 )

E [Y2
E [Y2
E [Y3
E [Y3

= 1 , S (z 2 ) = 2
= 1 , S (z 2 ) = 3
= 1 , S (z 2 ) = 3
= 2 , S (z 2 ) = 3

Weight

− Y1 ] = 0.087
− Y1 ] = 0.084
− Y2 ] = 0.094
− Y2 ] = 0.119

W1,2
W1,3
W1,3
W2,3

= 0.289
= 0.204
= 0.341
= 0.166

∆qj

Avg yearly return

1.790
1.790
2.988
2.988

0.049
0.047
0.031
0.040

ρLATE = 0.041

Total =1

E [Y −Y

]

Notes: The LATE estimator is the weighted sum of returns. The ‘‘Normalized Return’’ is the average return per year of schooling for that specific sub-population ρj = (q j−q j−1) .
j
j−1
The Return column shows the expected return for the specific group defined in the Group column. ∆qj is the difference in the average number of years of schooling for
individuals transiting from j − 1 to j. Of those induced to change schooling levels by the instrument, 48.7% moved from high school graduate to some college, 34.5% moved
from high school graduate to college graduate, and 16.8% moved from some college to college graduate.
Table 3
Means of observables and endowments for groups that constitute the LATE decomposition.

Cognitive
Non-cognitive
Black
Hispanic
Broken home

Full
Sample

HS to some coll
(1 → 2)

HS to coll grad
(1 → 3)

Some coll to coll grad
(2 → 3)

0.001
(0.679)
0.001
(0.652)
0.117
(0.322)
0.067
(0.250)
0.241
(0.428)

−0.006

0.286
(0.579)
0.249
(0.566)
0.083
(0.275)
0.044
(0.204)
0.157
(0.364)

0.321
(0.570)
0.229
(0.567)
0.096
(0.295)
0.057
(0.231)
0.197
(0.397)

(0.605)
0.032
(0.596)
0.116
(0.320)
0.067
(0.250)
0.235
(0.424)

Notes: Mean coefficients; sd in parentheses.

switch by the change in the instrument differ substantially by
observable characteristics and in their average levels of cognitive
and non-cognitive endowments.
Table 3 shows how the average levels of cognitive and socioemotional endowments and other background characteristics
differ across the sub-populations induced to change final schooling
levels by the college introduction instrument. The columns show
the three different populations induced to switch by changing Z .71
6.5. Regret
Some individuals continue their education even though the
expected ex-post benefit is negative. This behavior is not ruled
out in our model as the agent decision rules are not required to
be based on realized gains. From our model, an estimated 18%
of high school dropouts would have enrolled in college if they
had graduated from high school (and received the cost shock
associated with completing high school) and 4% would have gone
on to complete four-year degrees. Similarly, if terminal high school
graduates were forced to enroll in college, an estimated 28% would
then choose to complete college.72 This analysis suggests that expost, many agents regret their early educational decisions.
7. Summary and conclusions
This paper develops and estimates a model of treatment
effects that arise in multi-stage decision models. It gives economic
content to the treatment effect literature without imposing
the sometimes controversial rationality and functional form
assumptions standard in the literature on dynamic discrete choice.

71 The presence of a college in the vicinity does not affect the high school
graduation decision (see Table F.1 of the Web Appendix for details). In Section G
of the Web Appendix, we create counterfactual simulations where the presence
of the local college variable enters into the high school graduation decision with
different counterfactual coefficients. Even for a large instrument, IV estimates on
the simulated data are far from the true AMTE or ATE.
72 See Table D.1 in the Web Appendix.

Identification of our model for both ordered and unordered
versions of the model can be obtained from multiple sources:
(a) instrumental variables, as is standard in the treatment effect
literature; (b) through conditional independence assumptions, as
is conventional in the dynamic discrete choice literature and also
in the literature on matching; or (c) through combinations of these
assumptions.
Our analysis expands the tool kit available to the applied
economist. We define new dynamic treatment effects and
decompose them into direct effects of forcing agents to move or
not to move to the immediate next stage of a dynamic decision
process, and the effects of continuing beyond the next stage. Our
ex-post continuation values approximate the ex-ante continuation
values of a structural dynamic discrete choice model. Using our
framework, we interpret what IV estimates in a dynamic multistage model. Due to the sequential nature of agent decision
making, instruments that affect only one argument of a multi-stage
decision model affect treatment effects and estimated transition
probabilities of all subsequent stages. We clarify the crucial role of
the implicit assumption of an ordered choice model that underlies
the LATE-inspired IV literature.
We estimate a model of educational choices on earnings for
a sample of American males, and use the estimated model to
generate a variety of economically interpretable treatment effects
and to compare them with the treatment effects reported in
the statistics literature. We find sharp discrepancies between
the treatment effects generated from the two approaches. In
our samples, LATE is a poor approximation of the economically
interpretable average marginal treatment effect. We use our model
to decompose the Wald estimator for a dynamic discrete choice
model into economically interpretable components and weights
on those components.
Contrary to a behavioral assumption maintained in the dynamic
discrete literature, we test for and do not find evidence of
forward-looking behavior. We find that ex-post, a large fraction of
agents would continue on to further education if forced to make
transitions at earlier stages.

J.J. Heckman et al. / Journal of Econometrics 191 (2016) 276–292

Appendix A. Supplementary data and analyses
Supplementary material related to this article can be found
online at http://dx.doi.org/10.1016/j.jeconom.2015.12.001.
References
Abbring, J.H., Heckman, J.J., 2007. Econometric evaluation of social programs,
part III: Distributional treatment effects, dynamic treatment effects, dynamic
discrete choice, and general equilibrium policy evaluation. In: Heckman, J.,
Leamer, E. (Eds.), Handbook of Econometrics, vol. 6B. Elsevier, Amsterdam,
pp. 5145–5303.
Adda, J., Cooper, R.W., 2003. Dynamic Economics: Quantitative Methods and
Applications. The MIT Press, Cambridge, Mass.
Aguirregabiria, V., 2010. Another look at the identification of dynamic discrete
decision processes: An application to retirement behavior. J. Bus. Econom.
Statist. 28 (2), 201–218.
Almlund, M., Duckworth, A., Heckman, J.J., Kautz, T., 2011. Personality psychology
and economics. In: Hanushek, E.A., Machin, S., Wößmann, L. (Eds.), Handbook
of the Economics of Education, vol. 4. Elsevier, Amsterdam, pp. 1–181.
Altonji, J.G., 1993. The demand for and return to education when education
outcomes are uncertain. J. Labor Econ. 11 (1), 48–83.
Anderson, T.W., Rubin, H., 1956. Statistical inference in factor analysis. In: Neyman, J. (Ed.), Proceedings of the Third Berkeley Symposium on Mathematical Statistics and Probability, vol. 5. University of California Press, Berkeley,
pp. 111–150.
Angrist, J.D., Imbens, G.W., 1995. Two-stage least squares estimation of average
causal effects in models with variable treatment intensity. J. Amer. Statist.
Assoc. 90 (430), 431–442.
Angrist, J.D., Pischke, J.-S., 2009. Mostly Harmless Econometrics: An Empiricist’s
Companion. Princeton University Press, Princeton.
Angrist, J.D., Pischke, J.-S., 2010. The credibility revolution in empirical economics:
How better research design is taking the con out of econometrics. J. Econ.
Perspect. 24 (2), 3–30.
Arcidiacono, P., Ellickson, P.B., 2011. Practical methods for estimation of dynamic
discrete choice models. Ann. Rev. Econ. 3 (1), 363–394.
Bartlett, M.S., 1937. The statistical conception of mental factors. Br. J. Psychol. 28
(1), 97–104.
Blevins, J.R., 2014. Nonparametric identification of dynamic decision processes with
discrete and continuous choices. Quant. Econ. 5 (3), 531–554.
Bonhomme, S., Robin, J.-M., 2009. Consistent noisy independent component
analysis. J. Econometrics 149 (1), 12–25.
Borghans, L., Duckworth, A.L., Heckman, J.J., ter Weel, B., 2008. The economics and
psychology of personality traits. J. Hum. Resour. 43 (4), 972–1059.
Cameron, S.V., Heckman, J.J., 1987. Son of CTM: The DCPA Approach Based on
Discrete and Factor Structure Models, University of Chicago, Department of
Economics (unpublished working paper).
Cameron, S.V., Heckman, J.J., 1993. The nonequivalence of high school equivalents.
J. Labor Econ. 11 (1, Part 1), 1–47.
Cameron, S.V., Heckman, J.J., 1998. Life cycle schooling and dynamic selection bias:
Models and evidence for five cohorts of American males. J. Polit. Econ. 106 (2),
262–333.
Cameron, S.V., Heckman, J.J., 2001. The dynamics of educational attainment for
black, hispanic, and white males. J. Polit. Econ. 109 (3), 455–499.
Card, D., 1999. The causal effect of education on earnings. In: Ashenfelter, O.,
Card, D. (Eds.), Handbook of Labor Economics, vol. 5. North-Holland, New York,
pp. 1801–1863.
Carneiro, P., Hansen, K., Heckman, J.J., 2003. Estimating distributions of treatment
effects with an application to the returns to schooling and measurement of the
effects of uncertainty on college choice. Internat. Econom. Rev. 44 (2), 361–422.
Carneiro, P., Heckman, J.J., Vytlacil, E.J., 2010. Evaluating marginal policy changes
and the average effect of treatment for individuals at the margin. Econometrica
78 (1), 377–394.
Carneiro, P., Heckman, J.J., Vytlacil, E.J., 2011. Estimating marginal returns to
education. Amer. Econ. Rev. 101 (6), 2754–2781.
Chamberlain, G., 1977. An instrumental variable interpretation of identification in
variance components and MIMIC models. In: Taubman, P. (Ed.), Kinometrics:
Determinants of Socioeconomic Success Within and Between Families. NorthHolland, New York.
Comay, Y., Melnik, A., Pollatschek, M.A., 1973. The option value of education and
the optimal path for investment in human capital. Internat. Econom. Rev. 14
(2), 421–435.
Cunha, F., Heckman, J.J., Navarro, S., 2007. The identification and economic content
of ordered choice models with stochastic cutoffs. Internat. Econom. Rev. 48 (4),
1273–1309.
Cunha, F., Heckman, J.J., Schennach, S.M., 2010. Estimating the technology of
cognitive and noncognitive skill formation. Econometrica 78 (3), 883–931.
Eckstein, Z., Wolpin, K.I., 1989. The specification and estimation of dynamic
stochastic discrete choice models: A survey. J. Hum. Resour. 24 (4), 562–598.
Eisenhauer, P., Heckman, J.J., Mosso, S., 2015a. Estimation of dynamic discrete
choice models by maximum likelihood and the simulated method of moments.
Internat. Econom. Rev. 56 (2), 331–357.

291

Eisenhauer, P., Heckman, J.J., Vytlacil, E.J., 2015b. Generalized Roy model and costbenefit analysis of social programs. J. Polit. Econ. 123 (2), 413–433.
Freyberger, J., 2014. Nonparametric Panel Data Models with Interactive Fixed
Effects. Department of Economics, University of Wisconsin, Madison.
Gensowski, M., 2014. Personality, IQ, and Lifetime Earnings, Discussion Paper 8235,
IZA.
Geweke, J., Keane, M., 2001. Computationally intensive methods for integration in
econometrics. In: Heckman, J.J., Leamer, E. (Eds.), Handbook of Econometrics,
vol. 5. North-Holland, New York, pp. 3463–3568.
Haavelmo, T., 1943. The statistical implications of a system of simultaneous
equations. Econometrica 11 (1), 1–12.
Hansen, L.P., Sargent, T.J., 1980. Formulating and estimating dynamic linear rational
expectations models. J. Econ. Dyn. Control 2 (1), 7–46.
Heckman, J.J., 1981. Statistical models for discrete panel data. In: Manski, C.,
McFadden, D. (Eds.), Structural Analysis of Discrete Data with Econometric
Applications. MIT Press, Cambridge, MA, pp. 114–178.
Heckman, J.J., 2008. The principles underlying evaluation estimators with an
application to matching. Ann. Econ. Stat. 91–92, 9–73.
Heckman, J.J., 2010. Building bridges between structural and program evaluation
approaches to evaluating policy. J. Econ. Lit. 48 (2), 356–398.
Heckman, J.J., Humphries, J.E., Kautz, T. (Eds.), 2014a. The Myth of Achievement
Tests: The GED and the Role of Character in American Life. University of Chicago
Press, Chicago.
Heckman, J.J., Humphries, J.E., Kautz, T., 2014b. Who are the GEDs? In: Heckman, J.J.,
Humphries, J.E., Kautz., T. (Eds.), The Myth of Achievement Tests: The GED and
the Role of Character in American Life. University of Chicago Press, Chicago,
pp. 139–170.
Heckman, J.J., Humphries, J.E., Veramendi, G., 2015. The Causal Effects of Education
on Earnings and Health. J. Polit. Econ., under revision.
Heckman, J.J., Kautz, T., 2014. Fostering and measuring skills: Interventions that
improve character and cognition. In: Heckman, J.J., Humphries, J.E., Kautz, T.
(Eds.), The Myth of Achievement Tests: The GED and the Role of Character in
American Life. University of Chicago Press, Chicago, pp. 341–430.
Heckman, J.J., Lochner, L.J., Todd, P.E., 2006. Earnings functions, rates of return
and treatment effects: The Mincer equation and beyond. In: Hanushek, E.A.,
Welch, F. (Eds.), Handbook of the Economics of Education, vol. 1. Elsevier,
Amsterdam, pp. 307–458 (Chapter 7).
Heckman, J.J., Navarro, S., 2007. Dynamic discrete choice and dynamic treatment
effects. J. Econometrics 136 (2), 341–396.
Heckman, J.J., Pinto, R., 2015a. Unordered Monotonicity, University of Chicago
(unpublished manuscript).
Heckman, J.J., Pinto, R., 2015b. Causal analysis after Haavelmo. Econometric Theory
31 (1), 115–151.
Heckman, J.J., Pinto, R., Savelyev, P.A., 2013. Understanding the mechanisms
through which an influential early childhood program boosted adult outcomes.
Amer. Econ. Rev. 103 (6), 1–35.
Heckman, J.J., Schennach, S.M., Williams, B., 2011. Matching on Proxy Variables,
University of Chicago, Department of Economics, Revised 2014.
Heckman, J.J., Smith, J.A., Clements, N., 1997. Making the most out of programme
evaluations and social experiments: Accounting for heterogeneity in programme impacts. Rev. Econom. Stud. 64 (4), 487–535.
Heckman, J.J., Urzúa, S., 2010. Comparing IV with structural models: What simple
IV can and cannot identify. J. Econometrics 156 (1), 27–37.
Heckman, J.J., Urzúa, S., Vytlacil, E.J., 2006. Understanding instrumental variables in
models with essential heterogeneity. Rev. Econ. Stat. 88 (3), 389–432.
Heckman, J.J., Urzúa, S., Vytlacil, E.J., 2008. Instrumental variables in models
with multiple outcomes: The general unordered case. Ann. Econ. Stat. 91–92,
151–174.
Heckman, J.J., Vytlacil, E.J., 1999. Local instrumental variables and latent variable
models for identifying and bounding treatment effects. Proc. Natl. Acad. Sci. 96
(8), 4730–4734.
Heckman, J.J., Vytlacil, E.J., 2005. Structural equations, treatment effects and
econometric policy evaluation. Econometrica 73 (3), 669–738.
Heckman, J.J., Vytlacil, E.J., 2007a. Econometric evaluation of social programs,
part I: Causal models, structural models and econometric policy evaluation.
In: Heckman, J.J., Leamer, E. (Eds.), Handbook of Econometrics, vol. 6B. Elsevier,
Amsterdam, pp. 4779–4874.
Heckman, J.J., Vytlacil, E.J., 2007b. Econometric evaluation of social programs,
part II: Using the marginal treatment effect to organize alternative economic
estimators to evaluate social programs and to forecast their effects in new
environments. In: Heckman, J.J., Leamer, E. (Eds.), Handbook of Econometrics,
vol. 6B. Elsevier, Amsterdam, pp. 4875–5143 (Chapter 71).
Hu, Y., Schennach, S.M., 2008. Instrumental variable treatment of nonclassical
measurement error models. Econometrica 76 (1), 195–216.
Imbens, G.W., Angrist, J.D., 1994. Identification and estimation of local average
treatment effects. Econometrica 62 (2), 467–475.
Kautz, T., Zanoni, W., 2015. Measuring and Fostering Non-Cognitive Skills in
Adolescents: Evidence from Chicago Public Schools and the OneGoal Program,
University of Chicago, Department of Economics (unpublished manuscript).
Keane, M.P., Todd, P.E., Wolpin, K.I., 2011. The Structural Estimation of Behavioral
Models: Discrete Choice Dynamic Programming Methods and Applications.
In: Handbook of Labor Economics, vol. 4. Elsevier.
Keane, M.P., Wolpin, K.I., 1997. The career decisions of Young Men. J. Polit. Econ.
105 (3), 473–522.
Kling, J.R., 2001. Interpreting instrumental variables estimates of the returns to
schooling. J. Bus. Econom. Statist. 19 (3), 358–364.

292

J.J. Heckman et al. / Journal of Econometrics 191 (2016) 276–292

Laibson, D., 2003. Intertemporal decision making. In: Nadel., L. (Ed.), Encyclopedia
of Cognitive Science. Nature Publishing Group, London.
Lewbel, A., 2000. Semiparametric qualitative response model estimation with
unknown heteroscedasticity or instrumental variables. J. Econometrics 97 (1),
145–177.
Lochner, L., 2011. Nonproduction benefits of education: Crime, health, and good
citizenship. In: Hanushek, E.A., Machin, S., Woessmann, L. (Eds.), Handbook of
the Economics of Education, vol. 4. North-Holland, Amsterdam, pp. 183–282.
Madansky, A., 1964. Instrumental variables in factor analysis. Psychometrika 29 (2),
105–113.
Magnac, T., Thesmar, D., 2002. Identifying dynamic discrete decision processes.
Econometrica 70 (2), 801–816.
Matzkin, R.L., 1994. Restrictions of economic theory in nonparametric methods.
In: Engle, R., McFadden, D. (Eds.), Handbook of Econometrics, vol. 4. NorthHolland, New York, pp. 2523–2558.
McMahon, W.W., 2014. The Total Return to Higher Education: Is There Underinvestment for Development?, University of Illinois at Urbana-Champaign.
Mincer, J., 1974. Schooling, Experience and Earnings. Columbia University Press for
National Bureau of Economic Research, New York.
Murphy, S.A., 2003. Optimal dynamic treatment regimes. J. R. Stat. Soc. Ser. B Stat.
Methodol. 65 (2), 331–355.
Oreopoulos, P., Salvanes, K.G., 2011. Priceless: The nonpecuniary benefits of
schooling. J. Econ. Perspect. 25 (1), 159–184.
Pagan, A., Ullah, A., 1999. Nonparametric Econometrics. Cambridge University
Press, Cambridge, UK.
Pudney, S.E., 1982. Estimating latent variable systems when specification is
uncertain: Generalized component analysis and the eliminant method. J. Amer.
Statist. Assoc. 77 (380), 883–889.
Quandt, R.E., 1958. The estimation of the parameters of a linear regression
system obeying two separate regimes. J. Amer. Statist. Assoc. 53 (284),
873–880.
Quandt, R.E., 1972. A new approach to estimating switching regressions. J. Amer.
Statist. Assoc. 67 (338), 306–310.

Rosenbaum, P.R., Rubin, D.B., 1983. The central role of the propensity score in
observational studies for causal effects. Biometrika 70 (1), 41–55.
Rust, J., 1994. Structural estimation of Markov decision processes. In: Engle, R.,
McFadden, D. (Eds.), Handbook of Econometrics. North-Holland, New York,
pp. 3081–3143.
Schennach, S., 2013. Measurement error in nonlinear models—a review. In: Acemoglu, D., Arellano, M., Dekel, E. (Eds.), Advances in Economics and Econometrics: Theory and Applications, Tenth World Congress, vol. 3. Cambridge University Press, New York.
Schennach, S., White, H., Chalak, K., 2012. Local indirect least squares and average
marginal effects in nonseparable structural systems. J. Econometrics 166 (2),
282–302.
Skrondal, A., Laake, P., 2001. Regression among factor scores. Psychometrika 66 (4),
563–576.
Steinberg, L., 2014. Age of Opportunity: Lessons from the New Science of
Adolescence. Eamon Dolan/Houghton Mifflin Harcourt, New York.
Taber, C.R., 2000. Semiparametric identification and heterogeneity in discrete
choice dynamic programming models. J. Econometrics 96 (2), 201–229.
Vytlacil, E.J., 2002. Independence, monotonicity, and latent index models: An
equivalence result. Econometrica 70 (1), 331–341.
Vytlacil, E.J., 2006a. A note on additive separability and latent index models
of binary choice: Representation results. Oxf. Bull. Econ. Stat. 68 (4),
515–518.
Vytlacil, E.J., 2006b. Ordered discrete-choice selection models and local average
treatment effect assumptions: Equivalence, nonequivalence, and representation results. Rev. Econ. Stat. 88 (3), 578–581.
Weisbrod, B.A., 1962. Education and investment in human capital. J. Polit. Econ. 70
(5, Part 2: Investment in Human Beings), 106–123.
White, H., Chalak, K., 2009. Settable systems: An extension of Pearl’s causal
model with optimization, equilibrium, and learning. J. Mach. Learn. Res. 10,
1759–1799.
Williams, B., 2012. Identification of Factor Models. Department of Economics,
University of Chicago.

