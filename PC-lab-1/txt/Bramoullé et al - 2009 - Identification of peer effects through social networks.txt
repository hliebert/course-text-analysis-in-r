Journal of Econometrics 150 (2009) 41–55

Contents lists available at ScienceDirect

Journal of Econometrics
journal homepage: www.elsevier.com/locate/jeconom

Identification of peer effects through social networks
Yann Bramoullé, Habiba Djebbari, Bernard Fortin ∗
CIRPÉE, Université Laval, Canada
Department of Economics, Université Laval, Canada

article

info

Article history:
Received 5 December 2007
Received in revised form
3 November 2008
Accepted 23 December 2008
Available online 10 February 2009
JEL classification:
D85
L14
Z13
C3
Keywords:
Social network
Peer effects
Identification
Add Health dataset

a b s t r a c t
We provide new results regarding the identification of peer effects. We consider an extended version of
the linear-in-means model where interactions are structured through a social network. We assume that
correlated unobservables are either absent, or treated as network fixed effects. We provide easy-to-check
necessary and sufficient conditions for identification. We show that endogenous and exogenous effects
are generally identified under network interaction, although identification may fail for some particular
structures. We use data from the Add Health survey to provide an empirical application of our results
on the consumption of recreational services (e.g., participation in artistic, sports and social activities) by
secondary school students. Monte Carlo simulations calibrated on this application provide an analysis
of the effects of some crucial characteristics of a network (i.e., density, intransitivity) on the estimates
of peer effects. Our approach generalizes a number of previous results due to Manski [Manski, C., 1993.
Identification of endogenous social effects: The reflection problem. Review of Economic Studies 60 (3),
531–542], Moffitt [Moffitt, R., 2001. Policy interventions low-level equilibria, and social interactions. In:
Durlauf, Steven, Young, Peyton (Eds.), Social Dynamics. MIT Press] and Lee [Lee, L.F., 2007. Identification
and estimation of econometric models with group interactions, contextual factors and fixed effects.
Journal of Econometrics 140 (2), 333–374].
© 2009 Elsevier B.V. All rights reserved.

1. Introduction
In recent years, studies on peer effects have literally exploded.
They have been applied to topics as diverse as criminal activity
(e.g., Glaeser et al. (1996)), welfare participation (Bertrand et al.,
2000), school achievement (e.g., Sacerdote (2001)), participation in
retirement plans (Saez and Duflo, 2003), and obesity (e.g., Trogdon
et al. (2008)).
One key challenge for the empirical literature on peer effects
is to identify what drives the correlation between outcomes of
individuals who interact together (see Blume and Durlauf (2005)
and Soetevent (2006) for recent surveys). In a pioneer study,
Manski (1993) distinguishes between exogenous (or contextual)
effects, i.e., the influence of exogenous peer characteristics,
endogenous effects, i.e., the influence of peer outcomes, and
correlated effects, i.e., individuals in the same reference group tend
to behave similarly because they are alike or face a common
environment.

∗

Corresponding address: Department of Economics, Pavillon J.A. De Sève, 1025
Ave des Sciences - Humaines, Laval University, Quebec, Canada G1V 0A6. Tel.: +1
418 656 5678.
E-mail address: bernard.fortin@ecn.ulaval.ca (B. Fortin).
0304-4076/$ – see front matter © 2009 Elsevier B.V. All rights reserved.
doi:10.1016/j.jeconom.2008.12.021

Manski shows that two main identification problems arise in
the context of a linear-in-means model.1 First, it is difficult to
distinguish real social effects (endogenous + exogenous) from
correlated effects.2 Second, even in the absence of correlated
effects, simultaneity in behavior of interacting agents introduces
a perfect collinearity between the expected mean outcome of the
group and its mean characteristics. This reflection problem hinders

1 In the linear-in-means model, the outcome of each individual depends linearly
on his own characteristics, on the mean outcome of his reference group and on
its mean characteristics. Most papers on social interactions have considered the
linear-in-means model since it is naturally related to the standard simultaneous
linear model (Moffitt, 2001). Notable exceptions are Brock and Durlauf (2001a,
2003) that exploit non-linearities emerging from discrete choice models to identify
endogenous from exogenous effects under the assumption of no correlated effects,
and Krauth (2006) and Brock and Durlauf (2007) that extent Brock and Durlauf
(2001a) to account for correlated effects. Brock and Durlauf (2001b) provide
a careful analysis of identification in both linear-in-means and discrete choice
models.
2 A number of studies have notably addressed this problem by exploiting data
where individuals are randomly assigned to groups (removing any correlated
effects), e.g., Sacerdote (2001) and Zimmerman (2003), by imposing exclusion
restrictions on the structural model, e.g., Evans et al. (1992) and Graham and Hahn
(2005), or by introducing variance restrictions on the error terms (Graham, 2008).
In the latter case, the basic identifying assumption is that the variance matrix
parameters are independent of the reference group size.

42

Y. Bramoullé et al. / Journal of Econometrics 150 (2009) 41–55

the identification of the endogenous effect from the exogenous
effects.3
One basic assumption that is usually made in the linear-inmeans model, as well as in most peer effects models, is that
individuals interact in groups. This means that the population is
partitioned in groups, and that individuals are affected by all
others in their group and by none outside of it. This type of
interaction pattern is very particular and is not likely to represent
most forms of relationship between individuals. Indeed, there is
increasing recognition among economists in general of the role
played by social network in structuring interactions among agents.
A social network is a social structure made of nodes (which are
generally individuals or organizations) that are tied by one or
more specific types of interdependency, such as friendship, values,
beliefs, conflict or trade. The resulting graph-based structures are
often very complex. The analysis of social networks has been
first developed by sociologists and has become a central field
of research in sociology (e.g., Wasserman and Faust (1994) and
Freeman (2004)). In economics, a growing body of theoretical
work explores how individual incentives give rise to networks
and, in turn, can be shaped by them (e.g., Jackson (2006)). At
the empirical level, a few recent studies, including the present
one, exploit datasets possessing rich information on relationships
between agents in order to provide cleaner evidence on social
effects.4 It is thus natural to analyze the problem of identification
under more general assumptions.
Our approach is inspired from the literature in spatial
econometrics (e.g., Case (1991) and Anselin et al. (2004)). We
consider an extended version of the linear-in-means model where
each individual has his own specific reference group, defined by
the individuals whose mean outcome and characteristics influence
his own outcome. Interactions are thus structured through a
directed social network.5 We show that relaxing the assumption of
group interactions generally permits to separate endogenous and
exogenous effects. Therefore, the second negative result of Manski
(1993) is not robust to reference group heterogeneity.
Our main objective is to characterize the networks for which
endogenous and exogenous effects are identifiable. We determine
these structures both in the absence of correlated effects and
when controlling for correlated effects in the form of network
fixed effects. In both cases, we provide easy-to-check necessary
and sufficient conditions for identification. When there are no
correlated effects, we show that endogenous and exogenous effects
are identified as soon as individuals do not interact in groups.6
Thus, even the slightest departure from a groupwise structure is
sufficient to obtain identification.
When correlated effects are present at the network level, it is
natural to take them out through a within transformation similar
to the one used in linear panel data models. However many
transformations can be used for this purpose. We focus on two

3 Empirical studies have addressed this issue in many ways: for instance by
assuming that only one type of social effect exists (endogenous or exogenous),
e.g.,Gaviria and Raphael (2001) and Trogdon et al. (2008), or by assuming that there
exists an individual characteristic whose group-level analog does not play the role
of a contextual variable, e.g.,Ioannides and Zabel (2003). These assumptions are
often ad hoc and in any case cannot be tested when the model is exactly identified.
4 Dercon and De Weerdt (2006) study the network of risk-sharing relationships
between households in a Tanzanian village. Conley and Udry (2005) look at how
communication networks among farmers affect the adoption of a new technology.
Goyal et al. (2006) analyze the network of coauthorships among economists.
Calvó-Armengol et al. (2005) and Lin (2007) study the Add Health dataset and
friendship networks among adolescents.
5 In a directed social network, the direction of influence from one node to another
is taken into account. Any direction is disregarded in an undirected social network.
6 We also show that they may be identified under group interactions. See our
discussion on Lee (2007) below.

of them: the local transformation which expresses the model in
deviation from the mean equation of the individual’s neighbors
and the global transformation which expresses it in deviation from
the individual’s network. We show that the global transformation
is the one which imposes less restrictive conditions to obtain
identification. Whatever the transformation used, degrees of
freedom are lost, and identification now fails on some networks,
such as the star. We still find that endogenous and exogenous
effects can be distinguished on most networks.
Our analysis admits as special cases several models studied in
the literature, among which Manski (1993), Moffitt (2001) and Lee
(2007). These authors analyze different versions of the standard
model with group interactions. For our purposes, Manski’s model
has the same properties as one where the individual is included
when computing the mean of his group.7 In this case, peer effects
are not identified. In Moffitt’s model, the individual is excluded
from the mean and all groups have the same size. Peer effects are
also not identified. In contrast, Lee’s model considers interactions
in groups with different sizes, and the individual is also excluded
from the mean. He finds that variations in group sizes can yield
identification. We show that these three results directly follow
from our general conditions.
Our paper advances the methodology of the empirical estimation of peer effects. We provide a theoretical foundation behind
a few recent attempts at identifying and estimating social effects
(Laschever, 2005; De Georgi et al., 2007; Lin, 2007). Laschever
(2005) applies a model of social interactions with multiple reference groups to the likelihood of post-war employment of World
War I veterans.8 De Georgi et al. (2007) also make use of multiple
groups to identify peer effects in the educational choices of college
students. As shown in this paper, a multiple reference group structure is only one of many structures of interaction for which social
effects can be identified. Lin (2007) uses detailed data on friendship links to estimate peers’ influence on students’ outcomes. She
can obtain separate estimates for endogenous and exogenous effects only because the friendship networks in her dataset satisfy
our general identification conditions.
While our theoretical setting is perfectly general, we use a
running empirical application to illustrate the basic concepts
and motivate our results. Consider the consumption by a
secondary school student of recreational activities such as
participation in artistic, sports and social organizations and clubs.
His recreational activities are assumed to depend not only on his
own characteristics (e.g., age, gender, family background), but also
on his friends’ mean characteristics (exogenous social effect) and
their mean recreational activities (endogenous social effect). The
latter effect may reflect conformity or simply the pleasure for the
student to participate in recreational activities with friends who
also participate in such activities. Moreover, the more (and the
better) artistic, sports and social clubs are available in a school, the
more likely students from this school will consume recreational
activities (correlated effects).
While theoretically identified, a social interaction model can
suffer from weak identification in practice. We investigate this

7 More precisely, Manski develops a linear-in-expectations model, where the
individual’s outcome depends on the outcome expectation of his group and social
equilibrium is assumed.
8 While Laschever’s model is somewhat different from ours, the reason for
identification is similar. Especially, an individual may belong to more than one
reference group. In contrast, Cohen-Cole (2006) studies a context where groups
are mutually exclusive. He allows for both within and between-group endogenous
effects. He shows that identification usually holds in the presence of betweengroup exogenous effects. In future research, it could be interesting to generalize our
approach to a setting where different social networks can simultaneously affect an
individual’s behavior.

Y. Bramoullé et al. / Journal of Econometrics 150 (2009) 41–55

issue using both real data and Monte Carlo simulations. Using
Add Health dataset,9 we provide estimation results on recreational
activities by secondary school students when it is assumed that
each individual’s reference group is given by his best friends
at school, as self-reported in the questionnaire. Our results
show that the mean recreational activities by his friends have
a positive and significant influence on a student’s recreational
activities. Moreover, some friends’ characteristics such as their
mean parents’ participation in the labor market positively (and
significantly) affect a student’s recreational activities. Using the
estimated parameters, we calibrate the model in order to perform
Monte Carlo simulations. We analyze the effects of important
characteristics of a network, such as its density and its level
of intransitivity (defined below), on the quality of peer effects
estimates.
The rest of the paper is organized as follows. Section 2 presents
our basic linear-in-means model. It also provides a simple example
inspired from panel data literature to illustrate that the presence
of intransitivity in the network may help to identify the peer
effects. Our general identification results are then presented and
discussed. Section 3 addresses correlated effects in the form of
network fixed effects. Section 4 presents our estimation results on
recreational activities and Section 5 our Monte Carlo simulations.
A brief discussion concludes.
2. Social effects and social networks
2.1. The basic model
Our presentation closely follows our empirical application
on consumption of recreational services by secondary school
students. Our model is an extension of the standard linear-inmeans social interaction model in which we allow for studentspecific friends’ groups. Vectors are denoted with bold lower
case letters and matrices with bold capital letters. Suppose we
have a set of students i, (i = 1, . . . , n). Let yi be the level of
recreational activities by student i. Let xi be a 1 × K vector of
characteristics of i. For simplicity, we present the model with a
unique characteristic (K = 1), that is, family background (e.g.,
parents’ income). Results hold with any number of them (see
the appendices for more details). Our main new assumption is
as follows. Each student i may have a specific peers’ group Pi of
size ni . This reference group (known by the modeler) contains all
students whose recreational activities or family background may
affect i’s recreational activities. Except where otherwise specified,
we assume that student i is excluded from his reference group, that
is, i 6∈ Pi . This corresponds to the usual empirical formulation (e.g.,
Sacerdote (2001), and Soetevent and Kooreman (2007)). A student
is isolated if his friends’ group is empty.10 We assume that not
all students are isolated. The collection of student-specific friends’
groups defines a directed network between students.
Our results are consistent with two types of observations. First,
they hold if we observe an i.i.d. sample of size L from a population
of networks with a fixed and known structure.11 Alternatively, they
hold if we observe an i.i.d. sample from a population of networks
with a stochastic but strictly exogenous structure. For notational

43

simplicity, our results are presented for a fixed network; they can
be easily adapted to the latter case (see discussion below). Also,
to focus on the population model, we omit for the moment the
network observation index l, (l = 1, . . . , L).
We do not change any other assumption of the standard
model (see Moffitt (2001)). Especially, we assume that a student’s
recreational activities may be affected by the mean recreational
activities of his friends’ group, by his family background, and by
the mean family background of his friends’ group. Formally, the
structural model is given by:

P
yi = α + β

j∈Pi

ni

P

yj

+ γ xi + δ

xj

j∈Pi

ni

+ i ,

E[i | x] = 0,

where β captures the endogenous effect and δ the exogenous
effect. It is standard to require that |β| < 1. Except for this
restriction, our model does not impose any other constraints on
the parameters. The error term i reflects unobservable (to the
modeler) characteristics associated with i. In this section, we
assume the strict exogeneity of the regressors, that is, E[i | x] = 0,
where x is an n × 1 vector of family background. Thus we assume
no correlated effects. This assumption is relaxed in Section 3. We
make no further assumption on the error terms within a network.
Especially, they are not necessarily i.i.d. or normally distributed.12
Therefore our model is semiparametric, or ‘‘distribution-free’’.
We finally write the structural model in matrix notation. Our
model is of the form
y = αι + β Gy + γ x + δ Gx + ,

E[ | x] = 0,

(1)

where y is an n × 1 vector of recreational activities for the l
network, G is an n × n interaction matrix with Gij = 1/ni if j
is a friend of i, and 0 otherwise,13 and ι is an n × 1 vector of
ones. The variance matrix of the error terms is assumed to be
unrestricted and therefore contains no identifying information.
In particular, we do not impose homoskedasticity. We assume
throughout that the expected outer product of (ι, x) has full rank.
Note also that the systematic part of (1) is similar to that of a spatial
autoregressive (SAR) model (e.g., Cliff and Ord (1981)) extended to
allow for exogenous effects.14 It is also an extension of Lee’s (2007)
model since, in its general version, it does not impose that students
interact in groups.
The main result of the paper is to show that θ = (α, β, γ , δ)
is identified given the moment restriction E[ | x] = 0 and
restrictions on G. We relate in particular Manski’s (1993) and
Moffitt’s (2001) non-identification and Lee’s (2007) identification
results to their maintained assumptions on the form of G.

12 This structural model can be derived from a choice-theoretic approach
where each individual i chooses his outcome in order to maximize a quadratic
utility function depending on his outcome and on his reference group’s mean
expected outcome and mean characteristics. This approach also assumes that social
interactions have reached a noncooperative (Nash) equilibrium at which expected
outcomes are realized.
13 More generally, G could capture the strength of the interaction between i and
ij

9 The National Longitudinal Study of Adolescent Health (Add Health) is a schoolbased panel study of a nationally-representative sample of adolescents in grades
7–12 in the United States in 1994–95. A full description of the sample design, data,
and documentation is available at: http://www.cpc.unc.edu/projects/addhealth.
10 While an isolated individual is not affected by others, he may still affect others.
11 This may include the case where one observes the same network of students at
different points in time as long as the sample of observations on networks can be
considered as i.i.d.

j, and decrease with social, or geographic, distance. Some of our results hold for
arbitrary G, others for matrices that are row-normalized.
14 A standard spatial autoregressive (SAR) model consists of a spatially lagged

version of the dependent variable y with regressors X: y = β Gy + X γ + , where
G is a predetermined spatial weighting matrix and where β and γ are parameters
to be estimated. The error  may also have a SAR structure. For instance, such a
model could be used to estimate the unemployment rate in State i as a weighted
linear function of the unemployment rates in States geographically close to i and
additional explanatory variables.

44

Y. Bramoullé et al. / Journal of Econometrics 150 (2009) 41–55

2.2. A simple example

2.3. Reduced form and identification

The main intuition for our results can be conveyed through a
simple example.15 In addition, this example illustrates the formal
similarity with panel data econometrics. Consider a network of
students in infinite number arrayed on a line with each student
being influenced only by his left-hand friend in his choice of
recreational activities. The matrix G takes the following specific
form:
1,
0,


Gij =

j=i−1
j 6= i − 1

which leads to the following structural model:
yi = α + β yi−1 + γ xi + δ xi−1 + i ,

E[i | x−∞ , . . . , x∞ ] = 0.

(2)

Therefore, using the panel data model terminology, lags of xi
may be used as instruments for yi−1 even if i is serially correlated
of unspecified form in (2). This captures the intuition that the
characteristics of the friends’ friends of a student who are not his
friends may serve as instruments for the actions of his own friends.
Note that it is formally similar to the observation first made by
Chamberlain (1984) that strictly exogenous regressors can be used
to distinguish true state dependence (i.e., the value of β ) from
correlated heterogeneity in the linear panel data model.
This example illustrates the case of a network in which we can
find intransitive triads. These are sets of three students i, j, k such
that i is affected by j and j is affected by k (that is, a triad), but i is
not affected by k. Here, i, j, k forms an intransitive triad for any i
when j = i − 1 and k = i − 2, since i is not directly affected by
i − 2. We will show below that the presence of intransitive triads
is a sufficient (but not necessary) condition for the identification of
social effects in the absence of correlated effects.
Now consider the case where there may be network fixed
effects potentially correlated with the family background of
students. Indexing networks by l, assuming that the xli ’s are
strictly exogenous conditional on αl , and maintaining our other
assumptions, we have
yli = αl + β yli−1 + γ xli + δ xli−1 + li ,

E[li | x−l∞ , . . . , xl∞ , αl ] = 0.

(3)

Define 1zli = zli − zli−1 , for z = y, x,  . Then differencing (3) gives

1yli = β 1yli−1 + γ 1xli + δ 1xli−1 + 1li .
Hence, one has

E[1li | 1xl−∞ , . . . , 1xl∞ ] = 0.

(4)

Therefore, lags (1xli−2 , . . . , 1xl−∞ ) can be used as valid identifying instruments. From (4), and for all j and i, moment restrictions
of the form

E[1xlj (1yli − β 1yli−1 − γ 1xli − δ 1xli−1 )] = 0
are valid. The model thus generates internal conditions that
ensure identification of social effects in spite of serial correlation
of unspecified form and the endogeneity of lagged y. This is
essentially Chamberlain’s (1984) result for dynamic panel data
models with regressors strictly exogenous conditional on the fixed
effect. In the remaining part of the paper, we extend this example
to arbitrary networks.

15 We thank a referee for having suggested this example to us.

We now write the restricted reduced form of model (1). Since

|β| < 1, I − β G is invertible.16 We can write:

y = α(I − β G)−1 ι + (I − β G)−1 (γ I + δ G)x + (I − β G)−1 ,

(5)

where the intercept is simply α/(1 − β) if the student is not
isolated, and α otherwise.
We say that social effects are identified if and only if the
vector θ of structural parameters can be uniquely recovered
from the unrestricted reduced-form parameters in (5) (injective
relationship). Our identification results are asymptotic in nature
(see Manski (1995)). They characterize when social effects can, or
cannot, be disentangled if we are not limited in the number of
observations we can obtain.
It will be useful in
following to use a series expansion of (5).
Pthe
∞
k k
Since (I − β G)−1 =
k=0 β G and assuming no isolated students,
one has:
y = α/(1 − β)ι + γ x + (γ β + δ)

∞
X

β k Gk+1 x +

∞
X

β k Gk . (6)

k =0

k=0

Moreover, from (6), the expected mean friends’ groups’
recreational activities conditional on x can be written as:

E(Gy | x) = α/(1 − β)ι + γ Gx + (γ β + δ)

∞
X

β k Gk+2 x.

(7)

k=0

The remainder of the paper clarifies the conditions under which
identification holds under network interaction.
2.4. Results
Our first result shows that identification is related to a simple
property of the matrix G.
Proposition 1. Suppose that γ β + δ 6= 0. If the matrices I, G, and
G2 are linearly independent social effects are identified. If the matrices
I, G, and G2 are linearly dependent and no individual is isolated, social
effects are not identified.
It is worth noting that the first part of this result holds even if
Eq. (1) is written with an arbitrary matrix G, while the second part
holds as soon as G is row-normalized.17
The condition γ β + δ 6= 0 is natural in this setting. As
shown in (6), it means that family background of friends has some
(direct and/or indirect) effect on a student’s expected recreational
activities. When it is violated, endogenous and exogenous effects
are zero or exactly cancel out, and social effects are absent from the
reduced form. The condition is satisfied as soon as γ and δ have the
same sign, β > 0 and γ 6= 0. With several characteristics, it must
be satisfied for at least one of them.
Proposition 1 can be given a natural interpretation in terms of
instrumental variables. We show (see Appendix B) that when no
student is isolated, the matrices I, G, and G2 are linearly dependent
if and only if E(Gy|x) is perfectly collinear with (ι, x, Gx). This
perfect collinearity means that we cannot find a valid identifying
instrument for Gy in the structural equation (1). In contrast,
when E(Gy|x) is not perfectly collinear with the regressors, the
restrictions imposed by the network structure allow the model to

16 See Case (1991), footnote 5.
17 One easy way to check whether these three matrices are linearly independent
is the following. First, vectorize each matrix, that is, stack its columns on top of
each other. Second, verify whether the matrix formed by concatening these stacked
vectors has rank three.

Y. Bramoullé et al. / Journal of Econometrics 150 (2009) 41–55

be identified. From (7), it is clear that the variables (G2 x, G3 x, . . .)
can be used as identifying instruments and therefore can be used
to consistently estimate the parameters.18 In our application, these
instruments have a socioeconomic interpretation. For instance,
G2 x represents an n × 1 vector of weighted averages of family
background of the friends’ friends of each student in the network.
Here an important remark is in order. Up to now, we have
assumed that we observe an i.i.d. sample of (yl , xl ) of size L (l =
1, . . . , L) from a population of networks with a fixed and known
structure (matrix G non-stochastic). Alternatively suppose that we
observe an i.i.d. sample of (yl , xl , Gl ) of size L, where the matrices
Gl are now stochastic but strictly exogenous, which means that
E[l | xl , Gl ] = 0. Form a large network G by combining the
different matrices: add any network Gl in support of the network’s
distribution as a diagonal block of the large network. Then, we can
directly apply Proposition 1 to the network G. This is the case, since
for identification purposes, the size of the sample can be as large as
needed. Propositions 4 and 6 below can be generalized in a similar
way.
2.4.1. Group interactions
In this section, we apply Proposition 1 to analyze identification
when students interact in groups. We focus particularly on models
developed by Manski (1993), Moffitt (2001) and Lee (2007).
2.4.1.1. Non-identification in Manski’s (1993) model. Let us first
show how Proposition 1 covers Manski’s first negative result
discussed in the introduction. Suppose that students interact in
groups (e.g., their classroom), and also that the student is included
when computing the mean. That is, there is a partition of the
population in subsets G1 , . . . , Gm such that for any i ∈ Gl , Pi =
Gl . This means that students are affected by all others in their
classroom and by none outside of it. In this case, G is block diagonal
with G2 = G. The second part of Proposition 1 applies. From (7),
the expected mean recreational activities of the friends’ groups,
E(Gy|x), is given by α/(1 − β)ι + (γ + δ)/(1 − β)Gx and is
therefore perfectly collinear with the mean family background of
the group. Therefore, the list of valid instruments is limited to
(ι, x, Gx). In this model, no matter the group sizes, social effects are
not identified. The interpretation of this result is simple. As long
as students interact in groups (including themselves), the mean
family background of their friends is also equal to the mean family
background of their friends’ friends (G2 x = Gx). In that case there
is no identifying instrument for the mean recreational activities of
students’ friends.
2.4.1.2. Non-identification in Moffitt’s (2001) model. Alternatively,
suppose, as in Moffitt (2001), that students interact in groups, that
groups have the same size s, and that the student is excluded when
computing the mean. Denote 0s as the interaction matrix within a
group. One has Γs,ij = 1/(s − 1) if i 6= j and 0 otherwise. Again,
the matrix G is block diagonal but this time with diagonal blocks
−2
given by 0s . It is easy to see that G2 = s−1 1 I + ss−
G if s ≥ 2, and
1
the second part of Proposition 1 again applies. Social effects are not
identified.
2.4.1.3. Identification in Lee’s (2007) model. Assume now that
students interact in groups of different sizes. Assume also, with no
loss of generality, that there are two groups and that these groups

45

have sizes s1 and s2 with s1 , s2 ≥ 2. The interaction matrix G can
be written as follows


G=

0s1
0

0



0s 2

Suppose that G2 = λ0 I + λ1 G.19 The diagonal elements give λ0 =
1/(s1 − 1) = 1/(s2 − 1), hence s1 = s2 . Therefore, if s1 6= s2 ,
the matrices I, G, and G2 are linearly independent, the first part of
Proposition 1 applies. Moreover, using Eq. (7), one can easily show
that E(Gy|x) = α/(1 −β)ι+ b0 x + b1 Gx + b2 G2 x, with b2 6= 0 when
β 6= 0 and γ β +δ 6= 0.20 Therefore, the variable G2 x can be used as
a valid instrument for Gy. In this model, social effects are identified.
This result is related to Lee’s (2007) model in the absence of group
fixed effects.
Proposition 2. Suppose that individuals interact in groups. If all
groups have the same size, social effects are not identified. If (at least)
two groups have different sizes, and if γ β + δ 6= 0, social effects are
identified.
Identification arises thanks to the effects of the classroom size
on reduced-form coefficients within each classroom. After some
manipulations, Eq. (5) can be rewritten as follows:
yi =



α
β(γ β + δ)
+ γ+
xi
1−β
(1 − β)(sg − 1 + β)
+

γβ + δ

 x̄i + νi ,
(1 − β) 1 + sgβ−1

(8)

where sg is the size of i’s classroom, and x̄i is the mean family
background over all other students in the classroom and νi is
the error term. Variation of reduced-form coefficients across
classrooms of different size allows us to identify the structural
model. The impact of sg on these coefficients has an intuitive
interpretation. The size of classrooms (sg , for g = 1, 2, . . . , M)
varies within the network. Consider first the reduced-form
coefficient on xi in (8). It is the sum of a direct and an indirect
effect. The direct effect is simply equal to γ , and captures the
effect of i’s family background on i’s recreational activities. This
effect is already present in the structural model. The indirect effect
arises through feedback effects: when j and k belong to i’s group,
xi affects j’s recreational activities (=yj ), which in turn, affects i’s
recreational activities (=yi ).21 The indirect effect decreases with
sg , and become negligible as sg tends to infinity. This reflects the
diminishing role that i plays, by himself, in determining other
students’ recreational activities when the size of the classroom
grows. For a similar reason, the reduced-form coefficient on the
mean family background of i’s friends, x̄i , is increasing in the size
of the classroom. As the role played by one student decreases, the
mean family background of all the others become more important.
Thus, variations in group sizes create exogenous variations
in the reduced-form coefficients across groups that lead to
identification. Interestingly, Davezies et al. (2006) have shown that
Lee’s model is generically identified, even when all members in
the classroom are not observed. Observe finally that, in this model,
social effects may be identified when the individual is excluded in
the computation of the group mean, but not when he is included.

19 Observe that, since at least one individual is not isolated, the matrices I and G
are linearly independent.
20 After few manipulations, one obtains: b = [(γ β + δ)β]/(1 − λ β − λ β 2 −
2

18 One can show that the potential number of instruments cannot exceed a
critical level smaller than or equal to the number of individuals in the network.
Overidentification tests such as the one suggested by Lee (2003) for a SAR model
could be implemented.

λ0 β 3 ), where λ0 =

1

(s1 −1)(s2 −1)

, λ1 =

s1 +s2 −3
,
(s1 −1)(s2 −1)

and λ2 =

2
s1 s2−2 (s1 +s2 )+3
(s1 −1)(s2 −1)

1

.

21 This indirect effect itself has different channels: x affects y both directly
i
j
through exogenous effects (δ ), and indirectly through endogenous effects (β ) via
its effects on yi (γ ) and yk (δ ).

46

Y. Bramoullé et al. / Journal of Econometrics 150 (2009) 41–55

2.4.2. Network interactions
Suppose now that students interact through a network. In
addition, suppose that we can find an intransitive triad in the
network. Recall that this is a set of three individuals i, j, k such that
i is affected by j and j is affected by k, but i is not affected by k. In this
case, Gik = 0 while G2ik ≥ Gij Gjk > 0. In contrast, G2 = λ0 I + λ1 G
implies that G2ik = 0. Therefore, the presence of an intransitive triad
guarantees that I, G, and G2 are linearly independent. This means
that G2 x is an identifying instrument for Gy, since xk affects yi but
only indirectly, through its effect on yj . This result applies as long as
there are students whose friends’ friends are not all their friends.
This is a generalization of the first part of the example discussed in
Section 2.2.
Most networks have intransitive triads. Some networks do
not, however. They are called transitive, and are characterized
by specific properties (e.g., Bang-Jensen and Cutin (2000)). In
transitive networks, the student’s friends’ friends are always his
friends. We show in Appendix A how to apply Proposition 1 to
analyze these networks. Interestingly, we find that identification
generally holds on transitive networks. It relies then on the
directed nature of the links.22 In these networks, we can always
find a group of students who are only friends to each other.
Students in the group are not friends to students outside the group.
Friendship need not be symmetric, however. We can also find
students outside the group who are friends to students inside the
group. This difference in social positions impacts the reduced-form
equations. Especially, mean family background of students in the
group affects students in and outside the group differently. This
difference in magnitude can be exploited to identify social effects.
Formally, we show that when the network is transitive, I, G, and
G2 are linearly independent if and only if G2 6= 0.23 In this case, the
variable G2 x can be used as an identifying instrument for Gy. In the
end, we obtain the following result.
Proposition 3. Suppose that individuals do not interact in groups.
Suppose that γ β + δ 6= 0. If G2 6= 0, social effects are identified.
If G2 = 0, social effects are identified when α 6= 0, but not when
α = 0.
Overall, the results presented in this section show that
endogenous and exogenous effects can usually be identified as
soon as there is some variation in the reference groups. The results
are clear-cut, reflecting the theoretical nature of identification
conditions. In practice though, we expect identification to be weak
if the network is close to being complete. We explore this issue in
Section 5.
3. Correlated effects
In this section, we partially address the problem of correlated
effects. We introduce unobserved variables common to students
who belong to the same network.24 These variables may be correlated with the family background of students, which introduces

22 If links are undirected, a network without intransitive triads necessarily has a
group structure. This case is covered by Proposition 2.
23 When G2 = 0, the first part of Proposition 1 does not apply. In these networks,

a student either affects others or is affected by them. When α 6= 0, the presence of
isolated students still yields identification, see Appendix A.
24 In an earlier version of the paper (Bramoullé et al., 2006), we looked at a

finer subdivision of the population that may be relevant in some applications.
We assumed that unobserved variables are common to individuals in the same
component of the network. A component is a maximal set of indirectly related
individuals.

an additional identification problem. As in linear panel data models with fixed effects, we solve this problem by using appropriate differencing to eliminate unobserved variables.25 We then ask
whether endogenous and exogenous social effects can be disentangled. We characterize the necessary and sufficient conditions
for identification. Not surprisingly, these conditions are more demanding than in the absence of correlated effects. Identification
still holds in most networks, but it fails for some specific ones. We
also find that the way common unobservables are eliminated matters. We provide the best possible condition for identification in
this setting.
3.1. The model
We introduce network-specific unobservables in the previous
model. For any network l and for any student i belonging to l,

P
yli = αl + β

P

ylj

j∈Pi

ni

+ γ xli + δ

xlj

j∈Pi

ni

+ li ,

(9)

E(li | xl , αl ) = 0.
Eq. (9) generalizes Eq. (3) in our example discussed in Section 2.2.
The network fixed effect αl captures unobserved (by the modeler)
variables that have common effects on the outcome of all students
within the network (e.g., same professors, similar preferences
for recreational activities). Importantly, E(αl |xl ) is allowed to be
any function of xl but we assume that E(li | xl , αl ) = 0. Thus,
correlated unobservables may be present but we maintain the
strict exogeneity of xl conditional on αl . This is a natural extension
of the model of Lee (2007) to a network setting. A similar model
has been estimated by Lin (2007).
Here an important remark is in order. In the version of our
model with stochastic networks, we assume that the matrix Gl
is exogenous conditional on αl and xl , i.e., E(l | αl , xl , Gl ) =
0. This condition fails to hold, for instance, if some unobserved
characteristics affect both the likelihood to form links and the
outcome and differs among individuals in the same network.
Thus, if popular students are likely to interact with other popular
students and to participate in many recreational activities, and
if popularity is not observed and varies within a classroom, the
network will not be exogenous conditional on αl and xl . In this
case, our approach will yield inconsistent estimates of social
interactions.
Before studying how the reflection problem can be solved in this
context, the standard approach is first to eliminate the networkspecific unobservables. In analogy with the within transformation
in panel data models, this can be done by taking appropriate
differences between structural equations. However there are many
transformations that can eliminate the unobservables. We next
study two natural ways to do that. Throughout this section, we
assume that no student is isolated. More generally, our results are
valid for any row-normalized matrix G.
3.2. Local differences
We first take local differences. We average Eq. (9) over all
student i’s friends, and subtract it from i’s equation. This approach
is local since it does not fully exploit the fact that the fixed effect

25 Additional assumptions on the error terms can help identification. Graham
(2008) uses restrictions on the variance matrix to identify social interactions from
correlated effects. In his example applied to the Project Star, a key assumption is that
the variances of unobserved teacher quality and student characteristics, as well as
the (exogenous + endogenous) social effect, are not affected by the classroom size.

Y. Bramoullé et al. / Journal of Econometrics 150 (2009) 41–55

is not only the same for all i’s friends but also for all students of
his network. Written in matrix notations, the structural model, on
which a within local transformation is applied, becomes:

(I − G)yl = β(I − G)Gyl + γ (I − G)xl
+ δ(I − G)Gxl + (I − G)l .

(10)

The corresponding reduced form is obtained as in Section 2 (see
Eq. (5)).

(I − G)yl = (I − β G)−1 (γ I + δ G)(I − G)xl
+ (I − β G)−1 (I − G)l .

Proposition 4. Consider model (10). Suppose that γ β+δ 6= 0. Social
effects are identified if and only if the matrices I, G, G2 , and G3 are
linearly independent.
This condition is more demanding than the condition of
Proposition 1. Some information has been lost to take into account
the presence of correlated effects. This loss makes identification
more difficult.
As in the previous section, Proposition 4 has a natural
interpretation in terms of instrumental variables. We show in
Appendix B (Result 2) that the matrices I, G, G2 , and G3 are linearly
dependent if and only if the expected value of the endogenous
variable on the right-hand side of Eq. (10), E [(I − G)Gyl |xl ], is
perfectly collinear with the regressors ((I − G)xl , (I − G)Gxl ).
When this perfect collinearity holds, the structural model is clearly
not identified. Again, from a series expansion of E [(I − G)Gyl |xl ]
similar to the one in Eq. (7), it is clear that when E [(I − G)Gyl |xl ]
is not perfectly collinear with the regressors, the variables ((I −
G)G2 xl , (I − G)G3 xl , . . .) can be used as valid instruments for (I −
G)Gyl . This result generalizes the one presented in the second part
of Section 2.2 (see Eq. (4)).
We study the implications of Proposition 4 on the pattern
of interactions among students. Consider group interactions and
assume that each classroom forms a group. Three different
classroom sizes are now necessary to obtain identification. With
two classrooms of sizes s1 and s2 , we can see that I, G, G2 , and G3
are linearly dependent. More precisely,
1
s1 + s2 − 3
I+
G
(s1 − 1)(s2 − 1)
(s1 − 1)(s2 − 1)
s1 s2 − 2(s1 + s2 ) + 3 2
+
G .
(s1 − 1)(s2 − 1)

In contrast, with three classroom sizes (or more), I, G, G2 , and
G3 are linearly independent, and social effects are identified (see
Davezies et al. (2006)). This is, of course, confirmed by looking
directly at the reduced form. Let sg be the size of i’s group. Eq. (11)
becomes
yli − ȳl =

(sg − 1)γ − δ
sg − 1
(xli − x̄l ) +
(li − ¯l ).
(sg − 1) + β
sg − 1 + β

the maximal friendship distance between any two students in
the network (see Wasserman and Faust (1994)). Suppose that the
diameter is greater than or equal to 3. Then we can find two
students i and j separated by a friendship distance 3 in the network.
In this case, G3ij > 0 while G2ij = Gij = 0. Hence, no linear relation
of the form G3 = λ0 I + λ1 G + λ2 G2 can exist. In our example of
Section 2.2, the diameter of the network is infinite. This implies
that we can always find two students separated by a friendship
distance 3 (and more). Therefore, peer effects are identified even
when there are correlated effects. One has the following result:

(11)

Our next result characterizes identification in this setting.

G3 =

47

(12)

where means are computed over all students in i’s classroom (see
Eq. (2.5) in Lee (2007)). Only one composite parameter can now be
recovered from the reduced form for each group size. Three sizes
are thus needed to identify the three structural parameters.
Next, consider network interaction. Intransitive triads have a
natural counterpart. Define the distance between two students i
and j in the network as the number of friendship links connecting
i and j in the shortest chain of students i1 , . . . , il such that i1 is a
friend of i, i2 is a friend of i1 , . . . , and j is a friend of il . For instance,
this distance is 1 between two students who are friends and 2
between two students who are not friends but who have a common
friend (intransitive triad). Define the diameterof the network as

Corollary 1. Consider model (10) and suppose that γ β + δ 6= 0. If
the diameter of the network is greater than or equal to 3, social effects
are identified.
This condition is satisfied in most networks. As in Section 2, it
can be understood in terms of instrumental variables. From the
series expansion of the model, the variable (I − G)G2 xl is a valid
identifying instrument for the right-hand side endogenous vector
(I − G)Gyl .
Identification fails, however, for a number of nontrivial
networks of diameter lower than or equal to 2. This is notably the
case for complete bipartite networks. In these graphs, the population
of students is divided into two groups such that all students in one
group are friends with all students in the other group, and there
is no friendship links within groups. These include star networks,
where one student, at the center, is friend with all other students,
who are all friends only with him. It is easy to check that G3 = G for
complete bipartite networks. By Proposition 4, social effects are not
identified for these networks. To illustrate, consider star networks.
Let i = 1 denote the center. Reduced-form equation (11) for star
networks can be expressed as follows:

!
n
γ −δ
1 X
yl1 −
ylj =
xl1 −
xlj + νl1 ,
n − 1 j=2
1+β
n − 1 j=2


γ −δ
yli − yl1 = γ (xlj − xl1 ) + γ −
1!
+β
n
1 X
× xl1 −
xlj + νli , ∀i ≥ 2.
n − 1 j =2
1

n
X

or

We can only recover the two composite parameters γ and
γ −δ
from the estimation of the reduced form. This makes the
1+β
identification of the three structural parameters impossible.
We could not fully characterize the condition of Proposition 4 in
terms of the geometry of the network. To gain some insight on this
issue, we determined all the connected undirected networks for
which identification fails when n = 4, 5, and 6. They are depicted
in Fig. 1. We observe two features. First, the number of networks
for which identification fails is relatively low, even within the set
of networks with diameter lower than or equal to 2. Second, all
these networks exhibit a high degree of symmetry. We suspect that
both features hold more generally. Linear dependence between
I, G, G2 , and G3 likely imposes strong restrictions on the network’s
geometry.
3.3. Global differences
We next take global differences. We average Eq. (9) over all
students in i’s network, and subtract from i’s equation. In contrast
with the previous section, the equation being subtracted is now
identical for all students in the same network. Introduce the matrix
H as follows: H = 1n (ιι0 ). Therefore, I − H is the matrix which
obtains the deviation from network means. We can write the

48

Y. Bramoullé et al. / Journal of Econometrics 150 (2009) 41–55

Fig. 1. Undirected graphs for which the matrices I, G, G2 , and G3 are linearly dependent.

Fig. 2. A graph for which identification holds under global, but not local,
differences.

structural model on which a within global transformation is applied
as follows:

(I − H)yl = β(I − H)Gyl + γ (I − H)xl
+ δ(I − H)Gxl + (I − H)l .

(13)

In this context, the restricted reduced form becomes:

Proposition 5 implies that if social effects are identified when
taking local differences, they are also identified when taking global
differences. For many networks, the conditions in Propositions 4
and 5 are in fact equivalent. Especially, we can check that rank(I −
G) = n − 1 for the networks depicted in Fig. 1, so that identification
also fails for these structures when taking global differences. The
two conditions are not always equivalent, however. Consider, for
instance, the network presented in Fig. 2. For this graph, the matrix
G satisfies G3 = G, rank(I − G) = 3 < n − 1 = 4 and
2λ0 + λ1 + 1 = 2 6= 0. Applying our previous results, we see
that identification holds under global differences but not under
local ones. More generally, we have shown (see Bramoullé et al.
(2006)) that Proposition 5 provides the best possible identification
condition in this setting. If social effects are not identified when
subtracting the network’s average, they are never identified.

(I − H)yl = (I − H)(I − β G)−1 (γ I + δ G)xl
+ (I − H)(I − β G)−1 l .

(14)

We characterize the condition under which this model is identified.
Our result involves the rank of the matrix I − G. Since (I − G)ι = 0,
this rank is always lower than or equal to n − 1.
Proposition 5. Consider model (13). Suppose that γ β +δ 6= 0. If the
matrices I, G, G2 , and G3 are linearly independent, social effects are
identified. Next, suppose that G3 = λ0 I+λ1 G+λ2 G2 . If rank(I−G) <
n − 1 and 2λ0 + λ1 + 1 6= 0, social effects are identified. In contrast,
if rank(I − G) = n − 1, social effects are not identified.
From a demonstration similar to the one used in Result 2 of
Appendix B, one shows that the model is not identified if and
only if E [(I − H)Gyl |xl ] is perfectly collinear with the regressors
((I − H)xl , (I − H)Gxl ). Moreover, the variables ((I − H)G2 xl , (I −
H)G3 xl , . . .) can be used as valid instruments to estimate the model
consistently, when the model is identified.

4. Empirical results
To illustrate our approach, we analyze econometric results on
recreational activities by high school students in the US. We use
the In-school Add Health data collected between September 1994
and April 1995. In the project, a sample of 80 high schools and
52 middle schools was selected. The study design makes sure that
the sample is representative of US school with many respects
(region, school size, school type, urbanicity, and ethnicity). All
students in each school sampled have been asked to fill up the
self-administrated questionnaire. The data provide information on
variables such as social and demographic characteristics of the
respondents, the education level and occupation of their parents,
and their friendship links (i.e., their best friends, up to 5 females
and up to five males).
The left-hand side variable of our econometric model is an
index of participation in recreational activities such as educational,

Y. Bramoullé et al. / Journal of Econometrics 150 (2009) 41–55

artistic and sports organizations and clubs by a student.26 This
recreational activities index takes a value from 0 to 4, where 0 to
3 corresponds to the number of organizations and clubs of which
the student is a member when the number is smaller than 4, and
4 when the number is 4 and over.27 The right-hand side variables
includes own characteristics (age and dummies for grade, gender,
race, born in the US, mother present, father present, mother’s level
of education, father’s level of education, and parents’ participation
in the labor market28 ), their best friends’ mean characteristics
(exogenous social variables), and their mean recreational activities
index (endogenous social variable). Note that to construct our peer
variables, we had to restrict the list of friends to those registered at
the same secondary school.
In our empirical application, and following the second interpretation of our model (see Section 2.4), each school l is assumed to
form a network with a stochastic but strictly exogenous interaction matrix Gl , on the network fixed effect and the observed students’ characteristics. We construct the block diagonal matrix G of
the large network of all schools. We apply a local transformation to
the model defined on the latter network so that it can be written
as

(I − G)y = β(I − G)Gy + (I − G)X γ + (I − G)GX δ + ν

(15)

where X is the matrix of observations on students’ own characteristics. Students are assumed to interact with their friends, not in
groups as in most empirical studies on peer effects. It is easy to
verify that the matrices I, G, G2 , and G3 are linearly independent.
Therefore, from Proposition 4, the model is identified and the matrices ((I − G)G2 X, (I − G)G3 X, . . .) can be used as valid instruments.
We suppose that errors in (15) are independent across observations but heteroskedastic.29
Social effects are estimated following a Generalized 2SLS strategy proposed in Kelejian and Prucha (1998) and refined in Lee
(2003). This procedure yields an asymptotically optimal IV estimator when the errors are i.i.d. and reduces to a two-step estimation
method in our case.30 The first
 step consists in estimating a 2SLS

using as instruments S = (I − G)X (I − G)GX (I − G)G2 X .
2SLS

In our case, the model is overidentified,
and we obtain b
θ =

0
−1e0
e
e
e
(X PX) X Py where X = (I − G)Gy (I − G)X (I − G)GX is
the matrix of explanatory variables and P
= S(S0 S)−1 S
is the weighting matrix. The second step consists in esti2SLS

mating a 2SLS using as instruments b
Z = Z(b
θ ), with
E
[(
I
−
G
)
Gy
(θ)
|
X
,
G
]
(
I
−
G
)X (I − G)GX . From
Z(θ) =
the reduced-form equation, it follows that

E[(I − G)Gy(θ) | X, G] = G(I − β G)−1 [(I − G)(X γ + GX δ)].

26 The questionnaire classifies these activities into three categories : (1) clubs and
organizations, which include language club, book club, debate club, drama club,
future farmers of America, history/math/science/computer club, music clubs (band,
orchestra, chorus), dance/cheerleading and other clubs and organization; (2) sports
clubs, (3) other, including newspaper, honor society, student council, yearbook.
27 We used this definition to reduce the problem of measurement errors when a
student reports a large number of activities.
28 This dummy variable = 1 when the student reports living with at least one
parent who participates in the labor market, 0 otherwise. This variable may be
interpreted as a proxy for the student not being on welfare.
29 Our approach thus imposes within-network independence of the error terms,
which is a reasonable assumption given the presence of a network effect.
An alternative approach in this setting would be to ‘‘cluster’’ at the network
level (thus allowing to introduce random coefficients that could induce both
heteroskedasticity and within-network dependence).
30 Since we do not assume homoskedasticity, our estimates are consistent but
not asymptotically optimal. However, our estimates of the standard errors of the
estimated parameters do take the presence of heteroskedasticity into account.

49

Table 1
Descriptive statistics.
Variable

Mean

Standard deviation

Consumption of recreational services
Age
Female
Race is white only
White
Black
Asian
Native
Other
Born in the US
Mother present
Father present
Grade 6 to 8
Grade 9 or 10
Grade 11 or 12
Parents’ participation in the labor market

2.122
14.963
0.535
0.619
0.674
0.168
0.062
0.052
0.082
0.928
0.929
0.779
0.263
0.406
0.331
0.965

1.267
1.682
0.499
0.486
0.469
0.373
0.242
0.221
0.274
0.259
0.257
0.415
0.440
0.491
0.471
0.184

Mother’s level of education
No high school (HS)
HS graduate
More than HS but no college/University degree
College/University graduate
Went to school but do not know the level

0.097
0.284
0.276
0.206
0.066

0.296
0.451
0.447
0.404
0.248

Father’s level of education
No high school (HS)
HS graduate
More than HS but no college/University degree
College/University graduate
Went to school but do not know the level

0.081
0.211
0.240
0.178
0.069

0.273
0.408
0.427
0.383
0.253

Number of observations

55 208

Since the model is just identified, we obtain
LEE

b
θ

0

0

= (b
Ze
X)−1b
Z y.

The variance matrix of the estimated parameters is consistently
estimated by:
LEE
0 −1 0
0 0 −1
b
V (b
θ ) = (b
Ze
X) b
Z Db
Z(e
Xb
Z) ,

where D is an n × n diagonal matrix with entries given by the
squared residuals from this second step.31
Descriptive statistics of our sample are provided in Table 1. The
total number of observations is 55 208. The average age of the
students is 14.9 and 53.5% are female. Also, in 96.5% of households,
at least one parent participates in the labor market. Table 2
presents the estimation results. Even though the set of exogenous
social effects corresponds exactly to the one’s own characteristics,
the model can be estimated and many coefficients are significant.
As regards own characteristics, our results show in particular
that the recreational activities index decreases with age and with
being white, but rises with being female and with the parents’
participation in the labor market. The exogenous social effects
are significant for a number of variables. In particular, our results
indicate that a student’s recreational activities index decreases
with the mean age of his friends but rises with their mean
parents’ participation in the labor market. One interpretation for
the latter result is that working friends’ parents may help a student
to have a better access to recreational activities (e.g., through
contacts with people responsible for clubs or organizations, or

31 While our estimating approach ignores problems raised by a count dependent
variable, it has the advantage of convenience, given the presence of an endogenous
right-hand variable. In this, we follow the approach used in several published
models on peer effects with nonperfectly continuous response variables, such as
those on juvenile cigarette or drug use (e.g., Gaviria and Raphael (2001)) or on Grade
Point Average (e.g., Sacerdote (2001)). Note also that the estimated standard errors
of the coefficients handle the inherent heteroskedasticity of the count model.

50

Y. Bramoullé et al. / Journal of Econometrics 150 (2009) 41–55

Table 2
Consumption of recreational activities.

Own characteristics
= (I − G)x

Exogenous social effects
= (I − G)Gx

Variable

Coeff

Std err

Asymp. t-stat

Age
Female
Race is white only
Born in the US
Mother present
Father present
Grade 9 or 10
Grade 11 or 12
Mother is HS grad
Father is HS grad
Mother: more than HS but no college degree
Father: more than HS but no college degree
Mother is college/University grad
Father is college/University grad
Mother went to school but do not know level
Father went to school but do not know level
Parents’ participation in the labor market

−0.0225

0.0113
0.0148
0.0204
0.0333
0.0358
0.0289
0.0963
0.1021
0.0274
0.0287
0.0293
0.0304
0.0331
0.0311
0.0381
0.0380
0.0400

−1.9840

Age
Female
Race is white only
Born in the US
Mother present
Father present
Grade 9 or 10
Grade 11 or 12
Mother is HS grad
Father is HS grad
Mother: more than HS but no college degree
Father: more than HS but no college degree
Mother is college/University grad
Father is college/University grad
Mother went to school but do not know level
Father went to school but do not know level
Parents’ participation in the labor market

−0.0611

0.0202
0.0479
0.0447
0.0655
0.0638
0.0532
0.1859
0.1941
0.0504
0.0546
0.0676
0.0667
0.0808
0.0606
0.0702
0.0749
0.0728

−3.0247

0.0079
−0.0190
0.0420
0.1071
−0.1087
−0.0344
0.0997
−0.0474
0.1719
−0.0380
0.0911
−0.0310
0.1238
−0.0940
0.1500
0.1508
0.4667

0.2556

1.8259

Endogenous social effects = (I − G)Gy

Endogenous effect

Number of observations

55 208

0.2130

−0.1057
−0.0516
−0.0125
−0.0185
0.0108
0.0213
−0.0046
0.0470
0.1464
0.1669
0.1374
0.1274
−0.0096
−0.0665
0.0834

14.4136

−5.1874
−1.5527
−0.3488
−0.6381
0.1124
0.2091
−0.1687
1.6394
4.9963
5.4894
4.1483
4.0985
−0.2517
−1.7480
2.0866
0.1654

−0.4256
0.6407
1.6798
−2.0447
−0.1848
0.5136
−0.9407
3.1469
−0.5622
1.3669
−0.3834
2.0435
−1.3379
2.0033
2.0722

Note: Excluded categories: Grade 6 to 8, Mother: no HS, Father: no HS. The model is estimated using the Generalized 2SLS proposed in Kelejian and Prucha (1998) and refined
in Lee (2003).

simply through financial help). The endogenous social effect is
positive and significant at the 10% level (asymptotic t = 1.82).
This indicates that a one point increase in the mean recreational
activities index of student’s friends induces him to increase his
recreational activities index by 0.466.
5. Monte Carlo simulations
We provide Monte Carlo simulations calibrated on our econometric results to study how the strength of the identification is
affected by the density of the graph and its level of intransitivity.
Following Wasserman and Faust (1994), we define density as the
ratio of the number of links over the total number of possible links.
Thus, it describes the average probability that any two students are
connected. We expect identification to be weak if the graph is close
to being complete (i.e., when its density is close to one). The level of
intransitivity is the ratio of the number of intransitive triads over
the number of triads. The intransitivity level lies between 0 and 1;
it equals 0 only when the network is transitive.
We find that structural parameters are better estimated when
the density of the graph is small. The impact of intransitivity on
the precision of estimators is however more complex and often
nonmonotonic with intermediate to high density.
5.1. Calibration
Running our Monte Carlo simulations using the whole sample
of schools is intractable, given the large size of the dataset. Rather,

the procedure we adopt is the following. First, we pick the median
school in our sample. Its size is 240 students. Also, its density is
0.0201, its level of intransitivity is 0.2103 and the average number
of links per student is 4.81. (The corresponding numbers are
7.43 × 10−5 , 0.1978 and 4.10 for the complete sample). Second, we
assume that all students have the same characteristics except for
their parents’ participation in the labor market. Third, to increase
the variability of the latter variable in our subsample, we convert
it into a continuous measure of parents’ labor income (named x
from there on). More precisely, to take into account the mass of
probability at x = 0 we draw a 240 × 1 random vector in a
Bernoulli distribution with p = 227/240 (13 students report to
live with parents who are not working). Then, for the students who
are predicted to live with at least one parent who works, we draw
a vector of x from a log-normal distribution with E(x) normalized
to 1 and σx2 = 3. Fourth, the values of the parameters β , γ and δ
are those obtained by estimation on the complete sample. Finally,
the parameter α is calculated from the equation: α = y + β Gy +
γ x + δ Gx, where the bar indicates that the vector is computed at
the median school mean. One has:

α = 0.7683,

β = 0.4666,

γ = 0.0834,

δ = 0.1507.

In this model,  is a 240 × 1 vector of error terms distributed as
n(0, 6). We set 6 = σ 2 I and σ 2 = 0.1. Finally, we generate the
240 × 1 vector of endogenous variables y using the reduced-form
equation (5).
In the simulations, the model is still estimated using the
Generalized 2SLS approach. However, we assume homoskedastic
errors in the estimation of the variance matrix.

Y. Bramoullé et al. / Journal of Econometrics 150 (2009) 41–55
Table 3
Network simulations for Erdös–Renyi graphs (1000 draws).

0.01
0.02
0.03
0.04
0.05
0.06
0.07
0.08
0.09
0.10
0.20
0.30
0.40
0.50
0.60
0.70
0.80
0.90
1.00

51

Table 4
Small-world graphs, k = 3, 5 (1000 draws).

γ̂ (S.E)

δ̂ (S.E)

β̂ (S.E)

k

p

Intransitivity

γ̂ (S.E.)

δ̂ (S.E.)

β̂ (S.E.)

0.0833
0.0032
0.0834
0.0031
0.0834
0.0031
0.0832
0.0031
0.0836
0.0031
0.0833
0.0031
0.0834
0.0031
0.0834
0.0031
0.0835
0.0031
0.0833
0.0031
0.0836
0.0032
0.0834
0.0032
0.0834
0.0033
0.0832
0.0071
0.0845
0.2619
0.0835
0.1259
0.0831
0.213
0.0919
16.8469
0.1026

0.1511
0.0049
0.1512
0.0056
0.1506
0.0103
0.1508
0.0163
0.1516
0.0222
0.151
0.024
0.1514
0.0275
0.1512
0.0285
0.1516
0.0351
0.1505
0.0344
0.1509
0.0938
0.1554
0.1516
0.1447
0.2692
0.1261
1.8709
−0.3838
119.9752
0.1084
105.2318
0.9454
152.0559
−2.3448
5955.1294
4.7828

0.4663
0.0113
0.4669
0.0238
0.4671
0.0892
0.465
0.1679
0.4566
0.2273
0.4654
0.2531
0.4635
0.2605
0.4649
0.3195
0.4543
0.4162
0.4677
0.4112
0.4556
1.1006
0.4289
1.8064
0.5488
3.228
0.8232
23.8413
7.5082
1 574.4134
0.6689
1 409.2152
−9.2928
1 914.4321
32.6466
75 380.768
−1.3294

3

0.01

0.0309

3

0.05

0.2140

3

0.1

0.4239

3

0.2

0.5902

3

0.4

0.8713

3

0.6

0.9370

3

0.8

0.9912

3

1.0

0.9904

5

0.01

0.0455

5

0.05

0.1290

5

0.1

0.2994

5

0.2

0.5020

5

0.4

0.7913

5

0.6

0.9237

5

0.8

0.9772

5

1.0

0.9840

0.1022
0.5979
0.0835
0.0052
0.0833
0.0040
0.0833
0.0037
0.0836
0.0032
0.0834
0.0031
0.0835
0.0031
0.0835
0.0031
0.0838
0.0124
0.0838
0.0068
0.0832
0.0047
0.0835
0.0037
0.0835
0.0033
0.0833
0.0031
0.0835
0.0031
0.0835
0.0031

0.1891
1.2195
0.1514
0.0099
0.1510
0.0067
0.1509
0.0061
0.1506
0.0049
0.1508
0.0043
0.1509
0.0055
0.1507
0.0042
0.1524
0.0538
0.1522
0.0268
0.1509
0.0157
0.1510
0.0108
0.1509
0.0075
0.1507
0.0069
0.1507
0.0072
0.1505
0.0066

0.3366
4.0886
0.4654
0.0299
0.4666
0.0205
0.4662
0.0198
0.4664
0.0122
0.4662
0.0102
0.4673
0.0110
0.4672
0.0108
0.4611
0.1548
0.4629
0.0783
0.4667
0.0553
0.4658
0.0373
0.4666
0.0386
0.4652
0.0392
0.4679
0.0250
0.4669
0.0204

∞

∞

∞

the strength of identification, holding density constant. Also, they
can be used to analyze the impact of density, holding intransitivity
constant.
5.3. Results

5.2. Networks
To analyze the impact of density and intransitivity, we consider
two types of networks. We first look at the standard Erdös and
Rényi (1959) model of random graphs. Link are i.i.d. and each
pair of students is connected with the same probability d. In this
case, the expected density is equal to d while the expected level
of intransitivity is 1 − d. When d = 1, the network is complete
and students interact in groups. Therefore social effects are not
identified. We examine how the strength of identification changes
when d varies from 0.01 to 1 by increments of .01 from 0.01 to 0.1
and by increments of .1 from 0.1 to 1.
Erdös–Rényi random graphs provide a natural starting point,
but their structure is very specific. Especially, a lower d corresponds to a lower density and a higher intransitivity. In order to
disentangle both effects, we introduce a second type of graphs. We
adapt the small-world procedure of Watts and Strogatz (1998) to
our context. We start from disjoint complete subgraphs of size k.
(Hence k divides the population size n). For instance, if k = 12
in our school of 240 students, this means that there are 12 complete groups of 20 students. Then, with probability p each link is
rewired at random. Since the total number of links is constant,
1
density is fixed and equal to nk−
(= 0.046 in our example with
−1
k = 12). We let the probability p vary. When p equals 0, the
level of intransitivity is 0. This is the case since students interact
in groups. When p equals 1, we obtain an Erdös–Rényi graph. As
p increases, the expected level of intransitivity increases. We let
k and p take the following values: k ∈ {3, 5, 10, 12, 15, 20} and
p ∈ {0.01, 0.05, 0.1, 0.2, 0.4, 0.6, 0.8, 1}. In summary, the second type of graphs allows us to look at how intransitivity affects

Table 3 reports the estimation results for Erdös–Rényi graphs.
The probability of link formation, or expected density, d, is given in
column 1. For each level of density, we pick one graph. We look at
1000 draws for the vectors  and x. For each draw, we estimate
the structural parameters. Columns 2–4 of Table 3 report the
average estimates and the average standard errors over the 1000
draws. Estimates of the exogenous and the endogenous effects are
respectively shown in columns 3 and 4.
We find that precision is a decreasing function of density.
When the density is smaller than or equal to 0.07, the bias on the
estimates of both peer effects is relatively small and the precision is
relatively good especially on the exogenous effect. As the density of
the graph increases, precision worsens. None of the two estimates
are significant on average at the 10% level when the density reaches
0.20. As expected, when the density is equal to one (complete
graph), the estimation procedure diverges.
The estimation results for small-world graphs are given in
Tables 4–6. Each of these tables are composed of two panels. To
each panel corresponds a specific value of k. Within each panel,
density is fixed and as one goes down the columns, p, hence
intransitivity, increases. For each value of k and p, we pick one
graph. Again, for each graph we report the estimate averages over
1000 draws.
Results are more complex than for Erdös–Rényi graphs. When
density is low (k ∈ {3, 5}), precision is an increasing function
of intransitivity almost everywhere. However, for intermediate
to high levels of density k ∈ {10, 12, 15, 20}, the relationship
is nonmonotonic. In any case, starting from a situation where
peer effects are not identified (p = 0), a slight increase in the

52

Y. Bramoullé et al. / Journal of Econometrics 150 (2009) 41–55

Table 5
Small-world graphs, k = 10, 12 (1000 draws).
k

p

Intransitivity

γ̂ (S.E.)

δ̂ (S.E.)

β̂ (S.E.)

10

0.01

0.0407

10

0.05

0.1394

10

0.1

0.2983

10

0.2

0.4959

10

0.4

0.7888

10

0.6

0.9104

10

0.8

0.9545

10

1.0

0.9615

12

0.01

0.0253

12

0.05

0.1722

12

0.1

0.2926

12

0.2

0.5302

12

0.4

0.7695

12

0.6

0.9035

12

0.8

0.9464

12

1.0

0.9551

0.0831
0.0067
0.0836
0.0050
0.0833
0.0037
0.0832
0.0036
0.0834
0.0032
0.0834
0.0031
0.0835
0.0031
0.0834
0.0031
0.0825
0.0199
0.0836
0.0043
0.0834
0.0037
0.0832
0.0034
0.0834
0.0032
0.0834
0.0031
0.0834
0.0031
0.0833
0.0031

0.1478
0.0649
0.1531
0.0420
0.1495
0.0251
0.1502
0.0198
0.1512
0.0159
0.1510
0.0133
0.1508
0.0151
0.1517
0.0162
0.1407
0.2636
0.1522
0.0392
0.1507
0.0292
0.1509
0.0202
0.1516
0.0177
0.1511
0.0181
0.1502
0.0170
0.1509
0.0167

0.4743
0.1678
0.4601
0.1165
0.4670
0.0799
0.4674
0.0794
0.4611
0.1051
0.4640
0.1125
0.4666
0.1327
0.4574
0.1519
0.4889
0.6622
0.4607
0.1111
0.4642
0.0966
0.4629
0.0910
0.4585
0.1245
0.4636
0.1696
0.4696
0.1653
0.4618
0.1734

Table 6
Small-world graphs, k = 15, 20 (1000 draws).
k

p

Intransitivity

γ̂ (S.E.)

δ̂ (S.E.)

β̂ (S.E.)

15

0.01

0.0253

15

0.05

0.1535

15

0.1

0.2969

15

0.2

0.4767

15

0.4

0.7496

15

0.6

0.8905

15

0.8

0.9363

15

1.0

0.9421

20

0.01

0.0237

20

0.05

0.1482

20

0.1

0.2875

20

0.2

0.4789

20

0.4

0.7522

20

0.6

0.8742

20

0.8

0.9133

20

1.0

0.9197

0.0833
0.0093
0.0834
0.0039
0.0835
0.0035
0.0833
0.0034
0.0833
0.0032
0.0833
0.0031
0.0835
0.0031
0.0834
0.0031
0.0842
0.0146
0.0833
0.0045
0.0834
0.0035
0.0834
0.0033
0.0834
0.0032
0.0834
0.0031
0.0834
0.0031
0.0835
0.0031

0.1509
0.1471
0.1521
0.0413
0.1520
0.0304
0.1508
0.0286
0.1510
0.0228
0.1518
0.0219
0.1509
0.0234
0.1511
0.0236
0.1698
0.3085
0.1497
0.0703
0.1492
0.0395
0.1515
0.0312
0.1525
0.0257
0.1532
0.0295
0.1518
0.0298
0.1521
0.0298

0.4594
0.3656
0.4593
0.1183
0.4578
0.1046
0.4626
0.1120
0.4596
0.1506
0.4586
0.2034
0.4725
0.2505
0.4674
0.2395
0.4211
0.7344
0.4676
0.1870
0.4686
0.1207
0.4605
0.1194
0.4494
0.1710
0.4455
0.2663
0.4491
0.3042
0.4494
0.3140

level of intransitivity holding density constant greatly improves
identification. As regards the density, a glance across the tables
indicates that for a given level of intransitivity, the precision of the

estimates is everywhere a decreasing function of density. Overall,
these results confirm the role played by the network’s structure on
the identification of peer effects.
6. Conclusion
In this paper, we characterize the conditions under which
endogenous and exogenous social effects are identified in a linearin-means model with general interaction structure. Our analysis
shows that both effects can usually be distinguished with network
data, although identification may fail for specific networks. At the
empirical level, we demonstrate the feasibility of our identification
strategy by estimating a model of consumption of recreational
activities by secondary school students using Add Health data. We
show in particular that endogenous and exogenous social effects
(using the network of friends at school) can be disentangled. This
empirical application is in line with a few recent papers that have
already exploited the presence of a social network to estimate
peer effects.32 Also, when the model is identified, we show, from
Monte Carlo simulations, that characteristics of a network, such as
its density and its level of intransitivity, may strongly affect the
quality of the estimates of the peer effects.
Our results suggest that there are high benefits to analyzing
network data. On the other hand, collecting comprehensive data on
relationships between agents can be very costly. The development
of electronic databases has, in some instances, dramatically
lowered this cost. Thus, studies on co-authorship networks among
scientists are linked to the availability of literature databases (see
Newman (2001) and Goyal et al. (2006)). Sampling the network
provides a different way to reduce these costs. This can be done in
many ways, e.g., see Rothenberg (1995). It would be interesting to
study how our identification results apply in such settings. Can the
econometrician still recover endogenous and exogenous effects if
he only knows a limited part of the network?
Finally, the problems of correlated effects and the endogeneity of link formation remain central. Experiments, or natural
randomizations, provide one answer. In an experimental context,
our results could guide empirical research. For instance, appropriate structures of interactions could be imposed on participants in
the lab. With non-experimental data, taking differences between
endogenous variables can eliminate certain types of unobserved
variables, as done in Section 3. Alternatively, two-stage estimations
could be attempted on network data. The likelihood of link formation could be estimated in a first step, and social effects conditional
on links formed in a second step. This would require to have some
understanding on how relationships emerge, hence could be fruitfully combined with theoretical models of network formation.33
Acknowledgements
We are grateful to Oriana Bandiera, Charles Bellemare, Arianna
Degan, Alain Guay, Linda Khalaf, Ron Laschever, Robert Moffitt,
Imran Rasul, Jean-Marc Robin, Patrick Sevestre, Jose Scheinkman,
and seminar participants at the University of Toronto, Duke
University, the Université de Paris 1, the CREST, the Rand
Corporation, the European Summer Symposium in Economic
Theory (2006), Toulouse School of Economics, Greqam (Marseilles)
and the 12th International Conference on Computing in Economics
and Finance, and especially an anonymous referee, for many
helpful comments. We thank Vincent Boucher for exceptional

32 See Laschever (2005), Lin (2007), De Georgi et al. (2007), and our discussion in
the introduction.
33 See Ioannides and Soetevent (2007) and Weinberg (2007) for first steps in this
direction.

Y. Bramoullé et al. / Journal of Econometrics 150 (2009) 41–55

53
1
.
s 2 +s −1

If G2 = λ0 I + λ1 G, then

research assistance. This research uses data from Add health,
a program project designed by J. Richard Udry, Peter Bearman,
and Kathleen Mullan Harris, and funded by a grant from the
National Institute of Child Health and Human Development, with
cooperative funding from 17 other agencies.

while for any i 6= j ∈ S2 , Gij =

Appendix A

we have (s +2s−1)2 < s 1−1 , which is a contradiction.
1
2
Suppose next that s1 or s2 is equal to 1. It means that for some i,
(G2 )ii = 0. Hence λ0 = 0 and for all i, (G2 )ii = 0. Therefore, all the
strong components of the network have size 1, and the network is
acyclic. In this case, there must exist a pair of students i and j such
that: (1) i is affected by j, (2) j is isolated, and (3) all
Pthe students
affecting i are isolated. Then, Gij = n1 and (G2 )ij =
k∈N Gik Gkj =

2

s −1

Proof of Proposition 1. Consider two sets of structural parameters (α, β, γ , δ) and (α 0 , β 0 , γ 0 , δ 0 ) leading to the same reduced
form. It means that α(I −β G)−1 ι = α 0 (I −β 0 G)−1 ι and (γ I +δ G)(I −
β G)−1 = (γ 0 I + δ 0 G)(I − β 0 G)−1 . Multiply the second equality by
(I − β G)(I − β 0 G). Since ∀a, (I − aG)−1 G = G(I − aG)−1 , this is
equivalent to

(γ − γ 0 )I + (δ − δ 0 + γ 0 β − γ β 0 )G + (δ 0 β − δβ 0 )G2 = 0.

∀i, (G )ii = λ0 . In addition, (G )ii = j∈N Gij Gji . Since S1 is a strong
component, if i ∈ S1 and Gij Gji > 0, then j ∈ S1 . The same is true
P
1
for S2 . Therefore, if i ∈ S1 , (G2 )ii =
j∈S1 Gij Gji = s1 −1 . In contrast,
P
s2 −1
2
if i ∈ S2 , (G )ii =
j∈S2 Gij Gji = (s +s−1)2 . Since s2 + s − 1 > s1 − 1,
2

(A.1)

Suppose first that I, G, and G2 are linearly independent. Then, γ =
γ 0 , δ + γ 0 β = δ 0 + γ β 0 , and δ 0 β = δβ 0 . Suppose first that δ 0 β 6= 0.
There exists λ 6= 0 such that β 0 = λβ, δ 0 = λδ . Substituting yields
δ 0 + γ β 0 = λ(δ + γ β) = δ + γ β . Since δ + γ β 6= 0, λ = 1, hence
β 0 = β, δ 0 = δ . Suppose next that δ 0 β = 0. Since δ + γ β 6= 0, we
cannot have β = δ = 0 or β 0 = δ 0 = 0. Thus, either β = β 0 = 0
and by the last equation δ = δ 0 = 0, or δ = δ 0 = 0 and by the last
equation (and since γ 6= 0 because δ + γ β 6= 0), β = β 0 = 0. To
conclude, observe that α(I − β G)−1 ι = α 0 (I − β G)−1 ι implies that
αι = α 0 ι, hence α = α 0 .
Next, suppose that I, G, and G2 are linearly dependent, and that
no student is isolated. The latter property implies that Gι = ι,
and α(I − β G)−1 ι = α/(1 − β)ι. Three equations only need to
be satisfied for (α, β, γ , δ) and (α 0 , β 0 , γ 0 , δ 0 ) to yield the same
reduced form. Therefore, the model is not identified.
Suppose that there are K characteristics and that parameters γk
and δk are associated with characteristic k. Structural parameters
θ and θ 0 lead to the same reduced form iff α(I − β G)−1 ι = α 0 (I −
β 0 G)−1 ι and ∀k, (γk I + δk G)(I − β G)−1 = (γk0 I + δk0 G)(I − β 0 G)−1 .
Suppose that for some k0 , δk0 + γk0 β 6= 0. If I, G, and G2 are
linearly independent, by the previous argument α = α 0 , β = β 0 ,
γk0 = γk00 and δk0 = δk0 0 . Then, for any other k, multiplying by

P

2

i

0. Therefore, λ1 = 0, hence G2 = 0. Therefore, if G2 6= 0, I, G, and
G2 are linearly independent.
Finally, suppose that G2 = 0. These networks are characterized
by the fact that: (1) no relation is reciprocal, i.e., j ∈ Pi ⇒ i 6∈ Pj , and
(2) they do not have any triad, i.e., sets of three different students
i, j, k such that i ∈ Pj and j ∈ Nk . Two sets of structural coefficients
lead to the same reduced form if γ = γ 0 , δ + γ 0 β = δ 0 + γ β 0 ,
and α(I − β G)−1 ι = α 0 (I − β 0 G)−1 ι. The last condition becomes
αι − αβ 0 G ι = α 0 ι − α 0 β G ι. There must exist one isolated and one
non-isolated student in the network. When i is isolated, (G ι)i = 0
and α = α 0 . When i is not isolated, (G ι)i = 1, and α(1 − β 0 ) =
α 0 (1 − β). Under the assumption that α 6= 0, we have β = β 0 ,
hence δ = δ 0 and social effects are identified. 
Proof of Proposition 4. Two sets of structural parameters (β, γ , δ)
and (β 0 , γ 0 , δ 0 ) lead to the same reduced form of (I − G)y if and only
if (I − β G)−1 (γ I + δ G)(I − G) = (I − β 0 G)−1 (γ 0 I + δ 0 G)(I − G).
This is equivalent to

(γ − γ 0 )I + [δ − δ 0 − (γ − γ 0 ) + γ 0 β − γ β 0 ]G − [δ − δ 0
+ β 0 (δ − γ ) − β(δ 0 − γ 0 )]G2 + (β 0 δ − βδ 0 )G3 = 0.
Suppose first that I, G, G2 , and G3 are linearly independent. Then,

γ = γ 0 , δ + γ β = δ 0 + γ β 0 , and β 0 δ = βδ 0 . By the same argument
as in the proof of Proposition 1, β = β 0 and δ = δ 0 . Suppose next
that I, G, G2 , and G3 are linearly dependent. If G2 = λ0 I + λ1 G, only
two equations must be satisfied for (β, γ , δ) and (β 0 , γ 0 , δ 0 ) to lead

I −β G leads to γk I +δk G = γk0 I +δk0 G hence θ = θ 0 . If I, G, and G2 are
linearly dependent, we can find θ 6= θ 0 leading to the same reduced
form. 

to the same reduced form, hence social effects are not identified. If
G3 = λ0 I + λ1 G + λ2 G2 , (β, γ , δ) and (β 0 , γ 0 , δ 0 ) lead to the same
reduced form of (I − G)y if and only if the following three equations
are satisfied

Proof of Proposition 3. Suppose that students do not interact in
groups and that the network is transitive. We make use of standard
properties of directed graphs, see e.g., Bang-Jensen and Cutin
(2000). Say that there is a path between i and j in the network if
Gij > 0 or if there exist i1 , . . . , il such that Gii1 Gi1 i2 . . . Gil j > 0. A
cycle is a path between i and i. A strong component of the network
is a maximal set S of students such that there is a path between
any two students in S. The original network induces an acyclic
network on the strong components. Thus, there always exist a
strong component S such that ∀i ∈ S , Pi ⊂ S. Transitive directed
graphs admit a simple characterization, see Proposition 4.3.1 in
Bang-Jensen and Cutin (2000). Especially, their strong components
are complete, and the relations between strong components are
also complete. Formally, let S and S 0 be two strong components.
Then, ∀i 6= j ∈ S , Gij > 0. And, if there is a path between i ∈ S and
i0 ∈ S 0 , then for all j ∈ S and j0 ∈ S 0 , Gjj0 > 0.
We know that there exists two strong components S1 and S2 of
sizes s1 , s2 such that: (1) ∀i ∈ S1 , Pi = S1 − {i}, and (2) ∀i ∈ S2 ,
Pi = S ∪ S2 − {i} where S is a group size s ≥ s1 such that S1 ⊂ S
and S2 ∩ S = ∅. S1 is a strong component, which is not affected by
any other strong component. S2 is a strong component affected by
S1 . We can find S1 6= S2 since students do not interact in groups.
Suppose first that s1 , s2 ≥ 2. For any i 6= j ∈ S1 , Gij = s 1−1

γ − γ 0 + λ0 (β 0 δ − βδ 0 ) = 0
δ − δ 0 − (γ − γ 0 ) + γ 0 β − γ β 0 + λ1 (β 0 δ − βδ 0 ) = 0
−(δ − δ 0 ) − β 0 (δ − γ ) + β(δ 0 − γ 0 ) + λ2 (β 0 δ − βδ 0 ) = 0.

1

Since no student is isolated, Gι = ι, and λ0 + λ1 + λ2 = 1. This
means that the third equation can be simply obtained by summing
the first two. Hence two equations only need to be satisfied, and
social effects are not identified.
With K characteristics, θ and θ 0 lead to the same reduced form
iff ∀k, (I −β G)−1 (γk I +δk G)(I − G) = (I −β 0 G)−1 (γk0 I +δk0 G)(I − G).
Suppose that δk0 + γk0 β 6= 0. If I, G, G2 , and G3 are linearly
independent, then β = β 0 , γk0 = γk00 and δk0 = δk0 0 . For any other
k, multiplying by I − β G leads to (γk − γk0 )I + (δk − δk0 + γk0 − γk )G +
(δk0 − δk )G2 = 0, hence γk = γk0 and δk = δk0 . 
Proof of Proposition 5. We first show that social effects are
identified if and only if the following condition is true. If µ0 I +
µ1 G + µ2 G2 has identical rows, then µ0 = µ1 = µ2 = 0.
Suppose that the condition holds. In the proof, we omit the
index l for clarity. Eq. (14) becomes:
y−

1
n

n
X
i =1

!
yi

ι = (I − β G)−1 (γ I + δ G)x − ϕ(x, θ)ι + ν0

54

Y. Bramoullé et al. / Journal of Econometrics 150 (2009) 41–55

where θ = (β, γ , δ), and ϕ(x, θ) = 1n ι0 (I − β G)−1 (γ I + δ G)x
is linear in x. Next suppose that (β, γ , δ) and (β 0 , γ 0 , δ 0 ) lead to
the same reduced form. It means that ∀x, (I − β G)−1 (γ I + δ G)x −
ϕ(x, θ)ι = (I −β 0 G)−1 (γ 0 I +δ 0 G)x −ϕ(x, θ 0 )ι. Multiplying by I −β G
and I − β 0 G gives ∀x, [(γ − γ 0 )I + (δ − δ 0 + γ 0 β − γ β 0 )G + (β 0 δ −
βδ 0 )G2 ]x = (1 − β)(1 − β 0 )[ϕ(x, θ) − ϕ(x, θ 0 )]ι. This means that
the matrix (γ − γ 0 )I + (δ − δ 0 + γ 0 β − γ β 0 )G + (β 0 δ − βδ 0 )G2 has
identical rows. Thus, γ = γ 0 , δ + γ 0 β = δ 0 + γ β 0 , and β 0 δ = βδ 0 ,
and, using the argument in the proof of Proposition 1, social effects
are identified.
Conversely, suppose that the condition does not hold. There
exist µ0 , µ1 , µ2 not all equal to zero such that µ0 I + µ1 G + µ2 G2
has identical rows. We follow the previous reasoning in reverse.
We can find θ 6= θ 0 such that µ0 = γ −γ 0 , µ1 = δ −δ 0 +γ 0 β −γ β 0 ,
and µ2 = β 0 δ − βδ 0 . Then, (γ − γ 0 )I + (δ − δ 0 + γ 0 β −
γ β 0 )G + (β 0 δ − βδ 0 )G2 has identical rows. There exists (rj ) such
that ∀x, [(γ P
−γ 0 )I +(δ−δ 0 +γ 0 β −γ β 0 )G +(β 0 δ−βδ 0 )G2 ]x = (1 −
0
β)(1 − β )( nj=1 rj xj )ι. Dividing by I − β G and I − β 0 G means that

P
∀x, (I − β G)−1 (γ I +δ G)x −(I −β 0 G)−1 (γ 0 I +δ 0 G)x = ( nj=1 rj xj )ι.
Pn
Averaging over the network yields ϕ(x, θ) − ϕ(x, θ 0 ) =
j =1 r j x j .
−1
0 −1
Therefore, ∀x, (I −β G) (γ I +δ G)x −ϕ(x, θ)ι = (I −β G) (γ 0 I +
δ 0 G)x − ϕ(x, θ 0 )ι. This means that θ and θ 0 have the same reduced

form, hence social effects are not identified.
Next, suppose that µ0 I + µ1 G + µ2 G2 has identical rows. Since
Gι = ι, multiplying by G leaves the matrix unchanged. Thus,
µ0 I + µ1 G + µ2 G2 = µ0 G + µ1 G2 + µ2 G3 . If I, G, G2 , and G3
are linearly independent, then µ0 = µ1 = µ2 = 0 and social
effects are identified. If G3 = λ0 I + λ1 G + λ2 G2 , and µ2 = 0, then
µ0 = µ1 = 0. If µ2 6= 0, we can set µ2 = 1. This yields µ0 = λ0
and µ1 = λ0 + λ1 . In other words, either λ0 I + (λ0 + λ1 )G + G2
has identical rows and social effects are not identified, or it does
not have identical rows and social effects are identified. In the
first case, introduce M = λ0 I + (λ0 + λ1 )G + G2 . Notice that
GM = λ0 G + (λ0 + λ1 )G2 + G3 = M. It means that any column
Mj of M satisfies GMj = Mj . Suppose that rank(I − G) = n − 1.
Then, dim Ker (I − G) = 1. Therefore, Mj = ξj ι and all rows of
M are equal to (ξ1 , . . . , ξnC ). Thus, social effects are not identified.
Conversely, suppose that M has identical rows. Take a vector u such
that Gu = u. Then, Mu = (2λ0 + λ1 + 1)u. Since M has identical
rows, Mu has identical elements. As soon as 2λ0 + λ1 + 1 6= 0,
ui = uj and dim Ker (I − G) = 1, hence rank(I − G) = n − 1.
With K characteristics, θ and θ 0 lead to the same reduced form
iff ∀k, (I − H)(γk I +δk G)(I −β G)−1 = (I − H)(γk0 I +δk0 G)(I −β 0 G)−1 .
Suppose that δk0 + γk0 β 6= 0. If G satisfies the condition of
Proposition 5, then β = β 0 , γk0 = γk00 and δk0 = δk0 0 . For any
other k, right multiplying by I − β G leads to (I − H)(γk I + δk G) =
(I − H)(γk0 I + δk0 G) hence γk = γk0 and δk = δk0 .
Finally, to extend Proposition 5 to a setting with stochastic
networks, we just have to replace n − 1 by n − d where d
is the number of distinct networks in support of the network’s
distribution and n is the size of the large network G. 
Appendix B. Perfect collinearity and identification
Result 1. Suppose that γ β + δ 6= 0 and that no student is isolated.
Then,
(1) ∀x, E(Gy|x) = λ0 ι + λ1 x + λ2 Gx ⇒ G2 = µ0 I + µ1 G.
(2) G2 = µ0 I + µ1 G and µ0 β 6= −1 ⇒ ∀x, E(Gy|x) =
λ0 ι + λ1 x + λ2 Gx.
α
Proof. Recall, from (1), that y = 1−β
ι + (I − β G)−1 (γ I + δ G)x +
−1
(I − β G) . Multiplying by G and taking the expectation yields:

E(Gy|x) =

α
ι + (I − β G)−1 (γ G + δ G2 )x.
1−β

One can then see that ∀x, E(Gy|x) = λ0 ι+λ1 x +λ2 Gx is equivalent
α
to λ0 = 1−β
and

λ1 I + (λ2 − βλ1 − γ )G − (βλ2 + δ)G2 = 0.
If I, G, G2 are linearly independent, then λ1 = 0, λ2 = γ , hence
βγ + δ = 0, which is not possible. This shows that ∀x, E(Gy |
x) = λ0 ι + λ1 x + λ2 Gx ⇒ G2 = µ0 I + µ1 G.
Reciprocally, suppose that G2 = µ0 I + µ1 G. We want to find
λ1 and λ2 such that βλ2 + δ 6= 0, λ1 = µ0 (βλ2 + δ) and
λ2 − βλ1 − γ = µ1 (βλ2 + δ). This is equivalent to λ1 − µ0 βλ2 =
µ0 δ and βλ1 + (µ1 β − 1)λ2 = −γ − µ1 δ . This system has a
unique solution in λ1 and λ2 if and only if µ1 β − 1 + µ0 β 2 6= 0.
Since G2 ι = ι, µ0 + µ1 = 1 and the last condition is equivalent to
µ0 β 6= −1. If µ0 β = −1, then the system has no solution since
γ β + δ 6= 0.
With K characteristics, denote by xk the vector associated
with characteristic k. We can show through the same reasoning
PK
k
k
that ∀x1 , . . . , xK , E(Gy|x) = λ0 ι +
k=1 (λ1k x + λ2k Gx ) ⇒
G2 = µ0 I + µ1 G and that G2 = µ0 I + µ1 G and µ0 β 6=
PK
k
k
−1⇒∀x1 , . . . , xK , E(Gy|x) = λ0 ι +
k=1 (λ1k x + λ2k Gx ).
1
K
2 1
1
K
Observe that here the variables (ι, x , . . . , x , Gx , . . . , Gx , G x ,
. . . , G2 xK , . . .) can be used to instrument for Gy. 
Result 2. Suppose that γ β + δ 6= 0 and that no student is isolated.
Then,
(1) ∀x, E[(I − G)Gy|x] = λ0 (I − G)x + λ1 (I − G)Gx ⇒ G3 =
µ0 I + µ1 G + µ2 G 2 .
(2) G3 = µ0 I + µ1 G + µ2 G2 and µ0 β(1 + β) + µ1 β 6= −1 ⇒
∀x, E[(I − G)Gy|x] = λ0 (I − G)x + λ1 (I − G)Gx.
Proof. Similarly, E[(I − G)Gy|x] = (I − β G)−1 (γ G + δ G2 )(I − G)x.
Therefore, one can see that ∀x, E[(I − G)Gy|x] = λ0 (I − G)x +
λ1 (I − G)Gx is equivalent to

λ0 I + (λ1 − (1 + β)λ0 − γ )G + (γ − δ − λ1 − β(λ1 − λ0 ))G2
+ (βλ1 + δ)G3 = 0.
If I, G, G2 , G3 are linearly independent, then λ0 = 0, λ1 = γ , hence
βγ + δ = 0, which is not possible.
Reciprocally, suppose that G3 = µ0 I + µ1 G + µ2 G2 . We want
to find λ1 and λ2 such that βλ1 + δ 6= 0, −λ0 = µ0 (βλ1 + δ),
−(λ1 − (1 + β)λ0 − γ ) = µ1 (βλ1 + δ), and (−γ + δ + λ1 + β(λ1 −
λ0 )) = µ2 (βλ1 + δ). Since µ0 + µ1 + µ2 = 1, one can see that
the third equation is a simple linear combination of the first two.
Thus, only the first two have to be satisfied. They are equivalent to
λ0 +µ0 βλ1 = −µ0 δ and (1 +β)λ0 −(1 +µ1 β)λ1 = µ1 δ −γ . This
system as a unique solution if and only if µ0 β(1 + β) + µ1 β 6= −1.
As in the previous result, the generalization to K characteristics is
straightforward. Here, the variables ((I − G)x1 , . . . , (I − G)xK , (I −
G)Gx1 , . . . , (I − G)GxK , (I − G)G2 x1 , . . . , (I − G)G2 xK , . . .) can be
used to instrument for (I − G)Gy. 
References
Anselin, L., Florax, R., Rey, S. (Eds.), 2004. Advances in Spatial Econometrics,
Methodology, Tools and Applications. Springer-Verlag, Heidelberg.
Bang-Jensen, J., Cutin, G., 2000. Digraphs: Theory, Algorithms and Applications.
In: Monographs in Mathematics, Springer, London.
Bertrand, M., Luttmer, E.F.P., Mullainathan, S., 2000. Network effects and welfare
cultures. Quarterly Journal of Economics 115, 1019–1056.
Blume, L., Durlauf, S., 2005. Identifying social interactions: A review, Mimeo,
University of Wisconsin.
Bramoullé, Y., Djebbari, H., Fortin, B., 2006. Identification of peer effects through
social networks, Discussion Paper No. 2652, IZA.
Brock, W., Durlauf, S., 2001a. Discrete choice with social interactions. Review of
Economic Studies 68 (2), 235–260.
Brock, W., Durlauf, S., 2001b. Interaction-based models. In: Heckman, J., Leamer, E.
(Eds.), Handbook of Econometrics, vol. 5. North-Holland, Amsterdam.
Brock, W., Durlauf, S., 2003. Multinomial choice with social interactions, SSRI
Working Paper No. 2003-1, University of Wisconsin.

Y. Bramoullé et al. / Journal of Econometrics 150 (2009) 41–55
Brock, W., Durlauf, S., 2007. Identification of binary choice models with social
interactions. Journal of Econometrics 140 (1), 57–75.
Calvó-Armengol, A., Patacchini, E., Zenou, Y., 2005. Peer effects and social networks
in education and crime, Mimeo, Universitat Autonoma de Barcelona.
Case, A., 1991. Spatial patterns in household demand. Econometrica 59 (4), 953–965.
Chamberlain, G., 1984. Panel data. In: Griliches, Z., Intriligator, M.D. (Eds.),
Handbook of Econometrics. In: Handbooks in Economics, vol. 2. North-Holland,
Amsterdam, pp. 1248–1318.
Cliff, A., Ord, J.K., 1981. Spatial Processes. Pion, London.
Cohen-Cole, E., 2006. Multiple groups identification in the linear-in-means model.
Economics Letters 92 (2), 157–162.
Conley, T., Udry, C., 2005. Learning about a new technology: Pineapple in Ghana,
Mimeo, Yale University.
Davezies, L., d’Haultfoeuille, X., Fougère, D., 2006. Identification of peer effects using
group size variation, Discussion Paper No. 2324, IZA.
Dercon, S., De Weerdt, J., 2006. Risk-sharing networks and insurance against illness.
Journal of Development Economics 81 (2), 337–356.
De Georgi, G., Pellizzari, M., Redaelli, S., 2007. Be Careful of the Books you Read as
of the Company you Keep:Evidence on Peer Effetcs in Educational Choices, IZA
DP No 2833.
Evans, W., Oates, W., Schwab, R., 1992. Measuring peer group effects: A study of
teenage behavior. Journal of Political Economy 100 (5), 966–991.
Erdös, P., Rényi, A., 1959. On random graphs. Publicationes Mathematicae 6,
290–297.
Freeman, L.C., 2004. The development of social network analysis: A study in the
sociology of science. BookSurge, North Charleston, SC.
Gaviria, A., Raphael, S., 2001. School based peer effects and juvenile behavior.
Review of Economics and Statistics 83 (2), 257–268.
Graham, B.S., 2008. Identifying social interactions through conditional variance
restrictions. Econometrica 76 (3), 643–660.
Graham, B.S., Hahn, J., 2005. Identification and estimation of the linear-in-means
model of social interactions. Economics Letters 88 (1), 1–6.
Glaeser, E., Sacerdote, B., Scheinkman, J., 1996. Crime and social interaction.
Quarterly Journal of Economics 111 (2), 507–548.
Goyal, S., van der Leij, M., Moraga-Gonzalez, J.L., 2006. Economics: An emerging
small world. Journal of Political Economy 114 (2), 403–412.
Ioannides, Y., Soetevent, A., 2007. Social networking and individual outcomes
beyond the mean field case. Journal of Economic Behavior and Organization.
Ioannides, Y., Zabel, A., 2003. Neighborhood effects and housing demand. Journal of
Applied Econometrics 18 (5), 563–584.
Kelejian, H.H., Prucha, I.R., 1998. A generalized spatial two-stage least squares
procedure for estimating a spatial autoregressive model with autoregressive
disturbances. Journal of Real Estate Finance and Economics 17, 99–121.
Krauth, B., 2006. Simulation-based estimation of peer effects. Journal of Econometrics 133 (1), 243–271.

55

Jackson, M., 2006. The Economics of Social Networks. In: Proceedings of the 9th
World Congress of the Econometric Society, vol. 1. Cambridge University Press,
Cambridge.
Laschever, R., 2005. The doughboys network: Social interactions and labor market
outcomes of world war I veterans, Mimeo, Northwestern University.
Lee, L.F., 2003. Best spatial two-stage least squares estimators for a spatial
autoregressive model with autoregressive disturbances. Econometric Reviews
22 (4), 307–335.
Lee, L.F., 2007. Identification and estimation of econometric models with group
interactions, contextual factors and fixed effects. Journal of Econometrics 140
(2), 333–374.
Lin, X., 2007. Peer effects and student academic achievement: An application of
spatial autoregressive model with group unobservables, Mimeo, Department
of Economics, Tsinghyua University, Beijing.
Manski, C., 1993. Identification of endogenous social effects: The reflection problem.
Review of Economic Studies 60 (3), 531–542.
Manski, C., 1995. Identification Problems in the Social Sciences. Harvard Univ. Press,
Cambridge.
Moffitt, R., 2001. Policy interventions low-level equilibria, and social interactions.
In: Durlauf, Steven, Young, Peyton (Eds.), Social Dynamics. MIT Press.
Newman, M., 2001. The structure of scientific collaborations. Proceedings of the
National Academy of Sciences of the United States of America.
Rothenberg, R., 1995. Commentary: Sampling in social networks. Connections 18
(1), 104–110.
Sacerdote, B., 2001. Peer effects with random assignment: Results for darmouth
roommates. Quarterly Journal of Economics 116 (2), 681–704.
Saez, E., Duflo, E., 2003. The role of information and social interactions in retirement
plan decisions: Evidence from a randomized experiment. Quarterly Journal of
Economics 118, 2003, 815–842.
Soetevent, A., 2006. Empirics of the identification of social interactions: An
evaluation of the approaches and their results. Journal of Economic Surveys 20
(2), 193–228.
Soetevent, A., Kooreman, P., 2007. A discrete choice model with social interactions;
with an application to high school teen behavior. Journal of Applied
Econometrics 22 (3), 599–624.
Trogdon, J., Nonnemaker, J., Pais, J., 2008. Peer effects in adolescent overweight.
Journal of Health Economics 27 (5), 1388–1399.
Wasserman, S., Faust, K., 1994. Social Network Analysis: Methods and Applications.
Cambridge University Press.
Watts, D.J., Strogatz, S.H., 1998. Collective dynamics of small-world networks.
Nature 393, 440–442.
Weinberg, B., 2007. Social interactions and endogenous associations, NBER Working
Paper No. 13038.
Zimmerman, D., 2003. Peer effects in academic outcomes: Evidence from a natural
experiment. Review of Economics and Statistics 85 (1), 9–23.

