Econometric Models for Count Data with an Application to the Patents-R & D Relationship
Author(s): Jerry Hausman, Bronwyn H. Hall, Zvi Griliches
Source: Econometrica, Vol. 52, No. 4 (Jul., 1984), pp. 909-938
Published by: The Econometric Society
Stable URL: http://www.jstor.org/stable/1911191
Accessed: 19/11/2010 12:39
Your use of the JSTOR archive indicates your acceptance of JSTOR's Terms and Conditions of Use, available at
http://www.jstor.org/page/info/about/policies/terms.jsp. JSTOR's Terms and Conditions of Use provides, in part, that unless
you have obtained prior permission, you may not download an entire issue of a journal or multiple copies of articles, and you
may use content in the JSTOR archive only for your personal, non-commercial use.
Please contact the publisher regarding any further use of this work. Publisher contact information may be obtained at
http://www.jstor.org/action/showPublisher?publisherCode=econosoc.
Each copy of any part of a JSTOR transmission must contain the same copyright notice that appears on the screen or printed
page of such transmission.
JSTOR is a not-for-profit service that helps scholars, researchers, and students discover, use, and build upon a wide range of
content in a trusted digital archive. We use information technology and tools to increase productivity and facilitate new forms
of scholarship. For more information about JSTOR, please contact support@jstor.org.

The Econometric Society is collaborating with JSTOR to digitize, preserve and extend access to Econometrica.

http://www.jstor.org

Econometrica,Vol. 52, No. 4 (July, 1984)

ECONOMETRIC MODELS FOR COUNT DATA WITH AN
APPLICATION TO THE PATENTS-R& D RELATIONSHIP
BY JERRY HAUSMAN, BRONWYN H. HALL, AND Zvi GRILICHES'
This paper focuses on developing and adapting statistical models of counts (nonnegative
integers) in the context of panel data and using them to analyze the relationship between
patents and R & D expenditures. Since a variety of other economic data come in the form
of repeated counts of some individual actions or events, the methodology should have wide
applications.
The statistical models we develop are applications and generalizations of the Poisson
distribution. Two important issues are (i) Given the panel nature of our data, how can we
allow for separate persistent individual (fixed or random) effects? (ii) How does one
introduce the equivalent of disturbances-in-the-equation into the analysis of Poisson and
other discrete probability functions?
The first problem is solved by conditioning on the total sum of outcomes over the
observed years, while the second problem is solved by introducing an additional source of
randomness, allowing the Poisson parameter to be itself randomly distributed, and compounding the two distributions. Lastly, we develop a test statistic for the presence of serial
correlation when fixed effects estimators are used in nonlinear conditional models.

INTRODUCTION

THIS PAPER AROSE out of the analysis of a specific substantive problem: the
relationship between the research and development (R & D) expenditures of firms
and the number of patents applied for and received by them. There are two
salient aspects of the data we wish to analyze. (i) Our dependent variable is a
count of the total number of patents applied for by a particular firm in a given
year. It varies from zero to several or even many, for some firms. (ii) We have
repeated observations for the same firms. That is, our data form a combined
time-series cross-section panel. In this paper, we focus, therefore, on developing
and adapting statistical models of counts (nonnegative integers) in the context of
panel data and using them to analyze the relationship between patents and
R&D expenditures. This is not, however, the only possible application for the
methods discussed in this paper. A variety of other economic data come in the
form of repeated counts of some individual actions or events. The number of
spells of sickness in a year, the number of records purchased per month, the
number of cars owned, or the number of jobs held during a year, all have
nonnegligible probabilities of zero and are nonnegative integers.
The statistical models we develop are applications and generalizations of the
Poisson distribution. After rewriting the Poisson distribution as a function of a
number of independent variables we have to deal with two additional issues.
(i) Given the panel nature of our data, how can we allow for separate persistent
individual (fixed or random) effects? (ii) How does one introduce the equivalent
'We are indebted to NSF Grants SES79-24108, SOC78-04279, and PRA79-13740 for financial
support of this work. Whitney Newey provided research assistance. A referee provided helpful
comments.
909

910

J. HAUSMAN, B. H. HALL, AND Z. GRILICHES

of disturbance-in-the-equation into the analysis of Poisson and other discrete
probability functions?
The first problem is solved by conditioning on the total sum of outcomes over
the observed years, while the second problem is solved by introducing an
additional source of randomness, allowing the Poisson parameter to be itself
randomly distributed, and compounding the two distributions. The relevant
likelihood functions and the associated computational methods are described in
the body of the paper.
The substantive application continues the work of Pakes and Griliches [25]. In
that work patent data for 8 years (1968-1975) and 121 U.S. companies were
analyzed as a function of their current and lagged R & D expenditures. A log-log
functional form was used and the "zero value" problem was "solved" by
(a) choosing companies so as to minimize this problem (only 8 per cent of the
observations were zero in any one year) and (b) setting zeroes equal to one and
adding a dummy variable to allow the equation to choose implicitly another
value between zero and one. The questions of interest were (a) the strength (fit)
of the relationship between patents and R&D, (b) the elasticity of patents with
respect to R&D expenditures, (c) the shape of the distributed lag of R&D
effects, and (d) the presence and sign of a trend in this relationship. The major
findings were: A high fit (R2 .9) cross-sectionally and a lower (R2 .3) though
still statistically significant fit in the "within" time series dimension of the data.
The estimated elasticity was around 1.0 in the cross-sectional dimension, dropping to about .5 in the within, shorter-run time dimension. The shape of the
distributed lag was not well defined, with some indication of lag-truncation bias
(the possible influence of pre-sample unmeasured R & D expenditures) which
could not, however, be well distinguished from a fixed firm effect.2 A negative
time trend was found in most of the examined data subsets.
In this paper we wish to reexamine the earlier findings using a more appropriate model for such data, a model that reflects explicitly its integer nature. We do
not expect the results to change much since the "zero" problem is relatively
minor in this sample (8 per cent). We are interested, however, in developing this
methodology because the sample is being expanded to encompass many more
smaller firms with a concomitant increase in the importance of such issues. We
use a sample of 128 firms for the 7 years 1968-1974. The patent data were
tabulated for us by the Office of Technology Assessment and Forecasting of the
U.S. Patent Office and the R&D data were taken from the Compustat tape and
other sources (see Pakes and Griliches [25] for more detail on sample derivation
and construction), and deflated by an approximate R&D cost deflator.
The rest of the paper is organized as follows: Section 1 presents the simple
Poisson regression model and applies it to our data. Section 2 develops a
generalization which allows each firm to have its own average propensity to
21t is difficult to distinguish in a short series between a left-out pre-sample cumulated R & D value
whose effect is dying out slowly and a "permanent fixed" individual firm effect. See Griliches and
Pakes [15] for further discussion of these issues.

ECONOMETRIC MODELS

911

patent by conditioning separately the count distribution of each firm on the sum
of its patents for the whole period. Section 3 allows for the "over-dispersion" in
the data by letting each firm's Poisson parameter have a random distribution of
its own, leading to the estimation of a negative-binomial model for these data.
Section 4 explores in our nonlinear context the parallels to the "within""between" dichotomy in linear models. Section 5 summarizes the major methodological and substantive results and discusses some possible future lines of work.
1. THE POISSON MODEL AND APPLICATION

The Poisson distribution is often a reasonable description for events which
occur both "randomly and independently" in time.3 It seems a natural first
assumption for many counting problems in econometrics. Let us denote the
Poisson parameter as X, and consider specifications of the form logX = X,Bwhere
X is a vector of regressors which describe the characteristics of an observation
unit in a given time period. Denote nit as the observed event count for unit i
during the time period t. The advantages of the Poisson specification are: (i) In
many ways it is analogous to the familiar econometric regression specification. In
particular, E(ni, IXi,) = Xi,. Furthermore, estimation of unknown parameters is
straightforward and is done either by an iterative weighted least squares technique or by a maximum likelihood algorithm. The log likelihood function is
globally concave so that maximization routines converge rapidly. (ii) The "zero
problem," ni, = 0, is a natural outcome of the Poisson specification. In contrast to
the usual logarithmic regression specification we need not truncate an arbitrary
continuous distribution. Likewise, the integer property of the outcomes ni, is
handled directly. For large nit a continuous approximation often suffices. But for
small nit, a specification which models the counting properties of the data (both
large and small) seems in order. (iii) The Poisson specification allows for
convenient time aggregation so long as its basic assumption of time independence holds true. Thus, if the counting process is Poisson over time t = 1, T with
parameter Xi,, then the aggregate data over period one to T are also Poisson with
parameter Xi = ET Xi,. This property permits the convenient generalization of
the Poisson model to be developed below. The time independence property is
also a potential weakness of our specification given the often noted serial
correlation of residuals in econometric specifications. We will attempt to distinguish carefully between true time independence versus apparent dependence due
to unobserved heterogeneity of the individual units.
Our basic Poisson probability specification is
(1 1)

pr(ni,) =

f(nit)=

e )-n

n!

_

3It has a long history in the analysis of accident data with perhaps the most famous example being
von Bortkiewicz's 1898 study of accidental death by mule kick in the German army. The Poisson and
subsequent models that we consider might also usefully be analyzed as members of the "generalized
linear model" class of Nelder and Wedderburn [22]. See also Johnson and Kotz [19]. Gilbert [12] has
applied the Poisson model to economic data.

912

J. HAUSMAN, B. H. HALL, AND Z. GRILICHES

In our application, i indexes firms and t indexes years and we specify log i,
= Xi,/. Note that Xi, is a deterministic function of Xi,, and the randomness in the
model comes from the Poisson specification for the ni,,. The moment generating
function of the Poisson distribution is m(t) = e- eXe so that the first two
moments are E(nj,) = Xi, and V(ni,) = Xi,. The regression property of this specification arises from E(ni,) = ?i,, but it is not uncommon to find that the variance
of nit is larger than the mean empirically, implying "overdispersion" in the data.
After an initial exploration of the Poisson model, we shall consider the possibility
of such overdispersion.
The log likelihood of a sample of N firms over T time periods for this Poisson
specification is
N

(1.2)

L(/)

T

Z

=

i=1 t=1

[nil!-ex-

+ nitXit/].

The gradient and Hessian take the forms
OL
(1.3)

-e
Xj`j~(n,,
=

a2L

=

[

(Xi'Xi

) e xt-8

The first order conditions indicate that /3 can be estimated either by an iterative
nonlinear weighted least squares program with nt -Xit as the "residual" or by a
maximum likelihood (ML) program. The Hessian demonstrates that the likelihood function is globally concave as long as X is of full column rank and e XI
does not go to zero for all Xit. With a globally concave likelihood function, a
wide choice of ML algorithms can be used. In our applications convergence to
the global maximum was always rapid. The variance matrix of the asymptotic
distribution V(,/) is calculated from the Hessian matrix evaluated at,.
We fit our initial Poisson specification to a model with current R & D and five
lagged values of R & D, and a time trend. The results are found in Table I. We
also present the corresponding estimates of a least squares regression of log(ni,)
= XitJ + Eitwhere log(nit) is set to zero and a dummy variable used when nit = 0.
The results of the Poisson model are broadly similar to OLS although note that
the estimated standard errors of the Poisson estimates are approximately three
times smaller. The coefficient of current R &-D is higher but the sum of the lag
coefficients are quite similar. We note an exogeneous decrease in patents of 6 per
cent per year. Lastly, we have the somewhat disturbing pattern of a U-shaped
distributed lag which may well indicate a substantial truncation effect. This
pattern disappears, however, when we allow for firm specific effects below.
We now consider alternative specifications of the basic Poisson model. In
column 4 of Table I we include only contemporaneous R & D since we find later
in the paper that when firm specific effects are added the lagged effects become
quite small and difficult to identify. Note that the coefficient of current R&D is
very close to the sum of the coefficients in our initial specification. The ex-

913

ECONOMETRIC MODELS

log
2For
4The
3The
IThe
5Sum
log the
sample
OLS
book
scientific
evaluated is
at
128
sector
variable
estimates,
is
firms,
midpointthe
thedummy
of
is
annual
the for
natural
data
dependent
firms
period,
in from
logarithm
1971. thevariable
1968
of is
to
log
thedrug,
of
1974.
In
inflation
computer,
patents,
column
with
a 1,
adjusted
scientific
book

log
log
log
sum
time
time
Ro
x
logR_
of
1
R_3logR-2
logR_4
dummy3 logR-5
standard dummy
book
intercept
sector)
log
log(nil
R =
likelihood
Ro
coefficients
error
value4
0)
of
(scientific
residuals

0.08 5.36 0.52

Mean

(1.64)
(1.63)
(1.62)
(1.61)
(1.62)
(1.64)

-

.88
10,621.1

deviations

.84
.869

are
chemical,
firms
observations
in
in
and
with
1971.
zero
electric

11,198.4

industries.

OF

(.07)
(.05)
(.06)
(.05)
(.05)
(.03)
(.002)

(0.20)

Poisson
THE

TABLE
PATENTS
I

1.37
1.58

-.06.64 .01 -.08-.05.12 .21

(.12)
(.08)

(.02)
(.15)
(.19)
(.18)
(.18)
(.17)
(.12)

OLS2

.87

patents.

ESTIMATES

-.06.53 .11 .13 .09 .13 .36

1.68

-

parentheses.

component

1.962.032.082.122.152.17

(2.00)

dummy
standard
value for
instrument,
of
the

Variable

.81
.914

MODEL-TOTALS

1.55

.04

.87

(.018)

(.002)

(.004)

PoissonCoefficients

1.411.32

-.009

(.12)
(.08)

.81
OLS

(.02)
(0.15)

-

.575
9,077.5

.39.24

.37 .02.04

(.04)
(.01)
(.004) (.01)
(.008)

.65
Poisson

(.01)

914

J. HAUSMAN, B. H. HALL, AND Z. GRILICHES

ogeneous time effect has now decreased in magnitude to 4 per cent per year. In
column 5 we find very similar though slightly lower results in the OLS regression.
As a first-step in accounting for differences in propensity to patent across these
firms which are drawn from all manufacturing sectors, we add a dummy variable
for the scientific sector which includes firms in the drug, computer, scientific
instruments, chemical, and electrical equipment industries, and a proxy for firm
size, the inflation adjusted book value of the firm in 1971. Both variables have
strong positive effects on the expected number of patents. In addition, we
interact R&D with time to attempt to sort out a pure exogenous effect of time
from a decrease in the effectiveness of R&D over time. The estimates indicate
that the effect of R&D seems to be decreasing since the estimated coefficient is
-.02 while the time coefficient has now switched sign to +.04. Both effects are
precisely estimated and they tend to persist as we move to more elaborately
specified models.
To evaluate the adequacy of the Poisson specification we now turn to an
investigation of the residuals. Starting with the Poisson residual ui, = nit -Xi we
define the standardized residual as uit divided by its estimated standard deviation: Eit = (nit- Xig)/ X1t.We use these residuals to test our model specification
in two ways.4 First, the independence assumption can be tested by forming the
7 x 7 covariance matrix I = (1/N)ENY (EiE) where Eiis a vector of residuals for
firm i. The estimated correlation matrix has off diagonal element which equal .8
approximately. Significant correlation exists which casts serious doubts on the
adequacy of our Poisson specification. Next we consider the variance property.
Given the Poisson specification the variance of the Ei,'s should be unity. In Figure
1 we show a log-log plot of ui2= (1/(T - 1))E I(Ui, _ i)2 for Ri= (1/T)E,Ei,
against Xi= (1/ T)EtXiX.We do not find the expected one-to-one relationship at
all. The variance increases considerably more rapidly than does the mean. A
simple regression of log i2 on log Xi takes the form, log a72= -.68 + 1.42 log X.
Thus, we need also to attend to this failure of our initial specification.
2. FIRM SPECIFIC EFFECTS

Investigation of the standardized residuals from the Poisson estimation clearly
indicates the presence of serial correlation. Such a finding is not uncommon in
panel data of the type we are using. If unobserved firm specific effects exist, the
residuals for a given firm might all be of the same sign indicating the way in
which the firm deviates from the "average firm." We know from the analysis of
linear panel data models that there are two methods which can be used for this
type of problem: random effects and fixed effects. We explore first the random
effects specification. In the regression model this implies an equicorrelated
4One potential problem arises here. Since a common f8 is used to form u, under the null hypothesis
of zero covariance of the true ui,'s, induced covariance of order (1/NT) exists among the u,,'s. But
since NT = 896 in our sample, this problem and the associated Cox-Snell [11] corrections are quite
small.

915

ECONOMETRIC MODELS

log
A
2

-2

3

5

6

7

8

9

-2

0~~~~~~~~~~~~
-1

FIGURE

3~~~~

0

I-Within

1

firm

*
2~~~~~~~~~
*

2
*/Xi

residual
log

*@

variance 4

*@

*

3

~~~~~~~~
//i

*@/

*@

X

*

*a
*0

versus

*

*
5

/

*

*
0@

average

6

lambda.

7

Best
Fit
9

Line

Log(mean)

Log(variance)

916

J. HAUSMAN, B. H. HALL, AND Z. GRILICHES

covariance matrix and is sometimes sufficient to explain the apparent serial
correlation. In our Poisson specification the random effect has somewhat similar
implications. We specify Xi, = Xi,ai where ai is a random firm specific effect. The
Poisson parameter Xi, is now also a random variable rather than a deterministic
function of Xi,. Correlation of Xi, and Xi,, (t # t') arises from the ai while Xi, and
Xj are uncorrelated by the assumption of independent a.
The other approach to firm specific effects is to condition on the a-iand apply
conditional maximum likelihood techniques of Anderson [1, 2]. We then have a
fixed effects specification. While asymptotic efficiency is sacrificed by the conditioning, no distribution need be specified for the 5-i. Perhaps more important
while we might specify the a-ito be random, conditional on the Xi, they may no
longer be randomly distributed or exchangeable, in the sense of diFinetti. For
example, firms which are better at producing patents for unobserved reasons
may invest more in R&D because they obtain a higher return to the expenditures. The random effects specification is then no longer valid.5 We use Hausman's [17] test to decide whether there exists a significant nonrandom correlation
between the Xit and the a-i's.
We first consider the random effects specification. Because Xit needs to be
positive, we write it in the form
eXit = Xiai =

where [i is the firm specific effect and [t is the overall intercept. We include [t in
so that Eel = 1. The Poisson probability specification then becomes

Xi,

e

(2.1)

The joint density of

(2.2)

-,\e,

pr(ni, IXi, , Ai)=

pr(nil,

(nil,...

. . .,
=pr(nil,

(Xi,e87"

n

nit

,

niT)

i I Xil

I..

. .. ., niT

IXil

niT, I

-e
nIIt!
nit.

2`e
2'"AZg(

and [i takes the form
I XiT )

***

XiT '1 l)g

(l 1

1U,

where g( pi) is the probability density function of yt. In equation (2.2) we have
made the important assumption that the conditional density of [i given Xit equals
the unconditional density of [i. Thus, the [i's are assumed to be randomly
distributed across firms. Since [i is an unobservable random variable we now
integrate it out from equation (2.2). To do so, we assume that ai = eA is
distributed as a gamma random variable with parameters (3, 8), so that Eai = 1
5This problem has been recently discussed by Mundlak [21], Hausman [17], Chamberlain [7], and
Hausman-Taylor [18]. Gourieroux et al. [13] emphasize problems which may arise if a particular
distribution is chosen for the a,.

917

ECONOMETRIC MODELS

and Vai = 1/8. As long as Xi, contains an intercept this normalization involves
no loss of generality. We integrate by parts to find6
(2.3)

pr(nil, . . ., ni, I Xil,
= °°el

., XiT)
aettAttaitnf(ai) doai

-n,,it" -

itit"-

F E
n-E,, r(n
(X+3

(3

i+')

it + 8)

P(6)

where r(.) is the gamma function, F(z) = tz- e- for z > 0. For this model the
expectation of nit is Xi, and the variance is

it(it + 8)/8.

Therefore, the ratio of

the variance to the mean is now 1 + Xit/8 so that the ratio grows with Xi,, which
is what we observed in the residuals in Figure 1 although the observed relationship is not exactly quadratic as would be implied by the above formula.
Maximum likelihood estimation of the parameters of the model in equation (2.3)
is straightforward although we can no longer prove global concavity due to the
addition of the 8 parameter. Evaluation of the log gamma function and its
derivative (the digamma function) is akin to calculation of a logarithm on a
computer. Starting values are provided by the initial Poisson estimates and
guesses of the delta parameter using V(a) = 1/8.
Results for the random effects Poisson specification are given in columns 1
through 3 of Table II. We see that the U-shaped lag structure of R&D is
somewhat attenuated from that in Table I, but there is still a significant positive
coefficient on the last lag. The total R&D effect is lower than that in our basic
model in Table I although the exogenous time effect and the decline in the R& D
coefficient over time remain about the same. The implied variance to mean ratio
for patents at the means of the variables is about 20 and it grows with the
estimated Xi,.
We emphasized in our derivation of the random effects specification of
equation (2.3) the requirement that the unconditional and conditional density of
/i given Xit was identical. This requirement can be dropped when a conditional
maximum likelihood approach is used to develop a fixed effects specification.
But we cannot simply estimate separate /i parameters in equation (2.1) because
for T held fixed and N large we have the incidental parameter problem and
maximum likelihood need not be consistent (see Neymann and Scott [24],
Andersen [3], and Haberman [16]). Instead, we use the conditional maximum
likelihood approach of Andersen [1, 2] and condition on the sum of patents
nit. Since the Poisson distribution is a member of the exponential family, a
6Note that this specification is close to the classic Greenwood-Yule [14] specification which leads
to a negative binomial specification. A similar probability specification was derived by Bates and
Neyman [6] for a somewhat different model of accident proneness from that of Greenwood and Yule.
Bates and Neyman named the distribution the multivariate negative binomial distribution. It is also
referred to as the negative multinomial distribution.

J. HAUSMAN, B. H. HALL, AND Z. GRILICHES

918

6

log
Tests sum

log
loglog
time
R R0
- time
Fixed
1
dummy
logR-5
logR-3
logR_2
logR_4
5"Sum"
book
effectsfor
intercept
Sector)
log
'Random
log
R0
correlated R
likelihood
coefficients
effects:
value
effects
evaluated
firm
a,
(Scientific
at
b

of

=

theEstimates
eA,
a,

-

-

midpoint
of conditional
distributed
theon

3827.5

the
period,
sum
of
1971. independently
as
a
patents

-

-

.04.13.07.08.06.03.36

.591.20
2.30

1

(.03)
(.02)
(.05)
(.05)
(.05)
(.04)
(.01)

(.15)
(.16)

.45.982.65

.45

.03

2
over
all gamma

(.12)
3846.18 (.011)

(.01)
(.0005)

T
random
years.

ESTIMATES
Random
OF
EffectsaTHE

POISSON

variable
with

0.49 .18.32
1.40
.414c
.0368
.0170
(.17) (.16)
(.04)
3779.6 (.15)

.482

TABLE
11

3

MODEL

(.012)

(.0006)
(.0025)
WITH
parameters
(8,
8).

-

-

-

FIRM

.03.07.07.07.04.02.31

.43

15.2
3009.4

4

(.05) (.06)
(.06)
(.05)
(.04)
(.003)(.07)

EFFECTS

-

-

.35

.027

13.7
3014.4

.35

5

(.002)

Effectsb

-

.413c
.01
2979.0

Fixed

(.03)

.0171
.0369
(.0020)
(.0079)

.481

6

(.034)

919

ECONOMETRIC MODELS

sufficient statistic exists for TXi = YXi, and it is Yni,. Since Z,ni, is distributed as
Poisson with parameter YXit= aiyXi, conditional maximum likelihood follows
in a straightforward manner. Furthermore, it is known in the literature, e.g. Rao
[26], that the distribution of nit conditional on Z,ni, gives a multinomial distribution

(2.4)

. ., nid e nit)
/
h
pr(nil

=Frteilro,

o ,o

i
ni,T-p

a
nif
niicpr(

E nih)

t
I(nil!

e-'"8

(3Xit)

EDr! n
it!) Le

=

,

n\,
t

|

E2nit)

Set Pi,

i/2At

and we~have the multinomialdistributionsince Epi,

1.

Furthermore, for our particular specification we have
A

pit= eX

e XJ

E/(ex,,+A)=exJ

which is the so-called multinomial logit specification used by McFadden [20] in
the discrete choice problem.7 Define the share of patents for firm i in a given
The logit model then explains the share of total patents in
year by Sit = nillyini,
each year given the firms' total number of patents in T years.
The log likelihood function takes the form
N

(2.5)

T

N

L(PA) = E E F(ni, + 1) -2E
i=1 t=1

T

i=1 t=1

T

ni,log E e-(x,,-x,s)#.
s=1

Equation (2.5) differs from the discrete choice likelihood function because here
in general all the sit's are nonzero instead of only one nonzero value for the
choice which is made. The gradient and Hessian for this likelihood are similar to
those for the usual multinomial log specification: in particular, the Hessian can
be shown to be globally concave by the Cauchy inequality provided the parameters are bounded, and hence its computations should and did converge rapidly.
The results for the conditional Poisson are given in columns 4 through 6 of
Table II. The lag coefficients of R & D are now all small and insignificant with a
2=
10 for the test that they are jointly equal to zero. The U-shape of the
7Chamberlain [7] also derives a multinomial logit in his generalization of Cox's [10] fixed effects
binomial logit model.

920

J. HAUSMAN, B. H. HALL, AND Z. GRILICHES

distributed lag no longer appears. The firm specific effect, ai now represents both
the accumulated stock of knowledge from past R & D in the firm8 and unobserved permanent differences across the firms which affect their propensity to
patent. Conditioning on permanent differences in the firms' levels of R & D
expenditures has reduced the sum of the lag coefficients from .88 in the pooled
model and .59 in the random effects model to .43.9
In Column 5 we estimate the model which contains only current R & D and
find a coefficient of .35 which is 20 per cent below the sum of the coefficients in
the previous specification. The time coefficient remains at -3 per cent per year.
In column 6 we redo the specification with a time and R&D interaction. This
specification corresponds to that of column 3 where the scientific sector dummy
and book value variables have been absorbed into the fixed effect. The coefficient of current R&D now rises to .48 while our earlier findings about the
declining potency of R & D are repeated. Time itself has a positive coefficient of
4 per cent per year while the interaction with R&D has a coefficient of -.02.
To test whether our firm specific effects are correlated with the X in the model,
we compare the random effects estimates to the fixed effects estimates using
Hausman's [17] test. For the specification in columns 1 and 4, this test is
distributed as X7 under the null hypothesis. Our statistic equals 15.2 which leads
to a rejection of the random effects model. However, when we test column 3
against column 6 we accept the null hypothesis that the firm specific effects
remaining after inclusion of the scientific sector dummy and the firm size
variable are independent of the Xi,'s. The value of the statistic is .01, distributed

as X3 underthe null.

Lastly, we consider diagnostic tests. We can no longer disregard the induced
correlation in the conditional model since Z, ', = 0 which follows from the fixed
effects assumption and the definition Xi, = si,Eni,. Thus, under the null hypothesis of no serial correlation among the nit, we have serial correlation of order
(-1/T)
among the uit.
We form an asymptotic test as N becomes large by seeing whether the
estimated covariance matrix from the residuals of the multinomial model of
equations (2.4) and (2.5) has the form it would take under the null hypothesis of
no serial correlation. Using the predicted probabilities
7
=
Pit

ex"18

=
t=

A
18

I

8With more years of data we might well want to let this initial stock of knowledge decay over time.
However, we did not find evidence of such a decay process in our residuals.
9It may be interesting to report also the comparable original OLS estimates for this model.
Without the time interaction and firm specific variables the estimated coefficient of log R is .81, .77,
.29, and .39 for the total, between, within, and variance-components specifications respectively. With
the additional variables they are .49, .54, .29, and .29. The variance-components results are close to
the withiii because most of our variance is between (95 per cent for log Patents and 97 per cent for
log R) which is downweighted in this specification. These results are mirrored in the random-effects
specification results reported in the text. Note, however, that the comparable results are somewhat
higher for the Poisson than the OLS specification.

921

ECONOMETRIC MODELS

we form the vector of each firm's predicted probabilities
compute the multinomial covariance matrix:
(2.6)

i =

=

(Pi,,...

P
A

and

-A
diag(fl)

Since 2i is singular by construction, we delete the first row and column to form a
6 x 6 matrix Oil Likewise, we take the estimated residuals

(2.7)

uat=

(nit

At(_
pit

(n ))

n)

(t = 1, ...,

7)

and compute the covariance matrix Si. = ii. We delete the first row and
column to form Si. We then calculate the statistic
(2.8)

R

=

- 112Sg - 1/2'

which should be close to the identity matrix if serial correlation is not present. To
test for serial correlation we use the test statistic developed in Appendix B:
(2.9)

N ()

Vm

Mi( A)

where mi(/3) is the 15 element column vector composed of the unique nondiagonal elements of Ri in equation (2.8) and Vmis its asymptotic variance matrix
which is calculated in Appendix B. The test statistic is computed to be 39.6.
Under the null hypothesis this statistic is distributed as central X2s5 Having
rejected the null hypothesis of independence we turn, in the next section, to the
consideration of a more general model which allows for another source of within
stochastic variation and which may be able to account for this apparent nonindependence.

3. NEGATIVE BINOMIAL MODELS

Even with the fixed effects Poisson model we still have the restriction that the
variance and mean are equal, Eni
V(nit)= Xit. On the other hand, the random
effects Poisson has a variance to mean ratio of 1 + Xit/8 which increases with Xit
as our data indicates holds true. Speaking somewhat loosely, we would like to
combine the two models to permit the variance to grow with the mean while at
the same time we want to have a conditional fixed effect ai which could be
correlated with the right hand side variables, especially R& D. To develop such a
model, we begin with the famous negative binomial specification of Greenwood
and Yule [14]. We then develop a fixed effects version of the negative binomial
specification.
Greenwood and Yule in their model of accident proneness assumed that the

J. HAUSMAN, B. H. HALL, AND Z. GRILICHES

922

number of accidents in a year for a given worker followed a Poisson distribution.
They further assumed that the (unconditional) parameter Xi was distributed in
the population randomly and followed a gamma distribution. Our situation
differs in two respects from that of Greenwood and Yule. First, we want to
specify a conditional model for Xi, to ascertain the importance of research and
development to the distribution of patents. Also, we have panel data rather than
a single cross-section so that we can allow for both the possibility of permanent
unobserved firm effects as well as the possibility that these firm effects are
correlated with the R & D and other explanatory variables. To start, we return to
the situation of Section 1 and consider the yearly patents model. We assume that
the Poisson parameter Xi, follows a gamma distribution with parameters (y, 8)
and specify y = ext" with 8 common both across firms and across time.10 The
mean and variance of Xi, are then EXi, = ex'"/6 and V(Xi,)= extf/682. Note that
even if Xi, remains constant for a firm over time Xi, can still vary. This situation
should be distinguished from the random effects specification of Section 1 where
xit= aie'tf so that Xit was constant for a given firm if the Xit's remained
constant. On the other hand, in keeping with the models of Section 2, we have
not allowed for firm specific effects. Thus, the Xit'sare independent for a given
firm over time.
We now take the gamma distribution for the Xit and integrate by parts to find
(3.1)

pr(nit)=

nI ! e &/it.t(/Xt) Ait

( y,t)r(nit + 1)

I+ 8

which is the negative binomial distribution with parameters (7it, 8). Computation
of maximum likelihood estimates proceeds as for equation (2.3) with the use of
partial fraction expansions of the gamma and digamma functions permitting
rapid evaluation. The moments of nit have the form Enit = ext-/8 and V(nit)
= e'Xitf8(l + 8)/82.
Therefore, the variance to mean ratio V(ni,)/E(nit) = (1 + 8)
/8 > 1. Thus, the negative binomial specification allows for overdispersion with
the original Poisson a limiting case as 8 -* oc. We estimate a 8 of about .05,
implying a variance to mean ratio of 21 which is roughly consistent with the
Poisson random effects model presented earlier.
Both estimates are higher than would be suggested by Figure 1 because the
models we have used impose a constant variance to mean ratio across firms while
the data suggest that the ratio grows with the number of patents. Another
potential shortcoming of the negative binomial specification is that it does not
allow for firm specific effects so that serial correlation of the residuals (i.e.,
"0Theparameter 8 is different from its use in the last section.

923

ECONOMETRIC MODELS

nonindependence of the counts) may be a problem. We will return to this
question later after we look at the results.
The estimates from the negative binomial specification are given in Table III.
In the first two columns we consider specifications with and without lagged
R&D. The total coefficient of R&D is about .75 for either specification, which
is a decrease of 15 per cent from the corresponding model of Table I. We still
find a large positive coefficient on the last lag of R &D. In column 3 we add the
time and R&D interaction along with the scientific sector dummy variable and
book value for the firm. Taking into account the time-R&D interaction, the
estimated coefficient of current R&D falls from .55 in 1968 to .48 in 1974; the
level is slightly lower and the decline slightly smaller than in the corresponding
Poisson model. But as we suspected might happen, when we compute standardized residuals the problem of serial correlation reappears. Thus, we turn again to
a model with firm specific effects to take account of this problem.
In order to add firm specific effects to the negative binomial model we
consider a random effects specification as we did in Section 2 for the Poisson
model. It is more convenient in this case, however, first to describe the fixed
effects version of our model and then add the random (no correlation with the
X's) interpretation to it. To do so we need to find a convenient distribution for
the sum of the patents for a given firm (Z,ni,) which we will condition on as we
did in the Poisson specification of equation (2.4). There once we conditioned on
the firm specific effect ai we returned to a deterministic specification of the Xi,.
The situation differs here because of the stochastic nature of the Xi, even after
conditioning. The derivation of the fixed effects negative binomial model is given
in the Appendix. The resultingjoint probability of a firm's patents conditional on
TABLE III
ESTIMATES OF THE NEGATIVE BINOMIAL MODEL
Totals

log Ro
logR-1
logR-2
logR-3
logR_4
logR_5
time
time - log Ro
dummy (scientific
sector)
log book value
intercept
a
sum of logR
coefficients
log likelihood

.43 (.08)
-.04(.14)
.16 (.14)
-.12 (.13)
- .07 (.15)
.41 (.10)
- .05 (.01)

-

.75 (.02)

.56 (.03)

.03 (.01)

.017 (.025)
- .012 (.006)
.40 (.04)

- 1.10 (.07)
.14 (.002)
.76

- 1.27 (.07)
.04 (.002)
.75

- 3,820.8

- 3,845.3

aSum evaluated at the midpoint of the period, 1971.

.24 (.02)
- 2.20 (.13)
.057 (.003)
.5la

- 3,747.4

924

J. HAUSMAN, B. H. HALL, AND Z. GRILICHES

the seven year total is
(3.2)

pr(nil *

n iT

IZ nit)

( I F(-yit+nit)

(i
t

(-yit)l(nit)

+
+

-y(E it)r(nit

tF)ZniIF

+l
i)

The log likelihood of the sample follows once we specify
parameters of the underlying model be
(Yit ,6i)

Yit.

We let the

= (ex'' fi /e")

where both ci and Ii are allowed to vary across firms. The mean is
xit

= (ex-#+/4)/Oi

while the variance is
V(Xit) = (eXtf+2^

)/fp2

Therefore, we have multiplied the mean by ell as we did for the deterministic
Poisson parameter in the fixed effects case. Likewise, the standard deviation has
been multiplied by the same amount. Considering the corresponding unconditional negative binomial model we calculate
Enit = (ex-#+/4)/Oi

with
V(nit) = (ex J+^/4/)(l

+ eiS/4/0)

so that the variance to mean ratio is (e + 4j)/Oj. Thus we allow for both
overdispersion, which the fixed effects Poisson specification did not, as well as a
firm specific variance to mean ratio, which the original negative binomial
specification did not.
Estimates for the fixed effects negative binomial model are given in the last
three columns of Table IV. The coefficient of R & D is about one-half as large as
the original negative binomial specification and is quite close to the conditional
Poisson estimate. However, the standard errors on lagged R & D are much larger,
reflecting the increased "noise" in the negative binomial specification. When we

925

ECONOMETRIC MODELS

aSum

b a
log
log
log
time
time
Tests sum
firm
of
dummy
logR-1
logR-5
logR_4
logR-3
logR-2R0
for
book
intercept
sector)
log
log
71
correlated R
R0
coefficients
effects likelihood

evaluated
at

(scientific

the

midpoint
of

-

-

-

-

.03.19.06.01.13.12.45

1.33
2.56
.601.72

the

3,303.1 (.34)
(.10)
(.36)

(.11)
(.18)
(.19)
(.15)
(.10)
(.06)
(.003)

period,
1971.

-

ESTIMATES

-

1
2.15
.521.56
.47

OF

.02

.52

(.003)

(.025)

Random
THE

3,310.6 (.31)
(.30)
(.10)

Effects

NEGATIVE

-

2.56
1.74
.64.13
.45a

.17 .01
.010

.49

(.35)
(.04) (.11) (.01)
(.22)
3,304.9 (.37)
(.003)

TABLE

(.04)

BINOMIAL
IV

MODEL

-

.38
580.
2,467.3

-

-

-

WITH

1.84

.02.08.07.03.14.15.41

(.13)

(.11)
(.17)
(.10)
(.19)
(.16)
(.06)
(.004)

FIRM

EFFECTS

-

.37
65.0
2,468.9

1.86
(.11)

-

.38a
127.0
2,468.5

1.80

.02

.37

(.003)

(.03)

Fixed

Effects

-

.006
.004

(.13)

.39
(.04)

(.010)
(.003)

J. HAUSMAN, B. H. HALL, AND Z. GRILICHES

926

interact time and R & D in column 6 we find important differences from the
Poisson fixed effects model. First, the estimate of the coefficient of current R & D
is .39, which is somewhat lower than the Poisson model estimate of .48. Next the
pure time effect continues to be negative, although insignificantly so, while in all
previous models it becomes positive when the interaction term was added.
Correspondingly, the interaction term has a much smaller estimated magnitude.
This last set of results continues to indicate the decline in effectiveness of R & D
in producing patents. But since the negative binomial specification allows for an
additional source of variance, the estimated standard errors are all larger, and the
conclusions, while similar to the previous ones, are much less precise.
We again form a test for serial correlation. Define
7
t= 1

An extra term arises from the negative binomial (Dirichlet) assumption
(3.3)

=

A

(2

t=l

+

1exu1
t=1

( +

t=1

18)

Then we compute

(3.4)

i

=

gi[diag(f)

-f'fi]

We again drop the first row and column to form 2i and use the residuals a,to
form Si. The test statistic of equations (2.8) and (2.9) is used again. It is
calculated to be 64.7 so that significant nonindependence is still present. It is
interesting to note, however, that if we divide the sample on assets of $100
million, the test statistic equals 19.2 for the 44 small firms which is not significant
for a X2s random variable. But for the 84 larger firms the test statistic equals 58.5.
The model is satisfactory for the small firms which created the "zero patent"
problem, but trends in patents for a few quite large firms leave us with some
serial correlation which is not explained by the model. While statistically significant, the serial correlation is not large with the r2 between adjacent residuals of
about .15 and its sign changing from positive to negative as the distance between
observations increases.
We lastly consider the random effects version of the negative binomial
specification. In the fixed effects specification we set the parameters of the
underlying model as
(yit, Si) = (eXI', oi/e

so that both 4i and yi vary across firms. Upon conditioning on the total number
of patents in equation (3.2), the ji and yi parameters are eliminated and only
Yit= e
appears. Analogously to the Poisson random effects specification, we
now assume that il/eA is randomly distributed across firms, independent of the
Xit's. An interesting difference exists between the Poisson random effects specifi-

927

ECONOMETRICMODELS

cation and the negative binomial random effects specification. In the Poisson
case, ?xi = Xi,ai where ai is a random firm specific effect. Note that for constant
xit, Xitis also constant, which would occur if the Xit's are constant. However, in
the negative binomial specification Xit varies randomly across years even if the
Xit's are constant because it is a realization from a gamma probability distribution each year. Thus, we have randomness both across firms and across time,
which corresponds to the usual specification in the linear case where we have the
variance components decomposition for the stochastic disturbance (Et= ai + nit.
We choose a distribution for 3i = oi/e- which will allow us to integrate 3i out
of the marginal probability statement

(3.4)

pr(ni,, . . . , niTI Xil, *...*, XiT )
= pr(nil, . . . ,

niT I Xil I .. *

XiT 5S i ) g0i

)

where g(*) is the probability density of the incidental parameters. Because of the
variance components, we need a two parameter distribution for 3i and for ease of
integration we take the ratio
Si/(I

+ 3i) = 1/(1

+ eAli)

to be distributed as a beta random variable with parameters (a,b). Therefore,
7i/(I + 3,) has a density function
f(z) = [ B(a, b) ]

-lza-

(l

_

Z)b-1

where B(.) is the beta function. The ratio 7i/(1 + 3,) takes values on the unit
interval which implies 6i > 0, which is appropriate for the scale parameter. The
mean is
E(6i/(I + 3,)) = a/(a + b)
with variance
V(8i/(I + 3i)) = ab/(a + b + 1)(a + b)."
We integrate using the beta density to find
(3.5)

pr(nil, . . niT I Xil
T1r

*...*, XiT )

F'(yit+ nit)

Jo IIIh[ (7rey)r'(nj + 1)

z7i(1-

Zi)J

r(a + b)r(a + E yi)Jr(b + Enit)
r(a)r(b)r(a + b + Eyit + Enit)

f(zi)dzi

r(yit+ nit)

t r(7yt)r(njt+ 1)

Note that the scale parameter 8 is not identified here. We set 8 = 1. This result is to be expected
for the conditional model given the results of equation (3.3).

928

J. HAUSMAN, B. H. HALL, AND Z. GRILICHES

where zi = Si/(1 + 6,). Note that the last term in equation (3.5) corresponds
exactly to a term in the fixed effects model of equation (3.3). But we now
estimate additional parameters a and b from the beta distribution which describe
the distribution of the Si across firms.'2
Estimates of the random effects negative binomial specification are shown in
columns 1 to 4 of Table IV. They fall in between the estimates from the totals
model and the estimates from the fixed effects model. In the second column of
Table IV, where only R&D and time are used in the specification of Yi,t the
coefficient of R&D is estimated to be .52, compared to .75 for the totals model
and .37 for the fixed effects model. With all five lags on R&D present, the
estimates differ significantly from the fixed effects and totals estimates only in
the last lag, which is where any firm effect due to presample R&D (truncation
bias) will appear. The estimate of the time coefficients is negative and the same
as the fixed effects estimate. The parameters of the beta distribution are estimated quite precisely along with a large increase in the likelihood function
compared to the totals model. The variance to mean ratio of the effects is now
estimated to be about 1.7 which is somewhat higher than the corresponding
Poisson random effects estimate of about one. But now this ratio is being allowed
to vary across firms rather than taking on a constant value as it does in the
negative binomial totals or Poisson random effects models. A Hausman test of
the random versus fixed effects specification yields 580 and 65 respectively for
the first two specifications which leads to a rejection of the hypothesis of no
correlation between the Si and R&D. This result was to be expected, given the
evidence in Figure 1 that the unexplained variance rises more than proportionately with predicted patents and hence with R &D.
In column 3 of Table IV we now include the R & D-time interaction term and
the two firm specific variables, book value and scientific sector. The results differ
markedly from the Poisson case where this specification gave almost identical
results for the random effects and fixed effects models. Here the estimates of the
coefficients of R&D and book value differ significantly in the two cases. The
Hausman test statistic equals 127.0, which clearly rejects the no correlation
hypothesis, although the estimated coefficients are quite similar.
4. BETWEEN FIRM MODELS

Within the context of the linear panel data models it is often useful to separate
the total sample variability into between firm and within firm variability. That is,
given the model yi, = X,43 + ai + 77it,i = 1, N and t = 1, T, the between model
takes the form yi. = Xi. ,8 + ai + qi. where the dot notation signifies averages
over time, for example yi. = (1/ T)E yi,. The corresponding within model is
given by (yi, - yi. ) = (Xi, - Xi. )/3 + qi, - qi. . This decomposition is unique and
the resulting samples are orthogonal. But our conditional models differ from the
12Since these are unobservable random variables, the scale parameter merely serves as a normalization.

929

ECONOMETRIC MODELS

linear model because we no longer can use linear projections which separate the
variables uniquely into Xi. and Xi - Xi. components. We explore the parallel
definition of "between" models in this section. Our first conditional model, the
fixed effects Poisson specification, separates the original total sample into a
conditional multinomial probability times a marginal Poisson probability
(4.1)

pr(ni, . . .,
=pr

niT

nil

I Xil,

*..

n.,iT

,

XiT)

5XiT

IXi,i

x pr Enit5aiA15

...

5

it ,ai)

,XiT)

The first probability of the right hand side of equation (4.1) was derived in
equation (2.5) to be a multinomial distribution. The marginal probability follows
from taking the product of the moment generating function of the Poisson
distribution
T

fI ms(t) =

lIe- ElseXsNe'
s

s_=_1

so that the sum E,ni, is distributed as Poisson with parameter Ai = Esxis = TXi. .
We need to integrate out the unobservable random firm effect ai from the
marginal probability for Etni, in equation (4.1). Therefore as we did in equation
(2.3) we assume that ai = e - is distributed as a gamma random variable with
parameters (3, 8). We use the results of equation (2.3) on the sum of the patents
Etnit to derive the marginal probability
(4.2)

pr(

2

nit

t~~

Xil..,

XiT

)=(

eA'x-d )

~

[

x

+e

+
-

t

R)

~ x-0
I

+

8+ Enit)
F(3r
~+1)
r(8)r(Enit

Note that as with the linear between specification, the between Poisson model
suffers from the same problem as the random effects Poisson specification-it
assumes that the firm specific effects are uncorrelated with the explanatory
variables, including R&D. Note also that all the Xit enter the between model in
equation (4.2) instead of just Xi. appearing. Thus the between model does not
depend on Xi. (or TXi.) like the linear between model but instead depends on
the within period variation via E,eX1e, because of the nonlinearity introduced by
the exponential functions. Still, a close relationship to the linear case exists.
Rather than partitioning the sums of squares into a between and within component, we partition the likelihood of the original sample into two components,

930

J. HAUSMAN, B. H. HALL, AND Z. GRILICHES

conditional and marginal, so that the log likelihoods add up: L( ,nil, ... , niT)
= Lc( /nil, *...
niTI tnit) + LM(/3, tnit) for a common parameter vector /3.
The log likelihood function on the left hand side of the equation is given by
equation (1.2) while the conditional log likelihood LC(.) corresponds to the
density in equation (2.4) and the marginal log likelihood LM is the between
model of equation (4.2). Similarly, the Fisher information regarding the parameters adds up, JT = JC + JM for JT =-limE(A2L/a/3a/3')
with the variance
matrices for the estimates /3following by matrix inversion. Although the interpretation is not as neat in the Poisson case as in the linear case where no within
sample variation enters the between model, the idea of partitioning the information in the data into two additive components still goes through.
In the first two columns of Table V we give the estimates of the between
Poisson specification. The coefficient of current R & D expenditures is somewhat
less than that of the original Poisson model. The estimate of 8 implies a variance
to mean ratio for the seven year sum of patents of about 20 at the firm means,
which is the same as the estimate we obtained for the random effects model on
individual years of data. When we add the firm variables, however, this ratio is
cut in half, in contrast to the results from individual years of data. The size of the
coefficient on time interacted with R&D suggests that the earlier R & D expenditures are substantially more important than the later expenditures for the overall
level of patents.
For the negative binomial model the partitioning of the likelihood into
conditional and marginal pieces is not as neat, however, since the form of the
gamma functions allows us to identify the coefficients of variables which do not
change over time from the conditional model. To see this, observe that if we
include any variables which are constant over time in Yit in equation (3.2), they
will not necessarily cancel from the likelihood function and therefore their
coefficients will be estimable. If we look at the Dirichlet derivation of the model,
however, these variables do not really belong in Yit since this derivation starts
with the vector of patent shares in each year and treats them as random variables
TABLE V
ESTIMATES OF MARGINAL ("BETWEEN")

FIRM MODELS
Negative
Binomial

Poisson

log Ro
time - log Ro
dummy (scientific
sector)
log book value
intercept
8

.75 (.04)

1.72 (.08)
1.29 (.15)

1.18 (.15)
- .26 (.04)
0.20 (.18)
0.29 (.10)
0.58 (.16)
1.55 (.17)

a
b
log likelihood

1.02 (.06)

0.32 (.10)
4.24 (.63)
2.32 (.28)

- 806.5

- 792.9

1.29 (.15)
- .27 (.04)
0.26 (.18)

- 802.4

2.82 (.49)
3.17 (.69)
- 797.6

ECONOMETRIC MODELS

931

T. The Ait
which are based on the underlying random variables Xit, t= 1,...,
may be freely rescaled by any factor which is constant over time leaving the
shares unchanged. Therefore, the estimability of such coefficients is a kind of
specification test of the model; failure of the test implies that the variance pattern
in our data is not that implied by the Dirichlet or negative multivariate hypergeometric distribution.'3 A similar problem exists when we derive the between
specification of the negative binomial model; because of the functional form of
the gamma, we have identification of the coefficient of the time variable even
though all we observe is the sum of patents over the seven years.
We now make the same assumptions on Si as we did for the derivation of the
random effects negative binomial model of equation (3.3) to derive the between
firm negative binomial model. We take the negative binomial distribution with
parameters ( tyit,A ) and specify 3i/(l + 3i) to be distributed as a beta random
variable so that the between firm specification takes a generalized hypergeometric form,
(4.3)

ItX,iT)
pr(2i nXil,

+ Enit)r(a + b)r(a + zyit)r(b + Enit)
r(zyit)r( nit+ )T)r(a)r(b)r(a + b + Eyit + Enit)
r(yit

where a and b are the parameters of the underlying beta distribution. The log
likelihood function for equation (4.3) follows directly. It is interesting to note that
in equation (4.3) the leading terms in the numerator and denominator arise from
the combinatorial term in the negative binomial distribution of equation (2.3)
while the remaining terms arise from the ratio of two beta functions.
In columns 3 and 4 of Table V we give the results of the between negative
binomial model of equation (4.3). By analogy to the between estimates for a
variance components model, we can estimate only the overall variance of the
model and not the decomposition into within firm and between firm variances.
We accomplish this by dropping the intercept from yit and using the beta
distribution to estimate the mean firm effect and its variance. The only difference
between this model and the random effects Poisson model of columns 1 and 2 is
the underlying distributional assumption on which each was based: the Poisson
model variance arises only from the firm effect, whereas the negative binomial
variance is a compounding of two effects which cannot be separated. The
maxima of the likelihood functions for the two models are correspondingly close;
in fact, for the second model the Poisson likelihood is higher. The coefficient
estimates themselves are quite similar.

13We included the scientific sector and firm size variables in the model of column 6, Table IV and
found that they were insignificant with a x2 of 2.2 with 2 degrees of freedom. The coefficients of
interest (log Ro: .42 (.05), time: -.005 (.010), time log Ro: -.004 (.003)) do not change very much
and we conclude that this form of misspecification is not a serious problem in our model.

932

J. HAUSMAN, B. H. HALL, AND Z. GRILICHES
5. SUMMARY

Our various models can be thought of as differing along two conceptual
dimensions: (i) where and to what extent do they allow for "disturbances in the
equation," for variability not explicitly accounted for either by the X's or by the
assumed underlying Poisson process, and (ii) are the relevant coefficients (/3's)
different when estimated in the conditional ("within") rather than in the marginal ("between") dimension of the data. That is, do we get different answers
when we focus on the shorter term time-series aspects of the data than when we
sum or average over a longer time period and use primarily the cross-sectional
aspect of the data. In Mundlak's [21] language, are the individual "effects"
correlated with the X's?
Table VI attempts to organize and summarize all of our different models. We
start with the "total" Poisson: It assumes no disturbances in the equation and
maintains the equality of coefficients across all dimensions of the data. It can be
partitioned into two components: conditional ("within") and a marginal ("between"). If the two yielded the same estimated coefficients, their log likelihoods
would sum to the earlier total. The actual sum is higher, implying that the
coefficients do differ (as can also be seen in column 3), that there is a correlation
between individual firm effects and their R & D expenditures.
All the other models represent different ways of adding randomness. The
Poisson "random effects" model adds a pure firm disturbance with no within
(year to year) variablility. Note the large increase in the log likelihood (from
-9,078 to -3,780). The negative binomial "total" allows the Poisson parameter
Xi, to be distributed randomly, across firms and time, according to a Gamma
distribution. Adding such a disturbance again increases the likelihood greatly
(from -9,078 to -3,747). The random effects negative binomial, which is in
effect a Beta distribution (as described in the previous section), allows the
TABLE VI
SUMMARY OF RESULTS
Log Likelihood
Model

1. Totals (no firm effects)
2. Marginal (no firm effects)
3. Conditional
Sum of 2 and 3
Tests of 2 and 31
against 1
4. Totals (random effects)
5. Marginal (random effects)
Sum of 5 and 3
Test of 5 and 31
against 4

Poisson

Negative
Binomial

- 9,077.5
- 6,065.2
- 2,979.0
-9,044.2

- 3,747.4
- 776.1
- 2,468.5
-3,244.6

2 = 66.6
- 3,779.6
- 792.9
- 3,771.9

X2

X2 = 15.4

=
1006.
- 3,304.9
- 797.6
- 3,266.1

Total R & D Coefficients2
Poisson

Negative
Binomial

.57 (.006)
.56 (.008)
.41 (.03)

.51 (.02)
.66 (.19)
.37 (.04)

.41 (.01)
.14 (.13)

.45 (.04)
.21 (.19)

X6 = 77.6

These tests are likelihood ratio tests for the equality of the coefficients in the marginal and conditional models.
2This coefficient is computed as the total effect of log R&D in 1971, AOR + 4 *8I- R .

ECONOMETRIC MODELS

933

variance of the effects to differ in the within and between dimensions. It is
essentially a "variance components" version of the negative binomial. It is clear
from the results reported in Table V that the data want both a disturbance in the
conditional within dimension (compare the conditionals for the negative binomial and Poisson) and a different one, with a different variance, in the marginal
(between) dimension. The big changes in fit come from the introduction of such
variability and from allowing it to differ across these two dimensions of the data.
Most of this variability is in the between dimension (compare the log likelihoods
for the two Poisson marginals, one without and the other with firm effects), but
there is also variability in the time dimension. The estimated coefficients differ in
two dimensions, but much less so (the likelihood rises only from -3,305 to
- 3,245).
Substantively, our results differ from those of Pakes and Griliches [25] primarily because of the introduction of additional firm specific variables (log book
value and scientific industry dummy) and the log R-time interaction. Adding the
firm specific variables reduces the coefficient of log R from about .8 to .6 and
brings the "between" and "within" estimates closer to each other. While there is
still some (positive) correlation left between the individual firm propensity to
patent and its R&D intensity, it is now much smaller. In fact, it would not be a
bad approximation to assume that controlling for industry and size, the remaining firm effects are largely random.
Another way of summarizing our results is to look at our estimates of the
elasticity of patenting with respect to R&D. They differ along two somewhat
separate dimensions: (1) the implicit weighting of the individual observationsespecially the random effects models versus the rest-with the former downweighting the larger observations (since they allow the variance to increase as the
square of X) and the differential treatment of zero values; and (2) what variables
are included in the equation (none vs. 5 lagged R&D terms, size variables and
sector dummies) and whether we allow for a correlation between firm effects (or
past R&D) and the included R&D terms. With the implied error variance
proportional to X (Poisson) we start with a total elasticity of about .9 which is
reduced to .4 when all the various adjustments are made. It is still higher than the
.3 OLS-within estimates because it makes a more proper allowance for the
observed zero values. The difference between .4 and .9 can be decomposed
roughly as follows: size and sector effects about .3; lagged R&D effects during
the first five years about .07; effects of pre-sample R&D correlated within
sample R&D, about .08. In other words, while the current R&D component of
the overall R&D elasticity of patents is .38, the overall sum is at least .55 (which
is close to the Pakes and Griliches [25] estimates). It could be significantly higher,
however, since we can only estimate that contribution of past R & D which is
correlated with the included recent R & D terms.
The random effects model downweights the larger firms and starts out with a
lower estimate of the total R&D coefficient (about .6), and reduces very much
the influence of the size variables in the rest of the analysis. In this it is consistent
with the results reported by Bound et al. [5] who showed for a larger cross-

934

J. HAUSMAN, B. H. HALL, AND Z. GRILICHES

sectional sample, that the estimated patents-R&D elasticity is quite sensitive to
the weighting scheme used (or equivalently, that it is not really a constant
elasticity relationship).
The rest of the conclusions are quite similar, however. The "pure" current
R&D coefficient is around .38, time lagged R&D terms add another .08, while
allowing for correlated effects of pre-sample R&D adds another .07 or so,
yielding .53 as a lower bound on the total effect of R&D on subsequent
patenting.'4 Of course, if one were willing to interpret observed size difference as
the result of earlier R&D investments, then one could get an overall elasticity
closer to unity (c.f. the marginal results reported in Table IV).
The major new substantive finding is that the negative trend in the patent data
has a strong interactive component. That is, rather than the propensity to patent
just declining exogenously over time, firms are getting less patents from their
more recent R&D investments, implying a decline in the "effectiveness" or
productivity of R&D.
Methodologically, we have shown how a panel of count data can be analyzed
consistently. We described and illustrated the theoretical and empirical necessity
to generalize the Poisson model to allow for both "individual" effects and for
"overdispersion" in the data and derived models which allowed us to do so.
More work needs to be done, however, on the analysis of residuals from such
models. Also, it would be interesting to introduce firm effects which could decay
over time. This would allow us to consider the effects of lag truncation in such
models (along the lines of the Griliches-Pakes work for linear distributed lag
models). But even without such refinements, this type of model has many
potential uses in econometric data analysis which we expect to pursue further in
the future.
Massachusetts Institute of Technology,
National Bureau of Economic Research, Palo Alto, California,
and
Harvard University
ManuscriptreceivedDecember, 1981; final revisionreceivedJune, 1983.

APPENDIX A
To derive the fixed effects negative binomial model, we first find the moment generating function
for the negative binomial distribution to be
m(t) = (1 + 8-e'

)

14These interpretations are based on using the observed evidence for truncation of the lag
structure to attribute the correlation with firm effects to correlation with previous R & D whose effects
decay very slowly.

935

ECONOMETRIC MODELS

Since the moment generating function of a sum of independent random variables equals the product
of their moment generating functions we see that if 8 is common for two independent negative
binomial random variables w1 and w2, then wI + w2 = z is distributed as a negative binomial with
parameters (y1 + 72, 0). We first derive the distribution, conditioned on z, for the two observation
case
(A.1)

pr(w1 z

= wI +

w2) = pr(wl)pr(z)-w)

+

F(yl

WI)

(I

+ 1)

(-)r(Wl

+

+

1

F(72

+Y2

8

\)-(YI+W2)

+ 8 J

+ W2)

r(Y2)Y(W2

(I +
F(y] + y2)F(z + 1)

+

+ 1)

)

1(y1 + wl)r(Y2 + w2)r(Yl + Y2)F(W]+ W2+ 1)
+

F(-Yl

72 +

+

z)r(Yl)r(Y2)F(Wi

1)F(W2

+

1)

Note that in equation (A.1) we are left with the ratio of gamma functions which depend only on the
parameter y, not on the parameter 8. Thus, each firm, in effect, can have its own 8 so long as it does
not vary over time. The parameter 8 has been eliminated by the conditioning arguments.
More generally we consider the joint probability of a given firm's patents conditional on the seven
year total

(A.2)

pr(n,.

=

,,7

(t

(

);

[((it)(nit

+

')(

)1

The marginal distribution of a given n,, conditional on Enit is a negative hypergeometric distribution
(for integer values of the y,,'s) so equation (A.2) is sometimes called a negative multivariate
hypergeometric distribution for integer yit, e.g. Cheng Ping [8] and Johnson and Kotz [19].
We can also derive this distribution from the conditional Poisson model of the previous section,
i.e., the multinomial distribution of equation (2.4). In that model the multinomial parameters

Pit= A,it/E

t

xi,= ex1Z,

e x,,,6
t

arose from the Poisson distribution. The natural mixing distribution for these parameters is the
Dirichlet distribution which takes the p,,'s as random variables on the unit interval and enforces the
adding up condition. We then integrate over equation (2.4)

(A.3)

pr(nl.

niT |nit)

= E___

nit)!

flnit!
_

E(Jp7

p,)

+ n,,)

t
+__t_
_F(y_t

'

F
E -yt + E n(y)P(n,,

+ 1)

where 7, I. . ., Y,T are the parameters of the Dirichlet density. Note that equations (A.2) and (A.3)
are identical as expected. The mean of equation (A.2) is E(n,1/z,n,) = 71tESn1,1/Ey1, which is the
same as s;,2En,s from the multinomial distribution. The variance takes the form of the variance of a

936

J. HAUSMAN, B. H. HALL, AND Z. GRILICHES

multinomial variate times a ratio which arises from the Dirichlet parameters,
E -i,

V(ni,) = (nit,,/

E -i, ( Eni, + Z -i,)(

(-yi,/

+ Z -,,).

We have again increased the variance over the multinomial case and made it grow with the expected
number of patents to allow for overdispersion. The Dirichlet distribution occurs because each X,, is
distributed as a gamma random variable with parameters (yj,, Si). It can be shown that the random
for any Si
variable Xi /(XiI + Xi2) is distributed as a Beta random variable with parameters (YiI,2)
which is the same across all t. The Dirichlet distribution is the multivariate generalization of the Beta
is distributed as a Dirichlet random
distribution. The random vector (Xi,/Z,AX,,...., XiT/l,yit)
vector with parameters yi,, t = 1,. . ., T. Thus we have derived the conditional negative binomial
model in two ways: The first finds the conditional model for the negative binomial specification.
Equivalently, one can begin with the conditional Poisson model and let the pi,'s be random variables.
Both derivations yield interesting insights into the basic model.

APPENDIX B: BY JERRYHAUSMANAND WHITNEYNEWEY"5
To obtain a test for serial correlations in the fixed effects model, we use the fact that
(
i)
-pilpis,

E(ui-ui,) =

s=
s t

where
7
Pi=

e

and

eZ

/

t=

1

us,= (nil -pi,(
Then for pi = (pi, .
(B. 1)

Z(

nil))

ni,)

Pi6) and us = (u,,, . . ., ui6), we have
= Qi,

E(u, ui) = diag(pi) -pi

where the last equality defines Qi. We have deleted the last observation in forming pi and u, due to
the fact that E7= 1i,U = 0. Equation (B. 1) implies that
(B.2)

E(Qi2/2uu,,

-1/2) = 16

where I6 is a six-dimensional identity matrix. A test for serial correlation can now be based on the
sample counterpart of the off-diagonal elements of the 6 x 6 matrix Si- 112U;ig 1/2. Considering this
matrix as a function ,B, let mi(,8) be a 15 element column vector made up of the unique off-diagonal
elements of this matrix. Then if the fixed effects model is correct, equation (B.3) will imply under the
null hypothesis of no serial correlation that

(B.3)

q=

Z

^

)

V. ]-t

i=l

^i(1)

N)

d

2

i=l

as N gets larger for fixed T where Vm is a consistent estimator of the asymptotic
iN

(B.4)

,

(,N)/V.
('i=I

covariance matrix of

Note that a first-order Taylor's expansion around the population value 80 gives
18

1E1

Mi

LJN

I 0a

1J

For a general treatment of this type of specification test, see Newey [23].

937

ECONOMETRIC MODELS

where ,B lies between 8o and ,B. A central limit theorem and uniform convergence yields asymptotic
normality of the statistic in equation (B.4) which leads to the x2 distribution of equation (B.3).
To estimate Vmlet l,( 8) the log of the likelihood for observation i, and U( /3) = al,( :)/1a: be the
score vector for observation i. The relationship of the test statistic and the score vector follows from
(B.5)

E [ami(/0)/a/8 I = -E [m,( /,0) U( /'0)'].

Due to the presence of iQi-1/2(,8) in the definition of mi(,(), E[amj(,B0)/a/3] will not be zero in
general. However using e4quation(B.5) and an outer product estimator of the information matrix, a
consistent estimation of Vmis
N

A

(B.6)

VmI=

A

A

Nvmi(/C)m1()C

-

E

mifC ) UiCA)'[

l (/A )

(

A] i U(I

)mi().

It follows that the test statistic of equation (B.3) is analogous to a Lagrange multiplier test and can be
computed via a regression.

REFERENCES
[1] ANDERSEN, E. B.: "Asymptotic Properties of Conditional Maximum Likelihood Estimators,"
Journal of the Royal Statistical Society, B, 32(1970), 283-301.
: "The Numerical Solution of a Set of Conditional Estimation Equations," Journal of the
[2]
Royal Statistical Society, B, 34(1972), 42-54.
: ConditionalInference and Models for Measuring. Copenhagen: Mentalhygiejnisk Forlag,
[3]
1973.
[4] ANDERSON,T.: Multivariate Statistical Analysis. New York, 1958.
[5] BOUND, J., C. CUMMINS,
Z. GRILICHES,B. H. HALL, AND A. JAFFE: "Who Does R&D and Who
Patents?" NBER Working Paper #908, Cambridge, 1982.
[6] BATES, G. E., AND J. NEYMAN: "Contributions to the Theory of Accident Proneness," University
of California Publications in Statistics, 1. Berkeley: University of California Press, 1952,
215-253.
[7] CHAMBERLAIN,
G.: "Analysis of Variance with Qualitative Data," Review of Economic Studies,
47(1980), 225-238.
[8] CHENGPING:"Minimax Estimates of Parameters of Distributions Belonging to the Exponential
Family," Acta Mathematica Sinica, 5(1964), 277-299.
"The Use of the Maximum Likelihood Estimates in x2 Tests
[9] CHERNOFF,
H., AND E. LEHMANN:
for Goodness of Fit," Annals of Mathematical Statistics, 25(1954), 579-586.
[10] Cox, D. R.: Analysis of Binary Data. London: Methuen, 1970.
[11] Cox, D. R., AND E. J. SNELL:"A General Definition of Residuals," Journal of the Royal
Statistical Society, B, 30(1968), 248-275.
[12] GILBERT, G. C.: "Econometric Models for Discrete Economic Processes," paper given at the
European Meetings of the Econometric Society, Athens, 1979.
AND A. TROGNON:
"Pseudo Maximum Likelihood Methods:
[13] GOURIEROUX,C., A. MONFORT,
Application to Poisson Models," INSEE mimeo, Paris, 1981.
[14] GREENWOOD,M., AND G. U. YULE:"An Inquiry into the Nature of Frequency Distribution of
Multiple Happenings," Journal of the Royal Statistical Society, A, 83(1920), 255-279.
[15] GRILICHES, Z., AND A. PAKES:"Estimation of Distributed Lags in Short Panels," NBER
Working Paper #4, Cambridge, 1980.
[16] HABERMAN,S.: "Maximum Relationship Estimates in Experimental Response Models," Annals
of Statistics, 5 (1977), 815-841.
[17] HAUSMAN,J. A.: "Specification Tests in Econometrics," Econometrica, 46 (1978), 1251-1272.
[18] HAUSMAN, J. A., AND W. E. TAYLOR: "Panel Data and Unobservable Individual Effects,"
Econometrica, 49(1981), 1377-1398.
[19] JOHNSON,NORMAN L., AND SAMUELKOTZ: Discrete Distributions.New York: John Wiley, 1969.

J. HAUSMAN, B. H. HALL, AND Z. GRILICHES

938
[20]
[21]
[22]
[23]
[24]
[25]
[26]

D.: "Conditional Logit Analysis of Qualitative Choice Behavior," in P. Zarembka,
ed., Frontiers of Econometrics. New York: Academic Press, 1974.
MUNDLAK, Y.: "On the Pooling of Time Series and Cross Section Data," Econometrica,
46(1978), 69-86.
NELDER, J., AND R. WEDDERBURN: "Generalized Linear Models," Journal of the Royal Statistical
Society, 135(1972), 370-384.
NEWEY, W. K.: "Maximum Likelihood Specification Testing and Instrumented Score Tests,"
unpublished M.I.T. Ph.D. thesis, Cambridge, Mass., 1983.
NEYMAN, J., AND E. L. ScoTT: "Consistent Estimates Based on Partially Consistent Observations," Econometrica, 16(1948), 1-32.
PAKES, A., AND Z. GRILICHES: "Patents and R&D at the Firm Level: A First Look," Economic
Letters, 5(1980), 377-381.
RAO,C. R.: Advanced Statistical Methods in Biometric Research. New York: John Wiley, 1952.
McFADDEN,

