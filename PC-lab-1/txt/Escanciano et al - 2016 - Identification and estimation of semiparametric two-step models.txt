Quantitative Economics 7 (2016), 561–589

1759-7331/20160561

Identification and estimation of semiparametric
two-step models
Juan Carlos Escanciano
Department of Economics, Indiana University

David Jacho-Chávez
Department of Economics, Emory University

Arthur Lewbel
Department of Economics, Boston College

Let H0 (X) be a function that can be nonparametrically estimated. Suppose
E[Y |X] = F0 [X  β0  H0 (X)]. Many models fit this framework, including latent index models with an endogenous regressor and nonlinear models with sample selection. We show that the vector β0 and unknown function F0 are generally point
identified without exclusion restrictions or instruments, in contrast to the usual
assumption that identification without instruments requires fully specified functional forms. We propose an estimator with asymptotic properties allowing for
data dependent bandwidths and random trimming. A Monte Carlo experiment
and an empirical application to migration decisions are also included.
Keywords. Identification by functional form, double index models, two-step estimators, semiparametric regression, control function estimators, sample selection
models, empirical process theory, limited dependent variables, migration.
JEL classification. C13, C14, C21, D24.

1. Introduction
We provide new identification and estimation results for two-step estimators with a nonparametric first step. Given an observable vector X, suppose H0 (X) is some identified
function that can be nonparametrically estimated, for example, H0 (X) could be a conJuan Carlos Escanciano: jescanci@indiana.edu
David Jacho-Chávez: djachocha@emory.edu
Arthur Lewbel: lewbel@bc.edu
We would like to thank a co-editor as well as two anonymous referees for their helpful comments and
suggestions. We especially want to thank Yingying Dong, for providing data and other assistance on our
empirical application, and Jeffrey Racine for his advice on how to use the np package in our reported estimation results. We would also like to thank Hidehiko Ichimura, Simon Lee, Philip Shaw, Jörg Stoye, Ingrid
Van Keilegom, Adonis Yatchew, and participants of many conferences and seminars at various institutions
for many helpful comments. We acknowledge the use of the Big Red high performance cluster at Indiana
University where part of the computations were performed. All errors are our own. Escanciano’s research
was funded by the Spanish Plan Nacional de I+D+i, reference number ECO2012-33053.
Copyright © 2016 Juan Carlos Escanciano, David Jacho-Chávez, and Arthur Lewbel. Licensed under the
Creative Commons Attribution-NonCommercial License 3.0. Available at http://www.qeconomics.org.
DOI: 10.3982/QE328

562 Escanciano, Jacho-Chávez, and Lewbel

Quantitative Economics 7 (2016)

ditional mean, quantile, distribution, or density function. This paper considers identification and estimation of the function F0 and the vector β0 , where


E[Y |X] = M(X) = F0 X  β0  H0 (X)

(1.1)

for some observed outcome Y . Equation (1.1) is a double index model, with one linear
index X  β0 and one general function H0 (X) that acts as a second index. As described
below, many common econometric models involving either selection or an endogenous
regressor can be written in the form of equation (1.1).
Identification of models like these is generally obtained by exclusion or instrument
assumptions, such as knowing that some elements of β0 are zero, thereby making the
corresponding elements of X be valid instruments for H0 . This implies having some
variable that affects the selection or treatment model or the endogenous regressor, but
does not affect the outcome. The gold standard for such an identifying variable would
be random assignment, satisfying exclusion conditions by construction.
However, randomization or other sources of exclusion restrictions or instruments,
while preferable, are not always available. In such cases point identification is generally known to be obtainable only by parametric functional form restrictions. What we
show here is that identification can in fact be obtained, without exclusion restrictions or
instruments, under far weaker conditions than fully parameterizing the model. Specifically, we show that identification is generally possible in equation (1.1) where nothing
more than linearity of X  β0 is parameterized. Identification is obtained despite having
the parameters β0 be unknown and the functions H0 and F0 be unknown.
We illustrate our identification results by showing how they apply to a couple of common econometric models. One is a semiparametric double hurdle model, in which a
latent outcome is observed only if it and a separate binary variable are both positive.
This is equivalent to combining both Tobit estimation and a Heckman selection model,
except that in our case the error distributions and the propensity score function for the
selection are all unknown and dealt with nonparametrically. The second example illustration is a control function estimator of a binary choice model with an endogenous
regressor, as in Blundell and Powell (2004). Our results show that both these classes of
models are identified without instruments or exclusion assumptions.
While our primary contribution is identification, we also provide some new estimation results. Given identification of equation (1.1), either by our theorems or by standard
exclusion restrictions and instruments, we propose an estimator for F0 and β0 based on
minimizing a weighted least-squares criterion similar to Ichimura (1993) and Ichimura
and Lee (2010). However, in the latter the first stage plug-in estimate is parametric and
 that can be nonsatisfies an index restriction. In contrast, our setting has a plug-in H
parametric.
To establish the asymptotic normality of our proposed estimator, we employ a new
uniform-in-bandwidth expansion for sample means of weighted semiparametric residuals recently obtained in Escanciano, Jacho-Chávez, and Lewbel (2014). We obtain the
same limiting distributions that would be found using more well known approaches
such as Newey and McFadden (1994, p. 2197), Chen, Linton, and Van Keilegom (2003)

Quantitative Economics 7 (2016)

Semiparametric two-step models 563

and Ichimura and Lee (2010), but under weaker conditions. These conditions simultaneously permit data-driven bandwidths, trimming based on estimated objects (i.e.,
random trimming) and estimated observation weights. Some of these conditions could
in principle be shown to satisfy the higher-level assumptions provided in Chen, Linton,
and Van Keilegom (2003), but establishing that those assumptions hold is difficult (see,
e.g., Rothe (2009)). Other assumptions, such as the random trimming, does not fit the
standard framework at all.
We apply these identification and estimation results in an empirical application using the sample drawn by Dong (2010) from the 1990 wave of the Panel Study of Income
Dynamics (PSID). The dependent variable in this model equals one if an individual migrates from one state to another in the United States, and zero otherwise. Migration decisions depend partly on labor income prior to moving, which is an endogenous regressor
because both labor income and inclination to move may depend on common unobservable characteristics of individuals such job specific skills and drive to succeed. Our new
limiting distribution theory for this application accounts for data-dependent bandwidth
choice and random trimming.
Overall, our results suggest that identification by functional form need not be as fragile or unreliable as the name suggests, since at least in our large class of models identification without instruments does not require parameterizing the distribution of errors or
the functions F0 or H0 . Even when instruments are available, having identification not
depend on these means that their validity as instruments can be tested, by comparing
equality of estimates with and without imposing associated exclusion assumptions.
The rest of the paper is organized as follows: Section 2 provides some background information, including examples of models that fit our framework. Section 3 gives our general identification theorems, while Section 4 describes two examples that fit our framework. Section 5 describes the proposed estimator and establishes its limiting distribution. A Monte Carlo experiment and an empirical application to migration data is presented in Section 6. Section 7 concludes. The main proofs are gathered into Appendix A,
while the conditions for the provided asymptotic theory are listed and discussed in Appendix B. Replication files are available in a supplementary file on the journal website,
http://qeconomics.org/supp/328/code_and_data.zip.
2. Background
Models of the form M(X) = F0 [r0 (X) H0 (X)], where M(X) can be estimated, are called
double index models. Examples of estimators of double or multiple index models include Ichimura and Lee (1991), Pinkse (2001), and Lewbel and Linton (2007). Additional
models where both r0 (X) and H0 (X) are linear indices include Klein, Shen, and Vella
(2014), the sliced inverse regression models of Li (1991), and artificial neural networks.
This paper focuses on the case where just one of the two indices is linear, and hence parameterized as X  β0 . This is an appropriate assumption in contexts where X  β0 arises
as part of a structural model, while H0 (X) is a nuisance function associated with selection or endogeneity of a regressor.
In the semiparametric literature, when one or more of the functions H0 , r0 , and F0
are not parameterized, identification is generally obtained by exclusion restrictions, that

564 Escanciano, Jacho-Chávez, and Lewbel

Quantitative Economics 7 (2016)

is, some element of X is assumed to drop out of either r0 (X) or H0 (X). In models where
all of the unknown functions are parameterized, exclusion restrictions are generally not
required for identification, and we may instead obtain identification by functional form.
For example, Heckman’s (1979) sample selection model does not require an exclusion
restriction for identification, since identification is obtained by parameterization of the
joint error distribution in the selection and outcome equations. Empirically, identification by exclusion restrictions is generally considered more reliable than identification
based on functional form, but it is often the case that exclusions are hard to find or to
plausibly impose. Identification by functional form also provides a way to test exclusion
restrictions, since it nests models with exclusions.
As noted in the Introduction, this paper shows that “identification by functional
form” extends to the semiparametric model (1.1). In particular, it is shown that β0 and
F0 can be identified without exclusion restrictions under some relatively mild regularity
conditions (essentially, nonlinearity in H0 and some inequalities suffice). So for example
in Heckman’s model, identification by functional form does not actually require a parameterized functional form for the error distributions or for the selection index H0 (X).
One large class of models that fit in this paper’s framework are endogenous regressor models. Suppose Y = L(X1 α0 + X e δ0  e) for some possibly unknown function L,
where X e is an endogenous regressor with X e = g0 (X1 ) + u, e and u are unobserved
correlated error terms, and g0 represents a generally unknown conditional mean function. Let E[u|X1 ] = 0 and assume the endogeneity takes the “control function” form of
e = h0 (u v) for some function h0 , where v is an unobserved error that is independent
of X e and X1 . Another way to describe the endogeneity is to say e|X1  u ∼ e|u. Define
X  β0 := X1 α0 + X e δ0 and H0 (X) := X e − g0 (X1 ). Then equation (1.1) holds with F0
defined by E[Y |X] = E[L(X  β0  h0 (H0 (X) v))|X] =: F0 [X  β0  H0 (X)].
An example of this type of endogenous regressor model is Rivers and Vuong (1988).
More generally, for Y binary this is Blundell and Powell’s (2004) semiparametric binary
choice model with an endogenous regressor, so this paper’s identification results show
that Blundell and Powell’s control function model is generally identified (and so could
be estimated using their estimator or Rothe’s (2009) estimator), without the exclusion
restrictions they impose for identification. Our empirical application to estimation of a
migration equation is an example of this model.
Another large class of models that fit this paper’s framework are limited dependent
variable models with selection. Suppose Y ∗ = L(X  β0 + e) for some function L; for
example, L could be the identity function, so Y ∗ = X  β0 + e is a linear model, or Y ∗
could be a binomial response with Y ∗ = I(X  β0 + e > 0) for I being the indicator function that equals 1 if its argument is true and 0 otherwise, or L could be a censored regression such as Y ∗ = max(0 X  β0 + e). Suppose in addition to this possibly limited
dependent variable we also have nonrandom selection, so we do not observe Y ∗ but
instead observe (Y D X  ), where Y = Y ∗ D = L(X  β0 + e)D, implying that Y ∗ is only
observed when D = 1. Suppose D = I[s0 (X) + u > 0], where the conditional distribution u given e is continuous. Nonrandom selection arises because the unobserved errors e and u, though independent of X, are correlated with each other. It then follows
that H0 (X) = E[D|X] = Fu [s0 (X)], where Fu is a marginal distribution function of −u,

Semiparametric two-step models 565

Quantitative Economics 7 (2016)

and equation (1.1) holds with F0 defined by E[Y |X] = E[L(X  β0 + e)I(Fu−1 [H0 (X)] +
u > 0)|X] =: F0 [X  β0  H0 (X)]. This includes a wide class of selection models, including standard Heckman-type selection models, extensions of Tobit models like double
hurdle models, and censored binary choice models, among others.
3. Identification
Here we provide sufficient conditions for identifying the function F0 and the parameter
vector β0 in the semiparametric double index model M(X) = F0 [X  β0  H0 (X)], where
M(X) and H0 (X) are assumed to be identified. The estimators and example applications we discuss later are based on defining M(X) and H0 (X) in terms of conditional
expectations, but this is not necessary for our identification theorems. For example,
identification would hold in the same way regardless of whether M(X) was a nonparametrically identified density, distribution, or quantile function rather than a conditional
mean, and similarly for H0 (X).
To obtain identification under general conditions, we provide two different sets of
identifying assumptions, each of which can be applied to different sets of regressors in
the same model. We therefore let X  β0 = V  α0 + Z  δ0 and write the model as


M(V  Z) = F0 V  α0 + Z  δ0  H0 (V  Z) 
Here V is a vector of one or more continuous regressors, while Z is a vector that can
include covariates that are discrete, continuous, continuous with mass points, and so
forth. Theorem 3.1 below α0 using differentiability and inequality constraints, while
Theorem 3.2 below identifies δ0 exploiting support and invertibility restrictions instead.
The vector Z could be empty so only Theorem 3.1 would be needed, or V could just have
one element with a coefficient normalized to equal 1, in which case only Theorem 3.2
would be needed, or both theorems can be applied to identify models where different
sets of regressors satisfy different regularity assumptions.
3.1 Continuous regressors
Assumption 1. Assume V is a K × 1 vector and assume there exists a function F0 and
a vector α0 such that m(V ) = F0 (V  α0  H0 (V )). Assume functions m(V ) and H0 (V )
are identified. Let α0;k and Vk denote the kth element of α0 and V , respectively, for
k = 1     K. Assume α0;1 = 1.
Assumption 1 applies to the general double index model M(V  Z) = F0 [V  α0 +
) := M(V  0) and H(V ) := H0 (V  0), and provided the J ×1
vector of 0s is in the support of Z. If Z is empty, then Theorem 3.1 based on Assumptions 1 and 2 below will identify the entire model; otherwise it will identify just the α0
coefficients, and F0 only on the supports of V  α0 and H0 (V  0). If K = 1, then α0 just
equals α0;1 = 1 and so is known by the scale normalization assumption in that case.
The scaling of α0 is arbitrary, since changes in scaling can be freely absorbed into F0 .
Assumption 1 imposes the convenient scale normalization that V1 , the first element of V ,
Z  δ0  H0 (V  Z)] defining m(V

566 Escanciano, Jacho-Chávez, and Lewbel

Quantitative Economics 7 (2016)

has a coefficient of α0;1 = 1. This is a free normalization if one knows that this regressor
has a positive effect on F0 through the first index. This is also the most natural normalization in some contexts, for example, if in a binary choice model Y is a purchase
decision and −V1 is the price, then with the normalization α0;1 = 1 the remainder of the

index V  α0 , that is, K
k=2 Vk α0;k , equals (up to location) the willingness to pay for the
product (see, e.g., Lewbel, Linton, and McFadden (2011)).
Assumption 2. Assume H and F0 are differentiable and define F0;1 (r H) :=
∂F0 (r H)/∂r, the partial derivative of F0 with respect to its first element. Define H0;k (V ) :=
∂H0 (V )/∂Vk and ∂mk (V ) := ∂m(V )/∂Vk for k = 1     K. Assume there exist two vectors
v and 
v on the support V such that the derivatives H0;k (V ) and mk (V ) are identified at
V = v and V = 
v for k = 1     K, and assume there exist two elements k and j of the set
{1     K} such that the following inequalities hold:

 
F0;1 
v) = 0 and
v α0  H0 (



F0;1 v α0  H0 (v) = 0

H0;j (
v) = H0;1 (
v)α0;j

and

H0;k (
v) = H0;1 (
v)α0;k 

H0; (v) = H0;1 (v)α0;

for  = 2     K

H0;j (v)H0;k (
v) − H0;j (
v)H0;k (v)


= H0;1 (v)H0;k (
v) − H0;1 (
v)H0;k (v) α0;j


− H0;1 (v)H0;j (
v) − H0;1 (
v)H0;j (v) α0;k 
The inequalities in Assumption 2 essentially require F0 to depend on V  α0 , and
require some variation in H0 (V ) that distinguishes it from V  α0 . These inequalities
will not hold if H0 (V ) equals a transformation of a single index in V for example (see
Chamberlain (1986)), but otherwise it is very difficult to construct examples that violate the inequalities of Assumption 2. This assumption can be interpreted generically
as a rank condition, which is a common feature of many identification theorems. See,
for example, Komunjer (2012), Heckman, Matzkin, and Nehseim (2010), Lewbel (2007),
Matzkin (2007), and references therein.
The identification of derivatives of m and H0 at the two points v and 
v generally requires that V be continuously distributed at those points, so Theorem 3.1 below cannot
be applied to discrete regressors. Theorem 3.2 later will provide identification for other
regressor distributions, including discrete regressors.
Theorem 3.1. If Assumptions 1 and 2 hold, then the vector α0 and the function F0 (on
the supports of V  α0 and H0 (V  0)) are identified.
Theorem 3.1 obtains identification without an exclusion assumption, that is, all of
the covariates V can appear in both the index V  α0 and in the function H0 (V ). Identification can also be obtained from Theorem 3.1 using exclusions restrictions to satisfy
Assumption 2. However, with an exclusion restriction, identification can be obtained
more simply as follows: Let Assumption 1 hold with α0;K = 0 and assume H0 (V ) varies

Quantitative Economics 7 (2016)

Semiparametric two-step models 567

with VK (so VK is in H0 (V ) but not in the linear index V  α0 and hence VK is the excluded
regressor). Then if F0 is differentiable in its first element, it follows from equation (A.1)
that α0 is identified by


∂E m(V )|V1      VK−1  H0 (V )
α0;k =
∂Vk


∂E m(V )|V1      VK−1  H0 (V )
for k = 2     K − 1
∂V1
evaluated at any value of V that makes the derivative in the denominator of the above
expression nonzero.
3.2 Discrete regressors
Theorem 3.1 does not identify the coefficients of discrete regressors, but it can identify
the coefficients of the continuous regressors when both continuous and discrete regressors are present. Given both continuous and discrete regressors, Theorem 3.2 below can
be combined with Theorem 3.1 to identify the coefficients of the remaining discrete regressors or of other regressors that satisfy the alternative regularity conditions provided
in Assumptions 3 and 4. If all regressors satisfy these alternative regularity conditions,
then Theorem 3.2 alone can be used for identification with both types of regressors.
Assumption 4 imposes support restrictions and local invertibility of F0 , instead of the
differentiability and inequality constraints in Assumption 2.
Assumption 3. Let M(V  Z) = F0 [V  α0 + Z  δ0  H0 (V  Z)]. Assume H0 (V  Z) and
M(V  Z) are identified. Assume Z is a J × 1 vector and that α0 is identified.
If V is a scalar, then α0 is identified by the free (up to sign) normalization α0;1 = 1
as before. Alternatively, if V is a vector, then α0 is identified by Theorem 3.1 as long as
Assumptions 1 and 2 hold with m(V ) = M(V  0) and H0 (V ) = H0 (V  0). Having V be a
vector instead of a scalar makes the support requirements in Assumption 4 below less
restrictive. These support conditions are particularly mild when Z consists only of discrete regressors, which would then require V to contain all the continuous covariates in
the model.
Assumption 4. Assume the J × 1 vector of 0s is in the support of Z. Let 
zj denote the J × 1
vector that has element j equal to zj and all other elements equal to 0. Assume for some
zj = 0 in the support of Zj that there exists v(zj ) in the support of V such that v(zj ) α0 +
zj γj is in the support of V  α0 and H0 (v(zj ) zj ) is in the support of H0 (V  0). Assume
 is invertible on its first element at the point r = v(zj ) α0 + zj γj , H
 = H0 (v(zj ) zj ).
F0 [r H]
A sufficient condition for Assumption 4 to hold is if V  α0 and H0 (V  0) have support
on the entire real line and if F0 is strictly monotonic in its first element. Alternatively, if
Z is discrete, then only a limited range of values of V  α0 and H0 (V  0) is required; for
example, if there is a v such that v α0 can take on the value −zj γj , then letting v(zj )

568 Escanciano, Jacho-Chávez, and Lewbel

Quantitative Economics 7 (2016)

equal that v makes v(zj ) α0 + zj γj lie in the support of V  α0 , and a similar analysis
applies to H0 .
Theorem 3.2. If Assumptions 3 and 4 hold for j = 1     J, then α0 , δ0 , and F0 at all
points on the support of V  α0 + Z  δ0 and H0 (V  Z) are identified.
4. Examples of model identification
We now illustrate the identification results of Theorems 3.1 and 3.2 by applying them to
two examples: a double hurdle model and a binary choice control function model with
an endogenous regressor.
4.1 A semiparametric double hurdle model
Suppose a latent binary variable Y ∗ satisfies the standard fixed (at zero) censored regression model Y ∗ = (X  β0 − e)I(X  β0 − e ≥ 0) = max(0 X  β0 − e) with e independent of
X and the distribution function of e, Fe , possibly unknown. Suppose we only observe Y ∗
for some subset of the population, indexed by a binary variable D, that is, we only observe Y = Y ∗ D. This is a sample selection model with a censored regression outcome.
For example, Y ∗ could indicate the quantity of a good an individual might want to purchase, D indicates whether the good is available for purchase where the individual lives,
and Y indicates the quantity of the good the individual purchases, which is nonzero only
when both X  β0 − e > 0 and D = 1.
We apply our previous results to identify this censored regression with selection
model without exclusion assumptions. We also do not assume selection on observables,
so that D and Y ∗ remain correlated even after conditioning on observables X, as in
various Heckman-type selection models. The practitioner is assumed to know relatively
little about selection D other than that it is binary, so we assume D is given by a nonparametric threshold crossing model D = I[H0 (X) − u ≥ 0], where u ⊥ X and both the
function H0 (X) and the distribution of u are unknown. Based on Matzkin (1992), we
may without loss of generality assume H0 (X) = E[D|X] and u has a uniform distribution, since then Pr(D = 1|X) = Pr[u ≤ H0 (X)] = H0 (X).
We then have the model


D = I H0 (X) − u ≥ 0 


Y = max 0 X  β0 − e D

(4.1)
(4.2)

The latent error terms e and u are not independent of each other, so the model does
not have selection on observables. When H0 and the joint distribution of e and u are
parameterized, Cragg (1971) and later authors call this a double hurdle model, because
two hurdles must be crossed, H0 (X) ≥ u and X  β0 ≥ e, before a positive quantity of Y
can be observed. We therefore call equations (4.1) and (4.2) the semiparametric double
hurdle model.

Semiparametric two-step models 569

Quantitative Economics 7 (2016)

Let Feu (e u) denote the unknown joint distribution function of (e u) , and define
0 by
the functions M and F
M(X) := E[Y |X]
=

support (eu)




max 0 X  β0 − e I H0 (X) − u ≥ 0 dFeu (e u)



0 X  β0  H0 (X) 
=: F
We now give one set of conditions that suffice to identify this model based on Theo0 [X  β0  H0 (X)], where V
rem 3.2. Define the function F0 by F0 [V + Z  δ0  H0 (V  Z)] = F
is the first element of X, Z is the vector of remaining elements of X, and δ0 is the corresponding vector of elements of β0 scaled by the first element of β0 . This construction
is made without loss of generality because it just absorbs a scale normalization of the
function X  β0 into F0 . Note that in this construction, V is a scalar, and so is a special
case of the more general framework given in the previous theorems.
Assumption 5. Assume equations (4.1) and (4.2) hold, and that (e u) are continuously distributed with unknown joint distribution function Feu (e u) and are independent of X. Assume V is continuously distributed with support R, conditional on Z. Assume the J × 1 vector of 0s is in the support of Z. Let 
zj denote the J × 1 vector that has
element j equal to zj and all other elements equal to 0. For j = 1     J, assume for some
zj = 0 in the support of Zj that there exists a v(zj ) such that H0 (v(zj ) zj ) is in the support
of H0 (V  0).
Corollary 4.1. Let Assumption 5 hold. Then δ0 , and the functions F0 and H0 are identified.
Note that Corollary 4.1 identifies δ0 , and so only identifies the original β0 up to a
scale normalization. If desired, the scaling factor (corresponding to the coefficient of V )
could be identified in a variety of ways; for example, if the probability that D = 1 goes to
1 as V goes to infinity, then the scaling factor will equal limv→∞ E[∂M(v Z)/∂v].
Based on our theorems, Assumption 5 is stronger than necessary for Corollary 4.1.
For example, the corollary bases identification on Theorem 3.2 but not Theorem 3.1, and
assumes infinite support for V , which simplifies for Theorem 3.2 but is not required.
We provide this particular corollary as one example of easy to interpret conditions that
suffice for identification without exclusion or parametric functional form restrictions
(beyond linearity of one index). Note also that many of these conditions are testable; for
example, we can estimate H0 (V  Z) = E[D|V  Z], and then check whether a given v(zj )
yields an estimate H0 (v(zj ) zj ) that equals the estimate of H0 (v 0) for some value of v.
4.2 Binary choice with an endogenous regressor control function without instruments
Suppose we have a threshold crossing binary choice model


Y = I X1 α0 + X e γ0 − e ≥ 0 

(4.3)

570 Escanciano, Jacho-Chávez, and Lewbel

Quantitative Economics 7 (2016)

where X e is an endogenous regressor with
X e = g0 (X1 ) + u

(4.4)

where e and u are unobserved possibly correlated error terms. In our empirical application, Y will indicate whether an individual moves (migrates) from one state to another
in the United States, and X e will be logged income. People often move to find better
jobs, and unobservables that affect the willingness to relocate are likely to be related to
unobservables affecting income, so X e will generally be an endogenous regressor.
We assume we have the semiparametric model of equation (4.3) for migration Y
(semiparametric because the distribution of e is both unknown and correlated with X e ),
but the model for our endogenous regressor X e is nonparametric. One could argue that
much is known about the determinants of income, so perhaps the model for X e could
be parameterized as well, but we wish to consider the case where covariates X1 that
focus on migration have been collected, and just nonparametrically define g0 (X1 ) :=
E[X e |X1 ]. It then follows that E[u|X1 ] = 0. We assume endogeneity of X e in the Y equation takes the “control function” form e|X1  u ∼ e|u. Define X  β0 := X1 α0 + X e γ0 and
H0 (X) := X e − g0 (X1 ). Let V be the first element of the vector X1 , and let Z be the vector
consisting of the remaining elements of X1 and X e (as in the previous subsection, here
we simplify application of our theorems to the case where V is a scalar). Then, assuming
the first element of α0 is positive, we may without loss of generality scale all the coefficients and scale e to set the first element of α0 equal to 1 (α0;1 = 1), and thereby rewrite
equation (4.3) as




(4.5)
Y = I X  β0 − e ≥ 0 = I V + Z  δ0 − e ≥ 0 

where β0 = (1 δ
0 ) . Exploiting the condition e|X1  u ∼ e|u and u = H0 (X), define the
functions M and F0 by

M(X) := E[Y |X]

 
 
= E E I X  β0 − e ≥ 0 |X u X
 


 

= E E I X  β0 − e ≥ 0 |X  β0  H0 (X) X =: F0 X  β0  H0 (X) 
Assumption 6. Equations (4.4) and (4.5) hold with g0 (X1 ) := E[X e |X1 ] and e|X1  u ∼
e|u. Also V is continuously distributed conditional on Z.
Corollary 4.2. Let Assumptions 4 and 6 hold for j = 1     J. Then β0 , and the functions F0 and H0 are identified.
In our empirical implementation of this model we will have some discrete regressors, and a continuous exogenous regressor—an individual’s age—that we take to be the
regressor V . We use the more general support restrictions of Assumption 4 in Corollary 4.2 rather than the simpler conditions of Corollary 4.1, because age does not have
full real line support, though it is continuous over an interval, which facilitates satisfying the support restrictions in Assumption 4. We have evidence that the other required

Quantitative Economics 7 (2016)

Semiparametric two-step models 571

restrictions will similarly hold. In particular, among working age individuals migration
probabilities decrease steadily with age (since the gains in lifetime expected earnings
from migrating to a better paying job decrease linearly with age). Also, empirically income is highly nonlinear in age, providing the required nonlinearity in H0 (X). To satisfy
the remaining conditions, we have that F0 is monotonic in its first element since it equals
a conditional distribution function, and migration probabilities vary greatly with age as
required by the support assumptions.
5. Two-step semiparametric least squares estimation
Assume E[Y |X] = F0 [X  β0  H0 (X)], and define R(β X) := E[Y |X  β H0 (X)] for β in
the parameter space Θ ⊂ Rd . The identification results above provide sufficient conditions for R(β0  X) = R(β X) for all β ∈ Θ, β = β0 (i.e., E[Y |X] = R(β X) for all β = β0 ).
In turn, this implies by standard least-squares arguments that β0 = arg minβ∈Θ E[(Y −
R(β X))2 ], that is, the nonlinear least-squares criteria uniquely identify the parameter β0 . In this section, we propose an estimator for β0 based on a sample analog of this
minimization, in which the functions F0 and H0 that comprise R are estimated using
kernel regressions. We describe this estimator in detail for the binary choice model with
an endogenous regressor without instruments. Identification in the binary choice model
follows under Assumptions 4 and 6, by Corollary 4.2 above. Although we focus on this
binary choice model here, the same estimation approach can be applied to the more
general model described in equation (1.1). The only difference for other applications is
the form of the plug-in estimator for H0 (X).
To derive the asymptotic properties of our estimator we apply generic limiting distribution results in Escanciano, Jacho-Chávez, and Lewbel (2014). One of the example
applications in that paper applies to a similar binary choice model; however, the estimator we propose here differs substantially from the one proposed there, and has a different limiting distribution with different asymptotic properties. For example, the semiparametric least-squares estimator we propose here has an oracle property regarding
estimation of the function F0 that is not possessed by the semiparametric maximum
likelihood based estimator proposed in Escanciano, Jacho-Chávez, and Lewbel (2014).
This oracle property follows from Remark 3.1 in Escanciano, Jacho-Chávez, and Lewbel (2014, p. 430), and the fact that the gradient of F0 has zero conditional mean as in
Ichimura (1993). Therefore, the proposed estimator can be interpreted as a generalization of Ichimura (1993) that allows for additional generated conditional covariates while
preserving the oracle property, and as such is applicable to a wider range of problems
beyond those with dichotomous responses.
Recall that E[Y |X] = E[Y |w(X β0  g0 (X1 ))] almost surely (a.s.), where w(X β0 
g0 (X1 )) := [X  β0  X e − g0 (X1 )] , X := [X1  X e ] may contain both continuous and

discrete regressors, β0 := [α
0  γ0 ] (recall that we impose the normalization restriction
α0;1 = 1), and with some abuse of notation we denote the remainder parameters by β0 in
what follows. Similarly, we let g0 (x1 ) = E[X e |X1 = x1 ], where X e is a scalar random vari  X e }n is observed from the
able and X1 ⊂ X. We assume that a random sample {Yi  X1i
i i=1

e

joint distribution of (Y X1  X ) taking values in XY × XX1 × XX e ∈ Rd+2 . For any can-

572 Escanciano, Jacho-Chávez, and Lewbel

Quantitative Economics 7 (2016)

didate value of β and conditional mean function g, let W (β g) := [X  β X e − g(X1 )] ,
Wi (β g) := [Xi β Xie − g(X1i )] , W0 := W (β0  g0 ), and W0i := Wi (β0  g0 ), and set


F(w|β g) := E Y |W (β g) = w  w ∈ R2 
The regression function F(w|β g) can be consistently estimated by the nonparametric
Nadaraya–Watson kernel estimator

(w|β g)/f(w|β g)
F(w|β
g) := T
(w|β g) := 1
T
n
1
f(w|β g) :=
n

n

where



Yj K
hn Wj (β g) − w 

j=1
n



K
hn Wj (β g) − w 

j=1

Kh (w) = kh (w1 )kh (w2 ), w = (w1  w2 ), kh (u) = h−1 k(u/ h), k(·) is a kernel function, and

hn denotes a possibly data-dependent bandwidth parameter; see Assumptions B.4 and
B.5 in Appendix B. Our two-step semiparametric least-squares estimator (SLS) is
1
 := arg min Sn (β
β
g) ≡
n
β∈Θ

n


2
 Wi (β
g)|β
g 
Yi − F
ai 



(5.1)

i=1

where 
g represents the first-stage Nadaraya–Watson estimator of g0 satisfying Assump∗ 
∗ 
tion B.9 in Appendix B, and 
ai := I(fi∗ ≥ τn ), with fi∗ ≡ f(Wi (β
g)|β
g) for i = 1     n,

is a trimming function introduced here to keep f (Wi (β
g)|β
g) away from 0, with τn →
∗ , of β0 can be
0, as n → ∞ at a suitable rate. The preliminary consistent estimator, β
obtained by semiparametric M estimation with fixed trimming, that is, 
ai := I(Xi ∈ A)
for a compact set A ⊂ XX ; see, for example, Delecroix, Hristache, and Patilea (2006).
Notice that the estimator defined by (5.1) is like Ichimura’s (1993) estimator after
plugging in 
g, and is also considered in Ichimura and Lee (2010), except that here g0 is
not assumed to have an index structure, and we are allowing for a random trimming
function and a possibly data-dependent bandwidth. We establish the asymptotic properties of (5.1) by repeated applications of Escanciano, Jacho-Chávez, and Lewbel’s (2014)
uniform-in-bandwidth result.
After defining


Ψi := Yi − F0 (W0i |W0 ) ∂β F0 (W0i |W0 )

 

− Xie − g0 (X1i ) E ∂g F0 (W0i )∂β F0 (W0i |W0 ) X1i 
with ∂g F0 (W0i ) := ∂F0 (w(Xi  β0  g)|W0 )/∂g|g=g0i , the following theorem establishes the
consistency and asymptotic normality of the proposed estimator.
 is
Theorem 5.1. Let Assumptions 4 and 6, and Assumptions B.1–B.10 in B hold. Then β
consistent and asymptotically normal


√
 − β0 ) −→d N 0 Δ−1 Ω0 Δ−1 
n(β
0
0
where Ω0 := E[Ψi Ψi ] and Δ0 := E[∂β F0 (W0i |W0 )∂
β F0 (W0i |W0 )].

Semiparametric two-step models 573

Quantitative Economics 7 (2016)

 in this theorem can be readily estimated by the analog
The asymptotic variance of β
principle or by bootstrap methods. Estimation of g0 has an impact in the asymptotic
 through the term [X e − g0 (X1i )] × E[∂g F0 (W0i )∂β F0 (W0i |W0 )|X1i ]; however,
variance of β
i
 has an oracle property with respect to F0 , as its asymptotic properties
the estimator of β
are not affected by the lack of knowledge of F0 . Ichimura and Lee (2010) show this oracle
property for the special case where the first-stage estimate g0 has an index structure (and
assumed identification by exclusion assumptions), while our results show this oracle
property holds more generally for g0 estimated nonparametrically, and under our more
general conditions regarding trimming and bandwidth selection.
6. Numerical results
In this section we discuss the numerical implementation of our estimator (5.1) in the
context of a small Monte Carlo experiment and then an empirical implementation.
We make use of the np package by Hayfield and Racine (2008) in the statistical computing environment R. In particular, under its general public license (GPL) we modify its estimating function called npindex(...,method="ichimura",...) to allow
the inclusion of a second conditioning variable when calculating Ichimura’s (1993) estimator and user-specified weights. We use the options optim.method="BFGS" and
optim.method="Nelder-Mead" in each of the 20 times (option nmulti=20) we randomly restarted the optimization algorithm to avoid finding local minima in both the
Monte Carlo and the empirical application, respectively. We find our numerical calculations to be stable using a simple second order Gaussian kernel. We estimate our bandwidths jointly with the unknown β0 , that is,
  
 
β
h =

arg min

   
β h
∈Θ×R2

+

1
n

n




2
i Wi (β
Yi − F
g)|β
g 
ai 

(6.1)

i=1

making use of the fact that our asymptotic theory permits data-dependent bandwidth
. See also Marron (1994),
i denotes a leave-one-out version of F
choice, and where F
Härdle, Hall, and Ichimura (1993), and Rothe (2009) for related results regarding kernel and bandwidth choice. Random starting values in each restart and trimming function, 
ai , follow the original implementation by the np package developers and maintainers.
6.1 Monte Carlo experiments
We assess the performance of our identification strategy and our estimator with a
Monte Carlo simulation of a binary choice model with an endogenous regressor control function, where no outside instruments are available, as described in Section 4.2.
In particular, we generate 1000 samples of pseudo-random numbers, {Yi  X1i  Xie }ni=1 ,
with n ∈ {250 500 1000}, from (4.3)–(4.4), where X1 is univariate and has a centered
beta marginal distribution with shape parameters (2 2), g0 (u) = 2φ(u), where φ rep-

574 Escanciano, Jacho-Chávez, and Lewbel

Quantitative Economics 7 (2016)

resents the probability density function of a standard normal random variable, and the
error terms, ε and u, were generated independently of X = [X1  X e ] from marginal
normal distributions with var(ε) = 1, var(u) = 1/8, and correlation coefficient ρ =
{0 −1/2 −3/4}.
As required for identification, we set α0 = 1, and the parameter of interest becomes
β0 = [1 γ0 ] , so γ0 is to be estimated, with its true value equal to 1. We calculated four
sets of estimators of our parameter of interest, γ0 = 1: Set 1, the standard probit; Set 2,
Ichimura’s (1993) estimator; Set 3, the infeasible semiparametric estimator that uses the
true g0 ; Set 4, the proposed (feasible) semiparametric least squares with g0 estimated by
the Nadaraya–Watson estimator with bandwidths chosen in each replication by leastsquares cross-validation. Results are presented in Table 1. They show the simulated median bias (Bias), standard deviation (Std. Dev.), root mean square error (RMSE), and the
mean absolute deviation (MAE). Both Set 1 and Set 2 are only consistent when ρ = 0,
because they are misspecified otherwise. They are useful as benchmarks to check if errors in our estimator are smaller than errors due to (sometimes) misspecified existing
estimators. Notice that when ρ = 0, the probit model is correctly specified and the most
efficient. Model Set 3 provides an infeasible standard in all scenarios against which the
proposed estimator can be compared to measure the extent of the first-step impact on
the estimation precision of the proposed estimator, Set 4.
In all scenarios and sample sizes, estimators Sets 3 and 4 performs well in terms
of median bias and RMSE. The Monte Carlo variance of Set 4 is larger than in Set 3 as
expected by the asymptotic theory for small to medium sample sizes, but they become
comparable to Set 3 for n = 1000. The relatively small RMSE of estimators Sets 3 and 4,
and the rate at which it shrinks as the sample size grows, suggests that our identification
without instruments is not weak.
When ρ = 0, the simulated variance of the infeasible version of the proposed estimator (Set 3) is slightly larger than in Set 2, indicating a loss of efficiency when trying
to control for nonexistent endogeneity in the model. When the endogeneity problem
is severe, that is, ρ = −3/4, both versions of the proposed estimator perform very well
in comparison to the standard probit and Ichimura’s (1993) estimators, which become
substantially biased.
6.2 Empirical application
As previously discussed, we now estimate a binary choice model for workers’ migration
decisions based on a sample of 22–69 year old male household heads who had completed education by the time of interview and who reported positive labor income during 1989–1990. The sample is drawn from the 1990 wave of the Panel Study of Income
Dynamics (PSID). The top 1% highest earning individuals are dropped to reduce the
impact of outliers. Details regarding this data construction are in Dong (2010). Table 2
shows descriptive statistics of the resulting 4582 observations in the sample.
Let Y indicate if an individual moves (migrates, 1 or 0) from one state to another in
the United States in the years 1991–1993, and let X e be the logarithm of their average
labor income in 1989 and 1990. Exogenous covariates X1 are State (number of states

ρ=0
Est.

ρ = −1/2

ρ = −3/4

Std. Dev.

RMSE

MAE

Bias

Std. Dev.

RMSE

MAE

Bias

Std. Dev.

RMSE

MAE

n = 250
Set 1
Set 2
Set 3
Set 4

0033
−0032
−0025
−0015

0154
0395
0460
0476

0161
0399
0492
0502

0119
0266
0334
0344

0014
0295
0004
0004

0114
0366
0438
0501

0118
0513
0438
0501

0087
0388
0267
0294

−0343
0224
−0003
−0002

0063
0520
0481
0619

0337
0615
0514
0639

0331
0423
0317
0338

n = 500
Set 1
Set 2
Set 3
Set 4

0011
−0022
−0008
−0009

0104
0234
0348
0363

0107
0234
0420
0432

0082
0169
0267
0282

0007
0365
0000
0000

0077
0273
0315
0347

0079
0484
0333
0357

0060
0405
0173
0197

−0333
0123
−0003
−0003

0040
0277
0313
0322

0332
0321
0354
0354

0329
0230
0191
0200

n = 1000
Set 1
Set 2
Set 3
Set 4

0009
−0015
−0004
−0005

0072
0156
0329
0328

0073
0156
0413
0412

0057
0120
0254
0256

−0064
0361
0000
0000

0045
0196
0262
0264

0077
0433
0285
0282

0067
0388
0124
0125

−0372
0142
−0001
−0001

0024
0190
0282
0287

0371
0249
0319
0323

0371
0188
0152
0159

Note: This table displays Monte Carlo median bias (Bias), standard deviation (Std. Dev.), root mean squared error (RMSE), and mean absolute error (MAE) of the standard probit (Set 1),
Ichimura’s (1993) estimator (Set 2), the infeasible two-step SLS (Set 3), and the feasible two-step SLS (Set 4).

Semiparametric two-step models 575

Bias

Quantitative Economics 7 (2016)

Table 1. Monte Carlo results.

Name

Description

Y

Dummy variable of whether an individual
changes state of residence during 1991–1993 or not
Dummy variable of whether an individual
has a college education or not
The number of U.S. states individual ever lived in
Family size
Age in years
Natural logarithm of average annual labor income

Edu
State
Size
Age
log(Income)

Mean

Std. Dev.

25% Q.

0174

0379

0

0

0

0

1

0418

0493

0

0

1

0

1

218
328
38444
10012

1478
1584
10816
0931

1
2
30
9651

Median

2
3
36
10178

75% Q.

3
4
44
10601

Min.

1
1
22
4068

Max.

576 Escanciano, Jacho-Chávez, and Lewbel

Table 2. Descriptive statistics.

8
17
69
1168

Quantitative Economics 7 (2016)

Note: The sample consists of 4582 observations from the 1990 wave of the Panel Study of Income Dynamics (PSID). The sample consists of male household heads who are not students
and reported positive labor income between 1989 and 1990.

Quantitative Economics 7 (2016)

Semiparametric two-step models 577

ever lived in, 1–8), Edu (dummy indicating college or above education, 1 or 0), Size (logarithm of family size, 1–17), and Age (22–69). Theoretical models of migration decisions
as a function of observed labor income are based on variants of the binary Roy model.
See, for example, Heckman and Honoré (1990). We adopt the simple specification given
by Dong (2010) where the model is Y = I(X  β0 − e ≥ 0) = I(X1 α0 + X e γ0 − e ≥ 0),
where the endogenous regressor X e has X e = g0 (X1 ) + u, and e and u are unobserved
error terms, correlated with each other but independent of X1 . Then as shown earlier,
E[Y |X] = F0 [w(X β0  g0 )], where w(X β0  g0 ) := [X  β0  X e − g0 (X1 )] .
Note that by construction E(u|X1 ) = 0, so u is mean independent of X1 . This means
that u is not unobserved ability; rather, it is unobserved ability after conditioning on education level as well as other covariates. The standard control function assumption regarding u is therefore that this mean independence extends to full independence of X1 .
We include Edu in the list of covariates X1 since it is relevant for wages and hence for the
migration decision, and is predetermined at the time of the migration decision.
If we had an exclusion, that is, a covariate that affected Y but not X e , then this model
would be identified by, for example, Blundell and Powell (2004). However, it is not plausible in this application that any of the observed determinants of Y would not also affect
X e , since the utility from migrating depends at least in part on potential changes in labor income. We therefore assume identification without exclusion assumptions based
on Theorem 3.2 (or more specifically, based on Corollary 4.2). We take Age to be the continuous regressor V . This requires that the latent variable driving the probability that Y
equals 1 be linear in age (which as noted earlier is supported by the human capital theory of migration) and that this probability varies over a reasonably wide range with age.
The nonlinearity of X e − g0 (X1 ) =: H0 (X) required for identification will hold if g0 (X1 )
is nonlinear in age.
Figure 1 shows Nadaraya–Watson kernel regression estimates of E[Y |Age] and
E[log(Income)|Age] with bandwidths chosen by least-squares cross-validation and 95%
pointwise confidence intervals based on 399 bootstrapped replications. This figure provides empirical evidence supporting our preceding identifying assumptions. For example, E[Y |Age] takes on a reasonably wide range of values, considering that the expected
probability that a randomly chosen individual migrates in a 3 year period would not generally be high. Also the estimated migration probability is close to linear and certainly
plausibly monotonic in age, while log(Income) is highly nonlinear and nonmonotonic
in age. Similar results are reported in Dong (2010), who estimates a restricted version of a
model similar to ours with more parametric restrictions, but still exploiting nonlinearity
in E[log(Income)|Age] to aid in identification.
We estimate the model three ways: estimator I uses a probit that ignores endogeneity
of labor income and assumes e is normal, estimator II is Ichimura’s (1993), which ignores
endogeneity but does not assume a parameterized distribution for e, and estimator III
is our proposed two-step SLS. The coefficient of State is normalized to 1 in all specifications for comparison purposes. This is a free normalization. We also report marginal
effects. Bandwidths in II and III were estimated jointly with the unknown β0 coefficients
to minimize least squares, and then used throughout to calculate related quantities such
as asymptotic standard errors and marginal effects.

578 Escanciano, Jacho-Chávez, and Lewbel

Quantitative Economics 7 (2016)

Figure 1. Nonparametric age effects on labor income and migration probabilities. Note:
Nadaraya–Watson estimates of E[Y |Age] (solid gray line) and E[log(Income)|k] (solid black line)
with bandwidths chosen by least-squares cross-validation and 95% pointwise confidence intervals based on 399 bootstrapped replications (dotted lines).

For our proposed estimator, estimator III, in the first stage we nonparametrically
regress the endogenous covariate log(Income) on State, Edu, Size, and Age using generalized kernels as suggested in Racine and Li (2004) to handle the combination of discrete and continuous regressors, with smoothing parameters chosen by least-squares
cross-validation. The resulting data-dependent bandwidths are 1 for State, 00442 for
Edu, 01348 for Size, and 21121 for Age. We then estimate β in the second step as in (6.1),
where Xie −
g(X1i ) equals the residuals from the first-step nonparametric regression. Ta Define ∂w F0 (W0i ) := ∂F0 (w1  w2 |W0 )/∂w1 |
ble 3 shows the resulting estimates β.
1
w1 =Xi β0 .
 evaluated at the sample mean of the estimated index in II, and
Table 3 also reports ∂w F
1

the sample mean of the estimated indexes corresponding to III. Marginal effects for all
models are shown in Table 4. The marginal effects, marked with an asterisk (*), were
 in Table 3 by their corresponding estimated
obtained by multiplying the reported ∂w1 F
coefficient. Using results in Sperlich (2009), the asymptotic standard errors for models II
β
2 var(β
j ). For discrete
2 + ∂w F
and III are approximated as the square root of var(∂w1 F)
1
j
covariates Edu and Size, Table 4 also reports for each t − s the corresponding change,
t − F
s , where F
l represents the value of F
 evaluated at the implied index where a parF
ticular discrete variable is set equal to l while keeping the remaining part of the index

Quantitative Economics 7 (2016)

Semiparametric two-step models 579

Table 3. Migration binary choice model estimation results.
Variable
Edu
Size
Age
log(Income)
Const.
σ2
Bandwidths
Obj. func.
∂∂w F
1

Estimator I
−02535 (05802)
01397 (01737)
−01897 (00403)
−15803 (04089)
87084 (35356)
12334 (22075)
−20630
02510 (00622)

Estimator II

Estimator III

−0037 (00145)
−00042 (00076)
−00084 (00009)
−01408 (00044)

15257 (02924)
05309 (01471)
−03138 (00191)
−26427 (00892)

00731 (09325 14135)
01399
04378 (01912)

01398
00216 (00056)

Note: Results for probit (Estimator I), Ichimura’s (1993) estimator (Estimator II), and the feasible two-step SLS (Estimator III). The coefficient of state was normalized to 1 for all estimators. Asymptotic standard errors are given in parentheses.
Nonparametric residuals in the first step were obtained using the generalized kernel estimator of Racine and Li (2004) with
bandwidth chosen by least-squares cross-validation.

Table 4. Estimated marginal effects.
Variable

Estimator I

Estimator II

Estimator III

Edu∗
0–1

−00052 (00119)
−00052 (00119)

−00162 (00095)
−00166 (00296)

00329 (00106)
00355 (00114)

Size∗
1–2
2–3
3–4

00028 (00035)
00028 (00033)
00028 (00034)
00028 (00035)

−00018 (00034)
−00017 (00305)
−00018 (00301)
−00018 (00296)

00115 (00044)
00036 (00110)
00081 (00109)
00124 (00112)

−00039 (00005)
−00322 (00060)

−00037 (00017)
−00617 (00270)

−00067 (00018)
−0057 (00149)

Age∗
log(Income)∗

× β
j . All other marginal effects are
Note: The asterisk (*) denotes that marginal effects for variable j are calculated as ∂w1 F
 from changing the value of the discrete covariate from t to t + 1 while keeping the remaining
calculated as increments in F
parts of the index at their respective sample mean. Asymptotic standard errors are given in parentheses.

equal to its sample mean. Results in Schuster (1972) also allow us to approximate their
t ) + var(F
s ).
standard errors as the square root of var(F
Although β0 has the same normalization in all the estimators, estimated marginal
effects were still generally closer across specifications than estimates of β0 , suggesting
that small sample biases in estimating β0 and F0 may be offsetting to some extent. Moreover, marginal effects are more directly economically interpretable as the impacts of regressors on the probability of migrating. We therefore focus on summarizing marginal
effects.
In all the estimates, age has a negative impact on the probability of moving as expected by theory; however, the effect of age is more than 50% larger in our estimators
that take endogeneity of income into account, which suggests the importance of controlling for endogeneity. The endogenous regressor log income has a negative effect in
all the specifications, consistent with higher wage individuals having less income incentive to move. It is not clear how education should affect migration probabilities, and

580 Escanciano, Jacho-Chávez, and Lewbel

Quantitative Economics 7 (2016)

the estimates of this effect vary inconclusively across models. The effects of family size
were not statistically significant, but our estimates controlling for income endogeneity
suggest that larger families are more likely to move.
7. Conclusions
The new identification and estimation results in this paper are applicable to a wide variety of common econometric models, including latent index models with an endogenous regressor and nonlinear models with sample selection. The estimator we propose
for this class of models allows for data-driven bandwidths, which we exploit by selecting
bandwidths that minimize the same objective function that is used to estimate model
parameters. This numerically effective procedure performs well in our Monte Carlo experiments and in an empirical application to a migration decision model.
Regarding identification, we show that identification based on functional form,
without exclusion restrictions or instruments, extends to a semiparametric setting
where error distributions are unknown, first-stage regression functions are unknown,
and the only parameterization is that one index in the model is linear. The somewhat
surprising result, based on our theorems, simulations, and empirical results, is that parameters can be strongly identified and accurately estimated in this setting. While identification based on valid (and ideally randomized) instruments is of course preferable, it
is important to know the extent to which reasonably precise identification and inference
results can be obtained without instruments.
Appendix A: Proofs of main results
Proof of Theorem 3.1. Dropping V for now for clarity, define ∂r F0 := ∂F0 (r H)/∂r and
∂H F0 := ∂F0 (r H)/∂H. Equating m with F0 and taking derivatives shows that
∂Vk m = ∂r F0 α0;k + ∂H F0 ∂Vk H

(A.1)

Since α0;1 = 1 we have for each k = 2     K,
 



1
∂V1 H
∂r F0
∂V1 m
=

∂H F0
∂Vk m
α0;k ∂Vk H
By Assumption 2, ∂Vk g = ∂V1 Hα0;k so the matrix in the above equation is nonsingular.
Inverting to solve for ∂r F0 and ∂H F0 gives
∂r F0 =

∂Vk H∂V1 m − ∂V1 H∂Vk m

∂Vk H − ∂V1 Hα0;k

∂H F0 =

∂Vk m − ∂V1 mα0;k

∂Vk H − ∂V1 Hα0;k

Equating the above expression for ∂r F0 based on coefficients indexed by k with the same
expression evaluated at some other index i gives
∂Vk H∂V1 m − ∂V1 H∂Vk m ∂Vi H∂V1 m − ∂V1 H∂Vi m
=

∂Vk H − ∂V1 Hα0;k
∂Vi H − ∂V1 Hα0;i

Quantitative Economics 7 (2016)

Semiparametric two-step models 581

so
(∂Vk H∂V1 m − ∂V1 H∂Vk m)(∂Vi H − ∂V1 Hα0;i )
= (∂Vi H∂V1 m − ∂V1 H∂Vi m)(∂Vk H − ∂V1 Hα0;k )
which simplifies to
(∂Vk H∂Vi m − ∂Vi H∂Vk m)
= (∂Vk H∂V1 m − ∂V1 H∂Vk m)α0;i − (∂Vi H∂V1 m − ∂V1 H∂Vi m)α0;k 

(A.2)

which is linear in α0;k and α0;i . The same equation is obtained if one equates the expression for ∂H F0 based on two indices k and i.
Recalling the dependence of the functions above on V , equation (A.2) evaluated at
V = v and at V = 
v with i = j can be written as




α0;j
v)∂Vj m(
v) − ∂Vj H(
v)∂Vk m(
v)
∂Vk H(
=Ψ

(A.3)
α0;k
∂Vk H(v)∂Vj m(v) − ∂Vj H(v)∂Vk m(v)
where the matrix Ψ is given by


∂Vk H(
v)∂V1 m(
v) − ∂V1 H(
v)∂Vk m(
v) ∂Vj H(
v)∂V1 m(
v) − ∂V1 H(
v)∂Vj m(
v)
Ψ=

∂Vk H(v)∂V1 m(v) − ∂V1 H(v)∂Vk m(v) ∂Vj H(v)∂V1 m(v) − ∂V1 H(v)∂Vj m(v)
Using equation (A.1), each term in the matrix Ψ has the form
∂Vk H∂V1 m − ∂V1 H∂Vk m
= ∂Vk H(∂r F0 α0;1 + ∂g F0 ∂V1 H) − ∂V1 H(∂r F0 α0;k + ∂H F0 ∂Vk H)

(A.4)

= (∂Vk H − α0;k ∂V1 H)∂r F0 
so


 

v)
0
v α H(
∂r F0 

 
0
∂r F0 v α H(v)


v) − α0;k ∂V1 H(
v) ∂Vj H(
v) − α0;j ∂V1 H(
v)
∂Vk H(

×
∂Vk H(v) − α0;k ∂V1 H(v) ∂Vj H(v) − α0;j ∂V1 H(v)


Ψ=

Assumption 2 imposes sufficient conditions to ensure that the determinants of each of
the two matrices on the right above are nonzero, which shows that Ψ is nonsingular.
Since Ψ is nonsingular, equation (A.3) can be solved for α0;k and α0;j by inverting Ψ ,
thereby identifying α0;k and α0;j . Given identification of α0;k , we then may identify all
other coefficients α0;i by solving equation (A.2) (evaluated at V = v) for α0;i , which gives

α0;i = ∂Vk H(v)∂Vi m(v) − ∂Vi H(v)∂Vk m(v)



+ ∂Vi H(v)∂V1 m(v) − H1 (v)∂Vi m(v) α0;k


/ ∂Vk H(v)∂V1 m(v) − ∂V1 H(v)∂Vk m(v) 

582 Escanciano, Jacho-Chávez, and Lewbel

Quantitative Economics 7 (2016)

Note that the denominator in this expression is nonzero by Assumption 2 and equation (A.4). Finally, given identification of α0 , the function F0 is identified by F0 (V  α0 
H(V )) = E[m(V )|V  α0  H(V )].

Proof of Theorem 3.2. The function F0 is identified on the support of V  α0 , H0 (V  0)
by F0 (r H) = E[M(V  0)|V  α0 = r H0 (V  0) = H]. Then for each j, δ0;j solves
M[v(zj )
zj ] = F0 [v(zj ) α0 + zj δ0;j  H0 (v(zj ) zj )]. Invertibility of F0 on its first element
ensures that this solution is unique, and the support assumptions ensure that F0 is
identified at this point. Then, given this identification of each δ0;j , F0 is identified by
F0 (V  α0 + Z  δ0  H0 (V  Z)) = E[M(V  Z)|V  α0 + Z  δ0  H0 (V  Z)].

Proof of Corollary 4.1. The functions M and H0 are identified by M(V  Z) =
E[Y |V  Z] and H0 (V  Z) = E[D|V  Z]. Given these results and the construction of F0 ,
Assumption 1 holds with α0 = 1. By construction, differentiability of F0 follows from e
and u being jointly continuously distributed, and similarly by construction F0 is strictly
monotonic and hence invertible in V + Z  δ0 . The remaining conditions of Assumption 4 for j = 1     J hold by Assumption 5 with V having infinite support. Therefore
the conditions of Theorem 3.2 hold, so Corollary 4.1 holds.

Proof of Corollary 4.2. The functions M and H0 are identified by M(V  Z) =
E[Y |V  Z] and H0 (V  Z) := X e − E[X e |X1 ]. Given these results and the construction of
F0 , Assumption 1 holds with α0 = 1. Given Assumptions 1 and 4 we have Theorem 3.2
holding, so Corollary 4.2 holds.

 we need to prove the uniform
Proof of Theorem 5.1. To prove the consistency of β,
convergence of Sn (β
g) to S (β g0 ) ≡ E[Sn (β g0 )], uniformly in β, where
1
Sn (β g0 ) ≡
n

n




2
Yi − F0 Wi (β g0 )|β g0 

i=1

First, it follows from the triangle inequality that
sup Sn (β
g) − S (β g0 )
β∈Θ

g) − Sn (β g0 ) + sup Sn (β g0 ) − S (β g0 ) 
≤ sup Sn (β
β∈Θ

β∈Θ

Notice that
sup Sn (β
g) − Sn (β g0 )
β∈Θ

≤ max

 



 Wi (β
F
g)|β
g − F0 Wi (β g0 )|β g0

sup

1≤i≤n β∈Θ;x∈X

×

sup

β∈Θ;x∈X

+ sup
β∈Θ

1
n

n

1
n

n
i=1

 




 Wi (β

g)|β
g + F0 Wi (β g0 )|β g0 − 2Yi
ai F



i=1


2
ai − 1) 
Yi − F0 Wi (β g0 )|β g0 (

Semiparametric two-step models 583

Quantitative Economics 7 (2016)

By the uniform-in-bandwidth results of Escanciano, Jacho-Chávez, and Lewbel (2014),
the simple inequality








I f∗ < τn ≤ I f (W0i |W0 ) < 2τn + I f∗ − f W0i |W0 > τn 
and Assumptions B.7, B.9, and B.3, we obtain max1≤i≤n |
ai − 1| = oP (1). From a uniform
law of large numbers (ULLN), it then follows that
sup
β∈Θ

1
n

n



2
Yi − F0 Wi (β g0 )|β g0 (
ai − 1) = oP (1)

i=1

Now, by the uniform-in-bandwidth results of Escanciano, Jacho-Chávez, and Lewbel
(2014) and Assumption B.3,
 



 Wi (β
max sup
F
g)|β
g − F0 Wi (β g0 )|β g0 = oP (1)
(A.5)
1≤i≤n β∈Θ;x∈X

Using the last equality and the ULLN we conclude that
sup

β∈Θ;x∈X

1
n

n


 



 Wi (β

g)|β
g(x) + F0 Wi (β g0 )|β g0 − 2Yi = OP (1)
ai F

i=1

The ULLN is justified since F0 (Wi (β g0 )|β g0 ) is continuous in β and uniformly
bounded under our assumptions. The same arguments imply that supβ∈Θ |Sn (β g0 ) −
S (β g0 )| = oP (1).
We now show identification of the nonlinear least-squares criteria. By Corollary 4.2, under Assumptions 4 and 6, it holds that if β0 = β, then F0 (Wi (β g0 )|β g0 ) =
F0 (Wi (β0  g0 )|β0  g0 ) with positive probability. Then, by E[Y |X] = F0 (Wi (β0  g0 )|β0  g0 ),
we have
 


2 
S (β g0 ) = S (β0  g0 ) + E F0 Wi (β g0 )|β g0 − F0 Wi (β0  g0 )|β0  g0
> S (β0  g0 )
Thus, the nonlinear least-squares criteria uniquely identify the parameter β0 . Hence we
 = β0 + oP (1).
conclude by Theorem 2.1 in Newey and McFadden (1994, p. 2121) that β
We now prove the asymptotic normality of the proposed estimator by standard
methods coupled with the general result in Escanciano, Jacho-Chávez, and Lewbel
(2014). By the first order conditions,
√
 g) = √1
0 ≡ − n∂β Sn (β
n

n




 Wi (β
 g)|β
 g(x) ψ(X

 i  β)
Yi − F

i=1


 =
 g)|β
 g). Now by a standard Taylor expansion,
 i  β)
ai ∂
where ψ(X
β F(Wi (β
√
 g) = √1
− n∂β Sn (β
n

n
i=1



 Wi (β0 

 i  β)
g)|β0 
g(x) ψ(X
Yi − F



√
 g) n(β
 − β0 )
+ Hn (β

584 Escanciano, Jacho-Chávez, and Lewbel

Quantitative Economics 7 (2016)

 is an intermediate point between β
 and β0 and
where β
 g) = 1
Hn (β
n

n





 Wi (β
 Wi (β
 g)|β
 g ∂ F
 g)|β
g 

ai ∂β F
β

i=1

Note that






 Wi (β
 Wi (β
 Wi (β
 g)|β
 g = Xi ∂w1 F
 g)|β
 g + ∂β2 F
 g)|β
g 
∂β F
 and ∂β2 F
 denote the derivatives of F(w
 1  w2 |β g) with respect to w1 and β,
where ∂w1 F
respectively. From Escanciano, Jacho-Chávez, and Lewbel (2014) it then follows that


 Wi (β
 g)|β
 g − ∂ F0 (Wi |β0  g0 ) = oP (1)
∂β F
β
Hence, applying Theorem 3.2 in Escanciano, Jacho-Chávez, and Lewbel (2014, p. 430)
 we have
 i  β)
with the class Φ = T ηF , and using the uniform consistency of ψ(X
1
√
n

n





 Wi (

 i  β)
Yi − F
g)|
g(x) ψ(X

i=1

n


1
=√
Yi − F0 (W0i |W0 ) ψ⊥ (Xi  β0 )
n i=1


 
− Xie − g0 (X1i ) E ∂g F0 (W0i )ψ⊥ (Xi  β0 )|X1i + oP (1)

where
 

ψ⊥ (Xi  β0 ) = ∂
β F0 (W0i |W0 ) − E ∂β F0 (W0i |W0 ) W0 
Using Ichimura’s (1993) arguments one can show that


E ∂
β F0 (W0i |W0 ) W0 = 0
 i (β
 g)|β
 g) it follows that
On the other hand, by the uniform consistency of ∂β F(W


 g) →P Δ0 = E ∂β F0 (W0 )∂ F0 (W0 ) 
Hn (β
β
Hence, we conclude that
√

 − β0 )
n(β
n


1
= −Δ−1
Yi − F0 (W0i |W0 ) ∂β F0 (W0i |W0 )
√
0
n i=1

 

− Xie − g0 (X1i ) E ∂g F0 (W0i )∂β F0 (W0i |W0 ) X1i + oP (1)

The result then follows from an application of the Lindeberg–Lévy central limit theorem
(CLT).


Semiparametric two-step models 585

Quantitative Economics 7 (2016)

Appendix B: Asymptotic theory—Conditions
Define for any vector (a1      ad ) of d integers the differential operator ∂ax := ∂|a| /

a
a
∂x1 1    ∂xdd , where |a| := di=1 ai . Let XX be the support of X and let XX1 be the support of X1 . Assume that XX1 is a convex, bounded subset of Rd , with nonempty interior.
For any smooth function h : XX1 ⊂ Rd → R and some η > 0, let η be the largest integer
smaller than η and
h∞η := max sup ∂ax h(x) + max sup
|a|≤η x∈X

|a|=η x1 =x2

∂ax h(x1 ) − ∂ax h(x2 )
x1 − x2 η−η



η

Further, let CM (XX1 ) be the set of all continuous functions h : XX1 ⊂ Rd → R with
h∞η ≤ M. Since the constant M is irrelevant for our results, we drop the dependence
on M and denote C η (XX1 ). Define the sup-norm h∞ := supx∈XX |h(x)|.
1

e 
Let x := [x
1  x ] , fX (x|w W ) be the density, with respect to a σ-finite measure
μW (·) of X conditional on W (β g) = w and evaluated at x ∈ XX . Similarly, define
W0 := W (β0  g0 ) and W0i := Wi (β0  g0 ). Let G from Rd to R be the class of functions where
g belongs. Define the class of functions W as



e
d+1
W := x → v1 + x

2 β x − g(x1 ) : β ∈ Θ ⊂ R

g ∈ G ⊂C ηg (XX1 ) g − g0 ∞ < δ

for an arbitrarily small δ > 0 and ηg > d. The following assumptions will be needed in
our subsequent analysis. Escanciano, Jacho-Chávez, and Lewbel (2014) provide sufficient primitive conditions for some of our high-level assumptions in terms of the density
of X and the class G .
Assumption B.1. The sample observations {Yi  Xi }ni=1 are a sequence of independent and identically distributed (i.i.d.) variables, distributed as (Y X  ) and satisfying
E[|Y |p |X = x] < ∞ a.s. for some p > 2 and E[Y |X] = E[Y |W0 ] a.s.
Assumption B.2. The parameter space Θ is a compact subset of Rd and β0 is an element
of its interior. The class G ⊂ C ηg (XX1 ) for some ηg > d.
Assumption B.3. For all W ∈ W and x ∈ XX , f (w|W ), F0 (w|W ), and fX (x|w W ) are rtimes continuously differentiable in w, with uniformly (in w, W , and x) bounded derivatives (including zero derivatives) where r is as in Assumption B.4 below.
Assumption B.4. The kernel function k(t) : R → R is bounded, symmetric, continuously


differentiable, and satisfies the following conditions: k(t) dt = 1, t l k(t) dt = 0 for 0 <
 r
l < r, and |t k(t)| dt < ∞ for some r ≥ 2; |∂k(t)/∂t| ≤ C and for some v > 1, |∂k(t)/∂t| ≤
C|t|−v for |t| > L, 0 < L < ∞.
hn ≤
Assumption B.5. The possibly data-dependent bandwidth 
hn satisfies P(an ≤ 
bn ) → 1 as n → ∞ for deterministic sequences of positive numbers an and bn such that
(i) bn → 0 and a4n n/ log n → ∞, and (ii) nb4r
n → 0.

586 Escanciano, Jacho-Chávez, and Lewbel

Quantitative Economics 7 (2016)

Conditions B.1–B.3 are standard in the literature. Assumptions B.3 and B.7 below
are needed for establishing uniform convergence rates for kernel estimators, and for a
uniform expansion of nonparametric residual-marked empirical processes. Note that by
consistency of 
g we can take G to be contained in an arbitrary neighborhood of g0 .
Assumption B.4 is standard in the literature of nonparametric kernel estimation,
while Assumption B.5 permits data-dependent bandwidths, as in Andrews (1995). In
c hn with 
c stochasparticular, our theory allows for plug-in bandwidths of the form 
hn = 
tic and hn a suitable deterministic sequence converging to 0 as n → ∞. Andrews
(1995) points out that this condition holds in many cases for other common datadependent bandwidth selection procedures, such as cross-validation and generalized
cross-validation. Obviously, our results also apply to deterministic sequences. In parhn = cn−δ for some constant c > 0, then Assumption B.5(ii)
ticular if 
hn is of the form 
requires that 1/2r < δ < 1/2, so r needs to be greater than 1.
We now introduce two classes of functions that will serve as parameter spaces for
the functions F(w(x β g)|β g) and f (w(x β g)|β g), respectively, where henceforth
w(x β g) := [x β xe − g(x1 )] . Let T η be a class of uniformly bounded and measurable
functions




x → q w(x β g)|β g : β ∈ Θ g ∈ G  q ∈ T

(B.1)

such that for a universal constant CL , all gj ∈ G , βj ∈ Θ, j = 1 2, and all q ∈ T ,




q w|β1  g1 − q(w|β2  g2 ) ≤ CL |β1 − β2 | + g1 − g2 ∞ 

(B.2)

Moreover, we assume that there exists a convex, bounded subset of R2 , say CW , with
nonempty interior such that for each g ∈ G , β ∈ Θ, it holds that q(·|β g) ∈ C η (CW ), for
some η > 1.
g − g0 ∞ ,
Define the rates pn := Pr(f (W0 |W0 ) ≤ 2τn ), wn := 


 log a−2 ∨ log log n
n
+ brn 
dn := 
na2n
i ≡ ∂β F(W
 i (β
 g)|β
 g).
and qn := τn−1 dn + wn . Use the short notation ∂β F
 ∈ T ηF ) → 1 and
Assumption B.6. (i) We have F0 ∈ T ηF . (ii) For all i = 1     n, P(F
η
 ∈ T F ) → 1 for some ηF > 1.
P(∂β F
Assumption B.7. We have that τn is a sequence of positive numbers satisfying τn → 0,
nτn−6 dn4 → 0, and n(τn−l qnl + p2n ) → 0 for some l ≥ 2.
Assumption B.6 is a high-level condition and Escanciano, Jacho-Chávez, and Lewbel
(2014) provides sufficient low-level conditions for it to hold in various setups. Similarly,
Assumption B.7 is used to handle the random trimming as in Escanciano, Jacho-Chávez,
and Lewbel (2014).

Semiparametric two-step models 587

Quantitative Economics 7 (2016)

Assumption B.8. The function F0 (w1  w2 |W0 ) is twice continuously differentiable in w2
with bounded derivatives, for all w2 .
Assumption B.9. (i) The regression g0 is estimated by a Nadaraya–Watson kernel estimator with a kernel function satisfying Assumption B.4 with r = ρ and a possibly
hgn ≤ un ) → 1 as n → ∞ for deterministic sestochastic bandwidth 
hgn satisfying P(ln ≤ 
2ρ
quences of positive numbers ln and un such that un → 0 and nlnd / log n → ∞; nun → 0;
(ii) the function g0 and the density fX1 (·) of X1 are ρ-times continuously differentiable
in x, with bounded derivatives. The density fX1 (·) is bounded away from 0. Furthermore
g ∈ G ) → 1 for some ηg > 2.
g0 ∈ G ⊂ C ηg (XX1 ), P(
Assumption B.10. The matrix Δ0 := E[∂β F0 (W0i |W0 )∂
β F0 (W0i |W0 )] is positive definite.
Assumptions B.8 and B.9 are standard in the literature. Examples of random bandc hgn with
widths that satisfy our assumptions are plug-in bandwidths of the form 
hgn = 

c bounded in probability and hn a suitable deterministic sequence. Assumption B.9 has
been verified to hold under primitive regularity assumptions for the local polynomial
estimator in Neumeyer and Van Keilegom (2010) when all the X1 ’s are continuous. See
also Escanciano, Jacho-Chávez, and Lewbel (2014). Finally, Assumption B.10 is also standard and it ensures the nonsingularity of the asymptotic covariance matrix of the final
estimator.
References
Andrews, D. W. K. (1995), “Nonparametric kernel estimation for semiparametric models.” Econometric Theory, 11, 560–596. [586]
Blundell, R. W. and J. L. Powell (2004), “Endogeneity in semiparametric binary response
models.” Review of Economic Studies, 71, 655–679. [562, 564, 577]
Chamberlain, G. (1986), “Asymptotic efficiency in semi-parametric models with censoring.” Journal of Econometrics, 32 (2), 189–218. [566]
Chen, X., O. B. Linton and I. Van Keilegom (2003), “Estimation of semiparametric models
when the criterion function is not smooth.” Econometrica, 71 (5), 1591–1608. [562, 563]
Cragg, J. G. (1971), “Some statistical models for limited dependent variables with application to the demand for durable goods.” Econometrica, 39 (5), 829–844. [568]
Delecroix, M., M. Hristache, and V. Patilea (2006), “On semiparametric M-estimation in
single-index regression.” Journal of Statistical Planning and Inference, 136 (3), 730–769.
[572]
Dong, Y. (2010), “Endogenous regressor binary choice models without instruments, with
an application to migration.” Economics Letters, 107 (1), 33–35. [563, 574, 577]
Escanciano, J. C., D. T. Jacho-Chávez, and A. Lewbel (2014), “Uniform convergence of
weighted sums of non- and semi-parametric residuals for estimation and testing.” Journal of Econometrics, 178, 426–443. [562, 571, 572, 583, 584, 585, 586, 587]

588 Escanciano, Jacho-Chávez, and Lewbel

Quantitative Economics 7 (2016)

Härdle, W., P. Hall, and H. Ichimura (1993), “Optimal smoothing in single-index models.”
The Annals of Statistics, 21 (1), 157–178. [573]
Hayfield, T. and J. S. Racine (2008), “Nonparametric econometrics: The np package.”
Journal of Statistical Software, 27 (5), 1–32. [573]
Heckman, J. J. (1979), “Sample selection bias as a specification error.” Econometrica, 47
(1), 153–161. [562, 564, 565, 568]
Heckman, J. J. and B. E. Honoré (1990), “The empirical content of the Roy model.” Econometrica, 58 (5), 1121–1149. [577]
Heckman, J. J., R. L. Matzkin, and L. Nehseim (2010), “Nonparametric identification and
estimation of nonadditive hedonic models.” Econometrica, 78 (5), 1569–1591. [566]
Ichimura, H. (1993), “Semiparametric least squares (SLS) and weighted SLS estimation
of single index models.” Journal of Econometrics, 58, 71–120. [562, 571, 572, 573, 574, 575,
577, 579, 584]
Ichimura, H. and L. Lee (1991), “Semiparametric least squares estimation of multiple index models: Single equation estimation.” In Nonparametric and Semiparametric Methods in Econometrics and Statistics (W. A. Barnett, J. Powell, and G. Tauchen, eds.), 3–49,
Cambridge University Press, Cambridge. [563]
Ichimura, H. and S. Lee (2010), “Characterization of the asymptotic distribution of semiparametric M-estimators.” Journal of Econometrics, 159 (2), 252–266. [562, 563, 572,
573]
Klein, R., C. Shen, and F. Vella (2014), “Semiparametric selection models with binary
outcomes.” Unpublished paper. [563]
Komunjer, I. (2012), “Global identification in nonlinear models with moment restrictions.” Econometric Theory, 28 (4), 719–729. [566]
Lewbel, A. (2007), “Estimation of average treatment effects with misclassification.”
Econometrica, 75 (2), 537–551. [566]
Lewbel, A. and O. B. Linton (2007), “Nonparametric matching and efficient estimators of
homothetically separable functions.” Econometrica, 75 (4), 1209–1227. [563]
Lewbel, A., O. B. Linton, and D. McFadden (2011), “Estimating features of a distribution
from binomial data.” Journal of Econometrics, 162 (2), 170–188. [566]
Li, K.-C. (1991), “Sliced inverse regression for dimension reduction.” Journal of the American Statistical Association, 86 (414), 316–327. [563]
Marron, J. S. (1994), “Visual understanding of higher-order kernels.” Journal of Computational and Graphical Statistics, 3 (4), 447–458. [573]
Matzkin, R. L. (1992), “Nonparametric and distribution-free estimation of the binary
threshold crossing and the binary choice models.” Econometrica, 60, 239–270. [568]

Quantitative Economics 7 (2016)

Semiparametric two-step models 589

Matzkin, R. L. (2007), “Nonparametric identification.” In Handbook of Econometrics,
Vol. VIB (J. J. Heckman and E. E. Leamer, eds.), 5307–5368, North-Holland, Amsterdam.
[566]
Neumeyer, N. and I. Van Keilegom (2010), “Estimating the error distribution in nonparametric multiple regression with applications to model testing.” Journal of Multivariate
Analysis, 101, 1067–1078. [587]
Newey, W. K. and D. McFadden (1994), “Large sample estimation and hypothesis
testing.” In Handbook of Econometrics, Vol. IV (D. McFadden and R. F. Engle, eds.),
2111–2245, North-Holland, Amsterdam. [562, 583]
Pinkse, J. (2001), “Nonparametric regression estimation using weak separability.” Unpublished paper. [563]
Racine, J. S. and Q. Li (2004), “Nonparametric estimation of regression functions with
both categorical and continuous data.” Journal of Econometrics, 119 (1), 99–130. [578,
579]
Rivers, D. and Q. H. Vuong (1988), “Limited information estimators and exogeneity tests
for simultaneous probit models.” Journal of Econometrics, 39 (3), 347–366. [564]
Rothe, C. (2009), “Semiparametric estimation of binary response models with endogenous regressors.” Journal of Econometrics, 153 (1), 51–64. [563, 564, 573]
Schuster, E. F. (1972), “Joint asymptotic distribution of the estimated regression function
at a finite number of distinct points.” The Annals of Mathematical Statistics, 43 (1), 84–88.
[579]
Sperlich, S. (2009), “A note on non-parametric estimation with predicted variables.”
Econometrics Journal, 12 (2), 382–395. [578]

Co-editor Petra Todd handled this manuscript.
Submitted November, 2012. Final version accepted December, 2015.

