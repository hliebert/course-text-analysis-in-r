Econometrica, Vol. 86, No. 6 (November, 2018), 1939–1963

IDENTIFYING EFFECTS OF MULTIVALUED TREATMENTS
SOKBAE LEE
Department of Economics, Columbia University and Institute for Fiscal Studies
BERNARD SALANIÉ
Department of Economics, Columbia University
Multivalued treatment models have typically been studied under restrictive assumptions: ordered choice, and more recently, unordered monotonicity. We show how treatment effects can be identified in a more general class of models that allows for multidimensional unobserved heterogeneity. Our results rely on two main assumptions:
treatment assignment must be a measurable function of threshold-crossing rules, and
enough continuous instruments must be available. We illustrate our approach for several classes of models.
KEYWORDS: Identification, selection, multivalued treatments, instruments, monotonicity, multidimensional unobserved heterogeneity.

1. INTRODUCTION
SINCE THE SEMINAL WORK of Heckman (1979), selection problems have been one of the
main themes in both empirical economics and econometrics. One popular approach in the
literature is to rely on instruments to uncover the patterns of the self-selection into different levels of treatments, and thereby to identify treatment effects. The main branches
of this literature are the local average treatment effect (LATE) framework of Imbens and
Angrist (1994) and the local instrumental variables (LIV) framework of Heckman and
Vytlacil (2005).
The LATE and LIV frameworks emphasize different parameters of interest and suggest
different estimation methods. However, they both focus on binary treatments, and restrict
selection mechanisms to be “monotonic.” Vytlacil (2002) established that the LATE and
LIV approaches rely on the same monotonicity assumption. For binary treatment models, these approaches require that selection into treatment be governed by a single index
crossing a threshold.
Many real-world selection problems are not adequately described by single-crossing
models. The literature has developed ways of dealing with less restrictive models of assignment to treatment. Angrist and Imbens (1995) analyzed ordered choice models. Heckman, Urzua, and Vytlacil (2006, 2008) showed how (depending on restrictions and instruments) a variety of treatment effects can be identified in discrete choice models that
are additively separable in instruments and errors. More recently, Heckman and Pinto
(2018) defined an “unordered monotonicity” condition that is weaker than monotonicity
Sokbae Lee: sl3841@columbia.edu
Bernard Salanié: bsalanie@columbia.edu
We are grateful to the co-editor and to four anonymous referees for their comments. We also thank
Stéphane Bonhomme, Eric Gautier, Joe Hotz, Thierry Magnac, Lars Nesheim, Rodrigo Pinto, Adam Rosen,
Christoph Rothe, Azeem Shaikh, Alex Torgovitsky, Ed Vytlacil, and especially Jim Heckman for their very
useful suggestions. We also benefited from comments of seminar audiences in Cambridge, Chicago, Duke,
Georgetown, Harvard, MIT, NYU, UCL, and Yale. We would like to thank Junlong Feng and Cameron LaPoint for proofreading the paper. This research has received financial support from the European Research
Council under the European Community’s Seventh Framework Program FP7/2007-2013 Grant Agreement
295298-DYSMOIA and under the Horizon 2020 Framework Program Grant Agreement 646917-ROMIA.
© 2018 The Econometric Society

https://doi.org/10.3982/ECTA14269

1940

S. LEE AND B. SALANIÉ

when treatment is multivalued. They showed that, given unordered monotonicity, several
treatment effects can be identified.
Even the most generally applicable of these approaches can still only deal with models
of treatment that are formally analogous to an additively separable discrete choice model,
as proved in Section 6 of Heckman and Pinto (2018). The key condition is that the data
contain changes in instruments that create only one-way flows in or out of the treatment
cells the analyst is interested in. In binary treatment models, this is exactly the meaning
of monotonicity: there cannot be both compliers and defiers, so that LATE estimates the
average treatment effect on compliers.1 Things are somewhat more complex in multivalued treatment models. Unless selection only depends on one function of the instruments,
there exist changes in instruments that generate two-way flows in and out of any treatment
cell. Unordered monotonicity requires that we observe some changes in instruments that
only induce one-way flows.
This is still too restrictive for important applications. For instance, many transfer programs (or many educational tests) rely on several criteria and combine them in complex
ways to assign agents to treatments; and agents add their own objectives and criteria to
the list. An additively separable discrete choice model may not describe such a selection
mechanism. To see this, start from a very simple and useful application: the double hurdle
model, which treats agents only if each of two indices passes a threshold.2 While this is
a binary treatment model, the existence of two thresholds makes it non-monotonic: if a
change in instruments increases a threshold but reduces the other, some agents move into
the treatment group and some move out of it.
The double hurdle model is still unordered monotonic, as any change in instruments
that moves the two thresholds in the same direction only creates one-way flows. Now
let us change the structure of the model slightly: there are still two thresholds, but we
only treat agents who are above one threshold and below the other. As we will see in
Section 2, any change in instruments that moves both thresholds generates two-way flows,
and standard approaches to identification fail. This model of selection with two-way flows is
formally equivalent to a discrete choice model with three alternatives in which the analyst
only observes partitioned choices (e.g., the analyst only observes whether alternative 2
is chosen or not). Our identification results apply to this variant of the double hurdle
model, and to all treatment models generated by a finite family of threshold-crossing
rules. In fact, one way to describe our contribution is that it encompasses all additively
separable discrete choice models in which the analyst only observes a partition of the set
of alternatives.
To illustrate the applicability of our framework, assume that assignment to treatment
can be described by a random utility model of choice. Now imagine that, as is common
in practice, the analyst only observes choices between sets of treatments: for example,
various vocational programs have been aggregated into a “training” category in her data
set. Our methods allow identification of the effect of these different training programs
on outcomes, provided that continuous instruments shift their mean utilities. Variables
such as distance to the locations of the training centers or other components of the “full
cost” of treatment could serve as instruments in this application. For another example,
consider a dynamic sequence of treatments such as the curriculum of a college student or
the career of a worker. This could be represented as a “decision tree” in which various
1

de Chaisemartin (2017) showed that under a weaker condition, LATE estimates the average treatment
effect on a specific subset of the compliers.
2
See, for example, Poirier (1980) for a parametric version of this model.

IDENTIFYING EFFECTS OF MULTIVALUED TREATMENTS

1941

threshold-crossing rules govern the path of the individual through time. Again, this type
of model could be analyzed using the techniques in this paper. We study related examples
more formally in Section 4.
Our analysis allows selection to be determined by a vector of threshold-crossing rules.
Each of these rules compares a scalar unobservable to a threshold; these unobservables
can be correlated with each other and with potential outcomes. We proceed in two steps.
First, assume that the thresholds are known to the analyst. We use their values as control variables to deal with multidimensional unobserved heterogeneity. One important
difference with the unidimensional case is that, in our setting, LATE-type estimators can
only recover a mixture of causal parameters on groups that cross different thresholds, and
are therefore harder to interpret. We establish conditions under which one can identify
a generalized version of the marginal treatment effects (MTE) of Heckman and Vytlacil
(2005), as well as the probability distribution of unobservables governing the selection
mechanism, and more aggregated treatment effects such as the average treatment effect
(ATE), quantile treatment effects, the average treatment effect on the treated (ATT), and
the policy-relevant treatment effect (PRTE).
Since thresholds often are not known a priori, the second step requires identifying them
from the data. This is highly model-specific and the family of models encompassed in this
paper is too large and diverse to allow for a general result. We limit our discussion to a few
applications; in particular, we provide what we believe are new identification theorems for
the double-hurdle model.
We give a detailed comparison of our paper to the existing literature in Section 5.
Let us here mention a few points in which our paper differs from the literature. Unlike Imbens (2000), Hirano and Imbens (2004), Cattaneo (2010), and Yang, Imbens, Cui,
Faries, and Kadziola (2016), we allow for selection on unobservables. Gautier and Hoderlein (2015) studied binary treatment when selection is driven by a rule that is linear in
a vector of unobservable heterogeneity. Lewbel and Yang (2016) considered a different non-monotonic rule for binary treatment to identify the average treatment effect.
These two papers break monotonicity in different ways than ours. We focus on the pointidentification of marginal treatment effects, unlike the research on partial identification
(see, e.g., Manski (1990, 1997), and Manski and Pepper (2000)). Chesher (2003), Hoderlein and Mammen (2007), Florens, Heckman, Meghir, and Vytlacil (2008), Imbens and
Newey (2009), D’Haultfœuille and Février (2015), and Torgovitsky (2015) studied models with continuous endogenous regressors. Each of these papers develops identification
results for various parameters of interest. Our paper complements this literature by considering multivalued (but not continuous) treatments with more general types of selection
mechanisms.
Heckman and Vytlacil (2007, Appendix B) and Heckman, Urzua, and Vytlacil (2008),
and, more recently, Heckman and Pinto (2018) and Pinto (2015), are more closely related
to our paper. But they focused on the selection induced by multinomial discrete choice
models, whereas our paper allows for more general selection problems.
The paper is organized as follows. Section 2 sets up our framework; it motivates our
central assumptions by way of examples. We present and prove our identification results
in Section 3. Section 4 applies our results to three important classes of applications, including the models mentioned in this introduction. We relate our contributions to the
literature in Section 5. Finally, Section 6 gives the proof of the main theorem. Some further results and details of the omitted proofs are collected in the Supplemental Material
(Lee and Salanié (2018)).

1942

S. LEE AND B. SALANIÉ

2. THE MODEL AND OUR ASSUMPTIONS
We assume throughout that treatments take values in a finite set of treatments K. This
set may be naturally ordered, as with different tax rates. But it may not be, as when welfare
recipients enroll in different training schemes, for instance; this makes no difference to
our results. We assume that treatments are exclusive. This involves no loss of generality
as treatment values could easily be redefined otherwise. We denote K = |K| the number
of treatments, and we map the set K into {0     K − 1} for notational convenience.
We denote {Yk : k ∈ K} the potential outcomes. Let Dk be 1 if the k 
treatment is realized
and 0 otherwise. The observed outcome and treatment are Y := k∈K Yk Dk and
D := k∈K kDk , respectively.
In addition to the covariates X, observed treatment D, and outcomes Y , the data contain a random vector Z that will serve as instruments. We always condition on the value of
X in our analysis of identification, and thus suppress it from the notation. Observed data
consist of a sample {(Yi  Di  Zi ) : i = 1     N} of (Y D Z), where N is the sample size.
We denote the generalized propensity scores by Pk (Z) := Pr(D = k|Z); they are directly
identified from the data. Our models of treatment assignment rely on functions of the
instruments Q(Z) that are a priori unknown to the econometrician and will need to be
identified. We also introduce random vectors V to represent unobserved heterogeneity.
Let G denote a function defined on the support Y of Y , which can be discrete, continuous, or multidimensional. We focus on identification of the conditional counterfactual
expectations E(G(Yk )|V = v) and on measures of treatment effects that can be derived
from them. For example, a possible object of interest is the marginal treatment effect
(MTE), defined as E(Yk − Yl |V = v). This is similar to the MTE in the binary treatment
model, in that it conditions on the value of unobserved heterogeneity in treatment. One
important difference is that the link between the unobserved heterogeneity vector V and
the generalized propensity scores Pr(D = k|Z) is now more indirect.
Aggregating up would give the mean of the counterfactual outcome G(Yk ) (conditional
on the omitted covariates X). Once we identify EG(Yk ) for each k, we also identify the
average treatment effect E(G(Yk ) − G(Yj )) between any two treatments k and j. Alternatively, if we let G(Yk ) = 1(Yk ≤ y) for some y, where 1(·) is the usual indicator
function, then the object of interest is the cumulative distribution function (cdf) of Yk .
This leads to the identification of quantile treatment effects.
One of our aims is to relax the usual monotonicity assumption that underlies the LATE
and LIV estimators. Consider the following, simple example where K = 3, and treatment
assignment is driven by a pair of random variables V1 and V2 whose marginal distributions
are normalized to be U[0 1].
EXAMPLE 1—Selection With Two-Way Flows: Assume that there are two thresholds
Q1 (Z) and Q2 (Z) such that
• D = 0 iff V1 < Q1 (Z) and V2 < Q2 (Z),
• D = 1 iff V1 > Q1 (Z) and V2 > Q2 (Z),
• D = 2 iff (V1 − Q1 (Z)) and (V2 − Q2 (Z)) have opposite signs.
We could interpret Q1 and Q2 as minimum grades or scores in a two-part exam or an
eligibility test based on two criteria: failing both parts/criteria assigns you to D = 0, passing
both to D = 1, and failing only one to D = 2.

IDENTIFYING EFFECTS OF MULTIVALUED TREATMENTS

1943

FIGURE 1.—Example 1.

If F is the joint cdf of (V1  V2 ), it follows that the generalized propensity scores are
P0 (Z) = F(Q1 (Z) Q2 (Z))
P1 (Z) = 1 − Q1 (Z) − Q2 (Z) + F(Q1 (Z) Q2 (Z))

(2.1)

P2 (Z) = Q1 (Z) + Q2 (Z) − 2F(Q1 (Z) Q2 (Z))
Take a change in the values of the instruments that increases both Q1 (Z) and Q2 (Z):
both criteria, or both parts of the exam, become more demanding. Figure 1 plots this
change in (V1  V2 ) space. The black square represents the initial marginal observation,
with V1 = Q1 (Z) and V2 = Q2 (Z); and the red circle at the other end of the arrow is the
new marginal observation. In both cases, the quadrants delimited by the axes that intersect
at the marginal observation define treatment cells. Observations in region (A) move from
D = 1 to D = 2, those in region (B) move from D = 1 to D = 0, and those in region (C)
move from D = 2 to D = 0. Note that observations in region (C) leave D = 2, while those
in region (A) move into D = 2: there are two-way flows in and out of D = 2. This violates
monotonicity, and even the weaker assumption that generalized propensity scores are
monotonic in the instruments. Moreover, it is easy to see that any change in the thresholds
creates such two-way flows; Figure 2 illustrates it for changes in opposite directions, with
observations in region (E) moving from D = 0 to D = 2, observations (F) moving from

1944

S. LEE AND B. SALANIÉ

FIGURE 2.—Example 1 (continued).

D = 2 to D = 1, observations (G) moving from D = 1 to D = 2, and observations (H)
moving from D = 2 to D = 0.
Therefore, this model violates the weaker requirement of unordered monotonicity of
Heckman and Pinto (2018), which we describe in Section 5.3—unless we are only interested in treatment values 0 and 1.
To take a slightly more complicated example, consider the following entry game.
EXAMPLE 2—Entry Game: Two firms j = 1 2 are considering entry into a new market.
Firm j has profit πjm if it becomes a monopoly, and πjd < πjm if both firms enter. The static
Nash equilibria are simple:
• if for both firms πjm < 0, then no firm enters;
• if πjm > 0 and πkm < 0, then only firm j enters;
• if for both firms πjd > 0, then both firms enter;
• if πjd > 0 and πkd < 0, then only firm j enters;
• if πjm > 0 > πjd for both firms, then there are two symmetric equilibria, with only one
firm operating.
Now let πjm = Vj − Qj (Z) and πjd = V̄j − Q̄j (Z), and suppose we only observe the number
D = 0 1 2 of entrants. Then
• D = 0 iff V1 < Q1 (Z) and V2 < Q2 (Z);

IDENTIFYING EFFECTS OF MULTIVALUED TREATMENTS

1945

• D = 2 iff V̄1 > Q̄1 (Z) and V̄2 > Q̄2 (Z);
• D = 1 otherwise.
This is very similar to the structure of Example 1; in fact, it coincides with it in the degenj
erate case when, for each firm, πmj and πd have the same sign with probability 1.3
2.1. The Selection Mechanism
These two examples motivate the weak assumption we impose on the underlying selection mechanism. In the following, we use J to denote the set {1     J}.
ASSUMPTION 2.1—Selection Mechanism: There exist a finite number J, a vector of unobserved random variables V := {Vj : j ∈ J}, and a vector of known functions Q(Z) := {Qj (Z) :
j ∈ J} such that any of the following three equivalent statements holds:
(i) the treatment variable D is measurable with respect to the σ-field generated by the
events

 

Ej V  Q(Z) := Vj < Qj (Z) for j ∈ J;
(ii) each event {D = k} = {Dk = 1} is a member of this σ-field;
(iii) for each k, there exists a function dk that is measurable with respect to this σ-field
such that Dk = dk (V  Q(Z)).
Moreover, every treatment value k has positive probability.
The threshold conditions in Assumption 2.1 have the “rectangular” form Vj < Qj (Z).
Appendix E of the Supplemental Material discusses a more general form of linear inequalities βj · V < Qj (Z). Note that the fact that every observation belongs to one and
only one treatment group imposes further constraints. We defer discussion of these constraints to Section 4, where we show how they can be used for overidentification tests.
In this notation, the validity of the instruments translates into the following:
ASSUMPTION 2.2—Conditional Independence of Instruments: Yk and V are jointly independent of Z for each k = 0     K − 1.
To describe the class of selection mechanisms defined in Assumption 2.1 more concretely, we focus on a treatment value k. We define Sj (V  Q(Z)) := 1(Vj < Qj (Z)) for
j = 1     J. The σ-field generated by {Ej (V  Q(Z)) : j = 1     J} is obtained by taking
unions, intersections, and complements of these Ej sets. These three operations correspond to taking sums, products, and differences of their indicator functions Sj . Therefore,
the function dk referred to in Assumption 2.1(iii) can be written as an algebraic sum of
products of the Sj indicator functions. Let L denote the set of all subsets l = {l1      l|l| }
of J . Then




dk V  Q(Z) =


l∈L

|l|
 
  k


c
Sj V  Q(Z) =
cl
Slm V  Q(Z) 
k
l

j∈l

l∈L

(2.2)

m=1

where the clk are algebraic integers. Moreover, this decomposition is unique.
3
If the econometrician observes not only the number of the entrants but also their identity, we face the
usual partial identification problem generated by the existence of multiple equilibria (see, e.g., Tamer (2003)).
If equilibrium selection is modeled as an additional threshold-crossing rule, then our approach actually encompasses this case. We refer the reader to Appendix C of the Supplemental Material, where we explain this
in more detail.

1946

S. LEE AND B. SALANIÉ

Since dk (V  Q(Z)) depends on V and Q(Z) only through S := {Sj (V  Q(Z)) : j ∈ J}, it
will sometimes be convenient to express dk as a function of S, which we denote Dk (S).
k
k
k
S1 + c{2}
S2 + c{12}
S1 S2 for some algebraic
For example, if J = 2, we have Dk (S) = c∅k + c{1}
k
k
k
k
integers c∅ , c{1} , c{2} , and c{12} .
To illustrate this, let us return to Example 1, with J = 2 and K = 3. For k = 0, the
selection mechanism is described by the intersection E1 ∩ E2 , whose indicator function is
D0 (S) = S1 S2 . Similarly, for k = 1, we find D1 (S) = (1 − S1 )(1 − S2 ). Finally, for k = 2, we
have

D2 (S) = S1 (1 − S2 ) + (1 − S1 )S2 = S1 + S2 − 2S1 S2 
It is useful to think of the products in (2.2) as alternatives in a discrete choice model. For
instance, (1 − S1 )S2 could be interpreted as “item 1” having negative value and “item 2”
having positive value. In Example 1, D2 = 1 informs us that the values of item 1 and of
item 2 have opposite signs. In essence, we are dealing with discrete choice models with
only partially observed choices. This analogy will prove useful.
2.2. Indices and Degrees
The term l = {1     J} = J , which corresponds to the product of all J indicator functions Sj in (2.2), plays an important role in our analysis. We will call its cl the index of the
treatment.
DEFINITION 2.1: Take a treatment value k in a treatment model with J thresholds. We
call the coefficient cJk in (2.2) the index of treatment k.
k
k
In Example 1, the highest order term has a coefficient c{12}
= 1 if k = 0 1 and c{12}
= −2
if k = 2. With J = 2 as in Example 1, the only treatments with a zero index are those
which depend on only one threshold: for example, 1(V1 < Q1 ). But with three or more
thresholds (J > 2), it is not hard to generate cases in which a treatment value k depends
on all J thresholds and still has zero index, as shown in Example 3.

EXAMPLE 3—Zero Index: Assume that J = K = 3 and take treatment 0 such that
D0 = 1(V1 < Q1 (Z) V2 < Q2 (Z) V3 < Q3 (Z))
+ 1(V1 > Q1 (Z) V2 > Q2 (Z) V3 > Q3 (Z))
Then the indicator function for {D0 = 1} is

D0 (S) = S1 S2 S3 + (1 − S1 )(1 − S2 )(1 − S3 ) = 1 − S1 − S2 − S3 + S1 S2 + S1 S3 + S2 S3 
which has no degree 3 term.
When the index is zero as in Example 3, the indicator function of the corresponding
treatment k has degree strictly smaller than J. Since Assumption 2.1 rules out the uninteresting cases when treatment k occurs with probability zero or 1, its indicator function
cannot be constant; and its leading terms have degree m ≥ 1. We call m the degree of
treatment k. In Example 3, treatment value 0 has index 0 and degree 2.
The following lemma summarizes the discussion in Sections 2.1 and 2.2:

IDENTIFYING EFFECTS OF MULTIVALUED TREATMENTS

1947

LEMMA 2.1: Under Assumption 2.1, for each k ∈ K, there exists a unique family of algebraic integers (clk ) such that

  k 

cl
Sj V  Q(Z) 
dk V  Q(Z) =
l∈L

j∈l

where L is the set of all subsets l = {l1      l|l| } of J .
The leading terms of the multivariate polynomial Dk (S) have degree 1 ≤ m ≤ J, which we
also call the degree of treatment k.
• If m = J, then the leading term in Dk (S) is
cJk

J


Sj 

j=1

• If m < J, then cJk = 0.
We call cJk the index of treatment k.
3. IDENTIFICATION RESULTS
In this section, we fix x in the support of X and we suppress it from the notation. All the
results obtained below are local to this choice of x. Global (unconditional) identification
results follow immediately if our assumptions hold for almost every x in the support of X.
We only treat the nonzero index in the text. We make this explicit in the following
assumption.
ASSUMPTION 3.1—Nonzero Index: The index cJk defined in Lemma 2.1 is nonzero.
We analyze zero-index treatments in Appendix A.1 of the Supplemental Material.
We require that V have full support:
ASSUMPTION 3.2—Continuously Distributed Unobserved Heterogeneity in the Selection Mechanism: The joint distribution of V is absolutely continuous with respect to the
Lebesgue measure on RJ and its support is [0 1]J .
Note that when J = 1, Assumptions 2.1 and 3.2 define the usual threshold-crossing
model that underlies the LATE and LIV approaches. However, our assumptions allow
for a much richer class of selection mechanisms when J > 1. Our Example 1 illustrates
that our “multiple thresholds model” does not impose any multidimensional extension
of the monotonicity condition that is implicit with a single threshold model. Even when
K = 2, so that treatment is binary, J could be larger than 1. This would allow for flexible
treatment assignment: just modify Example 1 to obtain the double hurdle model


D = 1 V1 < Q1 (Z) and V2 < Q2 (Z) 
Let fV (v) denote the joint density function of V at v ∈ [0 1]J . Our identification argument relies on continuous instruments that generate enough variation in the thresholds.
This motivates the following three assumptions.
For any function ψ of q, define “local equicontinuity at q ” by the following property:
for any subset I ⊂ J , the family of functions qI → ψ(qI  q−I ) indexed by q−I ∈ [0 1]|J−I| is
equicontinuous in a neighborhood of qI .

1948

S. LEE AND B. SALANIÉ

ASSUMPTION 3.3—Local Equicontinuity at q: The functions v → fV (v) and v →
E(G(Yk )|V = v) are locally equicontinuous at v = q.
Assumption 3.3 allows us to differentiate the relevant expectation terms. It is fairly
weak: Lipschitz continuity, for instance, implies local equicontinuity.4
DEFINITION 3.1: Let Z denote the support of Z, and Q = Q(Z ) the range of variation
of Q(Z).
The next two assumptions apply to the functions Q(Z), and in particular, to their range
of variation over the support Z of Z. The functions Q are unknown in most cases, and
need to be identified; in this part of the paper, we assume that they are known. We will
return to identification of the Q functions in Section 3.2.
ASSUMPTION 3.4—Open Range at q: The point q belongs to the interior of the range of
variation of the thresholds Q.
Assumption 3.4 ensures that we can generate any small variation in Q(Z) around q by
varying the instruments around z. This makes the instruments strong enough to deal with
multidimensional unobserved heterogeneity V .
With J thresholds, Assumption 3.4 requires that Q contains a J-dimensional neighborhood of q. This in turn can only happen (given Assumption 3.3) if the range of variation
of the instruments Z contains an open subset of RJ . Having J-dimensional continuous
variation in the instruments is crucial to our approach.
For some corollaries, we use a global version of Assumptions 3.3 and 3.4. To state it
formally, we need one last definition.
DEFINITION 3.2: Let Q̃ ⊂ Q denote the set of values q where Assumptions 3.3 and 3.4
both hold.
ASSUMPTION 3.5—Global Condition: Q̃ contains (0 1)J .
Assumption 3.5 requires both that the variation in the instruments generates all possible values of the J thresholds and that Assumptions 3.3 and 3.4 hold everywhere. We do
not need this rather stringent assumption to identify the marginal treatment effects; but
it is useful to derive various parameters of interest that aggregate the marginal treatment
effects.
3.1. Identification With a Nonzero Index
We are now ready to prove identification of E(G(Yk )|V = q) when treatment k has
a nonzero index. In the following theorem, for any real-valued function q → h(q), the
notation
T h(q) ≡

∂J h
(q)
J

∂qj
j=1

4
It would be easy to adapt our results to cases where, for instance, Q has discontinuities. We do not pursue
it in this paper.

IDENTIFYING EFFECTS OF MULTIVALUED TREATMENTS

1949

refers to the J-order derivative that obtains by taking derivatives of the function h at q in
each direction of J , when this derivative exists.
THEOREM 3.1—Identification With a Nonzero Index: Let Assumptions 2.1, 2.2, 3.1,
and 3.2 hold. Fix a value q where Assumptions 3.3 and 3.4 hold; that is, q ∈ Q̃. Then the
density of V and the conditional expectation of G(Yk ) are given by5
1
T Pr(D = k|Q(Z) = q)
cJk


T E G(Y )Dk |Q(Z) = q

E G(Yk )|V = q =
T Pr(D = k|Q(Z) = q)
fV (q) =

Q.E.D.

PROOF OF THEOREM 3.1: See Section 6.
For two treatment values k and , define the marginal treatment effect as
(k)
MTE

(v) := E G(Yk )|V = v − E G(Y )|V = v 

(3.1)

The MTE function v → (k)
MTE (v) is the average treatment effect conditional on V = v.
Since V is the vector of unobservables that determine the selection mechanism, the MTE
function reveals how treatment effects vary with the unobservables governing selection.
As such, it captures the effect of selection and it allows the analyst to simulate counterfactual policies. It follows from Theorem 3.1 that if k and  are two treatments to which all
of our assumptions apply, then we can identify the marginal treatment effect of moving
between these two treatments, as well as the quantile version of this MTE. We also identify the joint density function v → fV (v), which is an object of interest since it describes
the dependence among elements of V . Appendix A.1 of the Supplemental Material extends Theorem 3.1 to zero-index treatment values; it shows that similar formulæ identify
marginal treatment effects averaged over the missing threshold rules.
As in Heckman and Vytlacil (2005), we can identify various treatment effect parameters
using Theorem 3.1. The following corollary shows that one can identify the average treatment effect (ATE), the average treatment effect on the treated (ATT), and the policyrelevant treatment effect (PRTE) of Heckman and Vytlacil (2001). The PRTE measures
the average effect of moving from a baseline policy to an alternative policy. To define the
PRTE, consider a class of policies that change Q but that do not affect E[G(Yk )|V = v].
Let D∗k and Y ∗ , respectively, denote
 the treatment choice indicator and the outcome under a new policy Q∗ . Define D∗ ≡ k∈K kD∗k .
COROLLARY 3.2: If Assumption 3.5 holds in addition to the conditions assumed in Theorem 3.1, then the average treatment effect (ATE) and the average treatment effect on the
treated (ATT) are identified by

5

E G(Yk ) − G(Y ) =

(k)
MTE

(v)ωATE (v) dv

(3.2)

E G(Yk ) − G(Y )|D = m =

(k)
MTE

(v)ωm
ATT (v) dv

(3.3)

The proof of the theorem shows that these derivatives are well-defined.

1950

S. LEE AND B. SALANIÉ

where
ωATE (v) := fV (v)
ωm
ATT (v) :=

Pr dm (v Q(Z)) = 1 fV (v)

Pr(D = m)

Furthermore, policy-relevant treatment effects (PRTEs) are identified by

 
E G Y ∗ − E G(Y ) =



Υk v Q∗  Q E G(Yk )|V = v fV (v) dv

k∈K

E D∗ − E[D] =



k



Υk v Q∗  Q fV (v) dv

k∈K

E D∗k = 1 − E[Dk = 1] =



Υk v Q∗  Q fV (v) dv

where




Υk v Q∗  Q := Pr dk v Q∗ (Z) = 1 − Pr dk (v Q(Z)) = 1 
PROOF OF COROLLARY 3.2: See Appendix B.1 of the Supplemental Material. Q.E.D.
In many applications, the range of variation of the thresholds may be limited so that
Assumption 3.5 will not hold. However, it is still possible to construct bounds for the
ATE, ATT, and PRTE if G(Yk ) is bounded. For example, consider Pr(Yk ≤ y), which is the
ATE for G(Yk ) = 1(Yk ≤ y). As shown in the proof of Theorem 3.2, we can point-identify
E[G(Yk )|V = q]fV (q) by (cJk )−1 T E(G(Y )Dk |Q(Z) = q) for each q ∈ Q̃. In addition, we
know that G(Yk ) is either 0 or 1. As in Manski (1990) and Heckman and Vytlacil (2000),
using this fact, we can bound EG(Yk ) = Pr(Yk ≤ y) within the interval defined by
1
cJk



T E 1(Y ≤ y)Dk |Q(Z) = q dq
q∈Q

and
1
cJk

q∈Q





T E 1(Y ≤ y)Dk |Q(Z) = q dq + 1 − Pr Q(Z) ∈ Q ;

and without further information, these bounds are sharp.
Finally, the analyst may only have discrete-valued instruments. A recent literature on
the MTE focuses on this case (with binary treatment); it relies on assumed restrictions on
the shape of the MTE function (see, e.g., Brinch, Mogstad, and Wiswall (2017), Kowalski
(2016), and Mogstad, Santos, and Torgovitsky (2017)). We are exploring different ways of
relaxing these restrictions within our framework.
3.2. Identification of Q
So far, we assumed that the functions {Qj (Z) : j = 1     J} were known (see Assumption 2.1). In practice, we often need to identify them from the data before applying Theorems 3.1 or A.1. The most natural way to do so starts from the generalized propensity

IDENTIFYING EFFECTS OF MULTIVALUED TREATMENTS

1951

scores {Pk (Z) : k = 0     K − 1}, which are identified as the conditional probabilities of
treatment.6
First note that, by definition (and by Assumption 2.2),
Pk (z) = Pr(D = k|Z = z)
=



 
1 dk v Q(z) = 1 fV (v) dv

Note that this is a J-index model. Ichimura and Lee (1991) considered identification
of multiple index models when the indices are specified parametrically. Matzkin (1993,
2007) obtained nonparametric identification results for discrete choice models;7 but her
results only apply to a subset of the types of selection mechanisms we consider (discrete
choice models when all choices are observed). Section 4 discusses identification of the Q’s
through the lens of several models.
4. APPLICATIONS
Our framework covers a wide variety of commonly used models. For simplicity, we only
illustrate its usefulness on two-threshold selection models in this section. These models generate different selection patterns. Not surprisingly, the identification conditions
require somewhat stronger instruments as the number of treatment values—the information available to the analyst—decreases.
4.1. Selection With Two-Way Flows
Let us return to Example 1, in which
• D = 0 iff V1 < Q1 (Z) and V2 < Q2 (Z),
• D = 1 iff V1 > Q1 (Z) and V2 > Q2 (Z),
• D = 2 iff (V1 − Q1 (Z)) and (V2 − Q2 (Z)) have opposite signs.
It is useful to start with some exclusion restrictions that help us identify Q1 (Z) and
Q2 (Z) separately from the generalized propensity scores given in (2.1). Assume that the
following holds.
ASSUMPTION 4.1—Two Continuous Instruments With Exclusion Restrictions:
1. The density of (V1  V2 ) is continuous on [0 1]2 , with marginal uniform distributions.
2. The instruments Z ≡ (Z1  Z2 ) consist of two scalar random variables whose joint distribution is absolutely continuous with respect to the Lebesgue measure on its support Z .
3. Q1 (Z) does not depend on Z2 , and it is continuously differentiable with respect to Z1 .
4. Q2 (Z) does not depend on Z1 , and it is continuously differentiable with respect to Z2 .
The first condition in Assumption 4.1 is just a normalization of the marginal distribution of each Vj ∈ V . The crucial part of Assumption 4.1 is in the exclusion restrictions:
Z1 affects Q1 but not Q2 , and Z2 affects Q2 but not Q1 . For example, if Q1 and Q2 represent minimum required grades on two parts of an exam, then Z1 should only affect the
requirement on the first part, and Z2 should only affect the second part.
6
It would also be possible to seek identification jointly from the generalized propensity scores and from
the cross-derivatives that appear in Theorems 3.1 or A.1, especially when they are over-identified. We do not
pursue this here.
7
See Heckman and Vytlacil (2007, Supplemental Material Appendix B) for an application to treatment
models.

1952

S. LEE AND B. SALANIÉ

THEOREM 4.1—Identification of Q1 and Q2 : Under Assumption 4.1,
(i) the function
P(Z) ≡ 2P0 (Z) + P1 (Z)
is additively separable in Z1 and Z2 on Z .
(ii) Q1 and Q2 are identified up to an additive constant. More precisely, take any (z10  z20 ) ∈
Z . Then




Q1 (z1 ) = P z1  z20 − P z10  z20 + C10 


Q2 (z2 ) = P z10  z2 − C10 
where the constant C10 must satisfy the restrictions Pr(D = k) > 0 for each k = 0 1 2.8
PROOF OF THEOREM 4.1: See Appendix B.2 of the Supplemental Material.

Q.E.D.

Suppose that the analyst has picked a point in the partially identified (Q1  Q2 ) set. Using
these Q1 and Q2 , since the indices are all nonzero (cJ0 = cJ1 = 1 and cJ2 = −2), we apply
Theorem 3.1 to identify the joint density by
fV1 V2 (q1  q2 ) =

1 ∂2 Pr D = k|Q1 (Z) = q1  Q2 (Z) = q2

∂q1 ∂q2
cJk

(4.1)

where k = 0 1 2.
Note that fV1 V2 (q1  q2 ) is over-identified; checking equality between the right-hand
sides of (4.1) for k = 0 1 2 provides a specification test.9 Similarly, we now apply Theorem 3.1 to the conditional expectations E(Yk |V1 = q1  V2 = q2 ); and as
E(Yk |V1 = q1  V2 = q2 ) =

∂2 E Y Dk |Q1 (Z) = q1  Q2 (Z) = q2 /∂q1 ∂q2
∂2 Pr D = k|Q1 (Z) = q1  Q2 (Z) = q2 /∂q1 ∂q2

for each k = 0 1 2, the identification of the marginal and average treatment effects follows immediately.
In practice, Q1 and Q2 are only identified up to the (restricted) additive constant C10
in Theorem 4.1(ii). As a consequence, fV1 V2 (q1  q2 ) and E(Yk |V1 = q1  V2 = q2 ) are only
identified up to the corresponding location shift in (q1  q2 ). However, it is easy to check
that (4.1) still yields a usable specification test.
4.2. The Double Hurdle Model
Let us now return to the double hurdle model of the Introduction, where treatment is
binary and the selection mechanism is governed by
D=1

iff

V1 < Q1 (Z) and

V2 < Q2 (Z)

(4.2)

and D = 0 otherwise.
8
9

The precise form of these restrictions in terms of C10 and P(Z1  Z2 ) is given in the proof of Theorem 4.1.
Since probabilities add up to 1, only one of these equalities generates a specification test.

IDENTIFYING EFFECTS OF MULTIVALUED TREATMENTS

1953

Both treatment values have nonzero indices: cJ1 = 1 and cJ0 = −1. But identification of
Q1 and Q2 , which is a premise of Theorem 3.1, is far from straightforward. In fact, this
case is more demanding than the selection model with two-way flows in Section 4.1 since
we only have two treatment values. We observe the propensity score


(4.3)
Pr(D = 1|Z) = FV1 V2 Q1 (Z) Q2 (Z) 
which we denote H(Z). This is a nonparametric double index model in which both the
link function FV1 V2 and the indices Q1 and Q2 are unknown; it is clearly under-identified
without stronger restrictions. Matzkin (1993, 2007) considered nonparametric identification and estimation of polychotomous choice models. Our multiple hurdle model has a
similar but not identical structure.
In order to identify Q, we assume that there exist two instruments that are excluded from one of the thresholds. More precisely, let the vector of instruments be
Z = (Z1  Z2  Z−12 ), with Z1 and Z2 scalar; we require that
• Q1 (Z) does not depend on Z2 , and
• Q2 (Z) does not depend on Z1 .
To simplify notation, we fix the value of Z−12 and we denote Q1 (Z) = G1 (Z1 ) and Q2 (Z) =
G2 (Z2 ), where G1 and G2 are two unknown functions. Note that the propensity score
becomes H(Z1  Z2 ) = FV1 V2 (G1 (Z1 ) G2 (Z2 )).
We give two identification results under these exclusion restrictions. We first build on
Lewbel (2000) and on Matzkin (1993, 2007)’s results to identify Q under full support
restrictions:
ASSUMPTION 4.2: Q1 = G1 (Z1 ) and Q2 = G2 (Z2 ). Moreover,
1. the density of (V1  V2 ) is continuous on [0 1]2 , with marginal uniform distributions,
2. G1 and G2 are strictly increasing C 1 functions from possibly unbounded intervals
(a1  b1 ) and (a2  b2 ) to (0 1); that is, for every t ∈ (0 1), there exist z1 ∈ (a1  b1 ) and
z2 ∈ (a2  b2 ) such that G1 (z1 ) = G2 (z2 ) = t,
3. Z is the rectangle (a1  b1 ) × (a2  b2 ).
THEOREM 4.2: Under Assumption 4.2, the functions FV , G1 , and G2 are identified from
the propensity score Pr(D = 1|Z).
PROOF: See Appendix B.3 of the Supplemental Material.

Q.E.D.

While Theorem 4.2 requires two continuous instruments that generate all possible values of the thresholds, various additional restrictions would relax this requirement. If, for
instance, G1 and G2 were linear, we would be back to the linear multiple index model of
Ichimura and Lee (1991).
Theorem 4.3 provides a complementary result and is useful when the instruments have
limited support. It relies on a semiparametric restriction. Remember that we normalized
the marginal distributions of V1 and V2 to be uniform over [0 1]; we now assume that
the codependence between V1 and V2 is described by a strict symmetric Archimedean
copula:10


FV1 V2 (v1  v2 ) = φ−1 φ(v1 ) + φ(v2 ) 
(4.4)
10
The class of Archimedean copulas includes the Clayton, Frank, and Gumbel families among others (see
Nelsen (2006, Chapter 4)).

1954

S. LEE AND B. SALANIÉ

where φ belongs to the set Ψ of C 2 , strictly decreasing, and convex functions from [0 1]
unto [0 +∞].
ASSUMPTION 4.3: Q1 = G1 (Z1 ) and Q2 = G2 (Z2 ). Moreover,
(a) the propensity score and the distribution of (V1  V2 ) are described by (4.3) and (4.4) for
unknown functions φ, G1 , and G2 ,
(b) the interior of the support Z of (Z1  Z2 ) contains a connected set N , and
(c) G1 and G2 are C 1 functions over the projections of N , with derivatives bounded away
from zero.
Let Hk (z1  z2 ) denote the derivative of the propensity score H(z1  z2 ) with respect to
its kth argument (k = 1 2) and H12 (z1  z2 ) the second-order cross-derivative of H(z1  z2 ).
Theorem 4.3 shows that φ is identified up to location and scale.
THEOREM 4.3: Let Assumption 4.3 hold. Then
1. over N , the ratio
H12
(z1  z2 )
H1 H2
is nonnegative and only depends on the value h = H(z1  z2 ).
2. the function φ is identified up to scale and location in Ψ on the image H(N ) = (h h̄) ⊂
(0 1) of N under H, where N is given in Assumption 4.3(b).
3. the scale parameter for φ is an arbitrary negative number, which we normalize by imposing φ (h̄) = −1; given this normalization, the location parameter for φ is bounded by
0 ≤ φ(h̄) ≤ 1 − h̄
If, moreover, supz∈N Pr(D = 1|Z = z) = 1, then h̄ = 1 and φ is point-identified.
4. for any admissible value of the location parameter of φ, the functions G1 and G2 are
identified on N up to a common constant k: any other admissible (G̃1  G̃2 ) must satisfy




φ G̃1 (z1 ) = φ G1 (z1 ) − k




φ G̃2 (z2 ) = φ G2 (z2 ) + k
over the projections of N . The number k is bounded above and below. If, moreover,
supz∈N Pr(D = 1|Z = z) = 1, then G1 and G2 are point-identified on the projections of N .
PROOF: See Appendix B.4 of the Supplemental Material.

Q.E.D.

In view of (4.4), the scale of φ is not identifiable. Furthermore, if φ is specified nonparametrically as an element of Ψ , the location of φ is only identifiable when the argument of
φ takes values close to 1.
Our constructive identification starts by writing
H12
φ
(h) = −
(z1  z2 )
φ
H1 H2

(4.5)

for all (z1  z2 ) such that H(z1  z2 ) = h. Once φ is identified from (4.5), then we proceed
to identify G1 and G2 . The function G1 , for instance, would be identified by


 

 
φ G1 (z1 ) = φ H z1  z20 − φ g20
for a fixed z20 and a value g20 of G2 (z20 ).

IDENTIFYING EFFECTS OF MULTIVALUED TREATMENTS

1955

Given more a priori restrictions on the function φ, identification results can be sharper.
The following example illustrates this point by taking a parametric family of φ.
EXAMPLE 4: Take the strict Clayton copula, which is generated by φ(u) = (u−θ − 1)/θ
for θ > 0. This yields

−1/θ
H(z1  z2 ) = G1 (z1 )−θ + G2 (z2 )−θ − 1

In this example, φφ (h) is simply −(1 + θ)/ h. Therefore, it follows from (4.5) that θ can
be identified in closed form as
θ=h

H12
(z1  z2 ) − 1
H1 H2

(4.6)

for all (h z1  z2 ) such that H(z1  z2 ) = h. Note that the scale and location of φ are pointidentified, given the parametric restriction.
Conversely, the constancy of the right-hand side of (4.6) characterizes a Clayton copula.
To identify G1 and G2 , note that
G1 (z1 )−θ + G2 (z2 )−θ = H(z1  z2 )−θ + 1
Thus, it is easy to see that G1 and G2 are identified up to a location constant.11
Once Q1 (Z) and Q2 (Z) are identified, then, under our assumptions, we identify the
joint density by
fV1 V2 (q1  q2 ) =

∂2 Pr D = 1|Q1 (Z) = q1  Q2 (Z) = q2

∂q1 ∂q2

(4.7)

and the marginal treatment effect is given by
E(Y1 − Y0 |V1 = q1  V2 = q2 )fV1 V2 (q1  q2 ) =

∂2 E Y |Q1 (Z) = q1  Q2 (Z) = q2

∂q1 ∂q2

(4.8)

Furthermore, it follows from Corollary 3.2 that under the additional Assumption 3.5, the
ATE, ATT, and PRTE parameters are identified as well.
4.3. Dynamic Treatment
To conclude our examples, let us consider a two-period model of dynamic treatment
where treatment assignment D2 in the second period depends on the first-period treatment D1 and outcome Y 1 :


 


D1 = 1 V1 < Q1 Z1
and D2 = 1 V2 < Q2 Z2  D1  Y 1 
The analyst observes (D1  D2  Y 1  Y 2  Z1  Z2 ). Theorem 3.1 applies to this model, provided only that the functions Q1 and Q2 are identified. The identification of Q1 is straightforward. To identify Q2 , we use the results of Shaikh and Vytlacil (2011), which considers a model similar to our second-period treatment assignment. While they stressed
11

This location constant plays the role of k in part 4 of Theorem 4.3.

1956

S. LEE AND B. SALANIÉ

partial identification, their Remark 2.2 (p. 954) gives a sufficient condition for pointidentification. Translated in our notation, this requires that
1. the support of (Z2  Q1 (Z1 )) is the product of the support of Z2 and the support of
Q1 (Z1 ), and that
2. for every value (z2  y 1 ) of (Z2  Y 1 ), there is a value z̄2 such that Q2 (z̄2  1 y 1 ) =
Q2 (z2  0 y 1 ); and there is a value z2 such that Q2 (z2  0 y 1 ) = Q2 (z2  1 y 1 ).
Assumption 1 above requires that the set of instruments in the second period has a component that does not affect treatment in the first period, and whose range of variation
does not depend on the propensity score of the first period. Assumption 2 adds the requirement that the ranges of the second-period propensity scores are independent of the
first-period treatment, for all values of the first-period outcome.
These assumptions require overlap between treatment branches. They would not hold,
for instance, in a medical trial when patients are oriented towards completely different
treatments depending on how they fare early on.
5. RELATION TO THE EXISTING LITERATURE
The existing literature is very large; we only discuss here the most directly relevant
papers.
5.1. Ordered Treatments With Discrete Instruments
Angrist and Imbens (1995) considered two-stage least-squares (TSLS) estimation of a
model in which the ordered treatment takes a finite number of values, and a discretevalued instrument is available. They showed that the TSLS estimator obtained by regressing outcome Y on a preestimated E(D|Z) converges to a weighted sum of average causal
responses under some monotonicity assumption. Heckman, Urzua, and Vytlacil (2006,
2008) went beyond Angrist and Imbens (1995) by showing how the TSLS estimate can
be reinterpreted in more transparent ways in the MTE framework. They also analyzed a
family of discrete choice models, to which we now turn.
5.2. Discrete Choice Models
Heckman, Urzua, and Vytlacil (2008, see also Heckman and Vytlacil (2007)) considered
a multinomial discrete choice model of treatment. They posited
D=k

⇐⇒

Rk (Z) − Uk > Rl (Z) − Ul

for l = 0     K − 1 such that l = k

(5.1)

where the U’s are continuously distributed and independent of Z. Then they studied the
identification of marginal and local average treatment effects under assumptions that are
similar to ours: continuous instruments that generate enough dimensions of variation in
the thresholds.
As they noted, the discrete choice model with an additive structure implicitly imposes
monotonicity, in the following form: if the instruments Z change in a way that increases
Rk (Z) relative to all other Rl (Z), then no observation with treatment value k is assigned
to a different treatment. We make no such assumption, as Example 1 and Figure 1 illustrate. Our results extend those of Heckman, Urzua, and Vytlacil (2008) to any model with

IDENTIFYING EFFECTS OF MULTIVALUED TREATMENTS

1957

identified thresholds.12 We consider a discrete choice model with three alternatives as an
example.
EXAMPLE 5—Discrete Choice Model With Three Alternatives: Suppose that K =
{0 1 2} with K = 3. Let R̃01 (Z) = R0 (Z) − R1 (Z), R̃02 (Z) = R0 (Z) − R2 (Z), and
R̃12 (Z) = R1 (Z) − R2 (Z). Similarly, let Ũ01 = U0 − U1 , Ũ02 = U0 − U2 , and Ũ12 = U1 − U2 .
Let V01 = FŨ01 (Ũ01 ) and Q01 (Z) = FŨ01 (R̃01 (Z)). Define V02 , V12 , Q02 (Z), and Q12 (Z)
similarly. Then the selection mechanism in (5.1) can be rewritten as
• D = 0 iff V01 < Q01 (Z) and V02 < Q02 (Z),
• D = 1 iff V01 > Q01 (Z) and V12 < Q12 (Z),
• D = 2 iff V02 > Q02 (Z) and V12 > Q12 (Z).
Our general result in Section 3 applies immediately once the Qjk ’s are identified. This
can be done, for example, by applying the results of Matzkin (1993, 2007).
There is a growing empirical literature on multivalued unordered treatments. Dahl
(2002) developed a semiparametric Roy model for migration across U.S. states. In his
empirical work, the number of unordered treatments is 51 (50 states plus the District of
Columbia) and he controlled for selection bias by conditioning on migration probabilities. Kirkeboen, Leuven, and Mogstad (2016) used discrete instruments to obtain TSLS
estimates of returns to different fields of study in postsecondary education in Norway.
In their setup, the unordered treatments are different fields of study. Kline and Walters
(2016) used data from the Head Start Impact Study to estimate a semiparametric selection model. Their model has three treatment cells: Head Start, competing preschool
programs, and no preschool (i.e., home care).
Broadly speaking, these papers are in the same vein as Roy models and discrete choice
models. Our approach complements this literature by focusing on the role of unobserved
heterogeneity and the selection mechanism.
5.3. Unordered Monotonicity
In an important recent paper, Heckman and Pinto (2018) introduced a new concept
of monotonicity. Their “unordered monotonicity” assumption can be rephrased in our
notation in the following way. Take two values z and z of the instruments Z and any
treatment value k.
ASSUMPTION 5.1—Unordered Monotonicity: Denote dk (v z) and dk (v z ) the counterfactual values of the variable dk = 1(D = k) for an observation with unobserved heterogeneity v. Then


dk (v z) ≥ dk v z
∀v;


∀v
or: dk (v z) ≤ dk v z
Unordered monotonicity for treatment value k requires that when instruments change
value from z to z , if some observations move out of (resp. into) treatment value k, then
12
Appendix D of the Supplemental Material compares our results with those of Heckman, Urzua, and Vytlacil (2008) in more detail.

1958

S. LEE AND B. SALANIÉ

no observation can move into (resp. out of) treatment value k. For binary treatments, unordered monotonicity is equivalent to the usual monotonicity assumption: there cannot
be both compliers and defiers. When K > 2, it is weaker than ordered choice. For example, suppose that there are three options {0 1 2} and that a change of instruments makes
option 1 less appealing. Under ordered choice, all agents who give up option 1 must fall
back on option 0, or all must fall back on option 2. Unordered monotonicity allows different agents to fall back on different options. It still rules out two-way flows, that is, agents
moving from option 0 or 2 into option 1.
Heckman and Pinto (2018) showed that unordered monotonicity (for well-chosen
changes in instruments) is essentially equivalent to a treatment model based on rules that
are additively separable in the unobserved variables—that is, the model of Section 5.2. In
this interpretation, changes in instruments that increase the mean utility of an alternative
relative to all others are unordered monotonic for that alternative, for instance. We refer
the reader to Section 6 of Heckman and Pinto (2018) for a more rigorous discussion, and
to Pinto (2015) for an application to the Moving to Opportunity program.
Unlike us, Heckman and Pinto (2018) did not require continuous instruments; all of
their analysis is framed in terms of discrete-valued instruments and treatments. Beyond
this (important) difference, unordered monotonicity clearly obeys our assumptions. On
the other hand, we allow for much more general models of treatment. It would be impossible, for instance, to rewrite our Examples 1, 2, and 3 so that they obey unordered
monotonicity. We illustrate this point using Example 1 below.
EXAMPLE 1—Continued: In Example 1, D = 2 iff (V1 − Q1 (Z)) and (V2 − Q2 (Z)) have
opposite signs. Note that there are two unobserved categories within D = 2:
D = 2a iff

V1 < Q1

and V2 > Q2 

D = 2b iff

V1 > Q1

and V2 < Q2 

Each one is unordered monotonic; but because we only observe their union, D = 2 is not
unordered monotonic—increasing Q1 brings more people into 2a but moves some out
of 2b, so that in the end we have two-way flows, contradicting unordered monotonicity.
To put it differently, the selection mechanism in Example 1 becomes a discrete choice
model when each of four alternatives d = 0 1 2a 2b is observed; however, we only observe whether alternative d = 0, d = 1, or d = 2 is chosen in Example 1. This amounts to
an unordered monotonic treatment that is observed through a coarser information partition; this coarsening destroys unordered monotonicity.
Appendix A.2 provides a characterization of Heckman and Pinto’s unordered monotonicity property as a subcase of our more general framework.
5.4. Other Non-Monotonic Models
It is also worth commenting on other papers that break monotonicity. Gautier and
Hoderlein (2015) considered a triangular random coefficients model for the binary treatment case. Their model is motivated by a single-agent Roy model with random coefficients. Its selection mechanism is governed by
D = 1 V1 − Z1 − g(Z1      ZL ) −

J

j=2

Vj fj (Zj ) > 0 

IDENTIFYING EFFECTS OF MULTIVALUED TREATMENTS

1959

where V = (V1      VJ ) is a vector of unobserved random variables, Z = (Z1      ZJ ) is
a vector of instruments that are independent of (Y0  Y1  V ), and the functions f2      fJ
and g are unknown. If we limit our attention to the case of two unobservables, then the
selection equation in Gautier and Hoderlein (2015) reduces to


D = 1 V1 − Z1 − g(Z1  Z2 ) − V2 f2 (Z2 ) > 0 
Here, changes in Z1 conform to monotonicity; but changes in Z2 need not.
Lewbel and Yang (2016) considered a different non-monotonic selection mechanism
for estimating the average treatment effect. They showed that the average treatment effect is identified when a binary treatment is assigned by
D = 1(α0 ≤ Z + V ≤ α1 )
where V is an unobserved random variable; Z is a continuous variable that satisfies
⊥ Z; and α0 , α1 are unknown parameters.
E(Yj |V  Z) = E(Yj |V ) for j = 0 1 and V ⊥
5.5. Models With Continuous Treatment
Chesher (2003) developed conditions to identify derivatives of structural functions in
nonseparable models from functionals of quantile regression functions. In addition, Florens et al. (2008) considered a potential outcome model with a continuous treatment.
They assumed a stochastic polynomial restriction and showed that the average treatment
effect can be identified if a suitable control function can be constructed using instruments.
Imbens and Newey (2009) also considered selection on unobservables with a continuous treatment. They assumed that the treatment (more generally in their paper, an endogenous variable) is given by D = g(Z V ), with g increasing in a scalar unobserved V .
They identified the average structural function as well as quantile, average, and policy effects. Other more recent identification results along this line can be found in Torgovitsky
(2015) and D’Haultfœuille and Février (2015) among others. One key restriction in this
group of papers is the monotonicity in the scalar V in the selection equation. We do not
rely on this type of restriction, but we only focus on the case of multivalued treatments.
Hence, our approach and those of the papers cited in this subsection are complementary.
Finally, our approach shares some features with Hoderlein and Mammen (2007). They
considered the identification of marginal effects in nonseparable models without monotonicity. They showed how local average structural derivatives can be identified. Like ours,
their approach relies on differentiation of observed functionals. The parameters of interest they studied are quite different, however, and their selection mechanism is not as
explicit as ours.
6. PROOF OF THEOREM 3.1
Our proof has three steps. We first write conditional moments as integrals with respect
to indicator functions. Then we show that these integrals are differentiable and we compute their multidimensional derivatives. Finally, we impose Assumption 3.1 and we derive
the equalities in the theorem.
Step 1: Under the assumptions imposed in the theorem, for any q in the range of Q,
E G(Y )Dk |Q(Z) = q
= E G(Yk )|D = k Q(Z) = q Pr(D = k|Q(Z) = q)

1960

S. LEE AND B. SALANIÉ



= E G(Yk )|dk (V  Q(Z)) = 1 Q(Z) = q Pr dk (V  Q(Z)) = 1|Q(Z) = q


= E G(Yk )|dk (V  q) = 1 Pr dk (V  q) = 1


= E G(Yk )1 dk (V  q) = 1

 

= E E G(Yk )1 dk (V  q) = 1 |V



= E E G(Yk )|V 1 dk (V  q) = 1 
where the third equality follows from Assumption 2.2 and the others are obvious. As a
consequence,
E G(Y )Dk |Q(Z) = q


1 dk (v q) = 1 E G(Yk )|V = v fV (v) dv

=

(6.1)

Let bk (v) ≡ E[G(Yk )|V = v]fV (v) and Bk (q) = E[G(Y )Dk |Q(Z) = q]. Then (6.1)
takes the form


Bk (q) = 1 dk (v q) = 1 bk (v) dv
Now recall from Lemma 2.1 that the indicator function of D = k is a multivariate polynomial of the indicator functions Sj for j ∈ J . Moreover,
Sj (V  Q(Z)) = 1(Vj < Qj (Z)) = H(Qj (Z) − Vj )
where H(t) = 1(t > 0) is the one-dimensional Heaviside function. Therefore, we can
rewrite the selection of treatment k as
  k

cl
H(qj − vj )
(6.2)
1 dk (v q) = 1 =
l∈L

j∈l

and it follows that
Bk (q) =



c

k
l



l∈L


H(qj − vj ) bk (v) dv

(6.3)

j∈l

Step 2: By Assumption 3.3, the function b is locally equicontinuous; and by Assumption 3.4, it is defined over an open neighborhood of q. This implies that all terms in (6.3)
are differentiable along all dimensions of q. To see this, start with dimension j = 1. Any
term l in (6.3) that does not contain 1 is constant in q1 and obviously differentiable. Take
any other term and rewrite it as
Al (q1 ) ≡ c

q1

k
l
0

 


H(qj − vj ) bk (v1  v−1 ) dv−1 dv1 

j∈l−{1}

where v−1 collects all directions of v in l − {1}.

IDENTIFYING EFFECTS OF MULTIVALUED TREATMENTS

Then, for any ε = 0,

 

Al (q1 + ε) − Al (q1 )
− clk
ε
ck
= l
ε

q1 +ε
q1

 

1961


H(qj − vj ) bk (q1  v−1 ) dv−1

j∈l−{1}



H(qj − vj )




bk (v1  v−1 ) − bk (q1  v−1 ) dv−1 dv1 

j∈l−{1}

Since the functions (bk (· v−1 )) are locally equicontinuous at q1 , for any η > 0 we can
choose ε such that if |q1 − v1 | < ε,


bk (q1  v−1 ) − bk (v1  v−1 ) < η;
and since the Heaviside functions are bounded above by 1, we have


 

  
 Al (q1 + ε) − Al (q1 )
k

− cl
H(qj − vj ) bk (q1  v−1 ) dv−1  < clk η

ε
j∈l−{1}
This proves that Al is differentiable in q1 and that its derivative with respect to q1 , which
we denote A1l , is

H(qj − vj )bk (q1  v−1 ) dv−1 
A1l = cl
j∈l−{1}

But this derivative itself has the same form as Al . Letting v−12 collect all components
of v except (q1  q2 ), the same argument would prove that since the functions (bk (· v−12 ))
are locally equicontinuous at (q1  q2 ), the function A1l is differentiable with respect to q2
and its derivative is
 

k
H(qj − vj ) bk (q1  q2  v−12 ) dv−12 
cl
j∈l−{12}

Continuing this argument finally gives us the cross-derivative with respect to (ql ) as


bk ql  v−l dv−l 

clk

where v−l collects all components of v whose indices are not in l.
3: Lemma 2.1 and Assumption 3.1 also imply that the leading term in the sum
Step
l
l cl
j∈l H(qj − vj ) is
cJk

J


H(qj − vj )

j=1

as cJk = 0 under Assumption 3.1; all other terms have a smaller number of indices j.
Now take the J-order derivative of B(q) with respect to all qj in turn. By Lemma 2.1,
the highest-degree term of B in q is
 J


H(qj − vj ) bk (v) dv
cJk
j=1

1962

S. LEE AND B. SALANIÉ

This term contributes a cross-derivative
cJk bk (q)
and all other terms generate zero-value contributions since each of them is constant in at
least one of the directions j.
More formally,
∂J Bk (q)
T Bk (q) = 
= cJk bk (q)
∂qj

(6.4)

j∈J

Given Assumptions 3.3 and 3.4, we can apply (6.4) successively to the pair of functions
Bk (q) = E G(Y )Dk |Q(Z) = q

and

bk (v) = E G(Yk )|V = v fV (v)

as in (6.3), and to the pair of functions
Bk (q) = Pr[D = k|Q(Z) = q]

with bk (v) = fV (v)

The first pair gives us the second equality in the theorem, and the second pair gives us the
first equality.
REFERENCES
ANGRIST, J. D., AND G. W. IMBENS (1995): “Two-Stage Least Squares Estimation of Average Causal Effects
in Models With Variable Treatment Intensity,” Journal of the American Statistical Association, 90 (430), 431–
442.[1939,1956]
BRINCH, C. N., M. MOGSTAD, AND M. WISWALL (2017): “Beyond LATE With a Discrete Instrument,” Journal
of Political Economy, 125 (4), 985–1039.[1950]
CATTANEO, M. D. (2010): “Efficient Semiparametric Estimation of Multi-Valued Treatment Effects Under
Ignorability,” Journal of Econometrics, 155 (2), 138–154.[1941]
CHESHER, A. (2003): “Identification in Nonseparable Models,” Econometrica, 71 (5), 1405–1441.[1941,1959]
DAHL, G. B. (2002): “Mobility and the Return to Education: Testing a Roy Model With Multiple Markets,”
Econometrica, 70 (6), 2367–2420.[1957]
DE CHAISEMARTIN, C. (2017): “Tolerating Defiance? Local Average Treatment Effects Without Monotonicity,” Quantitative Economics, 8 (2), 367–396.[1940]
D’HAULTFŒUILLE, X., AND P. FÉVRIER (2015): “Identification of Nonseparable Triangular Models With Discrete Instruments,” Econometrica, 83 (3), 1199–1210.[1941,1959]
FLORENS, J. P., J. J. HECKMAN, C. MEGHIR, AND E. VYTLACIL (2008): “Identification of Treatment Effects
Using Control Functions in Models With Continuous, Endogenous Treatment and Heterogeneous Effects,”
Econometrica, 76 (5), 1191–1206.[1941,1959]
GAUTIER, E., AND S. HODERLEIN (2015): “A Triangular Treatment Effect Model With Random Coefficients
in the Selection Equation,” http://arxiv.org/abs/1109.0362v4. [1941,1958,1959]
HECKMAN, J., AND R. PINTO (2018): “Unordered Monotonicity,” Econometrica, 86 (1), 1–35.[1939-1941,1944,
1957,1958]
HECKMAN, J. J. (1979): “Sample Selection Bias as a Specification Error,” Econometrica, 47 (1), 153–161.[1939]
HECKMAN, J. J., AND E. VYTLACIL (2000): “Local Instrumental Variables,” Technical Working Paper No. 252,
National Bureau of Economic Research. [1950]
(2001): “Policy-Relevant Treatment Effects,” American Economic Review, 91 (2), 107–111.[1949]
(2005): “Structural Equations, Treatment Effects, and Econometric Policy Evaluation,” Econometrica, 73 (3), 669–738.[1939,1941,1949]
(2007): “Econometric Evaluation of Social Programs, Part I: Causal Models, Structural Models and
Econometric Policy Evaluation,” in Handbook of Econometrics, Vol. 6B, ed. by J. J. Heckman and E. Leamer.
Amsterdam: Elsevier, 4779–4874, Chapter 70. [1941,1951,1956]
HECKMAN, J. J., S. URZUA, AND E. VYTLACIL (2006): “Understanding Instrumental Variables in Models With
Essential Heterogeneity,” Review of Economics and Statistics, 88 (3), 389–432.[1939,1956]

IDENTIFYING EFFECTS OF MULTIVALUED TREATMENTS

1963

(2008): “Instrumental Variables in Models With Multiple Outcomes: The General Unordered Case,”
Annales d’économie et de statistique, 91/92, 151–174.[1939,1941,1956,1957]
HIRANO, K., AND G. W. IMBENS (2004): “The Propensity Score With Continuous Treatments,” in Applied
Bayesian Modeling and Causal Inference From Incomplete-Data Perspectives, ed. by A. Gelman and X. Meng.
Wiley-Blackwell, 73–84.[1941]
HODERLEIN, S., AND E. MAMMEN (2007): “Identification of Marginal Effects in Nonseparable Models Without Monotonicity,” Econometrica, 75 (5), 1513–1518.[1941,1959]
ICHIMURA, H., AND L.-F. LEE (1991): “Semiparametric Least Squares Estimation of Multiple Index Models:
Single Equation Estimation,” in International Symposia in Economic Theory and Econometrics, ed. by W. A.
Barnett, J. Powell, and G. Tauchen. Cambridge University Press, 3–49.[1951,1953]
IMBENS, G. W. (2000): “The Role of the Propensity Score in Estimating Dose–Response Functions,”
Biometrika, 87 (3), 706–710.[1941]
IMBENS, G. W., AND J. D. ANGRIST (1994): “Identification and Estimation of Local Average Treatment Effects,” Econometrica, 62 (2), 467–475.[1939]
IMBENS, G. W., AND W. K. NEWEY (2009): “Identification and Estimation of Triangular Simultaneous Equations Models Without Additivity,” Econometrica, 77 (5), 1481–1512.[1941,1959]
KIRKEBOEN, L. J., E. LEUVEN, AND M. MOGSTAD (2016): “Field of Study, Earnings, and Self-Selection,”
Quarterly Journal of Economics, 131 (3), 1057–1111.[1957]
KLINE, P., AND C. R. WALTERS (2016): “Evaluating Public Programs With Close Substitutes: The Case of Head
Start,” Quarterly Journal of Economics, 131 (4), 1795–1848.[1957]
KOWALSKI, A. E. (2016): “Doing More When You’re Running LATE: Applying Marginal Treatment Effect
Methods to Examine Treatment Effect Heterogeneity in Experiments,” Working Paper No. 22363, National
Bureau of Economic Research. [1950]
LEE, S., AND B. SALANIÉ (2018): “Supplement to ‘Identifying Effects of Multivalued Treatments’,” Econometrica Supplemental Material, 86, https://doi.org/10.3982/ECTA14269. [1941]
LEWBEL, A. (2000): “Semiparametric Qualitative Response Model Estimation With Unknown Heteroscedasticity or Instrumental Variables,” Journal of Econometrics, 97 (1), 145–177.[1953]
LEWBEL, A., AND T. T. YANG (2016): “Identifying the Average Treatment Effect in Ordered Treatment Models
Without Unconfoundedness,” Journal of Econometrics, 195(1), 1–22.[1941,1959]
MANSKI, C. F. (1990): “Nonparametric Bounds on Treatment Effects,” American Economic Review, 80, 319–
323.[1941,1950]
(1997): “Monotone Treatment Response,” Econometrica, 65, 1311–1334.[1941]
MANSKI, C. F., AND J. V. PEPPER (2000): “Monotone Instrumental Variables: With an Application to the
Returns to Schooling,” Econometrica, 68 (4), 997–1010.[1941]
MATZKIN, R. L. (1993): “Nonparametric Identification and Estimation of Polychotomous Choice Models,”
Journal of Econometrics, 58 (1), 137–168.[1951,1953,1957]
(2007): “Heterogeneous Choice,” in Advances in Economics and Econometrics: Theory and Applications, Vol. 2, ed. by R. Blundell, W. Newey, and T. Persson. Cambridge University Press, 75–110, Chapter 4. [1951,1953,1957]
MOGSTAD, M., A. SANTOS, AND A. TORGOVITSKY (2017): “Using Instrumental Variables for Inference About
Policy Relevant Treatment Effects,” NBER Working Paper No. 23568. [1950]
NELSEN, R. B. (2006): An Introduction to Copulas (Second Ed.). New York, NY: Springer.[1953]
PINTO, R. (2015): “Selection Bias in a Controlled Experiment: The Case of Moving to Opportunity,” Report,
University of Chicago. [1941,1958]
POIRIER, D. J. (1980): “Partial Observability in Bivariate Probit Models,” Journal of Econometrics, 12 (2),
209–217.[1940]
SHAIKH, A., AND E. VYTLACIL (2011): “Partial Identification in Triangular Systems of Equations With Binary
Dependent Variables,” Econometrica, 79, 949–955.[1955]
TAMER, E. (2003): “Incomplete Simultaneous Discrete Response Model With Multiple Equilibria,” Review of
Economic Studies, 70 (1), 147–165.[1945]
TORGOVITSKY, A. (2015): “Identification of Nonseparable Models Using Instruments With Small Support,”
Econometrica, 83 (3), 1185–1197.[1941,1959]
VYTLACIL, E. (2002): “Independence, Monotonicity, and Latent Index Models: An Equivalence Result,”
Econometrica, 70 (1), 331–341.[1939]
YANG, S., G. W. IMBENS, Z. CUI, D. E. FARIES, AND Z. KADZIOLA (2016): “Propensity Score Matching
and Subclassification in Observational Studies With Multi-Level Treatments,” Biometrics, 72 (4), 1055–
1065.[1941]
Co-editor Elie Tamer handled this manuscript.
Manuscript received 25 March, 2016; final version accepted 29 May, 2018; available online 22 June, 2018.

