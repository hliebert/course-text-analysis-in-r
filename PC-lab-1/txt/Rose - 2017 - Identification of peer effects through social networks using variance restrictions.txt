Econometrics Journal (2017), volume 20, pp. S47–S60.
doi: 10.1111/ectj.12101

C HRISTIERN D. R OSE †
†

University of Queensland School of Economics, Level 6 Colin Clark Building (39), University
of Queensland, St Lucia, Brisbane, Australia, 4072.
E-mail: christiern.rose@uq.edu.au
First version received: April 2017; final version accepted: July 2017
Summary This paper presents a novel method to identify peer effects through exploiting
fluctuations in the variances and covariances of outcomes over a social network. Endogenous
and contextual peer effects can be disentangled by contrasting the covariances of the outcomes
of peers with the covariances of the outcomes of peers of peers. Correlated effects are
incorporated by allowing for unrestricted network level heterogeneity. The method is applied
to the Project STAR data to study peer effects in academic attainment of first-year kindergarten
students. Evidence is found of positive peer effects, which are statistically significant and
consistent with the existing literature.
Keywords: Covariance models, Identification, Peer effects, Project STAR, Social networks.

1. INTRODUCTION
This paper presents a novel method to identify peer effects through exploiting fluctuations in
the variance and covariance of the outcomes over a social network. Two types of peer effects
are considered: endogenous effects arise through interdependence of peer outcomes, whereas
contextual effects arise through dependence of outcomes on the characteristics of peers. For
example, in a given classroom, a student’s attainment might depend on the attainment and ability
of their peers. The latter is not observed by the researcher.
Endogenous effects propagate through the peer network and determine the attainment of both
direct peers and peers of peers, whilst contextual effects determine only the attainment of direct
peers. Consequently, the two effects can be disentangled by contrasting the covariances of the
attainment of peers with the covariances of the attainment of peers of peers. Depending on the
structure of the network, this might lead to point identification under the restriction that students’
abilities ( ci in the model to be introduced in Section 2) are homoscedastic and uncorrelated with
one another.
Identification of peer effects can be confounded by correlated effects, through which
attainments are correlated due to exposure to a common environment. For example, students
in the same classroom share the same teacher and learning resources. The method in this paper
allows for unrestricted classroom heterogeneity (αc in the model to be introduced in Section 2). In
particular, it can be arbitrarily correlated with ability and with the peer network. This allows for

C

2017 Royal Economic Society. Published by John Wiley & Sons Ltd, 9600 Garsington Road, Oxford OX4 2DQ, UK and 350 Main
Street, Malden, MA, 02148, USA.

Downloaded from https://academic.oup.com/ectj/article-abstract/20/3/S47/5056390 by Vrije Universiteit Amsterdam user on 21 February 2019

Identification of peer effects through social networks
using variance restrictions

S48

C. D. Rose

1 However, it does not allow for the peer network in a given classroom to depend on the students’ abilities or on their
attainment.
2 Strict exogeneity in observable characteristics requires that the observable characteristics of student i be uncorrelated
with the ability of student j for all i and j in the same classroom.


C

2017 Royal Economic Society.

Downloaded from https://academic.oup.com/ectj/article-abstract/20/3/S47/5056390 by Vrije Universiteit Amsterdam user on 21 February 2019

selection of students into classrooms.1 Moreover, the mean and variance of ability is permitted
to be classroom specific.
This paper’s approach does not rely on strictly exogenous variation in students’ observable
characteristics, as considered by Manski (1993), Moffitt (2001), Lee (2007), Davezies et al.
(2009), Bramoullé et al. (2009) and Blume et al. (2015), among others.2 These methods do
not require any assumptions on ability variance/covariance, but the methods can only be applied
if the researcher observes at least one student characteristic that is uncorrelated with the abilities
of all of the students in the classroom, and that has a strong reduced-form effect on attainment.
Settings in which the aforementioned conditions are violated have motivated approaches
based on second moments, such as Graham (2008). Unlike Graham (2008), however, this paper’s
approach does not require assumptions on classroom heterogeneity, such as homoscedasticity
and zero covariance with ability, nor does it depend on the absence of endogenous effects (β = 0
in Section 2). These restrictions can be difficult to justify, particularly if there is selection of
students into classrooms or if endogenous effects are the primary object of interest. Instead, this
paper exploits variation in the peer network for identification.
The method is applied to data on Stanford Achievement Test (SAT) scores in mathematics
for 6,172 first-year kindergarten students in 317 classes over 79 Tennessee schools at the end
of the 1986–1987 academic year. The data were collected as part of Project STAR, which was
designed to test the impact of class size on attainment. Students were randomly assigned to one
of three class types: small, regular, or regular with a classroom assistant. This process generated
variation in class sizes, which can be exploited to identify peer effects (Graham, 2008).
Students were randomly allocated to class types, rather than classrooms, and hence there
might have been selection into classrooms based on ability. The specification allows for selection
through leaving classroom heterogeneity unrestricted. Endogenous peer effects are found to be
large and statistically significant for some specifications of the network, whereas contextual
effects are close to zero and not statistically significant. The remainder of this section locates
this paper in the literature.
Manski (1993) studies a linear-in-means interaction structure in which attainment depends
on the mean observed exogenous characteristics and attainment of the classroom, and describes
a ‘reflection problem’, through which the linear-in-means setting precludes identification due to
perfect multicollinearity. Lee (2007) and Davezies et al. (2009) study a modification of linear-inmeans such that attainment depends on the mean attainment and exogenous characteristics of the
other students in the classroom, showing that peer effects are identified if there are sufficiently
many class sizes.
Linear-in-means based interaction structures correspond to a complete network in which
attainment depends equally on the attainments/characteristics of all classmates. Bramoullé et al.
(2009) consider general structures of interaction, allowing for both complete and incomplete
networks. Specifically, if G is the interaction matrix of the network with rows summing to one
(as defined in Section 2), identification is obtained if the matrices I, G, G 2 and G 3 are linearly
independent and the endogenous and contextual peer effects do not exactly offset one another in
the reduced form.

Identification of peer effects through social networks using variance restrictions

S49

3 For example, endogenous effects are more salient than contextual effects in applications such as risky behaviours,
where the researcher is primarily interested in the propagation of behaviour through social influence.


C

2017 Royal Economic Society.

Downloaded from https://academic.oup.com/ectj/article-abstract/20/3/S47/5056390 by Vrije Universiteit Amsterdam user on 21 February 2019

Glaeser et al. (1996) point out that peer effects in criminal activity might explain excess
variance in crime rates over time and space, but do not establish conditions under which this can
be used to point identify peer effects. Following Glaeser et al. (1996), a series of papers explore
identification by using restrictions on both first and second moments. Sacerdote (2000) exploits
random assignment of college roommates. The identification approach relies on exogenous
variation in students’ high-school attainment, which must have a non-zero reduced-form effect
on college attainment. To identify the peer effects, Sacerdote (2000) exploits zero covariance
between roommates’ abilities, which results from random allocation. A similar approach is
adopted by Moffitt (2001).
Davezies et al. (2009) extend Lee (2007), showing that peer effects are identified if there
is sufficient variation in class sizes and that ability is uncorrelated between students. De Paula
(2016) shows that zero covariance of abilities is sufficient for identification in the setting of
Lee (2007) in the absence of classroom heterogeneity. Blume et al. (2015) study the use of
restrictions on second moments in a context in which contextual effects arise only through
observable exogenous characteristics (i.e. not through ability) and the researcher observes the
mean attainment and exogenous characteristics for each classroom. It is shown that peer effects
are identified if there is at least one strictly exogenous characteristic that determines attainment,
and abilities are independent of one another.
The most closely related paper is Graham (2008), which also adopts an approach based on
second moments and studies the linear-in-means interaction structure of Manski (1993) with
contextual and correlated effects. In a setting with two observed class types, small and large,
Graham (2008) shows that restrictions on the conditional variance of ability and classroom
heterogeneity identify the magnitude of contextual effects, but not the sign. The conditional
variance restrictions hold if students and teachers are randomly allocated to classrooms (such that
abilities are uncorrelated with one another and with classroom heterogeneity), the distributions
of classroom heterogeneity for small and large classes are equal up to a location shift (classroom
heterogeneity is homoscedastic), and the variance of ability differs for small and large classes.
The method is applied to the Project STAR data, finding evidence of peer effects in reading and
mathematics among first-year kindergarten students.
To date, the literature based on exploiting second moments for identification has focused on
linear-in-means interaction structures, which correspond to complete networks. As observed by
Bramoullé et al. (2009), social networks are rarely complete. Motivated by this observation, this
paper contributes to the literature by exploiting the structure of social networks for identification.
The identification results in Section 3 demonstrate that interaction structures other than linearin-means can lead to point identification under milder assumptions than those of Graham (2008).
In particular, no restrictions are placed on classroom heterogeneity, which can be heteroscedastic
and arbitrarily correlated with ability. Moreover, ability might have classroom-specific mean and
variance. This paper also contributes by allowing for both endogenous and contextual effects,
and by identifying both the sign and magnitude of the effects. This is important, as the sign of
the effect is usually of primary empirical interest, and endogenous effects are often more salient
than contextual effects.3
The remainder of the paper is structured as follows. Section 2 presents the model. Section 3
studies identification and Section 4 proposes an estimator. Section 5 applies the method to the
Project STAR data. Section 6 concludes. All proofs are gathered in the Appendix.

S50

C. D. Rose

2. MODEL

yci = αc + β

nc

j =1

G cij ycj + δ

nc


G cij  cj +  ci ,

(2.1)

j =1

where αc is unobserved classroom heterogeneity such as teacher quality, and  ci can be
interpreted as ability, which is not observed by the researcher. The linear form in (2.1) can
be derived from the best response function of an incomplete information game of individual
choice under social influences (Blume et al., 2015). Stacking (2.1) yields the more compact
representation,
yc = αc ιnc + β G c yc + (I nc + δG c ) c ,

(2.2)

where I nc is the nc -dimensional identity. Equation (2.2) captures two peer effects: endogenous
effects, parametrized by β, and contextual effects, parametrized by δ. Thus, each student’s
attainment depends on both the attainment and ability of their peers. The specification also
permits correlated effects, captured by αc . This allows attainments to be correlated through
exposure to the same classroom environment, as well as for selection of students into classrooms.
Following Bramoullé et al. (2009), it is assumed that β ∈ (−1, 1), which implies that I nc − β G
is invertible, and hence that yc is uniquely determined by αc , G c and  c .
The specification in (2.2) extends that of Graham (2008) in a number of dimensions. First, it
allows for both endogenous and contextual effects, whereas Graham (2008) considers the case in
which β = 0. Second, the correlated effect αc is completely unrestricted, whereas Graham (2008)
makes a number of restrictions including V [αc ] = σα2 and E[αc  c ] = 0. Finally, (2.2) allows for
an arbitrary (row normalized) interaction matrix G c , whereas Graham (2008) restricts attention

to the linear-in-means structure in which G c = n−1
c ιnc ιnc . This is crucial, as it is variation in the
network structure that permits separation of the peer effects from one another and the correlated
effect.
Identically to Bramoullé et al. (2009), the specification is applicable to two types of
observations: one in which the interaction matrix is treated as fixed, and another in which it
is stochastic. In the former, it is supposed that G c = G ∀c = 1, . . . , C and E[ c ] = 0. In the
latter, the interaction matrix is assumed to be strictly exogenous, such that E[ c |G c ] = 0. This
rules out correlation of ties with both ability and attainment. Thus, whilst the model allows
students to be selected into classrooms, it does not allow the structure of interactions within a
4 In applied work, the diagonal elements of G are typically equal to zero and the off-diagonal elements are nonc
negative, though this is not necessary for any of the results in this paper.


C

2017 Royal Economic Society.

Downloaded from https://academic.oup.com/ectj/article-abstract/20/3/S47/5056390 by Vrije Universiteit Amsterdam user on 21 February 2019

The network representing classroom c comprises nc students and is summarized by the nc × nc
interaction matrix G c . For example, the interaction matrix might represent student friendships
or a seating plan, or it might depict the classroom as a group in which each student is equally
tied to each other student. Element G cij is non-zero if j is a peer of i and zero otherwise.4
The magnitude of G cij gives the strength of the tie. It is assumed throughout that G c is row
normalized, such that G c ιnc = ιnc and ιnc is the nc × 1 vector of ones. This implies that peer
effects operate through a weighted sum over peers, with weights summing to one.
The researcher observes an independent and identically distributed (i.i.d.) sample
( yc , G c )c=1,...,C from a population of classrooms, where yc = ( yc1 , . . . , ycnc ) is an nc × 1 vector
measuring attainment. The attainment for student i in classroom c is determined by

Identification of peer effects through social networks using variance restrictions

S51

3. IDENTIFICATION
The identification problem is to separate the two peer effects from one another and the correlated
effect. This is challenging because each of the channels leads to correlation in attainments
(Manski, 1993). The crucial assumption on which all of the identification results depend is
V [ c ] = σ 2 I,

(3.1)

for σ 2 > 0.5 The assumption is identical to that in Graham (2008), and is less restrictive than it
appears due to the unrestricted nature of αc . This is because (2.2) can be derived from the initial
specification,
yc = α1c ιnc + β Gyc + (I + δG)( c + α2c ιnc )
= αc ιnc + β G c yc + (I + δG c ) c ,

(3.2)

where αc = α1c + (1 + δ)α2c . In particular, α1c and α2c might be heteroscedastic and correlated
with  c .6 This implies that the composite ability  ci + α2c is permitted to have classroom-specific
mean and variance, and to be correlated across students (in a particular manner).
Equation (3.2) can be transformed to remove unobserved classroom heterogeneity by
subtracting a weighted average of classmate attainments from the attainment of each student. This
is in the same spirit as transformations applied in panel data models. The transformation adopted
here is the local transformation of Bramoullé et al. (2009), which weights each classmate using
the interaction matrix. The transformed attainment equation is obtained by applying T = I − G
to (3.2):
Tyc = β TGyc + T (I + δG) c
= (I − β G)−1 (I + δG)T  c .

(3.3)

Using (3.1), the variance of Tyc is
V [Tyc ; θ ] = σ 2 (I − β G)−1 (I + δG)T T  (I + δG  )(I − β G  )−1 .

(3.4)

Because V [Tyc ; θ ] is identified, the parameter vector θ = (β, δ, σ 2 ) is globally identified if it can
be uniquely recovered from V [ yc ; θ ] or, equivalently, if V [ yc ; θ ] is a globally injective mapping
of θ . All of the results concern global (as opposed to local) identification.
The intuition for the identification approach is that the endogenous and contextual effects
can be separated by their contrasting impacts on peers and peers of peers. Contextual effects
have only a direct impact on peers, whilst endogenous effects propagate through the network and
affect both peers and peers of peers. This implies that in the absence of endogenous effects, there
5
6


C

The corresponding assumption under the stochastic interaction matrix interpretation is V [ c |G c ] = σ 2 I for σ 2 > 0.
Under the stochastic interaction matrix interpretation, α1c and α2c can also be arbitrarily correlated with G c .

2017 Royal Economic Society.

Downloaded from https://academic.oup.com/ectj/article-abstract/20/3/S47/5056390 by Vrije Universiteit Amsterdam user on 21 February 2019

classroom to be endogenously determined. For ease of exposition, the remainder of the paper
follows the fixed interpretation. For this reason, the subscripts c and nc are respectively omitted
from G c and I nc . All results generalize to the stochastic setting by replacing unconditional
expectations with their counterparts conditional on G c .

S52

C. D. Rose

D EFINITION 3.1. Consider M matrices of the same dimension X 1 , . . . , X M . The matrix X m
(m ∈ {1, .
. . , M}) is maximally linearly independent from X 1 , . . . , X M if λm = 0 for all λ ∈ RM
such that M
m=1 λm X m = 0.
The identification results presented below depend on a certain subset of functions of the
interaction matrix (represented by X m ) being maximally linearly independent from certain other
functions (represented by X 1 , . . . , X M ). The conditions are weaker than linear independence
of X 1 , . . . , X M . The next proposition gives the first identification result, which applies if
interactions are asymmetric.
P ROPOSITION 3.1 (A SYMMETRIC INTERACTIONS). Consider the model in Section 2 and
suppose that V [ c ] = σ 2 I and G = G  . θ is globally identified if β + δ = 0 and the matrices
T T  , T (G + G  )T  and T (G 2 + G 2 )T  are maximally linearly independent from T T  ,
T (G + G  )T  , T (G 2 + G 2 )T  , T GG  T  , T G(G + G  )G  T  and T G 2 G 2 T  .
Proposition 3.1 provides a sufficient condition for identification of θ . The condition β + δ =
0 is necessary to identify β and δ, and implies that the endogenous and contextual effects are
not of equal magnitude and opposite sign. This is evident from visual inspection of the righthand side of (3.4). If β + δ = 0, then either there are no peer effects or the endogenous and
contextual effects exactly offset one another, such that there are no net peer effects. All parameter
values satisfying β + δ = 0 are observationally equivalent to β = δ = 0. Similar conditions are
necessary for the results in Lee (2007), Davezies et al. (2009) and Bramoullé et al. (2009).7
If β + δ = 0, the condition on the interaction matrix is sufficient for identification. It ensures
that there is enough variation in the variance of the attainments over the network to separate the
endogenous effect from the contextual effect by contrasting the covariances in the attainments of
peers with the covariances in the attainments of peers of peers. The approach is similar in spirit
to that of Bramoullé et al. (2009), which exploits the network structure to provide exclusion
restrictions for identification based on first moments.
Proposition 3.2 gives an analogous result for symmetric interactions, which do not satisfy the
condition in Proposition 3.1.8 The intuition for the result is identical to that of Proposition 3.1.
P ROPOSITION 3.2 (S YMMETRIC INTERACTIONS). Consider the model in Section 2 and suppose
that V [ c ] = σ 2 I and G = G  . θ is globally identified if β + δ = 0 and the matrices T 2 , T 2 G,
T 2 G 2 and T 2 G 3 are maximally linearly independent from T 2 , T 2 G, T 2 G 2 , T 2 G 3 and T 2 G 4 .
At this point, an important remark is required. The results thus far apply to the fixed
interaction matrix interpretation of the model, in which the researcher observes an i.i.d. sample
of yc of size C from a population of classrooms with fixed and known interaction matrix G.
Suppose, instead, that the researcher observes an i.i.d. sample of (yc , Gc ) of size C from a
population of classrooms that satisfy E[ c |G c ] = 0 and V [ c |G c ] = σ 2 I nc . If we define G as
7
8

Graham (2008) requires no such condition as he imposes the restriction β = 0.
This is because 2GG  = G 2 + G 2 if G = G  .

C

2017 Royal Economic Society.

Downloaded from https://academic.oup.com/ectj/article-abstract/20/3/S47/5056390 by Vrije Universiteit Amsterdam user on 21 February 2019

is zero covariance between the attainments of peers of peers after controlling for unobserved
classroom heterogeneity. Hence, the peer effects can be separated by contrasting the covariances
of the attainments of peers with the covariances of the attainments of peers of peers. As will
become clear in the identification results presented below, the feasibility of this approach depends
on the interaction matrix G.
The following definition is useful for the main results.

Identification of peer effects through social networks using variance restrictions

S53

P ROPOSITION 3.3 (L INEAR - IN - MEANS). Consider the model in Section 2 and suppose that
V [ c ] = σ 2 I. Suppose that G is block diagonal with each element in a block of size ns equal
2
2
to n−1
s . If there exists a block of size at least two, σ is globally identified. Otherwise, σ is not
globally identified. β and δ are not globally identified.
Proposition 3.3 states that peer effects are not globally identified for the linear-in-means
interaction structure. This is because the variance of Tyc is T σ 2 , which provides no information
on δ and β. This result applies because the assumptions on αc and β are weaker than those of
Graham (2008). In the absence of correlated effects (αc = 0), it can be shown that the variance
of yc is σ 2 (I + (β + δ)(1 − β)−1 G), which implies that σ 2 and the compound parameter (β +
δ)(1 − β)−1 are identified if there exists a classroom of size at least two. However, the peer
effects are not identified without further restrictions as they cannot be uniquely determined from
the compound parameter. Nevertheless, the parameter β is identified under the restriction δ = 0,
and vice versa.
P ROPOSITION 3.4 (M ODIFIED LINEAR - IN - MEANS). Consider the model in Section 2 and
suppose that V [ c ] = σ 2 I. Suppose that G is block-diagonal with each off-diagonal element
in a block of size ns ≥ 2 equal to (ns − 1)−1 and each diagonal element equal to zero. θ is
globally identified if β + δ = 0 and there are at least four differently sized blocks. Otherwise, θ
is not globally identified.
Proposition 3.4 states that peer effects are identified for the modified linear-in-means
interaction structure if and only if β + δ = 0 and there at least four differently sized classrooms.
This is because the modified linear-in-means interaction structure leads to the following variance
of Tyc :



nc
nc − 1 − δ 2
2
I
V [Tyc ; θ ] = σ
nc − 1
nc − 1 + β



nc
nc − 1 − δ 2 
−σ 2
(ιι − I).
(3.5)
(nc − 1)2
nc − 1 + β
Equation (3.5) demonstrates that each different class size yields two reduced-form parameters,
one diagonal term and one off-diagonal term. However, because the off-diagonal term is
proportional to the diagonal term by a factor −(nc − 1)−1 , each size provides only one
independent equation from which to identify θ . This implies that at least three sizes are required
9 Interaction structures based on classroom means are common in applied work because they can be constructed using
only information on classroom membership, and thus do not require detailed network data.


C

2017 Royal Economic Society.

Downloaded from https://academic.oup.com/ectj/article-abstract/20/3/S47/5056390 by Vrije Universiteit Amsterdam user on 21 February 2019

a block diagonal interaction matrix, with blocks comprising every Gc in the distribution of
the interaction matrix, then Propositions 3.1–3.4 continue to apply once V [ c ] is replaced with
V [ c |G c ]. This is the case as, for the purposes of identification, each Gc in the distribution of the
interaction matrix can be sampled an infinite number of times (Bramoullé et al., 2009).
Propositions 3.3 and 3.4 concern two specific interaction structures that are common in
applied work.9 These are the linear-in-means interaction structure of Manski (1993) and Graham
(2008), in which the attainment depends on the mean attainment and ability of the classroom,
and the modification of linear-in-means in Lee (2007) and Davezies et al. (2009), in which the
attainment depends on the mean attainment and ability of the other members of the classroom.

S54

C. D. Rose

to obtain at least as many equations as unknowns. A fourth size is necessary as the quadratic
system admits multiple solutions with just three group sizes.

Estimation can be conducted by a standard application of non-linear least squares. Using (3.3)
yields the following equation for the squares and cross-products of Tyc ,

2


Tyc y
c T = σ  + c  ,

(4.1)

2
where  = (I − β G)−1 (I + δG)T and c =  c  
c − σ I. Define ỹc , X̃(θ) and ωc as the
 
vectors that respectively stack the columns of Tyc yc T , σ 2  and c  to obtain

ỹc = X̃(θ) + ωc .

(4.2)

Equation (4.2) can then be stacked for c = 1, . . . , C and non-linear least squares applied to
estimate θ . For inference, one can use

ωc ω
c = ( ⊗ ) ( ⊗ ) ,

where

⎛

( 2c1 − σ 2 )2
⎜ c1  c2 ( 2c1 − σ 2 )
⎜
⎜
..
⎜
.
=⎜
⎜
⎜
⎜
⎝

 c1  c2 ( 2c1 − σ 2 )
 2c1  2c2
..
.

If ability is i.i.d. with E[( 2ci − σ 2 )2 ] = μ:
⎛
μ 0
⎜0 σ 4
⎜
⎜ ..
⎜. 0
⎜

E[ωc ωc ] = ( ⊗ )⎜
..
⎜
.
⎜
⎜
⎝

(4.3)
⎞

...
...
..
.
 2c1  2cn

...
0
..
.

( 2c2 − σ 2 )2

..

⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎠

(4.4)

.

⎞
⎟
⎟
⎟
⎟
⎟
⎟( ⊗ ) ,
⎟
⎟
⎟
⎠

...
σ4

μ
..

(4.5)

.

which can be consistently estimated. If ability is not i.i.d., then standard errors can be clustered
at the classroom level.

5. PEER EFFECTS IN EDUCATION
At the beginning of the 1985–1986 academic year, 325 teachers and 6,325 first-year kindergarten
students in 79 schools in the state of Tennessee were randomly allocated to class types within
their school. There were three types of class; small (consisting of 13–17 students), standard (with

C

2017 Royal Economic Society.

Downloaded from https://academic.oup.com/ectj/article-abstract/20/3/S47/5056390 by Vrije Universiteit Amsterdam user on 21 February 2019

4. ESTIMATION

Identification of peer effects through social networks using variance restrictions

S55

Table 1. Summary statistics for Project STAR.
Std dev.

Min

Max

485.3407
0.4858
0.3265
0.4804
18.0568

47.7924
0.4998
0.4690
0.4997
3.9646

288
0
0
0
9

626
1
1
1
27

22–25 students) and standard with a classroom assistant. All sampled schools were sufficiently
large so as to accommodate at least one of each class type. This process generated ample variation
in class sizes, which can be exploited to identify peer effects (Graham, 2008).
The experimental protocol randomly allocated students and teachers to class types rather
than classrooms. There is no distinction for 31 three-class schools, but for the remaining larger
schools it is feasible that students and teachers were selected into classrooms. The specification in
Section 2 addresses this concern by allowing unobserved classroom heterogeneity to be
correlated with ability in an unrestricted manner. Moreover, following the discussion in Section 3,
the mean and variance of ability are permitted to be classroom specific. The analysis in Graham
(2008) does not allow for selection of students and teachers into classrooms.
The outcome of interest is students’ performance in the SAT in mathematics, conducted at
the end of the first year of kindergarten. Following Graham (2008), scores are normalized to
have zero mean and unit standard deviation. The data also include indicators for student gender,
whether the student is African American, whether the student is eligible for free school meals,
class type, teacher characteristics and a school identifier. No classroom identifier is provided,
though the algorithm of Graham (2008) is able to assign 6,172 students to 317 of the 325
classrooms by matching on school, class type and teacher characteristics. Table 1 summarizes
the data for the subsample of 317 classrooms.
The interaction matrix G is constructed from 317 blocks G 1 , . . . , G 317 , each corresponding
to a classroom. There are 18 classroom sizes, thus there is sufficient variation in classroom sizes
to satisfy the identification requirements of Proposition 3.4. However, as shown by Lee (2007),
although identification can be attained through variation in class sizes alone, in practice it is
typically weak if the class sizes are large. This is is evident from the right-hand side of (3.5),
the limit of which is σ 2 I as nc → ∞. Consequently, the researcher is only able to obtain limited
information on the peer effects by contrasting the variances of attainment between large groups.
This holds true for the Project STAR data considered here, yielding standard errors several orders
of magnitude larger than the point estimates of the peer effects.10
To avoid issues related to weak identification, in the baseline specification the strength
of the tie between two students in the same class is weighted by their socio-demographic
distance, which has been shown to play an important role in the formation of social networks;
see, e.g. McPherson et al. (2001), Moody (2001), Jackson (2008) and Currarini et al. (2009).
Weighting the ties leads to greater variation in the interaction matrix G, substantially improving
the precision of the estimated peer effects. For students i and j = i in classroom c, the weight of
the tie is inversely proportional to the Euclidean social distance Dij based on gender, ethnicity
10


C

For β, the standard error is around 150 times larger than the point estimate, whereas for δ it is around 15 times larger.

2017 Royal Economic Society.

Downloaded from https://academic.oup.com/ectj/article-abstract/20/3/S47/5056390 by Vrije Universiteit Amsterdam user on 21 February 2019

Mathematics SAT score (M ci )
Female (F ci )
Black (B ci )
Free school meals (F SM ci )
Classroom size (nc )

Mean

S56

C. D. Rose

and eligibility for free school meals:
(5.1)

Dij = (F ci − F cj )2 + (B ci − B cj )2 + (F SM ci − F SM cj )2

1/2

.

(5.2)

Here, 1{i=j } is the indicator for i = j . The interaction matrix G is then row normalized such that
the rows sum to one. This procedure results in an asymmetric interaction matrix, which satisfies
the identification condition in Proposition 3.1.
5.1. Results
Table 2 presents non-linear least-squares estimates of θ . Reported standard errors are clustered by
classroom. Specification (1) restricts the contextual effect to be zero. The estimated endogenous
effect is positive and statistically significant at the 1% level. A standard deviation increase in
peer attainment is associated with a 0.65 of a standard deviation increase in attainment, which
suggests strong peer effects in mathematics. The sign and magnitude of the effect is consistent
with the majority of the empirical literature, as surveyed in Sacerdote (2010).
Specification (2) restricts the endogenous effect to be zero. The estimated contextual effect is
positive and statistically significant at the 1% level. A standard deviation increase in peer abilities
is associated with a 0.62 of a standard deviation increase in attainment. Using the same data and
a comparable specification, Graham (2008) estimates (δ + 1)2 = 3.47, which implies an estimate
of δ equal to {0.86, −2.86}, compared with the value 0.71 obtained here.
Specification (3) does not restrict either peer effect. The estimated endogenous effect is
similar to that of model (1), though it is slightly larger and ceases to be statistically significant.
The estimated contextual effect is close to zero and is statistically insignificant. The standard
errors for the two effects are large, which is indicative of weak identification. This suggests that
although the interaction matrix exhibits sufficient variation to satisfy the identification condition
in Proposition 3.1, there is insufficient variation to precisely disentangle the peer effects.
Bramoullé et al. (2009) show by simulation that the strength of identification (using first
moments) is positively associated with the sparsity of the network. This is likely because
Table 2. Peer effects in normalized mathematics test scores.
Interaction matrix weighted
by social distance (5.1)
(1)
Peer test score

β

Peer ability

δ

Ability variance

σ2

Classrooms
Classroom effects

317
Yes

(2)
***

0.6481
(0.1558)

0.7486***
(0.0264)
317
Yes

0.7093***
(0.1866)
0.7583***
(0.0302)
317
Yes

(3)
0.8966
(1.7295)
−0.0257
(1.9380)
0.7701***
(0.0483)
317
Yes

Interaction matrix weighted by
thresholded social distance (5.3)
(4)

(5)

(6)

0.5616***
(0.1684)
0.7423***
(0.0281)
317
Yes

0.8965*
(0.6727)
−0.0263
(0.8259)
0.7689***
(0.0331)
317
Yes

***

0.6477
(0.1254)

0.7476***
(0.0245)
317
Yes

Note: The sample comprises 317 classrooms. Parameters are estimated by applying non-linear least squares to (4.2).
Standard errors are clustered by classroom and reported in parentheses. * p < 0.1; ** p < 0.05; *** p < 0.01.

C

2017 Royal Economic Society.

Downloaded from https://academic.oup.com/ectj/article-abstract/20/3/S47/5056390 by Vrije Universiteit Amsterdam user on 21 February 2019

G cij = 1{i=j } (1 + Dij )−1

Identification of peer effects through social networks using variance restrictions

S57

Specifications (4)–(6) report results for the incomplete interaction matrix. In specifications
(4) and (5), the estimated peer effects remain positive, and are similar to, though smaller in
magnitude than, specifications (1) and (2). Standard errors are also comparable, though slightly
smaller in specifications (4) and (5). Point estimates for specification (6) are similar in magnitude
but more precisely estimated than those of specification (3).

6. CONCLUSION
This paper presents a novel method to identify peer effects through contrasting the covariances of
attainment for peers with the covariances of attainment for peers of peers. Identification prospects
depend on the network structure, which must lead to sufficient variation in the covariances of the
outcomes over the network. A non-linear least-squares estimator is proposed, and the method is
applied to the Project STAR data to study peer effects in educational attainment.
Future work might seek to apply the methodology derived in this paper to study peer effects
in settings with more detailed social network data than those available in Project STAR. For
example, a number of papers make use of the Add Health data set, which includes detailed data
on student friendships in US high schools. This would serve to complement existing work based
on first moments. In addition, there is scope to combine the method developed in this paper
with that of Bramoullé et al. (2009). Using both first and second moments might lead to point
identification for interaction structures such as linear-in-means, which preclude identification
using either first moments or second moments alone.

ACKNOWLEDGEMENTS
I acknowledge financial support from the European Research Council grant POEMH and the
Royal Economic Society (Junior Fellowship). I thank Grégory Jolivet, Aureo de Paula and
seminar audiences at Bristol and Toulouse School of Economics for their constructive comments.
I am also grateful to the University of Bristol and Toulouse School of Economics, institutions at
which much of the work on this paper was undertaken.

C

2017 Royal Economic Society.

Downloaded from https://academic.oup.com/ectj/article-abstract/20/3/S47/5056390 by Vrije Universiteit Amsterdam user on 21 February 2019

unlike complete networks, incomplete networks provide exclusion restrictions. For incomplete
networks, the exogenous covariates of peers of peers are valid instruments for peer attainment
(Bramoullé et al., 2009).
Sparsity is also likely to play a crucial role in determining the strength of identification
through second moments by contrasting the covariances of the attainment of peers with the
covariances of the attainment of peers of peers. The network corresponding to (5.1) is complete,
and hence there are no peers of peers who are not also peers. This is likely the reason for the large
standard errors in model (3). To explore this further, the analysis is repeated for an incomplete
counterpart of the network, in which a tie between two students in the same class is supposed
to exist only if they have at least one socio-demographic characteristic in common. To do this,
replace (5.1) with
√

1{i=j } (1 + Dij )−1 if Dij ≤ 2
.
(5.3)
G cij =
0
otherwise

S58

C. D. Rose

REFERENCES

APPENDIX A: PROOFS
Proof of Proposition 3.1: Let there be two parameters θ, θ̃ such that V [Tyc ; θ] = V [Tyc ; θ̃ ]. Then
σ 2 (I − β G)−1 (I + δG)(I + δG  )T T  (I − β G  )−1
= σ̃ 2 T (I − β̃ G)−1 (I + δ̃G)(I + δ̃G  )(I − β̃ G  )−1 T  .

(A.1)

Pre-multiplying (A.1) by (I − β G)(I − β̃ G), post-multiplying by (I − β G  )(I − β̃ G  ), and because
T G = GT , we obtain
σ 2 T (I − β̃ G)(I + δG)(I + δG  )(I − β̃ G  )T 
= σ̃ 2 T (I − β G)(I + δ̃G)(I + δ̃G  )(I − β G  )T 

C

(A.2)
2017 Royal Economic Society.

Downloaded from https://academic.oup.com/ectj/article-abstract/20/3/S47/5056390 by Vrije Universiteit Amsterdam user on 21 February 2019

Blume, L. E., W. A. Brock, S. N. Durlauf and R. Jayaraman (2015). Linear social interactions models.
Journal of Political Economy 123, 444–96.
Bramoullé, Y., H. Djebbari and B. Fortin (2009). Identification of peer effects through social networks.
Journal of Econometrics 150, 41–55.
Currarini, S., M. O. Jackson and P. Pin (2009). An economic model of friendship: homophily, minorities,
and segregation. Econometrica 77, 1003–45.
Davezies, L., X. d’Haultfoeuille and D. Fougère (2009). Identification of peer effects using group size
variation. Econometrics Journal 12, 397–413.
De Paula, A. (2016). Econometrics of network models. CWP 52/15, Centre for Microdata Methods and
Practice, Institute for Fiscal Studies and University College London.
Glaeser, E. L., B. Sacerdote and J. A. Scheinkman (1996). Crime and social interactions. Quarterly Journal
of Economics 111, 507–48.
Graham, B. S. (2008). Identifying social interactions through conditional variance restrictions.
Econometrica 76, 643–60.
Jackson, M. O. (2008). Social and Economic Networks, Volume 3. Princeton NJ: Princeton University Press.
Lee, L-f., (2007). Identification and estimation of econometric models with group interactions, contextual
factors and fixed effects. Journal of Econometrics 140, 333–74.
McPherson, M., L. Smith-Lovin and J. M. Cook (2001). Birds of a feather: homophily in social networks.
Annual Review of Sociology 27, 415–44.
Manski, C. F. (1993). Identification of endogenous social effects: the reflection problem. Review of
Economic Studies 60, 531–42.
Moffitt, R. A. (2001). Policy interventions, low-level equilibria, and social interactions. In S. Durlauf and
H. P. Young (Eds.), Social Dynamics, 45–82. Cambridge, MA: MIT Press.
Moody, J. (2001). Race, school integration, and friendship segregation in America. American Journal of
Sociology 107, 679–716.
Sacerdote, B. (2000). Peer effects with random assignment: results for Dartmouth roommates. Technical
Working Paper 7469, National Bureau of Economic Research.
Sacerdote, B. (2010). Peer effects in education: how might they work, how big are they and how much do we
know thus far? In E. A. Hanushek, S. J. Machin and L. Woessmann (Eds.), Handbook of the Economics
of Education, Volume 3, 249–77. Amsterdam: North-Holland.

Identification of peer effects through social networks using variance restrictions

S59

Expanding (A.2), we have

− T (G 2 + G 2 )T  (σ 2 δ̃β − σ̃ 2 δ β̃) + T GG  T  (σ 2 (δ − β̃)2 − σ̃ 2 (δ̃ − β)2 )
+ T G(G + G  )G  T  (σ 2 δ β̃(β̃ − δ) − σ̃ 2 δ̃β(β − δ̃))
+ T G 2 G 2 T  (σ 2 δ 2 β̃ 2 − σ̃ 2 δ̃ 2 β 2 ) = 0.






(A.3)

Because T T , T (G + G )T and T (G + G )T are maximally linearly independent from T T  ,
T (G + G  )T  , T (G 2 + G 2 )T  , T GG  T  , T G(G + G  )G  T  and T G 2 G 2 T  , (A.3) implies σ 2 =
σ̃ 2 and
2

2



(δ − β̃) − (δ̃ − β) = 0,

(A.4)

δ̃β − δ β̃ = 0.

(A.5)

Now, eliminate δ̃ by injecting (A.4) into (A.5):
(β + δ)(β − β̃) = 0.
Because β + δ = 0, β̃ = β solves (A.6). Injecting β̃ = β into (A.4) yields δ̃ = δ.

(A.6)


Proof of Proposition 3.2: Suppose that G = G  , which implies T = T  . Let there be two parameters θ,
θ̃ such that V [Tyc ; θ] = V [Tyc ; θ̃ ]. Then,
σ 2 T 2 (I − β G)−2 (I + δG)2 = σ̃ 2 T 2 (I − β̃ G)−2 (I + δ̃G)2 .

(A.7)

Pre-multiplying (A.7) by (I − β G) (I − β̃ G) , and expanding, we have
2

2

T 2 (σ 2 − σ̃ 2 ) + 2T 2 G(σ 2 (δ − β̃) − σ̃ 2 (δ̃ − β))
+T 2 G 2 (σ 2 (δ 2 + β̃ 2 − 4δ β̃) − σ̃ 2 (δ̃ 2 + β 2 − 4δ̃β))
+2T 2 G 3 (σ 2 δ β̃(β̃ − δ) − σ̃ 2 δ̃β(β − δ̃)) + T 2 G 4 (σ 2 δ 2 β̃ 2 − σ̃ 2 δ̃ 2 β 2 ) = 0.

(A.8)

Because T 2 , T 2 G, T 2 G 2 and T 2 G 3 are maximally linearly independent from T 2 , T 2 G, T 2 G 2 , T 2 G 3 and
T 2 G 4 , (A.8) implies σ 2 = σ̃ 2 and
(δ − β̃) − (δ̃ − β) = 0,

(A.9)

(δ 2 + β̃ 2 − 4δ β̃) − (δ̃ 2 + β 2 − 4δ̃β) = 0,

(A.10)

δ β̃(β̃ − δ) − δ̃β(β − δ̃) = 0.

(A.11)

Now eliminate δ̃ by injecting (A.9) into (A.10) and (A.11) respectively:
(β + δ)(β − β̃) + (β 2 − β̃ 2 ) = 0;

(A.12)

(β + δ)(β̃ − δ)(β̃ − β) = 0.

(A.13)

Because β + δ = 0, the solutions to (A.13) are β̃ = (β, δ). Consider the solution β̃ = δ. At this solution,
(A.12) is
(β + δ)(β − δ) + (β 2 − δ 2 ) = 0,

(A.14)

the solutions of which are β = (δ, −δ). However, β = −δ is not consistent with β + δ = 0, and hence the
unique solution is β = δ = β̃. Consequently, β̃ = β. Injecting β̃ = β into (A.9) yields δ = δ̃.


C

2017 Royal Economic Society.

Downloaded from https://academic.oup.com/ectj/article-abstract/20/3/S47/5056390 by Vrije Universiteit Amsterdam user on 21 February 2019

T T  (σ 2 − σ̃ 2 ) + T (G + G  )T  (σ 2 (δ − β̃) − σ̃ 2 (δ̃ − β))

S60

C. D. Rose

Proof of Proposition 3.3: It is straightforward to see that
G = G,
∀p ∈ N++ .

(A.16)

This implies that T 2 = T and T G p = 0 ∀p ∈ N++ . Let there be two parameters θ , θ̃ such that
V [Tyc ; θ] = V [Tyc ; θ̃ ]. Then, (A.8) simplifies to
T (σ 2 − σ̃ 2 ) = 0.

(A.17)

If there is at least one block of size 2 or more, then T = 0 and σ̃ 2 = σ 2 . Otherwise, there exists σ̃ 2 = σ 2 ,
which satisfies (A.17). Trivially, there always exist β̃ = β and δ̃ = δ, which satisfy (A.17).

Proof of Proposition 3.4: Using the interaction matrix and (A.7), it is straightforward to obtain



nc − 1 − δ 2
nc
I
V [Tyc ; θ] = σ 2
nc − 1
nc − 1 + β



nc
nc − 1 − δ 2 
−σ2
(ιι − I).
(nc − 1)2
nc − 1 + β

(A.18)

Let there be two parameters θ , θ̃ such that V [Tyc ; θ ] = V [Tyc ; θ̃ ]. Suppose that there are S group sizes.
Then (A.18) implies
σ 2 (ns − 1 − δ)2 (ns − 1 + β̃)2 = σ̃ 2 (ns − 1 − δ̃)2 (ns − 1 + β)2

∀s = 1, . . . , S.

(A.19)

Trivially, it is clear that θ is not identified for S < 3. By visual inspection of (A.18) if β + δ = 0, σ 2 is
identified but β, δ are not. Suppose that β + δ = 0 and S = 3. Consider the case where β = 0, δ = 1 and
σ 2 = 1, and denote ms = ns − 1. Then,
β̃ =

2m1 m2 m3 (m1 − 1)
m1 m2 + m1 m3 + m2 m3 − m21 − 2m1 m2 m3

(A.20)

m1 m2 + m1 m3 − m2 m3 − 2m21 m2 − 2m21 m3 + m21 + 2m21 m2 m3
m1 m2 − 2m1 + m1 m3 + m2 m3 + m21 − 2m1 m2 m3
2

m1 m2 − 2m1 + m1 m3 + m2 m3 + m21 − 2m1 m2 m3
σ̃ 2 =
m1 m2 + m1 m3 + m2 m3 − m21 − 2m1 m2 m3

δ̃ = −

(A.21)
(A.22)

are a solution to (A.19), and hence θ is not identified. If S ≥ 4 and β + δ = 0, then θ = θ̃ is the unique
solution to (A.19).


SUPPORTING INFORMATION
Additional Supporting Information may be found in the online version of this article at the
publisher’s web site:
Replication Files


C

2017 Royal Economic Society.

Downloaded from https://academic.oup.com/ectj/article-abstract/20/3/S47/5056390 by Vrije Universiteit Amsterdam user on 21 February 2019

G = Gp

(A.15)

