DE GRUYTER

Journal of Econometric Methods. 2019; 20170016

Yu-Chin Hsu1 / Martin Huber2 / Tsung-Chih Lai3

Nonparametric estimation of natural direct and
indirect effects based on inverse probability
weighting
1 Institute of Economics, Academia Sinica, Taipei, Taiwan, E-mail: ychsu@econ.sinica.edu.tw
2 Department of Economics, Universite de Fribourg, Fribourg, Switzerland
3 Department of Economics, Feng Chia University, Taichung, Taiwan

Abstract:
Using a sequential conditional independence assumption, this paper discusses fully nonparametric estimation
of natural direct and indirect causal effects in causal mediation analysis based on inverse probability weighting. We propose estimators of the average indirect effect of a binary treatment, which operates through intermediate variables (or mediators) on the causal path between the treatment and the outcome, as well as the
unmediated direct effect. In a first step, treatment propensity scores given the mediator and observed covariates or given covariates alone are estimated by nonparametric series logit estimation. In a second step, they
are used to reweigh observations in order to estimate the effects of interest. We establish root-n consistency
and asymptotic normality of this approach as well as a weighted version thereof. The latter allows evaluating
effects on specific subgroups like the treated, for which we derive the asymptotic properties under estimated
propensity scores. We also provide a simulation study and an application to an information intervention about
male circumcisions.
Keywords: causal channels, causal mechanisms, causal pathways, direct effects, indirect effects, inverse probability weighting, mediation analysis, nonparametric estimation, propensity score, series logit estimation
JEL classiï¬cation: C21
DOI: 10.1515/jem-2017-0016

Automatically generated rough PDF by ProofCheck from River Valley Technologies Ltd

1 Introduction
While a large literature in social sciences focuses on assessing the average treatment effect (ATE) of some intervention, quite frequently, also the causal mechanisms through which the effect materializes appear interesting.
Gelman and Imbens (2013), for instance, argue that in many cases not only the â€˜effects of causesâ€™ seem relevant,
but also the â€˜causes of effectsâ€™. When for example assessing the earnings effect of a training program, policy
makers might want to know whether the total impact comes from a change in search effort, human capital, or
other mediators that are themselves affected by the training. For this reason, causal mediation analysis aims at
disentangling a treatment effect into the indirect effect operating through one or several mediators as well as
the direct effect, net of mediation. Even under random treatment assignment, total effects can in general not
be disentangled by bluntly controlling for mediators, because this likely introduces selection bias, see Robins
and Greenland (1992). However, direct and indirect effects are identified under a particular sequential conditional independence assumption that assumes the exogeneity of the treatment given observed covariates and of
the mediator given observed covariates and the treatment, see for instance Imai, Keele, and Yamamoto (2010).
Huber (2014) shows that under this assumption, identification is obtained by weighting observations by the inverses of particular treatment propensity scores1 and considers semiparametric estimation based on parametric
propensity score models in a simulation study and an application.
This paper is the first to consider fully nonparametric estimation of natural direct and indirect effects [in the
denomination of Pearl (2001)] based on inverse probability weighting (IPW), using series logit estimation for
the computation of the propensity scores. The advantage of the latter approach is that it prevents inconsistency
of IPW due to an incorrectly specified parametric functional form of the propensity scores. We formally show
that under the sequential conditional independence assumption and particular regularity conditions, nonparametric IPW is root-n consistent and asymptotically normal. Furthermore, our estimator attains the semiparametric efficiency bounds for mediation analysis derived by Tchetgen Tchetgen and Shpitser (2012). We therefore
Yu-Chin Hsu is the corresponding author.
Â©2019 Walter de Gruyter GmbH, Berlin/Boston.

Unauthenticated
Download Date | 2/25/19 5:32 PM

1

Hsu et al.

DE GRUYTER

contribute to a growing literature concerned with assessing direct and indirect effects based on conditional independence under rather flexible model assumptions,2 see for instance Pearl (2001), Petersen, Sinisi, and van
der Laan (2006), Flores and Flores-Lagunes (2009), VanderWeele (2009), Imai, Keele, and Yamamoto (2010),
Hong (2010), Albert and Nelson (2011), Imai and Yamamoto (2013), Tchetgen Tchetgen and Shpitser (2012), and
Vansteelandt, Bekaert, and Lange (2012), among others.3 In addition to the evaluation of these effects in the
total population, we in contrast to Huber (2014) also discuss the identification and estimation of weighted direct and indirect effects. This provides a framework for evaluating causal parameters in interesting subgroups,
such as the direct and indirect effects on the treated, which are explicitly considered in this paper. Also for the
estimators of the weighted effects in general and the effects on the treated with estimated propensity scores in
particular, we show root-n consistency and asymptotic normality.
Furthermore, we investigate the finite sample performance of nonparametric IPW in a simulation study and
compare it to other estimators considered in the literature, namely estimation based on (parametrically) simulating potential mediators and outcomes using the â€˜mediationâ€™ package for R by Tingley et al. (2014) and IPW
with parametric propensity scores as in Huber (2014). Finally, we apply our estimator (as well as the other methods considered in the simulations) to the experimental evaluation of Chinkhumba, Godlonton, and Thornton
(2014) who investigate an information intervention about male circumcisions and HIV risk in urban Malawi.
We investigate whether the information treatment affects the event/willingness of being circumcised indirectly
through a change in the assessment of the relative HIV risk for circumcised and uncircumcised males (which
serves as mediator), or â€˜directlyâ€™, i.e. through other mechanisms. The results point to a small indirect effect,
while the direct effect estimates are never statistically different from zero.
The remainder of this paper is organized as follows. Section 2 defines the average natural direct and indirect effects and presents the identifying assumptions. Section 3 discusses nonparametric estimation based on
IPW as well as inference and shows root-n consistency and asymptotic normality under particular regularity
conditions. Section 4 extends the identification and estimation results to weighted effects and to the effects on
the treated under estimated propensity scores, respectively. Section 5 provides a simulation study. Section 6
presents an application to the direct and indirect effects of an information intervention about male circumcisions and HIV risk in urban Malawi. Section 7 concludes. All proofs are deferred to Appendix A.

2 Parameters of Interest and Identifying Assumptions

Automatically generated rough PDF by ProofCheck from River Valley Technologies Ltd

2.1 Natural Direct and Indirect Effects
We denote by D a binary intervention or treatment variable and by Y the outcome variable of interest. We would
like to disentangle the causal effect of D on Y into a direct effect and an indirect impact that works through
one or several discrete or continuous intermediate variables or mediators, denoted by M. Figure 1 provides
a graphical illustration of the causal framework, in which arrows represent causal effects from one variable
to another, but any confounders are omitted for the sake of simplicity. The definition of the total, direct, and
indirect effects makes use of the potential outcome framework, see for instance Rubin (1974), and its adaptation
to mediation analysis, see for instance Rubin (2004), Ten Have et al. (2007), and Albert (2008). M(d), Y(d, M(d))
denote the potential mediator state and the potential outcome, respectively, under treatment d âˆˆ {0, 1}. Î” =
E[Y(1, M(1)) âˆ’ Y(0,M(0))] yields the (total) average causal effect, also known as average treatment effect (ATE),
which has received much attention in the treatment or program evaluation literature, see for instance Imbens
and Wooldridge (2009) for a survey.

Figure 1: Graphical illustration of the mediation framework.

The (average) natural direct effect [using the denomination of Pearl (2001)]4 is defined as the mean effect of
varying the treatment when keeping the mediator fixed at its potential value for some d âˆˆ {0, 1}:
ğœƒ(ğ‘‘) = ğ¸[ğ‘Œ(1, ğ‘€(ğ‘‘)) âˆ’ ğ‘Œ(0, ğ‘€(ğ‘‘))],
2

ğ‘‘ âˆˆ {0, 1}.

(1)
Unauthenticated
Download Date | 2/25/19 5:32 PM

DE GRUYTER

Hsu et al.

Analogously, the (average) indirect effect is defined as the mean effect of shifting the mediator to its potential
values under treatment and non-treatment when keeping the treatment fixed:
ğ›¿(ğ‘‘) = ğ¸[ğ‘Œ(ğ‘‘, ğ‘€(1)) âˆ’ ğ‘Œ(ğ‘‘, ğ‘€(0))],

ğ‘‘ âˆˆ {0, 1}.

(2)

The ATE is the sum of the direct and indirect effects defined upon opposite treatment states:
Î” = ğ¸[ğ‘Œ(1, ğ‘€(1)) âˆ’ ğ‘Œ(0, ğ‘€(0))]
= ğ¸[ğ‘Œ(1, ğ‘€(0)) âˆ’ ğ‘Œ(0, ğ‘€(0))] + ğ¸[ğ‘Œ(1, ğ‘€(1)) âˆ’ ğ‘Œ(1, ğ‘€(0))] = ğœƒ(0) + ğ›¿(1)
= ğ¸[ğ‘Œ(1, ğ‘€(1)) âˆ’ ğ‘Œ(0, ğ‘€(1))] + ğ¸[ğ‘Œ(0, ğ‘€(1)) âˆ’ ğ‘Œ(0, ğ‘€(0))] = ğœƒ(1) + ğ›¿(0).

(3)

The notation Î¸(1), Î¸(0) and Î´(1), Î´(0) point out that direct and indirect effects may be heterogeneous in the
treatment, which allows for interaction effects between the treatment and the mediator. No effect is identifiable
without assumptions, because either Y(1, M(1)) or Y(0, M(0)) (but never both) is known for any individual, while
Y(1, M(0)) and Y(0, M(1)) cannot be observed for anyone (as an individual can either be treated or non-treated,
but not both at the same time).

2.2 Identiï¬cation
Like Imai, Keele, and Yamamoto (2010) and many others, we rely on a sequential conditional independence
assumption for identification. To this end, let X denote a vector of observed covariates that potentially confound
the treatment, the mediator, and the outcome. Furthermore, we denote by ğ’³ , â„³ the supports of X and M,
respectively.
Assumption 1 (conditional independence of the treatment):
{Y(dâ€², m), M(d)} âŠ¥ D |X =x for all dâ€², d âˆˆ {0, 1} and (m, x) âˆˆ â„³ Ã— ğ’³ .

Automatically generated rough PDF by ProofCheck from River Valley Technologies Ltd

Assumption 1 requires the treatment to be conditionally independent of the potential mediator states and
outcomes given X, ruling out unobserved confounders jointly affecting the treatment on the one hand and the
mediator and/or the outcome on the other hand conditional on the covariates. This restriction is known as
conditional independence, selection on observables, or exogeneity in the treatment evaluation literature.
Assumption 2 (conditional independence of the mediator):
Y(dâ€², m) âŠ¥ M | D = d, X = x for all dâ€², d âˆˆ {0, 1} and (m, x) âˆˆ â„³ Ã— ğ’³ .
Assumption 2 requires the mediator to be conditionally independent of the potential outcomes given D
and X, ruling out unobserved confounders jointly causing the mediator and the outcome conditional on the
treatment and the covariates.
Assumption 3 (common support):
Pr(D = d| M = m, X = x) is bounded away from zero for all d âˆˆ {0, 1} and (m, x) âˆˆ â„³ Ã— ğ’³ .
Assumption 3 is a common support restriction requiring that the conditional probability to be treated given
M, X must be bounded away from zero in either treatment state. Note that Pr(D = d|X = x) must therefore be
bounded away from zero on ğ’³, too. By Bayesâ€™ theorem, Assumption 3 also implies Pr(M = m|D = d, X = x) >
0 or, in the case of a continuous M, that the conditional density of M given D, X is larger than zero. Therefore,
the mediator state must not be a deterministic function of the treatment conditional on X.
Identification of the natural direct and indirect effects under these or similar assumptions based on functions
of the conditional mean of Y given D, M, X and the conditional density of M given D, X (the mediation formulae)
has been demonstrated for instance in Imai, Keele, and Yamamoto (2010) and Pearl (2001). Huber (2014) shows
that the effects as well as the mean potential outcomes may alternatively be identified by inverse probability
weighting (IPW) based on the conditional probabilities Pr(D = d|M, X) and Pr(D = d|X), henceforth referred
to as propensity scores:
ğœƒ(ğ‘‘)

=

ğ›¿(ğ‘‘) =
ğ¸[ğ‘Œ(ğ‘‘, ğ‘€(ğ‘‘â€² ))] =

ğ‘Œ(1âˆ’ğ·)
= ğ‘‘|ğ‘€, ğ‘‹)
âˆ’ 1âˆ’Pr(ğ·
ğ¸ [( Pr(ğ· =ğ‘Œğ·
) Pr(ğ·
],
1|ğ‘€, ğ‘‹)
= 1|ğ‘€, ğ‘‹)
Pr(ğ· = ğ‘‘|ğ‘‹)
ğ‘Œğ¼{ğ· = ğ‘‘}
= 1|ğ‘€, ğ‘‹)
= 1|ğ‘€, ğ‘‹)
ğ¸ [ Pr(ğ·
âˆ’ 1âˆ’Pr(ğ·
( Pr(ğ·
)] ,
Pr(ğ· = 1|ğ‘‹)
1âˆ’Pr(ğ· = 1|ğ‘‹)
= ğ‘‘|ğ‘€, ğ‘‹)

(4)

â€²

ğ‘Œğ¼{ğ· = ğ‘‘} Pr(ğ· = ğ‘‘ |ğ‘€, ğ‘‹)
ğ¸ [ Pr(ğ·
] for ğ‘‘, ğ‘‘â€² âˆˆ {1, 0}.
= ğ‘‘|ğ‘€, ğ‘‹) Pr(ğ· = ğ‘‘â€² |ğ‘‹)

Unauthenticated
Download Date | 2/25/19 5:32 PM

3

Hsu et al.

DE GRUYTER

I{â‹…} is the indicator function which is one if its argument is satisfied and zero otherwise. The expressions for
Î¸(d) and Î´(d) are (by Bayesâ€™ theorem) mathematically identical to weighting-based representations of the direct
and indirect effect relying on Pr(D = 1|X) and Pr(M = m|D, X) (rather than Pr(D = 1|M, X)) suggested in Hong
(2010) and Tchetgen Tchetgen and Shpitser (2012), see their â€˜strategy 3â€™. The practical advantage of the approach
advocated in this paper is that Pr(D = 1|M, X) may be easier to estimate than Pr(M = m|D, X) or the respective
conditional density of M in the case of a continuous M. This particularly relevant when the support of M is rich
(i.e., contains many values) or M is a vector of several variables.
We note that the identification results in (4) can be generalized in various dimensions. First, replacing Y
everywhere in (4) by an indicator function that Y is smaller than or equal to a particular value a, i.e. I{Y â‰¤
a}, allows the evaluation of distributional features and effects. In this case, the expressions for Î¸(d) and Î´(d)
provide the direct and indirect effects on the cumulative distribution function (cdf) evaluated at a rather than
the average effects. Likewise, the expressions for the mean potential outcomes identify the potential cdfâ€™s when
Y is substituted by I{Y â‰¤ a}. Inverting the cdfâ€™s in turn allows identifying quantile treatment effects, given that Y
satisfies particular continuity conditions. See Donald and Hsu (2014) for related results in the context of (total)
treatment effect evaluation. Second, the results can be extended to the evaluation of weighted direct and indirect
effects as a function of the distribution of X in an analogous way as suggested in Hirano, Imbens, and Ridder
(2003), henceforth HIR, in the context of the ATE. As more thoroughly discussed in Section 4, this permits the
identification and (under particular assumptions) root-n-consistent estimation in specific subgroups. As one
important special case of weighted IPW, Section 4.3 shows this for the treated population. Finally, the properties
derived for our estimators also apply to the estimation of the direct and partial indirect effects discussed in
Section 2.3 of Huber (2014) when some covariates in X are themselves affected by the treatment.

3 Estimation and Inference
3.1 Nonparametric Estimation

Automatically generated rough PDF by ProofCheck from River Valley Technologies Ltd

As in Huber (2014), the proposed estimators are based on normalized versions of the sample analogs of the
IPW-based identification results of expression (4), with weights adding up to unity in either treatment state,
see Imbens (2004) and Busso, DiNardo, and McCrary (2014). The normalized estimators of the direct effects
under treatment and non-treatment, for instance, correspond to

Ì‚
ğœƒ(1)
=
Ì‚
ğœƒ(0)
=

1
ğ‘›

ğ‘›

1
ğ‘›

Ì‚ ğ‘–)
âˆ‘ğ‘–=1 ğ‘Œğ‘– ğ·ğ‘– /ğ‘(ğ‘‹

ğ‘›

Ì‚ ğ‘– , ğ‘‹ğ‘– )/[(1 âˆ’ ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ))ğ‘(ğ‘‹
Ì‚ ğ‘– )]
âˆ‘ğ‘–=1 ğ‘Œğ‘– (1 âˆ’ ğ·ğ‘– )ğ‘(ğ‘€

âˆ’ 1 ğ‘›
,
ğ‘›
âˆ‘ğ‘–=1 ğ·ğ‘– /ğ‘(ğ‘‹
Ì‚ ğ‘–)
Ì‚ ğ‘– , ğ‘‹ğ‘– )/[(1 âˆ’ ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ))ğ‘(ğ‘‹
Ì‚ ğ‘– )]
ğ‘› âˆ‘ğ‘–=1 (1 âˆ’ ğ·ğ‘– )ğ‘(ğ‘€
ğ‘›
ğ‘›
1
1
Ì‚ ğ‘– , ğ‘‹ğ‘– ))/[ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– )(1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘– ))]
Ì‚ ğ‘– ))
ğ‘› âˆ‘ğ‘–=1 ğ‘Œğ‘– ğ·ğ‘– (1 âˆ’ ğ‘(ğ‘€
ğ‘› âˆ‘ğ‘–=1 ğ‘Œğ‘– (1 âˆ’ ğ·ğ‘– )/(1 âˆ’ ğ‘(ğ‘‹
âˆ’
,
ğ‘›
1 âˆ‘ğ‘› ğ· (1 âˆ’ ğ‘(ğ‘€
1
Ì‚ ğ‘– , ğ‘‹ğ‘– ))/[ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– )(1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘– ))]
Ì‚ ğ‘– ))
ğ‘›
ğ‘› âˆ‘ğ‘–=1 (1 âˆ’ ğ·ğ‘– )/(1 âˆ’ ğ‘(ğ‘‹
ğ‘–=1 ğ‘–
1
ğ‘›

(5)

and the normalized estimators of the indirect effects under treatment and non-treatment correspond to

Ì‚
ğ›¿(1)
=
Ì‚
ğ›¿(0)
=

1
ğ‘›

ğ‘›

Ì‚ ğ‘–)
âˆ‘ğ‘–=1 ğ·ğ‘– ğ‘Œğ‘– /ğ‘(ğ‘‹

1
ğ‘›

ğ‘›

Ì‚ ğ‘– , ğ‘‹ğ‘– ))/[ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– )(1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘– ))]
âˆ‘ğ‘–=1 ğ‘Œğ‘– ğ·ğ‘– (1 âˆ’ ğ‘(ğ‘€

,
ğ‘›
ğ‘›
1
âˆ‘ğ‘–=1 ğ·ğ‘– /ğ‘(ğ‘‹
Ì‚ ğ‘–)
Ì‚ ğ‘– , ğ‘‹ğ‘– ))/[ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– )(1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘– ))]
ğ‘› âˆ‘ğ‘–=1 ğ·ğ‘– (1 âˆ’ ğ‘(ğ‘€
ğ‘›
ğ‘›
1
1
Ì‚ ğ‘– , ğ‘‹ğ‘– )/[(1 âˆ’ ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ))ğ‘(ğ‘‹
Ì‚ ğ‘– )]
Ì‚ ğ‘– ))
ğ‘› âˆ‘ğ‘–=1 ğ‘Œğ‘– (1 âˆ’ ğ·ğ‘– )ğ‘(ğ‘€
ğ‘› âˆ‘ğ‘–=1 ğ‘Œğ‘– (1 âˆ’ ğ·ğ‘– )/(1 âˆ’ ğ‘(ğ‘‹
âˆ’
,
ğ‘›
1 âˆ‘ğ‘› (1 âˆ’ ğ· )ğ‘(ğ‘€
1
Ì‚ ğ‘– , ğ‘‹ğ‘– ))ğ‘(ğ‘‹
Ì‚ ğ‘– )]
Ì‚ ğ‘– ))
ğ‘– Ì‚
ğ‘– , ğ‘‹ğ‘– )/[(1 âˆ’ ğ‘(ğ‘€
ğ‘›
ğ‘› âˆ‘ğ‘–=1 (1 âˆ’ ğ·ğ‘– )/(1 âˆ’ ğ‘(ğ‘‹
ğ‘–=1
1
ğ‘›

âˆ’

(6)

i indexes the observations in an i.i.d. sample of size n. ğ‘(X
Ì‚ i ) and ğ‘(M
Ì‚ i , Xi ) denote estimates of the true propensity scores Pr(D = 1|X = Xi ) and Pr(D = 1|M = Mi , X = Xi ), henceforth abbreviated by p(Xi ) and p(Mi , Xi ),
respectively. In contrast to Huber (2014), we estimate the propensity scores nonparametrically by series logit
estimation (SLE) based on power series as in HIR. Normalized estimators for the indirect effects, denoted by
Ì‚
Ì‚
ğ›¿(1),
ğ›¿(0),
are obtained in an analogous way. See also Appendix A.1 for the normalized estimators of the potential outcomes.
To illustrate the SLE approach consider, for instance, ğ‘(X
Ì‚ i ) and suppose that X contains only continuous
ğ‘‘

variables with dimension dx . Let ğœ† = (ğœ†1 , ..., ğœ†ğ‘‘ğ‘¥ )â€² âˆˆ â„¤+ğ‘¥ be a dx -dimensional vector of non-negative integers
ğ‘‘

ğ‘¥
where â„¤+ denotes the set of non-negative integers, and define the norm for Î» as |ğœ†| = âˆ‘ğ‘—=1
ğœ†ğ‘— . Furthermore,

ğ‘‘

ğ‘¥
ğœ†
let {ğœ†(ğ‘˜)}âˆ
ğ‘˜=1 be a sequence including all distinct ğœ† âˆˆ â„¤+ such that |Î»(k)| is non-decreasing in k and let ğ‘¥ =

ğ‘‘

ğœ†

ğ‘¥
âˆğ‘—=1
ğ‘¥ğ‘— ğ‘— . For any integer Kx , define ğ‘…ğ¾ğ‘¥ (ğ‘¥) = (ğ‘¥ğœ†(1) , ..., ğ‘¥ğœ†(ğ¾ğ‘¥ ) )â€² as a vector of power functions. Denote by â„’(a)

4

Unauthenticated
Download Date | 2/25/19 5:32 PM

DE GRUYTER

Hsu et al.

= exp(a)/(1+exp(a)) the logistic cumulative distribution function (CDF). The SLE for p(x) is defined as ğ‘(ğ‘¥)
Ì‚
=
â„’ (ğ‘…ğ¾ (ğ‘¥)â€² ğœ‹Ì‚ğ¾ ) where

ğœ‹Ì‚ğ¾ğ‘¥ = arg max
ğœ‹
ğ‘˜

1 ğ‘›
âˆ‘ (ğ·ğ‘– ln â„’ (ğ‘…ğ¾ğ‘¥ (ğ‘‹ğ‘– )â€² ğœ‹ğ¾ğ‘¥ ) + (1 âˆ’ ğ·ğ‘– ) ln (1 âˆ’ â„’ (ğ‘…ğ¾ğ‘¥ (ğ‘‹ğ‘– )â€² ğœ‹ğ¾ğ‘¥ ))).
ğ‘› ğ‘–=1

(7)

The asymptotic properties of ğ‘(x)
Ì‚ are discussed in Appendix A of HIR. ğ‘(m,
Ì‚
x) is defined in an analogous way.

3.2 Asymptotic Behaviour
To show root-n-consistency and asymptotic normality of our estimators, we subsequently introduce regularity
conditions that are very much related to those in HIR.
Assumption 4 (distribution of (X, M)):
(i) The distribution of the (dm + dx )-dimensional vector (M, X) is absolutely continuous with probability
density f (m, x); (ii) â„³ and ğ’³ , are Cartesian products of compact intervals; (iii) f (m, x) is twice continuously
differentiable, bounded above, and bounded away from 0 on â„³ Ã— ğ’³ .
Assumption 4 rules out that M and/or X contain any binary or discrete variables, which seems restrictive for
empirical applications. We impose this assumption for the sake of ease of discussion and note that our results
could be easily extended to include discrete covariates and mediators as in Donald, Hsu, and Lieli (2014). See
Section 3.4 for more discussion on this matter.

Automatically generated rough PDF by ProofCheck from River Valley Technologies Ltd

Assumption 5 (smoothness of propensity scores):
(i) p(x) is continuously differentiable of order ğ‘xÌ„ â‰¥ 7dx ; (ii) p(m, x) is continuously differentiable of order ğ‘m
Ì„
â‰¥ 7(dm + dx ).
Assumption 5 is analogous to Assumption 4 of HIR and requires the propensity scores to be sufficiently
smooth.
Assumption 5 requires that p(x) and p(m, x) are continuously differentiable of order ğ‘xÌ„ â‰¥ 7dx and ğ‘m
Ì„ â‰¥
7(dm + dx ), respectively. When the numbers of continuous variables in X and M are large, this condition may
look restrictive in practice, albeit holds in studies assuming parametric specifications of the propensity score
functions such as probit or logit models. On the other hand, if the smoothness condition is a concern in empirical
studies, then one can relax it condition by using local polynomial estimators as in Ichimura and Linton (2005)
and Donald, Hsu and Lieli (2014) or higher order kernel estimators as in Abrevaya, Hsu, and Lieli (2015).
However, a disadvantage of these methods is that the resulting estimated propensity score functions are not
necessarily bounded away from 0 and 1 in finite samples, such that trimming might be required.
Assumption 6 (series estimator):
(i) The SLE of p(x) uses a power series with Kx = nÎ½x for some dx /4(ğ‘xÌ„ âˆ’ dx ) < Î½x < 1/9, ğ¾ğ‘¥3 ğ‘›âˆ’1/2 â†’ 0 and
âˆ’(ğ‘Ì„ğ‘¥ +2ğ‘‘ğ‘¥ )/2ğ‘‘ğ‘¥ 1/4
ğ¾ğ‘¥
ğ‘› â†’ 0; (ii) The SLE of p(m, x) uses a power series with Km = nÎ½m for some (dm + dx )/4(ğ‘xÌ„ âˆ’ dm âˆ’
3 ğ‘›âˆ’1/2 â†’ 0 and ğ¾ âˆ’(ğ‘Ì„ğ‘š +2ğ‘‘ğ‘š +2ğ‘‘ğ‘¥ )/(2ğ‘‘ğ‘š +2ğ‘‘ğ‘¥ ) ğ‘›1/4 â†’ 0.
dx ) < Î½m < 1/9, ğ¾ğ‘š
ğ‘š
Assumption 6 restricts the growth rate of the number of approximating functions to be included in the
series estimator of the propensity score. Note that our assumption is stronger than Assumption 5 of HIR by
requiring that ğ¾ğ‘¥3 ğ‘›âˆ’1/2 â†’ 0 and ğ¾ âˆ’(ğ‘Ì„ x +2dx )/2dx n1/4 â†’ 0, which ensures that supğ‘¥âˆˆğ’³ |ğ‘(x)
Ì‚ âˆ’ p(x)| = op (nâˆ’1/4 ). An
analogous result applies to p(m, x). These extra conditions on power series terms are needed because in contrast
to HIR, our estimation approach is based on two propensity scores. When employing mean-value expansions,
we require that the second order terms are of order op (1), for which supğ‘¥âˆˆğ’³ |ğ‘(ğ‘¥)
Ì‚
âˆ’ ğ‘(ğ‘¥)| = ğ‘œğ‘ (ğ‘›âˆ’1/4 ) and
supğ‘šâˆˆâ„³,ğ‘¥âˆˆğ’³ |ğ‘(ğ‘š,
Ì‚
ğ‘¥) âˆ’ ğ‘(ğ‘š, ğ‘¥)| = ğ‘œğ‘ (ğ‘›âˆ’1/4 ) are sufficient conditions.
We now define several conditional moments related to potential and observed outcomes: Ïddâ€² (x) = E[Y(d,
M(dâ€²))|X = x] and Î¶ d (m, x) = E[Y|M = m, X = x, D = d] for d, dâ€² âˆˆ {0, 1}. Note that
ğœŒ10 (ğ‘¥)

=

ğœŒ01 (ğ‘¥)

=

ğœ1 (ğ‘š, ğ‘¥)

=

ğœ0 (ğ‘š, ğ‘¥)

=

ğ‘(ğ‘€,ğ‘‹)

âˆ£ğ‘‹ = ğ‘¥],
ğ¸[ (1âˆ’ğ·)ğ‘Œ
1âˆ’ğ‘(ğ‘‹) (1âˆ’ğ‘(ğ‘€,ğ‘‹))

1âˆ’ğ‘(ğ‘€,ğ‘‹)
âˆ£ğ‘‹ = ğ‘¥],
ğ‘(ğ‘€,ğ‘‹)
ğ·ğ‘Œ
ğ¸[ ğ‘(ğ‘‹,ğ‘€) âˆ£ğ‘€ = ğ‘š, ğ‘‹ = ğ‘¥],
(1âˆ’ğ·)ğ‘Œ
âˆ£ğ‘€ = ğ‘š, ğ‘‹ = ğ‘¥].
ğ¸[ 1âˆ’ğ‘(ğ‘‹,ğ‘€)
ğ·ğ‘Œ
ğ¸[ ğ‘(ğ‘‹)

Unauthenticated
Download Date | 2/25/19 5:32 PM

5

Hsu et al.

DE GRUYTER

Assumption 7 imposes some regularity conditions on these moments and the second moments of the potential
outcomes.
Assumption 7 (moments of Y):
(i) E[Y] < âˆ; (ii) for d, dâ€² âˆˆ {0, 1}, Ïddâ€² (x) are continuously differentiable over ğ’³ ; (iii) for d = 0, 1, Î¶d (m, x) is
continuously differentiable over â„³ Ã— ğ’³ .
Under our assumptions, nonparametric IPW estimation of the direct and indirect effects using SLE-based
propensity scores is root-n-consistent and asymptotically normal.
Theorem 1 Under Assumptions 1 to 7,
Ì‚ âˆ’ ğœƒ(1)
ğœƒ(1)
â›
â
âœ
Ì‚ âˆ’ ğœƒ(0)âŸ
âœ
âŸ
ğœƒ(0)
ğ·
âœ
âŸ
âˆšğ‘› âœ
âœ
âŸ
â†’ ğ’© (0, ğ’± ),
âŸ
Ì‚
âœ
âŸ
ğ›¿(1)
âˆ’
ğ›¿(1)
âœ
âŸ
Ì‚ âˆ’ ğ›¿(0) â 
â ğ›¿(0)

(8)

Automatically generated rough PDF by ProofCheck from River Valley Technologies Ltd

where V is a 4 Ã— 4 covariance matrix generated by Ïˆ = (ÏˆÎ¸(1) , ÏˆÎ¸(0) , ÏˆÎ´(1) , ÏˆÎ´(0) )â€² with
ğœ“ğœƒ(1) (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) = ğœ“11 (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) âˆ’ ğœ“01 (ğ‘Œ, ğ‘€, ğ·, ğ‘‹),
ğœ“ğœƒ(0) (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) = ğœ“10 (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) âˆ’ ğœ“00 (ğ‘Œ, ğ‘€, ğ·, ğ‘‹),
ğœ“ğ›¿(1) (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) = ğœ“11 (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) âˆ’ ğœ“10 (ğ‘Œ, ğ‘€, ğ·, ğ‘‹),
ğœ“ğ›¿(0) (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) = ğœ“01 (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) âˆ’ ğœ“00 (ğ‘Œ, ğ‘€, ğ·, ğ‘‹),
ğ·ğ‘Œ
ğœŒ (ğ‘‹)
ğœ“11 (ğ‘Œ, ğ‘€, ğ·, ğ‘‹)
=
âˆ’ 11
(ğ· âˆ’ ğ‘(ğ‘‹)) âˆ’ ğœ‡11 ,
ğ‘(ğ‘‹)
ğ‘(ğ‘‹)
(1 âˆ’ ğ·)ğ‘Œ
ğœŒ (ğ‘‹)
ğœ“00 (ğ‘Œ, ğ‘€, ğ·, ğ‘‹)
=
+ 00
(ğ· âˆ’ ğ‘(ğ‘‹)) âˆ’ ğœ‡00 ,
1 âˆ’ ğ‘(ğ‘‹)
1 âˆ’ ğ‘(ğ‘‹)
ğœŒ10 (ğ‘‹)
ğ·ğ‘Œ 1 âˆ’ ğ‘(ğ‘€, ğ‘‹)
+
(ğ· âˆ’ ğ‘(ğ‘‹))
ğœ“10 (ğ‘Œ, ğ‘€, ğ·, ğ‘‹)
=
ğ‘(ğ‘€, ğ‘‹) 1 âˆ’ ğ‘(ğ‘‹)
(1 âˆ’ ğ‘(ğ‘‹))
ğœ1 (ğ‘€, ğ‘‹)
âˆ’
(ğ· âˆ’ ğ‘(ğ‘€, ğ‘‹)) âˆ’ ğœ‡10 ,
ğ‘(ğ‘€, ğ‘‹)(1 âˆ’ ğ‘(ğ‘‹))
(1 âˆ’ ğ·)ğ‘Œ ğ‘(ğ‘€, ğ‘‹) ğœŒ01 (ğ‘‹)
âˆ’
(ğ· âˆ’ ğ‘(ğ‘‹))
ğœ“01 (ğ‘Œ, ğ‘€, ğ·, ğ‘‹)
=
1 âˆ’ ğ‘(ğ‘€, ğ‘‹) ğ‘(ğ‘‹)
ğ‘(ğ‘‹)
ğœ0 (ğ‘€, ğ‘‹)
+
(ğ· âˆ’ ğ‘(ğ‘€, ğ‘‹)) âˆ’ ğœ‡01 ,
(1 âˆ’ ğ‘(ğ‘€, ğ‘‹))ğ‘(ğ‘‹)
and Î¼ddâ€² = E[Y(d, M(dâ€²))] for d, dâ€² âˆˆ {0, 1}.
We note that the expressions in Theorem 1 imply that our estimators attain the semiparametric efficiency
bounds for mediation analysis derived in Tchetgen Tchetgen and Shpitser (2012). Finally, a relevant question for
the practical implementation of the estimator is how to choose orders Kx and Km for propensity score estimation.
In the simulations presented in Section 5, we consider cross-validation for picking either parameter, see, e.g.,
Chapter 15 of Li and Racine (2007). We also consider overfitting by one order higher than suggested by crossvalidation. Even though cross-validation w.r.t. the the functional form of the propensity score does in general
not provide the optimal order for the estimation of direct and indirect effects in a given sample, the simulation
results suggest that this approach can yield satisfactory results in practice.

3.3 Inference
Inference based on the asymptotic results in Theorem 1 requires a consistent estimator of the asymptotic covariance matrix, denoted by ğ’±. We first propose uniformly consistent estimators for Ïddâ€² (x) and Î¶ d (m, x) with
d, dâ€² âˆˆ {0, 1}. Let RKx (x) and RKm (m, x) be the column vectors of power functions used for the estimation of the
propensity score functions and define

6

Unauthenticated
Download Date | 2/25/19 5:32 PM

DE GRUYTER

Hsu et al.

âˆ’1
1 ğ‘› ğ·ğ‘Œ
1 ğ‘›
ğœŒ11
Ì‚ (ğ‘¥) = ( âˆ‘ ğ‘– ğ‘– ğ‘…ğ¾ğ‘¥ (ğ‘‹ğ‘– )â€² )( âˆ‘ ğ‘…ğ¾ğ‘¥ (ğ‘‹ğ‘– )ğ‘…ğ¾ğ‘¥ (ğ‘‹ğ‘– )â€² ) ğ‘…ğ¾ğ‘¥ (ğ‘¥),
ğ‘› ğ‘–=1 ğ‘(ğ‘‹
Ì‚ ğ‘–)
ğ‘› ğ‘–=1
ğ‘›
âˆ’1
1
(1 âˆ’ ğ·ğ‘– )ğ‘Œğ‘– ğ¾
1 ğ‘›
ğœŒ00
Ì‚ (ğ‘¥) = ( âˆ‘
ğ‘… ğ‘¥ (ğ‘‹ğ‘– )â€² )( âˆ‘ ğ‘…ğ¾ğ‘¥ (ğ‘‹ğ‘– )ğ‘…ğ¾ğ‘¥ (ğ‘‹ğ‘– )â€² ) ğ‘…ğ¾ğ‘¥ (ğ‘¥),
ğ‘› ğ‘–=1 1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘–)
ğ‘› ğ‘–=1
âˆ’1
1 ğ‘›
ğ·ğ‘– ğ‘Œ 1 âˆ’ ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ) ğ¾
1 ğ‘›
ğœŒ10
Ì‚ (ğ‘¥) = ( âˆ‘
ğ‘… ğ‘¥ (ğ‘‹ğ‘– )â€² )( âˆ‘ ğ‘…ğ¾ğ‘¥ (ğ‘‹ğ‘– )ğ‘…ğ¾ğ‘¥ (ğ‘‹ğ‘– )â€² ) ğ‘…ğ¾ğ‘¥ (ğ‘¥),
ğ‘› ğ‘–=1 ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ) 1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘–)
ğ‘› ğ‘–=1
âˆ’1
1 ğ‘› (1 âˆ’ ğ·ğ‘– )ğ‘Œ ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ) ğ¾
1 ğ‘›
ğœŒ01
Ì‚ (ğ‘¥) = ( âˆ‘
ğ‘… ğ‘¥ (ğ‘‹ğ‘– )â€² )( âˆ‘ ğ‘…ğ¾ğ‘¥ (ğ‘‹ğ‘– )ğ‘…ğ¾ğ‘¥ (ğ‘‹ğ‘– )â€² ) ğ‘…ğ¾ğ‘¥ (ğ‘¥),
ğ‘› ğ‘–=1 1 âˆ’ ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ) ğ‘(ğ‘‹
Ì‚ ğ‘–)
ğ‘› ğ‘–=1
ğ‘›
âˆ’1
1 ğ‘›
ğ·ğ‘– ğ‘Œğ‘–
1
ğœ1Ì‚ (ğ‘š, ğ‘¥) = ( âˆ‘
ğ‘…ğ¾ğ‘š (ğ‘€ğ‘– , ğ‘‹ğ‘– )â€² )( âˆ‘ ğ‘…ğ¾ğ‘š (ğ‘€ğ‘– , ğ‘‹ğ‘– )ğ‘…ğ¾ğ‘š (ğ‘€ğ‘– , ğ‘‹ğ‘– )â€² ) ğ‘…ğ¾ğ‘š (ğ‘š, ğ‘¥),
ğ‘› ğ‘–=1 ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– )
ğ‘› ğ‘–=1
âˆ’1
1 ğ‘› (1 âˆ’ ğ·ğ‘– )ğ‘Œğ‘– ğ¾
1 ğ‘›
ğœ0Ì‚ (ğ‘š, ğ‘¥) = ( âˆ‘
ğ‘… ğ‘š (ğ‘€ğ‘– , ğ‘‹ğ‘– )â€² )( âˆ‘ ğ‘…ğ¾ğ‘š (ğ‘€ğ‘– , ğ‘‹ğ‘– )ğ‘…ğ¾ğ‘š (ğ‘€ğ‘– , ğ‘‹ğ‘– )â€² ) ğ‘…ğ¾ğ‘š (ğ‘š, ğ‘¥).
ğ‘› ğ‘–=1 1 âˆ’ ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– )
ğ‘› ğ‘–=1

This permits defining the estimated influence functions as

Automatically generated rough PDF by ProofCheck from River Valley Technologies Ltd

Ì‚ (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) =
ğœ“ğœƒ(1)
Ì‚ (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) =
ğœ“ğœƒ(0)
Ì‚ (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) =
ğœ“ğ›¿(1)
Ì‚ (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) =
ğœ“ğ›¿(0)
Ì‚ (ğ‘Œ, ğ‘€, ğ·, ğ‘‹)
ğœ“11

=

Ì‚ (ğ‘Œ, ğ‘€, ğ·, ğ‘‹)
ğœ“00

=

Ì‚ (ğ‘Œ, ğ‘€, ğ·, ğ‘‹)
ğœ“10

=

Ì‚ (ğ‘Œ, ğ‘€, ğ·, ğ‘‹)
ğœ“01

=

Ì‚ (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) âˆ’ ğœ“01
Ì‚ (ğ‘Œ, ğ‘€, ğ·, ğ‘‹),
ğœ“11
Ì‚
Ì‚ (ğ‘Œ, ğ‘€, ğ·, ğ‘‹),
ğœ“10 (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) âˆ’ ğœ“10
Ì‚
Ì‚ (ğ‘Œ, ğ‘€, ğ·, ğ‘‹),
ğœ“01 (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) âˆ’ ğœ“00
Ì‚
Ì‚
ğœ“10 (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) âˆ’ ğœ“00 (ğ‘Œ, ğ‘€, ğ·, ğ‘‹),
ğœŒ Ì‚ (ğ‘‹)
ğ·ğ‘Œ
âˆ’ 11
(ğ· âˆ’ ğ‘(ğ‘‹))
Ì‚
âˆ’ ğœ‡Ì‚11 ,
ğ‘(ğ‘‹)
Ì‚
ğ‘(ğ‘‹)
Ì‚
(1 âˆ’ ğ·)ğ‘Œ
ğœŒ Ì‚ (ğ‘‹)
+ 00
(ğ· âˆ’ ğ‘(ğ‘‹))
Ì‚
âˆ’ ğœ‡Ì‚00 ,
1 âˆ’ ğ‘(ğ‘‹)
Ì‚
1 âˆ’ ğ‘(ğ‘‹)
Ì‚
Ì‚
ğ‘‹)
ğ·ğ‘Œ 1 âˆ’ ğ‘(ğ‘€,
ğœŒ10
Ì‚ (ğ‘‹)
(ğ· âˆ’ ğ‘(ğ‘‹))
Ì‚
+
Ì‚
ğ‘(ğ‘€,
Ì‚
ğ‘‹) 1 âˆ’ ğ‘(ğ‘‹)
(1 âˆ’ ğ‘(ğ‘‹))
Ì‚
ğœ1Ì‚ (ğ‘€, ğ‘‹)
âˆ’
(ğ· âˆ’ ğ‘(ğ‘€,
Ì‚
ğ‘‹)) âˆ’ ğœ‡Ì‚10 ,
ğ‘(ğ‘€,
Ì‚
ğ‘‹)(1 âˆ’ ğ‘(ğ‘‹))
Ì‚
(1 âˆ’ ğ·)ğ‘Œ ğ‘(ğ‘€,
Ì‚
ğ‘‹) ğœŒ01
Ì‚ (ğ‘‹)
âˆ’
(ğ· âˆ’ ğ‘(ğ‘‹))
Ì‚
1 âˆ’ ğ‘(ğ‘€,
Ì‚
ğ‘‹) ğ‘(ğ‘‹)
Ì‚
ğ‘(ğ‘‹)
ğœ0Ì‚ (ğ‘€, ğ‘‹)
+
(ğ· âˆ’ ğ‘(ğ‘€,
Ì‚
ğ‘‹)) âˆ’ ğœ‡Ì‚01 ,
(1 âˆ’ ğ‘(ğ‘€,
Ì‚
ğ‘‹))ğ‘(ğ‘‹)
Ì‚

where
1 ğ‘› ğ·ğ‘– ğ‘Œğ‘– 1 ğ‘› ğ·ğ‘–
1 ğ‘› (1 âˆ’ ğ·ğ‘– )ğ‘Œğ‘– 1 ğ‘› (1 âˆ’ ğ·ğ‘– )
âˆ‘
/ âˆ‘
, ğœ‡Ì‚00 = âˆ‘
/ âˆ‘
,
ğ‘› ğ‘–=1 ğ‘(ğ‘‹
Ì‚ ğ‘– ) ğ‘› ğ‘–=1 ğ‘(ğ‘‹
Ì‚ ğ‘–)
ğ‘› ğ‘–=1 1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘– ) ğ‘› ğ‘–=1 1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘–)
ğ·ğ‘– ğ‘Œğ‘– 1 âˆ’ ğ‘(ğ‘€
ğ·ğ‘–
1 ğ‘›
Ì‚ ğ‘– , ğ‘‹ğ‘– ) 1 ğ‘›
1 âˆ’ ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– )
= âˆ‘
/ âˆ‘
,
ğ‘› ğ‘–=1 ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ) 1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘–)
ğ‘› ğ‘–=1 ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ) 1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘–)

ğœ‡Ì‚11 =
ğœ‡Ì‚10

ğœ‡Ì‚01 =

1
ğ‘›

ğ‘›

(1âˆ’ğ·ğ‘– )ğ‘Œğ‘–
âˆ‘ğ‘–=1 1âˆ’
ğ‘(ğ‘€
Ì‚
,ğ‘‹ )
ğ‘–

ğ‘–

ğ‘(ğ‘€
Ì‚ ğ‘– ,ğ‘‹ğ‘– )
/ ğ‘›1
ğ‘(ğ‘‹
Ì‚ ğ‘–)

ğ‘›

ğ‘–)
âˆ‘ğ‘–=1 1âˆ’(1âˆ’ğ·
ğ‘(ğ‘€
Ì‚
,ğ‘‹ )
ğ‘–

ğ‘–

ğ‘(ğ‘€
Ì‚ ğ‘– ,ğ‘‹ğ‘– )
.
ğ‘(ğ‘‹
Ì‚ ğ‘–)

Ì‚
Ì‚
Ì‚
Ì‚
Furthermore, define ğœ“iÌ‚ = (ğœ“Î¸(1),i
, ğœ“Î¸(0),i
, ğœ“Î´(1),i
, ğœ“Î´(0),i
)â€² with
Ì‚
Ì‚ (ğ‘Œğ‘– , ğ‘€ğ‘– , ğ·ğ‘– , ğ‘‹ğ‘– ) âˆ’ ğœ“01
Ì‚ (ğ‘Œğ‘– , ğ‘€ğ‘– , ğ·ğ‘– , ğ‘‹ğ‘– ),
ğœ“ğœƒ(1),ğ‘–
= ğœ“11
Ì‚
Ì‚
Ì‚ (ğ‘Œğ‘– , ğ‘€ğ‘– , ğ·ğ‘– , ğ‘‹ğ‘– ),
ğœ“ğœƒ(0),ğ‘– = ğœ“10 (ğ‘Œğ‘– , ğ‘€ğ‘– , ğ·ğ‘– , ğ‘‹ğ‘– ) âˆ’ ğœ“00
Ì‚
Ì‚
Ì‚
ğœ“ğ›¿(1),ğ‘– = ğœ“11 (ğ‘Œğ‘– , ğ‘€ğ‘– , ğ·ğ‘– , ğ‘‹ğ‘– ) âˆ’ ğœ“10 (ğ‘Œğ‘– , ğ‘€ğ‘– , ğ·ğ‘– , ğ‘‹ğ‘– ),
Ì‚
Ì‚ (ğ‘Œğ‘– , ğ‘€ğ‘– , ğ·ğ‘– , ğ‘‹ğ‘– ) âˆ’ ğœ“00
Ì‚ (ğ‘Œğ‘– , ğ‘€ğ‘– , ğ·ğ‘– , ğ‘‹ğ‘– ).
ğœ“ğ›¿(0),ğ‘–
= ğœ“01
ğ‘

Ì‚ â†’ ğ’± . The details are
Ì‚ = ğ‘›âˆ’1 âˆ‘ğ‘› ğœ“ğ‘–Ì‚ ğœ“ğ‘–â€²Ì‚ . By the same arguments as in HIR, one can show that ğ‘‰
Finally, let ğ’±
ğ‘–=1
therefore omitted.
We also note that given the asymptotic normality of our estimators, the bootstrap is a consistent inference
method, too, and is used in our simulations [see Section (5)] and application [see Section (6)]. To be specific, we
draw bootstrap samples of size n with replacement. We then estimate the propensity scores with the same orders
Kx and Km as chosen in the original sample for effect estimation and compute the direct and indirect effects in
Unauthenticated
Download Date | 2/25/19 5:32 PM

7

Hsu et al.

DE GRUYTER

the bootstrap samples using the bootstrap estimates of the propensity scores. Then, the limiting distribution of
Ì‚ âˆ’ ğœƒ(1)), for instance, can be approximated by âˆšğ‘›(ğœƒğ‘Ì‚ (1) âˆ’ 1 âˆ‘ğµ ğœƒğ‘Ì‚ (1)) with superscript b indicating a
âˆšğ‘›(ğœƒ(1)
ğ‘=1
ğµ
bootstrap estimate and B denoting the number of bootstrap samples. This allows computing the standard error
Ì‚ by the standard deviation of ğœƒbÌ‚ (1) across all bootstrap samples B.
of ğœƒ(1)

3.4 Incorporating Discrete Covariates and Mediators
Our theory only considers the case in which X and M are vectors of continuous variables. We subsequently
discuss the implications of having discrete variables among the covariates and/or mediators. We to this end
Ìƒ satisfying ğ‘¥ Ìƒ âˆˆ {0, 1} to be included in the condiassume that on top of X, there exists an additional covariate ğ‘‹
tioning set. Even though we focus on this binary case, we note that it easily extends to more general cases with
Ìƒ and
discrete variables. For estimating the propensity score ğ‘(x,
Ì‚ ğ‘¥),
Ìƒ we stratify the sample on the values of ğ‘‹
Ìƒ
Ìƒ
perform SLE as outlined in equation (7) separately in the subsamples satisfying ğ‘‹ i = 1 and ğ‘‹ i = 0, respectively,
Ì‚ and ğ›¿(d)
Ì‚ for d âˆˆ {0, 1}, we
for all i âˆˆ 1, â€¦, n. Estimation of ğ‘(m,
Ì‚
x, ğ‘¥)Ìƒ proceeds analogously. Finally, to obtain ğœƒ(d)
replace ğ‘(x)
Ì‚ and ğ‘(ğ‘š,
Ì‚
ğ‘¥, ğ‘¥)Ìƒ by ğ‘(ğ‘¥,
Ì‚ ğ‘¥)Ìƒ and ğ‘(ğ‘š,
Ì‚
ğ‘¥, ğ‘¥)Ìƒ in (5) and (6), respectively. Concerning the regularity conditions, we note that while ğ‘‹Ìƒ needs to be added to the conditioning set, dx and dm continue to denote the numbers
of continuous variables in X and M, respectively. Therefore, Assumption 4, for instance, remains valid, as well
as all the other results required for asymptotic normality.
However, stratifying on all possible combinations of discrete variables may in the case of a large number of
strata entail the practical issue that the numbers of observations in some strata are very small (or zero) even for
large n. In such cases, functional form restrictions on SLE might be imposed as in Donald, Hsu, and Lieli (2014)
to mitigate such issues related to the curse of dimensionality. Firstly, one approach is to allow lower order terms
in RKx (X) of equation (7) â€“ i.e. up to some lower order L < Kx â€“ to vary across strata, while higher order terms
are assumed to be homogenous across strata (and thus to be estimated in the total sample). Secondly, one may
rule out specific interactions between discrete variables to reduce the dimension of strata. To see this, suppose
that the set of covariates is (Xâ€², ğ‘‹Ìƒ 1 , ğ‘‹Ìƒ 2 ) where ğ‘‹Ìƒ 1 and ğ‘‹Ìƒ 2 are two binary variable, implying four strata defined
by the values of ğ‘‹Ìƒ 1 and ğ‘‹Ìƒ 2 . One may implement the SLE separately for subsamples with ğ‘‹Ìƒ 1ğ‘– = ğ‘‹Ìƒ 2ğ‘– = 0, ğ‘‹Ìƒ 1ğ‘– = 1,
and ğ‘‹Ìƒ 2ğ‘– = 1, while not considering the finer strata ğ‘‹Ìƒ 1ğ‘– = ğ‘‹Ìƒ 2ğ‘– = 1, (ğ‘‹Ìƒ 1ğ‘– = 0, ğ‘‹Ìƒ 2ğ‘– = 1), (ğ‘‹Ìƒ 1ğ‘– = 1, ğ‘‹Ìƒ 2ğ‘– = 0). This rules
out interactions between ğ‘‹Ìƒ 1 and ğ‘‹Ìƒ 2 w.r.t. their effect on the probability of D = 1. These two types of restrictions
may be combined and do not affect the asymptotic theory if the restrictions are removed as n grows large.

Automatically generated rough PDF by ProofCheck from River Valley Technologies Ltd

4 Weighted Direct and Indirect Effects
4.1 Identiï¬cation of Weighted Effects
In this section, we discuss the identification, estimation, and asymptotic results for weighted effects. Let to
this end g(X) denote a weighting function that depends on X or subsets thereof and satisfies |g(X)| < âˆ and
E[g(X)] > 0. Weighted direct and indirect effects as well as mean potential outcomes (denoted as Î¸g (d), Î´g (d),
Eg [Y(d, M(dâ€²))]) are identified by including g(X)/E[g(X)] in the respective expectation operators presented in
(4):
ğ‘”(ğ‘‹)
ğ‘Œğ·
ğ‘Œ(1 âˆ’ ğ·)
Pr(ğ· = ğ‘‘|ğ‘€, ğ‘‹)
(
âˆ’
)
],
ğ¸[ğ‘”(ğ‘‹)] Pr(ğ· = 1|ğ‘€, ğ‘‹) 1 âˆ’ Pr(ğ· = 1|ğ‘€, ğ‘‹)
Pr(ğ· = ğ‘‘|ğ‘‹)
ğ‘”(ğ‘‹)
ğ‘Œğ¼{ğ· = ğ‘‘}
Pr(ğ· = 1|ğ‘€, ğ‘‹) 1 âˆ’ Pr(ğ· = 1|ğ‘€, ğ‘‹)
ğ›¿ğ‘” (ğ‘‘) = ğ¸ [
(
âˆ’
)] .
ğ¸[ğ‘”(ğ‘‹)] Pr(ğ· = ğ‘‘|ğ‘€, ğ‘‹)
Pr(ğ· = 1|ğ‘‹)
1 âˆ’ Pr(ğ· = 1|ğ‘‹)
â€²
ğ‘Œğ¼{ğ· = ğ‘‘} Pr(ğ· = ğ‘‘ |ğ‘€, ğ‘‹)
ğ‘”(ğ‘‹)
] for ğ‘‘, ğ‘‘â€² âˆˆ {1, 0}.
ğ¸ğ‘” [ğ‘Œ(ğ‘‘, ğ‘€(ğ‘‘â€² ))] = ğ¸ [
ğ¸[ğ‘”(ğ‘‹)] Pr(ğ· = ğ‘‘|ğ‘€, ğ‘‹) Pr(ğ· = ğ‘‘â€² |ğ‘‹)
ğœƒğ‘” (ğ‘‘)

=

ğ¸[

(9)

This allows identifying the effects for specific subgroups of interest. For instance, setting g(X) = p(X) with E[g(X)]
= Pr(D = 1) yields the direct and indirect effects as well as the potential outcomes among the treated. To see
this, consider Eg [Y(d, M(dâ€²))] = E[Y(d, M(dâ€²))|D = 1] and note that (when M, X are continuous),

8

Unauthenticated
Download Date | 2/25/19 5:32 PM

DE GRUYTER

ğ¸[

Hsu et al.

ğ‘(ğ‘‹)
ğ‘Œğ¼{ğ· = ğ‘‘} Pr(ğ· = ğ‘‘â€² |ğ‘€, ğ‘‹)
]
ğ¸[ğ‘(ğ‘‹)] Pr(ğ· = ğ‘‘|ğ‘€, ğ‘‹) Pr(ğ· = ğ‘‘â€² |ğ‘‹)
ğ‘(ğ‘‹)
ğ‘Œğ¼{ğ· = ğ‘‘}
Pr(ğ· = ğ‘‘â€² |ğ‘€, ğ‘‹)
= ğ¸[
ğ¸ [ğ¸ [
âˆ£ğ‘€ = ğ‘š, ğ‘‹ = ğ‘¥]
âˆ£ğ‘‹ = ğ‘¥]]
Pr(ğ· = 1)
Pr(ğ· = ğ‘‘|ğ‘€, ğ‘‹)
Pr(ğ· = ğ‘‘â€² |ğ‘‹)
â€²
Pr(ğ· = ğ‘‘ |ğ‘€, ğ‘‹)
ğ‘(ğ‘‹)
ğ¸[ğ‘Œ|ğ· = ğ‘‘, ğ‘€ = ğ‘š, ğ‘‹ = ğ‘¥]
ğ‘‘ğ¹ğ‘€|ğ‘‹=ğ‘¥ (ğ‘š)ğ‘‘ğ¹ğ‘‹ (ğ‘¥)
=
âˆ« Pr(ğ· = 1) âˆ«
Pr(ğ· = ğ‘‘â€² |ğ‘‹)
ğ‘(ğ‘‹)
=
ğ¸[ğ‘Œ(ğ‘‘, ğ‘š)|ğ· = ğ‘‘, ğ‘€ = ğ‘š, ğ‘‹ = ğ‘¥]ğ‘‘ğ¹ğ‘€|ğ·=ğ‘‘â€² ,ğ‘‹=ğ‘¥ (ğ‘š)ğ‘‘ğ¹ğ‘‹ (ğ‘¥)
âˆ« Pr(ğ· = 1) âˆ«
ğ‘(ğ‘‹)
=
ğ¸[ğ‘Œ(ğ‘‘, ğ‘š)|ğ‘€(ğ‘‘â€² ) = ğ‘š, ğ‘‹ = ğ‘¥]ğ‘‘ğ¹ğ‘€(ğ‘‘â€² )|ğ‘‹=ğ‘¥ (ğ‘š)ğ‘‘ğ¹ğ‘‹ (ğ‘¥)
âˆ« Pr(ğ· = 1) âˆ«
ğ‘(ğ‘‹)
=
ğ¸[ğ‘Œ(ğ‘‘, ğ‘€(ğ‘‘â€² ))|ğ‘‹ = ğ‘¥]
ğ‘‘ğ¹ (ğ‘¥)
âˆ«
Pr(ğ· = 1) ğ‘‹

(10)

ğ¸[ğ‘Œ(ğ‘‘, ğ‘€(ğ‘‘â€² ))|ğ‘‹ = ğ‘¥]ğ‘‘ğ¹ğ‘‹|ğ·=1 (ğ‘¥)
âˆ«
= ğ¸[ğ‘Œ(ğ‘‘, ğ‘€(ğ‘‘â€² ))|ğ· = 1].
=

The first equation follows from the law of iterated expectations, the second from basic probability theory and
replacing expectations by integrals, the third and sixth from Bayesâ€™ theorem, the fourth from Assumption 1 and
Assumption 2, and the fifth and seventh from integration. Analogously, the parameters for the nontreated are
obtained by setting g(X) = 1 âˆ’ p(X). Furthermore, this approach can be used to asses effect heterogeneity w.r.t.
X, e.g. by defining g(X) as an indicator function that X takes particular (ranges of) values.

4.2 Estimation and Asymptotics Under Known Weighting Functions

Automatically generated rough PDF by ProofCheck from River Valley Technologies Ltd

Based on (9), we propose the following estimators for a known weighting function g(X):

ğœƒğ‘”Ì‚ (1)

=

ğœƒğ‘”Ì‚ (0)

=

ğ›¿ğ‘”Ì‚ (1) =
ğ›¿ğ‘”Ì‚ (0) =

1
ğ‘›

ğ‘›

âˆ‘ğ‘–=1 ğ‘”(ğ‘‹ğ‘– )ğ‘Œğ‘– ğ·ğ‘– /ğ‘(ğ‘‹
Ì‚ ğ‘–)
1
ğ‘›

ğ‘›

âˆ’

1
ğ‘›

ğ‘›

âˆ‘ğ‘–=1 ğ‘”(ğ‘‹ğ‘– )ğ‘Œğ‘– (1 âˆ’ ğ·ğ‘– )ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– )/[(1 âˆ’ ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ))ğ‘(ğ‘‹
Ì‚ ğ‘– )]
ğ‘›

1
âˆ‘ğ‘–=1 ğ‘”(ğ‘‹ğ‘– )ğ·ğ‘– /ğ‘(ğ‘‹
Ì‚ ğ‘–)
Ì‚ ğ‘– , ğ‘‹ğ‘– )/[(1 âˆ’ ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ))ğ‘(ğ‘‹
Ì‚ ğ‘– )]
ğ‘› âˆ‘ğ‘–=1 ğ‘”(ğ‘‹ğ‘– )(1 âˆ’ ğ·ğ‘– )ğ‘(ğ‘€
ğ‘›
1 âˆ‘
1 âˆ‘ğ‘› ğ‘”(ğ‘‹ )ğ‘Œ (1 âˆ’ ğ· )/(1 âˆ’ ğ‘(ğ‘‹
ğ‘”(ğ‘‹
)ğ‘Œ
ğ·
(1
âˆ’
ğ‘(ğ‘€
Ì‚
,
ğ‘‹
))/[
ğ‘(ğ‘€
Ì‚
,
ğ‘‹
)(1
âˆ’
ğ‘(ğ‘‹
Ì‚
))]
Ì‚ ğ‘– ))
ğ‘–
ğ‘– ğ‘–
ğ‘–
ğ‘–
ğ‘–
ğ‘–
ğ‘–
ğ‘–
ğ‘–
ğ‘–
ğ‘›
ğ‘›
ğ‘–=1
ğ‘–=1
âˆ’
,
ğ‘›
ğ‘›
1
1
Ì‚ ğ‘– , ğ‘‹ğ‘– ))/[ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– )(1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘– ))]
Ì‚ ğ‘– ))
ğ‘› âˆ‘ğ‘–=1 ğ‘”(ğ‘‹ğ‘– )ğ·ğ‘– (1 âˆ’ ğ‘(ğ‘€
ğ‘› âˆ‘ğ‘–=1 (1 âˆ’ ğ·ğ‘– )/(1 âˆ’ ğ‘(ğ‘‹
(11)
ğ‘›
ğ‘›
1
1
Ì‚ ğ‘–)
Ì‚ ğ‘– , ğ‘‹ğ‘– ))/[ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– )(1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘– ))]
ğ‘› âˆ‘ğ‘–=1 ğ‘”(ğ‘‹ğ‘– )ğ·ğ‘– ğ‘Œğ‘– /ğ‘(ğ‘‹
ğ‘› âˆ‘ğ‘–=1 ğ‘”(ğ‘‹ğ‘– )ğ‘Œğ‘– ğ·ğ‘– (1 âˆ’ ğ‘(ğ‘€
âˆ’ 1 ğ‘›
,
ğ‘›
1
Ì‚ ğ‘–)
Ì‚ ğ‘– , ğ‘‹ğ‘– ))/[ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– )(1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘– ))]
ğ‘› âˆ‘ğ‘–=1 ğ‘”(ğ‘‹ğ‘– )ğ·ğ‘– /ğ‘(ğ‘‹
ğ‘› âˆ‘ğ‘–=1 ğ‘”(ğ‘‹ğ‘– )ğ·ğ‘– (1 âˆ’ ğ‘(ğ‘€
ğ‘›
ğ‘›
1
1
Ì‚ ğ‘– , ğ‘‹ğ‘– )/[(1 âˆ’ ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ))ğ‘(ğ‘‹
Ì‚ ğ‘– )]
Ì‚ ğ‘– ))
ğ‘› âˆ‘ğ‘–=1 ğ‘”(ğ‘‹ğ‘– )ğ‘Œğ‘– (1 âˆ’ ğ·ğ‘– )ğ‘(ğ‘€
ğ‘› âˆ‘ğ‘–=1 ğ‘”(ğ‘‹ğ‘– )ğ‘Œğ‘– (1 âˆ’ ğ·ğ‘– )/(1 âˆ’ ğ‘(ğ‘‹
âˆ’
,
ğ‘›
1 âˆ‘ğ‘› ğ‘”(ğ‘‹ )(1 âˆ’ ğ· )ğ‘(ğ‘€
1
Ì‚ ğ‘– , ğ‘‹ğ‘– ))ğ‘(ğ‘‹
Ì‚ ğ‘– )]
Ì‚ ğ‘– ))
ğ‘–
ğ‘– Ì‚
ğ‘– , ğ‘‹ğ‘– )/[(1 âˆ’ ğ‘(ğ‘€
ğ‘›
ğ‘› âˆ‘ğ‘–=1 ğ‘”(ğ‘‹ğ‘– )(1 âˆ’ ğ·ğ‘– )/(1 âˆ’ ğ‘(ğ‘‹
ğ‘–=1

Under our previously discussed assumptions, nonparametric IPW estimation of the direct and indirect effects
using SLE-based propensity scores are root-n-consistent and asymptotically normal.
Theorem 2
Suppose that |g(x)| in uniformaly bounded on ğ’³ and E[g(X)] > 0. Under Assumption 1 to Assumption 7,
ğœƒğ‘”Ì‚ (1) âˆ’ ğœƒğ‘” (1)
â
â›
âœ
âŸ
âœ
ğœƒğ‘”Ì‚ (0) âˆ’ ğœƒğ‘” (0)âŸ
ğ·
âŸâ†’
âœ
âˆšğ‘› âœ
âŸ ğ’© (0, ğ’±ğ‘” )
âœ ğ›¿ Ì‚ (1) âˆ’ ğ›¿ (1) âŸ
âŸ
âœ
ğ‘”
âŸ
âœ ğ‘”
â ğ›¿ğ‘”Ì‚ (0) âˆ’ ğ›¿ğ‘” (0) â 

(12)

where Vg is a 4 Ã— 4 covariance matrix generated by Ïˆg = (ÏˆÎ¸g (1) , ÏˆÎ¸g (0) , ÏˆÎ´g (1) , ÏˆÎ´g (0) )â€² with

Unauthenticated
Download Date | 2/25/19 5:32 PM

9

Hsu et al.

DE GRUYTER

ğœ“ğœƒğ‘” (1) (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) = ğœ“11,ğ‘” (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) âˆ’ ğœ“01,ğ‘” (ğ‘Œ, ğ‘€, ğ·, ğ‘‹)
ğœ“ğœƒğ‘” (0) (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) = ğœ“10,ğ‘” (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) âˆ’ ğœ“00,ğ‘” (ğ‘Œ, ğ‘€, ğ·, ğ‘‹)
ğœ“ğ›¿ğ‘” (1) (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) = ğœ“11,ğ‘” (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) âˆ’ ğœ“10,ğ‘” (ğ‘Œ, ğ‘€, ğ·, ğ‘‹)
ğœ“ğ›¿ğ‘” (0) (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) = ğœ“01,ğ‘” (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) âˆ’ ğœ“00,ğ‘” (ğ‘Œ, ğ‘€, ğ·, ğ‘‹)
ğ·ğ‘Œ
ğœŒ (ğ‘‹)
ğ‘”(ğ‘‹)
(
âˆ’ 11
(ğ· âˆ’ ğ‘(ğ‘‹)) âˆ’ ğœ‡11,ğ‘” ),
ğœ“11,ğ‘” (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) =
ğ¸[ğ‘”(ğ‘‹)] ğ‘(ğ‘‹)
ğ‘(ğ‘‹)
ğœŒ (ğ‘‹)
ğ‘”(ğ‘‹) (1 âˆ’ ğ·)ğ‘Œ
(
+ 00
(ğ· âˆ’ ğ‘(ğ‘‹)) âˆ’ ğœ‡00,ğ‘” ),
ğœ“00,ğ‘” (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) =
ğ¸[ğ‘”(ğ‘‹)] 1 âˆ’ ğ‘(ğ‘‹)
1 âˆ’ ğ‘(ğ‘‹)
ğ‘”(ğ‘‹)
ğœŒ10 (ğ‘‹)
ğ·ğ‘Œ 1 âˆ’ ğ‘(ğ‘€, ğ‘‹)
ğœ“10,ğ‘” (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) =
(
+
(ğ· âˆ’ ğ‘(ğ‘‹))
ğ¸[ğ‘”(ğ‘‹)] ğ‘(ğ‘€, ğ‘‹) 1 âˆ’ ğ‘(ğ‘‹)
(1 âˆ’ ğ‘(ğ‘‹))
ğœ1 (ğ‘€, ğ‘‹)
âˆ’
(ğ· âˆ’ ğ‘(ğ‘€, ğ‘‹)) âˆ’ ğœ‡10,ğ‘” ),
ğ‘ƒ(ğ‘€, ğ‘‹)(1 âˆ’ ğ‘ƒ(ğ‘‹))
ğ‘”(ğ‘‹)
(1 âˆ’ ğ·)ğ‘Œ ğ‘(ğ‘€, ğ‘‹) ğœŒ01 (ğ‘‹)
ğœ“01,ğ‘” (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) =
(
âˆ’
(ğ· âˆ’ ğ‘(ğ‘‹))
ğ¸[ğ‘”(ğ‘‹)] 1 âˆ’ ğ‘(ğ‘€, ğ‘‹) ğ‘(ğ‘‹)
ğ‘(ğ‘‹)
ğœ0 (ğ‘€, ğ‘‹)
+
(ğ· âˆ’ ğ‘(ğ‘€, ğ‘‹)) âˆ’ ğœ‡01,ğ‘” ),
(1 âˆ’ ğ‘(ğ‘€, ğ‘‹))ğ‘(ğ‘‹)
where Î¼ddâ€²,g = E[g(X)Y(d, M(dâ€²))]/E[g(X)] for d, dâ€² âˆˆ {0, 1}.
Inference for weighted effects can be performed in a similar way as outlined in Section 3.3.

4.3 Effects on the Treated with Estimated Propensity Scores

Automatically generated rough PDF by ProofCheck from River Valley Technologies Ltd

In this section, we discuss the estimation and asymptotic results for the subgroup of treated. Note that if the
propensity score p(X) was known, the results of Section 4.2 with g(X) = p(X) would immediately apply. However,
practically more relevant is the case that p(X) is unknown and needs to be estimated, which is considered in
this section. We denote by ğœƒtÌ‚ (d) and ğ›¿tÌ‚ (d) estimates of the direct and indirect effects among the treated, Î¸t (d)
=E[Y(1, M(d)) âˆ’ Y(0, M(d))|D = 1] and Î´t (d) = E[Y(d, M(1)) âˆ’ Y(d, M(0))|D = 1], respectively.
The normalized sample analogs of the effects in (9) with an unknown weighting function g(X) = p(X) correspond to:

ğœƒğ‘¡Ì‚ (1) =
ğœƒğ‘¡Ì‚ (0) =

ğ›¿ğ‘¡Ì‚ (1) =
ğ›¿ğ‘¡Ì‚ (0) =

1
ğ‘›

ğ‘›

âˆ‘ğ‘–=1 ğ‘Œğ‘– ğ·ğ‘–
1
ğ‘›

ğ‘›

âˆ’

1
ğ‘›

ğ‘›

âˆ‘ğ‘–=1 ğ‘Œğ‘– (1 âˆ’ ğ·ğ‘– )ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– )/(1 âˆ’ ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ))
ğ‘›

1
âˆ‘ğ‘–=1 ğ·ğ‘–
Ì‚ ğ‘– , ğ‘‹ğ‘– )/(1 âˆ’ ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ))
ğ‘› âˆ‘ğ‘–=1 (1 âˆ’ ğ·ğ‘– )ğ‘(ğ‘€
1 âˆ‘ğ‘› ğ‘Œ ğ· (1 âˆ’ ğ‘(ğ‘€
Ì‚
,
ğ‘‹
))(
ğ‘(ğ‘‹
Ì‚
))/[
ğ‘(ğ‘€
Ì‚
,
ğ‘‹
)(1
âˆ’
ğ‘(ğ‘‹
Ì‚ ğ‘– ))]
ğ‘–
ğ‘–
ğ‘–
ğ‘–
ğ‘–
ğ‘›
ğ‘–=1 ğ‘– ğ‘–

,

ğ‘›
1
Ì‚ ğ‘– , ğ‘‹ğ‘– ))(ğ‘(ğ‘‹
Ì‚ ğ‘– ))/[ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– )(1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘– ))]
ğ‘› âˆ‘ğ‘–=1 ğ·ğ‘– (1 âˆ’ ğ‘(ğ‘€
1 âˆ‘ğ‘› ğ‘Œ (1 âˆ’ ğ· )(ğ‘(ğ‘‹
Ì‚
))/(1
âˆ’
ğ‘(ğ‘‹
Ì‚
))
ğ‘–
ğ‘–
ğ‘–
ğ‘–
ğ‘›
âˆ’ 1 ğ‘–=1
,
ğ‘›
âˆ‘
(1
âˆ’
ğ·
)(
ğ‘(ğ‘‹
Ì‚
))/(1
âˆ’
ğ‘(ğ‘‹
Ì‚
))
ğ‘–
ğ‘–
ğ‘–
ğ‘›
ğ‘–=1
ğ‘›
ğ‘›
1
1
Ì‚ ğ‘– , ğ‘‹ğ‘– ))(ğ‘(ğ‘‹
Ì‚ ğ‘– ))/[ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– )(1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘– ))]
ğ‘› âˆ‘ğ‘–=1 ğ·ğ‘– ğ‘Œğ‘–
ğ‘› âˆ‘ğ‘–=1 ğ‘Œğ‘– ğ·ğ‘– (1 âˆ’ ğ‘(ğ‘€
,
âˆ’ 1 ğ‘›
1 âˆ‘ğ‘› ğ·
Ì‚ ğ‘– , ğ‘‹ğ‘– ))(ğ‘(ğ‘‹
Ì‚ ğ‘– ))/[ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– )(1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘– ))]
ğ‘›
ğ‘› âˆ‘ğ‘–=1 ğ·ğ‘– (1 âˆ’ ğ‘(ğ‘€
ğ‘–=1 ğ‘–
ğ‘›
ğ‘›
1
1
Ì‚ ğ‘– , ğ‘‹ğ‘– )/(1 âˆ’ ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ))
Ì‚ ğ‘– ))/(1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘– ))
ğ‘› âˆ‘ğ‘–=1 ğ‘Œğ‘– (1 âˆ’ ğ·ğ‘– )ğ‘(ğ‘€
ğ‘› âˆ‘ğ‘–=1 ğ‘Œğ‘– (1 âˆ’ ğ·ğ‘– )(ğ‘(ğ‘‹
âˆ’
,
ğ‘›
ğ‘›
1 âˆ‘
1
Ì‚ ğ‘– , ğ‘‹ğ‘– )/(1 âˆ’ ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ))
Ì‚ ğ‘– ))/(1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘– ))
ğ‘›
ğ‘› âˆ‘ğ‘–=1 (1 âˆ’ ğ·ğ‘– )(ğ‘(ğ‘‹
ğ‘–=1 (1 âˆ’ ğ·ğ‘– )ğ‘(ğ‘€

(13)

Under the same assumptions as before, nonparametric IPW estimation of the direct and indirect effects among
the treated based on SLE-based propensity scores is root-n-consistent and asymptotically normal.
Theorem 3
Under Assumptions 1 to 7,
ğœƒğ‘¡Ì‚ (1) âˆ’ ğœƒğ‘¡ (1)
â
â›
âœ
âŸ
âœğœƒğ‘¡Ì‚ (0) âˆ’ ğœƒğ‘¡ (0)âŸ
ğ·
âŸ
âˆšğ‘› âœ
âŸ
âœ
â†’ ğ’© (0, ğ’±ğ‘¡ )
âŸ
âœ
Ì‚
âŸ
âœ
ğ›¿
(1)
âˆ’
ğ›¿
(1)
âŸ
âœ ğ‘¡
ğ‘¡
â ğ›¿ğ‘¡Ì‚ (0) âˆ’ ğ›¿ğ‘¡ (0) â 

(14)

where Vt is a 4 Ã— 4 covariance matrix generated by Ïˆt = (ÏˆÎ¸t (1) , ÏˆÎ¸t (0) , ÏˆÎ´t (1) , ÏˆÎ´t (0) )â€² with
10

Unauthenticated
Download Date | 2/25/19 5:32 PM

DE GRUYTER

ğœ“ğœƒğ‘¡ (1) (ğ‘Œ, ğ‘€, ğ·, ğ‘‹)
ğœ“ğœƒğ‘¡ (0) (ğ‘Œ, ğ‘€, ğ·, ğ‘‹)
ğœ“ğ›¿ğ‘¡ (1) (ğ‘Œ, ğ‘€, ğ·, ğ‘‹)
ğœ“ğ›¿ğ‘¡ (0) (ğ‘Œ, ğ‘€, ğ·, ğ‘‹)
ğœ“11,ğ‘¡ (ğ‘Œ, ğ‘€, ğ·, ğ‘‹)
ğœ“00,ğ‘¡ (ğ‘Œ, ğ‘€, ğ·, ğ‘‹)
ğœ“10,ğ‘¡ (ğ‘Œ, ğ‘€, ğ·, ğ‘‹)

ğœ“01,ğ‘¡ (ğ‘Œ, ğ‘€, ğ·, ğ‘‹)

Hsu et al.

= ğœ“11,ğ‘¡ (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) âˆ’ ğœ“01,ğ‘¡ (ğ‘Œ, ğ‘€, ğ·, ğ‘‹)
= ğœ“10,ğ‘¡ (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) âˆ’ ğœ“00,ğ‘¡ (ğ‘Œ, ğ‘€, ğ·, ğ‘‹)
= ğœ“11,ğ‘¡ (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) âˆ’ ğœ“10,ğ‘¡ (ğ‘Œ, ğ‘€, ğ·, ğ‘‹)
= ğœ“01,ğ‘¡ (ğ‘Œ, ğ‘€, ğ·, ğ‘‹) âˆ’ ğœ“00,ğ‘¡ (ğ‘Œ, ğ‘€, ğ·, ğ‘‹)
1
=
(ğ·(ğ‘Œ âˆ’ ğœ‡11,ğ‘¡ )),
ğ¸[ğ‘(ğ‘‹)]
1
ğ‘(ğ‘‹)(1 âˆ’ ğ·)(ğ‘Œ âˆ’ ğœŒ00 (ğ‘‹))
=
(
+ (ğœŒ00 (ğ‘‹) âˆ’ ğœ‡00,ğ‘¡ )ğ·),
ğ¸[ğ‘(ğ‘‹)]
1 âˆ’ ğ‘(ğ‘‹)
1
ğ‘(ğ‘‹)ğ·ğ‘Œ 1 âˆ’ ğ‘(ğ‘€, ğ‘‹)
ğœŒ (ğ‘‹)
=
(
+ 10
(ğ· âˆ’ ğ‘(ğ‘‹))
ğ¸[ğ‘(ğ‘‹)] ğ‘(ğ‘€, ğ‘‹) 1 âˆ’ ğ‘(ğ‘‹)
1 âˆ’ ğ‘(ğ‘‹)
ğ‘(ğ‘‹)ğœ1 (ğ‘€, ğ‘‹)
âˆ’
(ğ· âˆ’ ğ‘(ğ‘€, ğ‘‹)) âˆ’ ğœ‡10,ğ‘¡ ğ·),
ğ‘(ğ‘€, ğ‘‹)(1 âˆ’ ğ‘(ğ‘‹))
1
ğœ (ğ‘€, ğ‘‹)
(1 âˆ’ ğ·)ğ‘Œ
=
(
ğ‘(ğ‘€, ğ‘‹) + 0
(ğ· âˆ’ ğ‘(ğ‘€, ğ‘‹)) âˆ’ ğœ‡01,ğ‘¡ ğ·),
ğ¸[ğ‘(ğ‘‹)] 1 âˆ’ ğ‘(ğ‘€, ğ‘‹)
1 âˆ’ ğ‘(ğ‘€, ğ‘‹)

where Î¼ddâ€²,t = E[p(X)Y(d, M(dâ€²))]/E[p(X)] for d, dâ€² âˆˆ {0, 1}.

5 Simulations
This section presents a brief simulation study in which we investigate the finite sample performance of nonparametric IPW based on (5) and SLE of the propensity scores, as well as of alternative estimators by considering
the following data generating process:

Automatically generated rough PDF by ProofCheck from River Valley Technologies Ltd

ğ· = ğ¼{ğ›½(ğ‘‹12 + ğ‘‹2 ) + ğœ–ğ· > 0}, ğ‘€ = ğ›½(ğ· + ğ‘‹12 + ğ‘‹2 ) + ğœ–ğ‘€ ,
ğ‘Œ = ğ· + ğ‘€ + ğ›½[(1 + ğ·)(ğ‘‹12 + ğ‘‹2 ) + ğ·ğ‘€(1 + ğ‘‹12 + ğ‘‹2 )] + ğœ–ğ‘Œ ,
with ğ‘‹1 , ğœ–ğ· , ğœ–ğ‘€ , ğœ–ğ‘Œ âˆ¼ ğ’© (0, 1), ğ‘‹2 âˆ¼ binomial(0.5), independently of each other.

(15)

X1 and X2 are observed covariates and follow standard normal and binomial distributions, respectively. We
note that X1 enters the equations of the continuous outcome Y and mediator M as well as the index function of
the binary treatment D both linearly and quadratically. ÏµD , ÏµM , ÏµY are random and standard normally distributed
unobservables. The parameter Î² gauges the degree of confounding, i.e. how strongly the covariates jointly affect
D, M, and Y. Î² also determines the level of effect heterogeneity across values of the mediator and the covariates
rooted in the interaction terms between D, M, X1 , and X2 in the outcome equation. In our simulations with 1000
replications, we set Î² = 0.1, 0.2, implying low and stronger confounding and effect heterogeneity, respectively,
and consider two sample sizes of n = 1000, 4000.5
We investigate the performance of the following estimators: (i) Nonparametric IPW using SLE-based
propensity scores as outlined in Section 3, where the orders Kx and Km for the series approximations are chosen by leave-one-out cross-validation for either propensity score given X1 , X2 and X1 , X2 , M, respectively. For
implementation, we make use of some functions provided in the â€˜LARFâ€™ package of An and Wang (2016) for
the statistical software R. On top of IPW based on cross-validated propensity scores (ipw cv), we also consider
an overfitted version (ipw ofit) where Kx and Km are one order higher than suggested by cross-validation. (ii)
Semiparametric IPW based on parametric plug-in estimators as in Huber (2014) (sem ipw), using probit models for the treatment propensity scores. Note that all IPW estimators of (i) and (ii) apply a trimming rule that
discards observations with propensity scores smaller than 0.02 or larger than 0.98 to prevent exploding weights
due to small denominators.6 (iii) Simulation-based estimation (sim) as proposed by Tingley et al. (2014), see the
â€˜mediationâ€™ package for R. The implementation considered here estimates the mediator and outcome models
as linear functions of D, X1 , X2 and D, M, D M, X1 , X2 , respectively, in order to simulate potential mediators
and outcomes and compute direct and indirect effects. It therefore omits the squared terms of X1 as well as
interactions with covariates in the outcome equation.
Table 1 reports the bias, standard deviation (sd), root mean squared error (rm) of the estimators under various combinations of Î² and n. As a general pattern, nonparametric IPW becomes relatively more competitive
when compared to IPW with probit-based propensity scores and simulation-based estimation as n and/or Î²
increase. In any simulation design with n = 4000, our procedure with both cross-validated or overfitted propensity scores by and large dominates the other estimators in terms of the root mean squared error. This is driven
by the lower absolute bias of nonparametric IPW due to not imposing parametric assumptions on the propensity score or mediator/outcome models (in particular when Î² is large), while all methods are quite comparable
Unauthenticated
Download Date | 2/25/19 5:32 PM

11

Hsu et al.

DE GRUYTER

in terms of standard deviations. We also see that for n = 1000, the overfitted version of our method moderately
outperforms estimation based on cross-validation. Under the larger sample size, however, both methods are
very similar in terms of bias, standard deviation, and root mean squared error.
Table 1: Simulation results for Î² = 0.1, 0.2 and n = 1000, 4000.
Î¸(1)

n = 1000

Î¸(0)

Î´(1)

Î´(0)

Î² = 0.1
ipw cv
ipw ofit
sem ipw
sim
Î² = 0.2
ipw cv
ipw ofit
sem ipw
sim
n = 4000

bias
0.01
âˆ’0.00
0.05
0.05
bias
âˆ’0.01
âˆ’0.03
0.21
0.19

sd
0.07
0.07
0.07
0.07
sd
0.08
0.08
0.09
0.09

rm
0.07
0.07
0.09
0.08
rm
0.09
0.09
0.22
0.21

cov
0.95
0.96
0.89
0.88
cov
0.97
0.97
0.38
0.40
Î¸(1)

bias
0.06
0.01
0.04
0.03
bias
0.03
âˆ’0.01
0.06
0.04

sd
0.10
0.07
0.07
0.07
sd
0.13
0.09
0.09
0.09

rm
0.11
0.07
0.08
0.08
rm
0.13
0.10
0.11
0.10

cov
0.93
0.96
0.90
0.91
cov
0.95
0.98
0.89
0.92
Î¸(0)

bias
âˆ’0.05
âˆ’0.01
0.04
0.04
bias
âˆ’0.04
âˆ’0.00
0.25
0.26

sd
0.11
0.08
0.09
0.09
sd
0.13
0.12
0.13
0.14

rm
0.12
0.09
0.10
0.10
rm
0.14
0.12
0.28
0.29

cov
0.93
0.96
0.92
0.91
cov
0.94
0.96
0.49
0.46
Î´(1)

bias
âˆ’0.01
âˆ’0.00
0.03
0.03
bias
âˆ’0.01
âˆ’0.01
0.10
0.11

sd
0.07
0.07
0.07
0.07
sd
0.07
0.08
0.07
0.07

rm
0.07
0.07
0.07
0.07
rm
0.07
0.08
0.13
0.13

cov
0.95
0.96
0.93
0.92
cov
0.95
0.96
0.71
0.63
Î´(0)

Î² = 0.1
ipw cv
ipw ofit
sem ipw
sim
Î² = 0.2
ipw cv
ipw ofit
sem ipw
sim

bias
0.00
0.00
0.05
0.04
bias
âˆ’0.01
âˆ’0.02
0.20
0.16

sd
0.03
0.03
0.03
0.03
sd
0.04
0.04
0.05
0.04

rm
0.03
0.03
0.06
0.05
rm
0.04
0.05
0.21
0.16

cov
0.96
0.96
0.66
0.65
cov
0.95
0.95
0.00
0.00

bias
0.00
0.00
0.04
0.02
bias
0.00
âˆ’0.01
0.05
0.00

sd
0.03
0.03
0.03
0.03
sd
0.04
0.04
0.04
0.04

rm
0.03
0.03
0.05
0.04
rm
0.04
0.04
0.07
0.04

cov
0.96
0.97
0.84
0.83
cov
0.98
0.97
0.77
0.88

bias
0.00
0.00
0.05
0.05
bias
âˆ’0.00
0.00
0.26
0.27

sd
0.04
0.04
0.04
0.04
sd
0.05
0.06
0.06
0.07

rm
0.04
0.04
0.07
0.07
rm
0.05
0.06
0.27
0.28

cov
0.95
0.96
0.76
0.75
cov
0.95
0.96
0.01
0.01

bias
0.00
0.00
0.03
0.03
bias
0.00
0.00
0.11
0.11

sd
0.03
0.03
0.03
0.03
sd
0.04
0.04
0.04
0.04

rm
0.03
0.03
0.05
0.05
rm
0.04
0.04
0.11
0.12

cov
0.95
0.96
0.81
0.79
cov
0.95
0.96
0.14
0.09

Automatically generated rough PDF by ProofCheck from River Valley Technologies Ltd

â€˜biasâ€™, â€˜sdâ€™, â€˜rmâ€™, and â€˜covâ€™ denote the bias, standard deviation, root mean squared error, and coverage rate of the true effect when
bootstrapping/simulating 199 times. â€˜ipw cvâ€™, â€˜ipw ofitâ€™, â€˜sem ipwâ€™, and â€˜simâ€™ denote IPW using SLE based on cross-validation, IPW using
SLE based on overfitting, semiparametric IPW using probit, and simulation-based estimation, respectively.

Table 1 also provides the coverage rates (cov), i.e. the share of simulations in which the 95% confidence
intervals of the estimators include the respective true effect. For the IPW methods, the standard errors required
for computing confidence intervals in each simulation sample rely on 199 bootstrap samples in which both the
propensity scores and effects are re-estimated. Also for the method of Tingley et al. (2014), inference is based on
199 simulation steps. In the case of nonparametric IPW with cross-validation or overfitting, empirical coverage
is generally close to the nominal level of 95% for either sample size and choice of Î². In contrast, the coverage
rates of the biased methods, namely IPW with probit-based propensity scores and simulation-based estimation,
are in many cases substantially smaller than 95%, in particular for Î² = 0.2 and/or n = 4000.

6 Application
We apply our methods to experimental data from Chinkhumba, Godlonton, and Thornton (2014) who aim at
measuring the demand for adult medical male circumcision among 1634 uncircumcised men in urban Malawi
as a function of randomized subsidies for circumcision and comprehensive information on circumcision and
HIV. In our mediation analysis, we focus on the information campaign only, which was randomized independently of the financial subsidies. Men receiving comprehensive information were informed that circumcision
is partially protective against HIV transmission (based on other empirical studies) at the baseline survey in
2010, while those who did not receive it were only told about the (circumcision) services of the experimentersâ€™
partner clinic. We are interested in the effect of information (D) on a binary outcome taking the value one if
a male has already been circumcised or claimed to be willing to ever get circumcised at the follow up survey
(Y) in 2011, roughly one year after the baseline survey and treatment assignment.7 We assess the direct impact
of the treatment as well as its indirect effect operating through (a change in) the risk assessment of HIV with
and without circumcision. To this end, the mediator is defined as dummy for whether uncircumcised males
are considered to be more prone to HIV risk than circumcised ones in the follow up survey (M). We therefore
aim at evaluating whether it is HIV risk assessment or other potential causal mechanisms subsumed into the
direct effect, e.g. salience about the availability of circumcision or attitudes towards circumcision, that drive
any impact of the information treatment.
12

Unauthenticated
Download Date | 2/25/19 5:32 PM

DE GRUYTER

Hsu et al.

We control for the following baseline covariates (X) in our estimation, in particular to account for the endogeneity of the mediator, which is in contrast to the treatment not randomly assigned: age, education (measured
in categories of up to 11 years of education, 12 years, or 13 years and more), a dummy for having ever had sex,
a dummy for condom use at last sex as a proxy for sexual (risk) behavior, monthly expenditures in Malawian Kwacha (MKW), and dummies for having a working TV and/or stereo system as well as a working car as
wealth proxies. We confine our sample to those 1147 men without missing information in the covariates, the
mediator, and the outcome (while there are no missing values in the randomly assigned treatment). Table 2
provides descriptive statistics (means and standard deviations) for the covariates and the outcome across the
various treatment and mediator states. We refer to Chinkhumba, Godlonton, and Thornton (2014) for more
details about the survey design, the variables, and attrition patterns.

Table 2: Descriptives.
D=1

age (in years; discrete)
12 years of education (binary)
13+ years of education (binary)
ever had sex (binary)
used condom at last sex (binary)
expenditures (in 1000 MKW; continuous)
has a working tv/stereo system (binary)
has a working car (binary)
Y: got or would get circumcised (binary)

D=0

M=1

M=0

mean

std.dev

mean

std.dev

mean

std.dev

mean

std.dev

26.72
0.40
0.18
0.87
0.38
21.72
0.78
0.13
0.76

5.33
0.49
0.38
0.34
0.48
32.47
0.42
0.34
0.43

26.43
0.42
0.21
0.88
0.42
21.98
0.78
0.15
0.76

6.11
0.49
0.40
0.32
0.49
25.61
0.41
0.36
0.43

26.48
0.41
0.19
0.88
0.41
21.04
0.79
0.14
0.80

5.80
0.49
0.39
0.33
0.49
23.59
0.41
0.35
0.40

27.19
0.38
0.21
0.85
0.31
26.65
0.76
0.13
0.48

5.10
0.49
0.41
0.35
0.46
51.91
0.43
0.34
0.50

Automatically generated rough PDF by ProofCheck from River Valley Technologies Ltd

Sample consists of 1147 men without missing information in covariates, mediators, and outcomes (note that there are no missing values
in the randomly assigned treatment). â€˜meanâ€™ and â€˜std.devâ€™ denotes the mean and standard deviation, respectively. *Believe about HIV
riskâ€™ is 0 if individual believes circumcised men to have higher HIV risk than uncircumcised men, 1 if the risk is believed to be the same
for both groups, and 2 if uncircumcised men are believed to bear a higher HIV risk.

Table 3 reports the direct and indirect effects based on the same estimators as considered in the simulations
of Section 5. In the case of IPW, we again discard observations with extreme propensity scores using the 0.02
trimming rule. No observations are affected by trimming when estimating the propensity score by probit or
based on SLE with cross-validation, while 2 subjects are discarded when using an overfitted propensity score
where SLE uses one order higher than suggested by cross-validation. Standard errors (se) of any IPW method
are based on bootstrapping the effects 1999 times8 and p-values (pval) are computed using the t-statistic. For
the method of Tingley et al. (2014), p-values are computed by simulating potential mediators and outcomes
1999 times, as implemented in the â€˜mediationâ€™ package for R.9

Table 3: Application.
Î¸(1)

ipw cv
ipw ofit
semi ipw
sim

Î¸(0)

Î´(1)

Î´(0)

est

se

pval

est

se

pval

est

se

pval

est

se

pval

âˆ’0.00
âˆ’0.00
âˆ’0.00
âˆ’0.00

0.02
0.03
0.02

0.89
1.00
0.89
0.86

âˆ’0.01
âˆ’0.01
âˆ’0.01
âˆ’0.01

0.02
0.03
0.02

0.74
0.72
0.74
0.70

0.01
0.01
0.01
0.01

0.01
0.01
0.01

0.08
0.19
0.08
0.12

0.01
0.01
0.01
0.01

0.01
0.01
0.01

0.09
0.57
0.09
0.11

â€˜estâ€™, â€˜seâ€™, and â€˜pvalâ€™ denote the effect estimate, the standard error, and the p-value, respectively. â€˜ipw cvâ€™, â€˜ipw ofitâ€™, â€˜semi ipwâ€™, and â€˜simâ€™
denote IPW using SLE based on cross-validation, IPW using SLE based on overfitting, semiparametric IPW using probit, and
simulation-based estimation, respectively. Standard errors and/or p-values are based on 1999 bootstrap replications (in the case of IPW)
or simulations (in the case of â€˜simâ€™).

None of the direct effects is statistically different from zero at conventional levels of significance. All of the
indirect effects are positive, amounting to a small increase in (intended) circumcision of roughly one percentage
point. In the case of IPW using SLE with cross-validation or probit estimation of the propensity score, the
indirect effects are significant at the 10% level, while p-values under simulation-based estimation (sim) are
slightly higher. The p-values of IPW with overfitted propensity scores are far from any conventional level of
statistical significance, but the point estimates of the indirect effects are similar to those of other procedures. All
in all, the results suggest that the information intervention has a very moderate positive effect on the outcome
Unauthenticated
Download Date | 2/25/19 5:32 PM

13

Hsu et al.

DE GRUYTER

through a change in the assessment of HIV risk with and without circumcision. In contrast, the insignificant
direct effects do not point to further important causal mechanisms through which information affects (intended)
circumcision.10

7 Conclusion
This paper proposed a fully nonparametric estimator of natural direct and indirect effects in the total population or specific subgroups based on inverse probability weighting and series logit estimation of the propensity
scores when invoking a sequential conditional independence assumption. We established the conditions required for the root-n consistency and asymptotic normality of our estimator and investigated its finite sample
performance in a simulation study. Finally, we applied our method to experimental data from Malawi to evaluate the direct effect of receiving information on circumcision on the inclination towards circumcision, as well as
the indirect effect mediated by the risk assessment of HIV with and without circumcision. The results suggest a
very moderate positive indirect effect while the direct effect is virtually zero and never statistically significant.

A Appendix
A.1

Proof of Theorem 1

Define Yddâ€² = Y(d, M(dâ€²)) and Î¼ddâ€² = E[Yddâ€² ] for d, dâ€² âˆˆ {0, 1}. By Assumption 1 and Assumption 2,
ğ·ğ‘Œ
(1 âˆ’ ğ·)ğ‘Œ
], ğœ‡00 = ğ¸[
],
ğ‘(ğ‘‹)
1 âˆ’ ğ‘(ğ‘‹)
ğ·ğ‘Œ 1 âˆ’ ğ‘(ğ‘€, ğ‘‹)
(1 âˆ’ ğ·)ğ‘Œ ğ‘(ğ‘€, ğ‘‹)
= ğ¸[
], ğœ‡01 = ğ¸[
],
ğ‘(ğ‘€, ğ‘‹) 1 âˆ’ ğ‘(ğ‘‹)
1 âˆ’ ğ‘(ğ‘€, ğ‘‹) ğ‘(ğ‘‹)

ğœ‡11 = ğ¸[
ğœ‡10

Automatically generated rough PDF by ProofCheck from River Valley Technologies Ltd

see equations (4) and (5) of Huber (2014). This allows defining the direct and indirect effects of interest in terms
of Î¼ddâ€² , e.g. Î¸(1) = Î¼11 âˆ’ Î¼01 . We estimate Î¼ddâ€² for d, dâ€² âˆˆ {0, 1} by the normalized sample analogs
1 ğ‘› ğ·ğ‘– ğ‘Œğ‘– 1 ğ‘› ğ·ğ‘–
1 ğ‘› (1 âˆ’ ğ·ğ‘– )ğ‘Œğ‘– 1 ğ‘› (1 âˆ’ ğ·ğ‘– )
âˆ‘
/ âˆ‘
, ğœ‡Ì‚00 = âˆ‘
/ âˆ‘
,
ğ‘› ğ‘–=1 ğ‘(ğ‘‹
Ì‚ ğ‘– ) ğ‘› ğ‘–=1 ğ‘(ğ‘‹
Ì‚ ğ‘–)
ğ‘› ğ‘–=1 1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘– ) ğ‘› ğ‘–=1 1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘–)
ğ·ğ‘– ğ‘Œğ‘– 1 âˆ’ ğ‘(ğ‘€
ğ·ğ‘–
1 ğ‘›
Ì‚ ğ‘– , ğ‘‹ğ‘– ) 1 ğ‘›
1 âˆ’ ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– )
= âˆ‘
/ âˆ‘
,
ğ‘› ğ‘–=1 ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ) 1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘–)
ğ‘› ğ‘–=1 ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ) 1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘–)
1 ğ‘› (1 âˆ’ ğ·ğ‘– )ğ‘Œğ‘– ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ) 1 ğ‘›
(1 âˆ’ ğ·ğ‘– ) ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– )
= âˆ‘
/ âˆ‘
.
ğ‘› ğ‘–=1 1 âˆ’ ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ) ğ‘(ğ‘‹
Ì‚ ğ‘–)
ğ‘› ğ‘–=1 1 âˆ’ ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ) ğ‘(ğ‘‹
Ì‚ ğ‘–)

ğœ‡Ì‚11 =
ğœ‡Ì‚10
ğœ‡Ì‚01

To prove Theorem 1, it is thus sufficient to show that for d, dâ€² âˆˆ {0, 1},

âˆšğ‘›(ğœ‡Ì‚ğ‘‘ğ‘‘â€² âˆ’ ğœ‡ğ‘‘ğ‘‘â€² ) =

1 ğ‘›
âˆ‘ ğœ“ â€² (ğ‘Œ , ğ‘€ , ğ· , ğ‘‹ ) + ğ‘œğ‘ (1).
âˆšğ‘› ğ‘–=1 ğ‘‘ğ‘‘ ğ‘– ğ‘– ğ‘– ğ‘–

As the results regarding Î¼11 and Î¼00 have been established by HIR, we subsequently focus on the proof for Î¼10
and note that the derivations for Î¼01 proceed in an analogous way. Let ğœ‡Ìƒ10 be the numerator of ğœ‡Ì‚10 and ğœ”Ìƒ 10 be
the denominator of ğœ‡Ì‚10 . We first show that

âˆšğ‘›(ğœ‡Ìƒ10 âˆ’ ğœ‡10 ) =

1 ğ‘›
âˆ‘ ğœ“ (ğ‘Œ , ğ‘€ , ğ· , ğ‘‹ ) + ğ‘œğ‘ (1),
âˆšğ‘› ğ‘–=1 10 ğ‘– ğ‘– ğ‘– ğ‘–

using a similar approach as HIR. Note that

14

Unauthenticated
Download Date | 2/25/19 5:32 PM

DE GRUYTER

Hsu et al.

1 ğ‘›
ğ·ğ‘– ğ‘Œğ‘– 1 âˆ’ ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– )
âˆ‘{
âˆ’ ğœ‡10 }
âˆšğ‘› ğ‘–=1 ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ) 1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘–)
1 ğ‘›
ğ·ğ‘– ğ‘Œğ‘– 1 âˆ’ ğ‘(ğ‘€ğ‘– , ğ‘‹ğ‘– )
=
âˆ‘{
âˆ’ ğœ‡10 }
âˆšğ‘› ğ‘–=1 ğ‘(ğ‘€ğ‘– , ğ‘‹ğ‘– ) 1 âˆ’ ğ‘(ğ‘‹ğ‘– )
1 ğ‘›
ğ·ğ‘– ğ‘Œğ‘– 1 âˆ’ ğ‘(ğ‘€ğ‘– , ğ‘‹ğ‘– )
+
âˆ‘{
(ğ‘(ğ‘‹
Ì‚ ğ‘– ) âˆ’ ğ‘(ğ‘‹ğ‘– ))}
âˆšğ‘› ğ‘–=1 ğ‘(ğ‘€ğ‘– , ğ‘‹ğ‘– ) (1 âˆ’ ğ‘(ğ‘‹ğ‘– ))2
âˆ’ğ·ğ‘– ğ‘Œğ‘–
1
1 ğ‘›
+
âˆ‘{ 2
(ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ) âˆ’ ğ‘(ğ‘€ğ‘– , ğ‘‹ğ‘– ))} + ğ‘œğ‘ (1)
âˆšğ‘› ğ‘–=1 ğ‘ (ğ‘€ğ‘– , ğ‘‹ğ‘– ) 1 âˆ’ ğ‘(ğ‘‹ğ‘– )

âˆšğ‘›(ğœ‡Ìƒ10 âˆ’ ğœ‡10 ) =

where the second equality holds by a second order mean valued expansion around p(Xi ) and p(Mi , Xi ) and the
fact that supğ‘¥âˆˆğ’³ |ğ‘(ğ‘¥)
Ì‚
âˆ’ ğ‘(ğ‘¥)| = ğ‘œğ‘ (ğ‘›âˆ’1/4 ) and supğ‘šâˆˆâ„³,ğ‘¥âˆˆğ’³ |ğ‘(ğ‘š,
Ì‚
ğ‘¥) âˆ’ ğ‘(ğ‘š, ğ‘¥)| = ğ‘œğ‘ (ğ‘›âˆ’1/4 ). The converge rate of
supğ‘¥âˆˆğ’³ |ğ‘(ğ‘¥)
Ì‚
âˆ’ ğ‘(ğ‘¥)| = ğ‘‚ğ‘ (ğ¾ğ‘¥ (âˆšğ¾ğ‘¥ /ğ‘› + ğ¾ âˆ’ğ‘Ì„ğ‘¥ /2ğ‘‘ğ‘¥ )) is derived in Lemma A3 of Hsu (2017) and the conditions
given in this paper are sufficient for supğ‘¥âˆˆğ’³ |ğ‘(ğ‘¥)
Ì‚
âˆ’ ğ‘(ğ‘¥)| = ğ‘œğ‘ (ğ‘›âˆ’1/4 ). By the same argument as in Theorem 1
of HIR, we have
1 ğ‘›
ğ·ğ‘– ğ‘Œğ‘– 1 âˆ’ ğ‘(ğ‘€ğ‘– , ğ‘‹ğ‘– )
(ğ‘(ğ‘‹
Ì‚ ğ‘– ) âˆ’ ğ‘(ğ‘‹ğ‘– ))}
âˆ‘{
âˆšğ‘› ğ‘–=1 ğ‘(ğ‘€ğ‘– , ğ‘‹ğ‘– ) (1 âˆ’ ğ‘(ğ‘‹ğ‘– ))2
ğ·ğ‘– ğ‘Œğ‘– 1 âˆ’ ğ‘(ğ‘€ğ‘– , ğ‘‹ğ‘– )
1 ğ‘›
âˆ‘ {ğ¸[
âˆ£ğ‘‹ ](ğ·ğ‘– âˆ’ ğ‘(ğ‘‹ğ‘– ))} + ğ‘œğ‘ (1)
=
âˆšğ‘› ğ‘–=1
ğ‘(ğ‘€ğ‘– , ğ‘‹ğ‘– ) (1 âˆ’ ğ‘(ğ‘‹ğ‘– ))2 ğ‘–
1 ğ‘›
ğœŒ10 (ğ‘‹ğ‘– )
=
âˆ‘{
(ğ· âˆ’ ğ‘(ğ‘‹ğ‘– ))} + ğ‘œğ‘ (1).
âˆšğ‘› ğ‘–=1 (1 âˆ’ ğ‘(ğ‘‹ğ‘– )) ğ‘–

Automatically generated rough PDF by ProofCheck from River Valley Technologies Ltd

Similarly, it holds that
âˆ’ğ·ğ‘– ğ‘Œğ‘–
1 ğ‘›
1
(ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ) âˆ’ ğ‘(ğ‘€ğ‘– , ğ‘‹ğ‘– ))}
âˆ‘{
âˆšğ‘› ğ‘–=1 ğ‘2 (ğ‘€ğ‘– , ğ‘‹ğ‘– ) 1 âˆ’ ğ‘(ğ‘‹ğ‘– )
âˆ’ğ·ğ‘– ğ‘Œğ‘–
1 ğ‘›
1
âˆ‘ {ğ¸[ 2
=
âˆ£ğ‘€ , ğ‘‹ ](ğ·ğ‘– âˆ’ ğ‘(ğ‘€ğ‘– , ğ‘‹ğ‘– ))} + ğ‘œğ‘ (1)
âˆšğ‘› ğ‘–=1
ğ‘ (ğ‘€ğ‘– , ğ‘‹ğ‘– ) 1 âˆ’ ğ‘(ğ‘‹ğ‘– ) ğ‘– ğ‘–
1 ğ‘› âˆ’ğœ1 (ğ‘€ğ‘– , ğ‘‹ğ‘– )
1
=
(ğ· âˆ’ ğ‘(ğ‘€ğ‘– , ğ‘‹ğ‘– ))} + ğ‘œğ‘ (1).
âˆ‘{
âˆšğ‘› ğ‘–=1 ğ‘(ğ‘€ğ‘– , ğ‘‹ğ‘– ) 1 âˆ’ ğ‘(ğ‘‹ğ‘– ) ğ‘–
Next, one can easily show that
âˆšğ‘›(ğ‘¤Ìƒ 10 âˆ’ 1) = ğ‘œğ‘ (1),
by replacing Yi â€™s with 1â€™s in the proof for ğœ‡Ìƒ10 and acknowledging that the influence functions for ğ‘¤Ìƒ 10 are all
zero. Finally, it follows that
âˆšğ‘›(ğœ‡Ì‚10 âˆ’ ğœ‡10 ) = âˆšğ‘›( ğœ‡Ìƒ 10 âˆ’ ğœ‡10 )
ğ‘¤Ìƒ 10
= âˆšğ‘›(ğœ‡Ìƒ10 âˆ’ ğœ‡10 ) âˆ’ ğœ‡10 âˆšğ‘›(ğ‘¤Ìƒ 10 âˆ’ 1) + ğ‘œğ‘ (1)
= âˆšğ‘›(ğœ‡Ìƒ10 âˆ’ ğœ‡10 ) + ğ‘œğ‘ (1),
where the second equality follows by a mean-value expansion and the last equality holds by the fact that Î¼10 is
bounded and that âˆšğ‘›(ğ‘¤Ìƒ 10 âˆ’ 1) = ğ‘œğ‘ (1). This completes the proof.
â–¡

A.2 Proof of Theorem 2
Define Î¼ddâ€²,g = E[g(X)Yddâ€² ]/E[g(X)] for d, dâ€² âˆˆ {0, 1}. Similarly,

Unauthenticated
Download Date | 2/25/19 5:32 PM

15

Hsu et al.

DE GRUYTER

ğœ‡11,ğ‘” =
ğœ‡00,ğ‘” =
ğœ‡10,ğ‘” =
ğœ‡01,ğ‘” =

ğ·ğ‘Œ ]
ğ¸[ğ‘”(ğ‘‹) ğ‘(ğ‘‹)

,
ğ¸[ğ‘”(ğ‘‹)]
(1âˆ’ğ·)ğ‘Œ
ğ¸[ğ‘”(ğ‘‹) 1âˆ’ğ‘(ğ‘‹) ]

,
ğ¸[ğ‘”(ğ‘‹)]
ğ·ğ‘Œ 1âˆ’ğ‘(ğ‘€,ğ‘‹) ]
ğ¸[ğ‘”(ğ‘‹) ğ‘(ğ‘€,ğ‘‹)
1âˆ’ğ‘(ğ‘‹)
ğ¸[ğ‘”(ğ‘‹)]

(1âˆ’ğ·)ğ‘Œ ğ‘(ğ‘€,ğ‘‹)
ğ¸[ğ‘”(ğ‘‹) 1âˆ’ğ‘(ğ‘€,ğ‘‹)
]
ğ‘(ğ‘‹)

ğ¸[ğ‘”(ğ‘‹)]

,
.

We estimate Î¼ddâ€²,g for d, dâ€² âˆˆ {0, 1} by the normalized sample analogs
1 ğ‘›
ğ·ğ‘Œ
1 ğ‘›
ğ·ğ‘–
âˆ‘ ğ‘”(ğ‘‹ğ‘– ) ğ‘– ğ‘– / âˆ‘ ğ‘”(ğ‘‹ğ‘– )
,
ğ‘› ğ‘–=1
ğ‘(ğ‘‹
Ì‚ ğ‘– ) ğ‘› ğ‘–=1
ğ‘(ğ‘‹
Ì‚ ğ‘–)
1 ğ‘›
(1 âˆ’ ğ·ğ‘– )ğ‘Œğ‘– 1 ğ‘›
(1 âˆ’ ğ·ğ‘– )
= âˆ‘ ğ‘”(ğ‘‹ğ‘– )
/ âˆ‘ ğ‘”(ğ‘‹ğ‘– )
,
ğ‘› ğ‘–=1
1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘– ) ğ‘› ğ‘–=1
1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘–)
1 ğ‘›
Ì‚ ğ‘– , ğ‘‹ğ‘– ) 1 ğ‘›
1 âˆ’ ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– )
ğ·ğ‘– ğ‘Œğ‘– 1 âˆ’ ğ‘(ğ‘€
ğ·ğ‘–
/ âˆ‘ ğ‘”(ğ‘‹ğ‘– )
,
= âˆ‘ ğ‘”(ğ‘‹ğ‘– )
ğ‘› ğ‘–=1
ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ) 1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘–)
ğ‘› ğ‘–=1
ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ) 1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘–)
1 ğ‘›
(1 âˆ’ ğ·ğ‘– )ğ‘Œğ‘– ğ‘(ğ‘€
(1 âˆ’ ğ·ğ‘– ) ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ) 1 ğ‘›
Ì‚ ğ‘– , ğ‘‹ğ‘– )
= âˆ‘ ğ‘”(ğ‘‹ğ‘– )
/ âˆ‘ ğ‘”(ğ‘‹ğ‘– )
.
ğ‘› ğ‘–=1
1 âˆ’ ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ) ğ‘(ğ‘‹
Ì‚ ğ‘–)
ğ‘› ğ‘–=1
1 âˆ’ ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ) ğ‘(ğ‘‹
Ì‚ ğ‘–)

ğœ‡Ì‚11,ğ‘” =
ğœ‡Ì‚00,ğ‘”
ğœ‡Ì‚10,ğ‘”
ğœ‡Ì‚01,ğ‘”

ğ‘›

Automatically generated rough PDF by ProofCheck from River Valley Technologies Ltd

Define Pg = E[g(X)]. We would like to show that âˆšğ‘›(ğœ‡Ì‚11,ğ‘” âˆ’ğœ‡11,ğ‘” ) = ğ‘›âˆ’1/2 âˆ‘ğ‘–=1 ğœ“ğœ‡11,ğ‘” (ğ‘Œğ‘– , ğ‘€ğ‘– , ğ·ğ‘– , ğ‘‹ğ‘– )+ğ‘œğ‘ (1). First,
we can be demonstrated that
ğ·ğ‘Œ
1 ğ‘›
âˆšğ‘›( âˆ‘ ğ‘”(ğ‘‹ğ‘– ) ğ‘– ğ‘– âˆ’ ğœ‡11,ğ‘” â‹… ğ‘ƒğ‘” )
ğ‘› ğ‘–=1
ğ‘(ğ‘‹
Ì‚ ğ‘–)
ğ‘›
1
ğ‘”(ğ‘‹ğ‘– )ğ·ğ‘– ğ‘Œğ‘– ğ‘”(ğ‘‹ğ‘– )ğœŒ11 (ğ‘‹ğ‘– )
=
âˆ‘(
âˆ’
(ğ·ğ‘– âˆ’ ğ‘(ğ‘‹ğ‘– )) âˆ’ ğœ‡11,ğ‘” â‹… ğ‘ƒğ‘” ) + ğ‘œğ‘ (1), and
âˆšğ‘› ğ‘–=1
ğ‘(ğ‘‹ğ‘– )
ğ‘(ğ‘‹ğ‘– )
ğ·ğ‘–
1 ğ‘›
âˆšğ‘›( âˆ‘ ğ‘”(ğ‘‹ğ‘– )
âˆ’ ğœ‡11,ğ‘” â‹… ğ‘ƒğ‘” )
ğ‘› ğ‘–=1
ğ‘(ğ‘‹
Ì‚ ğ‘–)
1 ğ‘› ğ‘”(ğ‘‹ğ‘– )ğ·ğ‘– ğ‘”(ğ‘‹ğ‘– )
=
âˆ‘(
âˆ’
(ğ· âˆ’ ğ‘(ğ‘‹ğ‘– )) âˆ’ ğ‘ƒğ‘” ) + ğ‘œğ‘ (1)
âˆšğ‘› ğ‘–=1 ğ‘(ğ‘‹ğ‘– )
ğ‘(ğ‘‹ğ‘– ) ğ‘–
1 ğ‘›
=
âˆ‘(ğ‘”(ğ‘‹ğ‘– ) âˆ’ ğ‘ƒğ‘” ) + ğ‘œğ‘ (1).
âˆšğ‘› ğ‘–=1
Then by delta method, we have
âˆšğ‘›(ğœ‡Ì‚11,ğ‘” âˆ’ ğœ‡11,ğ‘” )
ğœ‡11,ğ‘”
1 1 ğ‘› ğ‘”(ğ‘‹ğ‘– )ğ·ğ‘– ğ‘Œğ‘– ğ‘”(ğ‘‹ğ‘– )ğœ‡1 (ğ‘‹ğ‘– )
=
âˆ‘(
âˆ’
(ğ·ğ‘– âˆ’ ğ‘(ğ‘‹ğ‘– )) âˆ’ ğœ‡11,ğ‘” â‹… ğ‘ƒğ‘” ) âˆ’
(ğ‘”(ğ‘‹ğ‘– ) âˆ’ ğ‘ƒğ‘” ) + ğ‘œğ‘ (1)
ğ‘ƒğ‘” âˆšğ‘› ğ‘–=1
ğ‘(ğ‘‹ğ‘– )
ğ‘(ğ‘‹ğ‘– )
ğ‘ƒğ‘”
1 ğ‘› ğ‘”(ğ‘‹ğ‘– )
ğ·ğ‘Œ
ğœŒ (ğ‘‹ )
=
âˆ‘
( ğ‘– ğ‘– âˆ’ 11 ğ‘– (ğ·ğ‘– âˆ’ ğ‘(ğ‘‹ğ‘– )) âˆ’ ğœ‡11,ğ‘” ) + ğ‘œğ‘ (1).
âˆšğ‘› ğ‘–=1 ğ¸[ğ‘”(ğ‘‹)] ğ‘(ğ‘‹ğ‘– )
ğ‘(ğ‘‹ğ‘– )
This gives the result for the Î¼11,g case. Using the same arguments, we can derive the results for Î¼00,g , Î¼01,g and
Î¼10,g , too, which is sufficient to prove Theorem 2.
â–¡

A.3 Proof of Theorem 3
Define Î¼ddâ€²,t = E[p(X)Yddâ€² ]/E[p(X)] for d, dâ€² âˆˆ {0, 1}. Similarly,

16

Unauthenticated
Download Date | 2/25/19 5:32 PM

DE GRUYTER

Hsu et al.

ğœ‡11,ğ‘¡ =
ğœ‡00,ğ‘¡ =
ğœ‡10,ğ‘¡ =
ğœ‡01,ğ‘¡ =

ğ·ğ‘Œ ]
ğ¸[ğ‘(ğ‘‹) ğ‘(ğ‘‹)

,
ğ¸[ğ‘(ğ‘‹)]
ğ¸[ğ‘(ğ‘‹) (1âˆ’ğ·)ğ‘Œ
]
1âˆ’ğ‘(ğ‘‹)

,
ğ¸[ğ‘(ğ‘‹)]
ğ·ğ‘Œ 1âˆ’ğ‘(ğ‘€,ğ‘‹) ]
ğ¸[ğ‘(ğ‘‹) ğ‘(ğ‘€,ğ‘‹)
1âˆ’ğ‘(ğ‘‹)
ğ¸[ğ‘(ğ‘‹)]
(1âˆ’ğ·)ğ‘Œ
ğ¸[ğ‘(ğ‘‹) 1âˆ’ğ‘(ğ‘€,ğ‘‹)

ğ‘(ğ‘€,ğ‘‹)
]
ğ‘(ğ‘‹)

ğ¸[ğ‘(ğ‘‹)]

,
.

We estimate Î¼ddâ€²,t for d, dâ€² âˆˆ {0, 1} by the normalized sample analogs
1 ğ‘›
1 ğ‘›
âˆ‘ ğ·ğ‘– ğ‘Œğ‘– / âˆ‘ ğ·ğ‘– ,
ğ‘› ğ‘–=1
ğ‘› ğ‘–=1
ğ‘›
1
(1 âˆ’ ğ·ğ‘– )ğ‘Œğ‘– 1 ğ‘›
(1 âˆ’ ğ·ğ‘– )
= âˆ‘ ğ‘(ğ‘‹
Ì‚ ğ‘–)
/ âˆ‘ ğ‘(ğ‘‹
Ì‚ ğ‘–)
,
ğ‘› ğ‘–=1
1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘– ) ğ‘› ğ‘–=1
1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘–)
ğ·ğ‘– ğ‘Œğ‘– 1 âˆ’ ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ) 1 ğ‘›
ğ·ğ‘–
1 âˆ’ ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– )
1 ğ‘›
Ì‚ ğ‘–)
/ âˆ‘ ğ‘(ğ‘‹
Ì‚ ğ‘–)
,
= âˆ‘ ğ‘(ğ‘‹
ğ‘› ğ‘–=1
ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ) 1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘–)
ğ‘› ğ‘–=1
ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ) 1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘–)
1 ğ‘› (1 âˆ’ ğ·ğ‘– )ğ‘Œğ‘–
1 ğ‘›
(1 âˆ’ ğ·ğ‘– )
= âˆ‘
ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– )/ âˆ‘
ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ).
ğ‘› ğ‘–=1 1 âˆ’ ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– )
ğ‘› ğ‘–=1 1 âˆ’ ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– )

ğœ‡Ì‚11,ğ‘¡ =
ğœ‡Ì‚00,ğ‘¡
ğœ‡Ì‚10,ğ‘¡
ğœ‡Ì‚01,ğ‘¡

Automatically generated rough PDF by ProofCheck from River Valley Technologies Ltd

Define Pt = E[p(X)]. Note that we have
1 ğ‘›
1 ğ‘›
âˆšğ‘›( âˆ‘ ğ·ğ‘– ğ‘Œğ‘– âˆ’ ğœ‡11,ğ‘¡ ğ‘ƒğ‘¡ ) =
âˆ‘(ğ· ğ‘Œ âˆ’ ğœ‡11,ğ‘¡ ğ‘ƒğ‘¡ ),
âˆšğ‘› ğ‘–=1 ğ‘– ğ‘–
ğ‘› ğ‘–=1
(1 âˆ’ ğ·ğ‘– )ğ‘Œğ‘–
1 ğ‘›
âˆšğ‘›( âˆ‘ ğ‘(ğ‘‹
Ì‚ ğ‘–)
âˆ’ ğœ‡00,ğ‘¡ ğ‘ƒğ‘¡ )
ğ‘› ğ‘–=1
1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘–)
ğœ‡0 (ğ‘‹ğ‘– )
1 ğ‘›
ğ‘(ğ‘‹ğ‘– )(1 âˆ’ ğ·ğ‘– )ğ‘Œğ‘–
+
(ğ· âˆ’ ğ‘(ğ‘‹ğ‘– )) âˆ’ ğœ‡00,ğ‘¡ ğ‘ƒğ‘¡ ) + ğ‘œğ‘ (1),
=
âˆ‘ (
âˆšğ‘› ğ‘–=1
1 âˆ’ ğ‘(ğ‘‹ğ‘– )
1 âˆ’ ğ‘(ğ‘‹ğ‘– ) ğ‘–
ğ·ğ‘– ğ‘Œğ‘– 1 âˆ’ ğ‘(ğ‘€
1 ğ‘›
Ì‚ ğ‘– , ğ‘‹ğ‘– )
âˆšğ‘›( âˆ‘ ğ‘(ğ‘‹
Ì‚ ğ‘–)
âˆ’ ğœ‡10,ğ‘¡ ğ‘ƒğ‘¡ )
ğ‘› ğ‘–=1
ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ) 1 âˆ’ ğ‘(ğ‘‹
Ì‚ ğ‘–)
1 ğ‘› ğ‘(ğ‘‹ğ‘– )ğ·ğ‘– ğ‘Œğ‘– 1 âˆ’ ğ‘(ğ‘€ğ‘– , ğ‘‹ğ‘– )
ğœŒ (ğ‘‹ )
âˆ‘(
=
+ 10 ğ‘– (ğ·ğ‘– âˆ’ ğ‘(ğ‘‹ğ‘– ))
âˆšğ‘› ğ‘–=1 ğ‘(ğ‘€ğ‘– , ğ‘‹ğ‘– ) 1 âˆ’ ğ‘(ğ‘‹ğ‘– )
1 âˆ’ ğ‘(ğ‘‹ğ‘– )
ğ‘(ğ‘‹ğ‘– )ğœ1 (ğ‘€ğ‘– , ğ‘‹ğ‘– )
(ğ· âˆ’ ğ‘(ğ‘€ğ‘– , ğ‘‹ğ‘– )) âˆ’ ğœ‡10,ğ‘¡ ğ‘ƒğ‘¡ ) + ğ‘œğ‘ (1), and
âˆ’
ğ‘(ğ‘€ğ‘– , ğ‘‹ğ‘– )(1 âˆ’ ğ‘(ğ‘‹ğ‘– )) ğ‘–
ğ‘›
(1 âˆ’ ğ·ğ‘– )ğ‘Œğ‘–
1
âˆšğ‘›( âˆ‘
ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ) âˆ’ ğœ‡01,ğ‘¡ ğ‘ƒğ‘¡ )
ğ‘› ğ‘–=1 1 âˆ’ ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– )
ğœ0 (ğ‘€ğ‘– , ğ‘‹ğ‘– )
1 ğ‘›
(1 âˆ’ ğ·ğ‘– )ğ‘Œğ‘–
ğ‘(ğ‘€ğ‘– , ğ‘‹ğ‘– ) +
(ğ· âˆ’ ğ‘(ğ‘€ğ‘– , ğ‘‹ğ‘– )) âˆ’ ğœ‡01,ğ‘¡ ğ‘ƒğ‘¡ ) + ğ‘œğ‘ (1).
=
âˆ‘(
âˆšğ‘› ğ‘–=1 1 âˆ’ ğ‘(ğ‘€ğ‘– , ğ‘‹ğ‘– )
(1 âˆ’ ğ‘(ğ‘€ğ‘– , ğ‘‹ğ‘– )) ğ‘–
Furthermore,
1 âˆ‘ğ‘› (ğ· âˆ’ ğ‘ƒ ) + ğ‘œ (1),
ğ‘–
ğ‘¡
ğ‘
ğ‘–=1
âˆšğ‘›
ğ‘›
1 âˆ‘ğ‘› (ğ· âˆ’ ğ‘ƒ ) + ğ‘œ (1)
ğ‘– )ğ‘Œğ‘–
âˆ’
ğ‘ƒ
)
=
âˆ‘ğ‘–=1 ğ‘(ğ‘‹
Ì‚ ğ‘– ) (1âˆ’ğ·
ğ‘¡
ğ‘–
ğ‘¡
ğ‘
ğ‘–=1
1âˆ’ğ‘(ğ‘‹
Ì‚ ğ‘–)
âˆšğ‘›
ğ‘›
1âˆ’ğ‘(ğ‘€
Ì‚ ğ‘– ,ğ‘‹ğ‘– )
ğ·ğ‘–
1 âˆ‘ğ‘› (ğ· âˆ’ ğ‘ƒ ) + ğ‘œ (1), and
âˆ’
ğ‘ƒ
)
=
âˆ‘ğ‘–=1 ğ‘(ğ‘‹
Ì‚ ğ‘– ) ğ‘(ğ‘€
ğ‘¡
ğ‘–
ğ‘¡
ğ‘
ğ‘–=1
Ì‚ ğ‘–)
Ì‚ ğ‘– ,ğ‘‹ğ‘– ) 1âˆ’ğ‘(ğ‘‹
âˆšğ‘›
ğ‘›
ğ‘›
(1âˆ’ğ·ğ‘– )
1
âˆ‘ğ‘–=1 1âˆ’ğ‘(ğ‘€
ğ‘(ğ‘€
Ì‚ ğ‘– , ğ‘‹ğ‘– ) âˆ’ ğ‘ƒğ‘¡ ) = âˆšğ‘› âˆ‘ğ‘–=1 (ğ·ğ‘– âˆ’ ğ‘ƒğ‘¡ ) + ğ‘œğ‘ (1).
Ì‚ ğ‘– ,ğ‘‹ğ‘– )

âˆšğ‘›( ğ‘›1 âˆ‘ğ‘›ğ‘–=1 ğ·ğ‘– âˆ’ ğ‘ƒğ‘¡ ) =

âˆšğ‘›( ğ‘›1
âˆšğ‘›( ğ‘›1
âˆšğ‘›( ğ‘›1

By delta method, we have

=
=

âˆšğ‘›(ğœ‡Ì‚11,ğ‘¡ âˆ’ ğœ‡11,ğ‘¡ )
1 âˆ‘ğ‘›
1
ğ‘–=1 ğ‘ƒ (ğ·ğ‘– ğ‘Œğ‘– âˆ’ ğœ‡11,ğ‘¡ ğ‘ƒğ‘¡ âˆ’ ğœ‡11,ğ‘¡ (ğ·ğ‘– âˆ’ ğ‘ƒğ‘¡ )) + ğ‘œğ‘ (1)
âˆšğ‘›
1
âˆšğ‘›

ğ‘›

âˆ‘ğ‘–=1

ğ‘¡

1 (ğ· (ğ‘Œ
ğ‘–
ğ‘–
ğ‘ƒğ‘¡

âˆ’ ğœ‡11,ğ‘¡ )) + ğ‘œğ‘ (1).
Unauthenticated
Download Date | 2/25/19 5:32 PM

17

Hsu et al.

DE GRUYTER

Similarly,
âˆšğ‘›(ğœ‡Ì‚00,ğ‘¡ âˆ’ ğœ‡00,ğ‘¡ )
1 âˆ‘ğ‘›
1 ğ‘(ğ‘‹ğ‘– )(1âˆ’ğ·ğ‘– )ğ‘Œğ‘– +
= âˆšğ‘›
ğ‘–=1 ğ‘ƒ (
1âˆ’ğ‘(ğ‘‹ )

ğœŒ00 (ğ‘‹ğ‘– )
(ğ·ğ‘– âˆ’ ğ‘(ğ‘‹ğ‘– )) âˆ’ ğœ‡00,ğ‘¡ ğ‘ƒğ‘¡ âˆ’ ğœ‡00,ğ‘¡ (ğ·ğ‘–
1âˆ’ğ‘(ğ‘‹ğ‘– )
1 âˆ‘ğ‘›
1 ( ğ‘(ğ‘‹ğ‘– )(1âˆ’ğ·ğ‘– )(ğ‘Œğ‘– âˆ’ğœŒ00 (ğ‘‹ğ‘– )) + (ğœŒ (ğ‘‹ ) âˆ’ ğœ‡
00
ğ‘–
00,ğ‘¡ )ğ·ğ‘– ) + ğ‘œğ‘ (1).
ğ‘–=1 ğ‘ƒğ‘¡
1âˆ’ğ‘(ğ‘‹ğ‘– )
âˆšğ‘›
ğ‘–

ğ‘¡

=

âˆ’ ğ‘ƒğ‘¡ )) + ğ‘œğ‘ (1)

Next,

=

âˆšğ‘›(ğœ‡Ì‚10,ğ‘¡ âˆ’ ğœ‡10,ğ‘¡ )
1 âˆ‘ğ‘›
1 ğ‘(ğ‘‹ğ‘– )ğ·ğ‘– ğ‘Œğ‘– 1âˆ’ğ‘(ğ‘€ğ‘– ,ğ‘‹ğ‘– )
ğ‘–=1 ğ‘ƒ ( ğ‘(ğ‘€ ,ğ‘‹ ) 1âˆ’ğ‘(ğ‘‹ ) +
âˆšğ‘›
ğ‘¡

ğ‘–

ğ‘–

ğ‘(ğ‘‹ğ‘– )ğœ1 (ğ‘€ğ‘– ,ğ‘‹ğ‘– )
(ğ·ğ‘–
âˆ’ ğ‘(ğ‘€ ,ğ‘‹
ğ‘–
ğ‘– )(1âˆ’ğ‘(ğ‘‹ğ‘– ))

=

ğ‘–

ğœŒ10 (ğ‘‹ğ‘– )
(ğ·ğ‘–
(1âˆ’ğ‘(ğ‘‹ğ‘– ))

âˆ’ ğ‘(ğ‘‹ğ‘– ))

âˆ’ ğ‘(ğ‘€ğ‘– , ğ‘‹ğ‘– )) âˆ’ ğœ‡10,ğ‘¡ ğ·ğ‘– ) + ğ‘œğ‘ (1),
âˆšğ‘›(ğœ‡Ì‚01,ğ‘¡ âˆ’ ğœ‡01,ğ‘¡ )
ğœ0 (ğ‘€ğ‘– ,ğ‘‹ğ‘– )
(1âˆ’ğ·ğ‘– )ğ‘Œğ‘–
1 âˆ‘ğ‘›
1
ğ‘–=1 ğ‘ƒ ( 1âˆ’ğ‘(ğ‘€ ,ğ‘‹ ) ğ‘(ğ‘€ğ‘– , ğ‘‹ğ‘– ) + (1âˆ’ğ‘(ğ‘€ ,ğ‘‹ )) (ğ·ğ‘– âˆ’ ğ‘(ğ‘€ğ‘– , ğ‘‹ğ‘– )) âˆ’ ğœ‡01,ğ‘¡ ğ·ğ‘– ) + ğ‘œğ‘ (1).
âˆšğ‘›
ğ‘¡

This completes the proof.

ğ‘–

ğ‘–

ğ‘–

ğ‘–

â–¡

A.4 Effects of Circumcision on the Treated

Table 4: Direct and indirect effects among treated.
Î¸(1)

ipw cv
ipw ofit
semi ipw

Î¸(0)

Î´(1)

Î´(0)

est

se

pval

est

se

pval

est

se

pval

est

se

pval

0.04
0.03
0.04

0.02
0.03
0.02

0.13
0.34
0.13

0.03
0.01
0.03

0.03
0.03
0.03

0.19
0.74
0.19

0.01
0.02
0.01

0.01
0.01
0.01

0.24
0.04
0.24

0.01
0.00
0.01

0.01
0.01
0.01

0.29
0.78
0.28

Automatically generated rough PDF by ProofCheck from River Valley Technologies Ltd

â€˜estâ€™, â€˜seâ€™, and â€˜pvalâ€™ denote the effect estimate, the standard error, and the p-value, respectively. â€˜ipw cvâ€™, â€˜ipw ofitâ€™, and â€˜semi ipwâ€™ denote
IPW using SLE based on cross-validation, IPW using SLE based on overfitting, and semiparametric IPW using probit, respectively.
Standard errors and/or p-values are based on 1999 bootstrap replications.

Notes
1 Tchetgen Tchetgen (2013) derives a related result in the context of inverse odds-ratio weighting.
2 In contrast, the seminal papers in mediation analysis of Judd and Kenny (1981) and Baron and Kenny (1986) assume linear models for
both the mediator and the outcome.
3 See also the textbooks by MacKinnon (2008), Hong (2015), and Hayes (2017) for general discussions of mediation analysis in social
sciences.
4 Robins and Greenland (1992) and Robins (2003) refer to this parameter as the total or pure direct effect and Flores and Flores-Lagunes
(2009) as net average treatment effect.
5 For Î² = 0.1, the averages of D and M are 0.56 and 0.21, respectively, in our simulations. For Î² = 0.2, the averages of D and M are 0.61 and
0.42, respectively.
6 Only few observations in our simulations need to be trimmed. For (Î² = 0.1, n = 1000), on average 0.36 overfitted SLE-based propensity
scores including both the covariates and the mediator lie outside the [0.02, 0.98] interval. This is also the case for on average 0.05 crossvalidated SLE-based propensity scores. For (Î² = 0.2, n = 1000), the respective numbers are 2.69 and 1.51 for the overfitted and cross-validated
SLE-based propensity scores, respectively. None of the probit-based propensity scores are trimmed in any simulation design.
7 To be concise, Y is defined as one if either the interviewee stated to be circumcised or was willing to ever get circumcised, or the administrative records of the partner clinic show that he actually got circumcised, see the discussion in Chinkhumba, Godlonton, and Thornton
(2014).
8 For IPW using SLE with cross-validation for propensity score estimation, we also considered asymptotic approximations based on Theorem 1 (see Section 3.3) to compute standard errors in order to check robustness across inference methods. The obtained p-values are mostly
similar to the bootstrap-based ones reported in the first line of Table 3, namely 0.90, 0.77, 0.00, and 0.07 for estimates of Î¸(1), 4 Î¸(0), Î´(1),
and Î´(0), respectively.
9 Note that standard errors are not provided for the simulation-based estimators.
10 While the effects discussed here refer to the total population, Appendix A.4 presents IPW-based estimates of direct and indirect effects
on the treated as an illustration of the weighting approach outlined in Section 4.3. Statistical power is, however, considerably lower and
with one exception, none of the estimates are significant at conventional levels.

18

Unauthenticated
Download Date | 2/25/19 5:32 PM

DE GRUYTER

Hsu et al.

Automatically generated rough PDF by ProofCheck from River Valley Technologies Ltd

References
Abrevaya, J., Y.-C. Hsu, and R. P. Lieli. 2015. â€œEstimating Conditional Average Treatment Effects.â€ Journal of Business & Economic Statistics 33 (4):
485â€“505.
Albert, J. M. 2008. â€œMediation analysis via potential outcomes models.â€ Statistics in Medicine 27: 1282â€“1304.
Albert, J. M., and S. Nelson. 2011. â€œGeneralized causal mediation analysis.â€ Biometrics 67: 1028â€“1038.
An, W., and X. Wang. 2016. â€œInstrumental Variable Estimation of Causal Effects through Local Average Response Functions.â€ Journal of Statistical Software 71: 1â€“13.
Baron, R. M., and D. A. Kenny. 1986. â€œThe Moderator-Mediator Variable Distinction in Social Psychological Research: Conceptual, Strategic,
and Statistical Considerations.â€ Journal of Personality and Social Psychology 51: 1173â€“1182.
Busso, M., J. DiNardo, and J .McCrary. 2014. â€œNew Evidence on the Finite Sample Properties of Propensity Score Matching and Reweighting
Estimators.â€ Review of Economics and Statistics 96 (5): 885â€“897.
Chinkhumba, J., S. Godlonton, and R. Thornton. 2014. â€œThe Demand for Medical Male Circumcision.â€ American Economic Journal: Applied Economics 6: 152â€“177.
Donald, S. G., and Y.-C. Hsu. 2014. â€œEstimation and Inference for Distribution Functions and Quantile Functions in Treatment Effect Models.â€
Journal of Econometrics 178: 383â€“397.
Donald, S. G., Y.-C. Hsu, and R. P. Lieli. 2014. â€œTesting the Unconfoundedness Assumption via Inverse Probability Weighted Estimators of
(L)ATT.â€ Journal of Business & Economic Statistics 32 (3): 395â€“415.
Donald, S. G., Y.-C. Hsu, and R. P. Lieli. 2014. â€œInverse Probability Weighted Estimation of Local Average Treatment Effects: A Higher Order
MSE Expansion.â€ Statistics and Probability Letters 95:132â€“138.
Flores, C. A., and A. Flores-Lagunes. 2009. â€œIdentiï¬cation and Estimation of Causal Mechanisms and Net Effects of a Treatment under Unconfoundedness.â€ IZA Dicussion Paper No. 4237.
Gelman, A., and G. Imbens. 2013. â€œWhy ask Why? Forward Causal Inference and Reverse Causal Questions.â€ NBER Working Paper No. 19614.
Hayes, A. F. 2017. An introduction to mediation, moderation, and conditional process analysis: A regression-based approach. New york, USA: Guilford
Press.
Hirano, K., G. W. Imbens, and G. Ridder. 2003. â€œEfï¬cient Estimation of Average Treatment Effects Using the Estimated Propensity Score.â€
Econometrica 71: 1161â€“1189.
Hong, G. 2010. â€œRatio of mediator probability weighting for estimating natural direct and indirect effects,â€ in JSM Proceedings, Biometrics
Section, pp. 2401â€“2415. Alexandria, VA: American Statistical Association.
Hong, G. 2015. Causality in a social world: Moderation, mediation and spill-over. West Sussex, UK: John Wiley & Sons, Ltd.
Hsu, Y.-C. 2017. â€œConsistent Tests for Conditional Treatment Effects.â€ Econometrics Journal 20 (1):1â€“22.
Huber, M. 2014. â€œIdentifying causal mechanisms (primarily) based on inverse probability weighting.â€ Journal of Applied Econometrics 29: 920â€“
943.
Ichimura, H., and O. Linton. 2005. â€œAsymptotic Expansions for Some Semiparametric Program Evaluation Estimators,â€ in Identiï¬cation and
Inference for Econometric Models: essays in honor of Thomas Rothenberg, edited by D. Andrews and J. Stock. Cambridge, England: Cambridge
University Press.
Imai, K., L. Keele, and T. Yamamoto. 2010. â€œIdentiï¬cation, Inference and Sensitivity Analysis for Causal Mediation Effects.â€ Statistical Science
25: 51â€“71.
Imai, K., and T. Yamamoto. 2013. â€œIdentiï¬cation and Sensitivity Analysis for Multiple Causal Mechanisms: Revisiting Evidence from Framing
Experiments.â€ Political Analysis 21: 141â€“171.
Imbens, G. W. 2004. â€œNonparametric Estimation of Average Treatment Effects under Exogeneity: A Review.â€ The Review of Economics and
Statistics 86: 4â€“29.
Imbens, G. W., and J. M. Wooldridge. 2009. â€œRecent Developments in the Econometrics of Program Evaluation.â€ Journal of Economic Literature
47: 5â€“86.
Judd, C. M., and D. A. Kenny. 1981. â€œProcess Analysis: Estimating Mediation in Treatment Evaluations.â€ Evaluation Review 5: 602â€“619.
Li, Q., and J. S. Racine. 2007. Nanparametric econometrics: theory and practice. Princeton, New Jersey: Princeton Universiry Press.
MacKinnon, D. P. 2008. Introduction to Statistical Mediation Analysis. New York: Taylor and Francis.
Pearl, J. 2001. â€œDirect and indirect effects,â€ in Proceedings of the Seventeenth Conference on Uncertainty in Artiï¬cial Intelligence, pp. 411â€“420, San
Francisco. Morgan Kaufman.
Petersen, M. L., S. E. Sinisi, and M. J. van der Laan. 2006. â€œEstimation of Direct Causal Effects.â€ Epidemiology 17: 276â€“284.
Robins, J. M. 2003. â€œSemantics of causal DAG models and the identiï¬cation of direct and indirect effects,â€ in In Highly Structured Stochastic
Systems, edited by P. Green, N. Hjort, and S. Richardson, pp. 70â€“81, Oxford: Oxford University Press.
Robins, J. M., and S. Greenland. 1992. â€œIdentiï¬ability and Exchangeability for Direct and Indirect Effects.â€ Epidemiology 3: 143â€“155.
Rubin, D. B. 1974. â€œEstimating Causal Effects of Treatments in Randomized and Nonrandomized Studies.â€ Journal of Educational Psychology 66:
688â€“701.
Rubin, D. B. 2004. â€œDirect and Indirect Causal Effects via Potential Outcomes.â€ Scandinavian Journal of Statistics 31: 161â€“170.
Tchetgen Tchetgen, E. J. 2013. â€œInverse Odds Ratio-Weighted Estimation for Causal Mediation Analysis.â€ Statistics in Medicine 32: 4567â€“4580.
Tchetgen Tchetgen, E. J., and I. Shpitser. 2012. â€œSemiparametric theory for causal mediation analysis: Efï¬ciency bounds, multiple robustness,
and sensitivity analysis.â€ The Annals of Statistics 40: 1816â€“1845.
Ten Have, T. R., M. M. Joffe, K. G. Lynch, G. K. Brown, S. A. Maisto, and A. T. Beck. 2007. â€œCausal mediation analyses with rank preserving
models.â€ Biometrics 63: 926â€“934.
Tingley, D., T. Yamamoto, K. Hirose, K. Imai, and L. Keele. 2014. â€œMediation: R package for causal mediation analysis.â€ Journal of Statistical
Software 59: 1â€“38.
VanderWeele, T. J. 2009. â€œMarginal Structural Models for the Estimation of Direct and Indirect Effects.â€ Epidemiology 20: 18â€“26.
Unauthenticated
Download Date | 2/25/19 5:32 PM

19

Hsu et al.

DE GRUYTER

Automatically generated rough PDF by ProofCheck from River Valley Technologies Ltd

Vansteelandt, S., M. Bekaert, and T. Lange. 2012. â€œImputation Strategies for the Estimation of Natural Direct and Indirect Effects.â€ Epidemiologic Methods 1: 129â€“158.

20

Unauthenticated
Download Date | 2/25/19 5:32 PM

