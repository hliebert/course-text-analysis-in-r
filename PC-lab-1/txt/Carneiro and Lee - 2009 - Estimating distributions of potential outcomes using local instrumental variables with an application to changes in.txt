Journal of Econometrics 149 (2009) 191–208

Contents lists available at ScienceDirect

Journal of Econometrics
journal homepage: www.elsevier.com/locate/jeconom

Estimating distributions of potential outcomes using local instrumental variables
with an application to changes in college enrollment and wage inequality
Pedro Carneiro, Sokbae Lee ∗
University College London, Institute for Fiscal Studies and Centre for Microdata Methods and Practice, United Kingdom

article

info

Article history:
Received 3 April 2007
Received in revised form
8 January 2009
Accepted 9 January 2009
Available online 30 January 2009
JEL classification:
C14
C31
J31

a b s t r a c t
This paper extends the method of local instrumental variables developed by Heckman and Vytlacil
[Heckman, J., Vytlacil E., 2005. Structural equations, treatment, effects and econometric policy evaluation.
Econometrica 73(3), 669–738] to the estimation of not only means, but also distributions of potential
outcomes. The newly developed method is illustrated by applying it to changes in college enrollment and
wage inequality using data from the National Longitudinal Survey of Youth of 1979. Increases in college
enrollment cause changes in the distribution of ability among college and high school graduates. This
paper estimates a semiparametric selection model of schooling and wages to show that, for fixed skill
prices, a 14% increase in college participation (analogous to the increase observed in the 1980s), reduces
the college premium by 12% and increases the 90–10 percentile ratio among college graduates by 2%.
© 2009 Elsevier B.V. All rights reserved.

Keywords:
Comparative advantage
Composition effects
Local instrumental variables
Marginal treatment effect
Semiparametric estimation
Wage inequality

1. Introduction
The potential outcomes framework has been increasingly
popular in applied research. In a series of papers, Heckman
and Vytlacil (1999, 2001, 2005) developed the method of local
instrumental variables in nonparametric selection models using
potential outcomes. Heckman et al. (2006) further extended
the method of local instrumental variables and Aakvik et al.
(2005) used factor structures for the analysis of the latent
variable framework of Heckman and Vytlacil (1999, 2001, 2005).
Vytlacil and Yildiz (2007) considered marginal means of potential
outcomes in weakly separable models. Moffitt (2008) proposed a
nonparametric series estimation method of estimating marginal
treatment effects in heterogeneous populations. This paper makes
two new contributions to this literature: first, we show how to
extend the method of local instrumental variables of Heckman and
Vytlacil to identify the distributions of potential outcomes; second,
we develop a semiparametric method for estimating the entire
marginal distributions of potential outcomes.

Distributions of potential outcomes are useful for policy
makers who care about distributional effects of policies. To
our best knowledge, estimation of marginal distributions of
potential outcomes has been considered by Imbens and Rubin
(1997) and Abadie (2002, 2003).1 However, these three papers
develop estimators under the local average treatment effect
(LATE) framework of Imbens and Angrist (1994). They are
useful for evaluating the effects of polices in place, but not
for forecasting those of new polices. One could estimate a
structural econometric model that describes individual choices
and corresponding outcomes to predict the distributional effects
of new polices, but this would involve stringent parametric
and functional-form assumptions on the econometric model. In
this paper, we provide an alternative method that can be used
to evaluate the distributional effect of a new policy without
specifying a complete parametric model. Moreover, since quantile
treatment effects are defined as the differences between quantiles
of marginal distributions of potential outcomes, we also contribute

∗ Corresponding address: Department of Economics, University College London,
London, WC1E 6BT, United Kingdom. Tel.: +44 20 7679 5848.
E-mail addresses: p.carneiro@ucl.ac.uk (P. Carneiro), l.simon@ucl.ac.uk (S. Lee).

1 A recent working paper by Chen and Khan (2007) develops estimators of the
scale ratio between potential outcomes under some symmetry conditions on the
joint distribution of outcome and selection errors.

0304-4076/$ – see front matter © 2009 Elsevier B.V. All rights reserved.
doi:10.1016/j.jeconom.2009.01.011

192

P. Carneiro, S. Lee / Journal of Econometrics 149 (2009) 191–208

to the literature on quantile treatment effects and on instrumental
variables estimation of quantile regression models.2
We apply our method to investigate changes in college
enrollment and wage inequality in the United States. College
enrollment doubled from 30% to 60% between 1960 and 2000 in
the United States. Such a large increase in college enrollment rates
is bound to cause changes in the quality of college and high school
workers. As a result, we cannot compare measures of the college
premium and within group inequality across different periods.
Trends in the college premium and wage inequality confound
changes in prices and changes in composition, and it is important
to separate the two.
The goal of our empirical exercise is to uncover the empirical
magnitude of this problem, generally called the composition
effect. In order to do so, we estimate a semiparametric model of
heterogeneous agents self-selecting into college, and uncover the
magnitude of selection observed in the data.3 We use the resulting
estimates to characterize the distributions of wages for individuals
enrolling either in college or in high school at a given point in
time, and how they change in response to changes in college
enrollment. We find that, for fixed skill prices, an increase of 14%
in the proportion of college-goers (of similar magnitude to the one
observed in the 1980s) leads to: (i) a reduction of 12% in the college
premium; (ii) a 2% increase in the ratio of the 90th to the 10th
percentile (P90-P10) of the college wage distribution; (iii) and no
change in the P90-P10 ratio of the high school wage distribution.
The remainder of this paper is organized as follows. In Section 2
we present a simple econometric model which underlies our
empirical work. In Section 3, we describe the basic ideas behind
a semiparametric estimation procedure based on Section 2, and
in Section 4 we describe in detail the way we apply it. Section 5
presents asymptotic distributions for our estimators. The data
we use are described in Section 6. In Section 7 we apply our
model to the study of wage inequality using white males in the
NLSY. Using our estimates we document the patterns of sorting
of individuals to different levels of schooling and the empirical
importance of selection bias and composition effects. Section 8
gives some concluding remarks. In the Appendix we provide a
detailed description of the data, further details of our estimation
procedure, and proofs of theorems given in Section 5.
2. The econometric model and identification of distributions of
potential outcomes
The econometric model we consider is that of Heckman and
Vytlacil (1999, 2001, 2005).4 Let Y1 and Y0 be potential individual
outcomes in two states, 1 and 0. In this paper, Y1 is the log college
wage and Y0 is the log high school wage, as in Willis and Rosen
(1979).

2 Some recent papers in this literature include: Abadie et al. (2002), Chesher
(2003), Imbens and Newey (forthcoming), Chernozhukov and Hansen (2005, 2006),
Chernozhukov et al. (2007), Ma and Koenker (2006), Lee (2007), and Horowitz and
Lee (2007) among others.
3 One measure of the importance of selection is, say, the OLS-IV gap in estimates
of the returns to schooling. As discussed in Card (2001), the usual finding is that
instrumental variables (IV) estimates of the return to one year of schooling are
above ordinary least squares (OLS) estimates of the same parameter by 2 to 3
percentage points (corresponding to 25 to 50% of the size of the OLS coefficient).
Much of the literature on inequality studies the evolution of the college premium,
estimated as the difference in log wages of individuals with 12 and 16 years of
education. If we extrapolated the reported OLS-IV gap to four years of schooling we
would get something on the order of 8–12% percentage points. This corresponds
to roughly 20 to 25% of the college premium in 1980, and almost 40 to 50% of its
increase in between 1980 and 1990 (Katz and Murphy, 1992).
4 For example, see Section 2 of Heckman and Vytlacil (2005).

We assume
Y1 = µ1 (X , U1 )

and Y0 = µ0 (X , U0 ) ,

(2.1)

where X is a vector of observed random variables influencing
potential outcomes, µ1 and µ0 are unknown functions, and U1 and
U0 are unobserved random variables.
We assume that individuals choose to be in state 1 or 0 (prior
to the realizations of the outcomes of interest) according to the
following equation:
S=1

if µS (Z ) − US > 0,

(2.2)

where Z is a vector of observed random variables influencing
the decision equation, µS is an unknown function of Z , and US
is an unobserved random variable. In this paper, Eq. (2.2) can
be interpreted as the reduced form of an economic model of
college attendance.5 The advantage of specifying it this way is the
relatively little structure it imposes on the model. In particular,
Vytlacil (2002) shows that the independence and monotonicity
assumptions needed to interpret instrumental variables estimates
in a model of heterogeneous returns (e.g., Imbens and Angrist
(1994)) imply that the data can be rationalized with the model of
Eqs. (2.1) and (2.2) (as long as one does not impose parametric
functional forms and distributional assumptions on the model).
This result guarantees that our model is consistent with the IV
estimates of the returns to college that can be produced in our data.
For each individual, the observed outcome Y is
Y = SY1 + (1 − S )Y0 .
The set of variables in X can be a subset of Z . For identification,
assume that there is at least one variable in Z that is not in X
(exclusion restriction). As in Heckman and Vytlacil (2001, 2005),
we can rewrite (2.2) as:
S=1

if P > V ,

where V = FUS |X ,Z [US |X , Z ], P = FUS |X ,Z [µS (Z )|X , Z ], and
FUS |X ,Z (us |x, z ) is the CDF of US conditional on X = x and Z = z.6
Note that for any arbitrary distribution of US conditional on X and
Z , by definition, V ∼ Unif [0, 1] conditional on X and Z .
We make the following assumptions as in Heckman and Vytlacil
(2005).
Assumption 1. Assume that (1) µS (Z ) is a nondegenerate random
variable conditional on X ; (2) (U1 , US ) and (U0 , US ) are independent of Z conditional on X ; (3) The distribution of US conditional
on (X , Z ) and that of µS (Z ) conditional on X are absolutely continuous with respect to Lebesgue measure; and (4) For a measurable
function G, E |G(Y1 )| < ∞, and E |G(Y0 )| < ∞.
The following theorem provides identification of our objects of
interest in the nonparametric model given by (2.1) and (2.2).
Theorem 1. Consider the nonparametric selection model given
by (2.1) and (2.2). Let V
= FUS |X ,Z [US |X , Z ] and P =
FUS |X ,Z [µS (Z )|X , Z ]. Let Assumption 1 hold. Then
E [G(Y1 )|X = x, V = p] = E [G(Y )|X = x, P = p, S = 1]
∂ E [G(Y )|X = x, P = p, S = 1]
+p
∂p
E [G(Y0 )|X = x, V = p] = E [G(Y )|X = x, P = p, S = 0]
∂ E [G(Y )|X = x, P = p, S = 0]
− (1 − p)
∂p

5 Carneiro et al. (2007) use this model to study heterogeneity in the returns to
college and present an economic model that can justify the specification in (2.2).
6 Throughout the paper, for any random vector X , f (x) denotes the PDF of X and
X

FX (x) denotes the CDF of X . In addition, for any random variables X and Y , fY ,X (y, x),
fY |X (y|x), and FY |X (y|x) denote the joint PDF of Y and X and the conditional PDF and
CDF of Y on X = x, respectively. We suppress subscripts in the notation whenever
this can be done without causing confusion.

P. Carneiro, S. Lee / Journal of Econometrics 149 (2009) 191–208

provided that E [G(Y )|X = x, P = p, S = 1] and E [G(Y )|X = x, P =
p, S = 0] are continuously differentiable with respect to p for almost
every x.
Proof. Assumptions (1) and (3) ensure that P is a nondegenerate,
continuously distributed random variable conditional on X .
Assumption (4) is needed to ensure that the expectations
considered below are finite. Notice that
E [G(Y )|X = x, P = p, S = 1] = E [G(Y )|X = x, P = p, V < p]

193

as opposed to Y1 = µ1 (X , U1 ) and Y0 = µ0 (X , U0 ). In
addition, we impose flexible but parametric forms for (µ1 , µ0 ) and
a semiparametric form for µS on the model so that estimating the
model reduces to a feasible semiparametric estimation problem.
The main reason why we adopt this particular semiparametric
specification is that it is relatively more difficult to model
parametric relationships among unobservables, (U1 , US ) and
(U0 , US ) than those among observables. Exact specifications are
given in Section 7.1.8

p

Z

E [G(Y1 )|X = x, V = v ] fV |X (v|x)dv/p

=

3. Semiparametric estimation

0
p

Z

E [G(Y1 )|X = x, V = v ]

=
Z0 p
=

Z

fV |X ,Z (v|x, z )fZ |X (z |x)dzdv/p

E [G(Y1 )|X = x, V = v ] dv/p,

0

where the second equality follows from assumption (2), and
the fourth equality comes from the fact that V is uniformly
distributed on [0, 1] conditional on X and Z . The first conclusion
follows by multiplying both sides of the equation above by p and
differentiating both sides with respect to p. The proof of the second
conclusion is similar. 
This theorem extends the identification results of Heckman
and Vytlacil (1999, 2001, 2005).7 The conditional means of Y1
and Y0 given X = x and V = v are identified by taking
G(Y ) = Y and therefore the marginal treatment effect (MTE),
defined as E (Y1 − Y0 |X = x, V = v), is identified. Furthermore,
the conditional distributions of Y1 and Y0 given X = x and V =
v are identified by choosing G(Y ) = 1(Y ≤ y), where 1(·)
is the standard indicator function, and therefore the conditional
densities and quantiles are also identified.
Notice that we can only identify E [G(Y1 )|X = x, V = p] over
the support of P for individuals in S = 1 conditional on X = x,
and E [G(Y0 )|X = x, V = p] over the support of P for individuals in
S = 0 conditional on X = x. As a consequence, we can only identify
the MTE over the common support of P for individuals in S = 1 and
S = 0 conditional on X = x.
The identification result in Theorem 1 is very general since
it does not impose any restrictions on the functional forms
of µ1 and µ0 in (2.1). However, such a flexible framework
has some disadvantages that limit its practical usefulness. One
important disadvantage is that the precision of a nonparametric
estimator based on Theorem 1 decreases rapidly as the number
of continuously distributed components of X increases (curse of
dimensionality). Another disadvantage is that it is difficult to have
full support of P for some observed values of X , thereby implying
that treatment parameters such as the MTE or counterfactuals
distributions such as FY1 (y1 ) and FY0 (y0 ) are not identified.
To circumvent these disadvantages, we specify and estimate a
separable version of (2.1) under a more stringent assumption on
unobservables, but one that is relatively standard in empirical
work: we assume that (U1 , US ) is independent of Z as well
as independent of X ; likewise for (U0 , US ). The assumption of
separability implies the following modification in our model:
Y1 = µ1 (X ) + U1

(2.3)

Y0 = µ0 (X ) + U0 ,

7 The identification results of Heckman and Vytlacil (1999, 2001, 2005) are
mainly concerned with average treatment effects. Vytlacil and Yildiz (2007) develop
identification results for the marginal means of potential outcomes in weakly
separable models. We identify not only average treatment effects but also whole
marginal distributions of potential outcomes.

This section describes semiparametric estimators of the expectations, quantiles, and marginal distributions of Y1 and Y0 conditional on X = x and V = v . We consider a semiparametric
selection model given by (2.2) and (2.3). From now on, let V =
FUS [US ] and P = FUS [µS (Z )]. We now assume that:
Assumption 2. Assume that (1) µS (Z ) is a nondegenerate random
variable conditional on X ; (2) (U1 , US ) and (U0 , US ) are independent of (Z , X ); (3) The distributions of US and µS (Z ) are absolutely
continuous with respect to Lebesgue measure; (4) E |Y1 | < ∞ and
E |Y0 | < ∞; (5) 0 < Pr(S = 1|Z ) < 1; and (6) E [U1 |P = p, S = 1],
E [U0 |P = p, S = 0], fU1 |P ,S =1 (u1 |p) and fU0 |P ,S =0 (u0 |p) are continuously differentiable with respect to p.
We first consider estimation of E [Y1 |X = x, V = v] and
E [Y0 |X = x, V = v]. Under the assumption that (U1 , US ) and
(U0 , US ) are independent of X ,
E [Y1 |X = x, V = v] = µ1 (x, β1 ) + E [U1 |V = v],
and
E [Y0 |X = x, V = v] = µ0 (x, β0 ) + E [U0 |V = v],
where the functional forms of µ1 and µ0 are specified up to finite
dimensional parameters β1 and β0 . Thus, estimates of E [Y1 |X =
x, V = v] and E [Y0 |X = x, V = v] can be obtained by estimating
β1 , β0 , E [U1 |V = v], and E [U0 |V = v].
We estimate β1 and β0 using a semiparametric version of the
sample selection estimator of Das et al. (2003). Notice that under
the assumption that U1 and V are independent of X and Z , we have
E [Y |X = x, P = p, S = 1] = µ1 (x, β1 ) + λ1 (p),

(3.1)

where λ1 (·) is an unknown function of P. Equation Eq. (3.1)
suggests that β1 can be estimated by a partially linear regression
of Y on X and P using only observations with S = 1. Since P is
unobserved, Das et al. (2003) suggest a two-step procedure. The
first step consists in the construction of the estimated P and the
second step consists in the estimation of β1 using the estimated P.
In this paper, the first step is carried out by a series regression of
S on Z . In particular, we approximate µS (z ) by some linear parts
and some nonparametric parts. The second step is accomplished
using a Robinson (1988)-type estimator with the estimated P.9
Analogously, β0 can be estimated by a partially linear regression

8 One important advantage of estimating a flexible model over a complete
parametric model is that the sources of variation in the data that identify the model
are very clear, as are the types of simulations that can be performed. For example,
suppose that, empirically, the variables Z are never high enough or low enough to
induce full participation in college, or no participation in college. In this case we
cannot estimate the full distribution of unobserved heterogeneity, and we cannot
simulate economies where college participation rates are 0 or 1 without imposing
more structure in the model (e.g., Heckman and Vytlacil (2005), Ichimura and Taber
(2000)). The use of semiparametric methods forces discipline both in the reporting
of results, and in the construction of simulations within the range of the data.
9 Series estimation is used in Das et al. (2003) for both the first and second steps.
See also Heckman et al. (1998).

194

P. Carneiro, S. Lee / Journal of Econometrics 149 (2009) 191–208

of Y on X and estimated P using only observations with S = 0.
See Section 4.1 for a detailed description of our estimators of P, β1
and β0 .
We now consider estimation of E [Uj |V = v] for j = 0, 1. It
follows from directly applying Theorem 1 with G(u) = u:
E [U1 |V = v ] = E [U1 |P = v, S = 1]
∂ E [U1 |P = v, S = 1]

+v

E [U0 |V = v ] = E [U0 |P = v, S = 0]
∂ E [U0 |P = v, S = 0]
− (1 − v)
.
∂p

(3.3)

and

To obtain fY1 |X ,V (y1 |x, v) and fY0 |X ,V (y0 |x, v), once we know β1
and β0 we only need to estimate fU1 |V (u1 |v) and fU0 |V (u0 |v).
As in (3.2) and (3.3), we can obtain identifying relationships for
fU1 |V (u1 |v) and fU0 |V (u0 |v) and resulting sample analog estimators
can be constructed. Note that given estimators of PDF’s, it is
straightforward to obtain estimators of corresponding CDF’s by
integrating the estimated PDF’s, and to obtain estimators of
corresponding quantiles by inverting the estimated CDF’s. In
Section 4.3 we describe in detail the corresponding nonparametric
estimators.
Heckman and Vytlacil (2001, 2005) show how we can construct
a variety of treatment effect parameters as weighted averages
of E (Y1 − Y0 |X = x, V = v), and develop weights for several
parameters of interest. Drawing on their work, we can estimate
E [Yj ], E [Yj |S = 1], and E [Yj |S = 0] by integrating out our estimator
of E [Yj |X = x, V = v] with some suitable weights for j =
0, 1. Specifically, we obtain estimators of E [Yj ], E [Yj |S = 1], and
E [Yj |S = 0] by the sample analogs of the following formulae:
E [Yj |X = x, V = v]fX (x)dv dx,
E [Yj |X = x, V = v]
Pr(S = 1)

fX (x)dv dx,

This section provides a detailed description of our estimators
of P, β1 and β0 . Assume that the data consist of i.i.d. observations
{(Yi , Si , Xi , Zi ) : i = 1, . . . , n}. First, we consider series estimation
of P. In Section 3, P = FUS [µS (Z )] = Pr(S = 1|Z ). In order to
avoid the curse of dimensionality, we model Pr(S = 1|Z = z ) as a
partially linear additive regression model:
0
Pr(S = 1|Z = z ) = ϕ1 (z1 ) + · · · + ϕd (zd ) + zpc
ϑ,

where z = (zc , zpc ), zc = (z1 , . . . , zd ) is a d-dimensional vector
of continuous random variables (nonparametric components), zpc
is a vector of parametric components, ϕ1 , . . . , ϕd are unknown
functions, and ϑ is a vector of unknown parameters. The partially
linear additive structure in (4.1) is adopted to have a good precision
in our estimation procedure.
To describe the series estimator, let {pk : k = 1, 2, . . .} denote
a basis for real-valued smooth functions defined on R such that a
linear combination of {pk : k = 1, 2, . . .} can approximate ϕj (·)
for each j = 1, . . . , d as the number of approximating functions
increases to infinity. For any positive integer κ , define

(3.4)

θ̂nκ =

"
n
X
i=1

and

Z Z
E [Yj |S = 0] =
0

1

E [Yj |X = x, V = v]

FP |X (v|x)
Pr(S = 0)

(4.1)

0

where

0

×

4.1. Estimating P, β1 and β0

P̃ (Zi ) = Pκ (Zi )0 θ̂nκ ,

1

1 − FP |X (v|x)

4. Details of estimation procedure

Then for each i, the series estimator of P (Zi ) is

0

E [Yj |S = 1] =

E [Y1 |S = 1] and E [Y0 |S = 0] can also be estimated directly by
taking sample means of observed college and high school wages.
Therefore, comparison between model-based and direct estimates
of E [Y1 |S = 1] and E [Y0 |S = 0] provides a goodness-of-fit check of
our model.11 Similarly, integrating our estimators of fYj |X ,V (yj |x, v)
for j = 0, 1 with the weights in (3.4), we can obtain estimators
of fYj (·), fYj |S =1 (·|S = 1), and fYj |S =0 (·|S = 0) for j = 0, 1. Note
that fY1 |S =1 (·|S = 1) and fY0 |S =0 (·|S = 0) can also be estimated
directly by taking sample analogs of observed college and high
school wages, which again allows us to do a goodness-of-fit check
of our model.

Pκ (z ) = [p1 (z1 ), . . . , pκ (z1 ), . . . , p1 (zd ), . . . , pκ (zd ), zpc ]0 .

1

Z Z

TUT (Average Treatment Effect on the Untreated)

= E [Y1 |S = 0] − E [Y0 |S = 0],

fY0 |X ,V (y0 |x, v) = fU0 |V (y0 − µ0 (x, β0 )|v) .

E [Yj ] =

TT (Average Treatment Effect on the Treated)

OLS (Ordinary Least Squares) = E [Y1 |S = 1] − E [Y0 |S = 0].

Eqs. (3.2) and (3.3) are the basis for nonparametric estimators of
E [U1 |V = v] and E [U0 |V = v] proposed in this paper.
Local polynomial estimation is used in the paper to estimate
E (U1 |P = v, S = 1) (which corresponds to λ1 (p) |p = v in Eq. (3.1)),
E (U0 |P = v, S = 0) and their partial derivatives with respect to
P. This is because local polynomial estimation not only provides a
unified framework for estimating both a function and its derivative
but also has a variety of desirable properties in comparison to other
available nonparametric methods.10 See Section 4.2 for detailed
description of nonparametric estimators of E [U1 |V = v] and
E [U0 |V = v].
Finally, notice that fY1 |X ,V (y1 |x, v) and fY0 |X ,V (y0 |x, v) can be
obtained by location shifts from fU1 |V (u1 |v) and fU0 |V (u0 |v), i.e.,

Z Z

ATE (Average Treatment Effect) = E [Y1 ] − E [Y0 ],

= E [Y1 |S = 1] − E [Y0 |S = 1],
(3.2)

∂p

fY1 |X ,V (y1 |x, v) = fU1 |V (y1 − µ1 (x, β1 )|v)

for j = 0, 1. See Appendix B.1 for details on implementing
(3.4). Using estimates of these conditional expectations, standard
treatment effect parameters can be estimated:

fX (x)dv dx.

10 Fan and Gijbels (1996) provide a detailed discussion of the properties of local
polynomial estimators. The advantages of the local polynomial estimators are that
(1) the form of bias is simpler than that of the standard kernel estimator, (2) it adapts
to various types of distributions of explanatory variables, (3) it does not require
boundary modifications to achieve the same convergence rate, and (4) it has very
good minimax efficiency property.

#−1 "
Pκ (Zi )Pκ (Zi )

0

n
X

#
Pκ (Zi )Si .

i=1

In finite samples, estimated P (Zi )’s might be negative or larger than
one. To solve this, our estimator is a trimmed version:
P̂ (Zi ) = P̃ (Zi ) + (1 − δ − P̃ (Zi ))1(P̃ (Zi ) > 1)

+ (δ − P̃ (Zi ))1(P̃ (Zi ) < 0)

(4.2)

11 In this paper, we have not yet developed asymptotic distribution theory for
average treatment effects, such as ATE, TT, and TUT, nor asymptotic properties of
the proposed goodness-of-fit check. These are topics for future research.

P. Carneiro, S. Lee / Journal of Econometrics 149 (2009) 191–208

β̂j =

"
n
X

n

Wji µj (Xi ) − Êh

h

io0
h
io n
µj (Xi ) − Êh µj (Xi )|P̂ (Zi ), Wji
µj (Xi )|P̂ (Zi ), Wji

195

#−1

i=1

"
×

n
X

Wji

n

#
io
h
io n
h
,
Yi − Êh Yi |P̂ (Zi ), Wji
µj (Xi ) − Êh µj (Xi )|P̂ (Zi ), Wji

i=1

Box I.

for sufficiently small δ > 0.12
We now consider estimation of β1 and β0 . For convenience,
we assume linear-in-parameters forms for µ1 and µ0 , that is
µj (x, βj ) = µj (x)0 βj for each j = 0, 1. Then β1 and β0 are estimated
as in Robinson (1988) (using the estimated rather than the true P)
with the S = 1 subsample and the S = 0 subsample, respectively.
Specifically, see the equation in Box I, where for j = 0, 1, Wji =
1(j=1)

1(j=0)

1(Zi ∈ Z)(Si )
(1 − Si )
and Êh [·|·] denotes the kernel
mean regression estimator with a bandwidth h. Here, Z is a strict
subset of the support of Z . A trimming function of the form 1(Zi ∈
Z) is considered here to avoid unduly influences of outliers of Z .
Alternatively, one could consider Wn,ji = (Si )1(j=1) (1 − Si )1(j=0) ωn,ji ,
where ωn,ji is some trimming function that may converge to one at
a certain asymptotic rate.

Similarly, the estimator of E [U0 |V = v] can be obtained by
replacing unknown functions in the right hand side of (3.3) with
their nonparametric estimators.
4.3. Estimating f (u1 |v) and f (u0 |v)
This section describes nonparametric estimators of f (u1 |v) and
f (u0 |v). As in (3.2) and (3.3), an application of Theorem 1 yields the
following relationships
fU1 |V (u1 |v) = fU1 |P ,S =1 (u1 |v, S = 1)

∂
fU |P ,S =1 (u1 |v, S = 1) and
∂p 1
fU0 |V (u0 |v) = fU0 |P ,S =0 (u0 |v, S = 0)
+v

− (1 − v)

4.2. Estimating E [U1 |V = v] and E [U0 |V = v]
This section gives a detailed description of nonparametric
estimators of E [U1 |V = v] and E [U0 |V = v]. First consider local
polynomial estimation of E [U1 |V = v]. In general, the use of higher
order polynomials may reduce the bias but increase the variance
by introducing more parameters. Fan and Gijbels (1996) suggest
that the order π of polynomial be equal to π = µ + 1, where µ is
the order of the derivative of the function of interest. That is, Fan
and Gijbels (1996) recommend a local linear estimator for fitting
a function and a local quadratic estimator for fitting a first-order
derivative. Following their suggestions, E (U1 |P = v, S = 1) is
estimated by a local linear estimator using observations with S = 1
and ∂ E (U1 |P = v, S = 1)/∂ p is estimated by a local quadratic
estimator.
To be more specific, let {(Û1i , P̂i , Si ) : i = 1, . . . , n} denote
observations of estimated U1 and P along with S, where Û1i =
Yi −µ1 (Xi , β̂1 ) for i = 1, . . . , n. The local linear estimator Ê (U1 |P =
v, S = 1) is obtained by solving the problem
min
c0 , c1

n
h
X

Si Û1i − c0 − c1 (P̂i − v)

i =1

i2

K

P̂i − v
hn1

!
,

where K (·) is a kernel function and hn1 is a bandwidth. The
resulting value of c0 is the local linear estimator of E (U1 |P = v, S =
1). Similarly, the local quadratic estimator ∂ˆ E (U1 |P = v, S =
1)/∂ p is obtained by solving the problem
min

c0 , c1 , c2

n
h
X

Si Û1i − c0 − c1 (P̂i − v) − c2 (P̂i − v)2

i=1

i2

K

P̂i − v
hn2

,

where hn2 is a bandwidth that can be different from hn1 . The
resulting value of c1 is the local quadratic estimator of ∂ E (U1 |P =
v, S = 1)/∂ p. Then the estimator of E [U1 |V = v] is given by
Ê [U1 |V = v] = v

∂ˆ
E (U1 |P = v, S = 1) + Ê (U1 |P = v, S = 1).
∂p
(4.3)

12 Alternatively, one may develop the series estimator of P based on a logit or
probit model, so that the fitted probability always lies between 0 and 1.

(4.5)

Sample analogs of the right-hand sides of Eqs. (4.4) and (4.5) can
be obtained by some suitable nonparametric estimators.
We only discuss estimation of f (u1 |v) in detail, since estimation
of f (u0 |v) is similar. To develop an estimator of f (u1 |v) using the
equation Eq. (4.4), it is necessary to estimate fU1 |P ,S =1 (u1 |p, S = 1)
and its derivative with respect to p. Specifically, the estimator of
f (u1 |v) can be obtained by

∂ˆ
fU |P ,S =1 (u1 |v, S = 1) + fˆU1 |P ,S =1 (u1 |v, S = 1),(4.6)
∂p 1
where fˆU1 |P ,S =1 (u1 |v, S = 1) and ∂ˆ fU1 |P ,S =1 (u1 |v, S = 1)/∂ p are
fˆ (u1 |v) = v

defined below.
In order to compute fˆU1 |P ,S =1 (u1 |v, S = 1) and ∂ˆ fU1 |P ,S =1 (u1 |v,

S = 1)/∂ p in (4.6), we begin with estimated data {(Û1i , P̂i ) :
i = 1, . . . , n, Si = 1}, where Û1i = Yi − µ1 (Xi , β̂1 ). One
could estimate the conditional density of U1 given P and its
derivative by estimating the joint and marginal densities using
the standard kernel density estimators, taking the ratio between
them to estimate the conditional density, and finally computing a
derivative of the conditional density. This procedure would yield
consistent estimators but it is quite cumbersome. Instead we use
a direct method of Fan et al. (1996), who develop local polynomial
estimators of the conditional density function and its derivative. To
motivate the estimators of Fan et al. (1996), notice that, as δn → 0,


E

!

∂
fU |P ,S =0 (u0 |v, S = 0).
∂p 0

(4.4)

δn−1 K



U1 − u1

δn





P = v, S = 1 ≈ fU1 |P ,S =1 (u1 |v, S = 1)

∂
fU |P ,S =1 (u1 |v0 , S = 1)(v − v0 )
∂p 1
for any v in a neighborhood of v0 , where K is a nonnegative
density function and δn is a bandwidth. This suggests that the
local linear estimator of fU1 |P ,S =1 (u1 |v, S = 1) can be defined as
fˆU1 |P ,S =1 (u1 |v, S = 1) ≡ ĉ0 , where (ĉ0 , ĉ1 ) solves the problem
"
!
#2
n
X
Û1i − u1
−1
min
Si δn K
− c0 − c1 (P̂i − v)
c0 , c1
δn
i=1
!
P̂i − v
×K
,
(4.7)
≈ fU1 |P ,S =1 (u1 |v0 , S = 1) +

hn1

196

P. Carneiro, S. Lee / Journal of Econometrics 149 (2009) 191–208

and the local quadratic estimator of ∂ fU1 |P ,S =1 (u1 |v, S = 1)/∂ p can
be defined as ∂ˆ fU1 |P ,S =1 (u1 |v, S = 1)/∂ p ≡ ĉ1 , where (ĉ0 , ĉ1 , ĉ2 )
solves the problem
min

c0 , c1 , c2

n
X

"
Si δn−1 K

Û1i − u1

− c2 (P̂i − v)2

K

P̂i − v

Q̂Y1 |X ,V (τ |x, v) − Q̂Y0 |X ,V (τ |x, v).

!
.

hn2

(4.8)

The estimator defined in (4.6) is an unrestricted estimator. Thus, it
can be negative for a given finite sample, although it is a consistent
estimator of f (u1 |v) under certain regularity conditions. To ensure
that the estimator is positive in finite samples, we consider a
trimmed version of (4.6):
fˆpdf (u1 |v) = max[ε, fˆ (u1 |v)],
where ε is a fixed, very small positive number.
Now we describe estimators of F (u1 |v) and F (u0 |v). Again we
only discuss estimation of F (u1 |v).
To develop an estimator that is a distribution function for a
given finite sample, note that
F (u1 |v) = FU1 |V u1 |v +



Z

u1

fU1 |V (u|v)du,

(4.9)

u1

for any fixed
 constant u1 < u1 . We estimate F (u1 |v) by replacing
FU1 |V u1 |v and fU1 |V (u|v) in (4.9) with their sample analogs. More



specifically, the estimator of FU1 |V u1 |v is defined as
cdf

F̂U1 |V (u1 |v) = max[0, F̂U1 |V (u1 |v)],

(4.10)

where
F̂U1 |V (u1 |v) = v

∂ˆ
FU |P ,S =1 (u1 |v, S = 1)
∂p 1

+ F̂U1 |P ,S =1 (u1 |v, S = 1),
and F̂U1 |P ,S =1 (u1 |v, S = 1) and ∂ˆ FU1 |P ,S =1 (u1 |v, S = 1)/∂ p,
respectively, are local linear and quadratic estimators that
solve the problems similar to those in (4.7) and (4.8) with

δn−1 K (Û1i − u1 )/δn replaced by 1(Û1i ≤ u1 ). Then our estimator
of F (u1 |v) is defined as
"
#
Z u1
cdf
F̂cdf (u1 |v) = min 1, F̂U |V (u1 |v) +
fˆpdf (u|v)du .
1

Q̂Y1 |X ,V (τ |x, v) = µ1 (x, β̂1 ) + Q̂U1 |V (τ |v).
Therefore, we can also obtain estimators of marginal quantile
treatment effects, which are defined as

− c0 − c1 (P̂i − v)

δn

i =1

#2

!

assumption that U1 and V are independent of X and Z , the τ -th
quantile of Y1 conditional on X = x and V = v can be estimated by

u1

The constant u1 can be chosen such that most of estimated values
Û1i are greater than u1 . Notice that by construction, our estimator
is a strictly increasing, continuous function of u1 (for u1 > u1 ) and
is restricted to be between 0 and 1. In other words, our estimator
is a distribution function for a given finite sample. One could also
use an unrestricted estimator (4.10), which is not necessarily a
distribution function in finite samples.
Notice that as a by-product of estimating F̂cdf (u1 |v), we obtain
an estimator of the τ -th quantile of U1 conditional on V = v for any
τ ∈ (0, 1), which is denoted by QU1 |V (τ |v). Simply, the estimator
is given by

This is a quantile analog to the marginal treatment effect of
Heckman and Vytlacil (1999, 2001, 2005).
5. Asymptotic properties of the estimators
This section provides asymptotic properties of the proposed
estimators. The proof of theorems in this section are provided
in the Appendix. Recall that Zc denotes the components of Z
which enter nonparametrically in the estimation of P. We consider
regression splines as approximating functions {pk : k = 1, . . .}
since regression splines have a smaller bias than power series
(Newey, 1997). The following assumptions are standard in the
literature on series estimation (Newey, 1997).
Assumption 3. The data {(Yi , Si , Xi , Zi ) :
independent and identically distributed.

i

= 1, . . . , n} are

This is a standard assumption in empirical microeconomics,
but it has some limitations. One limitation that might be related
with our application is that we do not allow for clustered data.
The extension of the asymptotic results obtained in this section to
clustered data is non-trivial, and we leave it for future research.
Assumption 4. The support of Zc is known and is a Cartesian
product of compact connected intervals on which Zc has a
probability density function that is bounded away from zero.
Assumption 5. Each function ϕj in (4.1) is rϕ -times continuously
differentiable on the support of Zc for some rϕ > 2.
Assumptions 4 and 5 are standard in the literature (Newey,
1997). In particular, Assumption 5 implies that the asymptotic bias
(due to the series approximation by regression splines) converges
to zero at a rate of κ −rϕ as the number of approximation functions,
κ , diverges to infinity.
Note that a finite-sample correction in (4.2) would not have
any effect on the asymptotic properties of the estimator. Then the
following theorem is a standard result in series estimation.
Theorem 2. Let Assumptions 2–5 hold. Then with regression splines
as approximating functions, we have
max |P̂ (Zi ) − P (Zi )| = Op

i=1,...,n

h κ
n1/2

i
+ κ −(2rϕ −1)/2 .

We now consider the asymptotic distribution of n1/2 (β̂j − βj )
for j = 0, 1. Let Wj = 1(Z ∈ Z)S 1(j=1) (1 − S )1(j=0) , where Z is a
strict subset of the support of Z . We make additional assumptions
that are standard in semiparametric estimation.
Assumption 6. Assume that P (Z ) is continuously distributed and
its density is bounded away from zero on Z.

−1
Q̂U1 |V (τ |v) = F̂cdf
(τ |v) ,

It might be too strong to assume that P is bounded away from
zero on the whole support of Z .13 Instead, we assume that it holds
in an interior of the support of Z .

where the right-hand side is unique for a given finite sample
provided that u1 is sufficiently small, since F̂cdf (u1 |v) is a strictly
increasing function when u1 > u1 . Furthermore, under the

13 We would like to thank an associate editor for pointing this out.

P. Carneiro, S. Lee / Journal of Econometrics 149 (2009) 191–208

Assumption 7. The conditional expectation E [µj (X )|P = p, Wj ] is
twice continuously differentiable with respect to p and its kernel
estimator Êh [µj (X )|P = p, Wj ] is consistent uniformly over p ∈ P ,
where P is an interior of the range of P (Z ) on Z. Furthermore,
assume that
sup Êh [µj (X )|P = p, Wj ] − E [µj (X )|P = p, Wj ] = op n−1/4 .



p∈P

Note that Assumption 8 is satisfied, for example, if κ ∝ na with
1/(2rϕ ) < a < 1/4. For j = 0, 1, define

h

0i
Ωj = E Wj µj (X ) − E [µj (X )|P , Wj ] µj (X ) − E [µj (X )|P , Wj ] ,
"
#
∂λj (p)
νj (z ) = E Wj (µj (X ) − E [µj (X )|P , Wj ])
Z =z ,
∂ p p=P

R
v u4 K (u)du ∂ 3 E [U1 |P = v, S = 1]
R
B1 (v) =
,
3! u2 K (u)du
∂ p3
R 2 2
u K (u)du E [(U1 − E [U1 |P = v, S = 1])2 |P = v, S = 1]
V1 (v) = v 2 R
,
2
fP ,S =1 (v)
u2 K (u)du
R
−(1 − v) u4 K (u)du ∂ 3 E [U0 |P = v, S = 0]
R
B0 (v) =
,
3!
∂ p3
u2 K (u)du
R 2 2
u K (u)du
V0 (v) = (1 − v)2 R
2
u2 K (u)du
×

and


Σj = E [Wj Uj2 µj (X ) − E [µj (X )|P , Wj ] (µj (X )


− E [µj (X )|P , Wj ])0 ] + E P (1 − P )νj (Z )νj (Z )0 ,
where λj (p) was defined in (3.1) for j = 1 and can be defined
similarly for j = 0.
Assumption 9. For each j = 0, 1, Ωj is positive definite, νj (z )
is continuously differentiable with respect to z, E [νj (Z )νj (Z )0 ] is
nonsingular, and Σj is finite.
The following theorem gives the asymptotic distribution of the
estimator of βj for j = 0, 1.
Theorem 3. Let Assumptions 2–9 hold. Then for each j = 0, 1, as
n → ∞,
n1/2 (β̂j − βj ) →d N(0, Ωj−1 Σj Ωj−1 ),
Our estimation details are different from Das et al. (2003);
however, the asymptotic distribution of n1/2 (β̂j −βj ) is comparable
to that of Das et al. (2003). It is straightforward to construct a
sample analog of the asymptotic variance Ωj−1 Σj Ωj−1 . We now
turn to estimation of E [Uj |V = v] for j = 0, 1.
Assumption 10. E [Uj |V
=
differentiable for j = 0, 1.

v] is four times continuously

Assumption 12.
max |P̂i − Pi | = op h2n1



and

i:1≤i≤n

max |P̂i − Pi | = op h2n2 .



i:1≤i≤n

In addition,

→ ∞ and

h3n2
hn1

E [(U0 − E [U0 |P = v, S = 0])2 |P = v, S = 0]
fP ,S =0 (v)

.

This theorem says that the asymptotic distributions of the
estimators of E [U1 |V = v] and E [U0 |V = v] are driven by
corresponding partial derivative estimators and that estimation
errors from β̂j and P̂i are asymptotically negligible. The asymptotic
bias is not easy to estimate because it involves nonparametric
estimation of higher-order partial derivatives, but one can adopt
undersmoothing to make the asymptotic bias negligible (at the
expense of slower rates of convergence in distribution). The
asymptotic variance is relatively easy to estimate (e.g., see
equations (4.8) and (4.9) of Fan and Gijbels (1996)). Combining
theorems above gives the main result of this section.
Theorem 5. Let Assumptions 2–12 hold. Then for any x in the support
of X and for any point v that is in the interior of the range of P (Z ) on
Z, the asymptotic distributions of the estimators of E [Y1 |X = x, V =
v], E [Y0 |X = x, V = v], and E [Y1 − Y0 |X = x, V = v] are as follows:

n
o
(nh3n2 )1/2 Ê [Y1 |X = x, V = v] − E [Y1 |X = x, V = v] − B1 (v)h2n2
→d N(0, V1 (v)),
n
o
(nh3n2 )1/2 Ê [Y0 |X = x, V = v] − E [Y0 |X = x, V = v] − B0 (v)h2n2
→d N(0, V0 (v)),
and


(nh3n2 )1/2 Ê [Y1 − Y0 |X = x, V = v] − E [Y1 − Y0 |X = x, V = v]

Assumption 11. K is a second-order kernel function with compact
support and is Lipschitz continuous.

hn1

Theorem 4. Let Assumptions 2–12 hold. Then for any point v that is
in the interior of the range of P (Z ) on Z, the asymptotic distributions
of the estimators of E [U1 |V = v] and E [U0 |V = v] are normal with
the same means and variances that they would be if U1i , U0i , and Pi
were observed directly. Furthermore, and
n
o
(nh3n2 )1/2 Ê [U0 |V = v] − E [U0 |V = v] − B0 (v)h2n2 →d N(0, V0 (v)),
where

Assumption 8. Assume that κ 4 /n → 0 and κ 2rϕ /n → ∞.

hn2

197

→ 0.

The following theorem gives the asymptotic distribution of the
estimators of E [Uj |V = v] for j = 0, 1.

− {B1 (v) − B0 (v)} h2n2 →d N(0, V1 (v) + V0 (v)),
where Bj (v) and Vj (v), j = 0, 1, are defined in Theorem 4.
It would be straightforward to establish similar results for
estimators of distributions of Y1 and Y0 conditional on X =
x and V = v . In particular, the asymptotic distributions of
the estimators would be driven by corresponding nonparametric
partial derivative estimators. We have not developed asymptotic
theory for average treatment effects, such as ATE, TT, and TUT.
Notice that Theorem 5 provides asymptotic normality only for
interior points of V . To develop asymptotic results for objective
defined in (3.4), it would be necessary to extend our asymptotic
results for boundary points with careful treatment on tail
conditions. This is a topic for future research.

198

P. Carneiro, S. Lee / Journal of Econometrics 149 (2009) 191–208

6. Data
The dataset we use consists of a sample of white males surveyed
in the NLSY. In the NLSY there exists detailed information on
cognitive ability and family background, which are important
determinants of both schooling and labor market outcomes.
Furthermore we know the place of residence of most respondents
in the NLSY during their adolescent years. As a result, we can
construct school and labor market characteristics in different
areas of residence of adolescent NLSY respondents and use them
as instrumental variables for schooling, as is often done in the
literature.
We estimate the model for 1992, 1994, 1996 and 1998. The
reason we choose to start our analysis in the 1990s and not before
is because NLSY respondents were very young in the 1980s. Our
sample consists of white males born between 1957 and 1964. The
hourly wage measure we use was created by the NLSY. In order to
minimize measurement error and reduce concerns with selective
unemployment, our wage measure for each year is a 5 year average
of all non-missing wages reported in the five year interval centered
in the year of interest.14 The model of Section 2 only allows for
selection into two levels of schooling, so we need to group some
schooling categories into these two. The two groups we consider
are: high school graduates plus high school dropouts; and some
college plus college graduates and above.15
The instruments for schooling we use are standard in the
literature: distance to college, tuition, and local unemployment
rates, all measured in the place of residence of each individual
during late adolescence.16 We provide details on their construction
in the Appendix.
7. Selection bias, composition effects and the evolution of
inequality
7.1. Specification of the model
We consider potential wage equations for the college and
high school sectors, denoted by Y1 and Y0 . Considering only two
schooling levels is a limitation of our analysis, but nevertheless a
common practice in the literature on inequality (and in studies of
the returns to schooling using selection models, such as Willis and
Rosen (1979), and Carneiro et al. (2007)). 17 Using the econometric
framework described in previous sections, we can estimate
the following objects: E (Y1 |X = x, V = v), E (Y0 |X = x, V = v),
FY1 |X ,V (y1 |x, v) and FY0 |X ,V (y0 |x, v). These functions tell us how the
distributions of counterfactual wages vary with observed (X ) and
unobserved (V ) heterogeneity.

14 The percentage of individuals in our sample who have a missing observation
for our measure of wages (due to unemployment or non-reporting, but not due to
attrition in the panel) is the following for each year: 3.21% in 1992, 3.03% in 1994,
3.19% in 1996, and 2.78% in 1998. When we use different measures of wages such
as yearly wages or averages over three years of wages, our results are qualitatively
similar but they are more imprecise.
15 The wage distribution of the NLSY roughly replicates that of the CPS during the
1990s for white males born between 1957 and 1964 (available on request from the
authors).
16 For example, see Cameron and Taber (2004), Card (1995, 1999), Carneiro et al.
(2007), Currie and Moretti (2003), Kane and Rouse (1995), Kling (2001), among
others.
17 Heckman and Vytlacil (2005) consider models with multiple levels of schooling,
but which we have difficulty implementing with the data at hand. Allowing for
multiple levels of schooling would in principle require different instruments for
different transitions, although that may not be strictly necessary provided that
different regressors have different effects in different transitions (see, e.g., Heckman
and Navarro (2007)).

Our focus on E (Y1 |X = x, V = v), E (Y0 |X = x, V = v), FY1 |X ,V
(y|1 x, v ) and FY0 |X ,V (y0 |x, v) is useful for two reasons. First, they
help us characterize how individuals sort across different levels
of schooling according to observed and unobserved heterogeneity.
Second, these objects are especially useful for simulating the effect
of changes in composition on inequality. As college enrollment
increases, there will be changes in the distribution of X and V
at each level of schooling because some individuals will switch
from high school to college (those who switch will probably be
those at the margin). If we can characterize these changes, then
we can use them together with our estimates of FY1 |X ,V (y1 |x, v)
and FY0 |X ,V (y0 |x, v) to compute the implied effects on inequality
(see Heckman and Vytlacil (1999, 2001, 2005)).
We now turn to the exact specification of the equations that
we estimate. The X vector in the log wage equations includes
years of actual experience, the Armed Forces Qualifying Test score
(AFQT, a measure of cognitive ability), number of siblings, mother’s
years of schooling, father’s years of schooling, cohort dummies,
and the state unemployment rate in the current state of residence
(five year average centered in the year of interest, mimicking our
construction of wages). In order to use a flexible specification for
the X s each variable (except the dummy variables and the current
state unemployment rate) enters with a linear and a quadratic
term. We also interact number of siblings, mother’s education and
father’s education. Finally, we include a dummy variable for being
a high school dropout for the high school wage equation, a dummy
variable for being a college attendee without a college degree
for the college wage equation, and interactions of these variables
with quadratic polynomials in experience and AFQT (the most
important observables in the wage equations). This is an attempt
to allow for some selection on observables within each broad
schooling category (fully interacted models where we interact all
variables with one another produce qualitatively similar results
but more imprecision).
We use a partially linear additive model for schooling choice.
In particular, regressors (the Z vector) include a constant, cohort
dummies, distance to college (an indicator variable for whether a
four-year college is in the county of residence at age 14), linear
terms of family background variables (number of siblings, mother’s
schooling, and father’s schooling), interactions between distance
to college and family background variables, and cubic B-splines
with equally spaced knots (based on quantiles of variables of
interest) for corrected AFQT, unemployment at 17, and college
tuition at 17. The number of interior knots as well as the inclusion
of interaction terms were determined by the least squares crossvalidation method. The variables that we exclude from the
outcome equations are distance to college, tuition and local
unemployment rate. Distance is a strong predictor of schooling, but
it takes only two values. By interacting it with family background
variables in the model we are able to expand the available variation
in this variable. The proportion of observations that were trimmed
in implementing (4.2) is between 0.07 and 0.08 across years. We
set δ to be 1e − 8 in (4.2).
Sample statistics are presented in Table 1. In each year of our
data, individuals who attend college have on average higher wages
than those who do not attend college. They also have fewer years of
experience, higher levels of cognitive ability, fewer siblings, more
educated parents, live nearer to colleges and in counties with lower
tuition at age 17 than those individuals who never enrolled in
college. College enrollment rates increase from 50% (1992) to 52%
(1998), although we follow relatively mature cohorts for college
enrollment (the NLSY respondents in year 1992 are between 28
and 35 years old).

P. Carneiro, S. Lee / Journal of Econometrics 149 (2009) 191–208

199

Table 1
Summary statistics of data.
Variable

Year 1992
Mean

College (S = 1)
Log Wage
Years of Experience
Current Unemployment
Born in 57
Born in 58
Born in 59
Born in 60
Born in 61
Born in 62
Born in 63
Corrected AFQT
Number of Siblings
Mother’s Schooling
Father’s Schooling
Distance to College
Unemployment at 17
College tuition at 17
Some college

Year 1994
SD

n = 907
2.70
7.65
7.46
0.10
0.12
0.09
0.12
0.14
0.17
0.14
0.56
2.61
12.91
13.70
0.58
7.09
2.05
0.46

High school (S = 0)

n = 898

Log wage
Years of experience
Current unemployment
Born in 57
Born in 58
Born in 59
Born in 60
Born in 61
Born in 62
Born in 63
Corrected AFQT
Number of siblings
Mother’s schooling
Father’s schooling
Distance to college
Unemployment at 17
College tuition at 17
High school dropout

2.36
10.94
7.34
0.10
0.08
0.12
0.14
0.13
0.17
0.14
−0.46
3.25
11.31
11.06
0.47
7.10
2.12
0.19

Mean

Year 1996
SD

n = 903
0.55
3.36
1.37
0.30
0.32
0.29
0.33
0.34
0.37
0.34
0.77
1.66
2.25
3.15
0.49
1.86
0.78
0.50

2.74
9.46
5.93
0.10
0.11
0.09
0.12
0.14
0.17
0.14
0.56
2.61
12.90
13.67
0.58
7.08
2.05
0.45

2.37
12.69
5.80
0.10
0.08
0.12
0.14
0.13
0.17
0.14
−0.47
3.26
11.27
11.00
0.46
7.09
2.11
0.18

Year 1998
SD

n = 893
0.55
3.57
1.29
0.30
0.32
0.29
0.33
0.34
0.37
0.34
0.77
1.66
2.21
3.14
0.49
1.87
0.79
0.50

n = 872
0.58
3.24
1.48
0.30
0.28
0.33
0.35
0.34
0.37
0.34
0.90
2.06
2.15
2.98
0.50
1.81
0.85
0.39

Mean

2.81
11.14
5.25
0.10
0.11
0.10
0.12
0.13
0.16
0.14
0.56
2.65
12.87
13.61
0.57
7.08
2.05
0.45

2.40
14.40
5.12
0.10
0.08
0.12
0.14
0.13
0.17
0.13
−0.49
3.24
11.25
10.98
0.46
7.07
2.11
0.17

SD

n = 891
0.55
3.70
1.05
0.30
0.32
0.29
0.33
0.34
0.37
0.34
0.76
1.72
2.24
3.17
0.50
1.87
0.78
0.50

n = 844
0.55
3.46
1.24
0.30
0.27
0.33
0.34
0.33
0.37
0.34
0.89
2.08
2.16
2.96
0.50
1.81
0.84
0.38

Mean

2.88
12.93
4.27
0.11
0.11
0.10
0.13
0.13
0.15
0.14
0.53
2.66
12.82
13.58
0.57
7.09
2.06
0.45

0.57
3.91
0.93
0.31
0.32
0.30
0.34
0.34
0.36
0.35
0.77
1.73
2.25
3.19
0.50
1.86
0.79
0.50

n = 821
0.50
3.63
1.02
0.30
0.27
0.32
0.35
0.33
0.37
0.34
0.88
2.03
2.16
2.96
0.50
1.81
0.83
0.37

2.45
16.02
4.26
0.10
0.08
0.12
0.14
0.13
0.17
0.13
−0.50
3.28
11.24
10.94
0.46
7.09
2.09
0.17

0.54
3.96
0.94
0.30
0.27
0.32
0.35
0.33
0.38
0.34
0.89
2.05
2.15
2.93
0.50
1.82
0.83
0.37

Entries in this table are means and standard deviations of variables. For each year, n denotes the sample size of each schooling group. The log wages are 5 year averages of
non-missing hourly wages. Years of experience are actual work experience from 1979. Current unemployment is 5 year averages of the state unemployment in percentage in
the current state of residence. The omitted variable for the birth-year is 1964. Correct AFQT is schooling-adjusted and normalized to have mean zero in the NLSY population.
Parental schooling is measured in years of education. Distance to college is an indicator variable that has value one when there is a four-year college in the county of residence
at age 14. Unemployment at 17 is the unemployment rate in percentage in the state of residence at 17. College tuition at 17 is the average tuition in thousand dollars of four
year public colleges in the county of residence at 17. Finally, some college and high school dropouts are indicator variables that have value one when an individual belongs
to corresponding education groups.

In implementing our selection model we estimate the model for
each year where the dependent variable is college attendance.18
Average derivatives are presented in Table 2. Ability and family
background are strong predictors of college attendance. The
presence of a college in the county of residence at 14 is also
an important determinant of enrollment in college, as are local
unemployment and tuition. We test the null hypothesis that three
average derivatives for instruments are all zeros and reject this null
hypothesis at any conventional level.
For each year we estimate fY1 |X ,V (y1 |x, v) and fY0 |X ,V (y0 |x, v)
and then weight these objects with appropriate weights to
construct the counterfactuals of interest, as described in Section 4.
However, it is only possible to estimate these functions within the
support of the data. In particular, we can only estimate them for

18 Alternatively we could have estimated a single selection model for all the
years of the sample. The reason we choose not to do it is that, even though these
individuals are well into their adult years in the beginning of the 1990s, there are
still changes in schooling attainment during the decade. In particular, the college
enrollment rate in this sample increases from 50% to 52%. A similar pattern is found
in the CPS. When we redo the analysis considering that schooling is fixed at a
particular level for all the years the overall results do not change substantially.

values of X and P (accordingly V ) for which we have individuals
both in college and high school. Fig. 1 shows the support of the data
for 1992, a representative year in our sample (this figure varies very
little across years). The top two figures refer to P and the bottom
two figures refer to AFQT. AFQT is only one of the variables in the X
vector on which we condition, but it is the most important one and
is also most likely to have non-overlapping supports (see Table 1).
Notice that the support of P is almost the full unit interval which
allows us to estimate our model over the full support of V . We
are able to achieve large support for P because: (i) we combine
multiple instruments into an index; (ii) if we assume that X is
independent of (U1 , U0 , V ) we can trade-off variation in X and Z to
increase the support of P (since X is controlled for in the outcome
equations in a very flexible way).19 Most of our simulations are

19 When X is not independent of (U , U , V ) our procedure is not valid and the
1
0
identification condition is that P has full support at each value of X , which is a very
demanding condition. For each X , variation in P identifies the objects of interest for
small intervals of V . However, if X is independent of (U1 , U0 , V ) we can put these
intervals all together and identify the objects interest over the whole support of V .
This is equivalent to using not only Z , but also interactions of X and Z as instruments

200

P. Carneiro, S. Lee / Journal of Econometrics 149 (2009) 191–208

Fig. 1. Support of P and AFQT (Year 1992). This figure shows the support of the data for 1992. The top two figures refer to P and the bottom two figures refer to AFQT.

within the range of the data, since we only consider movements
in P in regions well within the support.
7.2. Choosing tuning parameters
In our implementation of (4.2), we used δ = 1e − 8.20 Also,
in our application, we use cubic B-splines with equi-spaced knots
(based on sample quantiles of variables) as {pk : k = 1, 2, . . .}.
The number of approximating functions is chosen by least-squares
cross validation. In our empirical work, β1 and β0 are estimated
with ωn,ji ≡ 1 in Box I and a bandwidth of h = 0.10 (with the

for college attendance (controlling for X in the wage regressions). In such a case it
is important to ensure that variation in P is not driven exclusively by variation in
X . In order to assess the importance of this problem we performed the following
exercise. Let D = 1 indicate the presence of a college in the county of residence
at 14. We divided the sample into four groups according to S and D, and checked
the support of P in each group: S = 1 and D = 1, S = 0 and D = 1, S = 1 and
D = 0, S = 0 and D = 0. For each group, the support of P is close to the interval
between 0 and 1. Conversely, if we look at the extremes of the support of P, there
are individuals with both D = 1 and D = 0.
20 This is an arbitrary choice; however, the result would not be very sensitive,
provided that δ is sufficiently small.

standard normal density as kernel function) for estimation of the
kernel estimator. The main estimation results did not change as
we used alternative bandwidths (0.05 and 0.20), or we trimmed
the data by 5 or 10% of the observations with the smallest density
estimates of the estimated P.
Estimating E (U1 |P = v, S = 1) and its derivative requires
choices of two bandwidths hn1 and hn2 . A reasonable data-driven
bandwidth selection rule is important to carry out nonparametric
estimation. We carry out some initial search for bandwidths using
a method called residual squares criterion (RSC) proposed in
Fan and Gijbels (1996, Section 4.5). After experimenting different
bandwidths around RSC-chosen bandwidths, we finally choose
hn1 = 0.35 and hn2 = 1.25hn1 for estimating both E (Y1 |X , V )
and E (Y0 |X , V ) for all the years. The bandwidth hn2 is chosen to
be larger than hn1 since hn2 has to go to zero at a rate slower
than hn1 asymptotically. Varying the value of hn1 from 0.2 to 0.5
did not make any important changes in the shape of estimated
functions. Throughout the paper, we use the standard normal
density function as the kernel function K .
To estimate these conditional PDF’s and CDF’s, we adopt the
same bandwidths hn1 and hn2 that are used to estimate the
corresponding conditional means. The bandwidth δn is chosen by
Silverman’s normal reference rule ((Silverman, 1986), p.45). These

P. Carneiro, S. Lee / Journal of Econometrics 149 (2009) 191–208

201

Table 2
Average derivatives for the college attendance logit model.
Variable

Year 1992

Year 1994

Year 1996

Year 1998

Corrected AFQT

0.2171
(0.0116)
−0.0514
(0.0158)
0.2110
(0.0840)
0.3585
(0.0601)
0.0119
(0.0067)
−0.0270
(0.0142)
0.0403
(0.0200)

0.2194
(0.0115)
−0.0465
(0.0157)
0.2079
(0.0842)
0.3839
(0.0597)
0.0140
(0.0067)
−0.0335
(0.0144)
0.0459
(0.0200)

0.2283
(0.0110)
−0.0377
(0.0167)
0.1231
(0.0847)
0.4168
(0.0600)
0.0148
(0.0069)
−0.0365
(0.0147)
0.0402
(0.0202)

0.2231
(0.0111)
−0.0446
(0.0167)
0.1303
(0.0851)
0.4093
(0.0608)
0.0140
(0.0070)
−0.0270
(0.0147)
0.0506
(0.0204)

0.0073

0.0008

0.0012

0.0018

Number of siblings
Mother’s schooling
Father’s Schooling
Unemployment at 17
College tuition at 17
Distance to college
Test for Instruments
P-value

For each year, the average derivatives are obtained from a partially linear additive regression of college attendance on explanatory variables using B-splines. In particular,
regressors include a constant, cohort dummies, distance to college (a dummy variable), linear terms of family background variables (number of siblings, mother’s schooling,
and father’s schooling), interactions between distance to college and family background variables, and cubic B-splines with equally spaced knots (based on quantiles of
variables of interest) for corrected AFQT, unemployment at 17, and college tuition at 17. The number of interior knots as well as the inclusion of interaction terms were
determined by the least squares cross-validation method. Standard errors are in parentheses. The last row shows p-values for the null hypothesis that three average
derivatives for instruments are all zeros.

Fig. 2. MTE as a Function of AFQT (Year 1992). This figure shows estimates of
E (Y1 | AFQT , X , V = 0.5), E (Y0 | AFQT , X , V = 0.5), and E (Y1 − Y0 | AFQT , X , V =
0.5), as functions of AFQT, along with 95% pointwise asymptotic confidence
intervals for E (Y1 − Y0 | AFQT , X , V = 0.5). The remaining X variables are fixed
at 10 years of experience, 3 siblings, 12 years of mother’s and father’s education,
cohort at 1964 and 7% for the local unemployment rate.

choices of bandwidths are arbitrary, but our estimation results
were not very sensitive to the choices of the bandwidths.
7.3. Empirical results
There are three components in our empirical analysis. First, we
analyze how individuals sort into different levels of schooling and
illustrate how sorting affects inequality. Second, we investigate the
role of composition changes for the evolution of inequality. Third,
we characterize selection bias and its evolution over time.21
7.3.1. Characterizing the patterns of sorting
We start by presenting estimates of E (Y1 |X , V ) and E (Y0 |X , V )
for 1992, a representative year in our sample. Fig. 2 shows

21 We have carried out an informal goodness-of-fit check of our model specification by comparing estimates of E (Y1 |S = 1), E (Y0 |S = 0), Quantile (Y1 |S = 1) and
Quantile (Y0 |S = 0) from the model with the corresponding quantities in the data,
for all the years of our analysis. Overall, our model fits the data relatively well, giving
us confidence in the specification of the model.

estimates of E (Y1 |AFQT , X , V = 0.5), E (Y0 |AFQT , X , V = 0.5),
and the difference between these two objects, as functions of
AFQT, along with 95% pointwise asymptotic confidence intervals
for E (Y1 − Y0 |AFQT , X , V = 0.5).22
We fix years of experience at 10 to abstract from life-cycle
effects, V at its median value, and the remaining variables in X at:
3 siblings, 12 years of mother’s and father’s education, cohort at
1964 and 7% for the local unemployment rate. This figure shows
that, in 1992, on average AFQT is a strong determinant of college
wages (Y1 ) and of the return to college (Y1 − Y0 ), but not of high
school wages (Y0 ).
In Fig. 3 we graph E (Y1 |AFQT = 0, X , V ), E (Y0 |AFQT = 0, X , V ),
E (Y1 − Y0 |AFQT = 0, X , V ) (the Marginal Treatment Effect, or
MTE, of Heckman and Vytlacil (2001, 2005)), as functions of V ,
along with 95% pointwise confidence intervals for E (Y1 − Y0 |AFQT
= 0, X , V ). Again we fix years of experience at 10 and the remaining X variables at the values described above apart from AFQT,
which we fix at its mean value 0. As V increases, college wages decrease and so does the return to college, while high school wages
increase (recall that the higher the V is, the smaller the likelihood
that an individual enrolls in college).
These figures show that those individuals most likely to attend
college (the ones with high levels of AFQT and low levels of V ) have
high wages in the college sector (since college wages increase with
AFQT and decrease with V ) but have low wages in the high school
sector (since high school wages do not move substantially with
AFQT and increase with V ). Conversely, individuals less likely to
attend college have low college wages and high high school wages.
In summary, individuals sort into the sector where they have both
comparative and absolute advantage.
These results confirm the findings in Willis and Rosen (1979),
Carneiro et al. (2007), and Deschenes (2007). Single skill models

22 The pointwise asymptotic confidence intervals were constructed by normal
approximations with estimated pointwise asymptotic variances, while ignoring
asymptotic biases (undersmoothing). The asymptotic variance is estimated based
on equation (4.8) and (4.9) of Fan and Gijbels (1996). Alternatively, one could
consider bootstrap confidence intervals (for example, a percentile method for each
point). See Horowitz (2001, Section 4.2) for general exposition on bootstrapping
kernel-type estimators and Chen et al. (2003, Theorem B) for the asymptotic validity
of the bootstrap inference for the GMM-type semiparametric estimators. It is
expected that the bootstrap provides an asymptotically valid inference for our case,
but it is beyond the scope of this paper to prove its validity.

202

P. Carneiro, S. Lee / Journal of Econometrics 149 (2009) 191–208

Fig. 3. MTE as a Function of V (Year 1992). This figure shows estimates of
E (Y1 | AFQT = 0, X , V ), E (Y0 | AFQT = 0, X , V ), and E (Y1 − Y0 | AFQT = 0, X , V ),
as functions of V , along with 95% pointwise asymptotic confidence intervals for
E (Y1 − Y0 | AFQT = 0, X , V ). The remaining X variables are fixed at 10 years of experience, 3 siblings, 12 years of mother’s and father’s education, cohort at 1964 and
7% for the local unemployment rate.

of the labor market implicit in standard specifications of earnings
equations with no heterogeneity predict college goers to have
higher earnings both in the high school and college sectors than
high school graduates. Our findings (and those of the recent
literature cited above) are inconsistent with such a model (see also
Heckman and Scheinkman (1987); Heckman and Sedlacek (1985)
and Gould (2002, 2005)). Similar patterns are found for other years,
as shown in Fig. 4 (which shows these graphs for 1992, 1994, 1996
and 1998).
Fig. 5 presents estimates of the 25th, 50th and 75th percentiles
of f (u1 |v) and f (u0 |v) for 1992 (which, under our assumptions,
correspond up to location to f (y1 |x, v) and f (y0 |x, v)). U1 and U0
are normalized to have mean zero. The way these three quantiles
vary with V parallels the patterns we observed for means. While
the dispersion in Y1 is flat over a large range of V , the dispersion
in Y0 increases more visibly with V . The latter indicates that the
components of heterogeneity that do not determine selection are
more disperse for individuals with a higher level of V (indicating
more uncertainty in high school wages; see Carneiro et al. (2003)),
or that the prices of these components of heterogeneity (skills) are
higher for individuals with a high V .23
7.3.2. Composition effects and education policy
In this section we examine the importance of changes in the
educational composition of the population for wage inequality.
Since we follow a single cohort of individuals over time, there
are no significant composition changes which we can examine
in the raw data. Therefore, instead of looking directly to the
data for evidence of composition effects, we use our estimates
of the selection and outcome equations to simulate what would
happen to inequality if college enrollment rates were different
than the ones we observe, keeping prices fixed (partial equilibrium
framework; see also Ferreira and Leite (2005)).

23 When estimating the model using data for the 1980s the patterns of selection
we obtained were quite unstable, unlike what we observe in the 1990s when,
across different years, all the curves have similar shapes. In terms of selection on
AFQT, we observe roughly similar patterns for the 1980s and 1990s (at least in
qualitative terms). However, the patterns of selection on unobservables are more
erratic. Therefore we believe our estimates for the 1990s to be much more reliable
and we ignore the 1980s data in the rest of our analysis. We also note that the 1980s
data is not very adequate for our analysis since most individuals are in their 20s, and
their wages have not yet stabilized.

The main difficulty of this exercise is to determine which individuals shift across schooling levels when the college enrollment
rate changes. This is why a model is needed. Even though our data
is only representative of a fixed set of cohorts working in the 1990s,
our model can be useful for studying other time periods. The restriction we face is that we can only simulate changes in composition for skill prices fixed at their 1990s levels, and skill prices are
probably higher in the 1990s than ever before. Therefore composition effects will be larger when we evaluate them using 1990s
prices than they would be if we evaluated them instead using
1980s prices or 1970s prices.
The mechanics of the simulation are simple: first we change the
intercept of the schooling equation and we identify the distribution
of (X , V ) for individuals who are induced to enroll in college;
second we generate the distribution of high school and college
wages for this set of individuals; third, we compute how their
exit from the high school sector affects the high school wage
distribution and how their entry into the college sector affects
the college wage distribution. We use the estimates using the
1992 data. The details of the simulation procedure are presented
in Appendix B.2. When conducting the simulations, our aim is
to mimic the change in college participation among working-age
(25–65) white males that is observed between the 1980 and 1990
Censuses, which is an increase from 41% to 55%.
Table 3 (columns (1) and (2)) shows the result of an experiment
where we increase the fraction of individuals in college from 41%
to 55% (which, according to the Census, is roughly the same change
that is observed from 1980 to 1990 for white males aged 25 to
65). The consequence is a decrease in average college wages by 5%,
and an increase in average high school wages by 7%. The reason
is that the marginal individuals induced to attend college are of
below average college quality and they are also of below average
high school quality. As a result, the OLS estimate of the return to
schooling decreases from 54% to 42%.
We simulate much smaller changes in within group inequality
and overall inequality as a result of changes in composition.
The ratio of the 90th to the 10th percentile of college wages
increases from 1.29 to 1.31, an increase of 2%. In high school, the
90-10 percentile wage differential does not change. Finally, our
simulations show a very small decrease in the 90-10 differential
in the overall wage distribution, from 1.30 to 1.29.
Our simulation shows that in the absence of composition
effects the college premium in the 1980s would have grown by
12 percentage points more than it did in the data. Even if we
exaggerate the magnitude of these effects by using 1990s prices,
we conjecture that they would be still large if evaluated at 1980s
prices. Ignoring them would lead us to severely underpredict the
increase in the college premium in the 1980s. As a flip side, if we
were to estimate the elasticity of substitution between college and
high school labor in this data, it would be overstated.
The consequences of our simulated changes in composition
for within group inequality are smaller, although they are still
sizeable in the college sector. At first glance it is surprising to find
large effects of composition on between group inequality but small
effects on within group and overall inequalities. However, it is
possible to reconcile these facts. This will happen if the amount
of heterogeneity on which individuals select does not explain a
lot of the dispersion in wages. As emphasized in Carneiro et al.
(2003) and Cunha et al. (2005), even if the returns to schooling
are very heterogeneous across individuals, individuals only select
on returns to the extent that this heterogeneity is known at the
time they make the schooling decision. In our data individuals do
select into schooling based on their returns. However, their ex-ante
expectation of returns is quite imperfect, and it only accounts for a

P. Carneiro, S. Lee / Journal of Econometrics 149 (2009) 191–208

203

Table 3
Results of Simulating 1980’s.
Column
Variable

(1)
Simulation 1980

(2)
Simulation 1990

(3)
Census 1980

(4)
Census 1990

Panel A: College
College enrollment rates
Average college wages
90-10 College Wages

0.41
2.78
1.29

0.55
2.73
1.31

0.41
2.72
1.46

0.55
2.76
1.57

Panel B: High school
Average high school wages
90–10 high school wages

2.23
1.09

2.30
1.09

2.50
1.34

2.43
1.43

Panel C: All individuals
Average overall wages
90-10 Overall Wages

2.45
1.30

2.54
1.29

2.60
1.41

2.62
1.56

Panel D: Return to college
College premium (OLS)

0.54

0.42

0.22

0.33

Columns (3) and (4) present measures of average schooling and characteristics of the wage distribution using Census data from 1980 and 1990 for white males. Columns (1)
and (2) present characteristics of simulated wage distributions from our model under the assumption that the college participation rate is 41% (the third column) and 55%
(the fourth column).

Fig. 4. E [Y1 |X , V ] and E [Y0 |X , V ] (All Years) This figure shows estimates of E [Y1 |X , V ] and E [Y0 |X , V ] for years 1992, 1994, 1996 and 1998, as functions of AFQT and V . The
remaining X variables are fixed at 10 years of experience, 3 siblings, 12 years of mother’s and father’s education, cohort at 1964 and 7% for the local unemployment rate.

204

P. Carneiro, S. Lee / Journal of Econometrics 149 (2009) 191–208

Table 4
Analysis of Counterfactual Variances of Y1 and Y0 .
Component

Year 1992

Year 1994

Year 1996

Year 1998

0.223
0.068
0.013
0.736

0.206
0.078
0.023
0.670

0.188
0.070
0.015
0.688

0.218
0.099
0.015
0.656

0.156
0.071
0.116
0.455

0.126
0.085
0.132
0.367

0.138
0.033
0.039
0.656

0.174
0.036
0.085
0.589

Panel A: Variance decomposition of Y1
E [Var(U1 |V )]
Var[µ1 (X )]
Var[E (U1 |V )]
E [Var(U1 |V )]/Var(Y1 )
Panel B: Variance decomposition of Y0
E [Var(U0 |V )]
Var[µ0 (X )]
Var[E (U0 |V )]
E [Var(U0 |V )]/Var(Y0 )

The first panel of this table decomposes the variance of Y1 in a component due to X (second line), another due to V (third line) and a third one due neither to X nor V (first
line). The latter represents the variance in Y1 that is not related with selection and in the fourth line of the panel we report the percentage of the total variance accounted
for this component. The second panel presents a similar decomposition for Y0 .

a residual component (on which agents do not select).25 Carneiro
et al. (2003) and Cunha et al. (2005) interpret the former as (exante) heterogeneity and the latter as uncertainty. We could also
relate the former to the permanent component and the latter to
the transitory component of an earnings variance decomposition.
The latter accounts for 66%–74% of the variance of college wages
and 37%–66% of the variance of high school wages (the literature
on earnings dynamics usually finds that the permanent component
represents 50% of the total variance of earnings and that this
number is higher in college than high school; see, e.g., Meghir and
Pistaferri (2004)).

Fig. 5. Q [U1 |V ] and Q [U0 |V ] (Year 1992). This figure shows estimates of the
25th, 50th and 75th percentiles of f (u1 | v) and f (u0 | v) for 1992. U1 and U0 are
normalized to have mean zero.

small portion of the total dispersion in the returns to schooling.24
In such a context, it is possible to have a large impact of changes in
composition on average parameters such as the college premium,
but only a small effect on dispersion parameters, such as the 90–10
percentile ratio.
In Table 4 we compute the variance of counterfactual wages in
each sector (Var(Y1 ) and Var(Y0 )) for all the years and decompose
it into components due to X and V (on which agents select), and

7.3.3. The importance of selection bias
The fact that individuals sort into different levels of schooling
implies that selection bias affects both within and between group
inequality and their evolution over time. Selection bias is always
defined relatively to a specific parameter of interest. Here we
illustrate the role of selection bias by comparing inequality in the
observed economy with inequality in a simulated counterfactual
economy where individuals are randomly assigned to different
schooling levels, as in Heckman and Sedlacek (1985, 1990).
Therefore, we assess the effect of selection bias on inequality
parameters under random assignment. We are able to approximate
random assignment fairly well because we have close to full
support on P, although, as mentioned above, this relies on the
assumption of full independence between (X , Z ) and (U1 , U0 , V ).
The first column of Table 5 characterizes the observed
distribution of log wages in 1992, and the second column of
the table corresponds to the counterfactual distribution of log
wages in the same year for the random assignment economy.
Columns (3) and (4) of the table show the actual and counterfactual
distributions of log wages in 1998, and columns (5) and (6) concern
the evolution of these distributions between 1992 and 1998.
Composition changes do not contaminate this exercise because
most individuals in the sample are out of school during the 1990s.
In both 1992 and 1998, average wages in college (panel A)
and high school (panel B) are higher in the observed economy
than in the random assignment economy due to self selection. The

25 In particular, since X and U are assumed to be independent:
1
Var(Y1 ) = Var [µ1 (X )] + Var(U1 )

= Var [µ1 (X )] + Var [E (U1 |V )] + E [Var (U1 |V )] ,

24 This interpretation will change under different assumptions about the agents’
access to insurance markets. As argued in Cunha et al. (2005), it is not possible
to estimate the information set of the agents without first specifying the market
structure they face.

where Var [E (U1 |V )] is the component of variance due to V and E [Var (U1 |V )] is the
remainder. Var(Y0 ) can be decomposed in the same way. The first row of Table 4
corresponds to E [Var (U1 |V )], the part of the variance that cannot be associated
with selection, the second corresponds to Var [µ1 (X )], the third corresponds to
Var [E (U1 |V )] and the fourth corresponds to E [Var (U1 |V )] /Var(Y1 ), the fraction of
the variance in Y1 that is not due to any variable related to selection into schooling.

P. Carneiro, S. Lee / Journal of Econometrics 149 (2009) 191–208

205

Table 5
The Impact of self-selection on the distribution of log wages, 1992 and 1998.
Column

(1)
NLSY 92

(2)
Random 92

(3)
NLSY 98

(4)
Random 98

(5)
NLSY 98–92

(6)
Random 98–92

2.70
1.25
0.62
0.63

2.58
1.39
0.63
0.76

2.88
1.31
0.70
0.61

2.79
1.50
0.72
0.78

0.18
0.06
0.08
−0.02

0.21
0.11
0.09
0.02

2.36
1.10
0.54
0.56

2.00
1.24
0.76
0.48

2.45
1.17
0.59
0.58

2.21
1.16
0.58
0.58

0.09
0.07
0.05
0.02

−0.08
−0.18

Panel C: Return to college
OLS
0.34

0.58

0.43

0.58

0.09

0.00

Panel A: college
Mean
P90-P10
P90-P50
P50-P10
Panel B: High school
Mean
P90-P10
P90-P50
P50-P10

0.21

0.10

The first column of the table reports actual values for the distribution of log wages in 1992, whereas the second column of the table provides counterfactual values for the
distribution of log wages in 1992 that would be observed if individuals were randomly assigned to college and high-school sectors. Columns (3) and (4) of the table show
the actual and counterfactual distributions of log wages in 1998 and columns (5) and (6) give the differences between the 1992 and 1998 values. OLS in the last row denotes
the Ordinary Least Squares estimate of return to college.

college premium (panel C) is lower in the observed than in the
random assignment economy in 1992, although in theory this was
not guaranteed to happen (the college premium in the random
assignment economy corresponds to the average treatment effect,
or ATE). The observed OLS estimate increased by 9%, but there is no
increase in the average return to college in the random assignment
economy. Thus, the commonly used measure of college premium
cannot reveal the true evolution of skill prices.
Table 5 also shows that selection leads to lower within group
wage dispersion in college (measured by differences in percentiles
of the log wage distribution). In high school the effect of selection is
negligible in 1998. Finally, selection bias leads us to underestimate
the growth in within group inequality in college relative to the
random assignment economy (with the exception of the P90-P50
differential in college) and to have a different trend in within group
inequality in high school.
8. Conclusion
Much of the literature on inequality considers simple models
without heterogeneity and self-selection into schooling. Our paper
examines the importance of accounting for selection into schooling
in the empirical study of inequality. We estimate a semiparametric
selection model with two levels of schooling (high school and
college) using four years of data (1992, 1994, 1996 and 1998) from
the NLSY, and use it for three different exercises. First, we have
used it to understand the main patterns of sorting of individuals
into different levels of schooling. We find that individuals sort into
the level of schooling where they have absolute and comparative
advantage. Second, we have used the model to simulate a change in
college enrollment and examine its effect on the wage structure. In
our data increases in educational attainment lead to reductions in
between group inequality and increases in within group inequality
in college. Third, we have used it to analyze the evolution of
inequality and of its determinants in our sample during the 1990s,
purging our estimates of selection bias. We find that the trends in
the commonly measured college wage premium and within group
inequality cannot reveal the trends of prices of skills.
We have also made two new contributions to the econometrics literature. First, we have extended the method of local instrumental variables of Heckman and Vytlacil (1999, 2001, 2005) to
identify the distributions of potential outcomes. Second, we have
developed a semiparametric method for estimating the entire
marginal distributions of potential outcomes.
Some of the effects we emphasize in this paper are also
present in some analyses of larger samples. Using the Census, Juhn

et al. (2005) find evidence of cohort quality effects systematically
related to the educational attainment of different cohorts, but
argue these can only explain a small fraction of recent fluctuations
in the college premium. Carneiro and Lee (2007), using almost
the same data but an alternative approach, find larger effects.
However, more work remains to be done.
Acknowledgments
We thank an editor, an associate editor, and three anonymous
referees for helpful comments. Especially, we thank one anonymous referee for pointing out a mistake in the previous version of
this paper. We also thank participants in numerous seminars for
useful comments, especially Rita Almeida, Joe Altonji, David Autor,
Richard Blundell, Olympia Bover, Peter Gottschalk, Alan Krueger,
Alan Manning, Costas Meghir, Steve Pischke and Tom Stoker. This
research is supported in part by the Economic and Social Research
Council (ESRC) Research Grant RES-000-22-2542. We thank the
Leverhulme Trust and ESRC (RES-589-28-0001) through the funding of the Centre for Microdata Methods and Practice (Carneiro and
Lee) and of the research programme Evidence, Inference and Inquiry
(Lee). Carneiro also thanks the Poverty Unit of the World Bank Research Group and Georgetown for their hospitality. Earlier versions
of the paper were circulated under the titles ‘‘Changes in College
Enrollment and Wage Inequality: Distinguishing Price and Composition Effects’’ and ‘‘Ability, Sorting and Wage Inequality’’.
Appendix A. Description of the data
We restrict the NLSY sample to white males. We define
four schooling categories: high school dropouts, high school
graduates, some college and college graduates. Because there are
multiple useful reports of schooling in the NLSY we construct
the educational categories as follows: individuals without a high
school degree are high school dropouts; individuals with a high
school degree but with less than 13 years of schooling are high
school graduates; those reporting 13 to 15 years of schooling and
without a four year college degree go into the some college group;
finally, those reporting a four year college degree or 16 or more
years of schooling are considered to be four year college graduates.
GED recipients who never attend college are included in the group
of high school graduates. GED recipients that do not have a high
school degree, who have less than 12 years of schooling completed
and who never reported college attendance are excluded from the

206

P. Carneiro, S. Lee / Journal of Econometrics 149 (2009) 191–208

sample. The wage variables we use are deflated (to 1983) nonmissing hourly wages from 1990 to 2000. We use these to construct
5 year averages which we use in the analysis. We delete all wage
observations that are below 1 or above 100. Experience is actual
work experience in weeks accumulated from 1979 to the year of
interest (annual weeks worked are imputed to be zero if they are
missing in any given year). The remaining variables that we include
in the X and Z vectors are number of siblings, father’s years of
schooling, mother’s years of schooling, schooling corrected AFQT,
average tuition in four year colleges in the county of residence
at age 17 deflated (to 1993), distance to four-year colleges at age
14 and local unemployment rate in state of residence at age 17.
The distance variable, which is from Kling (2001), is an indicator
variable whether a four-year college is in the county of residence
at age 14. The state unemployment rate data comes from the BLS
website. However, from the BLS website it is not possible to get
state unemployment data for all states for all the 1970s (data is
available for all states from 1976 on, and it is available for 29 states
for 1973, 1974 and 1975), and therefore for some of the individuals
we have to assign them the unemployment rate in the state of
residence in 1976 (which will correspond to age 19 for those born
in 1957 and age 18 for those born in 1958). Annual records on
tuition, enrollment, and location of all public four year colleges
in the United States were constructed from the Department
of Education’s annual Higher Education General Information
Survey and Integrated Postsecondary Education Data System
‘‘Institutional Characteristics’’ surveys. By matching location with
county of residence, we determined the presence of four-year
colleges. Tuition measures are taken as enrollment weighted
averages of all public four-year colleges in a person’s county of
residence (if available) or at the state level if no college is available.
County and state of residence at 17 are not available for everyone
in the NLSY, but only for the cohorts born in 1962, 1963 and 1964
(age 17 in 1979, 1980 and 1981). However, county and state of
residence at age 14 is available for most respondents. Therefore, we
impute location at 17 to be equal to location at 14 for cohorts born
between 1957 and 1962 unless location at 14 is missing, in which
case we use location in 1979 for the imputation. For a description of
the NLSY sample see BLS (2001). The NLSY79 has an oversample of
poor whites which we exclude from this analysis. We also exclude
the military sample. To remove the effect of schooling on AFQT we
implement the same procedure as in Carneiro et al. (2007) (based
on Hansen et al. (2004)).

ˆ (S = j) is the sample proportion of S = j for
FP |X (v|x), and Pr
j = 0, 1. The integration with respect to v can be evaluated
numerically.
B.2. Simulating Wage distributions of different compositions of
education groups
This subsection describes how we carry out simulations whose
results are shown in Table 3. Suppose there is a policy that shifts
the distribution of P in the population from FP |X (p|x) to FP∗|X (p|x),
but has no effect on f (y0 |x, v) nor f (y1 |x, v). In view of (3.4), the
post-policy distributions of college and high school wages are
f (y1 |S = 1) =

Z Z

1

f (y1 |x, v)

0

1 − FP∗|X (v|x)
Pr∗ (S = 1)

fX (x)dv dx,

and
f (y0 |S = 0) =

(B.2)

Z Z

1

f (y0 |x, v)

0

FP∗|X (v|x)
Pr∗ (S = 0)

fX (x)dv dx.

Thus, in order to simulate wage distributions of different
compositions of education groups, we need to compute only
FP∗|X (p|x) and Pr∗ (S = 1). Recall that in our empirical work, P̂
is a series estimator. We simulate changes in college enrollment
rates simply by varying the intercept of P̂. Then FP∗|X (p|x) can be
estimated by a nonparametric kernel regression of 1{(P̂ + c∗ ) ≤
p} on X and Pr∗ (S = 1) can be estimated by a sample average
of (P̂ + c∗ ), where we choose the values of c∗ to match college
enrollment rates in 1980 and 1990. Finally the results shown in
Table 3 can be obtained by sample analogs of (B.2).
Appendix C. Mathematical proofs
Proof of Theorem 2. Given the partially linear additive structure
in the modeling of P, this lemma is a direct consequence of
Theorem 7 of Newey (1997).


Appendix B. More details of estimation procedure

Proof of Theorem 3. This can be proved using general results
for two-step semiparametric estimators. In particular, we verify
regularity conditions of Ichimura and Lee (2006, hereafter IL) and
apply their general theorem to our case. We consider only the case
that j = 1. The other case is very similar. To simplify the notation,
we make our derivation below implicit in the trimming function
1(z ∈ Z). Now we view the estimator β̂1 as an M-estimator with

B.1. Obtaining sample analogs of (3.4)

m [(y, s, x, z ), b, f (·)] =

Estimators of E [Yj ], E [Yj |S = 1], and E [Yj |S = 0] are obtained
by
E [Yj ] = n−1

n Z
X
i=1

1

Ê [Yj |X = Xi , V = v]dv,
0

E [Yj |S = 1] = n−1

n Z
X

Ê [Yj |X = Xi , V = v]
0

i=1

×

1

1 − F̂P |X (v|Xi )

ˆ (S = 1)
Pr

(B.1)

dv,

and
E [Yj |S = 0] = n−1

n Z
X
i=1

1

Ê [Yj |X = x, V = v]
0

F̂P |X (v|Xi )

ˆ (S = 0)
Pr

dv,

where Ê [Yj |X = x, V = v] = µj (x, β̂j ) + Ê [Uj |V = v] is defined
in Section 4.2, F̂P |X (v|x) is a nonparametric kernel estimator of

2
1 
s y − f1 (f3 (z )) − {x − f2 (f3 (z ))}0 b ,
2

where f = (f1 , f2 , f3 ) are the nonparametric components of the
model. In particular, the true function f0 = (f10 , f20 , f30 ) satisfies
f10 (·) = E [Y |P = ·, S = 1], f20 (·) = E [X |P = ·, S = 1], and
f30 (·) = E [S |Z = ·].
First, we check their regularity conditions. Assumption 3.1(a)
of IL is not needed in our case because we have an estimator
that minimizes a convex objective function. Assumptions 3.1(b)
is guaranteed by the assumption that Ωj is positive definite (see
Section 4 of Robinson (1988)). The consistency of the estimator can
be easily obtained in view of Assumption 7, so that Assumption
3.1(c) is satisfied. Assumptions 3.2 and 3.3 of IL are trivially
satisfied given the form of the objective function m. In view of
Theorem 2, Assumption 8 implies that
max |P̂ (Zi ) − P (Zi )| = op n−1/4 .



i:1≤i≤n

Then using this and Assumption 7, Assumption 3.4 of IL is easily
verified. Given the form of m, it is trivial to verify Assumption
3.5 of IL (see, Proposition 3.1 of IL and discussions on Examples

P. Carneiro, S. Lee / Journal of Econometrics 149 (2009) 191–208

207

2.2 and 2.3 of IL). Assumption 3.6 of IL is a key assumption that
characterizes the effect of the first stage estimation of P. Using the
notation that is same as in IL, it is straightforward to calculate

which implies that the error from estimating β1 is asymptotically
negligible.
To analyze Tn (v), define

Df1 m∗ (b, f0 (·))[h1 (·)] = −E [S {(Y − E [Y |P , S = 1])

U∗ = (E [U1 |P = P1 , S = 1], . . . , E [U1 |P = Pn , S = 1])0

− (µ1 (X ) − E [µ1 (X )|P , S = 1]) b}h1 (·)],
0

and

Df2 m∗ (b, f0 (·))[h2 (·)] = E [S {(Y − E [Y |P , S = 1])

1

.

XL =  ..
1

Proof of Theorem 4. Define Û =


(P̂1 − v)

..

.

h

Û11 , . . . , Û1n

i0

(P̂1 − v)
..
.



1

.

and X̂Q =  ..

(P̂n − v)

(P̂n − v)

1

0



Ê [U1 |V = v] = v × e02 X̂Q Ŵhn2 X̂Q
0

+ e01 X̂L Ŵhn1 X̂L

0

 −1 

0

X̂Q Ŵhn2 Û



X̂L Ŵhn1 Û ,

Ŵhn1 − Whn1

= op (1). By a Taylor series

and Ŵh

=


(P̂1 − v)2

..
.
.

(P̂n − v)

1 ∂ 2 E [U1 |P = v, S = 1]
2

where Rp (v) is a Taylor remainder term. Further, expand the
equation above as
E [U1 |P = Pi , S = 1] = E [U1 |P = v, S = 1]
∂ E [U1 |P = v, S = 1]
+
(P̂i − v)
∂p
∂ E [U1 |P = v, S = 1]
−
(P̂i − Pi )
∂p

+

2

+

1 ∂ 2 E [U1 |P = v, S = 1]

∂ p2

2

(Pi − v)2

1 ∂ 3 E [U1 |P = v, S = 1]

∂ p3

3!



(Pi − v)3 + Rp (v).

Using (C.4) and (C.5), we have
(C.1)



0

e01 X̂L Ŵhn1 X̂L

−1 

0



X̂L Ŵhn1 U − E [U1 |P = v, S = 1]

where e1 = (1, 0)0 and e2 = (0, 1, 0)0 .
Let U = [U11 , . . . , U1n]0 and µ
1 (X) = [µ1 (X1 ), . . . , µ1 (Xn )].

 0
−1  0

X̂L Ŵhn1 [U − U∗ ]
= e01 X̂L Ŵhn1 X̂L


+ Op max |P̂i − Pi | + h2n1



Ê [U1 |V = v] = Tn (v) − Rn (v) β̂1 − β1 ,

−1 0

= e1 XL Whn1 XL
XL Whn1 [U − U∗ ] [1 + op (1)]


+ Op max |P̂i − Pi | + h2n1
i:1≤i≤n


= Op (nhn1 )−1/2 + max |P̂i − Pi | + h2n1 .

Since Û1i = U1i − µ1 (Xi )0 β̂1 − β1 , we have

i:1≤i≤n

(C.2)

where



(C.4)

(Pi − v)2
∂ p2
1 ∂ 3 E [U1 |P = v, S = 1]
+
(Pi − v)3 + Rp (v),
3!
∂ p3
+

Then using this notation, it follows from (4.3) that

 −1 

(Pn − v)2

E [U1 |P = Pi , S = 1] = E [U1 |P = v, S = 1]
∂ E [U1 |P = v, S = 1]
(Pi − v)
+
∂p

In addition, define



(Pn − v)


(P1 − v)2

..
.
.

expansion,

i0

n

1

(Pn − v)

which implies that

diag S1 Kh (P̂1 − v), . . . , Sn Kh (P̂n − v) , where Kh (·) = h−1 K (·/h).

.

.

XQ =  ..
1

and

(P1 − v)
..
.

i

Thus, only the third term above affects the asymptotic distribution.
Its limiting behavior evaluated at P̂ − P is easy to describe, because
it is a linear functional of P̂ − P. For example, see Section 4 of Newey
(1997). Assumption 7 of Newey (1997) is satisfied with ν(z ) that is
defined above (see Assumption 9). Then the desired result follows
from Theorem 3.3 of IL with the restriction that n1/2 κ −rϕ → 0. 

X̂L =  ..

1

max Kh (P̂i − v) − Kh (Pi − v) = op (1),

∂
Df m∗ (b, f0 (·))[h1 (·)]|b=β1 = 0,
∂b 1
∂
Df m∗ (b, f0 (·))[h2 (·)]|b=β1 = 0,
∂b 2
∂
Df m∗ (b, f0 (·))[h3 (·)]|b=β1
∂b 3 

= E S (µ1 (X ) − E [µ1 (X )|P , S = 1])∂λ1 (p)/∂ p|p=P h3 (·) .

1



It follows from Assumptions 11 and 12 that

Then it easy to see that




(P1 − v)

..

.



− (µ1 (X ) − E [µ1 (X )|P , S = 1])0 b}h2 (·)0 b],
Df3 m∗ (b, f0 (·))[h3 (·)]
h 
= E S (Y − E [Y |P , S = 1]) − (µ1 (X ) − E [µ1 (X )|P , S = 1])0 b
i

× −∂ f10 (p)/∂ p|p=P + ∂ f20 (p)/∂ p0 |p=P b h3 (·) .

0

Tn (v) = v × e02 X̂Q Ŵhn2 X̂Q

−1 

0

X̂Q Ŵhn2 U



 0
 −1  0

X̂L Ŵhn1 U
+ e01 X̂L Ŵhn1 X̂L
 0
−1  0

Rn (v) = v × e02 X̂Q Ŵhn2 X̂Q
X̂Q Ŵhn2 µ1 (X)
 0
 −1  0

+ e01 X̂L Ŵhn1 X̂L
X̂L Ŵhn1 µ1 (X) .



0

i:1≤i≤n

Similar arguments also give

∂ E [U1 |P = v, S = 1]
∂p
 0
−1  0

= e02 X̂Q Ŵhn2 X̂Q
X̂Q Ŵhn2 [U − U∗ ]


2
+ Op max |P̂i − Pi | + hn2


0

e02 X̂Q Ŵhn2 X̂Q

Then since Rn (v) = Op (1),
Ê [U1 |V = v] = Tn (v) + Op n−1/2 ,

0

(C.3)

−1 

i:1≤i≤n

0



X̂Q Ŵhn2 U −

(C.5)

208

P. Carneiro, S. Lee / Journal of Econometrics 149 (2009) 191–208

−1

X0Q Whn2 [U − U∗ ] [1 + op (1)]
= e02 X0Q Whn2 XQ


+ Op max |P̂i − Pi | + h2n2
i:1≤i≤n


3 −1/2
2
= Op (nhn2 )
+ max |P̂i − Pi | + hn2 .



i:1≤i≤n

Then the theorem follows from standard results on local polynomial regression (for example, see Chapter 3 of Fan and Gijbels
(1996)). 
Proof of Theorem 5. This theorem follows easily by combining
Theorems 2–4 with the fact that the S = 1 and S = 0 samples
are independent of each other. 
References
Abadie, A., 2002. Bootstrap tests for distributional treatment effects in instrumental
variable models. Journal of the American Statistical Association 97, 284–292.
Abadie, A., 2003. Semiparametric instrumental variable estimation of treatment
response models. Journal of Econometrics 113 (2), 231–263.
Abadie, A., Angrist, J.D., Imbens, G.W., 2002. Instrumental variables estimates of the
effect of subsidized training on the quantiles of trainee earnings. Econometrica
70, 91–117.
Aakvik, A., Heckman, J., Vytlacil, E., 2005. Estimating treatment effects for discrete
outcomes when responses to treatment vary: An application to Norwegian
vocational rehabilitation programs. Journal of Econometrics 125 (1–2), 15–51.
Cameron, S., Taber, C., 2004. Estimation of educational borrowing constraints using
returns to schooling. Journal of Political Economy 112 (1), 132–182 (part 1).
Card, D., 1995. Using geographic variation in college proximity to estimate the return to schooling. In: Christofides, Louis, Kenneth Grant, E., Swindinsky, Robert
(Eds.), Aspects of Labour Economics: Essays in Honour of John Vanderkamp.
University of Toronto Press.
Card, D., 1999. In: Ashenfelter, Orley, Card, David (Eds.), The Causal Effect of
Education on Earnings. In: Handbook of Labor Economics, vol. 3A. NorthHolland, Amsterdam.
Card, D., 2001. Estimating the return to schooling: Progress on some persistent
econometric problems. Econometrica 69 (5), 1127–1160.
Carneiro, P., Hansen, K., Heckman, J., 2003. Estimating distributions of counterfactuals with an application to the returns to schooling and measurement of the
effects of uncertainty on schooling choice. International Economic Review 44
(2), 361–422.
Carneiro, P., Heckman, J., Vytlacil, E., 2007. Understanding what Instrumental
Variables estimate: Estimating average and marginal returns to schooling,
Working Paper, The University of Chicago.
Carneiro, P., Lee, S., 2007. Trends in Quality-Adjusted Skill Premia in the United
States, 1960–2000, Working Paper, University College London.
Chen, S.H., Khan, S., 2007. Estimating the Causal Effects of Education on Wage
Inequality Using IV Methods and Sample Selection Models, Working Paper,
SUNY at Albany.
Chen, X., Linton, O., van Keilegom, I., 2003. Estimation of semiparametric models
when the criterion function is not smooth. Econometrica 71 (5), 1591–1608.
Chernozhukov, V., Hansen, C., 2005. An IV model of quantile treatment effects.
Econometrica 73 (1), 245–261.
Chernozhukov, V., Hansen, C., 2006. Instrumental quantile regression inference for
structural and treatment effect models. Journal of Econometrics 132, 491–525.
Chernozhukov, V., Imbens, G.W., Newey, W.K., 2007. Instrumental variable
estimation of nonseparable models. Journal of Econometrics 139, 4–14.
Chesher, A.D., 2003. Identification in nonseparable models. Econometrica 71,
1405–1441.
Cunha, F., Heckman, J., Navarro, S., 2005. Separating uncertainty from heterogeneity
in life cycle earnings. In: Oxford Economic Papers, vol. 57. pp. 191–261.
Currie, J., Moretti, E., 2003. Mother’s education and the intergenerational
transimission of human capital: Evidence from college openings. Quartely
Journal of Economics 118 (4).
Das, M., Newey, W.K., Vella, F., 2003. Nonparametric estimation of sample selection
models. Review of Economics Studies 70, 33–58.
Deschenes, O., 2007. Estimating the impact of family background on the returns to
education. Journal of Business and Economic Statistics 25 (3), 265–277.
Fan, J., Gijbels, I., 1996. Local Polynomial Modelling and Its Applications. Chapman
& Hall, London.
Fan, J., Yao, Q., Tong, H., 1996. Estimation of conditional densities and sensitivity
measures in nonlinear dynamical systems. Biometrika 83, 189–206.

Ferreira, F., Leite, P., 2005. Educational expansion and income distribution: A microsimulation for ceara. In: Shorrocks, A., Hoeven, R. (Eds.), Growth, Inequality
and Poverty: Prospects for Pro-poor Economic Development. Oxford University
Press.
Gould, E.D., 2002. Rising wage inequality, comparative advantage, and the growing
importance of general skills in the United States. Journal of Labor Economics 20
(1), 105–147.
Gould, E.D., 2005. Inequality and ability. Labour Economics 12, 169–189.
Hansen, K., Mullen, K., Heckman, J., 2004. The effect of schooling and ability on
achievement test scores. Journal of Econometrics 121 (1–2), 39–98.
Heckman, J., Ichimura, H., Smith, J., Todd, P., 1998. Characterizing selection bias
using experimental data. Econometrica 66, 1017–1098.
Heckman, J., Navarro, S., 2007. Dynamic discrete choice and dynamic treatment
effects. Journal of Econometrics 136, 341–396.
Heckman, J., Scheinkman, J., 1987. The importance of bundling in a GormanLancaster model of earnings. Review of Economic Studies 54 (2), 243–255.
Heckman, J., Sedlacek, G., 1985. Heterogeneity, aggregation and market wage
functions: An empirical model of self-selection in the labor market. Journal of
Political Economy 93 (6), 1077–1125.
Heckman, J., Sedlacek, G., 1990. Self-selection and the distribution of hourly wages.
Journal of Labor Economics 8 (1), S329–S363 (Part 2).
Heckman, J., Urzua, S., Vytlacil, E., 2006. Understanding instrumental variables in
models with essential heterogeneity. Review of Economics and Statistics August
88 (3), 389–432.
Heckman, J., Vytlacil, E., 1999. Local instrumental variable and latent variable
models for identifying and bounding treatment effects. Proceedings of the
National Academy of Sciences 96, 4730–4734.
Heckman, J., Vytlacil, E., 2001. Local instrumental variables. In: Hsiao, C.,
Morimune, K., Powells, J. (Eds.), Nonlinear Statistical Modeling: Proceedings of
the Thirteenth International Symposium in Economic Theory and Econometrics: Essays in Honor of Takeshi Amemiya. Cambridge University Press, Cambridge, pp. 1–46.
Heckman, J., Vytlacil, E., 2005. Structural equations, treatment, effects and
econometric policy evaluation. Econometrica 73 (3), 669–738.
Horowitz, J.L., 2001. In: Heckman, J.J., Leamer, E. (Eds.), The Bootstrap. In: Handbook
of Econometrics, vol. 5. pp. 3159–3228.
Horowitz, J.L., Lee, S., 2007. Nonparametric instrumental variables estimation of a
quantile regression model. Econometrica 75, 1191–1208.
Ichimura, H., Taber, C., 2000. Direct Estimation of Policy Impacts, Northwestern
University, unpublished manuscript.
Ichimura, H., Lee, S., 2006. Characterization of the asymptotic distribution of
semiparametric M-estimators, Cemmap Working Papers, CWP15/06. Available
at: http://cemmap.ifs.org.uk.
Imbens, G., Angrist, J., 1994. Identification and estimation of local average treatment
effects. Econometrica 62 (2), 467–475.
Imbens, G., Newey, W., 2009. Identification and Estimation of Triangular Simultaneous Equations Models Without Additivity, Econometrica, forthcoming.
Imbens, G., Rubin, D., 1997. Estimating outcome distributions for compliers in
instrumental variable models. Review of Economics Studies 64, 555–574.
Juhn, C., Kim, D.-L., Vella, F., 2005. The expansion of college education in the United
States: Is there evidence of declining cohort quality?. Economic Inquiry 43 (2),
303–315.
Kane, T., Rouse, C., 1995. Labor-market returns to two- and four-year college.
American Economic Review 85 (3), 600–614.
Kling, J., 2001. Interpreting instrumental variables estimates of the returns to
schooling. Journal of Business and Economic Statistics 19 (3), 358–364.
Lee, S., 2007. Endogeneity in quantile regression models: A control function
approach. Journal of Econometrics 141, 1131–1158.
Ma, L., Koenker, R., 2006. Quantile regression methods for recursive structural
equation models. Journal of Econometrics 134, 471–506.
Meghir, C., Pistaferri, L., 2004. Income variance dynamics and heterogeneity.
Econometrica 72 (1), 1–32.
Moffitt, R., 2008. Estimating Marginal Treatment Effects in Heterogeneous Populations, Annales d’Economie et de Statistique, Special Issue on Econometrics of
Evaluation (in press).
Newey, W.K., 1997. Convergence rates and asymptotic normality for series
estimators. Journal of Econometrics 79, 147–168.
Robinson, P.M., 1988. Root-N-consistent semiparametric regression. Econometrica
56 (4), 931–954.
Silverman, B.W., 1986. Density Estimation for Statistics and Data Analysis. Chapman
and Hall, London.
Vytlacil, E., 2002. Independence, monotonicity, and latent index models: An
equivalence result. Econometrica 70, 331–341.
Vytlacil, E., Yildiz, N., 2007. Dummy endogenous variables in weakly separable
models. Econometrica 75 (3), 757–779.
Willis, R., Rosen, S., 1979. Education and self-selection. Journal of Political Economy
87 (5), Pt2:S7-36.

