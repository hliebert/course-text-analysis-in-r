Downloaded from https://academic.oup.com/restud/article-abstract/85/3/1824/4105005 by WWZ Bibliothek (Oeffentliche Bibliothek der UniversitÃ¤t Basel) user on 05 December 2018

Review of Economic Studies (2018) 85, 1824–1851
doi:10.1093/restud/rdx052
© The Author 2017. Published by Oxford University Press on behalf of The Review of Economic Studies Limited.
Advance access publication 6 September 2017

Non-parametric Panel Data
Models with Interactive Fixed
Effects
JOACHIM FREYBERGER
University of Wisconsin - Madison
First version received June 2014; Editorial decision June 2017; Accepted September 2017 (Eds.)
This article studies non-parametric panel data models with multidimensional, unobserved individual
effects when the number of time periods is fixed. I focus on models where the unobservables have a factor
structure and enter an unknown structural function non-additively. The setup allows the individual effects
to impact outcomes differently in different time periods and it allows for heterogeneous marginal effects. I
provide sufficient conditions for point identification of all parameters of the model. Furthermore, I present
a non-parametric sieve maximum likelihood estimator as well as flexible semiparametric and parametric
estimators. Monte Carlo experiments demonstrate that the estimators perform well in finite samples.
Finally, in an empirical application, I use these estimators to investigate the relationship between teaching
practice and student achievement. The results differ considerably from those obtained with commonly
used panel data methods.
Key words: Panel data, Multidimensional individual effects, Factor model, Non-parametric identification.
JEL Codes: C14, C23

1. INTRODUCTION
A standard linear fixed effects panel data model allows for a scalar unobserved individual effect,
which may be correlated with explanatory variables. Consequently, by making use of panel
data, a researcher may allow for endogeneity without the need for an instrumental variable.
However, a scalar unobserved individual effect, which enters additively, imposes two important
restrictions. To illustrate these restrictions, suppose that the observed outcome Yit denotes the
test score of student i in test t. Here the researcher could either observe the same student taking
tests in different time periods or, as in many empirical applications, the researcher could observe
several subject specific tests for the same student.1 In these applications the individual effect
typically represents unobserved ability of student i and the explanatory variables include student
and teacher characteristics. Since the individual effect is a scalar and constant across t, the first
main restriction is that if one student has a higher individual effect than another student with the
same observed characteristics, then the student with the higher individual effect also has a higher
1. For example, using subject specific tests, Dee (2007) analyses whether assignment to a same-gender teacher
has an influence on student achievement. Clotfelter et al. (2010) and Lavy (2016) investigate the relationship between
teacher credentials and student achievement and teaching practice and student achievement, respectively.
1824

[17:29 14/6/2018 rdx052.tex]

RESTUD: The Review of Economic Studies

Page: 1824

1824–1851

JOACHIM FREYBERGER

NON-PARAMETRIC PANEL DATA MODELS

1825
Downloaded from https://academic.oup.com/restud/article-abstract/85/3/1824/4105005 by WWZ Bibliothek (Oeffentliche Bibliothek der UniversitÃ¤t Basel) user on 05 December 2018

expected test outcome in all tests. Hence, it is not possible that student i has abilities such that she
is better in mathematics, while student j is better in English. The second main restriction is that
the model does not allow for interactions between individual effects and explanatory variables.
Therefore, in the previous example, the linear fixed effects model implicitly assumes that the
effect of a teacher characteristic on test scores does not depend on students’ abilities.
To allow for these empirically relevant features, in this article I study panel data models with
multidimensional individual effects and marginal effects that may depend on these individual
effects. Specifically, I consider models based on


Yit = gt Xit ,λi Ft +Uit ,
i = 1,...,n, t = 1,...,T ,
(1)
where Yit is a scalar outcome variable, gt is an unknown structural function, Xit ∈ Rdx is a vector
of explanatory variables, λi ∈ RR and Ft ∈ RR are unobserved vectors, and Uit is an unobserved
random variable. The explanatory variables Xi = (Xi1 ,...,XiT ) may be continuous or discrete and
Xi may depend on the individual effects λi . In the previous example, λi accounts for different
dimensions of unobserved abilities of student i and Ft is the importance of the abilities for test
t. Hence, both the returns to the various abilities and the relative importance of each ability on
the outcome can change across tests. Thus, some students may have higher expected outcomes
in mathematics, while others may have higher expected outcomes in English, without changes
in covariates. Furthermore, since the structural functions are unknown, the model allows for
a flexible relationship between Yit and Xit , and the effect of Xit on Yit may depend on λi . A
semiparametric special case of the model, which is covered by the results in this paper, is αt (Yit ) =
Xit βt +λi Ft +Uit where αt is an unknown strictly increasing transformation of Yit . Such a model
is particularly appealing when Yit are test scores, because test scores do not have a natural
metric and any increasing transformation of them preserves the same ranking of students (see
Cunha and Heckman, 2008). Thus, next to estimating the slope coefficients, a researcher can
allow for an unknown transformation of the test scores. Other special cases of (1) include a linear
factor model, where gt is linear, as well as the standard linear fixed effects model with both scalar
individual effects and time dummies. Notice that while a linear factor model allows for multiple
individual effects, it does not allow for heterogeneous marginal effects.
The models studied in this article are appealing in a variety of empirical applications where
unobserved heterogeneity is not believed to be one dimensional and time homogeneous, and
a researcher wants to allow for a flexible relationship between Yit , Xit , and the unobservables.
Examples include estimating the returns to education or the effect of union membership on
wages (where λi represents different unobserved abilities and Ft their price at time t), estimating
production functions (where λi can capture different unobserved firm specific effects), and cross
country regressions (where Ft denotes common shocks and λi the heterogeneous impacts on
country i).2
This article presents sufficient conditions for point identification of all parameters of models
based on outcome Equation (1) when T is fixed and the number of cross-sectional units is
large. In the previous example, where T represents the number of tests, I therefore only require
a small number of tests for each student. The identified parameters include the structural
functions gt , the number of individual effects R, the vectors Ft , and the distribution of the
individual effects conditional on the covariates.3 Identification of these parameters immediately
2. For more examples of factor models in economics see Bai (2009) and references therein.
3. The factor structure of the unobservables is commonly called interactive fixed effects due to the interaction of
λi and Ft . The vector Ft is usually referred to as the factors, while λi is called the loadings. I use this terminology because
I do not impose a parametric assumption on the dependence between λi and Xit . Graham and Powell (2012) provide a
discussion on the difference between fixed effects and correlated random effects.

[17:29 14/6/2018 rdx052.tex]

RESTUD: The Review of Economic Studies

Page: 1825

1824–1851

1826

REVIEW OF ECONOMIC STUDIES
Downloaded from https://academic.oup.com/restud/article-abstract/85/3/1824/4105005 by WWZ Bibliothek (Oeffentliche Bibliothek der UniversitÃ¤t Basel) user on 05 December 2018

implies identification of economically interesting features such as average and quantile structural
functions. Although T is fixed, I require that T ≥ 2R+1 so that for a given T only models
with at most (T −1)/2 factors are point identified, which is also a standard condition in linear
factor models. The main result in the article is for continuously distributed outcomes, where
my assumptions are natural extensions of those in a linear factor model, but the identification
arguments are substantially different. As in the linear model, the assumptions rule out lagged
dependent variables as regressors. However, I discuss extensions to allow for lagged dependent
variables as regressors, as well as discretely distributed outcomes, in the Supplementary Appendix
(see Remark 3).
I then show that a non-parametric sieve maximum likelihood estimator estimates all
parameters consistently. Since the estimator requires estimating objects which might be high
dimensional in applications, such as the density of λi | Xi , this paper also provides a flexible
semiparametric estimator, where I reduce the dimensionality of the estimation problem by
assuming a location and scale model for the conditional
distributions. I provide conditions
√
under which the finite dimensional parameters are n consistent and asymptotically normally
distributed, and I also describe an easy to implement fully parametric estimator.
In an empirical application, I study the relationship between teaching practice and student
achievement, where Yit are different mathematics and science test scores for each student i. The
main regressors are measures of traditional and modern teaching practice for each class a student
attends, constructed from a student questionnaire. Traditional and modern teaching practices
are associated with lectures/memorizing and group work/explanations, respectively. I estimate
marginal effects of teaching practice, on mathematics and science test scores, for different levels of
students’ abilities and find that the semiparametric two factor model yields substantially different
conclusions than a linear fixed effects model.
Many recent papers in the non-parametric panel data literature are related to the models
I consider. First, several papers make use of some form of time homogeneity to achieve
identification, do not restrict the dependence of Uit over t or the distribution of λi | Xi , and achieve
identification of average or quantile effects. Papers in this category include Graham and Powell
(2012), Hoderlein and White (2012) and Chernozhukov et al. (2013).4 Chamberlain (1992)
analyses common parameters in random coefficient models. Arellano and Bonhomme (2012)
extend his analysis and restrict the dependence of Uit over t to obtain identification of the variance
and the distribution of the random coefficients. While all of these papers allow for multiple
individual effects and heterogeneous marginal effects, the time homogeneity assumptions imply
that the ranking of individuals based on E[Yit | Xi ,λi ] cannot change over t without a change
in Xit . Contrarily, compared to those papers, (1) makes stronger assumptions on the dimension
of λi , assumes that λi affects Yit through an index, and requires independence of Uit over t
for identification (see Section 2.2 for more details). It therefore rules out random coefficients
for example. Thus, (1) is most useful if one believes that λi has a different effect on Yit for
different t and is willing to put some structure on the unobservables. Bester and Hansen (2009)
do not impose time homogeneity and instead restrict the distribution of λi | Xi .Altonji and Matzkin
(2005) require an external variable, which they construct in panels by restricting the distribution
of λi | Xi . Wilhelm (2015) analyses a non-parametric panel data model with measurement error
and an additive scalar individual effect. Evdokimov (2010, 2011) assumes that Uit is independent
over t and he uses identification arguments that are related to those in the measurement error

4. Scalar additive or multiplicative time effects are allowed in some of these papers.

[17:29 14/6/2018 rdx052.tex]

RESTUD: The Review of Economic Studies

Page: 1826

1824–1851

JOACHIM FREYBERGER

NON-PARAMETRIC PANEL DATA MODELS

1827
Downloaded from https://academic.oup.com/restud/article-abstract/85/3/1824/4105005 by WWZ Bibliothek (Oeffentliche Bibliothek der UniversitÃ¤t Basel) user on 05 December 2018

literature. He provides identification results in non-separable models with a scalar heterogeneity
term as well as a novel conditional deconvolution estimator.5
I also make use of measurement error type arguments instead of relying on time homogeneity
or restricting the distribution of λi | Xi . Specifically, I build on the work of Hu (2008),
Hu and Schennach (2008) and Cunha et al. (2010). Hu and Schennach (2008) study a nonparametric measurement error model with instruments. The connection to (1) is that λi can be
seen as unobserved regressors, a subset of the outcomes represents observed and mismeasured
regressors, and another subset of outcomes serves as instruments. Cunha et al. (2010) apply
results in Hu and Schennach (2008) to a measurement model of the general form Yit = gt (λi ,Uit ).
Compared to the general model, I use a more restrictive outcome equation to reduce the
dimensionality of the estimation problem, which may be appealing in empirical applications.
As a consequence, two main identifying assumptions in Cunha et al. (2010) cannot be used in
my setting, which changes important arguments in the identification proofs. In particular, one
of their main identifying assumption fixes a measure of location of the distribution of a subset
of outcomes given λi .6 In my model, such an assumption would impose very strong restrictions
on gt . Instead, I use the relation between Yit and λi delivered by (1), combined with arguments
from linear factor models and single index models. Moreover, Cunha et al. (2010) impose an
assumption on the conditional distribution of the outcomes, which does not hold with my factor
structure and T = 2R+1.7 I instead show that interchangeability of outcomes can be used to obtain
identification with T = 2R+1. These results require stronger independence assumptions compared
to Cunha et al. (2010), but some of these assumptions also serve as sufficient conditions for their
completeness assumptions and are used to identify average and quantile structural functions.
Finally, I consider extensions to allow for an unknown R and lagged dependent variables as
regressors.
This article is also related to a vast literature on linear factor models, which are well understood
and can deal with multiple unobserved individual effects.8 Non-linear models of the form Yit =
g(Xit )+λi Ft +Uit have been studied by Su and Jin (2012) and Huang (2013) when n,T → ∞.
A drawback of additively separable models is that they impose homogeneous marginal effects.
The analysis in these papers is tailored to additively separable models. For example, estimation
in Bai (2009) is based on the method of principal components.
The remainder of the article is organized as follows. Section 2 outlines the identification
arguments. Section 3 discusses different ways to estimate the model. Sections 4 and 5 contain
the empirical application and Monte Carlo simulation results, respectively. Finally, Section 6
concludes. The proofs of the main results are in the Appendix. Additional material is in a
Supplementary Appendix with Section numbers S.1, S.2, etc..
Notation: To simplify the notation, I drop the subscript i from
 all random variables in the
remainder of the article and write the outcome equation as Yt = gt Xt ,λ Ft +Ut . For each t, let

5. Many of these papers also assume some form of strict exogeneity for their main results (Assumption N4).
Exceptions are Altonji and Matzkin (2005), who instead assume an exchangeability condition, and Chernozhukov et al.
(2013).
6. See their Assumption (v) of Theorem 2. Hu and Schennach (2008) fix a measure of location of the distribution
of the measurement error.
7. See their Assumption (iv) of Theorem 2. The assumption holds with a factor structure when T ≥ 3R and can
also hold with T = 2R+1 if the unobservables do not have a factor structure.
8. The theoretical literature on linear factor models includes Heckman and Scheinkman (1987), Holtz-Eakin et al.
(1988), Ahn et al. (2001), Bai and Ng (2002), Bai (2003), Andrews (2005), Pesaran (2006), Bonhomme and Robin
(2008), Bai (2009), Ahn et al. (2013), Bai (2013), and Moon and Weidner (2015). Factor models have also been used in
applications related to the one in this paper, including Carneiro et al. (2003), Heckman et al. (2006), Cunha and Heckman
(2008), Cunha et al. (2010), and Williams et al. (2010).

[17:29 14/6/2018 rdx052.tex]

RESTUD: The Review of Economic Studies

Page: 1827

1824–1851

1828

REVIEW OF ECONOMIC STUDIES
Downloaded from https://academic.oup.com/restud/article-abstract/85/3/1824/4105005 by WWZ Bibliothek (Oeffentliche Bibliothek der UniversitÃ¤t Basel) user on 05 December 2018

Xt ⊆ RK and Yt ⊆ R be the supports of Xt and Yt , respectively. Let  ⊆ RR be the support of λ.
Define X = (X1 ,...,XT ) and define Y and U analogously. Let X and Y be the supports of X and
Y , respectively. The conditional pdf of any random variable W | V is denoted by fW |V (w;v) and
the marginal pdf by fW (w).
2. IDENTIFICATION
In this section, I assume that R is known. I consider identification of the number of factors in
Section S.1.1 of the Supplementary Appendix. Before discussing the general model, I provide
intuition for the main result by showing identification of a linear model, where the main arguments
go back to Madansky (1964) and are very similar to those of Heckman and Scheinkman (1987).
2.1.

Preliminaries: linear factor models

I consider a linear factor model with T = 5 and R = 2, where Xt is a scalar and
Yt = Xt βt +λ1 Ft1 +λ2 Ft2 +Ut .

(2)

I make the following assumptions.
 
 
Assumption L1. F4 = 1 0 and F5 = 0 1 .
Assumption L2. E[Ut | X,λ] = 0 for all t = 1,...5.
Assumption L3. U1 ,...,U5 ,λ are uncorrelated conditional on X.


Assumption L4. The 2×2 matrix Ft Fs has full rank for all s = t.
Assumption L5. The 2×2 covariance matrix of λ has full rank conditional on X.
Assumption L6. For any t1 ∈ {1,...,5} there exists t2 ,t3 ∈ {1,...,5}\t1 such that Var(Xt1 |
Xt2 ,Xt3 ) > 0.
Assumption L1 is a normalization needed because for any R×R invertible matrix H it holds
that λ Ft = λ HH −1 Ft = (H  λ) (H −1 Ft ) = λ̃ F̃t . Thus, the factors and loadings are only identified
up to a rotation and R2 restrictions are needed to identify a certain rotation. I impose them by
assuming that a submatrix of the matrix of factors is the identity matrix, which often gives the
individual effects an intuitive interpretation. For example, when the outcomes are test scores,
λ1 and λ2 can then be interpreted as the abilities, which affect test 4 and 5, respectively.
Assumption L2 is a strict exogeneity assumption. Assumption L3 implies that Ut and λ are
uncorrelated and that Ut is uncorrelated across t, conditional on X. Assumptions L4 and L5
ensure that the covariance matrix of any two pairs of outcomes has full rank and imply that each
outcome is affected by a different linear combination of λ. Assumption L6 describes the variation
in Xt over t needed to identify βt .
Assumption L1 implies that
λ1 = Y4 −X4 β4 −U4

and

λ2 = Y5 −X5 β5 −U5 .

Plugging these expressions for λ into Equation (2) when t = 3 and rearranging yields
Y3 = Y4 F31 +Y5 F32 +X3 β3 −X4 β4 F31 −X5 β5 F32 +ε,

[17:29 14/6/2018 rdx052.tex]

ε = U3 −U4 F31 −U5 F32 .

RESTUD: The Review of Economic Studies

Page: 1828

1824–1851

JOACHIM FREYBERGER

NON-PARAMETRIC PANEL DATA MODELS

1829
Downloaded from https://academic.oup.com/restud/article-abstract/85/3/1824/4105005 by WWZ Bibliothek (Oeffentliche Bibliothek der UniversitÃ¤t Basel) user on 05 December 2018

Clearly, Y4 and Y5 are correlated with ε. However, we can use (Y1 ,Y2 ) as instruments for (Y4 ,Y5 )
because (Y1 ,Y2 ) is uncorrelated with ε conditional on X by L2 and L3 and

cov((Y1 ,Y2 ),(Y4 ,Y5 ) | X) =


F11 F12
cov(λ | X),
F21 F22

which has full rank by Assumptions L4 and L5. Hence F31 and F32 are identified. Next, F1 is
identified by using Y1 , Y4 , and Y5 to difference out λ and (Y2 ,Y3 ) as instruments for (Y4 ,Y5 ).
Analogously, we can identify F2 . By Assumption L6 we can now identify βt1 for all t1 by using
Yt1 , Yt2 , Yt3 to difference out λ and the remaining outcomes as instruments. Hence, to identify
all parameters we have to interchange the outcomes that serve as instruments.9 To identify the
distribution of (U,λ) | X, stronger assumptions are needed. In particular, we could assume that
Ut is independent over t and independent of λ and then use arguments related to the extension of
Kotlarski’s Lemma in Evdokimov and White (2012).
The arguments can easily be extended to the case where R > 2 and T > 5. However, the
previous arguments highlight that it is necessary to have T ≥ 2R+1.10 We need R+1 outcomes
to difference out λ and then another R outcomes, which can be used as instruments.

2.2. Assumptions and definitions
I now return to the general model. One assumption I impose is that the structural functions gt
are strictly increasing in the second argument, which is common in non-additive models (see for
example Matzkin (2003) or Evdokimov (2010)). In the application λ Ft +Ut could be interpreted
as the skills needed for test t and the assumption then says that more skills increase the test scores.
Define the inverse function ht (Yt ,Xt ) ≡ gt−1 (Yt ,Xt ) so that
ht (Yt ,Xt ) = λ Ft +Ut ,

t = 1,...,T .

(3)

Although T ≥ 2R+1 is needed, to simplify the notation I assume that T = 2R+1. The extension
to a larger T is straightforward as discussed below. Moreover, this section focuses on the
continuous case. Therefore, I make the following two assumptions.
Assumption N1. R is known and T = 2R+1.
Assumption N2. fY1 ,...,YT ,λ|X (y1 ,...,yT ,v;x) is bounded on Y1 ×···×YT ××X and continuous in (y1 ,...,yT ,v) ∈ Y1 ×···×YT × for all x ∈ X . All marginal and conditional densities are
bounded.
Let ht (yt ,xt ) denote the derivative of ht with respect to yt . The next assumption imposes
monotonicity and a normalization on ht .

9. These arguments differ from Ahn et al. (2013), who study a linear factor model for fixed T , because I allow βt
to be time varying and I use outcomes as instruments once the individual effects are differences out.
10. It can be shown that without additional assumptions to the ones presented here, the slope coefficients βt are not
point identified if T < 2R+1.

[17:29 14/6/2018 rdx052.tex]

RESTUD: The Review of Economic Studies

Page: 1829

1824–1851

1830

REVIEW OF ECONOMIC STUDIES
Downloaded from https://academic.oup.com/restud/article-abstract/85/3/1824/4105005 by WWZ Bibliothek (Oeffentliche Bibliothek der UniversitÃ¤t Basel) user on 05 December 2018

Assumption N3.
(i) ht is strictly increasing and differentiable in its first argument.
(ii) There exist x̄ ∈ X and ȳ on the support of Y | X = x̄ such that ht (ȳt , x̄t ) = 0 for all t = R+
2,...,2R+1 and ht (ȳt , x̄t ) = 1 for all t = 1,...,T .
Define the subset of the support where the location normalizations are imposed by X̃ ≡
{(x1 ,...,xT ) ∈ X : xt = x̄t for all t = R+2,...,2R+1}. Next, let F = (F1 F2 ··· FT ) be the R×T
matrix of factors and let IR×R be the R×R identity matrix. The remaining assumptions are
as follows.
Assumption N4. M [Ut | X,λ] = 0 for all t = 1,...,T .
Assumption N5. U1 ,...,UT ,λ are jointly independent conditional on X.
Assumption N6. (FR+1 ··· F2R+1 ) = IR×R and any R×R submatrix of F has full rank.
Assumption N7. The R×R covariance matrix of λ has full rank conditional on X.
Assumption N8. The characteristic function of Ut is non-vanishing on (−∞,∞) for all t and
λ has support on RR conditional on X.
To better understand the normalizations, notice that a special case without covariates is αt +
βt Yt = λ Ft +Ut . Since the right-hand side is not observed, one can divide both sides by a constant
for each t and still satisfy all assumptions. Thus, βt is not identified for any t and N3(ii) normalizes
them to 1. Similarly, αt is not identified for R periods, because the mean of λ is unknown, and N3(ii)
normalizes them to −ȳt for t = R+2,...,2R+1. As stated in Theorem 2, economically interesting
quantities, such as average and quantile structural functions, are invariant to these normalizations
(as well the ones in N4 and N6).
Assumptions N4–N7 can be seen as the non-parametric analogs of L2–L5. Assumption N4
implies that the regressors are strictly exogenous with respect to Ut , which rules out for example
that Xt contains lagged dependent variables. A median normalization is more convenient in
non-linear models than the zero mean assumption used in the linear model. Assumption N5
strengthens L3. Although the unobservables λ Ft +Ut are correlated over t, any dependence is
due to λ. Autoregressive Ut are thus ruled out. A similar assumption is needed in the linear model
to identify the distribution of (U,λ) | X. Note that the assumptions do not require that Ut and Xt are
independent and permit heteroskedasticity. Independence can be relaxed if T > 2R+1 because the
proof only requires that 2R+1 outcomes are independent conditional on (X,λ). Hence, one could
allow for MA(1) disturbances if T ≥ 4R+1 and similarly for a more complicated dependence
structure for larger T . Assumption N6 generalizes L1 and L4. Assumption N7 is just as L5 and
rules out that some element of λ is a linear combination of the other elements. Furthermore, all
constant elements of λ, and thus time trends, are absorbed by the function ht .
Assumption N8 is an additional assumption needed due to the non-parametric nature of the
model. A non-vanishing characteristic function holds for many standard distributions such as
the normal family, the t-distribution, or the gamma distribution, but not for all distributions,
for instance the uniform distribution. The purpose of the assumption is to guarantee that a nonparametric analog of the rank condition holds, known as completeness, which implies a strong
dependence between two vectors of outcomes, similar as in the linear model (see Lemma 1 in
the Appendix).

[17:29 14/6/2018 rdx052.tex]

RESTUD: The Review of Economic Studies

Page: 1830

1824–1851

JOACHIM FREYBERGER

NON-PARAMETRIC PANEL DATA MODELS

1831
Downloaded from https://academic.oup.com/restud/article-abstract/85/3/1824/4105005 by WWZ Bibliothek (Oeffentliche Bibliothek der UniversitÃ¤t Basel) user on 05 December 2018

2.3. Identification outline and main results
I now outline the main identification arguments and state and discuss the formal results. The first
step is to notice that independence of U1 ,...,UT ,λ | X implies that
fY |X (y;x) =

 
T

fYt |X,λ (yt ;x,v)fλ|X (v;x)dv.

t=1

Similarly, with Z1 ≡ (Y1 ,...,YR ), Z2 ≡ YR+1 , and Z3 ≡ (YR+2 ,...,Y2R+1 ) we get

fY |X (y;x) = fZ1 |X,λ (z1 ;x,v)fZ2 |X,λ (z2 ;x,v)fZ3 ,λ|X (z3 ,v;x)dv.

(4)

The expression for fY |X (y;x) has a similar structure as in the measurement error model of
Hu and Schennach (2008). Here we can interpret λ as unobserved regressors. By Assumption
N6, we can solve for λ in terms of any R outcomes, the corresponding Xt , and Ut . Thus, a set of R
outcomes, here Z3 , can be interpreted as observed, but mismeasured regressors. The instruments
needed for identification are then another set of R outcomes, Z1 , as before.
The results of Hu and Schennach (2008) do not immediately apply to (4) for two main
reasons. First, since Z2 is of lower dimension than λ and since I assume a factor structure for the
unobservables, one of their identification conditions is violated.11 I solve this problem by rotating
the outcomes contained in Z1 and Z2 , which is analogous to rotating the outcomes that serve as
instruments in the linear model.12 This additional step and arguments as in Hu and Schennach
(2008) then imply identification of fY ,λ|X up to a one-to-one transformation of λ. Second,
to pin down this transformation, Hu and Schennach (2008) and Cunha et al. (2010) impose a
normalization of the form (fZ3 |λ (· | λ)) = λ, where  is a known functional, such as E(Z3 | λ) = λ
in a classical measurement error model. However, in the factor model discussed here, I show
that such a normalization imposes very strong restrictions on the structural functions and that all
parameters are identified without an additional normalization of λ.13 To do so, I use arguments
from linear factor models and single index models to point identify all parameters of the model.
Important assumptions used in this step are the factor structure, independence, monotonicity,
the normalizations of gt , and the moments conditions. These arguments then not only uniquely
determine fY ,λ|X , but also gt and Ft . To obtain these results I require stronger independence
assumptions compared to Cunha et al. (2010), but some of these assumptions also serve as
sufficient conditions for their completeness assumptions and are used to identify average and
quantile structural functions. These arguments lead to the following theorem. The proof is in the
appendix.
Theorem 1. Suppose Assumptions N1 – N8 hold. Then Ft , the functions gt , and the distribution
of (U,λ) | X = x are identified for all x ∈ X̃ . If in addition fX (x) > 0 for all x ∈ X1 ×...×XT , then
gt and the distribution of (U,λ) | X = x are identified for all x ∈ X .
11. Specifically, Assumption 4 in Hu and Schennach (2008) or, translated to the panel setting, Assumption (iv) or
Theorem 2 in Cunha et al. (2010).
⊥ U2 ⊥
⊥ ... ⊥
⊥ UR+1 ⊥
⊥ (UR+2 ,...,U2R+1 ) | λ as opposed to
12. For this particular step, I require U1 ⊥
⊥ UR+1 ⊥
⊥ (UR+2 ,...,U2R+1 ) | λ without rotations in Hu and Schennach (2008).
(U1 ,U2 ,......UR ) ⊥
13. Only an unknown transformation of λ is pinned down by the eigenfunctions. For example, Assumptions
N3(i), N4, and N6 imply that M [YT | X = x,λ = v] = gT (xT ,vR ). In the completely non-parametric setting of
Hu and Schennach (2008) and Cunha et al. (2010), this assumption is much less restrictive and is truly a normalization
if a monotonicity condition holds.

[17:29 14/6/2018 rdx052.tex]

RESTUD: The Review of Economic Studies

Page: 1831

1824–1851

1832

REVIEW OF ECONOMIC STUDIES
Downloaded from https://academic.oup.com/restud/article-abstract/85/3/1824/4105005 by WWZ Bibliothek (Oeffentliche Bibliothek der UniversitÃ¤t Basel) user on 05 December 2018

Remark 1. The proof proceeds in two steps. First, I condition on x ∈ X̃ and I show that Ft , the
functions gt , and the conditional distribution of the unobservables are identified. Consequently,
fY ,λ|X (y,v;x) is identified for all y ∈ Y, v ∈ , and x ∈ X̃ . The reason for conditioning on x ∈ X̃
is that I make use of the normalizations in Assumption N3(ii). Notice that X̃ is a subset of
the support X with xt fixed for all t = R+2,...,2R+1. To identify the functions gt for different
values of Xt , the covariates need to have enough variation across t, similar as in the linear
model. A simple sufficient condition is that fX (x) > 0 for all x ∈ X1 ×...×XT . Section S.1.2 in the
Supplementary Appendix discusses a weaker sufficient condition for the variation needed, which
requires more notation, but is important for the application.
Remark 2. While the assumptions are natural extensions of those in the linear model, the
identification arguments are different. When T = 5 and R = 2 we get just as in Section 2.1
h3 (Y3 ,X3 ) = h4 (Y4 ,X4 )F31 +h5 (Y5 ,X5 )F32 +ε, ε = U3 −U4 F31 −U5 F32 ,
which might suggest that identification could be based on moment conditions. While such an
approach might lead to identification of ht under similar assumptions, my approach also yields
identification of the distribution of (λ,U) | X and thus, average and quantile structural functions,
which require knowledge of the distribution of the unobservables and are invariant to the
normalizing assumptions (see Section 2.4).
Remark 3. The Supplementary Appendix contains extensions of the identification results to
identification of the number of factors (Section S.1.1 in Supplementary Appendix), lagged
dependent variables as regressors (Section S.1.4 in Supplementary Appendix), and discrete
outcomes (Section 1.1.5 in Supplementary Appendix). Incorporating predetermined regressors
other than lagged dependent variables requires modeling their dependence, similar as in
Shiu and Hu (2013). Lagged dependent variables have the advantage of being modeled in the
system.
2.4. Objects invariant to normalizations
This section describes economically interesting objects, namely average and quantile structural
functions, which are invariant to the normalization assumptions N3(ii), N4, and N6. Define
Ct ≡ λ Ft and let Qα [Ct ] and Qα [Ut ] be the α-quantile of Ct and Ut , respectively. Let x̃t ∈ Xt and
define the quantile structural functions


st,α (x̃t ) = gt (x̃t ,Qα [Ct +Ut ]) and st,α1 ,α2 (x̃t ) = gt x̃t ,Qα1 [Ct ]+Qα2 [Ut ]

as well as the average structural function s̄t (x̃t ) = gt (x̃t ,e)dFCt +Ut (e). The functions st,α (x̃t )
and s̄t (x̃t ) are analogous to the average and quantile structural functions in Blundell and Powell
(2003) and Imbens and Newey (2009). Here the unobservables consist of two parts, Ct and Ut ,
and Ct often has a specific interpretation in applications, such as the abilities needed for a certain
test. The function st,α1 ,α2 (x̃t ) allows the two unobservables to be evaluated at different quantiles.
Therefore, one could set Ut to its median value of 0 and investigate how the outcomes vary with
Ct . Moreover, let x ∈ X and define the conditional versions of these functions as
st,α (x̃t ,x) = gt (x̃t ,Qα [Ct +Ut | X = x])


st,α1 ,α2 (x̃t ,x) = gt x̃t ,Qα1 [Ct | X = x]+Qα2 [Ut | X = x] , and

s̄t (x̃t ,x) = gt (x̃t ,e)dFCt +Ut |X=x (e).

[17:29 14/6/2018 rdx052.tex]

RESTUD: The Review of Economic Studies

Page: 1832

1824–1851

JOACHIM FREYBERGER

NON-PARAMETRIC PANEL DATA MODELS

1833
Downloaded from https://academic.oup.com/restud/article-abstract/85/3/1824/4105005 by WWZ Bibliothek (Oeffentliche Bibliothek der UniversitÃ¤t Basel) user on 05 December 2018

Average and quantile structural functions can be used to answer important policy questions.
For example suppose Xt is class size and the outcomes are test scores. Then s̄t (25)–s̄t (20) is
the expected effect of a change in class size from 20 to 25 on the test score for a randomly
selected student. The conditional version s̄t (25,x)–s̄t (20,x) is the expected effect for a randomly
selected student from a class of size x. The quantile effects have similar interpretations, but are
evaluated at quantiles of unobservables, rather than averaging over them. The following result
shows identification of these functions without the normalizations.
Theorem 2. Suppose Assumptions N1, N2, N3(i), N5, N7, and N8 hold. Further suppose that
for all t M[Ut | X,λ] = ct for some ct ∈ R, that each R×R submatrix of F has full rank, and that
fX (x) > 0 for all x ∈ X1 ×...×XT . Then st,α (x̃t ,x), st,α1 ,α2 (x̃t ,x), s̄t (x̃t ,x), st,α (x̃t ), st,α1 ,α2 (x̃t ), and
s̄t (x̃t ) are identified for all x̃t ∈ Xt and x ∈ X .
Remark 4. As in Theorem 1, we can replace fX (x) > 0 for all x ∈ X1 ×...×XT with a weaker
sufficient condition. Specifically, we can instead assume that Assumption N9 in Section S.1.2 in
the Supplementary Appendix holds for all x ∈ X .
3. ESTIMATION
This section discusses estimation when R is known. Section S.2.3 in the Supplementary Appendix
shows how to test the null hypothesis that the model has R factors against the alternative that it
has more than R factors, and how to consistently estimate the number of factors.
First notice that, by Assumptions N3 and N5, the density of Y | X can be written as
fY1 ,...,YT |X (y;x) =

 
T

fUt |X (ht (yt ,xt )−v Ft ;x)ht (yt ,xt )fλ|X (v;x)dv.

t=1

I use this expression to suggest estimation based on the maximum likelihood method. Although
I show that a completely non-parametric estimator is consistent, such an estimator might not be
attractive in applications due to the potentially high dimensionality of the estimation problem. For
example, the function fλ|X (v;x) has R+Tdx arguments, which implies a slow rate of convergence,
and consequently imprecise estimators in finite samples.14 Hence, I also suggest a more practical
semiparametric estimator, where I reduce the dimensionality by assuming a location and scale
model for the conditional distributions.
3.1.

Fully non-parametric estimator

I follow well known results, such as Chen (2007), and prove consistency of a nonparametric maximum likelihood estimator. I briefly outline the main assumptions below and
provide the details in the Supplementary Appendix. Next to the identification conditions, the
main assumptions for estimation include smoothness restrictions on the unknown functions.
Specifically, I assume that the unknown functions lie in a weighted Hölder space, which allows
the functions to be unbounded and have unbounded derivatives. I denote the parameter space
by  and the consistency norm by · s , which is a weighted sup norm.15 Let Wi = (Yi ,Xi ) and
14. In addition, the model nests deconvolution problems which can have a logarithmic rate of convergence. For
related setups see Fan (1991), Delaigle et al. (2008), and Evdokimov (2010).
15. This combination of the consistency norm and the parameter space ensures that  is compact under · s . As
discussed in Section S.2.1 in Supplementary Appendix, a weighted sup norm implies consistency in the regular unweighted
sup norm over any compact subset of the support.

[17:29 14/6/2018 rdx052.tex]

RESTUD: The Review of Economic Studies

Page: 1833

1824–1851

1834

l(θ0 ,Wi ) ≡ ln

 
T

Downloaded from https://academic.oup.com/restud/article-abstract/85/3/1824/4105005 by WWZ Bibliothek (Oeffentliche Bibliothek der UniversitÃ¤t Basel) user on 05 December 2018

REVIEW OF ECONOMIC STUDIES


denote the true value of the parameters by θ0 = h1 ,...,hT ,fU1 |X ,...,fUT |X ,fλ|X ,F ∈ . Then the
log-likelihood evaluated at θ0 and the ith observation is
fUt |X (ht (Yit ,Xit )−v Ft ;Xit )ht (Yit ,Xit )fλ|X (v;Xit )dv.

t=1

Now let n be a finite dimensional sieve space of , which depends on the sample size n and
has the property that θ0 can be approximated arbitrary well by some element in n when n is
large enough (see Assumption E4 in the Supplementary Appendix for the formal statement). For
example, ht could be approximated by a polynomial function, where the order of the polynomial
grows with the sample size. The estimator of θ0 is θ̂ ∈ n which satisfies
1
n

n

1
θ ∈n n

n

l(θ̂ ,Wi ) ≥ sup
i=1

l(θ,Wi )−op (1/n).
i=1

Once the sieve space is specified, estimation is equivalent to a parametric maximum likelihood
estimator.16 For the estimator to be consistent it is crucial that the parameter space reflects
all identification assumptions to ensure that θ0 is the unique maximizer of E [l(θ,Wi )] in
. Notice that the likelihood already incorporates independence of U1 ,...,UT ,λ. Moreover,
the normalizations in Assumptions N3(ii), N4, and N6 as well as monotonicity of ht are
straightforward to impose (see Section 5 for details). The remaining two assumptions, N7 and
N8, do not have to be imposed in the optimization problem. The reason is that even without
imposing the assumptions, a maximizer of E[l(θ,Wi )] corresponds to the true density of Y | X.
By Lemma 1 this density implies certain completeness conditions, which can only hold if the
covariance matrix of λ | X has full rank. Moreover, given Assumption N1–N7, completeness
is sufficient for identification and therefore θ0 is the unique maximizer of E [l(θ,Wi )]. Other
implementation issues, including specific sieve spaces, are discussed in Sections 4 and 5 (the
application and Monte Carlo simulations, respectively) in more detail.
The following result is shown in the appendix which, given the assumptions, follows from
Theorem 3.1 in combination with Condition 3.5M in Chen (2007).
Theorem 3. Let Assumptions N1–N8 and Assumptions E7–E9 in the Supplementary Appendix
p
hold. Let Assumption N9 in the Supplementary Appendix hold for all x ∈ X . Then θ̂ −θ0 s → 0.
Remark 5. It is well known that if the individual fixed effects are estimated as parameters, then
the maximum likelihood estimator is generally not consistent in non-linear panel data models
when T is fixed (i.e. the incidental parameters problem). I circumvents this problem by not treating
the fixed effects as parameters, but instead estimating the distribution of λ. The assumptions then
imply that the number of parameters grows slowly with the sample size, as opposed to being of
the same order as the sample size. However, I assume that λ has a smooth density, which is not
required when the fixed effects are treated as parameters (but in this case the estimator would
not be consistent). I therefore rule out for example that λ is discretely distributed, but I neither
impose parametric assumptions on its distribution, nor on the dependence between λ and X.

16. The definition ensures that the estimator is always well defined. If the solution to the sample optimization
problem is unique, then one can simply use θ̂ = argmaxθ ∈n n1 ni=1 l(θ,Wi ).

[17:29 14/6/2018 rdx052.tex]

RESTUD: The Review of Economic Studies

Page: 1834

1824–1851

JOACHIM FREYBERGER

NON-PARAMETRIC PANEL DATA MODELS

1835
Downloaded from https://academic.oup.com/restud/article-abstract/85/3/1824/4105005 by WWZ Bibliothek (Oeffentliche Bibliothek der UniversitÃ¤t Basel) user on 05 December 2018

Remark 6. Consistency of θ̂ in the · s norm implies consistency of plug-in estimators of
average and quantile structural functions. For example, let ŝt,α (x̃t ) = ĝt (x̃t , Q̂α [Ct +Ut ]), where
ĝt is the estimated structural function and Q̂α [Ct +Ut ] is the estimated α quantile of Ct +Ut
obtained from the estimated density. Then the assumptions and results of Theorem 3 imply that
p
ŝt,α (x̃t ) → st,α (x̃t ).

3.2.

Semiparametric estimator

I now outline a semiparametric estimator, which I use in the application. First, I reduce the
dimensionality of the estimation problem by making additional assumptions on the conditional
distribution of λ | X. In particular, I assume that λ = μ(X,β1 )+ (X,β2 )ε, where ε is independent
of X. The main advantage of this approach is that the likelihood now depends on the density
of ε as well as β1 and β2 instead of the high dimensional function fλ|X . Furthermore, I assume
that Ut is independent of X, but the density fUt is unknown. Alternatively, one could model the
dependence between Ut and X to allow for heteroskedasticity. The structural functions can be
parametric, semiparametric, or non-parametric depending on the application. To accommodate
all cases, I assume that ht (Yt ,Xt ) = m(Yt ,Xt ,αt ,β3t ), where β3t is a finite dimensional parameter,
αt is an unknown function, and m is a known function. As an example, in Sections 4 and 5, I
model ht (Yt ,Xt ) = αt (Yt )−Xt β3t .
Define the finite dimensional parameter vector β0 = (β1 ,β2 ,β31 ,...,β3T ,F) , let α0 =
(α1 ,...,αT ,fε ,fU1 ,...,fUT ) denote all unknown functions, and define θ0 ≡ (α0 ,β0 ). Now in
addition to the various finite dimensional parameters, several low dimensional functions, namely
T one-dimensional densities, one R-dimensional density, and the functions αt have to be estimated.
The estimator θ̂ = (α̂, β̂) is again computed using sieves and maximizing the log-likelihood
function. This is computationally almost identical to the estimator described in the previous
section, except that now there are less sieve terms and more finite dimensional parameters to
maximize over. Next to improved rates of convergence due to the reduced dimensionality,
another
√
major advantage of the semiparametric estimator is that β0 can be estimated at the n rate and the
estimator is asymptotically normally distributed. Thus, one can easily conduct inference. These
results are shown in the following theorem.
Theorem 4. Let Assumptions E2 and E8–E18 in the Supplementary Appendix hold. Then
 d 

√ 
n β̂ −β0 → N 0,(V ∗ )−1 , where V ∗ is defined in Equation (4) in the Supplementary Appendix.
The proof is very similar to the ones in Ai and Chen (2003) and Carroll et al. (2010) among
others. Ackerberg et al. (2012) provide a consistent estimator of the covariance matrix and discuss
its implementation in a more general setting.

3.3. Parametric estimator
Finally, given the previous results, it is straightforward to estimate the model completely
parametrically. In this case the densities fUt and fλ|X and the functions ht are assumed to be
known up to finite dimensional parameters. For example, one could assume that λ and Ut are
normally distributed, where the mean and the covariance of λ is a parametric function of X and the
variance of Ut is a constant. Consistency and asymptotic normality then follows from standard
arguments, such as those in Newey and McFadden (1994).

[17:29 14/6/2018 rdx052.tex]

RESTUD: The Review of Economic Studies

Page: 1835

1824–1851

1836

REVIEW OF ECONOMIC STUDIES
Downloaded from https://academic.oup.com/restud/article-abstract/85/3/1824/4105005 by WWZ Bibliothek (Oeffentliche Bibliothek der UniversitÃ¤t Basel) user on 05 December 2018

4. APPLICATION
This section investigates the relationship between teaching practice and student achievement
using test scores from the Trends in International Mathematics and Science Study (TIMSS).
4.1.

Data and background

The TIMSS is an international assessment of mathematics and science knowledge of fourth and
eighth-grade students. I make use of the 2007 sample of eighth-grade students in the U.S. This
sample consists of 7,377 students. Each student attends a math and an integrated science class
with different teachers in each class for most students. I exclude students which cannot be linked
to their teachers, students in classes with less than five students, and observations with missing
values in covariates (defined below).
The TIMSS contains test scores for different cognitive domains of the tests, which are
mathematics applying, knowing, and reasoning, as well as science applying, knowing, and
reasoning.17 I use these six test scores as the dependent variables Yit , where i denotes a student
and t denotes a test. Hence, T = 6 which allows me to estimate a factor model with two factors.
The main regressors are measures of modern and traditional teaching practice. Intuitively, modern
teaching practice is associated with group work and reasoning, while traditional teaching practice
is based on lectures and memorizing. To construct these, I follow Bietenbeck (2014) and use
students’ answers about frequencies of certain class activities. I number the response as 0 for
never, 0.25 for some lessons, 0.5 to about half of the lessons, and 1 for every or almost every
lesson, so that the numbers correspond approximately to the fraction of time the activities are
performed in class. The teaching measures of student i are the class means of these responses,
excluding the student’s own response.18
Various educational organizations have generally advocated for a greater use of modern
teaching practices and a shift away from traditional teaching methods (see Zemelman et al.
(2012) for a “consensus on best practice” and a list of sources, including among many others,
the National Research Council and the National Board of Professional Teaching Standards).
However, despite these policy recommendations, the empirical evidence on the relationship
between teaching practice and test scores is not conclusive and varies depending on the data
set, test scores, and methods used. For example, Schwerdt and Wuppermann (2011) make use of
the 2003 TIMSS data and find positive effects of traditional teaching practice. Bietenbeck (2014)
documents a positive effect of traditional and modern teaching practice on applying/knowing and
reasoning test scores, respectively. Using Spanish data, Hidalgo-Cabrillana and Lopez-Mayany
(2015) find a positive effect of modern teaching practice on math and reading test scores and, with
teaching measures constructed from students’ responses, a negative effect of traditional teaching
practice. Lavy (2016) finds evidence of positive effects of both modern and traditional teaching
practices on test scores using data from Israel. All of these studies at most allow for an additive
student individual effect. Since math includes sections on number, geometry, algebra, data, and
chance and science includes biology, chemistry, earth science, and physics, it is not clear a priori
that the two subjects require the same skills.19 I show below that the conclusions in the models
I estimate change considerably once more general heterogeneity is allowed for. Moreover, while
17. “Knowing” measures knowledge of facts, concepts, and procedures. “Applying” focuses on the ability of
students to solve routine problems. “Reasoning” covers unfamiliar situations, complex contexts, and multi-step problems.
18. The questions used to construct the teaching practice measures are listed in Table S.2 in the Supplementary Appendix. Bietenbeck (2014) contains much more details on their construction and the background literature.
19. For example, a physics “knowing” question asks what happens to an iron nail with an insulated wire coiled
around it, which is connected to a battery, when current flows through the wire (answer: the nail will become a magnet).
An algebra “knowing” question asks what 3x > 8 is equivalent to (answer: x > 24).

[17:29 14/6/2018 rdx052.tex]

RESTUD: The Review of Economic Studies

Page: 1836

1824–1851

JOACHIM FREYBERGER

NON-PARAMETRIC PANEL DATA MODELS

1837
Downloaded from https://academic.oup.com/restud/article-abstract/85/3/1824/4105005 by WWZ Bibliothek (Oeffentliche Bibliothek der UniversitÃ¤t Basel) user on 05 December 2018

Zemelman et al. (2012) generally advocate for modern teaching practices in all subjects, best
teaching practices vary across subjects. For instance, they write that “we now know that problem
solving can be a means to build mathematical knowledge” (p. 170). It is thus not obvious that the
same teaching practice dominates in both subjects and I therefore also allow for different effects
of teaching practices across test scores.20
The outcome equation of the general model is Yt = gt (Xt ,λ Ft +Ut ) and thus, Yt is an unknown
function of Xt . Hence, if Xt is discrete, a completely non-parametric estimator allows for a different
function for each point of support of the covariates, and a researcher can study the differences
of the estimated functions for different values of Xt . A major downside of this generality is
that there might be very few observations once all discrete covariates are controlled for. To
keep the non-parametric idea of the estimator, in this application I restrict myself to students
between the age of 13.5 and 15.5 and English as their first language, which leaves 1,739 male
and 1,787 female students in 169 schools with 235 math and 265 science teachers.21 I then
estimate the model separately for male and female students to illustrate how discrete covariates
can be incorporated non-parametrically, and how gender heterogeneity can be studied with the
non-parametric estimator. Similarly, the general model allows for a completely non-parametric
function of all additional covariates, including teaching practices, but estimating functions of
many dimensions implies a slow rate of convergence and poor finite sample properties. I therefore
estimate a flexible semiparametric model, similar to the one in the Monte Carlo simulations, which
allows among others for an unknown transformation of the test scores.

4.2.

Model and implementation

The results reported in this article are based on the outcome equation
αt (Yt ) = γt +Xttrad βttrad +Xtmod βtmod +Zt δ +λ Ft +Ut ,

(5)

where t = 1,2,3 are the math scores (applying, knowing, reasoning) and t = 4,5,6 are the science
scores (applying, knowing, reasoning). The scalars Xtmod and Xttrad are the modern and traditional
teaching practice measures. The vector Zt includes the other covariates, namely the class size,
hours spent in class, teacher experience, whether a teacher is certified in the field, and the gender
of the teacher. I set λ = μ(X trad ,X mod ,θ)+ε, where ε ⊥
⊥ X trad ,X mod ,Z and μ is a linear function
mod
trad
trad
mod
22
and X , and U ⊥
⊥ (λ,X ,X
,Z).
of X
I estimate marginal effects, evaluated at the median value of the observables and different
quantiles of λ Ft .23 There are twelve marginal effects I consider, namely the effect of traditional
teaching on Yt and the effect of modern teaching on Yt for t = 1,...,6, which correspond to
the derivative of the quantile structural function, st,q, 1 (x̃t ), discussed in Section 2.4. With the
2

20. Other settings where estimated effects differ considerably between math and science include the effects of
degrees/coursework and the gender of the teacher on student achievement, respectively (see Wayne and Youngs (2003)
and Dee (2007)).
21. I obtain qualitatively similar results for a smaller sample, with 897 male and 973 female students, which is
restricted to schools with an enrollment between 100 and 600 students, where parents’ involvement is not reported to be
very low, and where less than 75% of the students receive free lunch.
22. With this assumption, λ become correlated random effects instead of fixed effects. The results with a quadratic
μ are almost identical.
23. Estimation results based on the average structural functions, s̄t (xt ), and averaged over the covariates, are very
similar.

[17:29 14/6/2018 rdx052.tex]

RESTUD: The Review of Economic Studies

Page: 1837

1824–1851

1838

REVIEW OF ECONOMIC STUDIES
Downloaded from https://academic.oup.com/restud/article-abstract/85/3/1824/4105005 by WWZ Bibliothek (Oeffentliche Bibliothek der UniversitÃ¤t Basel) user on 05 December 2018

specification above, the marginal effect of traditional teaching is
∂
∂xttrad

αt−1 γt + x̃ttrad βttrad + x̃tmod βtmod + z̃t δ +Qq [λ Ft ] ,

(6)

where x̃ttrad = M[Xttrad ], x̃tmod = M[Xtmod ], and z̃t = M[Zt ]. In a linear model these marginal effect
are simply the slope coefficients βttrad and βtmod , and therefore do not depend on the skill
level. I show results for the linear fixed effects estimator (FE), three parametric models, and a
semiparametric estimator. All parametric models assume that at (·) is linear and that ε and Ut are
normally distributed. I consider a one factor model where Ft = 1 for all t, a one factor model with
time varying factors, and a two factor model to illustrate what is driving the differences between
the fixed effects estimates and the semiparametric estimates. In addition, I present results for a
linear fixed effects model, where the slope coefficients are identical across subjects, which is the
specification of Bietenbeck (2014).
For the semiparametric estimator I estimate among others six one-dimensional functions αt ,
six one-dimensional functions fUt , the two-dimensional pdf of ε, and twelve slope coefficients
for teaching practices. The outcome equation is only non-parametric in Yt because a more
flexible specification with higher dimensional functions would be very imprecise with the limited
sample size. While this specification is relatively simple, it keeps all important features of the
model, namely the two factors and heterogeneous marginal effects, and that the results do not
depend on the particular metric of the test scores. The linearity in Xttrad and Xtmod also has
the advantage that marginal effects are non-zero if and only if the slope coefficients are nonzero. Since the estimated slope coefficients are asymptotically normally distributed, we can find
significance of estimated marginal effects by testing H0 : βttrad = 0, even in the semiparametric
model, which would not be possible with a completely non-parametric function. Finally, although
the model is semiparametric, the structural functions are non-parametrically identified under
Assumptions N1–N8 and weak support conditions on the teaching practice measures, as discussed
in Section S.1.3 in Supplementary Appendix. To calculate the standard errors for the parametric
and semiparametric likelihood based estimators I use the estimated outer product form of the
covariance matrix as suggested by Ackerberg et al. (2012). For the linear fixed effects model I use
standard GMM-type standard errors. I defer specific implementation issues, such as the choices
of basis functions and how the constraints are imposed, to Section 5 as well as Section S.3 in the
Supplementary Appendix.
4.3. Results
Table 1 shows the estimated marginal effects for the sample of 1,739 boys.24 The results from
the linear fixed effects models suggest a positive relationship between Xttrad and knowing and
applying test scores as well as a positive relationship between Xtmod and reasoning scores. In the
unrestricted model, the slope coefficients are similar for math and science and thus, restricting
the slope coefficients to be the same across subjects yields similar results. I standardized Yt and
the teaching practice measures to have a standard deviation of 1. Hence, a one standard deviation
increase of X2trad is associated with a 0.078 standard deviation increase of Y2 in the unrestricted
fixed effects model. The marginal effects for a parametric one factor model with Ft = 1, where αt
is linear and all unobservables are normally distributed, are very similar to the fixed effects model,
24. For each student and test, the TIMSS contains five imputed values because students generally did not answer
the same set of questions. My results are based on the first imputed values for each student and test, but the results with
the others are similar.

[17:29 14/6/2018 rdx052.tex]

RESTUD: The Review of Economic Studies

Page: 1838

1824–1851

JOACHIM FREYBERGER

NON-PARAMETRIC PANEL DATA MODELS

1839
Downloaded from https://academic.oup.com/restud/article-abstract/85/3/1824/4105005 by WWZ Bibliothek (Oeffentliche Bibliothek der UniversitÃ¤t Basel) user on 05 December 2018

TABLE 1
Marginal effects teaching practice for boys
Fixed effects
Restr.

Unrestr.

Parametric
R=1
Ft = 1

R=1

Subject

Teaching

Math applying
Math knowing
Math reasoning

Trad.
Trad.
Trad.

0.034∗
0.063∗∗∗
0.021

0.041∗∗
0.078∗∗∗
0.015

0.042
0.079∗∗
0.011

0.105∗∗∗
0.142∗∗∗
0.089∗∗∗

Science applying
Science knowing
Science reasoning

Trad.
Trad.
Trad.

0.034∗
0.063∗∗∗
0.021

0.030
0.038∗
0.029

0.033∗∗∗
0.035∗∗∗
0.031∗∗∗

0.068∗∗∗
0.069∗∗∗
0.065∗∗∗

Math applying
Math knowing
Math reasoning

Modern
Modern
Modern

0.012
−0.011
0.046∗∗

0.023
−0.013
0.049∗∗

Science applying
Science knowing
Science reasoning

Modern
Modern
Modern

0.012
−0.011
0.046∗∗

0.009
0.011
0.045∗∗

0.022
−0.007
0.045
0.009
0.016∗
0.042∗∗∗

−0.010
−0.039
0.002
0.002
0.009
0.035∗∗∗

Semip.
R=2

R=2

0.138
0.171∗∗
0.117

0.139
0.174∗∗
0.120

−0.186
−0.189
−0.165

−0.193
−0.198
−0.173

−0.200∗∗
−0.214∗∗
−0.155∗∗

−0.200∗∗
−0.215∗∗
−0.159∗

0.405∗
0.421∗∗
0.396∗∗

0.411∗
0.428∗∗
0.402∗∗

The symbols *, **, and *** denote significance at 10%, 5%, and 1% level, respectively. Significance levels are obtained
by testing H0 : βttrad = 0 and H0 : βtmod = 0.

which is not surprising because they are based on the same outcome equation. However, in the
fixed effects model, Ut is not assumed to be independent over t and the relation between λ and X
is not modeled. Independence might be hard to justify here because all three math (and similarly
science) test scores are obtained from the same overall test. Nonetheless, the two models yield
very similar conclusions. Allowing Ft to vary produces different marginal effects, which now
suggest that traditional teaching practices are associated with better test scores in both subjects.
Moreover, in this model β̂ttrad > β̂tmod for all t.
Allowing for two individual effects changes the estimates considerably. Specifically, a
parametric two factor model still yields a positive relationship between Xttrad and math scores, but
a negative relationship between Xttrad and science scores. Contrarily, Xtmod has a positive effect on
science and a negative effect on math. The effect of Xttrad on math knowing scores and the effects
of Xtmod on all tests are significantly different from 0. Furthermore, I reject H0 : β1trad = β2trad =
β3trad = 0 and H0 : β1mod = β2mod = β3mod = 0 at the 1% level and H0 : β4mod = β5mod = β6mod = 0 at
the 2% level. For modern teaching practice I also reject that the marginal effects in the two factor
model are the same as the ones in the linear fixed effects model (for each t at least at the 10%
level). The estimated matrix of factors is

Skill 1
Skill 2



Math applying Math knowing Math reasoning Science applying Science knowing Science reasoning

1.00
0.00

0.94
0.04

0.84
0.03

0.03
0.98

0.00
1.00

0.11
0.89


.

The math subjects have more weight on the first skill, while science subjects have more weight
on the second skill. Two numbers are exactly 0 and two are exactly 1, which corresponds
to a particular normalization. That is, λ1 can be interpreted as the skills needed for math
applying and λ2 are the skills for science knowing. Hence, the skills needed in other subjects
are linear combinations of these two skills. The estimated correlation is around 68%. Notice
that identification would fail if two factors, next to F12 and F51 , were zero. Using the results in
Chen et al. (2011), I can test whether any combination of two factors are 0 and I reject each such
null at least at the 10% level. I also reject the one factor model in favour of the two factor model at

[17:29 14/6/2018 rdx052.tex]

RESTUD: The Review of Economic Studies

Page: 1839

1824–1851

1840

REVIEW OF ECONOMIC STUDIES
Downloaded from https://academic.oup.com/restud/article-abstract/85/3/1824/4105005 by WWZ Bibliothek (Oeffentliche Bibliothek der UniversitÃ¤t Basel) user on 05 December 2018

Figure 1
Derivatives of quantile structural functions

the 1% level. The Appendix also contains results for the sample of 1,787 girls. While the results
are mostly qualitatively similar, the estimated marginal effects of tradition teaching practices on
math scores are not statistically significant and negative, suggesting heterogeneity in gender.
The estimated marginal effects in the semiparametric model, evaluated at the median of the
observables and unobservables, are very similar to the ones in the parametric two factor model.
The additional conclusions one can draw from a non-linear model are illustrated in Figure 1,
which shows derivatives of quantile structural functions, namely estimates of
∂

α −1 γ1 +x1trad β1trad + x̃1mod β1mod + z̃1 δ +Qq [λ F1 ]
∂x1trad 1
in the left panel (as a function of quantiles of X1trad and for different quantiles of λ F1 ) and
∂
∂x6mod

α6−1 γ6 + x̃6trad β6trad +x6mod β6mod + z̃6 δ +Qq [λ F6 ]

in the right panel (as a function of quantiles of X6mod and for different quantiles of λ F1 ).25 The
results suggest that marginal effects are larger for small values of teaching practices and larger for
students with low abilities, because the smaller q, the larger the function values. Hence, changes
in teaching practices seem to have a larger impact on low ability students. These conclusions
generally also hold for the other ten marginal effects as shown in Table 2. This table displays
derivatives of the quantile structural functions for different quantiles of λ Ft (high skills is the
95% quantile, medium the 50% quantile, and low skills the 5% quantile) and evaluated at the
median values of the covariates. Similar as in Figure 1, the marginal effects are usually largest in
absolute value for students with low abilities.
25. Using quantiles of λ Ft +Ut yields similar results and even more heterogeneity due to the presence of the
additional random variable Ut .

[17:29 14/6/2018 rdx052.tex]

RESTUD: The Review of Economic Studies

Page: 1840

1824–1851

JOACHIM FREYBERGER

NON-PARAMETRIC PANEL DATA MODELS

1841
Downloaded from https://academic.oup.com/restud/article-abstract/85/3/1824/4105005 by WWZ Bibliothek (Oeffentliche Bibliothek der UniversitÃ¤t Basel) user on 05 December 2018

TABLE 2
Marginal effects for boys and different skills
Subject

Teaching

Low skills

Medium skills

High skills

Math applying
Math knowing
Math reasoning

Trad.
Trad.
Trad.

0.150
0.174
0.118

0.139
0.174
0.120

0.128
0.165
0.109

Science applying
Science knowing
Science reasoning

Trad.
Trad.
Trad.

−0.197
−0.202
−0.181

−0.193
−0.198
−0.173

−0.183
−0.185
−0.157

Math applying
Math knowing
Math reasoning

Modern
Modern
Modern

−0.215
−0.216
−0.156

−0.200
−0.215
−0.159

−0.183
−0.204
−0.144

Science applying
Science knowing
Science reasoning

Modern
Modern
Modern

0.421
0.436
0.420

0.411
0.428
0.402

0.391
0.400
0.364

To better understand the differences between the fixed effects and the two factor model,
suppose αt is linear and suppress Zt . Then differencing two outcomes for t ∈ {1,2,3} and s ∈
{4,5,6} yields
Yt −Ys = γt −γs +Xttrad βttrad −Xstrad βstrad +Xtmod βtmod −Xsmod βsmod +λ (Ft −Fs )+Ut −Us
and λ (Ft −Fs ) = λ1 (Ft1 −Fs1 )+λ2 (Ft2 −Fs2 ). In this case (Ft1 −Fs1 ) > 0 while (Ft2 −Fs2 ) < 0,
differencing might not eliminate the bias, and the direction of the bias depends on the correlation
between λ and the regressors. The signs of the marginal effect changes in two cases, namely
the effect of Xtmod on math and Xstrad on science, respectively. In the two factor model, Xtmod is
positively correlated with the first skill (representing applying-math) and negatively correlated
with the second skill (representing knowing-science). Hence, the fixed effects model leads to
a positive bias of the effect of Xtmod on math, which explains the first sign change. Similarly,
Xstrad is negatively correlated with the first skill and positively correlated with the second skill,
leading to a positive bias of the effect of Xstrad on science. These correlations could either be due
to teachers adapting their teaching style to the skills of the students or due to students selecting
certain teachers based on their skills. Therefore, a linear fixed effects model can lead to very
different conclusions compared to a model that allows for richer heterogeneity.
5. MONTE CARLO SIMULATIONS
In this section, I investigate the finite sample properties of the estimators in a setting that is
calibrated to mimic the data in the empirical application. Again I let
αt (Yt ) = γt +Xttrad βttrad +Xtmod βtmod +λ Ft +Ut ,
where Xttrad ,Xtmod ∈ R, λ ∈ R2 , and T = 6. Moreover, Xttrad = X1trad for all t = 1,2,3 and
Xttrad = X4trad for all t = 4,5,6. The same holds for Xtmod . I draw Xttrad and Xtmod from the
empirical distribution of teaching practices I use in the application.26 The sample size is
26. The regressors Xttrad and Xtmod correspond to the traditional and modern teaching practice measure, respectively.
In the application t = 1,2,3 belongs to mathematics and t = 4,5,6 belongs to science test scores. Non-parametric

[17:29 14/6/2018 rdx052.tex]

RESTUD: The Review of Economic Studies

Page: 1841

1824–1851

1842

REVIEW OF ECONOMIC STUDIES
Downloaded from https://academic.oup.com/restud/article-abstract/85/3/1824/4105005 by WWZ Bibliothek (Oeffentliche Bibliothek der UniversitÃ¤t Basel) user on 05 December 2018

n = 1739 as in the application. I set β trad = (0.14 0.17 0.12 −0.19 −0.19 −0.17), and β mod =
(−0.20 −0.21 −0.16 0.41 0.42 0.40), which are the point estimates from the two factor model in
the empirical application. I assume that λ = μ(X trad ,X mod ,θ)+ε, where ε | X trad ,X mod ∼ N (0, )
with 11 = 0.90, 22 = 0.89, 21 = 12 = 0.61, and that μ(X trad ,X mod ,θ) is a linear function of
X1trad , X4trad , X1mod , and X4mod . Notice that the correlation between the two skills is roughly 0.68.
The values of θ are also set to the point estimates and so is


1.00 0.94 0.84 0.03 0.00 0.11
F=
.
0.00 0.04 0.03 0.98 1.00 0.89


I assume that Ut ∼ N 0,σt2 , where σ = (0.16 0.22 0.53 0.21 0.21 0.31) are again the point
estimates in the application. Finally, I choose αt (Yt ) = (Yt +ct )at /st , where at , ct , and st are chosen
to mimic the non-parametrically estimated transformations in the application and to ensure that
αt (Yt ) satisfies the normalization αt (0) = 1. Here at > 1 for all t, which implies that αt (Yt ) is
convex, just as the estimated functions in the empirical application.
I use five different estimators, which I also used in the empirical application, namely a linear
fixed effects estimator (FE), three parametric estimators, and a semiparametric estimator. Again,
all parametric estimators assume that at (·) is linear and that ε and Ut are normally distributed.
The parametric estimators include a one factor model where Ft = 1 for all t, a one factor model
with time varying factors, and a two factor model. For the semiparametric estimator I nonparametrically estimate αt , fUt , and the two-dimensional pdf of ε next to the finite dimensional
parameters. To implement the semiparametric estimator, I approximate fUt (u) by a Hermite
polynomial of degree 4, which implies that
1
fUt (u) ≈
σt

 4

2
dkt u

k−1

φ(u/σt )

=

k=1

1
σt

4

4

djt dkt uj−1 uk−1 φ(u/σt )2 ,
j=1 k=1

where φ(u) denotes the standard normal pdf. While the theoretical arguments would allow setting
σt = 1 for all t, choosing σt to be an estimated standard deviation of Ut improves the finite sample
properties (see Gallant and Nychka (1987) and Newey and Powell (2003) for related arguments).
I set σt to the estimated standard deviation obtained from a parametric model. Notice that the
estimated density is positive by construction. Moreover, since

 z/σt
4 4
4 4
1 z
djt dkt uj−1 uk−1 φ(u/σt )2 du =
djt dkt
uj−1 uk−1 φ(u)2 du,
σt −∞
−∞
j=1 k=1
j=1 k=1
both the constraint that the density integrates to 1 (with z = ∞) and the median 0 restriction (with
z = 0) are quadratic constraints in djt . Similarly, I write λ = μ(X trad ,X mod ,θ)+ 1/2 ε̃, I set to
the estimated covariance matrix from a parametric model, and I approximate the density of ε̃ by
⎛

⎞2

fε̃ (e1 ,e2 ) ≈ ⎝

ajk e1 e2k−1 φ(e1 )φ(e2 )⎠ .
j−1

j,k∈Z+ :j+k≤4

identification in this setup is shown in Section S.1.3 in Supplementary Appendix. Drawing Xttrad and Xtmod from truncated
normal distributions with the means, the covariance matrix, and the cutoffs chosen such that the distributions closely
mimic the empirical distributions, yields almost identical results.

[17:29 14/6/2018 rdx052.tex]

RESTUD: The Review of Economic Studies

Page: 1842

1824–1851

JOACHIM FREYBERGER

NON-PARAMETRIC PANEL DATA MODELS

1843
Downloaded from https://academic.oup.com/restud/article-abstract/85/3/1824/4105005 by WWZ Bibliothek (Oeffentliche Bibliothek der UniversitÃ¤t Basel) user on 05 December 2018

TABLE 3
Median of estimated marginal effects and MSE
Parametric
Subject

Teaching

True

Math applying

Trad.

0.136

Math knowing

Trad.

0.170

Math reasoning

Trad.

0.116

Science applying

Trad.

−0.186

Science knowing

Trad.

−0.189

Science reasoning

Trad.

−0.163

Math applying

Modern

−0.197

Math knowing

Modern

−0.213

Math reasoning

Modern

−0.154

Science applying

Modern

0.403

Science knowing

Modern

0.420

Science reasoning

Modern

0.390

Semip.

R=1
Ft = 1

R=1

R=2

0.043
(0.009)
0.080
(0.008)
0.006
(0.012)

0.043
(0.009)
0.078
(0.008)
0.006
(0.012)

0.105
(0.001)
0.140
(0.001)
0.088
(0.001)

0.139
(0.003)
0.173
(0.003)
0.117
(0.002)

0.140
(0.003)
0.173
(0.003)
0.118
(0.002)

0.030
(0.047)
0.033
(0.049)
0.029
(0.037)

0.031
(0.047)
0.032
(0.049)
0.031
(0.038)

0.068
(0.065)
0.069
(0.067)
0.065
(0.052)

−0.175
(0.016)
−0.178
(0.017)
−0.156
(0.013)

−0.176
(0.015)
−0.179
(0.017)
−0.157
(0.013)

0.023
(0.048)
0.000
(0.045)
0.047
(0.041)

0.025
(0.049)
0.000
(0.045)
0.050
(0.042)

−0.009
(0.035)
−0.035
(0.032)
0.005
(0.025)

−0.196
(0.003)
−0.212
(0.003)
−0.152
(0.002)

−0.194
(0.003)
−0.210
(0.003)
−0.150
(0.002)

0.015
(0.151)
0.023
(0.157)
0.040
(0.122)

0.014
(0.151)
0.022
(0.158)
0.041
(0.122)

0.004
(0.159)
0.013
(0.166)
0.031
(0.129)

0.386
(0.022)
0.405
(0.023)
0.378
(0.018)

0.385
(0.021)
0.402
(0.022)
0.379
(0.017)

FE

R=2

j−1

The sum includes all basis functions of the form e1 e2k−1 φ(e1 )φ(e2 ) with j +k ≤ 4 and j,k ≥ 1.27
Notice that without the scale and location model, the density of λ | X trad ,X mod would be a sixdimensional function, which would lead to imprecise estimates with a sample size of 1739. I
j
approximate αt (Yt ) with polynomials of order 4, that is αt (Yt ) ≈ Yt + 4j=2 Yt bjt . The coefficient

in front of Yt is 1 to impose the scale normalization αt (0) = 1 and to ensure that the semiparametric
model nests the linear model. The location normalizations are easy to impose by setting γt = 0
for two periods, or by imposing M[λj ] = 0 for j = 1,2. I use the latter restriction to facilitate
comparison with a parametric model, where λ is normally distributed and M[λj ] = 0. I approximate
the integral in the likelihood using Gauss-Hermite quadrature. With these choices, estimating the
parameters amounts to maximizing a non-linear function subject to quadratic constraints. In
Section S.3 of the Supplementary Appendix, I provide details on the convergence behavior in the
simulations and the application.
I investigate finite sample properties of estimated marginal effects, evaluated at the median
value of the observables and unobservables, as well as coverage rates of confidence intervals for
the slope coefficients.28 The marginal effects are analogous to those in Table 1 are described in
Equation (6). The results are based on 1,000 Monte Carlo simulations. Table 3 shows the true
27. For a given number of parameters, this specification typically leads to a better approximation of the function
than a tensor product (Judd, 1998).
28. While the marginal effects are invariant to the normalizations, the slope coefficients depend on the scale
normalizations. Hence, imposing the true normalizations is crucial for obtaining correct coverage. In the application, I

[17:29 14/6/2018 rdx052.tex]

RESTUD: The Review of Economic Studies

Page: 1843

1824–1851

1844

REVIEW OF ECONOMIC STUDIES
Downloaded from https://academic.oup.com/restud/article-abstract/85/3/1824/4105005 by WWZ Bibliothek (Oeffentliche Bibliothek der UniversitÃ¤t Basel) user on 05 December 2018

TABLE 4
Coverage rates of confidence intervals with nominal level 95%
Parametric

Semip.

FE

R=1
Ft = 1

R=1

R=2

R=2

Trad.
Trad.
Trad.

0.001
0.001
0.000

0.201
0.159
0.001

0.995
0.998
0.883

0.958
0.959
0.957

0.966
0.964
0.967

Science applying
Science knowing
Science reasoning

Trad.
Trad.
Trad.

0.000
0.000
0.000

0.000
0.000
0.000

0.000
0.000
0.000

0.952
0.957
0.955

0.964
0.965
0.965

Math applying
Math knowing
Math reasoning

Modern
Modern
Modern

0.000
0.000
0.000

0.000
0.000
0.000

0.000
0.000
0.000

0.957
0.952
0.953

0.961
0.958
0.960

Science applying
Science knowing
Science reasoning

Modern
Modern
Modern

0.000
0.000
0.000

0.000
0.000
0.000

0.000
0.000
0.000

0.941
0.940
0.939

0.950
0.948
0.953

Subject

Teaching

Math applying
Math knowing
Math reasoning

marginal effects as well as the median of the estimated marginal effects and the median squared
error (MSE) in parenthesis.29 The fixed effects estimator and the one factor model with Ft = 1
perform very similar and have large biases and MSEs. Time varying Ft only help reducing the
biases for t = 1,2,3. Both the parametric and the semiparametric two factor models perform very
well and very similar, both in terms of the median estimated marginal effect and the MSE. The
parametric model is misspecified because it assumes a linear transformation, but this seems to
be a good approximation for marginal effects at the median. However, at different quantiles, the
model predicts the same marginal effects, which will lead to a bias.
Table 4 shows coverage rates of confidence intervals for the estimated slope coefficients. As
expected, all one factor models have poor coverage rates. Contrarily, both two factor models have
coverage rates close to 95% for all slope coefficients.
6. CONCLUSION
This article studies a class of non-parametric panel data models with multidimensional,
unobserved individual effects, which can impact outcomes Yt differently for different t. These
models are appealing in a variety of empirical applications where unobserved heterogeneity is
not believed to be one dimensional and time homogeneous, and a researcher wants to allow for
a flexible relationship between Yt , Xt , and the unobservables. In microeconomic applications,
researchers routinely use panel data to control for “abilities” using a fixed effects approach. The
methods presented here allow researchers to specify much more general and realistic unobserved
heterogeneity by exploiting rich enough data sets. For example, in an empirical application,
I investigate the relationship between teaching practice and math and science test scores. As
opposed to a standard linear fixed effects model, I allow students to have two unobserved
individual effects, which can have different impacts on different tests. Hence, some students
can have abilities such that they are better in math, while others can be better in science. The
am interested in testing H0 : βttrad = 0, which is invariant to the normalizations and thus, coverage rates of confidence
intervals for the (possibly scaled) slope coefficients are of interest.
29. I use the median and the median squared error to make the results less dependent on outliers.

[17:29 14/6/2018 rdx052.tex]

RESTUD: The Review of Economic Studies

Page: 1844

1824–1851

JOACHIM FREYBERGER

NON-PARAMETRIC PANEL DATA MODELS

1845
Downloaded from https://academic.oup.com/restud/article-abstract/85/3/1824/4105005 by WWZ Bibliothek (Oeffentliche Bibliothek der UniversitÃ¤t Basel) user on 05 December 2018

results from this model differ considerably from the ones obtained with a linear fixed effects
model, which has also been used in related contexts, such as studying the relationship between
student achievement and the gender of the teacher, teacher credentials, or teaching practice,
respectively. Since one-dimensional heterogeneity appears to be very restrictive in this context
and the conclusions from the two factor model are substantially different, specifying the most
realistic model is crucial and might warrant a more in depth analysis, possibly with an even richer
data set. Moreover, the models allow for heterogeneous marginal effects and thus, the effects of
teaching practices on test scores can depend on students’ abilities. I find that the marginal effects
of a change in teaching practice on test scores are larger for students with low abilities. Next to
microeconomic applications and the examples mentioned in the introduction, the models can for
example also be useful in empirical asset pricing, where the return of firm i in time t, denoted
by Yit , can then depend on characteristics Xit and a small number of factors. The non-parametric
approach reduces concerns about functional form misspecification (Fama and French, 2008).
I present non-parametric point identification conditions for all parameters of the models,
which include the structural functions, the number of factors, the factors themselves, and the
distributions of the unobservables, λ and Ut , conditional on the regressors. I also provide a nonparametric maximum likelihood estimator, which allows estimating the parameters consistently,
as well as flexible semiparametric and parametric estimators.
One restriction of the models is that, other than lagged dependent variables studied in
Section S.1.4 in Supplementary Appendix, the regressors are strictly exogenous. It would
therefore be useful to incorporate predetermined regressors, which might require modeling
their dependence. Furthermore, while Section S.2.3 in the Supplementary Appendix suggests
an approach to estimate the number of factors consistently, providing an estimator with desirable
finite sample properties, similar to the ones proposed by Bai and Ng (2002) in linear factor
models, is another open problem. Finally, it would be interesting to extend the analysis to a large
n and large T framework, where so far the existing models do not allow for interactions between
covariates and unobservables.

APPENDIX
A. IDENTIFICATION PROOFS
A.1. A useful lemma
Lemma 1. Let Assumptions N1, N2, N3(i), N5 – N8 hold.Let Z3 = (YR+2
 ,...,Y2R+1 ). Let K ≡ {k1 ,k2 ,...,kR } be a set of
any R distinct integers between 1 and R+1. Define Z1K ≡ Yk1 ,...,YkR . Then Z3 is bounded complete for Z1K and λ is
bounded complete for Z3 given X.
Proof. Condition on X ∈ X and suppress X. Since Z3 and Z1K are independent conditional on λ,

fZ K ,Z3 (z1 ,z3 ) =

fZ3 |λ (z3 ;v)fZ K |λ (z1 ;v)fλ (v)dv.

1

1

It follows that for any bounded function m such that E[|m(Z3 )|] < ∞





fZ K ,Z3 (z1 ,z3 )m(z3 )dz3 =
1

fZ K ,λ (z1 ,v)
1


fZ3 |λ (z3 ;v)m(z3 )dz3 dv.

Conditional on X = x we can write Z3 = g(x,λ+V ), where V = (UR+2 ,...,U2R+1 ) and g : RR → RR with g(x,v) =
(gR+2 (xR+2 ,vR+2 ),...,g2R+1 (x2R+1 ,v2R+1 )). From Theorem 2.1 in D’Haultfoeuille (2011) it follows that Z3 is bounded
complete for λ. Furthermore, Proposition 2.4 in D’Haultfoeuille (2011) implies that λ is (bounded) complete for Z1K and
that λ is (bounded) complete for Z3 . Hence, by the previous equality, Z3 is bounded complete for Z1K .

[17:29 14/6/2018 rdx052.tex]

RESTUD: The Review of Economic Studies

Page: 1845

1824–1851

1846

REVIEW OF ECONOMIC STUDIES
Downloaded from https://academic.oup.com/restud/article-abstract/85/3/1824/4105005 by WWZ Bibliothek (Oeffentliche Bibliothek der UniversitÃ¤t Basel) user on 05 December 2018

A.2. Proof of Theorem 1
R
First define Z1 ≡ (Y1 ,...,YR ), Z2 ≡ YR+1 , and Z3 ≡ (YR+2 ,...,Y2R+1 ), and let Z1 ⊆ RR , Z2 ⊆ R, and
 Z3 ⊆ R be the

R = m : RR → R :
Next
define
the
function
spaces
L
|m(v)|dv
<∞ ,
supports of Z1 , Z2 , and Z3 , respectively.
R
R




R
R
R
R
R
L (Z1 ) ≡ m : R → R : RR |m(v)|fZ1 (v)dv < ∞
and
Lbnd (Z1 ) ≡
Lbnd =R m ∈ L : supv∈RR |m(v)| < ∞ ,
m ∈ L (Z1 ) : supv∈RR |m(v)| < ∞ . Define LR (Z3 ), LRbnd (Z3 ), LR (), and LRbnd () analogously. Now condition
on X = x, where x ∈ X such that xt = x̄t for all t = R+2,...,2R+1, let z2 ∈ R be a fixed constant, and define



L1,2,3 : LRbnd (Z1 ) → LRbnd L1,2,3 m (z2 ,z3 ) ≡ fZ1 ,Z2 ,Z3 |X (z1 ,z2 ,z3 ;x)m(z1 )dz1

L1,3 : LRbnd (Z1 ) → LRbnd
L3,λ : LRbnd → LRbnd
Lλ,1 : LRbnd (Z1 ) → LRbnd
D2,λ : LRbnd () → LRbnd ()


L1,3 m (z3 ) ≡





L3,λ m (z3 ) ≡




Lλ,1 m (v) ≡


fZ1 ,Z3 |X (z1 ,z3 ;x)m(z1 )dz1

fZ3 |λ,X (z3 ;v,x)m(v)dv


fZ1 ,λ|X (z1 ,v;x)m(z1 )dz1




D2,λ m (z2 ,v) ≡ fZ2 |λ,X (z2 ;v,x)m(v).

The operator L1,2,3 is a mapping from LRbnd (Z1 ) to LRbnd for a fixed value z2 . Changing the value of z2 gives a different
mapping. With these definitions it follows from Assumption N5 that for any m ∈ LRbnd (Z1 )



L1,2,3 m (z2 ,z3 ) = fZ1 ,Z2 ,Z3 |X (z1 ,z2 ,z3 ;x)m(z1 )dz1
 
=

=

=


fZ3 |λ,X (z3 ;v,x)fZ2 |λ,X (z2 ;v,x)fZ1 ,λ|X (z1 ,v;x)dv m(z1 )dz1



fZ3 |λ,X (z3 ;v,x)fZ2 |λ,X (z2 ;v,x) Lλ,1 m (v)dv


fZ3 |λ,X (z3 ;v,x) D2,λ Lλ,1 m (z2 ,v)dv



= L3,λ D2,λ Lλ,1 m (z2 ,z3 ).




Similarly, L1,3 m (z3 ) = L3,λ Lλ,1 m (z3 ). These equalities hold for all functions m ∈ LRbnd (Z1 ) and thus we can write
L1,2,3 = L3,λ D2,λ Lλ,1 and L1,3 = L3,λ Lλ,1 . By Lemma 1, L3,λ is invertible and the inverse can be applied from the left.
−1
−1
L1,3 = Lλ,1 , which implies that L1,2,3 = L3,λ D2,λ L3,λ
L1,3 . Lemma 1 of Hu and Schennach (2008) and
It follows that L3,λ
Lemma 1 above imply that L1,3 has a right inverse which is densely defined on LRbnd . Therefore,
−1
−1
L1,2,3 L1,3
= L3,λ D2,λ L3,λ
.

The operator on the left-hand side depends on the population distribution of the observables only. Hence, it can be
considered known. Hu and Schennach (2008) deal with the same type of operator equality in a measurement error setup.
They show that the operator on the left-hand side is bounded and its domain can therefore be extended to LRbnd . They
−1
also show that the right-hand side is an eigenvalue-eigenfunction decomposition of the known operator L1,2,3 L1,3
. The
eigenfunctions are fZ3 |λ,X (z3 ;v,x) with corresponding eigenvalues fZ2 |λ,X (z2 ;v,x). Each v indexes an eigenfunction and
an eigenvalue. The eigenfunctions are functions of z3 , while x and z2 are fixed. Hu and Schennach (2008) show that this
decomposition is unique up to three features:
(1) Scaling: Multiplying each eigenfunction by a constant yields a different eigenvalue-eigenfunction decomposition
−1
.
belonging to the same operator L1,2,3 L1,3
(2) Eigenvalue degeneracy: If two or more eigenfunctions share the same eigenvalue, any linear combination of these
functions are also eigenfunctions. Then several different eigenvalue-eigenfunction decompositions belong to the same
−1
.
operator L1,2,3 L1,3
−1
(3) Ordering: Let λ̃ = B(λ,x) for any one-to-one transformation B : RR → RR . Then L3,λ D2,λ L3,λ
= L3,λ̃ D2,λ̃ L −1 .
3,λ̃

These conditions are very similar to conditions for non-uniqueness of an eigendecomposition of a square matrix. While
for matrices the order of the columns of the matrix that contains the eigenvectors is not fixed, with operators any one-toone transformation of λ leads to an eigendecomposition with the same eigenvalues and eigenfunctions (but in a different
order). I show next that the assumptions fix the scaling and the ordering and that all eigenvalues are unique. It then follows
−1
−1
that there are unique operators L3,λ and D2,λ such that L1,2,3 L1,3
= L3,λ D2,λ L3,λ
.

[17:29 14/6/2018 rdx052.tex]

RESTUD: The Review of Economic Studies

Page: 1846

1824–1851

JOACHIM FREYBERGER

NON-PARAMETRIC PANEL DATA MODELS

1847
Downloaded from https://academic.oup.com/restud/article-abstract/85/3/1824/4105005 by WWZ Bibliothek (Oeffentliche Bibliothek der UniversitÃ¤t Basel) user on 05 December 2018

First, the scale of the eigenfunctions is fixed because the eigenfunctions we are interested in are densities and
therefore have to integrate to 1. Second, two different eigenfunctions share the same eigenvalue if there exists v and w
with v = w such that fZ2 |λ,X (z2 ;v,x) = fZ2 |λ,X (z2 ;w,x). Following Hu and Schennach (2008), while this could happen for
a fixed z2 , changing z2 leads to a different eigendecomposition with identical eigenfunctions. Therefore, combining all
these eigendecompositions, eigenvalue degeneracy only occurs if two eigenfunctions share the same eigenvalue for all
z2 ∈ Z2 , which means that fZ2 |λ,X (z2 ;v,x) = fZ2 |λ,X (z2 ;w,x) for all z2 ∈ Z2 . Recall that Z2 = YR+1 ∈ R, while λ ∈ RR . Given
the structure of the model, we get fZ2 |λ,X (z2 ;v,x) = fZ2 |λ,X (z2 ;w,x) for all z2 ∈ Z2 if v FR+1 = w FR+1 , which is clearly
possible if R > 1. Hu and Schennach (2008) rule out this situation in their Assumption 4, but an analog of this assumption
does not hold here if R > 1. Hence, compared to Hu and Schennach (2008), additional arguments are needed to solve the
eigenvalue degeneracy problem. To do so, notice that, similar as in the linear model, we can rotate the outcomes in Z1
and Z2 . Specifically, let K ≡ {k1 ,k2 ,...,k
 R } be a set of any R integers between 1 and R+1 with k1 < k2 < ... < kR and let
kR+1 = {1,...,R+1}\K. Define Z1K ≡ Yk1 ,...,YkR and Z2K = YkR+1 . For example, if R = 2 and T = 5, then we could take
K = {2,3} and kR+1 = 1 and thus, Z1K = (Y2 ,Y3 ) and Z2K = Y1 . Let Z1K be the support of Z1K and, analogously to before,
define the operators

 K

K
L1,2,3
: LRbnd (Z1K ) → LRbnd L1,2,3
m (z2 ,z3 ) ≡ fZ K ,Z K ,Z3 |X (z1 ,z2 ,z3 ;x)m(z1 )dz1
1

K
L1,3
: LRbnd (Z1 ) → LRbnd
K
D2,λ
: LRbnd () → LRbnd ()




K
L1,3
m (z3 ) ≡



K
D2,λ
m



2


fZ K ,Z3 |X (z1 ,z3 ;x)m(z1 )dz1
1

(z2 ,v) ≡ fZ K |λ,X (z2 ;v,x)m(v).
2

Then using identical arguments to before, it can be shown that for all sets K
−1
K
K −1
K
L1,2,3
(L1,3
) = L3,λ D2,λ
L3,λ
.
K
K )−1 has the same eigenfunctions for all K. Hence, by considering the eigendecomposition for
It follows that L1,2,3
(L1,3
all K, the eigenvalue degeneracy issue now only occurs if two or more eigenfunctions share the same eigenvalue for all
operators, which is a similar idea to varying z2 above. In terms of Yt , this means that eigenvalue degeneracy arises if for
v = w it holds that fYt |λ (yt ;v) = fYt |λ (yt ;w) for all yt ∈ Yt and all t = 1,...,R+1. However, Assumptions N3(i), N4, and N6
imply that M[Yt | λ = v] = gt (v Ft ), that gt are strictly increasing functions, and that the matrix (F1 ... FR ) has full rank.
Hence fYt |λ (yt ;v) = fYt |λ (yt ;w) for all yt ∈ Yt and all t = 1,...,R+1 implies that v (F1 ... FR ) = w (F1 ... FR ), which in turn
implies that v = w.
Third, I show that there is a unique ordering of the eigenfunctions which coincides with L3,λ . Generally, the problem
is that while the sets of eigenfunctions and eigenvalues are uniquely determined, these sets do not uniquely define the
distribution of λ | X. In particular, let λ̃ = B(λ,x), where B(·,x) is a one-to-one transformation of λ, which may depend
on x. Then fZ3 |λ,X (·;v,x) = fZ3 |B(λ,x),X (·;B(v,x),x) and hence each eigenfunction could belong to fZ3 |λ̃,X (·; ṽ,x) for some

ṽ.30 To solve the ordering issue, Hu and Schennach (2008) and Cunha et al. (2010) assume that there exists a known
function  such that (fZ3 |λ,X (·;λ,x)) = λ (see Assumption 5 in Hu and Schennach (2008)). Notice that in the factor
model discussed in this article, the assumptions already imply M(YR+1+r | λ = v,X = x) = gR+1+r (x,vr ). Hence, it might
be tempting to impose the “normalization” gR+1+r (x,λr ) = λr so that M(Z3 | λ,X = x) = λ. However, as shown below, here
the distribution of Y | λ is identified without such an additional “normalization” of λ. Thus, imposing this “normalization”
is only consistent with the model if gR+1+r is linear in the second argument for all r = 1,...,R, which is a strong assumption.
Now to show that there is a unique ordering, first notice that both λ̃ = B(λ,x) and λ have to be consistent with the model.
In particular, for λ̃ there has to exist strictly increasing and differentiable functions g̃t (with inverses h̃t ) such that
M(YR+1+r | λ̃ = ṽ,X = x) = g̃R+1+r (xR+1+r , ṽr ) for all r = 1,...,R.
In particular, the conditional median of YR+1+r only depends on the r’th element of ṽr . Since
M(YR+1+r | λ = v,X = x) = M(YR+1+r | B(λ,x) = B(v,x),X = x)

it follows that gR+1+r (xR+1+r ,vr ) = g̃R+1+r (xR+1+r ,Br (v,x)). Moreover, since g̃R+1+r is strictly increasing and
differentiable, it has to hold that Br (·,x) is differentiable. Since the left-hand side only depends on vr , it follows that

30. To see why B(·,x) has to be one-to-one, notice that since the set of eigenfunctions is uniquely determined,
for each v and w, there has to exist B(v,x) and B(w,x) such that fZ3 |λ,X (·;v,x) = fZ3 |λ̃,X (·;B(v,x),x) and fZ3 |λ,X (·;w,x) =
fZ3 |λ̃,X (·;B(w,x),x). But as shown above, if v = w, then fZ3 |λ,X (·;v,x) = fZ3 |λ,X (·;w,x) which immediately implies that
fZ3 |λ̃,X (·;B(v,x),x) = fZ3 |λ̃,X (·;B(w,x),x), and thus B(v,x) = B(w,x).

[17:29 14/6/2018 rdx052.tex]

RESTUD: The Review of Economic Studies

Page: 1847

1824–1851

1848

REVIEW OF ECONOMIC STUDIES
Downloaded from https://academic.oup.com/restud/article-abstract/85/3/1824/4105005 by WWZ Bibliothek (Oeffentliche Bibliothek der UniversitÃ¤t Basel) user on 05 December 2018

∂Br (v,x)/∂vs = 0 for all s = r. Hence, Br (v,x) only depends on vr . Next, it also holds by independence of UR+1+r and λ,
conditional on X, that
P(YR+1+r ≤ y | X = x,λ = v) = FUR+1+r |X (hR+1+r (y,xR+1+r )−vr ;x),
and therefore it has to hold that for some F̃Ut |X
FUR+1+r |X (hR+1+r (y,xR+1+r )−vr ;x) = F̃UR+1+r |X (h̃R+1+r (y,xR+1+r )−Br (vr ,x);x).
Then taking the ratio of the derivatives with respect to vr and y yields

(y,xR+1+r )
h̃R+1+r


hR+1+r
(y,xR+1+r )

= Br (vr ,x).

But since at ȳR+1+r (recall that xt = x̄t for t = R+2,...,2R+1), we get


h̃R+1+r
(ȳR+1+r , x̄R+1+r ) = hR+1+r
(ȳR+1+r , x̄R+1+r ) = 1,

it has to hold that Br (vr ,x) = vr +dr (x) for some functions dr (x). Moreover, for all r = 1,...,R it has
to hold that gR+1+r (xR+1+r ,vr ) = g̃R+1+r (xR+1+r ,vr +dr (x)), or alternatively h̃R+1+r (yR+1+r ,xR+1+r ) =
hR+1+r (yR+1+r ,xR+1+r )+dr (x), where yR+1+r ≡ gR+1+r (xR+1+r ,vr ). But since at ȳR+1+r we have
h̃R+1+r (ȳR+1+r , x̄R+1+r ) = hR+1+r (ȳR+1+r , x̄R+1+r ) = 0, it has to hold that dr (x) = 0. Therefore, only B(λ,x) = λ
is consistent with the model.31
Since none of the three non-unique features can occur due to the assumptions and structure of the model, L3,λ and
−1
D2,λ are identified. By the relation L3,λ
L1,3 = Lλ,1 it also holds that Lλ,1 is identified. The operator being identified is the
same as the kernel being identified. Hence, fY ,λ|X (y,v;x) is identified for all y ∈ RT , v ∈ , and x ∈ X̃ . Since λr has support
on R for all r = 1,...,R, gR+1+r is identified for all r =1,...,R because M [YR+1+r | λ = v,X = x] = gR+1+r (xR+1+r ,vr ) and
fY ,λ|X is identified. Similarly M [Yt | λ = v,X = x] = gt xt ,v Ft for all t < R+2. If R = 1, then gt is identified up to scale,
which is fixed by Assumption N3. If R > 1, taking ratios of derivatives with respect to different elements of λ identifies
Ftr
Fts for all r,s = 1,...,R. Hence, again gt is identified up to scale which is fixed. Therefore, gt and Ft are identified.
Finally suppose that fX (x) > 0 for all x ∈ X1 ×...×XT . Then the previous arguments imply that gt is identified for
all xt ∈ Xt and t < R+2. Next take any x ∈ X . Since Ft is identified and gt is identified for all xt ∈ Xt and t < R+2, the
arguments above imply that fY ,λ|X (y,v;x) is then identified for all y ∈ Y, v ∈  by switching the roles of (Y1 ,...,YR ) and
(YR+2 ,...,Y2R+2 ) in the proof. Consequently, gt and the distribution of (U,λ) | X = x are identified for all x ∈ X .

A.3. Proof of Theorem 2
t ,x̄t )
First fix x̄ ∈ X and ȳ on the support of Y | X = x̄ and define dt = ∂ht (ȳ
for all t. Next let F 3 = (FR+1 ··· F2R+1 ), F̄ =
∂y

(F 3 )−1 F, F̃t = F̄t /dt if t = 1,...,R+1 and F̃t = F̄t if t = R+2,...,2R+1. Let λ̄ = (λ (F 3 )−1 −b ) and λ̃r = λ̄r /dR+1+r for
 F̄ −c
t
t
r = 1,...,R, where b is chosen such that b F̄t +ct = ht (ȳt , x̄t ) for t = R+2,...,2R+1. Finally let h̃t (y,x) = ht (y,x)−b
dt

t
and Ũt = Utd−c
. Then we get h̃t (Yt ,Xt ) = λ̃ F̃t + Ũt , h̃t (ȳt , x̄t ) = 0 for all t = R+2,...,2R+1,
t

∂ h̃t (ȳt ,x̄t )
∂y

= 1 for all t = 1,...,T ,

F̃ 3 = IR×R ,

and M[Ũt | X, λ̃] = 0. By Theorem
 1, h̃t (·,xt ), F̃t and the distributionof Ũ, λ̃ | X = x are identified for all x ∈ X .
Thus, the distribution of C̃t = λ̃ F̃t and g̃t x̃t ,Qα1 [C̃t | X = x]+Qα2 [Ũt | X = x] are identified for each t, all x̃ ∈ Xt , and
x ∈ X . Finally, it holds that


g̃t x̃t ,Qα1 [C̃t | X = x]+Qα2 [Ũt | X = x]
 


= gt x̃t , Qα1 [C̃t | X = x]+Qα2 [Ũt | X = x] dt +b F̄t +ct
 


Qα1 [Ct | X = x]−b F̄t Qα2 [Ut | X = x]−ct
= gt x̃t ,
+
dt +b F̄t +ct
dt
dt


= gt x̃t ,Qα1 [Ct | X = x]+Qα2 [Ut | X = x] .

31. When R > 1, it can be shown that B(λ,x) = λ using only median independence and not full independence. Hence,
even without independence of Ut and λ, imposing a “normalization” of the form (fZ3 |λ (·;λ)) = λ is not without loss of
generality.

[17:29 14/6/2018 rdx052.tex]

RESTUD: The Review of Economic Studies

Page: 1848

1824–1851

JOACHIM FREYBERGER

NON-PARAMETRIC PANEL DATA MODELS

1849





Similarly, since P C̃t + Ũt < e | X = x = P Ct +Ut < edt +b F̄t +ct | X = x it follows that




g̃t (x̃t ,e)dFC̃t +Ũt |X (e;x) = g̃t (x̃t ,e)dFCt +Ut |X edt +b F̄t +ct ;x

=

=

Downloaded from https://academic.oup.com/restud/article-abstract/85/3/1824/4105005 by WWZ Bibliothek (Oeffentliche Bibliothek der UniversitÃ¤t Basel) user on 05 December 2018



 


e−b F̄t −ct
gt x̃t ,
dt +b F̄t +ct dFCt +Ut |X (e;x)
dt
gt (x̃t ,e)dFCt +Ut |X (e;x)

Analogous arguments yields g̃t (x̃t ,Qα [C̃t + Ũt | X = x]) = gt (x̃t ,Qα [Ct +Ut | X = x])
gt (x̃t ,Qα [Ct +Ut | X]) as well as identification of the unconditional quantities.

and

identification

of

Acknowledgments. This paper is a revised version of my job market paper. I am very grateful to Joel Horowitz as well
as Ivan Canay and Elie Tamer for their excellent advice, constant support, and many helpful comments and discussions.
I thank Stéphane Bonhomme and four anonymous referees for valuable suggestions, which helped to substantially
improve the paper. I have also received helpful comments from James Heckman, Matt Masten, Konrad Menzel, Jack
Porter, Diane Schanzenbach, Arek Szydlowski, Alex Torgovitsky, and seminar particatipants at various institutions. I
thank Jan Bietenbeck for sharing his data and STATA code and for many helpful discussions. Financial support from the
Robert Eisner Memorial Fellowship is gratefully acknowledged.
Supplementary Data
Supplementary data are available at Review of Economic Studies online.
REFERENCES
ACKERBERG, D., CHEN, X. and HAHN, J. (2012), “A Practical Asymptotic Variance Estimator for Two-Step
Semiparametric Estimators”, The Review of Economics and Statistics, 94, 481–498.
AHN, S., LEE, Y. and SCHMIDT, P. (2001), “GMM Estimation of Linear Panel Data Models with Time-varying Individual
Effects”, Journal of Econometrics, 101, 219–255.
—— (2013), “Panel Data Models with Multiple Time-varying Individual Effects”, Journal of Econometrics,
174, 1–14.
AI, C. and CHEN, X. (2003), “Efficient Estimation of Modelswith Conditional Moment Restrictions Containing Unknown
Functions”, Econometrica, 71, 1795–1843.
ALTONJI, J. and MATZKIN, R. (2005), “Cross Section and Panel Data Estimators for Nonseparable Models with
Endogenous Regressors”, Econometrica, 73, 1053–1102.
ANDREWS, D. (2005), “Cross-section Regression with Common Shocks”, Econometrica, 73, 1551–1585.
ARELLANO, M. and BONHOMME, S. (2012), “Identifying Distributional Characteristics in Random Coefficients Panel
Data Models”, Review of Economic Studies, 79, 987–1020.
BAI, J. (2003), “Factor Models of Large Dimensions”, Econometrica, 71, 135–171.
—— (2009), “Panel Data Models with Interactive Fixed Effects”, Econometrica, 77, 1229–1279.
—— (2013), “Fixed-Effects Dynamic Panel Models, A Factor Analytical Method”, Econometrica, 81, 285–314.
BAI, J. and NG, S. (2002), “Determining the Number of Factors in Approximate Factor Models”, Econometrica, 70,
191–221.
BESTER, A. and HANSEN, C. (2009), “Identification of Marginal Effects in a Nonparametric Correlated Random Effects
Model”, Journal of Business and Economic Statistics, 27, 235–250.
BIETENBECK, J. (2014), “Teaching Practices and Cognitive Skills”, Labour Economics, 20, 143–153.
Blundell, R. W., and J. L. Powell (2003), “Endogeneity in Nonparametric and Semiparametric Regression Models”, in
Dewatripont, M., Hansen, L. P. and Turnovsky, S. J., (eds), Advances in Economics and Econonometrics: Theory and
Applications, Eighth World Congress, vol. 2. (Cambridge, UK: Cambridge University Press).
BONHOMME, S. and ROBIN, J.-M. (2008), “Consistent Noisy Independent Component Analysis”, Journal of
Econometrics, 149, 12–25.
CARNEIRO, P., HANSEN, K. T. and HECKMAN, J. J. (2003), “Estimating Distributions of Treatment Effects with
an Application to the Returns to Schooling and Measurement of the Effects of Uncertainty on College Choice”,
International Economic Review, 44, 361–422.
CARROLL, R. J., CHEN, X. and HU, Y. (2010), “Identification and Estimation of Nonlinear Models using Two Samples
with Nonclassical Measurement Errors”, Journal of Nonparametric Statistics, 22, 379–399.
CHAMBERLAIN, G. (1992), “Efficiency Bounds for Semiparametric Regression”, Econometrica, 60, 567–596.
CHEN, X. (2007), “Large Sample Sieve Estimation of Semi-Nonparametric Models”, in Heckman, J. and Leamer,
E., (eds), Handbook of Econometrics, Vol. 6 of Handbook of Econometrics, chap. 76. (Amsterdam, North-Holland:
Elsevier) 5550–5623.
CHEN, X., TAMER, E. and TORGOVITSKY, A. (2011), “Sensitivity Analysis in Semiparametric Likelihood Models”
(Working paper).

[17:29 14/6/2018 rdx052.tex]

RESTUD: The Review of Economic Studies

Page: 1849

1824–1851

1850

REVIEW OF ECONOMIC STUDIES
Downloaded from https://academic.oup.com/restud/article-abstract/85/3/1824/4105005 by WWZ Bibliothek (Oeffentliche Bibliothek der UniversitÃ¤t Basel) user on 05 December 2018

CHERNOZHUKOV, V., FERNANDEZ-VAL, I., HAHN, J. and NEWEY, W. (2013), “Average and Quantile Effects in
Nonseparable Panel Models”, Econometrica, 81, 535–580.
CLOTFELTER, C. T., LADD, H. F. and VIGDOR, J. L. (2010), “Teacher Credentials and Student Achievement in High
School: A Cross-Subject Analysis with Student Fixed Effects”, Journal of Human Resources, 45, 655–681.
CUNHA, F. and HECKMAN, J. J. (2008), “Formulating, Identifying and Estimating the Technology of Cognitive and
Noncognitive Skill Formation”, Journal of Human Resources, 43, 738–782.
CUNHA, F., HECKMAN, J. J. and SCHENNACH, S. M. (2010), “Estimating the Technology of Cognitive and
Noncognitive Skill Formation”, Econometrica, 78, 883–931.
DEE, T. S. (2007), “Teachers and the Gender Gaps in Student Achievement”, Journal of Human Resources, 42, 528–554.
DELAIGLE, A., HALL, P. and MEISTER, A. (2008), “On Deconvolution with Repeated Measurements”, The Annals of
Statistics, 36, 665–685.
D’HAULTFOEUILLE, X. (2011), “On The Completeness Condition In Nonparametric Instrumental Problems”,
Econometric Theory, 27, 460–471.
EVDOKIMOV, K. (2010), “Identification and Estimation of a Nonparametric Panel Data Model with Unobserved
Heterogeneity” (Working paper).
EVDOKIMOV, K. and WHITE, H. (2012), “An Extension of a Lemma of Kotlarski”, Econometric Theory, 28, 925–932.
—— (2011), “Nonparametric Identification of a Nonlinear Panel Model with Application to Duration Analysis with
Multiple Spells” (Working paper).
FAMA, E. F. and FRENCH, K. R. (2008), “Dissecting Anomalies”, Journal of Finance, 63, 1653–1678.
FAN, J. (1991), “On the Optimal Rates of Convergence for Nonparametric Deconvolution Problems”, The Annals of
Statistics, 19, 1257–1272.
GALLANT, A. R. and NYCHKA, D. W. (1987), “Semi-nonparametric Maximum Likelihood Estimation”, Econometrica,
55, 363–390.
GRAHAM, B. and POWELL, J. (2012), “Identification and Estimation of Average Partial Effects in “Irregular” Correlated
Random Coefficient Panel Data Models”, Econometrica, 80, 2105–2152.
HECKMAN, J. J. and SCHEINKMAN, J. A. (1987), “The Importance of Bundling in a Gorman-Lancaster Model of
Earnings”, The Review of Economic Studies, 54, 243–255.
HECKMAN, J. J., STIXRUD, J. and URZUA, S. (2006), “The Effects of Cognitive and Noncognitive Abilities on Labor
Market Outcomes and Social Behavior”, Journal of Labor Economics, 24, 411–482.
Hidalgo-CABRILLANA, A. and LOPEZ-MAYANY, C. (2015), “Teaching Styles and Achievement: student and Teacher
Perspectives” (Working paper).
HODERLEIN, S. and WHITE, H. (2012), “Nonparametric Identification in Nonseparable Panel Data Models with
Generalized Fixed Effects”, Journal of Econometrics, 168, 300–314.
HOLTZ-EAKIN, D., NEWEY, W. and ROSEN, H. S. (1988), “Estimating Vector Autoregressions with Panel Data”,
Econometrica, 56, 1371–1395.
Hu, Y. (2008), “Identification and Estimation of Nonlinear Models with Misclassification Error using Instrumental
Variables: A General Solution”, Journal of Econometrics, 144, 27–61.
Y. Hu and SCHENNACH, S. M. (2008), “Instrumental Variable Treatment of Nonclassical Measurement Error Models”,
Econometrica, 76, 195–216.
HUANG, X. (2013), “Nonparametric Estimation in Large Panels with Cross Sectional Dependence”, Econometric
Reviews, 32, 754–777.
IMBENS, G. W. and NEWEY, W. K. (2009), “Identification and Estimation of Triangular Simultaneous Equations Models
Without Additivity”, Econometrica, 77, 1481–1512.
JUDD, K. (1998), Numerical Methods in Economics (Cambridge, Massachusetts, USA: The MIT Press).
LAVY, V. (2016), “What Makes an Effective Teacher? Quasi-Experimental Evidence”, CESifo Economic Studies, 62,
88–125.
MADANSKY, A. (1964), “Instrumental Variables in Factor Analysis”, Psychometrika, 29, 105–113.
MATZKIN, R. (2003), “Nonparametric Estimation of Nonadditive Random Functions”, Econometrica, 71, 1339–1375.
MOON, H. R. and WEIDNER, M. (2015), “Linear Regression for Panel with Unknown Number of Factors as Interactive
Fixed Effects”, Econometrica, 83, 1543–1579.
NEWEY, W. and POWELL, J. (2003), “Instrumental Variable Estimation of Nonparametric models”, Econometrica, 71,
1565–1578.
NEWEY, W. K. and McFADDEN, D. (1994), “Large Sample Estimation and Hypothesis Testing”, in Engle, R. F.
and McFadden, D., (eds), Handbook of Econometrics, vol. 4 of Handbook of Econometrics, chap. 36 (Amsterdam,
North-Holland: Elsevier) 2111–2245.
PESARAN, M. H. (2006), “Estimation and Inference in Large Heterogeneous Panels with a Multifactor Error Structure”,
Econometrica, 74, 967–1012.
SCHWERDT, G. and WUPPERMANN, A. C. (2011), “Is Traditional Teaching Really all that Bad? A Within-Student
Between-Subject Approach”, Economics of Education Review, 30, 365–379.
SHIU, J.-L. and HU, Y. (2013), “Identification and Estimation of Nonlinear Dynamic Panel Data Models with Unobserved
Covariates”, Journal of Econometrics, 175, 116–131.
SU, L. and JIN, S. (2012), “Sieve Estimation of Panel Data Models with Cross Section Dependence”, Journal of
Econometrics, 169(1), 34–47.
WAYNE, A. J. and YOUNGS, P. (2003), “Teacher Characteristics and Student Achievement Gains: A Review”, Review
of Educational Research, 73, 89–122.

[17:29 14/6/2018 rdx052.tex]

RESTUD: The Review of Economic Studies

Page: 1850

1824–1851

JOACHIM FREYBERGER

NON-PARAMETRIC PANEL DATA MODELS

1851
Downloaded from https://academic.oup.com/restud/article-abstract/85/3/1824/4105005 by WWZ Bibliothek (Oeffentliche Bibliothek der UniversitÃ¤t Basel) user on 05 December 2018

WILHELM, D. (2015), “Identification and Estimation of Nonparametric Panel Data Regressions with Measurement
Error” (Working paper).
WILLIAMS, B., HECKMAN, J. and SCHENNACH, S. (2010), “Nonparametric Factor Score Regression with an
Application to the Technology of Skill Formation” (Working paper).
ZEMELMAN, S., DANIELS, H. and HYDE, A. (2012), Best Practice: Bring Standards to Life in America’s Classrooms
(Portsmouth, New Hampshire, USA: Heinemann).

[17:29 14/6/2018 rdx052.tex]

RESTUD: The Review of Economic Studies

Page: 1851

1824–1851

