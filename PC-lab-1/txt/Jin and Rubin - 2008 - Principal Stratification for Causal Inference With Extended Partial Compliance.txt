This article was downloaded by: [Universitaetsbibliothek Freiburg]
On: 11 December 2012, At: 10:40
Publisher: Taylor & Francis
Informa Ltd Registered in England and Wales Registered Number: 1072954 Registered office: Mortimer
House, 37-41 Mortimer Street, London W1T 3JH, UK

Journal of the American Statistical Association
Publication details, including instructions for authors and subscription information:
http://www.tandfonline.com/loi/uasa20

Principal Stratification for Causal Inference With
Extended Partial Compliance
Hui Jin and Donald B. Rubin
Hui Jin is Institute Fellow, Institute for Quantitative Social Science (Email: , and Donald
B. Rubin is John L. Loeb Professor of Statistics, Department of Statistics , Harvard
University, Cambridge, MA 02138. We thank Bradley Efron for making the Efronâ€“Feldman
data available to us. This work was supported in part by NIH grant R01EY14314 and in
part by NIH grant R01HL62567.
Version of record first published: 01 Jan 2012.

To cite this article: Hui Jin and Donald B. Rubin (2008): Principal Stratification for Causal Inference With Extended Partial
Compliance, Journal of the American Statistical Association, 103:481, 101-111
To link to this article: http://dx.doi.org/10.1198/016214507000000347

PLEASE SCROLL DOWN FOR ARTICLE
Full terms and conditions of use: http://www.tandfonline.com/page/terms-and-conditions
This article may be used for research, teaching, and private study purposes. Any substantial or systematic
reproduction, redistribution, reselling, loan, sub-licensing, systematic supply, or distribution in any form to
anyone is expressly forbidden.
The publisher does not give any warranty express or implied or make any representation that the contents
will be complete or accurate or up to date. The accuracy of any instructions, formulae, and drug doses
should be independently verified with primary sources. The publisher shall not be liable for any loss, actions,
claims, proceedings, demand, or costs or damages whatsoever or howsoever caused arising directly or
indirectly in connection with or arising out of the use of this material.

Principal Stratification for Causal Inference With
Extended Partial Compliance
Hui J IN and Donald B. RUBIN
Many double-blind placebo-controlled randomized experiments with active drugs suffer from complications beyond simple noncompliance.
First, the compliance with assigned dose is often partial, with patients taking only part of the assigned dose, whether active or placebo.
Second, the blinding may be imperfect in the sense that there may be detectable positive or negative side effects of the active drug, and
consequently, simple compliance has to be extended to allow different compliances to active drug and placebo. Efron and Feldman presented
an analysis of such a situation and discussed inference for doseâ€“response from the nonrandomized data in the active treatment arm, which
stimulated active discussion, including on the role of the intention-to-treat principle in such studies. Here, we formulate the problem within
the principal stratification framework of Frangakis and Rubin, which adheres to the intention-to-treat principle, and we present a new
analysis of the Efronâ€“Feldman data within this framework. Moreover, we describe precise assumptions under which doseâ€“response can be
inferred from such nonrandomized data, which seem debatable in the setting of this example. Although this article only deals in detail with
the specific Efronâ€“Feldman data, the same framework can be applied to various circumstances in both natural science and social science.

Downloaded by [Universitaetsbibliothek Freiburg] at 10:40 11 December 2012

KEY WORDS: Causal inference; Missing data; Rubin Causal Model.

1. EFRONâ€“FELDMAN AND THE LRCâ€“CPPT DATA
Efron and Feldman (1991; hereafter EF) was among the
earliest statistical articles to address noncompliance in randomized experiments. It analyzed a subset of the data from
the Lipid Research Clinics Coronary Primary Prevention Trial
(LRCâ€“CPPT), which was a placebo-controlled dou1ble-blind
randomized clinical trial designed to study the effectiveness of
cholestyramine for lowering cholesterol levels. In the trial reported in EF, 164 men were randomized to the treatment group
and assigned active pills of the drug, whereas 171 men were
randomized to the control group and assigned placebo pills.
Each manâ€™s cholesterol level was measured before the trial and
at the end of the trial, which lasted for about 7 years; the outcome variable was his decrease in cholesterol level. The complication in this trial is that most of the patients in the experiment took only part of their assigned dose, which is typical
partial-compliance behavior. The only data available to us are
the treatment assignment, the proportion of the assigned drug
or placebo taken, and the observed cholesterol reduction.
Figure 1 displays the LRCâ€“CPPT data used in EF with EFâ€™s
regression curves of outcome on compliance, after the removal
of outliers. Figure 1(a) exhibits the association in the treatment
group between the observed outcome of cholesterol reduction
and the observed compliance to drug, defined as the proportion
of active drug taken, which both EF and we assume is measured without error. Figure 1(b) shows the association in the
control group between the observed outcome of cholesterol reduction and the observed compliance to placebo, defined as the
proportion of placebo taken. Considering that the drug is designed to reduce cholesterol, it is not surprising that there is an
apparent increasing trend in Figure 1(a): Better compliance to
drug is associated with larger reductions in cholesterol levels.
However, a similar but less dramatic association also exists in
Figure 1(b): Better compliance to placebo also seems to be associated with larger reductions in cholesterol levels. As noted
by EF, â€œ. . . compliance has a different meaning in the Treatment and Control groups. Compliance determines the amount

of active drug taken for Treatment group patients and also indicates something about the patientâ€™s psychological status. In
the Control group, only the psychological component of compliance applies.â€ Thus, compliance to drug and compliance to
placebo are both explanatory variables in the experiment, but
may have different roles to play.
In particular, how much of the greater cholesterol reduction
in the treatment group is caused by taking more drug, and how
should we formulate this intuitive question? In some intuitive
sense, in Figure 1, we would like to subtract the control panel
from the treatment panel. Consistent with EF (1991, pp. 9, 10),
we believe a correct way to formulate it is in terms of the â€œtrue
doseâ€“response relationshipâ€ that would have been observed if
dose had been randomly assigned and 100% compliance had
been enforced. We present two analyses, both different from
EFâ€™s analysis: The first regards both placebo compliance and
cholestyramine compliance in this study as characteristics of
patients and therefore does not address causal (i.e., true) doseâ€“
response; the second analysis explicitly imposes assumptions
in the form of a hypothetical doseâ€“response randomized trial,
which led to the observed data, and allows us to estimate the
true doseâ€“response curves.
By randomization, the distribution of unobserved drug compliance in the control group is, in expectation, the same as
the distribution of observed drug compliance in the treatment
group, and analogously for unobserved placebo compliance in
the treatment group. If the placebo were perfect in a sense formalized in Section 2.3, the observed treatment and control compliance distributions would differ only randomly.
Figure 2 shows the distribution of the drug and placebo compliances in the two random halves of the experiment. The histogram of compliance to drug differs from that of compliance to
placebo, with a greater proportion at the lower compliance levels for those assigned drug and a greater proportion at the higher
compliance levels for those assigned placebo. This difference is
possibly due to the adverse side effects of the drug, which include increased colonic gas, and may induce some people to
stop taking it. The difference is also revealed by the quantileâ€“
quantile plot in Figure 3.

Hui Jin is Institute Fellow, Institute for Quantitative Social Science (Email: jin@stat.harvard.edu), and Donald B. Rubin is John L. Loeb Professor
of Statistics, Department of Statistics (E-mail: rubin@stat.harvard.edu), Harvard University, Cambridge, MA 02138. We thank Bradley Efron for making
the Efronâ€“Feldman data available to us. This work was supported in part by
NIH grant R01EY14314 and in part by NIH grant R01HL62567.
101

Â© 2008 American Statistical Association
Journal of the American Statistical Association
March 2008, Vol. 103, No. 481, Applications and Case Studies
DOI 10.1198/016214507000000347

102

Journal of the American Statistical Association, March 2008
(a)

(b)

Downloaded by [Universitaetsbibliothek Freiburg] at 10:40 11 December 2012

Figure 1. LRCâ€“CPPT data. (a) Treatment group; (b) control group.

To handle this obvious violation of the â€œperfect blind assumptionâ€ (EF), which asserts that compliance to placebo is
identical, unit by unit, to compliance to drug, EF assumed a
monotonely increasing deterministic function relating the compliances in the two groups and, therefore, deterministically imputed â€œadjusted compliancesâ€ for the control group used in their
inferences. That is, the imputed drug compliance for each control group member is a deterministic function of his placebo
compliance. We believe that the EF assumption of a deterministic relation between drug and placebo compliances is overly
restrictive and can be replaced with weaker and more plausible
assumptions. Moreover, we estimate the true doseâ€“response relation under explicit additional assumptions, which we view as
necessary for a causal interpretation of the association between
dose and response.
2. THE PRINCIPAL STRATIFICATION FRAMEWORK
APPLIED TO EXTENDED PARTIAL COMPLIANCE
2.1 General Notation
The principal stratification framework in causal inference
was proposed in Frangakis and Rubin (2002), but its implicit
application for simple noncompliance phenomena in randomized experiments had received considerable attention previously (e.g., Angrist, Imbens, and Rubin 1996; Imbens and Rubin 1997; Frangakis, Rubin, and Zhou 2002; Greevy, Silber,
Cnaan, and Rosenbaum 2004). Specifically, because compliance was not controlled by the experimenter, we should not hypothesize what the outcomes would have been if compliance
(a)

(b)

Figure 2. Histograms of observed drug compliance and placebo
compliance in LRCâ€“CPPT. (a) Treatment group; (b) control group.

Figure 3. Qâ€“Q plot of observed drug compliance and placebo compliance in LRCâ€“CPPT.

had been enforced, as in a different experiment, without being explicit about this other hypothetical experiment. Therefore,
how a patient would comply under both treatment and control
in the actual experiment should, at least initially, be viewed as a
bivariate pretreatment covariate consisting of a pair of potential
compliances. Doing so, we can classify the patients into different principal strata according to this bivariate characteristic
and study the average causal effects in each principal stratum,
which collectively are called principal causal effects. In the simplest binary compliance case with only assignment to take or
not take a drug, we have four principal strata: compliers, nevertakers, always-takers, and defiers. The key idea with principal
stratification is that the strata are created based on the values of
one or more intermediate outcome variables, which are generally only partially observed. For example, compliance to drug
is only observed when the person is actually assigned to take
the drug. This approach forms the basis for our analyses.
To start, we use notation basically consistent with the applications in the previously mentioned articles. Let n be the
number of patients in the LRCâ€“CPPT experiment. Let Zi represent the treatment assignment for patient i, i = 1, 2, . . . , n:
Zi = T if patient i is assigned treatment, and Zi = C if patient i is assigned control. Then Yi (Zi = T ) is the potential
outcome giving the cholesterol reduction of patient i if assigned
treatment, and Yi (Zi = C) is the potential outcome giving the
cholesterol reduction if assigned control. The causal effect of
treatment assignment on cholesterol reduction for patient i is
Ei = Yi (T ) âˆ’ Yi (C), and the average causal effect across all the
n patients is E = Y (T ) âˆ’ Y (C). These are standard primitives
in the Rubin Causal Model (e.g., Holland 1986; Rubin 2005).
For some questions, it is helpful to think of these n patients as a
random sample from a much larger population of patients who
are not in this experiment, but in this article we focus on the n
patients in the experiment.
Let Di (Zi = T ) denote the level of active treatment received
by patient i if assigned treatment, and let Di (Zi = C) denote
the level of active treatment received by patient i if assigned
control, where the amount of drug taken is defined as the proportion of that assigned in accordance with Figure 1. Likewise,

Downloaded by [Universitaetsbibliothek Freiburg] at 10:40 11 December 2012

Jin and Rubin: Causal Inference With Extended Partial Compliance

103

let di (Zi = T ) denote the actual level of placebo received by
patient i if assigned treatment and let di (Zi = C) denote the
level of placebo received by patient i if assigned control.
The principal stratum patient i belongs to is the combination of potential compliance pairs Si = [Di (T ), Di (C),
di (T ), di (C)]. We define the principal causal effect in stratum
S as E s = AVEiâˆˆS [Yi (T ) âˆ’ Yi (C)], the average causal effect
in the 
principal stratum, where the number of patients in Si
is ni , i ni = n. In previous binary compliance applications,
Si = [Di (T ), Di (C), 0, 0] with Di (T ) and Di (C) taking values
of 1 or 0 only, thereby implying at most four principal strata.
For a specific example, Greevy et al. (2004) considered the case
with Si = [Di (T ), 0, 0, 0] and response directly proportional to
dose. We describe the new framework as handling â€œextended
partial complianceâ€ in the sense of extending [Di (T ), Di (C)]
to [Di (T ), Di (C), di (T ), di (C)] and allowing the four components to be â€œpartialâ€ in the sense of being between 0 and 1.
We illustrate the general structure of this framework with the
toy example in Table 1 with eight patients evenly randomized
into treatment and control, where Xi represents any pretreatment covariates, such as age and sex. The â€œâ€ denotes observed
data, and the â€œ?â€ denotes unobserved, or missing, data. For units
1â€“4 assigned to the treatment group, the potential compliances
and outcomes in the treatment arm, Di (T ), di (T ), and Yi (T ),
are observed, whereas the corresponding values in the control
arm, Di (C), di (C), and Yi (C), are missing. The exact opposite
is true for units 5â€“8 assigned to the control group.
2.2 Standard Assumptions
Two assumptions are standard in the setting we consider and
need no modification.
1. Stable unit treatment value assumption (SUTVA; Rubin 1980). For unit i assigned treatment, there is only one
possible value of [Yi (T ), Di (T ), di (T )], and analogously, for
unit i assigned control, there is only one possible value of
[Yi (C), Di (C), di (C)]. This assumption has implications, such
as that there is no interference between units (Cox 1958); that
is, one patientâ€™s treatment assignment will not affect another
patientâ€™s potential outcomes (e.g., whether patient 1 is assigned
drug or placebo does not affect patient 2â€™s potential cholesterol
reductions or compliance behaviors). Also, SUTVA asserts that
there are â€œno hidden versions of treatments.â€ SUTVA is widely
assumed in clinical research, and the representation of the potential outcomes in Table 1 would not be adequate without it.
Table 1. Principal stratification structure of extended
partial compliance
i

Xi

Zi

Di (T )

Di (C)

di (T )

di (C)

Yi (T )

Yi (C)

1
2
3
4
5
6
7
8










T
T
T
T
C
C
C
C





?
?
?
?

?
?
?
?









?
?
?
?

?
?
?
?









?
?
?
?

?
?
?
?





NOTE: â€œâ€ represents observed data; â€œ?â€ represents missing data.

2. Ignorable treatment assignment (Rubin 1978). Formally,
P (Z|Y (T ), Y (C), D(T ), D(C), d(T ), d(C), X) = P (Z|Yobs ,
Dobs , dobs , X), where Yobs , Dobs , and dobs represent the observed outcome and compliance values, respectively. This assumption basically states that the treatment assignment is a
known probabilistic function of observed values, which is true
in the randomized LRCâ€“CPPT experiment, because, by the
complete randomization of Z, P (Z|Y (T ), Y (C), D(T ), D(C),
d(T ), d(C), X) = P (Z). Under ignorability, we do not need to
model the assignment mechanism for Bayesian or likelihood
inference.
2.3 Assumptions With Extended Partial Compliance
Other assumptions are extensions of those made with simple
problems of noncompliance at the unit level.
1. Access monotonicity. In the expanded framework, we differentiate two levels of access monotonicity.
1.A. General access monotonicity. This assumption has two
parts: treatment access monotonicity, Di (T ) â‰¥ Di (C); and
placebo access monotonicity, di (T ) â‰¤ di (C). Treatment access
monotonicity means that for every patient, the amount of active drug he takes if assigned treatment will be greater than
or equal to the amount of active drug he takes if assigned
control, because he has more convenient access to drug under
treatment than he does under control. Analogously for placebo
access monotonicity: For each patient, the amount of placebo
he takes under control will be greater than or equal to the
amount of placebo he takes under treatment, because he has
more convenient access to placebo under control. Note that
in the binary compliance case, we only have treatment access
monotonicity because we only consider compliance to drug.
It is often safe to assume both access monotonicity assumptions.
1.B. Strong access monotonicity. This assumption also has
two parts: strong treatment access monotonicity, Di (C) = 0;
and strong placebo access monotonicity, di (T ) = 0. That is,
first, no member of the treatment group has access to placebo,
and, second, no member of the control group has access to drug.
In tightly controlled experiments, it is often reasonable to assume both of these.
2. Side-effect monotonicity. There are two versions of this
assumption: negative side-effect monotonicity, Di (T ) â‰¤ di (C);
and positive side-effect monotonicity, Di (T ) â‰¥ di (C). If the
drug has more negative side effects than the placebo, the
amount of drug patient i takes under treatment will be at most
the amount of placebo he takes under control, and vice versa
for positive side-effect monotonicity. Often, one or the other
of these assumptions will be reasonable, but certainly not always. In fact, in some cases the sample could be realistically
viewed as a mixture of two subgroups, one susceptible to positive side effects and the other susceptible to negative side effects.
3. Perfect blind. This assumption asserts Di (T ) = di (C);
that is, the amount of drug taken by a patient under treatment is exactly equal to the amount of placebo he takes under control, which requires the active drug to be perceived
identically as the placebo, with identical side effects for instance. Under this strong assumption, everyoneâ€™s principal

Downloaded by [Universitaetsbibliothek Freiburg] at 10:40 11 December 2012

104

stratum is known, because, for each person, either Di (T )
or di (C) is observed. Thus, under the perfect-blind assumption, the principal strata can be further simplified into Si =
Di (T ) = di (C), and we can directly group patients based
on their observed Di (T ) or di (C) and, thereby, directly estimate principal causal effects for each principal stratum. The
whole problem can then be reduced to a relatively simple
one with a fully observed covariate. However, the perfectblind assumption can be contradicted by the observed data,
as with the EF compliance data of displayed in Figures 2 and
3.
4. Equipercentile equating of compliances. This assumption
is a weakening of the perfect-blind assumption so that it cannot be contradicted by the observed data. It states that Di (T ) =
f [di (C)] = FDâˆ’1 {Fd [di (C)]}, where FD (Â·) and Fd (Â·) are the
cumulative distribution functions (CDFs) of D(T ) and d(C),
respectively. In practice, under this assumption, the â€œequating
functionâ€ f (Â·) is estimated by the relationship between the empirical CDFs of observed D(T ) and observed d(C) as illustrated in Figure 3. For the EF data, EF used fË†[di (C)], which
has essentially the identical observed distribution in the control
group as Di (T ) does in the treatment group. This transformation is known in the educational testing world as â€œequipercentile
test equatingâ€ (see the discussion in Rubin 1991). The analysis becomes straightforward again due to the resulting fully
observed principal strata. Nonetheless, this one-to-one mapping function f (Â·) denies the possibility that two patients who
take the same amount of placebo under control may take different amounts of drug under treatment, possibly because of
different tolerances to the drugâ€™s side effects. The side-effect
monotonicity assumptions allow for this possibility and are,
therefore, less restrictive than the equipercentile equating assumption.
2.4 Application of Assumptions to LRTâ€“CPPT Data
The EF analysis assumes SUTVA, ignorable treatment assignment, strong access monotonicity, and equipercentile equating of compliances. We agree that all of these are reasonable
for the EF data except for the equipercentile equating of compliances. We replace this assumption with negative side-effect
monotonicity because of the obvious negative side effects of the
drug. Of course, it is possible that some patients do not experience these negative side effects and may even realize positive
side effects from their reported cholesterol reductions after periodic blood tests, but the analyses presented here do not address
this possibility. Our first analysis estimates principal causal effects with principal strata defined by (Di , di ); our second analysis will add more assumptions and estimate true doseâ€“response
relationships between cholesterol reduction and dose of active
drug with principal strata defined only by di , the psychological compliance behavior, where we assume dose is randomly
assigned in a particular hypothetical experiment described in
Section 4.
More explicitly, our first analysis uses a Bayesian parametric
model to draw inferences for causal effects within each principal stratum defined by Si = [Di (T ), 0, 0, di (C)], or, more simply, Si = [Di (T ), di (C)] = [Di , di ]. As a result, we have the
structure for the LRCâ€“CPPT data presented in Table 2.

Journal of the American Statistical Association, March 2008

Table 2. Principal stratification structure of LRCâ€“CPPT data
i

Zi

Di (T )

Di (C)

di (T )

di (C)

Yi (T )

Yi (C)

1
2
..
.
nT
nT + 1
nT + 2
..
.
n

T
T




0
0

0
0

?
?




?
?

T
T
C
C



?
?

0
0
0
0

0
0
0
0

?
?





?
?

?
?



C
C

?
?

0
0

0
0




?
?




NOTE: â€œâ€ represents observed data; â€œ?â€ represents missing data.

3. MODEL, COMPUTATION, AND RESULTS BASED
ON PRINCIPAL STRATIFICATION ON (Di , di )
3.1 Bayesian Inference Framework
For Bayesian inference, the quantities for each patient in Table 2, Zi , Di , di , Yi (T ), and Yi (C), are regarded as a joint realization of random variables from the following general model:


f Z, (D, d), (Y (T ), Y (C)) = f (Z, S, Y ) = f (S, Y |Z)f (Z)
= f (S, Y )f (Z),
where Z is the n Ã— 1 vector indicating treatment assignment,
S = (D, d) is the n Ã— 2 matrix of principal strata, and Y =
(Y (T ), Y (C)) is the nÃ—2 matrix of potential outcomes. The last
equality follows from the randomization of Z, which enables us
to separate the â€œscience,â€ the joint distribution of (S, Y ), from
the treatment assignment mechanism f (Z). With essentially no
loss of generality (Rubin 1978), we can rewrite the joint distribution of (S, Y ) as
 
f (S, Y ) =
f (Si , Yi |Î¸ )p(Î¸ ) dÎ¸
i

=

 

f (Sobs,i , Smis,i , Yobs,i , Ymis,i |Î¸ )p(Î¸ ) dÎ¸,

i

where Î¸ is a generic parameter with prior distribution p(Î¸ ), and
(Zi , Sobs,i , Smis,i , Yobs,i , Ymis,i ) represents the data, both observed and missing for patient i, using standard self-explanatory
notation. The posterior distribution of Î¸ can be written as
p(Î¸ |Z, Sobs , Yobs )
âˆ p(Î¸ )
 
f (Sobs,i , Smis,i , Yobs,i , Ymis,i |Î¸ ) dYmis,i dSmis,i
Ã—
i

= p(Î¸ )

 

f (Sobs,i , Smis,i , Yobs,i |Î¸ ) dSmis,i .

(1)

i

Direct inference from (1) is computationally difficult in general, because of the integral over Smis,i . However, inference
from the following posterior joint distribution of (Î¸, Smis ),

p(Î¸, Smis |Z, Sobs , Yobs ) âˆ p(Î¸ )
f (Sobs,i , Smis,i , Yobs,i |Î¸ ),
i

(2)

Downloaded by [Universitaetsbibliothek Freiburg] at 10:40 11 December 2012

Jin and Rubin: Causal Inference With Extended Partial Compliance

105

is easier. The right side of (2) is proportional to the standard
posterior distribution of Î¸ with Smis,i observed in a randomized
experiment. It is typically easy to compute using (2) because
of the simplicity of the â€œcomplete-data likelihoodâ€ given the
Smis,i , as well as the availability of missing data algorithms such
as the expectationâ€“maximization (EM) algorithm (Dempster,
Laird, and Rubin 1977), data augmentation (Tanner and Wong
1987), and the Gibbs sampler (Geman and Geman 1984). For
example, in each iteration of the Gibbs sampler, we draw the parameter Î¸ given the missing principal strata components Smis ,
and then draw the missing Smis given Î¸ , and continue until the
process converges. This method of inference is relatively easy
because the two conditional posterior distributions are readily written once we specify
 the prior distribution p(Î¸ ) and the
complete-data likelihood i f (Sobs,i , Smis,i , Yobs,i |Î¸ ). Here we
define â€œcomplete dataâ€ as (Sobs , Smis , Yobs ) and exclude Ymis ,
because missing potential outcomes in each principal stratum
can be easily dealt with using standard complete-data tools.
3.2 Our Parametric Model
Our parametric model consists of one model for the distribution of the principal strata and one model for the conditional distribution of potential outcomes given the principal strata. Consistent with Figure 1, EF proposed a linear model for Y (C) as
a function of compliance and a quadratic model for Y (T ) as
a function of compliance, but, as mentioned earlier, they did
not employ the concept of principal strata and effectively set
Di = fË†(di ) in both models.
We first specify a Beta distribution for the psychological
component of compliance, that is, placebo compliance di :
di |Î¸ âˆ¼ Beta(Î±1 , Î±2 ),

(3)

and then consistent with negative side-effect monotonicity, we
specify another Beta distribution for relative drug compliance
Di /di given placebo compliance; specifically,
Di 
(4)
di , Î¸ âˆ¼ Beta(Î±3 , Î±4 ).
di
Consistent with EF, we assume a normal distribution for Yi (C)
given Si with mean linear in Di and di :
Yi (C)|Di , di , Î¸ âˆ¼ N(Î²0 + Î²1 Di + Î²2 di , ÏƒC2 ),

(5)

and a normal distribution for Y (T ) given Si with a quadratic
regression on Di and a linear regression on di :
Yi (T )|Di , di , Î¸ âˆ¼ N(Î³0 + Î³1 Di + Î³2 Di2 + Î³3 di , ÏƒT2 ).

(6)

For simplicity, we initially assume Yi (T ) and Yi (C) are independent given Si , because only one of them can be observed for each patient and the observed data have no information about their partial correlation. The partial correlation, Ï, between Yi (T ) and Yi (C) given Di , di , and Î¸ can be
viewed as a sensitivity parameter, as in Rubin (1990) and as
is done here in Section 3.4. The complete-data likelihood for
Î¸ = (Î±1 , Î±2 , Î±3 , Î±4 , Î²0 , Î²1 , Î²2 , Î³0 , Î³1 , Î³2 , Î³3 , ÏƒC , ÏƒT , Ï = 0) is

f (Sobs,i , Smis,i , Yobs,i |Î¸ )
i

=


i

(Î±1 + Î±2 ) Î±1 âˆ’1
(Î±3 + Î±4 )
di
(1 âˆ’ di )Î±2 âˆ’1
(Î±1 ) (Î±2 )
(Î±3 ) (Î±4 )

Ã—
Ã—

Di
di


Î±3 âˆ’1

1âˆ’

Î±4 âˆ’1

Di
di

1
di

1
âˆš
2Ï€ÏƒT
iâˆˆ{Z =T }
i

Ã— exp âˆ’
Ã—

(Yi (T ) âˆ’ Î³0 âˆ’ Î³1 Di âˆ’ Î³2 Di2 âˆ’ Î³3 di )2
2ÏƒT2



âˆš

iâˆˆ{Zi =C}

Ã— exp âˆ’

1
2Ï€ÏƒC

(Yi (C) âˆ’ Î²0 âˆ’ Î²1 Di âˆ’ Î²2 di )2
.
2ÏƒC2

We use a prior distribution on (Î±1 , Î±2 , Î±3 , Î±4 ), roughly analogous to that in Hirano, Imbens, Rubin, and Zhou (2000), which
specifies a prior distribution through hypothetical data points.
This corresponds to adding to the observed-data likelihood
function six extra observations of (D, d) selected in the following way: First, we construct a dataset of (D, d) values for all
the patients in the experiment according to EFâ€™s equipercentile
equating assumption; second,we select the 1st, 21st, 41st, 61st,
81st, and 100th percentiles in this dataset and add these six prior
data points [with complete (D, d) values, but missing all Y values] to the actual data; see Table 3 for the six data points to
be added to the EF data in Table 2. We believe this prior is
reasonable because it weakly pulls the posterior distribution of
(Î±1 , Î±2 , Î±3 , Î±4 ) toward the equipercentile equating assumption
displayed in Figure 3. After the addition of these six prior data
observations to the observed data, the prior distribution for the
parameters is a standard improper diffuse prior proportional to
(ÏƒC ÏƒT )âˆ’2 . The Appendix provides details of the computation.
3.3 Resultsâ€”Principal Causal Effects in Strata
Defined by (Di , di ) With Ï = 0
Figure 4 displays the posterior medians of all the principal causal effects, that is, the posterior median of E s for each
(D, d); the median at four specific values of (D, d) is displayed
at the bottom. Given any principal stratum (D, d) in the defined
triangular area D â‰¤ d of the horizontal plane, we plot in the vertical direction the posterior median of the corresponding principal causal effect of assignment to drug versus assignment to
placebo. The surface of these posterior medians for the principal causal effects is smooth, rising from its lowest point âˆ’13 at
principal stratum (0, 1) to its highest point 50 at principal stratum (1, 1). Thus, given the value of d, the type of compliance
under control, the estimated principal causal effect increases as
Table 3. Structure of prior data observations to be added to
data of Table 2
i
(1)
(2)
..
.
(6)

Zi

Di (T )

Di (C)

di (T )

di (C)

Yi (T )

Yi (C)

?
?




0
0

0
0




?
?

?
?

?
?




0
0

0
0




?
?

?
?

NOTE: â€œâ€ represents observed data; â€œ?â€ represents missing data.

Downloaded by [Universitaetsbibliothek Freiburg] at 10:40 11 December 2012

106

Journal of the American Statistical Association, March 2008

Figure 4. Posterior medians of principal causal effects with Ï = 0.

D increases, that is, as the strata represent men with better compliance under treatment. Numerically, the increase in the estimated causal effect is mainly due to the rapid increase in Y (T )
and the relatively stable increase in Y (C) as D increases with
fixed d. Table 4 displays the 2.5, 50.0, and 97.5 percentiles of
the posterior distribution of the principal causal effects for principal start with D and d values at zero, their respective first
quartile, medians, third quartile and one. The widest interval
is (âˆ’42, 27) at the principal stratum (0, 1), whereas the intervals become narrower as the principal strata move toward the
â€œmedian complierâ€ who has D = .70 and d = .89 in this experiment. The posterior median and 95% interval for the principal causal effect for the median complier are 24 and (17, 30),
which are comparable with those of the estimated intention-totreat effect of 25 and (20, 30). Given that the median cholesterol
reduction for good compliers in the treatment group is about 60,
and the median cholesterol reduction for good compliers in the
control group is about 10 (see the right ends of the two regression lines in Fig. 1), it is not surprising that the largest principal causal effect is 50 (39, 59) in the perfect-complier stratum
(1, 1).
The first column of Figure 5 assesses whether EFâ€™s deterministic equipercentile equating of d and D is a reasonable assumption within the context of our model with Ï = 0, wherein
each panel represents one draw of the principal strata. Each dot
represents the principal stratum Si = (Di , di ) for patient i in
this draw. If the dots were distributed closely around the solid
curve, then EFâ€™s equipercentile equating assumption would be

reasonable in the context of our more general negative sideeffect monotonicity assumption. However, this does not seem
to be the case. The second column of Figure 5 displays the corresponding distributions for Di /di . The first two columns reveal that, under our model, the perfect-blind assumption might
be true or close to being true for many patients, because Di /di
is concentrated near 1 in the histograms, and most points are on
or close to the 45â—¦ line in the scatterplots. However, under our
model, some patients appear to suffer from negative side effects
of the drug, and they would take less drug under treatment than
they would take placebo under control. The existence of these
two kinds of patients explains the quantileâ€“quantile plot of the
observed D and observed d in Figure 3.
The third and fourth columns of Figure 5 assess our model
with Ï = 0 by comparing the distribution of simulated missing D (and missing d) with that of the observed D (and observed d) in the same two posterior draws of principal strata.
As mentioned previously, the distribution of unobserved drug
compliance in the control group (missing D) is, in expectation,
the same as the distribution of observed drug compliance in the
treatment group (observed D) due to the randomization, and
analogously for the distribution of unobserved placebo compliance in the treatment group (missing d) and the distribution of
observed placebo compliance in the control group (observed d).
Therefore, the simulated missing D or missing d from an appropriate model should satisfy this expectation. The quantileâ€“
quantile plots support the propriety of our model in this regard.
3.4 Sensitivity Analysis to Ï
We now conduct a sensitivity analysis to Ï, the partial correlation between Yi (T ) and Yi (C) given the principal strata.
Because we never observe the two potential outcomes for any
patient, the data contain no information about Ï. When Ï is not
zero, we modify the distribution of Yi (T ) in (6) as follows:
Yi (T )|Yi (C), Di , di , Î¸
âˆ¼ N (Î³0 + Î³1 Di + Î³2 Di2 + Î³3 di )
+Ï


ÏƒT
Yi (C) âˆ’ Î²0 âˆ’ Î²1 Di âˆ’ Î²2 di , (1 âˆ’ Ï 2 )ÏƒT2 . (7)
ÏƒC

We let Ï be âˆ’.2, .2, .4, .6, .8, and .9, and reestimate the principal
causal effects. Table 5 reports the results for principal causal
effects in four representative strata. We see that different values
of Ï change the results only slightly.

Table 4. Posterior 2.5, 50.0, and 97.5 percentiles of representative principal causal effects with Ï = 0
d
0

D

1
.95
.7
.27
0

âˆ’6, 5, 16

.6

âˆ’5, 5, 15
âˆ’23, âˆ’4, 17

.89

.97

1

17, 24, 30
âˆ’19, 0, 21
âˆ’37, âˆ’9, 24

36, 45, 53
16, 24, 32
âˆ’23, âˆ’1, 23
âˆ’41, âˆ’10, 25

39, 50, 59
36, 45, 53
15, 24, 32
âˆ’24, âˆ’2, 23
âˆ’42, âˆ’13, 27

Downloaded by [Universitaetsbibliothek Freiburg] at 10:40 11 December 2012

Jin and Rubin: Causal Inference With Extended Partial Compliance

107

Figure 5. Two draws of principal strata (D, d) in the sample with Ï = 0.

4. ESTIMATION OF DOSEâ€“RESPONSE WITHIN
PRINCIPAL STRATA DEFINED BY di
4.1 General Formulation and Hypothetical Underlying
Randomized Experiment
To estimate doseâ€“response causal effects as if the doses were
assigned and enforced in a hypothetical randomized experiment, we have to make an additional critical assumption and
use a modified framework. Specifically, imagine that the EF
data arose from the following hypothetical experiment: First,
we measured diâˆ— , the psychological or baseline compliance to
placebo for each patient (e.g., as measured in a pilot study);
second, we randomly divided the patients into treatment and
control. Then, in the treatment group, we stochastically assigned dose ZDi â‰¤ diâˆ— according to a certain â€œruleâ€ that depended only on diâˆ— , where we enforced compliance to this assigned dose; in the control group, we assigned a full dose of
placebo and measured di . After the experiment was over, we
noticed that di = diâˆ— in the control group, and we were so
pleased with this finding that we made two mistakes: First, because di = diâˆ— in the control group, we discarded diâˆ— in both
Table 5. Posterior median and 95% interval of representative
principal causal effects for different values of Ï
(D, d)
Ï = âˆ’.2
Ï=0
Ï = .2
Ï = .4
Ï = .6
Ï = .8
Ï = .9

(1, 1)

(.68, .89)

(0, 1)

(0, 0)

49 (39, 59)
50 (39, 59)
50 (39, 59)
50 (40, 59)
51 (39, 62)
52 (38, 63)
51 (37, 66)

24 (18, 30)
24 (17, 30)
23 (16, 29)
23 (16, 29)
22 (15, 30)
22 (11, 33)
22 (6, 36 )

âˆ’10 (âˆ’40, 25)
âˆ’13 (âˆ’42, 27 )
âˆ’11 (âˆ’47, 27)
âˆ’6 (âˆ’43, 34)
âˆ’10 (âˆ’43, 30)
âˆ’8 (âˆ’62, 68)
âˆ’1 (âˆ’74, 79)

4 (âˆ’6, 14)
5 (âˆ’6, 16)
5 (âˆ’7, 18)
6 (âˆ’7, 20)
7 (âˆ’8, 23)
6 (âˆ’11, 28)
9 (âˆ’25, 41)

the control group and the treatment group; second, because we
had measured ZDi , we â€œforgotâ€ the exact stochastic rule for the
assignment of ZDi .
Accordingly, Table 2 is modified into Table 6 as follows:
First, we add a column for the fully missing diâˆ— . Second, the
columns involving Di (T ) and Di (C) are no longer present because D is no longer viewed as an outcome variable. Third,
we use ZDi to denote the assigned dose of active drug under
treatment, which can be T0 , . . . , TD , . . . , T1 , where TD âˆˆ [0, 1].
Fourth, because we still assume strong access monotonicity,
there is just one column of di that is relevant, that is, di (C).
Finally, there are now many Y columns, one for Yi (C) and one
for each Yi (TD ), where, for notational simplicity, we set {Yi } =
{Yi (T0 ), . . . , Yi (TD ), . . . , Yi (T1 ), Yi (C)} and {Y } = {{Yi }|i =
1, . . . , n}. See Table 6 for the results.
In this hypothetical experiment, the assignment of ZDi is no
longer ignorable, because the dosage assignment mechanism in
the treatment arm, P (ZDi |{Y }, diâˆ— ) = P (ZDi |diâˆ— ), depends explicitly on diâˆ— , which is missing; however, it would be ignorable
if diâˆ— were fully observed in the treatment arm. Therefore, the
dosage assignment mechanism can be called â€œlatently ignorableâ€ given diâˆ— (Frangakis and Rubin 1999). Consequently, we
accept a version of SUTVA appropriate to Table 6, strong access monotonicity, and a dose assignment mechanism that has
ZDi â‰¤ diâˆ— ; that is, the experimenter never attempts to enforce
a dose of the active drug that is larger than the self-selected
dose of placebo in the pilot study. However, we supplement
the ignorable treatment assignment assumption for the assignment of T versus C with a critical assumption in the treatment
group, the latent ignorable assignment of dose of active drug
ZD given d âˆ— ; furthermore, we assume that diâˆ— is equal to the
observed di in the control group, whereas both di and diâˆ— are
unobserved in the treatment group.

108

Journal of the American Statistical Association, March 2008

Table 6. Doseâ€“response structure of LRCâ€“CPPT data
i
1
Â·Â·Â·
Â·Â·Â·
Â·Â·Â·
nT
nT + 1
Â·Â·Â·
Â·Â·Â·
n

diâˆ—

Zi

ZDi

di (T )

di (C)

Yi (T0 )

Â·Â·Â·

Yi (TD )

Â·Â·Â·

Yi (T1 )

Yi (C)

?
?
?
?
?
?
?
?
?

T
T
T
T
T
C
C
C
C

T0
Â·Â·Â·
TD
Â·Â·Â·
T1
?
?
?
?

0
0
0
0
0
0
0
0
0

?
?
?
?
?






Â·Â·Â·
?
Â·Â·Â·
?
?
?
?
?

?
Â·Â·Â·
?
Â·Â·Â·
?
?
?
?
?

?
Â·Â·Â·

Â·Â·Â·
?
?
?
?
?

?
Â·Â·Â·
?
Â·Â·Â·
?
?
?
?
?

?
Â·Â·Â·
?
Â·Â·Â·

?
?
?
?

?
?
?
?
?





NOTE: â€œâ€ represents observed data; â€œ?â€ represents missing data.

Downloaded by [Universitaetsbibliothek Freiburg] at 10:40 11 December 2012

4.2 Doseâ€“Response With Principal Strata Defined by di
All the random variables in this case are Z, ZD , d, and {Y },
with joint distribution
f (Z, ZD , d, {Y }) = f (ZD , d, {Y })f (Z),
because of the randomized assignment of Z, and
f (ZD , d, {Y }) = f ({Y }|d)f (ZD |d)f (d)
due to the latent ignorable assignment of ZD given d. Thus,
given d, the analysis for doseâ€“response is a standard completedata Bayesian causal analysis (e.g., see Rubin 1978; or for more
details, see Rubin 2007).
Our specific model for the distribution of the baseline compliance di , f (di |Î¸ ), is the same as in (3). Our model for the
latent ignorable assignment mechanism of ZDi , f (ZDi |di , Î¸ ),
is analogous to (4):
ZDi 
(8)
 di , Î¸ âˆ¼ Beta(Î±3 , Î±4 ).
di
For the model specified by (3) and (8), we use the analogous
prior distribution as in Section 3.2, which includes the six extra
data points for the prior distribution of p(Î±1 , Î±2 , Î±3 , Î±4 ).
The joint distribution of the Y potential outcomes given principal strata, f (Yi (ZDi ), Yi (C)|di , Î¸ ), is specified in two parts.
First, (5) is modified to be
Yi (C)|di , Î¸ âˆ¼ N(Î²0 + Î²2 di , ÏƒC2 ),
where the distribution of Yi (C) is now only a function of di ,
because it cannot depend on ZDi , the randomly assigned treatment dose. Second, (6) [or more generally (7)] is modified to
be
Yi (ZDi )|Yi (C), di , Î¸
2
âˆ¼ N[Yi (C) + Î³1 ZDi + Î³2 ZDi
+ Î³3 di ZDi , ÏƒT2.C ],

(9)

where Î³1 â‰¥ 0, Î³2 â‰¥ 0, and Î³1 + Î³3 â‰¥ 0. The form of the regression (9) having intercept Yi (C) derives from the science
of doseâ€“response. First, when dose ZDi is zero, the outcome
Yi (ZDi ) is, as expected, the same as if assigned placebo, that is,
Yi (C); EF made a similar assumption in their equation (2.1), but
without the benefit of different variables ZDi and di . Second,
the constraints on Î³1 , Î³2 , and Î³3 are invoked because the doseâ€“
response curve, that is, the expectation of Y (ZDi ) âˆ’ Yi (C),
has to be monotonically increasing in ZDi for all values of
di âˆˆ [0, 1], and because, from Figure 1, we expect any quadratic

aspects in these curves to be increasing. The effect of being in
different principal strata defined by placebo compliance (i.e.,
di ) is to change the shape of the quadratic doseâ€“response.
This question of changing the doseâ€“response as a function of
placebo compliance cannot be addressed within the EF framework because ZDi is a deterministic function of di , so conditioning on di automatically conditions on Di and, thus, ZDi .
We assume, as before, the standard improper diffuse prior distribution for the parameters of the Y potential outcomes proportional to (ÏƒC ÏƒT .C )âˆ’2 .
Within each cohort of patients with the same baseline compliance d, we calculate the posterior distribution of the mean
of the individual responses, Ei = Yi (ZDi ) âˆ’ Y (C), for those
assigned dose ZDi , where ZDi â‰¤ d. Figure 6 displays the estimated true doseâ€“response relationship within four principal
strata: perfect placebo complier (di = 1.00), 75th percentile
placebo complier (di = .97), median placebo complier (di =
.89), and 25th percentile placebo complier (di = .60). Plotted
are the posterior medians (the thick curves) and the 95% intervals (the thin curves) of doseâ€“response. The dotted lines indicate the differing responses at dose .60. Notice that the poorer
placebo compliers appear to benefit more from the drug than do
the better placebo compliers, possibly because the better compliers are doing other things to lower their cholesterol in any
case, as seen in Figure 1(b). In fact, the plot suggests that the
25th percentile placebo compliers benefit almost twice as much
as the perfect compliers from an assigned dose of .60: an estimated 48-point causal reduction in the di = .60 group relative
to a 26-point causal reduction for the perfect placebo compliers.
5. DISCUSSION OF DOSEâ€“RESPONSE AND THE
ROLE OF COVARIATES
The methods and analyses of Sections 2 and 3 were based
on principal stratification on (D, d). That is, we treated both
compliance to drug and compliance to placebo as psychological
characteristics of patients and then estimated the expected effect of assignment to treatment versus assignment to control for
each type of person jointly defined by D and d. But it is difficult
to look at such results without thinking that the resulting dose,
D, causally affects response (cholesterol reduction relative to
placebo) for each type of person defined by their compliance
to placebo, d. That is, we should be able to encourage people
to move to higher levels of D compliance and, thereby, to shift
principal strata. To make this leap formally, however, required

Downloaded by [Universitaetsbibliothek Freiburg] at 10:40 11 December 2012

Jin and Rubin: Causal Inference With Extended Partial Compliance

109

(a)

(b)

(c)

(d)

Figure 6. Doseâ€“response. The thick curves are posterior medians of doseâ€“response at d = 1.00 (a), .97 (b), .89 (c), and .60 (d), where the
d values are the 100th, 75th, 50th, and 25th percentiles of compliance in the control group. The thin curves provide the corresponding 95%
posterior intervals. The dotted curves represent the median doseâ€“response for ZD = .60 at these d levels.

more structure, which was described in Section 4. In particular,
estimating true doseâ€“response required an assignment mechanism for dose, which we assumed was latent ignorable given
d. Under these assumptions, we estimated a quadratically increasing positive doseâ€“response curve for each type of placebo
complier, using a doseâ€“response model with scientific assumptions formalized. We find evidence that poorer placebo compliers benefited more from the same dose of drug, presumably
because they do not do other things to help reduce their cholesterol.
Despite these provocative doseâ€“response results, they are
causal only under a debatable assumption, namely, â€œnatureâ€™sâ€
latently ignorable assignment of ZD given d, that is, f (ZD |{Y },
d) = f (ZD |d). A more plausible assumption for this assignment mechanism would involve covariates, such as some true
pre-experimental measures of sensitivity to the side-effects of
the drug, which could play a key role in the patientsâ€™ compliance behavior to the drug. Letting X indicate such sideeffect covariate measurements, we believe f (ZD |{Y }, X, d) =
f (ZD |X, d) would be more plausible than our current assumption. In general, the role of covariates in randomized experiments with complications, such as noncompliance or missing
data, seems to be underappreciated.
If a covariate vector XÌƒi = [1, X1i , . . . , Xmi ]T were observed,
we could, for example, specify a model such as

T
T
di |XÌƒi , Î¸ âˆ¼ Beta eÎ±Ìƒ1 XÌƒi , eÎ±Ìƒ2 XÌƒi ,

ZDi 
T
T
XÌƒi , di , Î¸ âˆ¼ Beta eÎ±Ìƒ3 XÌƒi , eÎ±Ìƒ4 XÌƒi ,
di

Yi (C)|XÌƒi , di , Î¸ âˆ¼ N(Î²Ìƒ0T XÌƒi + Î²2 di , ÏƒC2 ),

T
T
2
Yi (ZDi )|XÌƒi , Yi (C), di , Î¸ âˆ¼ N Yi (C) + eÎ³Ìƒ1 XÌƒi ZDi + eÎ³Ìƒ2 XÌƒi ZDi


T
T
+ eÎ³Ìƒ3 XÌƒi âˆ’ eÎ³Ìƒ1 XÌƒi ZDi di , ÏƒT2.C ,
where Î±Ìƒ1 , Î±Ìƒ2 , Î±Ìƒ3 , Î±Ìƒ4 , Î²Ìƒ0 , Î³Ìƒ1 , Î³Ìƒ2 , and Î³Ìƒ3 are the corresponding
(m + 1)-dimensional column vectors of parameters. Obviously,
other specifications with covariates are also possible. The computation would be adjusted accordingly to incorporate these parameters and their prior distributions, but the basic methodology of Bayesian inference would remain the same. We could
also use this formulation to test the sensitivity of our doseâ€“
response results to an unmeasured covariate X, but this too is a
topic for future work.
APPENDIX: COMPUTATION
We apply Markov chain Monte Carlo (MCMC) to the first analysis
using the basic idea of the Gibbs sampler. Specifically, in each iteration, we carry out the following computations.
1. Given the parameter Î¸ and observed data, draw the missing data
di or Di .
(t)
For the control group members, we need to draw the missing Di
from the distribution
Di |Î¸, di , Yi (C)
Î± âˆ’1

âˆ Di 3

(di âˆ’ Di )Î±4 âˆ’1 exp âˆ’

(Yi (C) âˆ’ Î²0 âˆ’ Î²1 Di âˆ’ Î²2 di )2
.
2ÏƒC2
(t)

We use a Metropolisâ€“Hastings method to draw the new Di at
iteration t: First, draw Diâˆ— from the beta distribution Diâˆ— /di âˆ¼

110

Journal of the American Statistical Association, March 2008

4. Iterate until approximate convergence.

Beta(Î±3 , Î±4 ), and then accept it with probability
(Yi (C) âˆ’ Î²0 âˆ’ Î²1 Diâˆ— âˆ’ Î²2 di )2
pD = exp âˆ’
2ÏƒC2
(tâˆ’1)

+

(Yi (C) âˆ’ Î²0 âˆ’ Î²1 Di

âˆ’ Î²2 di )2

2ÏƒC2

,

(tâˆ’1)

is the value in the last iteration t âˆ’ 1.
where Di
For the treatment group members, we need to draw the missing di
from the following distribution:
Î± âˆ’Î±3 âˆ’Î±4

di |Î¸, Di , Yi (T ) âˆ di 1

Downloaded by [Universitaetsbibliothek Freiburg] at 10:40 11 December 2012

Ã— exp âˆ’

(1 âˆ’ di )Î±2 âˆ’1 (di âˆ’ Di )Î±4 âˆ’1

(Yi (T ) âˆ’ Î³0 âˆ’ Î³1 Di âˆ’ Î³2 Di2 âˆ’ Î³3 di )2
.
2ÏƒT2
1âˆ’d âˆ—

We draw diâˆ— from the beta distribution 1âˆ’Di âˆ¼ Beta(Î±2 , Î±4 ) and then
i
accept it with probability
pd =

diâˆ—

Î±1 âˆ’Î±3 âˆ’Î±4

(tâˆ’1)

di

Ã— exp âˆ’

(Yi (T ) âˆ’ Î³0 âˆ’ Î³1 Di âˆ’ Î³2 Di2 âˆ’ Î³3 diâˆ— )2
2ÏƒT2

(tâˆ’1) 2
)
(Yi (T ) âˆ’ Î³0 âˆ’ Î³1 Di âˆ’ Î³2 Di2 âˆ’ Î³3 di
.
+
2ÏƒT2

2. Given the Di , di , Yobs,i , and other parameters, draw the parameters Î±1 , Î±2 , Î±3 , and Î±4 .
The methods for Î±1 , Î±2 , Î±3 , and Î±4 are similar; therefore,
we only describe in detail how to draw Î±1 from the distribution
 (Î±1 +Î±2 ) Î±1 âˆ’1
. Because it is not a standard
Î±1 |Di , di , Yobs,i , Î±2 âˆ
(Î±1 ) di
distribution, we also use the Metropolisâ€“Hastings method with a truncated normal distribution centered at the value of the last draw as the
(tâˆ’1)
, 1), Î±1âˆ— > 0,
jumping distribution. First, draw Î±1âˆ— from Î±1âˆ— âˆ¼ N(Î±1
âˆ
(tâˆ’1)
) dx. Then calcuwith normalizing constant c1 = 0 Ï†(x âˆ’ Î±1
late the normalizing constant for the left-truncated normal distribution
N(Î±1âˆ— , 1) of â€œjumping backâ€: c1âˆ— = 0âˆ Ï†(x âˆ’ Î±1âˆ— ) dx. Second, accept
Î±1âˆ— with probability
(tâˆ’1)
) Î±1âˆ— âˆ’Î±1(tâˆ’1)
c  (Î±1âˆ— + Î±2 ) (Î±1
di
.
p1 = 1âˆ—
(tâˆ’1)
c1
(Î±1
+ Î±2 ) (Î±1âˆ— )

Similarly, we can draw new values of Î±2 and Î±3 with acceptance
rates
(tâˆ’1)
(tâˆ’1)
)
âˆ—
c  (Î±1 + Î±2âˆ— ) (Î±2
(1 âˆ’ di )Î±2 âˆ’Î±2 ,
p2 = 2âˆ—
(tâˆ’1)
âˆ—
c2
(Î±1 + Î±2
) (Î±2 )
(tâˆ’1)
âˆ—
(tâˆ’1)
) Di Î±3 âˆ’Î±3
c  (Î±3âˆ— + Î±4 ) (Î±3
p3 = 3âˆ—
,
(tâˆ’1)
c3
(Î±3
+ Î±4 ) (Î±3âˆ— ) di

and
(tâˆ’1)
âˆ—
(tâˆ’1)
)
Di Î±4 âˆ’Î±4
c4  (Î±3 + Î±4âˆ— ) (Î±4
1âˆ’
p4 = âˆ—
,
(tâˆ’1)
c4
di
(Î±3 + Î±4
) (Î±4âˆ— )

respectively.
3. Given the Di , di , Yobs,i , and other parameters, draw the parameters Î², Î³ , and Ïƒ .
This step comprises two standard Bayesian regressions (Gelman,
Carlin, Stern, and Rubin 2004); specifically, we draw samples of Î²,
ÏƒC , Î³ , and ÏƒT from the two Bayesian regression models in Section 3.2.

After convergence, continue the previous steps, drawing the missing
potential outcome Yi (T ) or Yi (C), and thereby drawing Ei = Yi (T ) âˆ’
Yi (C) for each patient, as well as any other estimands of interest.
For the sensitivity analysis to Ï, the only modification to the preceding computation is that we now can simulate Ymis,i given Di , di ,
Yobs,i , and a specific value of Ï; then we use both Yobs,i and Ymis,i in
the two Bayesian regressions which draw the parameters Î², Î³ , and Ïƒ .
We checked the computer program and the results in two ways.
First, to examine convergence, we ran parallel Markov chains with
different starting values, to ensure that they all converge to the same
posterior distribution. Second, to ensure there are no coding errors in
our program, we repeatedly drew Î¸ from a proper but diffuse prior
distribution, simulated datasets given each drawn parameter Î¸ , made
inferences with our program, and calculated the Bayesian posterior
quantiles for Î¸ . See Cook, Gelman, and Rubin (2006) for details of
the general method. The z scores were all insignificant, as expected
with a correctly written program.
The computation for the doseâ€“response is the same as before, except that we do not have missing ZD and the regression for Y (ZD )
and Y (C) is slightly different. We also checked the computer program
using the Bayesian posterior quantile method, which indicated that the
program was written correctly.
[Received August 2005. Revised December 2006.]

REFERENCES
Angrist, J. D., Imbens, G. W., and Rubin, D. B. (1996), â€œIdentification of Causal
Effects Using Instrumental Variablesâ€ (with discussion), Journal of the American Statistical Association, 91, 444â€“472.
Cook, S. R., Gelman, A., and Rubin, D. B. (2006), â€œValidation of Software
for Bayesian Models Using Posterior Quantiles,â€ Journal of Graphical and
Computational Statistics, 5, 675â€“692.
Cox, D. R. (1958), The Planning of Experiments, New York: Wiley.
Dempster, A. P., Laird, N. M., and Rubin, D. B. (1977), â€œMaximum Likelihood
From Incomplete Data via EM Algorithm,â€ Journal of the Royal Statistical
Society, Ser. B., 39, 1â€“38.
Efron, B., and Feldman, D. (1991), â€œCompliance as an Explanatory Variable in
Clinical Trials,â€ Journal of the American Statistical Association, 86, 9â€“17.
Frangakis, C. E., and Rubin, D. B. (1999), â€œAddressing Complications
of Intention-to-Treat Analysis in the Combined Presence of All-or-None
Treatment-Noncompliance and Subsequent Missing Outcomes,â€ Biometrika,
86, 365â€“379.
(2002), â€œPrincipal Stratification in Causal Inference,â€ Biometrics, 58,
20â€“29.
Frangakis, C. E., Rubin, D. B., and Zhou, X. H. (2002), â€œClustered Encouragement Designs With Individual Noncompliance: Bayesian Inference With
Randomization, and Application to Advance Directive Forms,â€ Biostatistics,
3, 147â€“164.
Gelman, A., Carlin, J. B., Stern, H. S., and Rubin, D. B. (2004), Bayesian Data
Analysis (2nd ed.), Boca Raton, FL: Chapman & Hall/CRC.
Geman, S., and Geman, D. (1984), â€œStochastic Relaxation, Gibbs Distributions, and the Bayesian Restoration of Images,â€ IEEE Transactions on Pattern
Analysis and Machine Intelligence, 6, 721â€“741.
Greevy, R., Silber, J. H., Cnaan, A., and Rosenbaum, P. R. (2004), â€œRandomization Inference With Imperfect Compliance in the ACE-Inhibitor After Anthracycline Randomized Trial,â€ Journal of the American Statistical Association,
99, 7â€“15.
Hirano, K., Imbens, G. W., Rubin, D. B., and Zhou, X.-H. (2000), â€œAssessing
the Effect of an Influenza Vaccine in an Encouragement Design,â€ Biostatistics, 1, 69â€“88.
Holland, P. (1986),â€œStatistics and Causal Inference,â€ Journal of the American
Statistical Association, 81, 945â€“970.
Imbens, G. W., and Rubin, D. B. (1997), â€œBayesian Inference for Causal Effects
in Randomized Experiments With Noncompliance,â€ The Annals of Statistics,
25, 305â€“327.
Rubin, D. B. (1978), â€œBayesian-Inference for Causal Effectsâ€”Role of Randomization,â€ The Annals of Statistics, 6, 34â€“58.
(1980), Comment on â€œRandomization Analysis of ExperimentalDataâ€”The Fisher Randomization Test,â€ by D. Basu, Journal of the American
Statistical Association, 75, 591â€“593.

Jin and Rubin: Causal Inference With Extended Partial Compliance

Downloaded by [Universitaetsbibliothek Freiburg] at 10:40 11 December 2012

(1990), â€œComment: Neyman (1923) and Causal Inference in Experiments and Observational Studies,â€ Statistical Science, 5, 472â€“480.
(1991), Comment on â€œDoseâ€“Response Estimands,â€ by B. Efron and D.
Feldman, Journal of the American Statistical Association, 86, 22â€“24.
(2005), â€œCausal Inference Using Potential Outcomes: Design, Modeling, Decisions,â€ Journal of the American Statistical Association, 100,
322â€“331.

111
(2007), â€œStatistical Inference for Causal Effects, With Emphasis on
Applications in Epidemiology and Medical Statistics,â€ in Handbook of Statistics: Epidemiology and Medical Statistics, eds. C. R. Rao, J. P Miller, and
D. R. Rao, The Netherlands: Elsevier, pp. 28â€“63.
Tanner, M. A., and Wong, W. H. (1987), â€œAn Application of Imputation to
an Estimation Problem in Grouped Lifetime Analysis,â€ Technometrics, 29,
23â€“32.

