Journal of the American Statistical Association

ISSN: 0162-1459 (Print) 1537-274X (Online) Journal homepage: https://www.tandfonline.com/loi/uasa20

Treatment Evaluation With Multiple Outcome
Periods Under Endogeneity and Attrition
Markus Frölich & Martin Huber
To cite this article: Markus Frölich & Martin Huber (2014) Treatment Evaluation With Multiple
Outcome Periods Under Endogeneity and Attrition, Journal of the American Statistical Association,
109:508, 1697-1711, DOI: 10.1080/01621459.2014.896804
To link to this article: https://doi.org/10.1080/01621459.2014.896804

View supplementary material

Accepted author version posted online: 07
Mar 2014.
Published online: 07 Mar 2014.
Submit your article to this journal

Article views: 485

View Crossmark data

Citing articles: 2 View citing articles

Full Terms & Conditions of access and use can be found at
https://www.tandfonline.com/action/journalInformation?journalCode=uasa20

Supplementary materials for this article are available online. Please go to www.tandfonline.com/r/JASA

Treatment Evaluation With Multiple Outcome Periods
Under Endogeneity and Attrition
Markus FRÖLICH and Martin HUBER
This article develops a nonparametric methodology for treatment evaluation with multiple outcome periods under treatment endogeneity
and missing outcomes. We use instrumental variables, pretreatment characteristics, and short-term (or intermediate) outcomes to identify
the average treatment effect on the outcomes of compliers (the subpopulation whose treatment reacts on the instrument) in multiple periods
based on inverse probability weighting. Treatment selection and attrition may depend on both observed characteristics and the unobservable
compliance type, which is possibly related to unobserved factors. We also provide a simulation study and apply our methods to the evaluation
of a policy intervention targeting college achievement, where we find that controlling for attrition considerably affects the effect estimates.
Supplementary materials for this article are available online.
KEY WORDS:

Panel data; Treatment effect; Weighting.

1. INTRODUCTION
We develop a nonparametric methodology for evaluating the
effect of an endogenous binary variable (referred to as treatment) in multiple outcome periods where some outcomes are
missing nonrandomly due to nonresponse and attrition (e.g.,
survey nonresponse or truncation by death). Our identification
strategy exploits an instrument (to control for treatment endogeneity), baseline covariates, and short-term (or intermediate)
posttreatment variables to tackle the dynamic nature of the attrition problem. This in principle allows us to estimate the treatment effects also in later periods where the attrition problem is
typically particularly severe.
The proposed methods appear important in the light of two
fundamental trends that are currently observed in applied research in social sciences: First, the increasing use of randomized experiments and second, a growing interest in medium
to long-term treatment effects of interventions, to see whether
effects are sustainable. Even randomized experiments, which
are frequently regarded as the gold standard for causal inference, are often plagued by imperfections such as noncompliance
with treatment assignment and outcome attrition due to loss to
follow-up. The noncompliance issue can be solved if it can be
plausibly assumed that random treatment assignment provides a
credible instrument for (endogenous) treatment take-up. While
this is common practice for the identification of complier average causal effects (CACE) (also known as local average treatment effects, LATE) in experiments—see Imbens and Angrist
(1994) and Angrist, Imbens, and Rubin (1996)—our approach
also tackles the attrition problem. The latter appears particularly
relevant when noting the increasing importance of long-term
evaluations of policy interventions as, for example, in the assessment of active labor market policies, for example, Lechner,

Markus Frölich is Professor of Econometrics, Universität Mannheim, L7, 35, IZA Bonn and ZEW, 68131 Mannheim (E-mail: froelich@uni-mannheim.de).
Martin Huber, Universität St.Gallen, 9000 St. Gallen, Switzerland (E-mail:
martin.huber@unisg.ch). The authors thank Michael Lechner, Blaise Melly,
Conny Wunsch, the editor and associate editor, and three anonymous referees
for their comments that improved the article. The first author acknowledges
financial support from the Research Center (SFB) 884 “Political Economy of
Reforms” Project B5, funded by the German Research Foundation (DFG). The
second author acknowledges financial support from the Swiss National Science
Foundation grant PBSGP1 138770.

Miquel, and Wunsch (2011), or of educational interventions, for
example, Angrist, Bettinger, and Kremer (2006).
To see the contribution of this article, it appears useful to
review previously suggested approaches to correct for attrition.
The very common missing at random (MAR) restriction assumes nonresponse or attrition to be conditionally ignorable
(i.e., independent of the potential outcomes) given observed
characteristics; see, for instance, Rubin (1976), Little and Rubin
(1987), Robins, Rotnitzky, and Zhao (1994), Robins, Rotnitzky,
and Zhao (1995), Carroll, Ruppert, and Stefanski (1995), Shah,
Laird, and Schoenfeld (1997), Fitzgerald, Gottschalk, and Moffitt (1998), and Abowd, Crepon, and Kramarz (2001). Frangakis
and Rubin (1999) suggested a relaxation of MAR in experiments which they called latent ignorability (LI). Nonresponse is
assumed to be ignorable conditional on observed characteristics
and the latent (compliance) type, characterizing how an individual’s treatment state reacts on some instrument. See Barnard
et al. (2003), Frangakis et al. (2004), and Mealli et al. (2004)
for related applications.
Approaches other than MAR and LI, permitting attrition to
be related to unobservables in a general way, are referred to
as nonignorable nonresponse models. The earlier work, for example, Heckman (1976), Hausman and Wise (1979), Bollinger
and David (2001), and Chen et al. (2000), focused on fully parameterized maximum likelihood estimation with identification
often achieved only via functional form restrictions; see Little
(1995) for an intuitive example. Instrumental variables for nonresponse and attrition offer an additional source of identification;
see DiNardo, McCrary, and Sanbonmatsu (2006) for an application in an experimental context. In particular, such models
allow for nonparametric identification and more flexible estimation, including the series regression approach of Das, Newey,
and Vella (2003) and inverse probability weighting based on
instruments for attrition as outlined in Huber (2012, 2013).
While the standard framework consists of just one follow-up
period, panel data sample selection models as suggested by
Kyriazidou (1997, 2001) can be used to consider multiple periods as in this article. In addition to dynamic attrition, Semykina

1697

© 2014 American Statistical Association
Journal of the American Statistical Association
December 2014, Vol. 109, No. 508, Theory and Methods
DOI: 10.1080/01621459.2014.896804

1698

and Wooldridge (2006) even allowed for endogenous regressors,
given that sufficiently many instruments to control for attrition
and endogeneity are available.
An alternative to the assumptions discussed so far are methods
that do not require a fully specified model for attrition, however,
at the cost of sacrificing point identification. For example, building on the partial identification literature (Robins 1989; Manski
1989, 1990), Zhang and Rubin (2003), Zhang, Rubin, and Mealli
(2008), Imai (2008), and Lee (2009), among others, bound treatment effects in the presence of nonresponse under comparably
mild restrictions. Another approach is multiple imputation of
missing values, which goes back to Rubin (1977, 1978). Based
on Bayesian techniques, multiple attrition models are used to
impute multiple sets of plausible values for the missing data to
obtain a probability interval for the parameter of interest. Finally, Rotnitzky, Robins, and Scharfstein (1998), Scharfstein,
Rotnitzky, and Robins (1999), and Xie and Qian (2012) (who
even allowed for nonmonotone nonresponse), among others,
proposed sensitivity checks for violations of MAR related to
unobservables by varying the nuisance term causing nonignorable attrition over a relevant range to examine the robustness
of the results. By not considering arguably implausible attrition
mechanisms, this approach likely yields more informative results than Manski-style bounds analysis and, therefore, provides
a middle ground between the latter and point identification.
In this article, we propose a new nonparametric approach
for point identification of the average causal effect on the
compliers (those who are responsive to the instrument). We
rely on pretreatment covariates and (endogenous) posttreatment
variables to control for attrition in a panel data framework
as well as a single instrument (e.g., random assignment in
an experiment) to tackle treatment endogeneity. (We only
require a single instrument, which is important because
instrumental variables are often hard to find in applications.)
Our method for the evaluation of binary treatments provides
three improvements compared to standard MAR. First, we do
not control for pretreatment covariates only. That would ignore
information about the intermediate variables, which presumably
are important predictors of nonresponse in many empirical
contexts. Second, we allow for treatment endogeneity which
has rarely been considered under MAR. Exceptions are Yau and
Little (2001) and Ding and Lehrer (2010), who, however, relied
on considerably stronger functional form assumptions and, in
the latter case, on a difference-in-difference strategy rather than
an instrument. Third, in our main identification theorem, we
develop a panel data extension of LI by permitting that attrition
does not only depend on observables but also on the latent
types.
It is also interesting to compare our framework to the literature on dynamic treatment regimes, for example, Robins,
Greenland, and Hu (1999), Murphy, van der Laan, and Robins
(2001), and Lok et al. (2004). If one were to consider attrition as
a dynamic treatment regime, those methods could be adjusted to
our situation. However, they are all based on a type of dynamic
ignorability condition, which would correspond to a MAR assumption in our context. In contrast, we also allow for selection
on the latent types and make use of an instrumental variable to
overcome the endogeneity problems.

Journal of the American Statistical Association, December 2014

Our framework is also more general than the original LI assumption of Frangakis and Rubin (1999). First, we permit twosided noncompliance (i.e., the existence of never takers, who
are never treated irrespective of the instrument, and of always
takers, who are always treated) and extend LI to conditional LI
given observables. Second, we consider multiple periods under
comparably weak assumptions, whereas the literature conventionally imposes more structure and assesses only one outcome
period; see, for instance, Peng, Little, and Raghunathan (2004).
Note, however, that the identification problem considered in this
article is distinct from nonignorable nonresponse and panel data
sample selection models. That is, we assume that conditional on
observed characteristics and the latent type, there are no further unobservables that are jointly related to attrition and the
potential outcomes. Therefore, we do not require any additional
instruments for nonresponse, which are typically hard to find in
applications; see the discussion in Fitzgerald, Gottschalk, and
Moffitt (1998). All in all, the methods proposed in this article
use less severe functional form and/or identifying assumptions
than many nonresponse models invoked in recent empirical applications; see the examples in Preisser et al. (2000), Mattei and
Mealli (2007), Shepherd, Redman, and Ankerst (2008), Zhang,
Rubin, and Mealli (2009), Frumento et al. (2012), and Wang
et al. (2012).
The remainder of this article is organized as follows. Section
2 introduces a treatment effect model with endogeneity and multiple outcome periods and shows nonparametric identification
under two distinct forms of attrition. For the ease of exposition,
only two outcome periods are considered in the main text. A
simulation study is provided in Section 3. Section 4 presents
an application to a policy intervention aiming to increase college achievement previously analyzed by Angrist, Lang, and
Oreopoulos (2009). Section 5 concludes. The (separate) online
appendix presents identification in the more general case with
several outcome periods along with the identification proofs,
discusses the implications of our identifying assumptions √
in a
parametric benchmark model, provides nonparametric and nconsistent estimators based on kernel regression along with the
proofs of their asymptotic properties, and includes an extended
range of simulation studies.
2. MODEL AND IDENTIFICATION
Suppose we are interested in estimating the treatment effect
of a binary variable D ∈ {0, 1} on an outcome Yt , where the
subscript t denotes the period (t = 1, 2, 3, . . .) after the start
of the treatment. All variables observed prior to the treatment
are indexed by period zero and are denoted as X0 . The potential outcomes Yt1 and Yt0 are the outcomes that would have
been realized if D had been set to 1 or 0, respectively, by external
intervention. (To avoid confusion between subscripts and super0
instead of Y10 when referring
scripts we sometimes write Yt=1
to a specific time period.) In our nonparametric identification
framework, two major issues have to be dealt with: endogenous
treatment selection and missing outcome data due to attrition
or nonresponse. The indicator variable Rt will denote whether
in time period t outcome data are observed (Rt = 1) or missing (Rt = 0). We assume that information on the treatment D

Frölich and Huber: Treatment Evaluation With Multiple Outcome Periods Under Endogeneity and Attrition

and baseline covariates X0 is available for all individuals, but
that individuals may not respond or drop out at follow-up data
collection. In most applications, nonresponse increases at later
follow-up periods.
2.1 Treatment Endogeneity Without Attrition
Consider first the case without missing data. Imbens and Angrist (1994) and Angrist, Imbens, and Rubin (1996) showed
that in the presence of an instrumental variable (denoted by Z)
satisfying particular assumptions, treatment effects are nonparametrically identified for a subset of the population, the so-called
compliers. Adhering to their terminology, let Diz denote the potential treatment status of some individual i if Zi were hypothetically set to z. For ease of exposition we will focus on a binary Z,
which often occurs in experiments, even though the framework
could be extended easily to nonbinary discrete instruments, see
for example Frölich (2007). The two binary potential treatment
states Di0 and Di1 partition the population into four different
types of individuals according to treatment behavior: the always takers (a) who are treated irrespective of the instrument
(Di1 = 1, Di0 = 1), the never takers (n) who are never treated
(Di1 = 0, Di0 = 0), the compliers (c) who only attend treatment
if the instrument takes the value one (Di1 = 1, Di0 = 0), and the
defiers (d) who only attend treatment if the instrument takes
the value zero (Di1 = 0, Di0 = 1 ). As shortcut notation we will
henceforth use Ti for “type” with Ti ∈ {a, n, c, d}. Note that the
type of any individual is only partially observed, that is, latent,
because the observed D and Z do not uniquely determine T , as
discussed in the Appendix.
Abadie (2003) showed the nonparametric identification of the
CACE (or LATE)



E Yt1 − Yt0 T = c ,
that is, the effect for the compliers, under conditions implying
conditional validity of the instrument given observed baseline
characteristics, which we denote by X0 :
⊥Z|X0
{Ytd , T }⊥
Pr(T = d|X0 ) = 0

for d ∈ {0, 1},
Pr(T = c|X0 ) > 0.

The first line assumes independence between the instrument and
the type and potential outcomes, conditional on X0 . (Note that
“ ⊥⊥” denotes statistical independence.) It thus assumes random
assignment of Z and an exclusion restriction with respect to the
potential outcomes for given values of the baseline covariates
X0 . The second line states that the treatment is (weakly) monotonic in the instrument conditional on X0 so that defiers are ruled
out and compliers do exist.
In the subsequent sections, we extend the CACE framework
to allow for missing values in the outcome variables Yt . (Here
we only consider average effects, but we could also identify
quantile treatment effects along the lines of Frölich and Melly
(2013).) We focus on the case of attrition (i.e., missingness
as an absorbing state), which is the most frequent concern in
empirical applications, particularly in impact evaluation. However, our approach does also permit intermittent missingness,
implying that intermediate outcomes are missing while later
ones are observed, but in this case does not exploit the information from later waves. With this respect, it is interesting to note

1699

that several contributions considering parametric missing data
models distinguish explicitly between attrition and intermittent
missingness; see, for instance, Xie and Qian (2012). In those
approaches, however, one either has to additionally model the
reentry process after nonresponse or specify attrition and intermittent missingness as two separate processes. Under additional
assumptions, also our nonparametric approach could use information from the reentrants to permit more precise estimates
(given that reentry occurs sufficiently often), but the identification expressions and estimators would become less tractable.
Since we aim at imposing as few restrictions as possible and
do not make use of additional instruments (other than for treatment), which are often not available in applications, we therefore
only model the nonresponse process and ignore any information
after the first nonresponse. Hence, we do permit that individuals
have missing data in only one or several waves and then reenter
the panel after periods of nonobservability, but we do not exploit
this information.
In the following, we denote by Xt the observed characteristics
for any t > 0, that is, after treatment. Note that Xt usually also
contains the outcome Yt . In contrast to X0 , these variables Xt
may possibly already be causally affected by the treatment, and
we refer to them as (endogenous) posttreatment characteristics.
(Note that whereas X0 is permitted to be endogenous in the sense
of Frölich (2008), i.e., that X0 may be correlated with baseline
unobservables, X0 is not permitted to be causally influenced
by treatment D, e.g., due to anticipation.) Furthermore, define
Xt = {X1 , . . . , Xt } to be the history of the characteristics up to
time t, where we do not include X0 here to make the distinction
between pretreatment and endogenous posttreatment variables
explicit. Accordingly, Xtd and Xdt denote the potential values
of the characteristics and of their history, respectively, at time
t, if the treatment had been set to d by external intervention.
Furthermore, let Rt be the response indicator in period t. That
is, Xt and Yt are only observed if Rt = 1. Our setup permits
that R1 is zero for some individuals, such that outcome data are
completely missing for those subjects. The history of response
indicators over the posttreatment periods up to t is denoted by
Rt = {R1 , . . . , Rt }. The potential values of response and the
response history are denoted by Rtd and Rdt , respectively.
The occurrence of attrition and nonresponse may have many
reasons. In the simplest and least realistic case, it is only triggered by random events happening after treatment, such that
outcomes are missing completely at random (MCAR), see, for
example, Rubin (1976) and Heitjan and Basu (1996). However,
it is more likely that attrition depends also on observed and/or
unobserved characteristics of the individuals. In particular, attrition may depend on Yt−1 , which is an endogenous variable
that has been causally affected by the treatment. In addition, attrition could also be directly causally affected by the treatment
itself, for example, due to side effects or adverse events of a
drug treatment in a medical intervention. Finally, attrition could
also be caused directly by the instrumental variable Z.
Our identification strategy requires us to restrict the missing
data process in two ways: First, we assume that nonresponse in
time t is not simultaneously related to the outcome variable in
time t. This implies that while any variables measured in the
past may trigger nonresponse today, current and future values
of the outcome variable are not permitted to do so. Nonresponse

1700

Journal of the American Statistical Association, December 2014

is thus considered to be predetermined. Second, we need to
impose some restrictions on the relationship between the instrument and nonresponse. In the following two sections, we
will discuss two different identification assumptions. The first
approach permits nonresponse to depend on unobservables, but
requires it to be ignorable given the observed characteristics
andthe latent types (conditional LI). The second approach assumes that nonresponse is missing at random (MAR) given the
observed pre- and posttreatment characteristics. While the first
setup appears to be more general in most applications than the
second one, they are not strictly nested. That is, while the first
approach is less restrictive with respect to the nonresponse process, the second one imposes weaker (albeit only mildly weaker)
assumptions on the instrument.
Our analysis covers four cases. First, it includes randomized
experiments with full compliance. Then, the exclusion restriction is valid with X0 being the empty set (i.e., not controlling
for any covariates) and using D as its own instrument, that is,
defining Zi ≡ Di . Second, under random assignment but imperfect compliance, we may use the randomization Z as an
instrumental variable for the actual treatment receipt D. If the
randomization probability is the same for everyone, X0 may
again be the empty set. Third, the framework also includes observational studies, where the instrumental variable assumption
is often plausible only after conditioning on some variables
X0 ; see Abadie (2003), Tan (2006), and Frölich (2007). Finally,
when controlling for some X0 and using D as its own instrument,
that is, defining Zi ≡ Di , we impose what is referred to in the
literature as the selection on observables, unconfoundedness,
ignorable assignment, or conditional independence assumption;
see, for instance, Rosenbaum and Rubin (1983), Lechner (1999),
and Imbens (2004). Hence, although we focus on instrumentbased identification, our identification results are also directly
applicable to the selection on observables framework with missing outcome data.
2.2 Nonresponse Under Conditional Latent Ignorability
This section presents the identifying assumptions for the case
of conditional latent ignorability. We permit that the response
process at time Rt is related to all observed variables in the past
and that it is a function of the latent type T . Hence, the response process is supposed to be predetermined, which means
that past values of the outcomes and further observed characteristics may affect the response behavior today. However,
conditional on these past values, the instrument and conditional
on the latent type, current and future outcomes must be independent of nonresponse in period t. This is, for instance, different
to Xie and Qian (2012), who permitted response and contemporaneous outcomes to be related and propose various sensitivity
checks. Assumption 1 formalizes predetermined nonresponse
under conditional LI. As already mentioned, Xt−1 may contain both intermediate outcomes Yt−1 as well as other observed
characteristics.
Assumption 1. Predetermined nonresponse
Yt+s ⊥⊥Rt |X0 , Xt−1 , Rt−1 , Z, T ,

for s ≥ 0.

(1)

The plausibility of predetermined nonresponse (not related to
contemporaneous outcomes) needs to be judged in the light of
the application at hand. Some statistical support that this may

be an empirically relevant case comes from Hirano et al. (2001),
who provided conditions implied by nonresponse related to
(i) past information and (ii) contemporaneous outcomes that
can be tested if a refreshment sample is available. Applying
their test to a Dutch household survey, they rejected attrition
related to contemporaneous outcomes, but did not reject predetermined nonresponse at any conventional level. Our assumption
may for instance appear plausible in the context of educational
outcomes, where Yt denotes a measure of cognitive skills (e.g.,
test scores or grades) at the end of some academic year t and Rt
is an indicator for (not) having dropped out of school. Predetermined nonresponse is (closely) satisfied if individuals decide to
remain in or leave education (mainly) based on their academic
performance in the previous academic year, Yt−1 , so that the
drop-out decision Rt is taken shortly after that, for example,
during or at the end of summer vacation.
In addition to Assumption 1, we invoke exclusion, monotonicity, and common support restrictions, as stated in Assumptions
2 and 3. The latter are similar to Abadie (2003), apart from that
we have to strengthen the instrumental exclusion restriction for
the always and never takers.
Assumption 2. Exclusion restriction: For d ∈ {0, 1}
(Yt , Xt−1 , Rt−1 )⊥⊥Z|X0 , T ∈ {a, n}
Ytd ⊥⊥Z|X0 , T = c
T ⊥⊥Z|X0 .
Assumption 2 requires that conditional on the observed baseline characteristics, the instrumental variable Z affects neither
the histories of characteristics (possibly including intermediate
potential outcomes) nor of responses of the always and never
takers up to one period prior to the outcome period considered.
In the two outcome periods case for instance, only X1 , R1 are
restricted in this way, but not R2 . Furthermore, note that for
the always takers, the exclusion restriction only refers to the
potential outcome under treatment, because (Yt ,Xt−1 ,Rt−1 ) =
(Yt1 ,X1t−1 ,R1t−1 ) for T = a, while (Yt0 ,X0t−1 ,R0t−1 ) is not restricted. An analogous statement holds for the never takers.
Assuming that Z does not affect the response behavior of always and never takers may appear reasonable in double-blind
randomized medical trials, where individuals are not even aware
of their treatment assignment. In nonblinded trials, this assumption seems generally less innocuous. Consider, for example, a
nonblinded randomized drug-trial, where a never taker does not
take the new drug irrespective of being assigned to treatment
or control. Under assignment to treatment she actively decides
to not comply with the protocol, whereas she would comply
when being assigned to the control group. It is conceivable that
the decision to not comply might affect response behavior. In
other cases it may, however, be less of a problem. For example,
assume the randomization of a school voucher (for tuition fees)
where the outcome of interest is some test score in the final grade
and nonresponse is characterized by dropping out from school.
Here, it appears more reasonable that mere voucher assignment
does not affect the drop out decision of never takers, who would
not use the school voucher anyway.
The stronger exclusion restriction is only required for the always and never takers, not for the compliers. Concerning the
latter, only the standard exclusion restriction Ytd ⊥⊥Z|X0 , T =
c is imposed (see second line of Assumption 2) such that

Frölich and Huber: Treatment Evaluation With Multiple Outcome Periods Under Endogeneity and Attrition

nonresponse may be arbitrarily related to and thus, affected by
the instrument. This may happen either directly, for example,
when Z is treatment assignment and the notification of having
been assigned to the treatment or control group itself changes
the response behavior, or indirectly via treatment choice, for
example, due to the side effects or adverse events of a drug
treatment which influences attrition.
Assumption 3. Monotonicity and support restrictions
Existence of compliers: Pr(T = c) > 0
Monotonicity:
Pr(T = d) = 0
Common support:
0 < Pr(Z = 1|X0 ) < 1.
Assumption 3 invokes weak monotonicity, that is, the existence of compliers and the nonexistence of defiers (or vice
versa). For nonparametric identification, common support in the
baseline characteristics X0 across the populations receiving and
not receiving the instrument must also hold. This is, for example, satisfied in randomized experiments, where Pr(Z = 1|X0 )
is often a constant.
Theorem 1 shows the identification of the mean potential
outcomes of the compliers. For ease of exposition, only two
outcome periods are considered here, that is, t ∈ {1, 2}, while
the general result for more than two periods is provided in
the online appendix given in the supplementary material. For
a concise exposition of the results, we define the following
conditional probabilities:
π
Pt
Pt
t
t,Z=z

=
=
=
=
=

Pr (Z = 1|X0 )
Pr(Z = 1|X0 , Xt , Rt = 1, D = 1)
Pr(Z = 1|X0 , Xt , Rt+1 = 1, D = 1)
Pr(Rt+1 = 1|X0 , Xt , Rt = 1, D = 1)
Pr(Rt+1 = 1|X0 , Xt , Rt = 1, D = 1, Z = z).

Identification is based on a weighting representation in which
four conditional probabilities enter multiplicatively: The probability that Z takes the value one, conditional on three different
sets of regressors, and a time-varying conditional response probability. For identification, t has to be larger than zero, that is,
for each value of the covariates (X0 ,Xt ), the probability of attrition must not be one. Then, the treatment effect on the compliers
is identified as E[Yt1 |T = c] − E[Yt0 |T = c].
The intuition underlying Theorem 1 is as follows. By the
independence of Z and T given X0 stated in Assumption 2,
the proportions of compliers, always takers, and never takers
in groups defined by D and Z are identified. By Assumption
1, the first period potential outcomes are independent of first
period response conditional on X0 , Z, and T , and in the second
period, independence of Y2 and R2 holds by additionally conditioning on X1 and R1 . Together with the exclusion restrictions
on the compliers’ potential outcomes as well as the potential
outcomes and preperiod responses (only relevant for the second
period) of always and never takers postulated in Assumption
2, this ultimately allows isolating the mean potential outcomes
of compliers in the mixed groups with (Z = 1, D = 1) and
(Z = 0, D = 0), so that the CACE is identified. Finally, it is
worth noting that if there was no attrition, the CACE based on
the expressions in Theorem 1 would simplify to equation (11)
in Frölich (2007), which provides a representation of the CACE

1701

based on inverse probability weighting in the absence of the
missing outcomes problem.
Theorem 1. Under Assumptions 1, 2, and 3, the potential
outcomes in periods t ∈ {1, 2} are identified as



 1
|T = c =
E Yt=1

Z−π
E Yt=1 Rt=1 D
π 1−π

E

 D Z−π 


 1
|T = c
E Yt=1

Z−π 1 P0 −π
E Yt=2 Rt=1 Rt=2 D
π 1−π E0 E1 P0 −π
 Z−π 
=
E D
π 1−π

1
E0

PO

P0 −π

.

π 1−π

P1 −π

P1 −π


.

(2)

An equivalent expression for E[Yt0 |T = c] is obtained by replacing D with 1 − D and D = 1 with D = 0 everywhere.
2.3 Nonresponse Under the Missing
at Random Assumption
In this section we consider an alternative identification approach, where the response process is assumed to be ignorable
conditional on observed characteristics, which corresponds to a
type of MAR assumption. That is, we no longer permit that the
unobserved type T is related to response behavior. This implies
that only unobservables that are not related to the potential outcomes are allowed to affect attrition. Again, past values of Y may
trigger nonresponse in the current period, but neither present nor
future values of Y. As stated in Assumption 1’, response behavior might depend on all past values of X, which itself could be
endogenous, that is, causally affected by the treatment.
Assumption 1’. Predetermined nonresponse
Yt+s ⊥⊥Rt |X0 , Xt−1 , Rt−1 , Z, D

for s ≥ 0.

(3)

The key difference between Assumption 1’ and Assumption
1 is that the latter permits the response behavior to depend on
the latent type T , while the former does not. Still, Assumption
1’ allows response to be a function of the received treatment,
which is a relevant scenario for example, if the treatment leads
to dissatisfaction and reduces the willingness to provide outcome data. On the other hand, one can think of many frameworks where it is not the treatment receipt alone that determines
response behavior but rather the unobserved type T of an individual, as permitted in Assumption 1. Consider, for example,
an educational intervention as analyzed in Angrist, Lang, and
Oreopoulos (2009) where college students are randomly provided with services and/or financial incentives to obtain better
grades. In this context, never takers who do not comply when
offered a treatment might have a higher probability to drop
out due to a lower commitment to this particular college or to
higher education in general. Assumption 1’ therefore appears
to be more restrictive than Assumption 1 in many empirical
applications.
On the other hand, since we need no longer condition on the
latent type, the restrictions on the instrument can be relaxed
somewhat. The following Assumption 2’ is thus a little weaker
than Assumption 2 because exclusion restrictions of the instrument on the response behavior do not have to be imposed for any
type. This may be of practical relevance in randomized trials for

1702

Journal of the American Statistical Association, December 2014

example if those always takers who were not randomized into
the treatment (Z = 0) are less inclined to respond than those
with Z = 1 due to their discontent about having to organize
the treatment receipt through alternative means. In this case,
Assumption 2 is violated while Assumption 2’ may still hold.
Assumption 2’. Exclusion restriction: For d ∈ {0, 1}
(Ytd , T )⊥⊥Z|X0 .

Theorem 2 gives the identification results for the compliers under MAR for the case of two outcome periods, while
the general result for more outcome periods is provided in the
Appendix.
Theorem 2. Under Assumptions 1’, 2’, and 3, the potential
outcomes in periods t ∈ {1, 2} are identified as

 E
 1
|T = c =
E Yt=1

Yt=1 Rt=1 DZ Yt=1 Rt=1 D(1−Z)
πE0 ,z=1
(1−π)0 ,z=0

∼ uniform(0, 1),
Z = I {0.25X0 + W > 0},
= I {αZ − 0.25X0 + U0 > 0.5},
= 0.5X0 + 0.5D + κDU0 + U1 ,
= 0.5Y1 + 0.5Q,
= I {0.25X0 + 0.25D + βZ
+ γ I {0.5 − α < U0 − 0.25X0 ≤ 0.5} + δY1 + V > 0},
Y2 = 0.5X0 + X1 + D + κDU0 + U2 ,
R2 = R1 I {0.25X0 + 0.25X1 + 0.25D + βZ
+ γ I {0.5 − α < U0 − 0.25X0 ≤ 0.5} − δY2 + > 0},
each of Q, V , W, ∼ N (0, 1), independent of each other,
⎛ ⎞
⎛ ⎞
U0
0
⎜ ⎟
⎜ ⎟
and ⎝ U1 ⎠ ∼ N (μ, σ ), where μ = ⎝ 0 ⎠
0
U2
⎞
⎛
1 0.5 0.5
⎟
⎜
and σ = ⎝ 0.5 1 0.5 ⎠ .

X0
D
Y1
X1
R1

0.5



 D Z−π 

E π 1−π

 1
E Yt=2 |T = c


Yt=2 Rt=1 Rt=2 DZ Yt=2 Rt=1 Rt=2 D(1−Z)
E π
0 ,z=11 ,Z=1 (1−π)0 ,Z=01 ,Z=0
 Z−π 
=
.
E D
π 1−π

be controlled for based on our identification results:

(4)

The expression for E[Yt0 |T = c] is obtained by replacing D
with 1 − D and D = 1 with D = 0 everywhere.
Note that the assumptions underlying Theorems 1 and 2 are
partly testable. Consider first the case that attrition is zero in
some outcome period (e.g., zero attrition in the first follow-up
period). Our setup then collapses to the standard LATE assumptions, for which tests have been proposed by Huber and Mellace
(2013) and Kitagawa (2013). Similar tests could be derived
for the case with attrition. By straightforward modifications of
Theorems 1 and 2 the distribution functions of the potential
outcomes among compliers are identified and, therefore, also
the density functions. As in Kitagawa (2013), a testable implication is that the estimated potential outcome densities of
compliers must not be significantly negative at any point in the
outcome support, because this would indicate the failure of our
identifying assumptions. As a further possibility to validate the
MAR assumptions underlying Theorem 2, one may consider
the approach of Hirano et al. (2001) for testing MAR models
in the presence of a refreshment sample. We leave the detailed
derivations and analyses of such tests for future research.
3. FINITE SAMPLE PROPERTIES
To illustrate the behavior of the proposed estimators in finite
samples we examine a small simulation study in this section.
We consider the following data-generating process (DGP) with,
for the sake of simplicity, parsimonious specifications of the instrument, treatment, covariate, response, and outcome equations
that nevertheless give an idea about which forms of attrition can

0.5

1

α, β, γ , δ, κ are parameters of the DGP that will be varied later.
I {·} denotes the indicator function which is one if its argument is
true and zero otherwise. Q, V , W, are random nuisance variables that are standard normal with zero correlation. U0 , U1 , U2
are unobserved terms in the treatment and outcome equations
in various periods. Correlation among these variables causes
the endogeneity problem we have to deal with: Endogeneity is
caused by the fact that U0 affects the treatment D and is also
associated with the outcomes Y1 , Y2 through its correlation with
U1 and U2 . The response indicators R1 , R2 are equal to one if
the outcome is observed in the respective period. Attrition is
modeled as an absorbing state, that is, R2 is necessarily zero
if R1 = 0. X0 , X1 are observed covariates. The uniformly distributed X0 confounds the instrument because of its impact on
Z and Y1 and Y2 . Therefore, the instrument is only conditionally
valid given X0 . The latter also affects response in both periods,
thus causing attrition bias if not controlled for. Similarly, X1
jointly influences R2 and Y2 , creating further bias in the second
period. Note that X1 is a function of Y1 , which incorporates the
idea that previous outcomes or functions thereof might be used
to model attrition in the current period.
Our set up contains several tuning parameters: α, β, γ , δ,
κ. In the treatment equation, α determines the strength of
the instrument and thus the share of compliers. The compliers are those individuals with values of U0 and X0 such that
0.5 − α < U0 − 0.25X0 ≤ 0.5. The larger α, the more individuals react to a change in the instrument by switching their
treatment status. We consider two values of α: α = 0.68 and
α = 1.35, resulting in complier shares of roughly 25% and
50% under effect homogeneity, respectively. β in the response
equations gauges the effect of the instrument on R1 and R2 . If
β = 0, the exclusion restriction of Z on response as postulated
in Assumption 2 is violated and estimators based on Theorem
1 are inconsistent. γ defines the extent to which the compliers’
response behavior differs from the remainder of the population (i.e., the never and always takers). To see this, remember
that I {0.5 − α < U0 − 0.25X0 ≤ 0.5} is an indicator for being a complier. For γ = 0, Assumption 1’ is violated because

Frölich and Huber: Treatment Evaluation With Multiple Outcome Periods Under Endogeneity and Attrition

response then depends on the latent types. In this case, estimators based on Theorem 2 are inconsistent. δ determines whether
response is related to the outcomes of the current period, as for
instance considered in Xie and Qian (2012). That is, if δ = 0,
then Rt depends on Yt such that neither Assumption 1 nor Assumption 1’ are satisfied. Hence, estimators based on Theorems
1 or 2 are all inconsistent. Finally, κ determines whether the
treatment effects are homogeneous or heterogeneous as a function of the unobservables U0 . For κ = 0, the treatment effects
are homogeneous, that is, identical for everyone. In this case,
the treatment effect is 0.5 for everyone in the first period and
1.25 in the second period. (The effect of 1.25 consists of the
direct effect of D on Y2 , which is 1.00, and the indirect effect
of 0.5 · 0.5 = 0.25 running through X1 .) For κ = 0, the treatment effects differ depending on the values of U0 . Therefore,
the CACE differs from the average effect in the total population
because of different distributions of U0 .
We simulate the DGP 1000 times with a sample size of 5000
observations, which is representative for many recently conducted field experiments in social sciences; see, for instance,
Angrist, Bettinger, and Kremer (2006) and Bertrand and Mullainathan (2004). (The separate online appendix also examines
other sample sizes.) We investigate the performance of the following estimators: (i) naive estimation based on mean differences in observed treated and nontreated outcomes that ignores
both treatment endogeneity and attrition, (ii) CACE estimation
based on equation (11) in Tan (2006) or equation (12) in Frölich
(2007) that controls for endogeneity, but ignores attrition (denoted by ω̂), (iii) CACE estimation using expression (2) of
Theorem 1 (denoted by θ̂ ), and (iv) CACE estimation using expression (4) of Theorem 2 (denoted by φ̂). The propensity scores
in ω̂, θ̂, and φ̂ are estimated by local constant kernel regression
(with Gaussian kernel). The bandwidths were chosen according
to the nearest-neighbor-based default smoothing parameter in
the R-package “locfit,” which was 0.7. (The results were similar
when using a different kernel function such as the Epanechnikov kernel and/or when using other bandwidth values such
as 0.6 and 0.8. However, values smaller than 0.6 considerably
increased the variance of θ̂ , whereas the estimates and standard
errors were fairly robust for larger bandwidth values, e.g., 1.0
or larger.)
We also consider trimmed versions of θ̂ and φ̂ to prevent
denominators from being close to zero, which may imply arbitrarily large weights for some observations. Propensity score
trimming is discussed, for example, in Frölich (2004), Heckman, Ichimura, and Todd (1997), Dehejia and Wahba (1999),
Busso, DiNardo, and McCrary (2014), and Crump et al. (2009).
Yet, a trimming rule that is optimal in the sense that it minimizes the mean square error of the estimator does not appear
to be available in the literature. Here, we follow Huber, Lechner, and Wunsch (2013) and discard observations whose relative
weights within subgroups defined by Z and D exceed a particular
threshold. As trimming thresholds we consider relative weights
of 15 and 1%, resulting in the trimmed estimators θ̂trim (0.15),
φ̂trim (0.15), θ̂trim (0.01), φ̂trim (0.01). The appendix provides additional results for further trimming levels (10, 5, and 2%).
We also consider an estimator that controls for attrition under
the assumption of MAR but ignores treatment endogeneity due
to U0 , U1 , U2 , while controlling for confounding related to X0 .

1703

To be specific, we use the MLE-based G-computation procedure
of Robins (1986), in which the outcomes and response processes
are modeled parametrically by linear and logit specifications, respectively. The appendix also provides the results for estimation
based on targeted MLE (see van der Laan and Rubin 2006), inverse probability weighting (see, e.g., Horvitz and Thompson
1952; Hirano, Imbens, and Ridder 2003), and augmented IPW
(AIPW) (as in Robins, Rotnitzky, and Zhao 1995; Scharfstein,
Rotnitzky, and Robins 1999) which yield very similar results.
Finally, parametric Heckman (1976) MLE estimation of sample
selection models assuming jointly normally distributed unobserved terms in the response and the outcome equations is also
considered. The latter estimator controls for X0 , D, and Z in the
estimation of response and can, therefore, account for attrition
related to unobservables if R1 and R2 are functions of Z and if
Z does not have a direct effect on the outcomes conditional on
X0 and D. However, it does not allow for treatment endogeneity related to U0 , U1 , U2 and additionally presumes treatment
effects to be homogeneous.
Table 1 provides the bias, standard deviation and root mean
squared error (rmse) of the various estimators in periods 1 and 2
under treatment endogeneity and conditional LI with γ = 0.5,
and β, δ equal to zero. θ̂ , which is consistent in this scenario,
performs very well in terms of bias and rmse irrespective of
the period, share of compliers, and effect homogeneity or heterogeneity. In contrast, the naive approach, the MAR-based
G-computation procedure not controlling for treatment endogeneity, and the Heckman estimator are severely biased in any
specification. Also φ̂ (and its trimmed versions) and ω̂ are prone
to nonnegligible bias, even though the latter performs comparably well in the first time period. Note that trimming affects
neither θ̂ nor φ̂, implying that large relative weights do not occur.
In the second simulation (Table 2), γ = 0 such that the assumptions underlying φ̂ hold. At the same time β = 0.5, implying a direct effect of the instrument on the response process and
a violation of Assumption 2 required for the consistency of θ̂ .
Hence, estimators based on Theorem 2 are consistent, whereas
the assumptions for Theorem 1 are not met. As expected, φ̂
now dominates any other estimator with respect to bias and low
rmse and is unchanged by trimming. The naive approach, θ̂ ,
G-computation, the Heckman estimator, and (to a lesser extent)
ω̂ are substantially biased in most cases. θ̂ performs particularly
poorly under the smaller complier share (α = 0.68) due to a
large increase of the variance. Yet, already moderate trimming
using the 15% threshold (θ̂trim (0.15)) reduces the variance (and
the rmse) considerably, even though it remains at comparably
high levels. More trimming further decreases the rmse in the
first period, but increases it in the second one. In the latter case,
the rmse is relatively stable for 15% and 10%, but grows more
strongly for 2% and 1%.
In the third simulation (Table 3) we consider a scenario where
all estimators are inconsistent: γ is set to 0, while β = 0.5 and
δ = 0.25, implying that the instrument directly affects nonresponse, which in addition is also related to the outcomes of the
current period. θ̂ and φ̂ are biased because they ignore attrition
related to contemporaneous outcomes, while G-computation ignores both treatment endogeneity and attrition related to contemporaneous outcomes, and the Heckman estimator does not
account for treatment endogeneity. Trimming again reduces the

1704

Journal of the American Statistical Association, December 2014

Table 1. Simulation 1—treatment endogeneity and conditional LI
Homogeneous effects
α = 0.68, β = 0, γ = 0.5, δ = 0, κ = 0
Time period 1

Naive
ω̂
θ̂
θ̂trim (0.15)
θ̂trim (0.01)
φ̂
φ̂trim (0.15)
φ̂trim (0.01)
MAR G-comp.
Heckman

α = 1.35, β = 0, γ = 0.5, δ = 0, κ = 0

Time period 2

Time period 1

Time period 2

bias

stddev

rmse

bias

stddev

rmse

bias

stddev

rmse

bias

stddev

rmse

0.70
0.05
0.01
0.01
0.01
−0.14
−0.14
−0.14
0.71
0.36

0.03
0.11
0.12
0.12
0.12
0.14
0.14
0.14
0.03
1.59

0.70
0.13
0.12
0.12
0.12
0.20
0.20
0.20
0.71
1.63

0.92
0.12
−0.03
−0.03
−0.03
−0.41
−0.41
−0.41
0.94
0.03

0.06
0.16
0.17
0.17
0.17
0.23
0.23
0.23
0.06
1.61

0.92
0.20
0.17
0.17
0.17
0.47
0.47
0.47
0.94
1.61

0.56
0.03
0.01
0.01
0.01
−0.09
−0.09
−0.09
0.56
0.33

0.03
0.06
0.06
0.06
0.06
0.07
0.07
0.07
0.03
3.30

0.56
0.07
0.06
0.06
0.06
0.12
0.12
0.12
0.56
3.32

0.69
0.07
−0.01
−0.01
−0.01
−0.25
−0.25
−0.25
0.70
−0.22

0.06
0.08
0.09
0.09
0.09
0.11
0.11
0.11
0.06
2.63

0.69
0.11
0.09
0.09
0.09
0.27
0.27
0.27
0.70
2.64

True CACE
Mean response

0.50
0.63

1.25
0.41

0.50
0.69

1.25
0.49

Heterogeneous effects
α = 0.68, β = 0, γ = 0.5, δ = 0, κ = 0.5
Time period 1

Naive
ω̂
θ̂
θ̂trim (0.15)
θ̂trim (0.01)
φ̂
φ̂trim (0.15)
φ̂trim (0.01)
MAR G-comp.
Heckman
True CACE
Mean response

α = 1.35, β = 0, γ = 0.5, δ = 0, κ = 0.5

Time period 2

Time period 1

Time period 2

bias

stddev

rmse

bias

stddev

rmse

bias

stddev

rmse

bias

stddev

rmse

0.99
0.05
0.01
0.01
0.01
−0.20
−0.20
−0.20
1.00
0.63

0.04
0.13
0.13
0.13
0.13
0.16
0.16
0.16
0.04
2.27

0.99
0.14
0.13
0.13
0.13
0.25
0.25
0.25
1.00
2.36

1.34
0.12
−0.03
−0.03
−0.03
−0.52
−0.52
−0.52
1.36
0.25

0.06
0.18
0.20
0.20
0.20
0.26
0.26
0.26
0.06
2.07

1.34
0.22
0.20
0.20
0.20
0.58
0.58
0.58
1.37
2.09

0.83
0.03
0.01
0.01
0.01
−0.14
−0.14
−0.14
0.84
0.41

0.04
0.07
0.07
0.07
0.07
0.08
0.08
0.08
0.04
5.04

0.83
0.08
0.07
0.07
0.07
0.16
0.16
0.16
0.84
5.06

1.10
0.08
−0.01
−0.01
−0.01
−0.35
−0.35
−0.35
1.10
−0.18

0.06
0.10
0.10
0.10
0.10
0.13
0.13
0.13
0.06
2.85

1.10
0.13
0.10
0.10
0.10
0.37
0.37
0.37
1.10
2.86

0.64
0.63

1.45
0.43

0.48
0.69

1.22
0.50

NOTE: Results are based on 1000 simulations and 5000 observations.

variance of θ̂ in several cases, but smaller threshold values tend
to increase the rmse relative to larger thresholds when α = 0.68.
All in all, no method performs convincingly in this last set-up
considered.
4. APPLICATION TO A POLICY INTERVENTION
IN COLLEGE
In this section, we apply our methods to data from the Student Achievement and Retention Project assessed in Angrist,
Lang, and Oreopoulos (2009), a randomized program providing
academic services and financial incentives to first year students
at a Canadian campus which aimed at improving the academic
performance. To this end, all students who entered in September
2005 and had a high school grade point average (GPA) lower
than the upper quartile were randomly assigned either to one
of three different treatments provided in the first year, namely
academic support services, financial incentives, or both, or oth-

erwise to a control group. The services contained both access to
peer advisors, that is, trained upper-class students supposed to
provide academic support, and class-specific sessions targeted
at improving study habits without focusing on specific course
content. The financial incentives consisted of cash payments
between 1000 and 5000 dollars that were conditional on attaining particular GPA targets in college, where the targets were a
function of the high school GPA.
While the intervention appeared to be generally ineffective
for males, Angrist, Lang, and Oreopoulos (2009) found positive
effects of the combined treatment (academic support and financial incentives) on the college performance of females in the
first and second year. For this reason, we will only focus on the
subsample of 948 female students in the subsequent discussion.
As the number of observations assigned to a particular treatment
arm is rather low, we aggregate the academic services and financial incentives to a binary treatment that takes the value one if
any form of intervention took place and zero otherwise to avoid

Frölich and Huber: Treatment Evaluation With Multiple Outcome Periods Under Endogeneity and Attrition

1705

Table 2. Simulation 2—treatment endogeneity and MAR (with the instrument affecting response)
Homogeneous effects
α = 0.68, β = 0.5, γ = 0, δ = 0, κ = 0
Time period 1

Naive
ω̂
θ̂
θ̂trim (0.15)
θ̂trim (0.01)
φ̂
φ̂trim (0.15)
φ̂trim (0.01)
MAR G-comp.
Heckman

α = 1.35, β = 0.5, γ = 0, δ = 0, κ = 0

Time period 2

Time period 1

Time period 2

bias

stddev

rmse

bias

stddev

rmse

bias

stddev

rmse

bias

stddev

rmse

0.75
0.21
−0.37
−0.93
−0.86
0.02
0.02
0.02
0.76
0.86

0.03
0.09
41.34
5.08
4.30
0.14
0.14
0.14
0.03
0.04

0.75
0.23
41.34
5.17
4.38
0.14
0.14
0.14
0.77
0.86

1.08
0.47
307.31
1.76
2.10
−0.09
−0.09
−0.09
1.11
1.30

0.06
0.12
9507.59
32.97
41.21
0.23
0.23
0.23
0.05
0.06

1.09
0.48
9512.56
33.02
41.26
0.25
0.25
0.25
1.11
1.30

0.64
0.12
−0.05
−0.05
−0.05
0.01
0.01
0.01
0.65
0.83

0.03
0.05
0.08
0.08
0.08
0.07
0.07
0.07
0.03
0.04

0.64
0.13
0.10
0.10
0.10
0.07
0.07
0.07
0.65
0.83

0.93
0.28
−0.40
−0.49
−0.43
−0.05
−0.05
−0.05
0.95
1.26

0.06
0.07
4.80
0.64
0.84
0.12
0.12
0.12
0.06
0.09

0.93
0.29
4.82
0.81
0.95
0.13
0.13
0.13
0.95
1.26

True CACE
Mean response

0.50
0.68

1.25
0.49

0.50
0.69

1.25
0.51

Heterogeneous effects
α = 0.68, β = 0.5, γ = 0, δ = 0, κ = 0.5
Time period 1

Naive
ω̂
θ̂
θ̂trim (0.15)
θ̂trim (0.01)
φ̂
φ̂trim (0.15)
φ̂trim (0.01)
MAR G-comp.
Heckman
True CACE
Mean response

α = 1.35, β = 0.5, γ = 0, δ = 0, κ = 0.5

Time period 2

Time period 1

bias

stddev

rmse

bias

stddev

rmse

1.05
0.29
−0.28
−0.85
−0.77
0.02
0.02
0.02
1.07
1.21

0.04
0.10
41.34
5.08
4.23
0.15
0.15
0.15
0.04
0.04

1.05
0.31
41.34
5.15
4.37
0.15
0.15
0.15
1.07
1.21

1.54
0.65
307.47
1.92
2.26
−0.08
−0.08
−0.08
1.57
1.88

0.06
0.13
9507.59
32.97
41.21
0.25
0.25
0.25
0.06
0.07

1.54
0.67
9512.56
33.03
41.27
0.26
0.26
0.26
1.58
1.88

0.64
0.68

1.45
0.49

bias
0.94
0.18
0.01
0.01
0.01
0.01
0.01
0.01
0.95
1.19

Time period 2

stddev

rmse

bias

stddev

rmse

0.04
0.06
0.09
0.09
0.09
0.08
0.08
0.08
0.04
0.04

0.94
0.19
0.09
0.09
0.09
0.08
0.08
0.08
0.95
1.19

1.39
0.43
−0.27
−0.36
−0.30
−0.04
−0.04
−0.04
1.41
2.02

0.06
0.09
4.80
0.65
0.84
0.13
0.13
0.13
0.06
0.44

1.39
0.44
4.81
0.74
0.89
0.14
0.14
0.14
1.41
2.06

0.48
0.69

1.22
0.51

NOTE: Results are based on 1000 simulations and 5000 observations.

small sample problems. For the same reason, we use (parametric) probit regressions (rather than nonparametric methods) to
estimate the conditional probabilities involved in the identification results, which entails semiparametric estimators of the
CACE. Inference is based on the bootstrap.
Albeit treatment assignment was random, identification may
be flawed by both endogeneity and attrition. The endogeneity
issue stems from the fact that only 274 (or 73%) of the 374 students who were offered any treatment actually signed up for it,
which gives rise to potential selection bias into treatment. Furthermore, GPA scores, one of the outcomes measuring college
success, are not observed for all students. Whereas they are missing for only 56 students (or 6%) in the first year, nonresponse
amounts to a nonnegligible 169 (or 18%) in the second year. If
attrition is selective so that, for example, the probability to drop
out decreased in both the treatment state and unobserved ability, the treatment effect is biased due to positive selection into
observed GPA scores. Angrist, Lang, and Oreopoulos (2009)

used instrumental variable estimation to control for endogeneity, where the random assignment indicator serves as instrument.
They, however, did not correct for attrition in the GPA outcomes,
but merely base their analysis on all those observations without
missing GPAs; see the note underneath Table 6 in their article.
Here, we apply the methods outlined in Sections 2.2 and 2.3 to
control for both endogeneity and attrition.
We are interested in the effect of having signed up for any
of the three treatments (D = 1) versus no treatment (D = 0)
on the GPA scores at the end of the first and second year. We
estimate the CACE based on Theorem 1 to allow attrition to
be related to the latent types, as compliers with the treatment
assignment may be more motivated to stay in college than the
never takers, whose reluctance to take the treatment even when
offered may be associated with a higher inclination to drop out
of college. This motivates our higher confidence in Assumption
1 rather than the stronger Assumption 1’ (which does not permit
LI conditional on observables). At the same time, it seems likely

1706

Journal of the American Statistical Association, December 2014

Table 3. Simulation 3—treatment endogeneity and selection on current outcomes
Homogeneous effects
α = 0.68, β = 0.5, γ = 0, δ = 0.25, κ = 0
Time period 1

Naive
ω̂
θ̂
θ̂trim (0.15)
θ̂trim (0.01)
φ̂
φ̂trim (0.15)
φ̂trim (0.01)
MAR G-comp.
Heckman

α = 1.35, β = 0.5, γ = 0, δ = 0.25, κ = 0

Time period 2

Time period 1

Time period 2

bias

stddev

rmse

bias

stddev

rmse

bias

stddev

rmse

bias

stddev

rmse

0.68
0.10
−1.55
−1.18
−1.21
−0.23
−0.23
−0.23
0.70
0.87

0.03
0.10
5.09
4.65
4.90
0.14
0.14
0.14
0.03
0.04

0.68
0.13
5.32
4.80
5.05
0.27
0.27
0.27
0.70
0.88

0.85
0.36
1.48
−1.21
−0.45
−0.59
−0.59
−0.59
0.89
1.23

0.05
0.11
572.82
20.30
24.37
0.22
0.22
0.22
0.05
0.09

0.85
0.37
572.82
20.34
24.37
0.63
0.63
0.63
0.89
1.23

0.57
0.05
−0.19
−0.19
−0.19
−0.13
−0.13
−0.13
0.58
0.84

0.03
0.05
0.08
0.08
0.08
0.07
0.07
0.07
0.03
0.07

0.57
0.07
0.21
0.21
0.21
0.15
0.15
0.15
0.58
0.84

0.67
0.19
−0.68
−0.67
−0.65
−0.36
−0.36
−0.36
0.70
2.11

0.06
0.07
0.47
0.24
0.20
0.11
0.11
0.11
0.05
1.02

0.67
0.20
0.83
0.71
0.69
0.37
0.37
0.37
0.70
2.34

True CACE
Mean response

0.50
0.71

1.25
0.55

0.50
0.72

1.25
0.57

Heterogeneous effects
α = 0.68, β = 0.5, γ = 0, δ = 0.25, κ = 0.5
Time period 1

Naive
ω̂
θ̂
θ̂trim (0.15)
θ̂trim (0.01)
φ̂
φ̂trim (0.15)
φ̂trim (0.01)
MAR G-comp.
Heckman
True CACE
Mean response

α = 1.35, β = 0.5, γ = 0, δ = 0.25, κ = 0.5

Time period 2

Time period 1

Time period 2

bias

stddev

rmse

bias

stddev

rmse

bias

stddev

rmse

bias

stddev

rmse

1.00
0.13
−1.51
−1.14
−1.16
−0.22
−0.22
−0.22
1.02
1.30

0.03
0.11
5.09
4.65
4.90
0.15
0.15
0.15
0.03
0.04

1.00
0.17
5.31
4.79
5.04
0.27
0.27
0.27
1.02
1.30

1.33
0.43
1.55
−1.13
−0.38
−0.56
−0.56
−0.56
1.37
1.95

0.06
0.14
572.82
20.30
24.37
0.24
0.24
0.24
0.06
0.27

1.33
0.45
572.82
20.33
24.37
0.61
0.61
0.61
1.37
1.97

0.89
0.09
−0.15
−0.15
−0.15
−0.11
−0.11
−0.11
0.90
1.67

0.04
0.06
0.09
0.09
0.09
0.08
0.08
0.08
0.04
0.57

0.89
0.11
0.18
0.18
0.18
0.13
0.13
0.13
0.90
1.77

1.18
0.28
−0.60
−0.59
−0.57
−0.29
−0.29
−0.29
1.21
2.65

0.06
0.09
0.47
0.25
0.21
0.12
0.12
0.12
0.06
1.27

1.18
0.29
0.76
0.64
0.61
0.31
0.31
0.31
1.21
2.94

0.64
0.72

1.45
0.56

0.48
0.73

1.22
0.59

NOTE: Results are based on 1000 simulations and 5000 observations.

that mere assignment does not affect the drop out decision of
never takers, who would not take advantage of the treatment
anyway. We, therefore, suspect Assumption 2 to be satisfied,
albeit somewhat stronger than Assumption 2’. Nevertheless, we
also consider estimation based on Theorem 2 imposing MAR
given the observed variables and the treatment, which allows
checking the sensitivity of the results to the presumed form of
attrition. If one obtains similar results under both methods, this
may imply that (the respective stronger assumption of) both
sets of assumptions are satisfied, that is, Assumption 1’ and Assumption 2. We use both untrimmed and trimmed versions of
the respective estimators. As in the simulations, trimming discards observations whose relative weights in subgroups defined
by Z and D exceed a certain threshold, which is set to 10% in
the application.
The dataset contains a range of pretreatment variables measuring performance and ambition as well as socioeconomic characteristics that allow us to model the response process in the first

year. For example, we observe the GPA score in high school,
the fall grade of the first year, and the attempted math and science courses, which are most likely correlated with both GPA
scores in later periods and the probability to drop out. Indeed,
the empirical relevance of academic performance in high school
and in the first semester of college as a predictor for attrition
is well documented in the literature on higher education; see,
for example, Leppel (2002), Herzog (2005), and Tinto (1997).
Furthermore, the data include self-assessed measures of effort
and ambition, for example, whether the student wants to finish in four years, or strives for a higher degree than a BA.
Learning habits are reflected by the information on how often a student leaves studying until the last minute. The data
also comprise important characteristics reflecting the socioeconomic background, such as age, parents’ education, and indicators for living at home and English mother tongue. Finally, it
contains dummies for whether the student is at the first choice
college and whether she completed the base line survey which

Frölich and Huber: Treatment Evaluation With Multiple Outcome Periods Under Endogeneity and Attrition

1707

Table 4. Probit coefficients and marginal effects of the model for 1st year response
Coefficients

Constant
Treatment D
High school GPA ≤ 75.2
High school GPA
Fall grade
Attempted math/science credits
Wants more than B.A.
Last minute learning (usual/often)
Age < 20
Father has college degree
At first choice college
Completed baseline survey
Pseudo R2

Marginal effects

(1)

(2)

(3)

5.495
(2.896)
0.335
(0.265)
−0.574
(0.312)
−0.078
(0.036)
0.028
(0.003)
0.878
(0.239)
0.235
(0.223)
−0.054
(0.244)
0.311
(0.396)
−0.129
(0.230)
0.208
(0.258)
0.778
(0.269)
0.494

6.196
(2.721)
0.529
(0.262)
−0.503
(0.300)
−0.076
(0.034)
0.029
(0.003)
0.970
(0.247)

1.445
(0.072)
0.571
(0.184)

0.452

0.027

(1)

(2)

(3)

0.003
(0.002)
−0.008
(0.008)
−0.001
(0.001)
0.000
(0.000)
0.008
(0.004)
0.002
(0.003)
−0.000
(0.002)
0.004
(0.008)
−0.001
(0.002)
0.002
(0.002)
0.018
(0.016)
0.494

0.004
(0.003)
−0.007
(0.007)
−0.001
(0.001)
0.000
(0.000)
0.009
(0.005)

0.052
(0.013)

0.452

0.027

NOTE: (1)–(3) give the probit coefficients and marginal effects, respectively, when estimating 0 = Pr(R1 = 1|X0 , D = 1) under different specifications: (1) is the main specification
with all regressors, (2) contains a subset of regressors, (3) contains only D and a constant. The marginal effects are evaluated at the means of all other regressors. Standard errors are given
in brackets. The sample size is 948.

may be correlated with the likelihood to be observed in later
periods.
Table 4 gives the results of a probit regression of first year
response on the baseline covariates X0 and the treatment indicator D to estimate 0 = Pr(R1 = 1|X0 , D = 1). The main
specification (1) contains all regressors, and is used for the
estimation of the CACE. Specification (2) presents a more parsimonious model consisting of D and pretreatment outcomes
(high school GPA, fall grade, attempted math/science credits).
Finally, specification (3) only contains D and a constant as regressors. Comparing the results for the different specifications,
we find that the pretreatment outcomes and the dummy for
survey completed clearly have the highest predictive power,
whereas socioeconomic variables are less important.
For modeling response in the second period, we use in addition to the covariates X0 of specification (1) three intermediate
outcomes (X1 ) at the end of the first year: the GPA as well as
the number of credits earned in the first year and an indicator for
good standing, all of which are highly correlated with response
in the second year.
Table 5 provides descriptive statistics (means and standard
deviations) of the variables used in our analysis for all females,
as well as for subsamples with D = 1 and D = 0. The variables
measured after the first or second year are only observed if
R1 = 1 and R2 = 1, respectively. Note that treated females have
on average higher pretreatment outcomes (high school GPA and

fall grade) and higher aspirations (wanting more than a BA) than
the nontreated. This points to selectivity and motivates the use
of random treatment assignment Z as an instrument for actual
treatment take-up D.
Table 6 presents the estimated treatment effects of the intervention on the GPA one and two years later. The top panel
provides the estimates for the full sample. The subsequent panels show the results for various subsamples defined by age and
parental background. In each panel, the first line gives the CACE
estimates, the second line the bootstrap standard errors, and
the third line the bootstrap p-values based on the quantiles of
the resampled distribution of the CACE estimates; see eq. (6)
in MacKinnon (2006). We provide the quantile-based p-values
(rather than those based on the t-statistic) to account for the problem that in finite samples the moments of instrumental variable
estimators may not exist such that t-statistics may be misleading, which might even be aggravated by attrition. The first and
sixth columns labeled “Wald” show the Wald estimates, that is
the instrumental variable estimator without any covariates. The
estimates based on Theorem 1 are denoted by θ̂ and θ̂trim , where
the latter represents the trimmed version. The estimates based on
Theorem 2 are denoted by φ̂ and φ̂trim . We find that large weights
rarely occur such that the trimmed and untrimmed point estimates are always very similar, if not the same. Note, however,
that trimming reduces the standard errors of the estimates based
on Theorem 1 by disciplining outliers in the bootstrap samples.

1708

Journal of the American Statistical Association, December 2014

Table 5. Descriptive statistics
Total sample
(948 obs.)

D = 1 (274 obs.)

D = 0 (674 obs.)

Regressor

mean

std. dev

mean

std. dev

mean

std. dev

High school GPA (multivalued)
Fall grade (multivalued)
Attempted math/science credits (multivalued)
Wants more than BA (binary)
Last minute learning (binary)
At first choice college (binary)
Age < 20 (binary)
Father has college degree (binary)
Completed baseline survey (binary)
First year response R1 (binary)
First year GPA Y1 (multivalued)
First year good standing for R1 = 1 (binary)
First year credits earned for R1 = 1 (multivalued)
Second year response R2 (binary)
Second year GPA Y2 for R2 = 1 (multivalued)

78.88
53.69
1.00
0.52
0.28
0.24
0.97
0.37
0.90
0.94
1.76
0.48
2.36
0.82
2.07

4.29
25.71
1.16
0.50
0.45
0.43
0.17
0.48
0.30
0.24
0.90
0.50
0.93
0.38
0.87

79.10
58.55
1.05
0.58
0.30
0.26
0.99
0.40
0.95
0.98
1.81
0.54
2.47
0.83
2.19

4.30
23.04
1.19
0.49
0.46
0.44
0.12
0.49
0.23
0.15
0.88
0.50
0.94
0.37
0.86

78.80
51.71
0.97
0.49
0.28
0.23
0.97
0.36
0.89
0.93
1.74
0.46
2.32
0.82
2.01

4.28
26.48
1.15
0.50
0.45
0.42
0.18
0.48
0.32
0.26
0.91
0.50
0.92
0.39
0.87

NOTE: Descriptive statistics for baseline covariates X0 , response indicators R1 and R2 and outcomes Y1 and Y2 , if observed.

Both θ̂ and θ̂trim are nevertheless less precise than φ̂ and φ̂trim .
We would generally (and specifically in moderate samples) expect this to be the case at least if both theorems are (closely)
satisfied, because Theorem 1 contains more conditional probabilities to be estimated, for example, P0 − π and P1 − π in the
denominator, which may potentially decrease precision in small
samples. In particular, if the latter differences are small (which
likely occurs if Z only weakly shifts D so that few compliers
exist) the variance might be large. Furthermore, in the current
application, φ̂ and φ̂trim appear to rest on stronger assumptions
than θ̂ and θ̂trim , which again suggests lower standard errors of
the former: Whereas we argued in Section 2 that Assumption 2’
is generally weaker than Assumption 2, they are, however, very
similar in the application at hand. This is because Assumption
2 only restricts the response process in time period 1, where
we have in fact very little nonresponse. (Nonresponse is larger
in time period 2, but this does not enter Assumption 2.) On
the other hand, Assumption 1’ is clearly much stronger than
Assumption 1. The former imposes independence within each
stratum defined by Z and D (and other predetermined observables), whereas the latter additionally requires conditioning on
the (unobserved) type. Therefore, estimators based on Assumption 1’ exploit more restrictions and can (figuratively speaking)
use coarser strata with more information than methods relying
on Assumption 1, which have to operate within finer strata additionally defined upon the type. Therefore, φ̂ and φ̂trim can exploit
more information.
Examining first the estimates for the whole population, we
do not find any significant effects in the first year. In contrast,
the simple Wald estimates for the second year are significant (at
the 5% level) and suggest that the GPA of compliers increases
by 0.164 points. However, when using the attrition-corrected
estimators, the effect shrinks considerably to 0.077 or 0.071,
respectively, and becomes insignificant. Therefore, our results
suggest that attrition, if ignored, may lead to an overestimation
of the effects in education experiments.

In the remainder of Table 6, we investigate effect heterogeneity for subsamples stratified by age, prior academic achievement,
and parental background. For example, we separately consider
students in the lower and the upper half of the high school
GPA distribution (median: 78.5 points) to see whether high or
low achievers particularly benefit from the intervention. Indeed,
the Wald estimate for the second year GPA of low achievers
amounts to 0.225 points, indicating that the less capable students benefit most when taking advantage of the services and
incentives. However, after controlling for attrition, the effect becomes much smaller and insignificant, irrespective of trimming.
When we split the sample by age groups (17 and 18 years vs.
older than 18), we also cannot draw reliable conclusions as the
estimates are generally rather noisy.
Finally, we examine whether the effects differ by parents’
education, which might be regarded as a proxy for family background. Interestingly, the second year Wald estimate in the subsample with mothers that have a college degree is negative and
large. When controlling for attrition, the estimate shrinks in
magnitude (in the case of θ̂ , θ̂trim quite considerably) and becomes even less significant. In contrast, for those students whose
mother has no degree, the Wald estimate is significantly positive
(at the 5% level) in both periods. Furthermore, correcting for
attrition does not substantially reduce the estimate in the second
year, even though the precision decreases. The estimates φ̂ and
φ̂trim remain significant at the 5% level. A similar pattern appears
when stratifying on the father’s degree status. While the Wald
estimate in the second year is insignificant in the subpopulation
with fathers having a degree, it is large and significant in the subsample without college degree. Furthermore, the effect is almost
the same when using θ̂ , albeit less precisely estimated, and θ̂trim ,
φ̂, φ̂trim are significant at the 10% and 5% levels, respectively.
In summary, our findings suggest that the empirical evidence
about the effectiveness of the intervention considered by Angrist, Lang, and Oreopoulos (2009) is much weaker once attrition is acknowledged. Nevertheless, female students with a less

Frölich and Huber: Treatment Evaluation With Multiple Outcome Periods Under Endogeneity and Attrition

1709

Table 6. Effectiveness of the school intervention on GPA: all females and subsamples
1st year effect of intervention on GPA
Wald estimate
(no covariates)

θ̂
θ̂trim
(Theorem 1)

Effect
s.e.
p-val

0.074
0.079
0.399

0.022
0.291
0.709

0.022
0.129
0.679

Effect
s.e.
p-val

0.156
0.110
0.149

0.107
2.340
0.502

Effect
s.e.
p-val

0.023
0.106
0.812

Effect
s.e.
p-val

φ̂
φ̂trim
(Theorem 2)

2nd year effect of intervention on GPA
Wald estimate
(no covariates)

Full sample: all females (948 obs.)
−0.047
−0.047
0.164
0.075
0.076
0.083
0.517
0.577
0.040

θ̂
θ̂trim
(Theorem 1)

φ̂
φ̂trim
(Theorem 2)

0.077
8.694
0.817

0.077
0.214
0.770

0.071
0.090
0.419

0.071
0.093
0.340

0.107
0.274
0.456

Subsample: high school GPA ≤ 78.5 (467 obs.)
0.057
0.057
0.225
0.143
0.112
0.128
10.937
0.112
0.595
0.565
0.069
0.451

0.143
0.378
0.382

0.043
0.130
0.698

0.043
0.131
0.669

−0.093
36.995
0.668

−0.093
0.382
0.712

Subsample: high school GPA > 78.5 (481 obs.)
−0.170
−0.170
0.099
0.036
0.135
0.128
0.098
24.073
0.220
0.382
0.300
0.941

−0.066
0.968
0.670

−0.001
0.180
0.816

−0.122
0.156
0.456

0.042
0.090
0.632

−0.024
2.472
0.816

−0.024
0.310
0.848

Subsample: 17 and 18 years old (741 obs.)
−0.050
−0.050
0.132
0.093
0.089
0.088
0.092
28.780
0.547
0.556
0.145
0.573

0.093
0.322
0.469

0.043
0.103
0.680

0.043
0.103
0.668

Effect
s.e.
p-val

0.131
0.192
0.484

0.064
1530.530
0.822

0.002
0.627
0.776

Subsample: 19-23 years old (207 obs.)
0.226
0.275
−0.051
−0.059
0.194
0.195
0.218
733.224
0.772
0.939
0.259
0.615

0.171
0.889
0.448

0.125
0.379
0.656

−0.021
0.306
0.703

Effect
s.e.
p-val

−0.178
0.143
0.212

−0.171
2.745
0.388

−0.249
0.329
0.148

Subsample: mother has college degree (304 obs.)
−0.201
−0.201
−0.253
−0.085
0.167
0.135
0.155
64.916
0.157
0.224
0.105
0.936

−0.197
0.481
0.675

−0.211
0.193
0.208

−0.211
0.157
0.281

Effect
s.e.
p-val

0.197
0.097
0.034

0.135
5.960
0.130

0.135
0.098
0.117

Subsample: mother has no college degree (644 obs.)
0.080
0.080
0.383
0.345
0.111
0.098
0.099
5.095
0.366
0.290
0.000
0.147

0.345
0.271
0.096

0.259
0.155
0.050

0.259
0.131
0.018

Effect
s.e.
p-val

0.035
0.133
0.827

−0.029
58.422
0.839

−0.029
0.216
0.886

Subsample: father has college degree (355 obs.)
−0.038
−0.038
−0.078
0.065
0.187
0.123
0.141
37.131
0.717
0.833
0.566
0.457

0.065
0.406
0.212

−0.127
0.206
0.342

−0.127
0.134
0.443

Effect
s.e.
p-val

0.092
0.101
0.371

0.066
8.636
0.491

0.066
0.133
0.479

Subsample: father has no college degree (593 obs.)
0.307
−0.008
−0.008
0.317
0.099
0.101
0.108
6.418
0.979
0.904
0.002
0.150

0.307
0.225
0.085

0.250
0.140
0.063

0.250
0.143
0.029

NOTE: Treatment effects of the intervention (support and/or financial services) on GPA outcomes one and two years later, respectively. The top panel displays the results for the full
sample (on the left, the effect after one year; on the right, the effect after two years). The subsequent panels show estimates for subpopulations stratified by age, parental background,
and prior academic achievement. P-values are given in brackets and are based on 1999 bootstrap replications. Trimming in θ̂trim and φ̂trim is based on dropping observations that have a
relative weight larger than 10%.

favorable family background seem to gain from the services and
financial incentives.
5. CONCLUSIONS
In this article, we proposed a novel approach for the identification and estimation of local average treatment effects in
multiple outcome periods which controls for both treatment endogeneity and outcome attrition. We showed how pretreatment
information can be combined with intermediate outcomes to
correct more plausibly for nonresponse bias in later periods,
while an instrument was used to tackle endogenous treatment
selection. Two sets of identifying assumptions were presented.
The first one, which we call conditional latent ignorability, per-

mits attrition to depend on observables and the latent treatment
compliance type, which may be related to unobservables. The
second one imposes randomness given observed variables only,
which amounts to a dynamic missing at random assumption. The
proposed methods were applied to a policy intervention aimed
at increasing academic performance in college, where ignoring
attrition was found to lead to upwardly biased estimates.

SUPPLEMENTARY MATERIALS
The supplementary materials contain all proofs and further
simulation results. The appendix will be made available on the
personal homepages of the authors.

1710

Journal of the American Statistical Association, December 2014
[Received January 2012. Revised January 2014.]

REFERENCES
Abadie, A. (2003), “Semiparametric Instrumental Variable Estimation of
Treatment Response Models,” Journal of Econometrics, 113, 231–263.
[1699,1700]
Abowd, J., Crepon, B., and Kramarz, F. (2001), “Moment Estimation With
Attrition: An Application to Economic Models,” Journal of the American
Statistical Association, 96, 1223–1230. [1697]
Angrist, J., Bettinger, E., and Kremer, M. (2006), “Long-Term Educational
Consequences of Secondary School Vouchers: Evidence From Administrative Records in Colombia,” American Economic Review, 96, 847–862.
[1697,1703]
Angrist, J., Imbens, G., and Rubin, D. (1996), “Identification of Causal Effects
Using Instrumental Variables” (with discussion), Journal of the American
Statistical Association, 91, 444–472. [1697,1699]
Angrist, J., Lang, D., and Oreopoulos, P. (2009), “Incentives and
Services for College Achievement: Evidence From a Randomized
Trial,” American Economic Journal: Applied Economics, 1, 136–163.
[1698,1701,1704,1705,1708]
Barnard, J., Frangakis, C., Hill, J., and Rubin, D. (2003), “A Principal Stratification Approach to Broken Randomized Experiments: A Case Study of
School Choice Vouchers in New York City,” Journal of the American Statistical Association, 98, 299–323. [1697]
Bertrand, M., and Mullainathan, S. (2004), “Are Emily and Greg More Employable Than Lakisha and Jamal? A Field Experiment on Labor Market
Discrimination,” The American Economic Review, 94, 991–1013. [1703]
Bollinger, C., and David, M. (2001), “Estimation With Response Error and
Nonresponse: Food-Stamp Participation in the SIPP,” Journal of Business
and Economic Statistics, 19, 129–141. [1697]
Busso, M., DiNardo, J., and McCrary, J. (2014), “New Evidence on the Finite
Sample Properties of Propensity Score Matching and Reweighting Estimators,” Review of Economics and Statistics, accepted. [1703]
Carroll, R., Ruppert, D., and Stefanski, L. (1995), Measurement Error in Nonlinear Models, London: Chapman and Hall. [1697]
Chen, P., Wong, E., Dominik, R., and Steiner, M. (2000), “A Transitional
Model of Barrier Methods Compliance With Unbalanced Loss to FollowUp,” Statistics in Medicine, 19, 71–82. [1697]
Crump, R., Hotz, J., Imbens, G., and Mitnik, O. (2009), “Dealing With Limited Overlap in Estimation of Average Treatment Effects,” Biometrika, 96,
187–199. [1703]
Das, M., Newey, W., and Vella, F. (2003), “Nonparametric Estimation of Sample
Selection Models,” Review of Economic Studies, 70, 33–58. [1697]
Dehejia, R., and Wahba, S. (1999), “Causal Effects in Non-Experimental Studies: Reevaluating the Evaluation of Training Programmes,” Journal of the
American Statistical Association, 94, 1053–1062. [1703]
DiNardo, J., McCrary, J., and Sanbonmatsu, L. (2006), “Constructive Proposals for Dealing With Attrition: An Empirical Example,” Working paper, University of Michigan, available at
http://eml.berkeley.edu/∼jmccrary/DMS_v9.pdf. [1697]
Ding, W., and Lehrer, S. (2010), “Estimating Treatment Effects From Contaminated Multiperiod Education Experiments: The Dynamic Impacts of Class
Size Reductions,” Review of Economics and Statistics, 92, 31–42. [1698]
Fitzgerald, J., Gottschalk, P., and Moffitt, R. (1998), “An Analysis of Sample
Attrition in Panel Data: The Michigan Panel Study of Income Dynamics,”
Journal of Human Resources, 33, 251–299. [1697,1698]
Frangakis, C., Brookmeyer, R., Varadhan, R., Safaeian, M., Vlahov, D., and
Strathdee, S. (2004), “Methodology for Evaluating a Partially Controlled
Longitudinal Treatment Using Principal Stratification, With Application to a
Needle Exchange Program,” Journal of the American Statistical Association,
99, 239–249. [1697]
Frangakis, C., and Rubin, D. (1999), “Addressing Complications of Intentionto-Treat Analysis in the Combined Presence of All-or-None TreatmentNoncompliance and Subsequent Missing Outcomes,” Biometrika, 86,
365–379. [1697,1698]
Frumento, P., Mealli, F., Pacini, B., and Rubin, D. B. (2012), “Evaluating the
Effect of Training on Wages in the Presence of Noncompliance, Nonemployment, and Missing Outcome Data,” Journal of the American Statistical
Association, 107, 450–466. [1698]
Frölich, M. (2004), “Finite Sample Properties of Propensity-Score Matching
and Weighting Estimators,” Review of Economics and Statistics, 86, 77–90.
[1703]
——— (2007), “Nonparametric IV Estimation of Local Average Treatment Effects With Covariates,” Journal of Econometrics, 139, 35–75.
[1699,1700,1701,1703]
——— (2008), “Parametric and Nonparametric Regression in the Presence
of Endogenous Control Variables,” International Statistical Review, 76,
214–227. [1699]

Frölich, M., and Melly, B. (2013), “Unconditional Quantile Treatment Effects Under Endogeneity,” Journal of Business and Economic Statistics,
31, 346–357. [1699]
Hausman, J., and Wise, D. (1979), “Attrition Bias in Experimental and Panel
Data: The Gary Income Maintenance Experiment,” Econometrica, 47,
455–473. [1697]
Heckman, J. (1976), “The Common Structure of Statistical Models of Truncation, Sample Selection, and Limited Dependent Variables, and a Simple
Estimator for Such Models,” Annals of Economic and Social Measurement,
5, 475–492. [1697,1703]
Heckman, J., Ichimura, H., and Todd, P. (1997), “Matching as an Econometric Evaluation Estimator: Evidence From Evaluating a Job Training Programme,” Review of Economic Studies, 64, 605–654. [1703]
Heitjan, D., and Basu, S. (1996), “Distinguishing Missing at Random and
Missing Completely at Random,” The American Statistician, 50, 207–
213. [1699]
Herzog, S. (2005), “Measuring Determinants of Student Return vs.
Dropout/Stopout vs. Transfer: A First-to-Second Year Analysis of New
Freshmen,” Research in Higher Education, 46, 883–928. [1706]
Hirano, K., Imbens, G., and Ridder, G. (2003), “Efficient Estimation of Average
Treatment Effects Using the Estimated Propensity Score,” Econometrica,
71, 1161–1189. [1703]
Hirano, K., Imbens, G. W., Ridder, G., and Rubin, D. B. (2001), “Combining
Panel Data Sets With Attrition and Refreshment Samples,” Econometrica,
69, 1645–1659. [1700,1702]
Horvitz, D., and Thompson, D. (1952), “A Generalization of Sampling Without
Replacement From a Finite Population,” Journal of the American Statistical
Association, 47, 663–685. [1703]
Huber, M. (2012), “Identification of Average Treatment Effects in Social Experiments Under Alternative Forms of Attrition,” Journal of Educational and
Behavioral Statistics, 37, 443–474. [1697]
——— (2013), “Treatment Evaluation in the Presence of Sample Selection,”
Econometric Reviews, 33, 869–905. [1697]
Huber, M., Lechner, M., and Wunsch, C. (2013), “The Performance of Estimators Based on the Propensity Score,” Journal of Econometrics, 175, 1–21.
[1703]
Huber, M., and Mellace, G. (2013), “Testing Instrument Validity for LATE
Identification Based on Inequality Moment Constraints,” forthcoming in
The Review of Economics and Statistics. [1702]
Imai, K. (2008), “Sharp Bounds on the Causal Effects in Randomized Experiments With ‘Truncation-by-Death’,” Statistics & Probability Letters, 78,
144–149. [1698]
Imbens, G. (2004), “Nonparametric Estimation of Average Treatment Effects
Under Exogeneity: A Review,” Review of Economics and Statistics, 86,
4–29. [1700]
Imbens, G., and Angrist, J. (1994), “Identification and Estimation of Local
Average Treatment Effects,” Econometrica, 62, 467–475. [1697,1699]
Kitagawa, T. (2013), “A Bootstrap Test for Instrument Validity in the
Heterogeneous Treatment Effect Model,” CeMMAP working paper,
CWP53/13. [1702]
Kyriazidou, E. (1997), “Estimation of a Panel Data Sample Selection Model,”
Econometrica, 65, 1335–1364. [1697]
——— (2001), “Estimation of Dynamic Panel Data Sample Selection Models,”
The Review of Economic Studies, 68, 543–572. [1697]
Lechner, M. (1999), “Earnings and Employment Effects of Continuous Off-theJob Training in East Germany After Unification,” Journal of Business and
Economic Statistics, 17, 74–90. [1700]
Lechner, M., Miquel, R., and Wunsch, C. (2011), “Long-Run Effects of Public
Sector Sponsored Training in West Germany,” Journal of the European
Economic Association, 9, 742–784. [1697]
Lee, D. (2009), “Training, Wages, and Sample Selection: Estimating Sharp
Bounds on Treatment Effects,” Review of Economic Studies, 76, 1071–1102.
[1698]
Leppel, K. (2002), “Similarities and Differences in the College Persistence of
Men and Women,” Review of Higher Education, 25, 433–450. [1706]
Little, R., and Rubin, D. (1987), Statistical Analysis with Missing Data, New
York: Wiley. [1697]
Little, R. J. A. (1995), “Modeling the Drop-Out Mechanism in RepeatedMeasures Studies,” Journal of the American Statistical Association, 90,
1112–1121. [1697]
Lok, J., Gill, R., van der Vaart, A., and Robins, J. (2004), “Estimating the Causal
Effect of a Time-Varying Treatment on Time-to-Event Using Structural
Nested Failure Time Models,” Statistica Neerlandica, 58, 271–295. [1698]
MacKinnon, J. G. (2006), “Bootstrap Methods in Econometrics,” The Economic
Record, 82, S2–S18. [1707]
Manski, C. (1989), “Anatomy of the Selection Problem,” Journal of Human
Resources, 24, 343–360. [1698]
——— (1990), “Nonparametric Bounds on Treatment Effects,” American Economic Review, Papers and Proceedings, 80, 319–323. [1698]

Frölich and Huber: Treatment Evaluation With Multiple Outcome Periods Under Endogeneity and Attrition
Mattei, A., and Mealli, F. (2007), “Application of the Principal Stratification Approach to the Faenza Randomized Experiment on Breast Self-Examination,”
Biometrics, 63, 437–446. [1698]
Mealli, F., Imbens, G., Ferro, S., and Biggeri, A. (2004), “Analyzing a Randomized Trial on Breast Self-Examination With Noncompliance and Missing
Outcomes,” Biostatistics, 5, 207–222. [1697]
Murphy, S., van der Laan, M., and Robins, J. (2001), “Marginal Mean Models
for Dynamic Regimes,” Journal of the American Statistical Association, 96,
1410–1423. [1698]
Peng, Y., Little, R. J. A., and Raghunathan, T. E. (2004), “An Extended General
Location Model for Causal Inferences from Data Subject to Noncompliance
and Missing Values,” Biometrics, 60, 598–607. [1698]
Preisser, J. S., Galecki, A. T., Lohman, K. K., and Wagenknecht, L. E. (2000),
“Analysis of Smoking Trends With Incomplete Longitudinal Binary Responses,” Journal of the American Statistical Association, 95, 1021–1031.
[1698]
Robins, J. (1989), “The Analysis of Randomized and Non-Randomized AIDS
Treatment Trials Using a New Approach to Causal Inference in Longitudinal
Studies,” in Health Service Research Methodology: A Focus on AIDS, eds. L.
Sechrest, H. Freeman, and A. Mulley, Washington, DC: U.S. Public Health
Service, pp. 113–159. [1698]
Robins, J., Greenland, S., and Hu, F.-C. (1999), “Estimation of the Causal Effect
of a Time-Varying Exposure on the Marginal Mean of a Repeated Binary
Outcome,” Journal of the American Statistical Association, 94, 687–700.
[1698]
Robins, J., Rotnitzky, A., and Zhao, L. (1995), “Analysis of Semiparametric Regression Models for Repeated Outcomes in the Presence of Missing Data,” Journal of the American Statistical Association, 90, 106–121.
[1697,1703]
Robins, J. M. (1986), “A New Approach to Causal Inference in Mortality
Studies With a Sustained Exposure Period Application to Control of the
Healthy Worker Survivor Effect,” Mathematical Modelling, 7, 1393–1512.
[1703]
Robins, J. M., Rotnitzky, A., and Zhao, L. (1994), “Estimation of Regression
Coefficients When Some Regressors are not Always Observed,” Journal of
the American Statistical Association, 90, 846–866. [1697]
Rosenbaum, P., and Rubin, D. (1983), “The Central Role of the Propensity
Score in Observational Studies for Causal Effects,” Biometrika, 70, 41–55.
[1700]
Rotnitzky, A., Robins, J., and Scharfstein, D. (1998), “Semiparametric Regression for Repeated Outcomes With Nonignorable Nonresponse,” Journal of
the American Statistical Association, 93, 1321–1339. [1698]
Rubin, D. (1976), “Inference and Missing Data,” Biometrika, 63, 581–592.
[1697,1699]
——— (1977), “Formalizing Subjective Notions About the Effect of Nonrespondents in Sample Surveys,” Journal of the American Statistical Association, 72, 538–543. [1698]

1711

——— (1978), “Multiple Imputations in Sample Surveys—A Phenomenological Bayesian Approach to Nonresponse,” in Proceedings of the Survey
Research Methods Section, American Statistical Association, Alexandria,
VA: ASA, pp. 20–34. [1698]
Scharfstein, D., Rotnitzky, A., and Robins, J. (1999), “Adjusting for Nonignorable Drop-Out Using Semiparametric Nonresponse Models,” Journal of the
American Statistical Association, 94, 1096–1120. [1698,1703]
Semykina, A., and Wooldridge, J. (2010), “Estimating Panel Data Models in
the Presence of Endogeneity and Selection,” Journal of Econometrics, 157,
375–380. [1698]
Shah, A., Laird, N., and Schoenfeld, D. (1997), “A Random-Effects Model
for Multiple Characteristics With Possibly Missing Data,” Journal of the
American Statistical Association, 92, 775–779. [1697]
Shepherd, B. E., Redman, M. W., and Ankerst, D. P. (2008), “Does Finasteride
Affect the Severity of Prostate Cancer? A Causal Sensitivity Analysis,”
Journal of the American Statistical Association, 103, 1392–1404. [1698]
Tan, Z. (2006), “Regression and Weighting Methods for Causal Inference Using
Instrumental Variables,” Journal of the American Statistical Association,
101, 1607–1618. [1700,1703]
Tinto, V. (1997), “Classroom as Communities: Exploring the Educational Character of Student Persistence,” Journal of Higher Education, 68, 599–623.
[1706]
van der Laan, M., and Rubin, D. (2006), “Targeted Maximum Likelihood
Learning,” The International Journal of Biostatistics, 2, article 11, DOI:
10.2202/1557-4679.1043. [1703]
Wang, L., Rotnitzky, A., Lin, X., Millikan, R. E., and Thall, P. F. (2012), “Evaluation of Viable Dynamic Treatment Regimes in a Sequentially Randomized
Trial of Advanced Prostate Cancer,” Journal of the American Statistical
Association, 107, 493–508. [1698]
Xie, H., and Qian, Y. (2012), “Measuring the Impact of Nonignorability in Panel
Data With Non-Monotone Nonresponse,” Journal of the Applied Econometrics, 27, 129–159. [1698,1699,1700,1703]
Yau, L., and Little, R. (2001), “Inference for the Complier-Average Causal Effect
From Longitudinal Data Subject to Noncompliance and Missing Data, With
Application to a Job Training Assessment for the Unemployed,” Journal of
the American Statistical Association, 96, 1232–1244. [1698]
Zhang, J., and Rubin, D. (2003), “Estimation of Causal Effects via Principal
Stratification When Some Outcome are Truncated by Death,” Journal of
Educational and Behavioral Statistics, 28, 353–368. [1698]
Zhang, J., Rubin, D., and Mealli, F. (2008), “Evaluating The Effects of Job
Training Programs on Wages Through Principal Stratification,” in Advances
in Econometrics: Modelling and Evaluating Treatment Effects in Econometrics (vol. 21), eds. D. Millimet, J. Smith, and E. Vytlacil, Amsterdam:
Elsevier Science Ltd, pp. 117–145. [1698]
——— (2009), “Likelihood-Based Analysis of Causal Effects of Job-Training
Programs Using Principal Stratification,” Journal of the American Statistical
Association, 104, 166–176. [1698]

