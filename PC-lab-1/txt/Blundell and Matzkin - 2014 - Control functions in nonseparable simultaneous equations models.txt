Quantitative Economics 5 (2014), 271–295

1759-7331/20140271

Control functions in nonseparable simultaneous
equations models
Richard Blundell
University College London and Institute for Fiscal Studies

Rosa L. Matzkin
University of California—Los Angeles

The control function approach (Heckman and Robb (1985)) in a system of linear
simultaneous equations provides a convenient procedure to estimate one of the
functions in the system using reduced form residuals from the other functions as
additional regressors. The conditions on the structural system under which this
procedure can be used in nonlinear and nonparametric simultaneous equations
has thus far been unknown. In this paper, we define a new property of functions
called control function separability and show it provides a complete characterization of the structural systems of simultaneous equations in which the control
function procedure is valid.
Keywords. Nonseparable models, simultaneous equations, control functions.
JEL classification. C3.

1. Introduction
Economic models of agent’s optimization problems or of interactions among agents often exhibit simultaneity. It is well known that any function in which an explanatory variable is partly determined by the dependent variable of the function cannot be identified
without additional information. Typically this additional information is provided by observable exogenous variables or functional structures.
Consider the identification and estimation of the derivative of the unknown function
m1 with respect to the scalar y2 in the structural model
y1 = m1 (y2  ε1 )
where m1 is strictly increasing in the scalar ε1 and where it is suspected or known that y2
is itself a function of the scalar y1 . One approach to identify this derivative proceeds by
Richard Blundell: r.blundell@ucl.ac.uk
Rosa L. Matzkin: matzkin@econ.ucla.edu
We are grateful to the coeditor, editor, and two referees, Arthur Lewbel, Whitney Newey, Yong Hyeon Yang,
and participants at the Cowles–Cemmap conference in “Advancing Applied Microeconometrics” (Beijing,
August 2010), the Cemmap–Northwestern conference in honor of Joel Horowitz (UCL, July 2011), and the
California Econometrics Conference (USC, September 2011) for helpful comments. The usual disclaimer
applies. Blundell would like to thank the ESRC Centre for the Microeconomic Analysis of Public Policy at
IFS for financial support. Matzkin acknowledges support from NSF Grants SES-1062090 and SES-0833058.
Copyright © 2014 Richard Blundell and Rosa L. Matzkin. Licensed under the Creative Commons
Attribution-NonCommercial License 3.0. Available at http://www.qeconomics.org.
DOI: 10.3982/QE281

272 Blundell and Matzkin

Quantitative Economics 5 (2014)

using an observable scalar instrument, x, independent of ε1 and functionally dependent
with y2 . Newey and Powell (2003), Darolles, Florens, and Renault (2002), Ai and Chen
(2003), Hall and Horowitz (2003), Chernozhukov and Hansen (2005), Chernozhukov, Imbens, and Newey (2007), and Chen and Pouzo (2012) followed this instrumental variable
approach. Identification requires additional conditions on the relationship between y2
and x.1 Estimation requires dealing with the ill-posed inverse problem.
Another approach involves describing the source of simultaneity by specifying some
function m2 and a scalar unobservable ε2 , such that
y2 = m2 (y1  x ε2 )
where m2 is strictly increasing with respect to ε2 and where x is independent of (ε1  ε2 ).
Identification can then be analyzed in terms of conditions on the structural system composed of (m1  m2 ), and the distributions of (ε1  ε2 ) and x. In this discussion all variables
are scalars. Pointwise estimation of the derivative of m1 with respect to y2 can be performed without facing ill-posed inverse problems. Roehrig (1988), Benkard and Berry
(2006), and Matzkin (2008, forthcoming) followed this approach. Identification and estimation require additional restrictions on the structural functions (m1  m2 ) and/or the
density of (ε1  ε2 ).
The control function approach assumes that the simultaneous system can be expressed in the triangular form
y1 = m1 (y2  ε1 )
y2 = s(x η)
where the function s is strictly increasing in the unobservable scalar η and where x is
independent of (ε1  η).2 Identification of various features of this triangular model has
been widely studied under different sets of assumptions, including Newey, Powell, and
Vella (1999), Chesher (2003), Florens et al. (2008), Imbens and Newey (2009), Torgovitsky
(2012), and D’Haultfuille and Fevrier (2012), among others. Conditions for pointwise
identification and estimation of the derivatives of m1 have been derived and again avoid
an ill-posed inverse problem.
Although the control function approach is attractive because of its simplicity, it requires the condition that the simultaneous system can be expressed in a triangular form.
The question we aim to answer is the following: Suppose that we are interested in estimating the function m1 when the structural model is of the form
y1 = m1 (y2  ε1 )
y2 = m2 (y1  x ε2 )
1 See Chen, Chernozhukov, Lee, and Newey (2014) for the most up to date identification results for these
models. See also Hahn and Ridder (2011) regarding identification of models using conditional moment
restrictions.
2 Heckman (1978) referenced the Telser (1964) paper in his comprehensive discussion of estimating simultaneous models with discrete endogenous variables. Blundell and Powell (2003) noted that it is difficult to locate a definitive early reference to the control function version of two-stage least squares (2SLS).
Dhrymes (1970, equation 4.3.57) showed that the 2SLS coefficients can be obtained by a least squares regression of y1 on 
y2 and η
, while Telser (1964) showed how the seemingly unrelated regressions model can
be estimated by using residuals from other equations as regressors in a particular equation of interest.

Quantitative Economics 5 (2014)

Control functions in simultaneous equations

273

and x is independent of (ε1  ε2 ). Under what conditions on m2 can we do this by first
estimating a function for y2 of the type
y2 = s(x η)
and then using η as an additional conditioning variable in the estimation of m1 ?
More specifically, we seek an answer to the question: Under what conditions on m2
it is the case that the simultaneous equations Model (S),
y1 = m1 (y2  ε1 )
y2 = m2 (y1  x ε2 )
with x independent of (ε1  ε2 ), is observationally equivalent to the triangular Model (T),
y1 = m1 (y2  ε1 )
y2 = s(x η)
with x independent of (ε1  η)?
If (S) and (T) are observationally equivalent, then the average structural function of
1
m , defined by Blundell and Powell (2003) as

G(y2 ) = m1 (y2  ε1 )fε1 (ε1 ) dε1 
can be derived from the distribution of (Y1  Y2  X) as

G(y2 ) = E(Y1 |Y2 = y2  T = t)fT (t) dt
where
T = FY2 |X (Y2 )
The local average response function, defined by Altonji and Matzkin (2005) as

β(y2 ) =

∂m1 (y2  ε1 )
fε1 |Y2 =y2 (ε1 ) dε1 
∂y2

can be derived from the distribution of (Y1  Y2  X) as

∂E(Y1 |Y2 = y2  T = t)
β(y2 ) =
fT |Y2 =y2 (t) dt
∂y2
where T is as defined above. The quantile structural function, defined by Imbens and
Newey (2009) for the τth quantile of ε1 , qε1 (τ), as

 

r 1 (y1  y2 ) = Pr m1 Y2  qε1 (τ) ≤ y1 |Y2 = y2 

274 Blundell and Matzkin

Quantitative Economics 5 (2014)

can be derived from the distribution of (Y1  Y2  X) by

r 1 (y1  y2 ) =

Pr(Y1 ≤ y1 |Y2 = y2  T = t)fT (t) dt

The derivative of m1 at (y2  ε1 ) for ε1 = r 1 (y1  y2 ) can be derived from the distribution of
(Y1  Y2  X), following Chesher (2003), by

−1

∂FY1 |Y2 =y2 T =t (y1 ) 
∂m1 (y2  ε1 )
=

∂y2
∂y1
t=FY2 |X=x (y2 )



∂FY1 |Y2 =y2 T =t (y1 ) 
×

∂y2
t=FY |X=x (y2 )
2

or, in terms of the distribution of the observable variables,
∂m1 (y2  ε1 )
∂y2
 


∂FY1 |Y2 =y2 X=x (y1 ) −1 ∂FY1 |Y2 =y2 X=x (y1 )
=−
∂y1
∂y2
−1 


∂FY1 |Y2 =y2 X=x (y1 )
∂FY1 |Y2 =y2 X=x (y1 )
+
∂y1
∂x

−1 

∂FY2 |X=x (y2 )
∂FY2 |X=x (y2 )

×
∂x
∂y2
In what follows, we first define a new property of functions, control function separability. This is a condition that states that y1 is weakly separable from x in the structural
inverse function r 2 . We then show, in Section 3, that this property completely characterizes systems of simultaneous equations where a function of interest can be estimated using a control function. This condition is satisfied by simultaneous linear models with additive errors. In nonlinear models, this condition should be checked, since it is a strong
assumption, and if it is not satisfied, estimation using a control function approach may
be severely inconsistent. Roughly, the condition states that the structural unobservable
random term, ε2 , in the second equation of the simultaneous equations system can be
represented as a function of the reduced form unobservable random term, η, in the second equation of the triangular system and the unobservable random term, ε1 , in the
first equation of the simultaneous equations system. An example of a utility function
whose system of demand functions satisfies control function separability is presented
in Section 4. In Section 5, we describe how to extend our results to limited dependent
variable models with simultaneity in latent or observable continuous variables. The Appendix provides conditions in terms of the derivatives of the structural functions in the
system and conditions in terms of restrictions on the reduced form system. Section 6
concludes.

Quantitative Economics 5 (2014)

Control functions in simultaneous equations

275

2. Assumptions and definitions
2.1 The structural model and control function separability
We consider the structural model
Model (S)

y1 = m1 (y2  ε1 )
y2 = m2 (y1  x ε2 )

with y1  y2  x ε1  ε2 ∈ R, satisfying the following assumptions.
Assumption S.1 (Differentiability). For all values (y1  y2  x ε1  ε2 ) of (Y1  Y2  X ε1  ε2 )
in R5 , the functions m1 and m2 are continuously differentiable.
Assumption S.2 (Independence). The vector (ε1  ε2 ) is distributed independently of X.
Assumption S.3 (Support). Conditional on any value x of X, the densities of (ε1  ε2 )
and of (Y1  Y2 ) are continuous and have convex support.
Assumption S.4 (Monotonicity). For all values y2 of Y2 in R, the function m1 is strictly
monotone in ε1 , and for all values (y1  x) of (Y1  X) in R2 , the function m2 is strictly
monotone in ε2 .
Assumption S.5 (Crossing). For all values (y1  y2  x ε1  ε2 ) of (Y1  Y2  X ε1  ε2 ) in R5 ,
(∂m1 (y2  ε1 )/∂y2 )(∂m2 (y1  x ε2 )/∂y1 ) < 1.
The technical assumptions (Assumptions S.1–S.3) can be partially relaxed at the cost
of making the presentation more complex. Depending on the object of interest, the continuous differentiability in Assumption S.1 may be satisfied only on a particular neighborhood of the support of the variables. The independence condition in Assumption S.2
may be satisfied only conditionally on some external variable. For example, if for a variable Z, the conditional density of (Y1  Y2  X) given Z = z is identified, and if (ε1  ε2 )
is independent of X conditional on Z = z, then our results can be extended to such a
situation. In many situations, the continuity of the densities of (Y1  Y2 ) and of (ε1  ε2 )
given X = x may be required to hold only on some neighborhoods of the supports of the
variables.
Assumption S.3 is a weakening of the full support condition in Matzkin (2008). Assumption S.4 guarantees that the function m1 can be inverted in ε1 and that the function
m2 can be inverted in ε2 . Hence, this assumption allows us to express the direct system
of structural equations (S), defined by (m1  m2 ), in terms of a structural inverse system
(I) of functions (r 1  r 2 ), which map any vector of observable variables (y1  y2  x) into the
vector of unobservable variables (ε1  ε2 ):
Model (I)

ε1 = r 1 (y1  y2 )
ε2 = r 2 (y1  y2  x)

Assumption S.5 is a weakening of the common situation where the value of the endogenous variables is determined by the intersection of a downward and an upward

276 Blundell and Matzkin

Quantitative Economics 5 (2014)

slopping function. Together with Assumption S.4, this assumption guarantees the existence of a unique value for (y1  y2 ), given any X = x. In other words, these assumptions
guarantee the existence of a reduced form system (R) of equations, defined by functions
(h1  h2 ), that map the vector of exogenous variables (ε1  ε2  x) into the vector of endogenous variables (y1  y2 ):
y1 = h1 (x ε1  ε2 )

Model (R)

y2 = h2 (x ε1  ε2 )
These assumptions also guarantee that the reduced form function h1 is monotone
increasing in ε1 and the reduced form function h2 is monotone increasing in ε2 . These
results are established in Lemma 1 below.
Lemma 1. Suppose that Model (S) satisfies Assumptions S.1–S.5. Then there exist unique
functions h1 and h2 that represent Model (S). Moreover, for all x, ε1 , ε2 , h1 and h2 are
continuously differentiable, ∂h1 (x ε1  ε2 )/∂ε1 > 0, and ∂h2 (x ε1  ε2 )/∂ε2 > 0.
Proof. Assumption S.4 guarantees the existence of the structural inverse system (I) of
differentiable functions (r 1  r 2 ) that satisfy


y1 = m1 y2  r 1 (y1  y2 ) 


y2 = m2 y1  x r 2 (y1  y2  x) 
By Assumption S.1, we can differentiate these equations with respect to y1 and y2 to get
⎞
⎛
∂m1 ∂r 1
∂m1 ∂m1 ∂r 1
+
⎜
∂ε1 ∂y1
∂y2
∂ε1 ∂y2 ⎟
1 0
⎜
⎟
=⎜
⎟
0 1
⎝ ∂m2 ∂m2 ∂r 2
⎠
∂m1 ∂r 2
+
∂y1
∂ε2 ∂y1
∂ε2 ∂y2
Hence, ∂r 1 /∂y1 = (∂m1 /∂ε1 )−1 , ∂r 2 /∂y2 = (∂m2 /∂ε2 )−1 , ∂r 1 /∂y2 = −(∂m1 /∂ε1 )−1 ×
(∂m1 /∂y2 ), and ∂r 2 /∂y1 = −(∂m2 /∂ε2 )−1 (∂m2 /∂y1 ). These expressions together with Assumptions S.4 and S.5 imply that ∂r 1 /∂y1 > 0, ∂r 2 /∂y2 > 0, and (∂r 1 /∂y2 )(∂r 2 /∂y1 ) <
(∂r 1 /∂y1 )(∂r 2 /∂y2 ). Hence the determinants of all principal submatrices of the Jacobian
matrix
⎛
⎞
∂r 1 (y1  y2 )
∂r 1 (y1  y2 )
⎜
⎟
∂y1
∂y2
⎜
⎟
⎝ ∂r 2 (y  y  x) ∂r 2 (y  y  x) ⎠
1

∂y1

2

1

2

∂y2

of (r 1  r 2 ) with respect to (y1  y2 ) are positive. It follows by Gale and Nikaido (1965) that
there exist unique functions (h1  h2 ) such that for all (ε1  ε2 ),


ε1 = r 1 h1 (x ε1  ε2 ) h2 (x ε1  ε2 ) 


ε2 = r 2 h1 (x ε1  ε2 ) h2 (x ε1  ε2 ) x 

Quantitative Economics 5 (2014)

Control functions in simultaneous equations

277

We have then established the existence of the reduced form system (R). The implicit
function theorem implies by Assumption S.1 that h1 and h2 are continuously differentiable. Moreover, the Jacobian matrix of (h1  h2 ) with respect to (ε1  ε2 ) is the inverse of
the Jacobian matrix of (r 1  r 2 ) with respect to (y1  y2 ). Assumptions S.4 and S.5 then imply that for all x, ε1 , ε2 , ∂h1 (x ε1  ε2 )/∂ε1 > 0 and ∂h2 (x ε1  ε2 )/∂ε2 > 0. This completes
the proof of Lemma 1.

We next define a new property, which we call control function separability.
Definition 1. Let (Y1 × Y2 × X ) denote the support of (y1  y2  x). A structural inverse
system of equations (r 1 (y1  y2 ) r 2 (y1  y2  x)) satisfies control function separability if there
exist functions q : R2 → R and v : R2 → R such that for all (y1  y2  x) ∈ (Y1 × Y2 × X ),
(a) r 2 (y1  y2  x) = v(q(y2 x) r 1 (y1  y2 )),
(b) q is strictly increasing in its first argument, and
(c) v is strictly increasing in its first argument.
Control function separability is weaker than the standard triangular specification,
where the unobservable variable in the second structural equation, ε2 , is determined
only by y2 and x. Control function separability allows this unobservable variable, ε2 , to
be determined by y1 as well as by y2 and x. However, the way in which y1 affects the
value of ε2 is very limited. The dependent variable y1 in the first structural equation can
determine the value of the unobservable variable ε2 in the second equation only through
a function of (y1  y2 ), which is the same function through which (y1  y2 ) determine the
value of ε1 . In other words, in control function separability, y1 determines the value of
ε2 only weakly, through the effect of y1 on ε1 and that of ε1 on ε2 .
2.2 The triangular model and observational equivalence
We consider triangular models of the form
Model (T)

y1 = m1 (y2  ε1 )
y2 = s(x η)

with y1  y2  x ε1  η ∈ R, satisfying the following assumptions.
Assumption T.1 (Differentiability). For all values of (y1  y2  x ε1  η) of (Y1  Y2  X ε1  η)
in R5 , the functions m1 and s are continuously differentiable.
Assumption T.2 (Independence). The vector (ε1  η) is distributed independently of X.
Assumption T.3 (Support). Conditional on any value x of X, the densities of (ε1  η) and
of (Y1  Y2 ) are continuous and have convex support.
Assumption T.4 (Monotonicity). For all values of y2 , the function m1 is strictly monotone in ε1 , and for all values of x, the function s is strictly monotone in η.

278 Blundell and Matzkin

Quantitative Economics 5 (2014)

Using the standard definition of observational equivalence, we say that Model (S) is
observationally equivalent to Model (T) if the distributions of the observable variables
generated by each of these models is the same.
Definition 2. Model (S) is observationally equivalent to model (T) if and only if for all
y1 , y2 , x such that fX (x) > 0,
fY1 Y2 |X=x (y1  y2 ; S) = fY1 Y2 |X=x (y1  y2 ; T )
In the next section, we establish that control function separability completely characterizes observational equivalence between Model (S) and Model (T).
3. Characterization of observational equivalence and
control function separability
Our characterization theorem is the following.
Theorem 1. Suppose that Model (S) satisfies Assumptions S.1–S.5 and Model (T) satisfies
Assumptions T.1–T.4. Then Model (S) is observationally equivalent to Model (T) if and
only if the inverse system of equations (r 1 (y1  y2 ) r 2 (y1  y2  x)) derived from (S) satisfies
control function separability.
Proof. Suppose that Model (S) is observationally equivalent to Model (T). Then, for all
y1 , y2 , x such that fX (x) > 0,
fY1 Y2 |X=x (y1  y2 ; S) = fY1 Y2 |X=x (y1  y2 ; T )
Consider the transformation
ε1 = r 1 (y1  y2 )
y2 = y2 
x = x
The inverse of this transformation is
y1 = m1 (y2  ε1 )
y2 = y2 
x = x
Hence, the conditional density of (ε1  y2 ) given X = x, under Model (T) and under
Model (S) are, respectively,
fε1 Y2 |X=x (ε1  y2 ; T ) = fY1 Y2 |X=x



 ∂m1 (y2  ε1 ) 


m (y2  ε1 ) y2 ; T 

∂ε



1

1

Quantitative Economics 5 (2014)

Control functions in simultaneous equations

279

and


 1
 ∂m1 (y2  ε1 ) 


fε1 Y2 |X=x (ε1  y2 ; S) = fY1 Y2 |X=x m (y2  ε1 ) y2 ; S 

∂ε1
In particular, for all y2 , all x such that fX (x) > 0, and for ε1 = r 1 (y1  y2 ),
fY2 |ε1 =r 1 (y1 y2 )X=x (y2 ; T ) = fY2 |ε1 =r 1 (y1 y2 )X=x (y2 ; S)

(T1.1)

That is, the distribution of Y2 conditional on ε1 = r 1 (y1  y2 ) and X = x, generated by
either Model (S) or Model (T), must be the same. By Model (T), the conditional distribution of Y2 conditional on (ε1  X) = (r 1 (y1  y2 ) x) can be expressed as


Pr Y2 ≤ y2 |ε1 = r 1 (y1  y2 ) X = x


= Pr s(x η) ≤ y2 |ε1 = r 1 (y1  y2 ) X = x


= Pr η ≤
s(y2  x)|ε1 = r 1 (y1  y2 ) X = x


= Fη|ε1 =r 1 (y1 y2 ) 
s(y2  x) 
where
s denotes the inverse of s with respect to η. The existence of
s and its strict monotonicity with respect to y2 is guaranteed by Assumption T.4. The last equality follows
because Assumption T.2 implies that conditional on ε1 , η is independent of X. On the
other side, by Model (S), we have that


Pr Y2 ≤ y2 |ε1 = r 1 (y1  y2 ) X = x


= Pr h2 (x ε1  ε2 ) ≤ y2 |ε1 = r 1 (y1  y2 ) X = x


= Pr ε2 ≤ 
h2 (x ε1  y2 )|ε1 = r 1 (y1  y2 ) X = x




= Pr ε2 ≤ r 2 m1 (y2  ε1 ) y2  x |ε1 = r 1 (y1  y2 ) X = x
 

= Fε2 |ε1 =r 1 (y1 y2 ) r 2 m1 (y2  ε1 ) y2  x 
where 
h2 denotes the inverse of h2 with respect to ε2 . The existence of 
h2 and its
strict monotonicity with respect to y2 follows by Lemma 1. The third equality follows because of the uniqueness of equilibrium. At equilibrium, conditional on X = x,
(y1  y2 ) is mapped into (ε1  ε2 ) = (r 1 (y1  y2 ) r 2 (y1  y2  x)), and (ε1  ε2 ) is mapped into
(h1 (x ε1  ε2 ) h2 (x ε1  ε2 )). In other words, along the curve of all the values (y1  y2 ) for
which ε1 = r 1 (y1  y2 ), the value of r 2 (y1  y2  x) is equal to ε2 only when (y1  y2 ) = (y1  y2 ).
Similarly, when ε1 and y2 are given, the only values of ε2 and y1 for which


y2 = h2 x ε1  ε2 


ε1 = r 1 y1  y2
are (ε2  y1 ) = (ε2  y1 ) = (r 2 (y1  y2  x) m1 (y2  ε1 )). But then, because of the strict monotonicity of h2 (x ε1  ε2 ) in ε2 , it must be that, given ε1 and y2 , ε2 = 
h2 (x ε1  y2 ) =
2
1
2
2
1
r (y1  y2  x). Substituting y1 = m (y2  ε1 ), we get that 
h (x ε1  y2 ) = r (m (y2  ε1 ) y2  x),

280 Blundell and Matzkin

Quantitative Economics 5 (2014)

which shows that the third equality is satisfied. The last equality follows because Assumption S.2 implies that conditional on ε1 , ε2 is independent of X.
Equating the expressions that we got for Pr(Y2 ≤ y2 |ε1 = r 1 (y1  y2 ) X = x) from
Model (T) and from Model (S), we can conclude that for all y2 , x, ε1 ,


 

s(y2  x) 
Fε2 |ε1 =r 1 (y1 y2 ) r 2 m1 (y2  ε1 ) y2  x = Fη|ε1 =r 1 (y1 y2 ) 

(T1.2)

Substituting m1 (y2  ε1 ) by y1 , we get that for all y1 , y2 , x,




s(y2  x) 
Fε2 |ε1 =r 1 (y1 y2 ) r 2 (y1  y2  x) = Fη|ε1 =r 1 (y1 y2 ) 
Note that the distribution of ε2 conditional on ε1 can be expressed as an unknown
function G(ε2  ε1 ) of two arguments. Analogously, the distribution of η conditional
on ε1 can be expressed as an unknown function H(η ε1 ). Denote the (possibly infi2  ε2 ], and denote the (possinite) support of ε2 conditional on ε1 = r 1 (y1  y2 ) by [εL
U
bly infinite) support of η conditional on ε1 = r 1 (y1  y2 ) by [ηL  ηU ]. Our Assumptions
2  ε2 ]
S.2 and S.3 imply that the distribution Fε2 |ε1 =r 1 (y1 y2 ) (·) is strictly increasing on [εL
U
2  ε2 ] onto [0 1]. Our Assumptions T.2 and T.3 imply that the distribution
and maps [εL
U
Fη|ε1 =r 1 (y1 y2 ) (·) is strictly increasing in [ηL  ηU ] and maps [ηL  ηU ] onto [0 1]. Hence,
(T1.1) and our assumptions imply that there exists a function 
s, strictly increasing in its
second argument, and functions G(ε2  ε1 ) and H(η ε1 ), such that for all y1 , y2 , x with
fX (x) > 0 and fY1 Y2 |X=x (y1  y2 ) > 0,




s(y2  x) r 1 (y1  y2 ) 
G r 2 (y1  y2  x) r 1 (y1  y2 ) = H 
and such that G and H are both strictly increasing in their first arguments at, respec denote the inverse of G with respect to its
s(y2  x). Let G
tively, ε2 = r 2 (y1  y2  x) and η =
2  ε2 ] is strictly increasing on (0 1) and
1

first argument. Then G(· r (y1  y2 )) : [0 1] → [εL
U
 


 H
s(y2  x) r 1 (y1  y2 )  r 1 (y1  y2 ) 
r 2 (y1  y2  x) = G
This implies that r 2 is weakly separable into r 1 (y1  y2 ) and a function of (y2  x), strictly in are both strictly increasing with respect to their
creasing in y2 . Moreover, since H and G
first argument on their respective relevant domains, r 2 must be strictly increasing in the
value of 
s. We can then conclude that (T1.1), and hence also the observational equivalence between Model (T) and Model (S), implies that (r 1 (y1  y2 ) r 2 (y1  y2  x)) satisfies
control function separability.
To show that control function separability implies the observational equivalence
between Model (S) and Model (T), suppose that Model (S), satisfying Assumptions
S.1–S.5, is such that there exist functions q : R2 → R and v : R2 → R such that for all
(y1  y2  x) ∈ (Y1 × Y2 × X ),


r 2 (y1  y2  x) = v q(y2  x) r 1 (y1  y2 ) 
where on (Y2 × X ), q is strictly increasing in its first argument, and for each for each
(y1  y2  x) ∈ (Y1 × Y2 × X ) v(q(y2  x) r 1 (y1  y2 )) is strictly increasing in q(y2  x).

Quantitative Economics 5 (2014)

Control functions in simultaneous equations

281

Let ε1 = r 1 (y1  y2 ) and η = q(y2  x). Then
ε2 = r 2 (y1  y2  x) = v(η ε1 )
v denote the inverse of v with respect to η, it
where v is strictly increasing in η. Letting 
follows that
q(y2  x) = η = 
v(ε2  ε1 )
Since 
v is strictly increasing in ε2 , Assumption S.3 implies that (ε1  η) has a continuous density on a convex support. Let 
q denote the inverse of q with respect to y2 . The
function 
q exists because q is strictly increasing in y2 . Then


q(η x) = 
q
v(ε2  ε1 ) x 
y2 = 
Since η is a function of (ε1  ε2 ), Assumption S.2 implies Assumption T.2. Since also
y2 = h2 (x ε1  ε2 )
it follows that


q
v(ε2  ε1 ) x 
y2 = h2 (x ε1  ε2 ) = 
where 
q is strictly increasing with respect to its first argument. Hence,
q(η x)
y2 = h2 (x ε1  ε2 ) = 
where 
q is strictly increasing in η. This implies that control function separability implies
that the system composed of the structural form function for y1 and the reduced form
function for y2 is of the form
y1 = m1 (y2  ε1 )



q
v(ε2  ε1 ) x = 
q(η x)
y2 = h2 (x ε1  ε2 ) = 

where 
q is strictly increasing in η and (ε1  η) is independent of X. To show that the
model generated by (m1  h2 ) is observationally equivalent to the model generated by
(m1 
q), we note that the model generated by (m1  h2 ) implies that for all x such that
fX (x) > 0,
fY1 Y2 |X=x (y1  y2 ; S)



= fε1 ε2 r 1 (y1  y2 ) r 2 (y1  y2  x) ry11 ry22 − ry12 ry21 
where ry11 = ry11 (y1  y2 ) defines the partial derivative of r 1 with respect to its first argument.
Similarly ry22 = ry22 (y1  y2  x), ry12 = ry12 (y1  y2 ), and ry21 = ry21 (y1  y2  x). On the other side, for
the model generated by (m1 
q), we have that
fY1 Y2 |X=x (y1  y2 ; T )



= fε1 η r 1 (y1  y2 )
v r 2 (y1  y2  x) r 1 (y1  y2 )
  2

 2

v 1 r y2 + 
v1 r y1 + 
× ry11 
v2 ry12 − ry12 
v2 ry11 

282 Blundell and Matzkin

Quantitative Economics 5 (2014)

where 
v1 denotes the derivative of 
v with respect to its first coordinate and 
v2 denotes
the derivative of 
v with respect to its second coordinate. Since
 1 2



 2

r 
v1 ry11 ry22 − ry12 ry21 
v1 r y1 + 
v2 ry12 − ry12 
v2 ry11  = 
y1 v 1 r y2 + 
and



  2
fε2 |ε1 =r 1 (y1 y2 ) r 2 (y1  y2  x) = fη|ε1 =r 1 (y1 y2 ) 
v1 
v r (y1  y2  x) r 1 (y1  y2 ) 
it follows that for all x such that fX (x) > 0,
fY1 Y2 |X=x (y1  y2 ; S) = fY1 Y2 |X=x (y1  y2 ; T )
Hence, control function separability implies that Model (S) is observationally equivalent
to Model (T). This completes the proof of Theorem 1.

Theorem 1 provides a characterization of two-equation systems with simultaneity
where one of the functions can be estimated using the other to derive a control function. One of the main conclusions of the theorem is that to verify whether one of the
equations can be used to derive a control function, it must be that the inverse function
of that equation, which maps the observable endogenous and observable exogenous
variables into the value of the unobservable, must be separable into the inverse function of the first equation and a function not involving the dependent variable of the first
equation. That is, the function
y2 = m2 (y1  x ε2 )
can be used to derive a control function to identify the function m1 , where
y1 = m1 (y2  ε1 )
if and only if the inverse function of m2 with respect to ε2 is separable into r 1 and a
function of y2 and x.
3.1 Alternative characterizations
An alternative characterization of systems where one of the functions can be estimated
using a control function approach can be given in terms of the derivatives of the functions of Models (T) and (S). Let rx2 = ∂r 2 (y1  y2  x)/∂x, ry21 = ∂r 2 (y1  y2  x)/∂y1 , and ry22 =
∂r 2 (y1  y2  x)/∂y2 denote the derivatives of r 2 , let sx = ∂s(y2  x)/∂x and sy2 = ∂s(y2  x)/∂y2
denote the derivatives of s, and let m1y2 = ∂m1 (y2  ε1 )/∂y2 denote the derivative of the
function of interest m1 with respect to the endogenous variable y2 . The following theorem, whose proof is presented in the Appendix, provides one such characterization.
Theorem 2. Suppose that Model (S) satisfies Assumptions S.1–S.5 and that Model (T)
satisfies Assumptions T.1–T.4. Then Model (S) is observationally equivalent to Model (T)
if and only if for all x, y1 , y2 ,
rx2
2
1
ry1 my2 + ry22

=

sx

sy2

Quantitative Economics 5 (2014)

Control functions in simultaneous equations

283

In the Appendix, we show that in terms of the derivatives of the inverse system of
structural equations of Model (S), the condition in Theorem 2 implies that
ry11 (y1  y2 )rx2 (y1  y2  x)
∂
log
∂y1
|ry (y1  y2  x)|

= 0

Another alternative characterization, which follows from the proof of Theorem 1, is
in terms of the reduced form functions. Suppose we ask when the function
y2 = m2 (y1  x ε2 )
can be used to derive a control function to identify the function m1 , where
y1 = m1 (y2  ε1 )
Our arguments show that the control function approach can be used if and only if the
reduced form function, h2 (x ε1  ε2 ), for y2 can be expressed as a function of x and a
function of (ε1  ε2 ). That is, the control function approach can be used if and only if, for
some functions s and 
v,


v(ε1  ε2 ) 
h2 (x ε1  ε2 ) = s x
Note that while the sufficiency of such a condition is obvious, the necessity, which follows from Theorem 1, had not been previously known.3
4. An example
We next provide two examples in the context of a consumer optimization problem with
unobserved heterogeneity. In the first example, the utility is such that the first order
conditions for maximization satisfy control function separability. In the second example, control function separability is not satisfied. In both examples, the utility function,
U(ε1  ε2  y1  y2  y3 ), for goods y1 , y2 , and y3 , and for a consumer with unobservable taste
(ε1  ε2 ) > 0 has the recursive structure
U(ε1  ε2  y1  y2  y3 ) = V (ε1  ε2  y2 ) + W (ε1  y1  y2 ) + y3 
where the unknown functions V (ε1  ε2  ·) and W (ε1  · ·) are such that U(ε1  ε2  · · y3 ) is
strictly increasing and strictly concave in (y1  y2 ). The typical consumer, characterized
by (ε1  ε2 ), chooses the quantity of (y1  y2  y3 ) by maximizing U(ε1  ε2  y1  y2  y3 ) subject
the linear budget constraint, x1 y1 + x2 y2 + y3 ≤ x3 , where x1 and x2 denote the prices of,
respectively, one unit of y1 and y2 , and where x3 denotes the income of the consumer
The price of a unit of the third good is normalized to 1. Since U(ε1  ε2  · · ·) is strictly
3 Kasy (2010) also highlighted the one-dimensional distribution condition on the reduced form h2 , but
did not relate this to restrictions on the structure of the simultaneous equation system (S), which is our
primary objective.

284 Blundell and Matzkin

Quantitative Economics 5 (2014)

increasing in (y1  y2  y3 ), the optimal quantities satisfy the budget constraint with equality. Substituting y3 = x3 − y1 x1 − y2 x2 , we get that the optimal quantities of (y1  y2 ) must
maximize the unconstrained function
U(ε1  ε2  y1  y2  x1  x2  x3 )
= V (ε1  ε2  y2 ) + W (ε1  y1  y2 ) − y1 x1 − y2 x2 + x3 
To provide an example where control function separability is satisfied, we let u(·) denote
a strictly increasing and strictly concave function, and specify
V (ε1  ε2  y2 ) = (ε1 + ε2 )u(y2 )
and


W (ε1  y1  y2 ) = ε1 log y1 − u(y2 ) 
The first order conditions with respect to y1 and y2 for maximization of
U(ε1  ε2  y1  y2  x1  x2  x3 )



= (ε1 + ε2 )u(y2 ) + ε1 log y1 − u(y2 ) − y1 x1 − y2 x2 + x3

are
∂
:
∂y1

ε1
− x1 = 0
(y1 − u(y2 ))

∂
:
∂y2

(ε1 + ε2 )u (y2 ) − u (y2 )

(4.1)
ε1
− x2 = 0
(y1 − u(y2 ))

(4.2)

The Hessian of the objective function is
⎡
⎤
ε1 u (y2 )
−ε1
⎢ (y − u(y ))2
⎥
(y1 − u(y2 ))2
2
⎥
⎢ 1
⎥
⎢


⎦
⎣ ε1 u (y2 )
ε1
ε
2
1


ε1 + ε2 −
u (y2 ) − u (y2 )
2
2
(y
−
u(y
))
(y1 − u(y2 ))
(y1 − u(y2 ))
1
2
This Hessian is negative definite when ε1 > 0, u (y2 ) > 0, u (y2 ) < 0, and
ε1 + ε2 −

ε1
(y1 − u(y2 ))

> 0

Since at the values of (y1  y2 ) that satisfy the first order conditions, ε1 /(y1 − u(y2 )) =
x1 and (ε1 + ε2 − (ε1 /(y1 − u(y2 ))))u (y2 ) = x2 , the objective function is strictly concave at
values of (y1  y2 ) that satisfy the first order conditions as long as x1 > 0 and x2 > 0. Since
the demanded quantities for (y1  y2 ) are optimal, they satisfy the simultaneous system
of equations given by the first order conditions. To express those conditions in the form
of an indirect system of equations, Note that from (4.1), we get


(4.3)
ε1 = y1 − u(y2 ) x1 

Quantitative Economics 5 (2014)

285

Control functions in simultaneous equations

and using (4.3) in (4.2), we get


(ε1 + ε2 ) − x1 u (y2 ) = x2 

(4.4)

Hence,
ε2 =
=

x2
− y1 x1 + u(y2 )x1 + x1
u (y2 )
x2
u (y2 )



+ x1 − y1 − u(y2 ) x1 

We can then easily see that the resulting system of structural equations, which is


ε1 = y1 − u(y2 ) x1 
ε2 =

x2

u (y2 )



+ x1 − y1 − u(y2 ) x1 

satisfies control function separability. The triangular system of equations, which can
then be estimated using a control function for nonseparable models, is
y1 = u(y2 ) +

ε1

x1

 −1
y2 = u 

x2

ε1 + ε2 − x1

The unobservable η = ε1 + ε2 is the control function for y2 in the equation for y1 .
Conditional on η = ε1 + ε2 , y2 is a function of only (x1  x2 ), which is independent of ε1 .
Hence, conditional on η = ε1 + ε2 , y2 is independent of ε1 , exactly the conditions one
needs to use η as the control function in the estimation of the equation for y1 .
To modify the example so that control function separability is not satisfied, suppose
that V is specified as above but W is instead given by
W (ε1  y1  y2 ) = ε1 w(y1  y2 )
for a strictly increasing and strictly concave function w. The first order conditions for
optimization become
∂
:
∂y1

ε1 wy1 (y1  y2 ) − x1 = 0

(4.5)

∂
:
∂y2

(ε1 + ε2 )u (y2 ) + ε1 wy2 (y1  y2 ) − x2 = 0

(4.6)

The system of simultaneous equations that (y1  y2 ) satisfies can then be expressed as
ε1 =

x1
wy1 (y1  y2 )

(4.7)

ε2 =



wy2 (y1  y2 )
x2
1
+
−
ε

1
u (y2 )
u (y2 )

(4.8)

and

286 Blundell and Matzkin

Quantitative Economics 5 (2014)

Unless −wy2 (y1  y2 )/wy1 (y1  y2 ) = u (y2 ), as in the previous example, in general, control
function separability will not be satisfied.
5. Simultaneity in latent variables
Our results can be applied to models with simultaneity in continuous latent variables.
These are the models with “no structural shifts” in Heckman (1978), which do not allow
for explanatory variables that are dummy endogenous variables. More specifically, our
results can be applied in simultaneous equations models specified as


y1∗ = m1 y2∗  ε1 
(5.1)


y2∗ = m2 y1∗  x ε2 
where instead of observing (y1∗  y2∗ ), one observes a transformation, (y1  y2 ), of (y1∗  y2∗ )
defined by a known vector function (T1  T2 ):


y1 = T1 y1∗  y2∗ 
(5.2)


y2 = T2 y1∗  y2∗ 
Suppose that m1 and m2 satisfy Assumptions S.1–S.5 and also control function separability. Then, by Theorem 1, (5.1) can be written equivalently as the triangular model


y1∗ = m1 y2∗  ε1 
y2∗ = s(x η)
satisfying Assumptions T.1–T.4. Identification in the model


y1 = T1 y1∗  y2∗ 


y2 = T2 y1∗  y2∗ 


y1∗ = m1 y2∗  ε1 

(5.3)

y2∗ = s(x η)
can then be analyzed using known techniques for models with latent variables and triangularity.
To provide an example, consider the binary response model with simultaneity,
y1∗ = g(y2 ) − ε1 


y2 = Λ βy1∗ + γx + ε2 

1 if y1∗ ≥ 0
y1 =
0 otherwise
where only the random vector (y1  y2  x), whose support is {0 1} × R2 , is observed, where
Λ is strictly increasing, and where the functions g and Λ and the parameters β and γ are

Quantitative Economics 5 (2014)

Control functions in simultaneous equations

287

unknown. Usually in this model one is interested in objects such as the probability that
y1 = 1 when ε1 is assumed to be distributed with its marginal distribution (Blundell and
Powell (2004)) or the derivative of the probability that y1 = 1 with respect to y2 when the
distribution of ε1 conditional on y2 is kept unchanged (Altonji and Matzkin (2005)). In an
empirical application in Blundell and Powell (2004), y1∗ is the hours of work of one of the
spouses in a household and y2 is the income of the other spouse. The family makes the
joint decision of (y1∗  y2 ). Assume that the function Λ−1 (y2 ) − βg(y2 ) is strictly increasing
in y2 , and that Assumptions S.1–S.5 are satisfied. Then the system
y1∗ = g(y2 ) − ε1 


y2 = Λ βy1∗ + γx + ε2
satisfies control function separability. To see this, note that the random variable ε2 in
this system is determined by the function




ε2 = Λ−1 (y2 ) − βg(y2 ) − γx + β g(y2 ) − y1∗ 
which is separable into the function [Λ−1 (y2 ) − βg(y2 ) − γx] and the function β(g(y2 ) −
y1∗ ). It then follows by Theorem 1 that the system is observationally equivalent to a triangular system
y1∗ = g(y2 ) − ε1 
y2 = s(x η)
satisfying Assumptions T.1–T.4. Given the distribution of η or of (η y2 ) (Matzkin (2003),
Imbens and Newey (2009)), one can obtain the probability that Y1 = 1 when Y2 = y2 and
ε1 is distributed with its marginal distribution as



Fε1 g(y2 ) = Pr(Y1 = 1|Y2 = y2  η = t)fη (t) dt
The derivative with respect to y2 of the probability that y1 = 1 when the conditional distribution of ε1 stays fixed can be calculated as

∂Fδ (g(y2 ))
∂ Pr(Y1 = 1|Y2 = y2  η = t)
=
fη|Y2 =y2 (t) dt
∂y2
∂y2
where δ denotes a random term that has the same distribution as that of ε1 conditional
on Y2 = y2 . (See Blundell and Powell (2004) and Altonji and Matzkin (2005) for details.)
Alternatively, one can employ our results to identify g or its derivative with respect to
y2 separately from the distribution of ε1 by first identifying the distribution of the latent
variables and then proceeding with that distribution as if the latent variables were observed. For single equation binary response models, with all the explanatory variables
being independent of the unobservable ε1 , the conditions under which such a procedure can be done were given in Cosslett (1983) for linear in parameters g and in Matzkin
(1992) for nonparametric g. Matzkin (1992) showed pointwise identification of g under shape restrictions on g, such as homogeneity of degree 1 or additivity, and without

288 Blundell and Matzkin

Quantitative Economics 5 (2014)

requiring large support conditions. Matzkin and Newey (1993) used the conditions in
Matzkin (1992) to develop an estimator that followed the two step procedure. Still under
independence conditions, Briesch, Chintaguna, and Matzkin (2010) considered binary
response models with nonparametric random functions g. Identification in more general limited dependent variable models, under conditional independence, rather than
full independence, and with linear in parameters g, were developed in Lewbel (2000),
using a large support regressor.
Consider models with simultaneity,


y1∗ = m1 y2∗  ε1 


y2∗ = m2 y1∗  x ε2 
where instead of observing (y1∗  y2∗ ), one observes a transformation, (y1  y2 ), of (y1∗  y2∗ )
defined by a known vector function (T1  T2 ):


y1 = T1 y1∗  y2∗ 


y2 = T2 y1∗  y2∗ 
For these models, Matzkin (2012) showed identification using additional regressors
(w1  w2 ). Specifically, the vector (w1  w2  x) was assumed to be distributed independently of (ε1  ε2 ), (w1  w2 ) entered the functions in known ways, and restrictions on the
support of the continuous (w1  w2 ) conditional on x had the effect of restricting the set of
values (y1  y2  x) at which the functions or its derivatives were identified. Identification
followed the two step procedure. This required attaching to each y1∗ and y2∗ one of the
continuous regressors, w1 and w2 , in a known way. Matzkin (2012) assumed that the additional regressors (w1  w2 ) were observed, and that the simultaneous model was weakly
separable into known functions b1 (y1∗  w1 ) and b2 (y2∗  w2 ). In other words, the model was
assumed to be


y1∗ = m1 y2∗  w1  w2  ε1 


y2∗ = m2 y1∗  w1  w2  x ε2 
with the restriction that for some unknown functions m1 and m2 , and known functions
b1 (y1∗  w1 ) and b2 (y2∗  w2 ):


 
 
b1 y1∗  w1 = m1 b2 y2∗  w2  ε1 


 


b2 y2∗  w2 = m2 b1 y1∗  w1  x ε2 
The restrictions on the support of (w1  w2  x) depended on the range of the known
transformations (T1  T2 ) and on the elements of m1 and m2 that one is interested in identifying. For example, if y2∗ is observed, so that y2 = y2∗ , or, in other words,


T2 y1∗  y2∗ = y2 

Quantitative Economics 5 (2014)

Control functions in simultaneous equations

289

then w2 is not needed. Alternatively, if y2∗ is only observed when it is positive, then the
support of w2 may only be the half real line. The most important feature is that the system can be expressed as
b1 = m1 (b2  ε1 )
b2 = m2 (b1  x ε1 )
where the distribution of (b1  b2  x) = (b1 (y1∗  w1 ) b2 (y2∗  w2 ) x) is continuous. Since the
mapping between (m1  m2 ) and (m1  m2 ) is known, identification of pointwise features
in (m1  m2 ) can be obtained from identification of analogous features in (m1  m2 ).
To provide some insight to the methods, consider first a single equation binary response model. Suppose that (w1  y2 ) is independent of ε1 , the conditional distribution
of w1 is continuously distributed given y2 = 0, and g(0) = 0. Matzkin (1992, Example 3 in
Section 5) showed identification of g in the model
y1∗ = w1 + g(y2 ) − ε1 

1 if y1∗ ≥ 0
y1 =
0 otherwise
by applying her Theorem 1. In her theorem, the support of w1 is not required to be unbounded. As mentioned above, the effect of a smaller support is to restrict the set of
values of y2 at which the function g is identified. Identification of Fε1 follows because
Pr(y1 = 1|w1  y2 = 0) = Fε1 (w1 )
while once Fε1 is identified in the relevant support, g(y2 ) is identified, given any value of
w1 , by


g(y2 ) = Fε−1 Pr(y1 = 1|w1  y2 ) − w1 
Consider now the binary response model with simultaneity and random function g1 ,
y1∗ = w1 + g1 (y2  ε1 )


y2 = g2 y1∗ − w1  x ε2 

1 if y1∗ ≥ 0
y1 =
0 otherwise
where (w1  x) is independent of (ε1  ε2 ). An example of such a model is where y1∗ is the
utility of one of the spouses from working, y2 is the work income of the other spouse,
and w1 is an exogenous variable that increases the utility y1∗ for one of the spouses but
decreases the amount of work income of the other. Denote b1 = y1∗ − w1 . Assume that g1
is invertible in ε1 and g2 is invertible in ε2 . Then, for some functions r 1 and r 2 ,
ε1 = r 1 (b1  y2 )
ε2 = r 2 (b1  y2  x)

290 Blundell and Matzkin

Quantitative Economics 5 (2014)

Note that b1 takes the place of y1 in the model with continuous dependent variables. The
only problem is that the distribution of (b1  y2 ) is not directly observed. To identify the
distribution of (b1  y2 ), Matzkin (2012) followed the argument in Lewbel (2000). Assume
that (x w1 ) has an everywhere positive density. Our independence assumption between
(x w1  w2 ) and (ε1  ε2 ) implies that w is independent of (ε1  ε2 ) conditional on x. Then,
since conditional on x, (b1  y2 ) is only a function of (ε1  ε2 ), we have that for all w1 , t1




Pr (B1  Y2 ) ≤ (t1  y2 )|X = x = Pr (B1  Y2 ) ≤ (t1  y2 )|W1 = w1  X = x



= Pr Y1∗ − W1  Y2 ≤ (t1  y2 )|W1 = w1  X = x



= Pr Y1∗  Y2 ≤ (t1 + w1  y2 )|W1 = w1  X = x 
Letting w1 = −t1 , we get that




Pr (B1  Y2 ) ≤ (t1  y2 )|X = x = Pr (Y1  Y2 ) ≤ (0 y2 )|W1 = −t1  X = x 
Hence, the distribution of (b1  y2 ) conditional on X is identified. The analysis of the system
b1 = g1 (y2  ε1 )
y2 = g2 (b1  x ε2 )
when the distribution of (b1  y2  x) is identified is analogous to the analysis of the system
y1 = m1 (y2  ε1 )
y2 = m2 (y1  x ε2 )
when the distribution of (y1  y2  x) is given.
Suppose now that the system (g1  g2 ) satisfies control function separability in the
sense that it can be expressed as
ε1 = r 1 (b1  y2 )


ε2 = v s(y2  x) r 1 (b1  y2 )
for some functions v and s, each strictly increasing in its first argument. Then one can
identify and estimate g1 using a control function approach.
6. Conclusions
In this paper, we have provided a conclusive answer to the question of when it is possible
to use a control function approach to identify and estimate a function in a simultaneous
equations model. We defined a new property of functions, called control function separability, which characterizes systems of two simultaneous equations where a function
of interest can be estimated using a control function derived from the second equation. We showed that this is a strong condition, equivalent to requiring that the reduced

Quantitative Economics 5 (2014)

Control functions in simultaneous equations

291

form function for the endogenous regressor in the function of interest is separable into
a function of all the unobservable variables. We also provided conditions in terms of the
derivatives of the two functions in the system.
An example of a system of structural equations, which is generated by the first order conditions of a heterogeneous consumer optimization problem that satisfies control
function separability, was presented. By slightly modifying the example, we have shown
the restrictiveness of the control function separability condition. We have also shown
how our results can be used to identify and estimate limited dependent variable models
with simultaneity in the latent or observable continuous variables.
Appendix
Proof of Theorem 2. As in the proof of Theorem 1, observational equivalence between Model (T) and Model (S) implies that for all y2 , x, ε1 ,
 



Fε2 |ε1 =r 1 (y1 y2 ) r 2 m1 (y2  ε1 ) y2  x = Fη|ε1 =r 1 (y1 y2 ) s(y2  x) 
(T2.1)
Differentiating both sides of (T2.1) with respect to y2 and x, we get that


 


fε2 |ε1 r 2 m1 (y2  ε1 ) y2  x ry21 m1y2 + ry22 = fη|ε1 s(y2  x) sy2 
 



fε2 |ε1 r 2 m1 (y2  ε1 ) y2  x rx2 = fη|ε1 s(y2  x) sx 
where, as defined above, ry21 = ∂r 2 (m1 (y2  ε1 ) y2  x)/∂y1 , ry22 = ∂r 2 (m1 (y2  ε1 ) y2  x)/∂y2 ,
rx2 = ∂r 2 (m1 (y2  ε1 ) y2  x)/∂x, m1y2 = ∂m1 (y2  ε1 )/∂y2 , sy2 = ∂s(y2  x)/∂y2 , and sx =
∂s(y2  x)/∂x.
Taking ratios, we get that
rx2
ry21 m1y2

+ ry22

=

sx

sy2

Conversely, suppose that for all y2 , x, ε1 ,
rx2
2
1
ry1 my2 + ry22

=

sx

sy2

(T2.2)

Define


b(y2  x ε1 ) = r 2 m1 (y2  ε1 ) y2  x 
Equality (T2.2) implies that for any fixed value of ε1 , the function b(y2  x ε1 ) is a transformation of s(y2  x). Let t(· · ε1 ) : R → R denote such a transformation. Then, for all
y2 , x,




b(y2  x ε1 ) = r 2 m1 (y2  ε1 ) y2  x = t s(y2  x) ε1 
Substituting m1 (y2  ε1 ) with y1 and ε1 with r 1 (y1  y2 ), it follows that


r 2 (y1  y2  x) = t s(y2  x) r 1 (y1  y2 ) 

292 Blundell and Matzkin

Quantitative Economics 5 (2014)

Hence, (T2.2) implies control function separability. This implies, by Theorem 1, that
Model (T) and Model (S) are observationally equivalent, and it completes the proof of
Theorem 2.

A.1 Alternative expression for (T2.1)
Instead of characterizing observationally equivalence in terms of the derivatives of the
functions m1 and r 2 , as in (T2.2), we can express observational equivalence in terms of
the derivatives of the inverse reduced form functions. Differentiating with respect to y1
and y2 the identity


y1 = m1 y2  r 1 (y1  y2 ) 
and solving for m1y2 , we get that
m1y2 =

−ry12
ry11



Hence, the condition that for all y1 , y2 , x,
rx2
ry21 m1y2

+ ry22

=

sx

sy2

is equivalent to the condition that for all y1 , y2 , x,
ry11 (y1  y2 )rx2 (y1  y2  x)
ry11 (y1  y2 )ry22 (y1  y2  x) − ry12 (y1  y2 )ry21 (y1  y2  x)

=

sx (y2  x)
sy2 (y2  x)

or
ry11 (y1  y2 )rx2 (y1  y2  x)
|ry (y1  y2  x)|

=

sx (y2  x)

sy2 (y2  x)

where |ry (y1  y2  x)| is the Jacobian determinant of the vector function r = (r 1  r 2 ) with
respect to (y1  y2 ).
Differentiating both sides of the above equation with respect to y1 , we get the following expression, only in terms of the derivatives of the inverse system of structural
equations of Model (S):
1
2
∂ log ry1 (y1  y2 )rx (y1  y2  x)
∂y1
|ry (y1  y2  x)|

= 0

References
Ai, C. and X. Chen (2003), “Efficient estimation of models with conditional moments
restrictions containing unknown functions.” Econometrica, 71, 1795–1843. [272]

Quantitative Economics 5 (2014)

Control functions in simultaneous equations

293

Altonji, J. G. and R. L. Matzkin (2005), “Cross section and panel data estimator for
nonseparable models with endogenous regressors.” Econometrica, 73 (4), 1053–1102.
[273, 287]
Benkard, C. L. and S. Berry (2006), “On the nonparametric identification of nonlinear
simultaneous equations models: Comment on B. Brown (1983) and Roehrig (1988).”
Econometrica, 74 (5), 1429–1440. [272]
Blundell, R. and J. L. Powell (2003), “Endogeneity in nonparametric and semiparametric
regression models.” In Advances in Economics and Econometrics, Theory and Applications, Eighth World Congress, Vol. II (M. Dewatripont, L. P. Hansen, and S. J. Turnovsky,
eds.), Cambridge University Press, Cambridge. [272, 273]
Blundell, R. and J. L. Powell (2004), “Endogeneity in semiparametric binary response
models.” Review of Economic Studies, 71 (3), 581–913. [287]
Briesch, R., P. Chintagunta, and R. L. Matzkin (2010), “Nonparametric discrete choice
models with unobserved heterogeneity.” Journal of Business & Economic Statistics, 28,
291–307. [288]
Chen, X. and D. Pouzo (2012), “Estimation of nonparametric conditional moment models with possibly nonsmooth moments.” Econometrica, 80, 277–321. [272]
Chen, X., V. Chernozhukov, S. Lee, and W. K. Newey (2014), “Local identification of nonparametric and semiparametric models.” Econometrica, 82 (2), 785–809. [272]
Chernozhukov, V. and C. Hansen (2005), “An IV model of quantile treatment effects.”
Econometrica, 73, 245–261. [272]
Chernozhukov, V., G. Imbens, and W. Newey (2007), “Instrumental variable estimation
of nonseparable models.” Journal of Econometrics, 139, 4–14. [272]
Chesher, A. (2003), “Identification in nonseparable models.” Econometrica, 71 (5),
1405–1441. [272, 274]
Cosslett, S. R. (1983), “Distribution-free maximum likelihood estimator of the binary
choice model.” Econometrica, 51 (3), 765–782. [287]
Darolles, S., J. P. Florens, and E. Renault (2002), “Nonparametric instrumental regression.” Report, IDEI, Toulouse. [272]
D’Haultfuille, X. and P. Fevrier (2012), “Identification of nonseparable models with endogeneity and discrete instruments.” Report. [272]
Dhrymes, P. (1970), Econometrics. Harper & Row, New York. [272]
Florens, J. P., J. J. Heckman, C. Meghir, and E. Vytlacil (2008), “Identification of treatment
effects using control functions in models with continuous, endogenous treatment and
heterogeneous effects.” Econometrica, 76 (5), 1191–1206. [272]
Gale, D. and H. Nikaido (1965), “The Jacobian matrix and global univalence of mappings.” Mathematische Annalen, 159, 81–93. [276]

294 Blundell and Matzkin

Quantitative Economics 5 (2014)

Hahn, J. and G. Ridder (2011), “Conditional moment restrictions and triangular simultaneous equations.” Review of Economics and Statistics, 93, 683–689. [272]
Hall, P. and J. L. Horowitz (2003), “Nonparametric methods for inference in the presence
of instrumental variables.” Working Paper 102/03, Center for Microdata Methods and
Practice. [272]
Heckman, J. J. (1978), “Dummy endogenous variables in a simultaneous equation system.” Econometrica, 46 (4), 931–959. [272, 286]
Heckman, J. J. and R. Robb (1985), “Alternative methods for evaluating the impact of interventions.” In Longitudinal Analysis of Labor Market Data (J. J. Heckman and B. Singer,
eds.), Econometric Society Monograph, Vol. 10, Cambridge University Press, Cambridge.
[271]
Imbens, G. W. and W. K. Newey (2009), “Identification and estimation of triangular
simultaneous equations models without additivity.” Econometrica, 77 (5), 1481–1521.
[272, 273, 287]
Kasy, M. (2010), “Identification in triangular systems using control functions.” Report,
Berkeley. [283]
Lewbel, A. (2000), “Semiparametric qualitative response model estimation with unknown heteroskedasticity and instrumental variables.” Journal of Econometrics, 97,
145–177. [288, 290]
Matzkin, R. L. (1992), “Nonparametric and distribution-free estimation of the binary
threshold crossing and the binary choice models.” Econometrica, 60 (2), 239–270. [287,
288, 289]
Matzkin, R. L. (2003), “Nonparametric estimation of nonadditive random functions.”
Econometrica, 71 (5), 1339–1375. [287]
Matzkin, R. L. (2008), “Identification in nonparametric simultaneous equations.” Econometrica, 76 (5), 945–978. [272, 275]
Matzkin, R. L. (2012), “Identification in nonparametric limited dependent variable models with simultaneity and unobserved heterogeneity.” Journal of Econometrics, 166 (1),
106–115. [288, 290]
Matzkin, R. L. (forthcoming), “Estimation of nonparametric models with simultaneity.”
Econometrica. [272]
Matzkin, R. L. and W. Newey (1993), “Kernel estimation for nonparametric limited dependent variable models.” Report, Northwestern University. [288]
Newey, W. and J. Powell (2003), “Instrumental variables estimation of nonparametric
models.” Econometrica, 71 (5), 1565–1578. [272]
Newey, W., J. Powell, and F. Vella (1999), “Nonparametric estimation of triangular simultaneous equations models.” Econometrica, 67 (3), 565–603. [272]

Quantitative Economics 5 (2014)

Control functions in simultaneous equations

295

Roehrig, C. S. (1988), “Conditions for identification in nonparametric and parametric
models.” Econometrica, 56 (2), 433–447. [272]
Telser, L. G. (1964), “Iterative estimation of a set of linear regression equations.” Journal
of the American Statistical Association, 59 (307), 845–862. [272]
Torgovitsky, A. (2012), “Identification of nonseparable models with general instruments.” Report, Northwestern University. [272]

Submitted May, 2012. Final version accepted July, 2013.

