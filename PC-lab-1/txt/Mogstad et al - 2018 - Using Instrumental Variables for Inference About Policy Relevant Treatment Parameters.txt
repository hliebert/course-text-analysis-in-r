Econometrica, Vol. 86, No. 5 (September, 2018), 1589‚Äì1619

USING INSTRUMENTAL VARIABLES FOR INFERENCE ABOUT POLICY
RELEVANT TREATMENT PARAMETERS
MAGNE MOGSTAD
Department of Economics, University of Chicago, Statistics Norway, and NBER
ANDRES SANTOS
Department of Economics, University of California at Los Angeles
ALEXANDER TORGOVITSKY
Department of Economics, University of Chicago
We propose a method for using instrumental variables (IV) to draw inference about
causal effects for individuals other than those affected by the instrument at hand. Policy relevance and external validity turn on the ability to do this reliably. Our method
exploits the insight that both the IV estimand and many treatment parameters can
be expressed as weighted averages of the same underlying marginal treatment effects.
Since the weights are identified, knowledge of the IV estimand generally places some
restrictions on the unknown marginal treatment effects, and hence on the values of
the treatment parameters of interest. We show how to extract information about the
treatment parameter of interest from the IV estimand and, more generally, from a
class of IV-like estimands that includes the two stage least squares and ordinary least
squares estimands, among others. Our method has several applications. First, it can be
used to construct nonparametric bounds on the average causal effect of a hypothetical
policy change. Second, our method allows the researcher to flexibly incorporate shape
restrictions and parametric assumptions, thereby enabling extrapolation of the average
effects for compliers to the average effects for different or larger populations. Third,
our method can be used to test model specification and hypotheses about behavior,
such as no selection bias and/or no selection on gain.
KEYWORDS: Instrumental variables, treatment effects, extrapolation, local average
treatment effect, LATE, marginal treatment effect, MTE, partial identification.

1. INTRODUCTION
IN AN INFLUENTIAL PAPER, Imbens and Angrist (1994) provided conditions under which
an instrumental variables (IV) estimand can be interpreted as the average causal effect
for the subpopulation of compliers, that is, for those whose treatment status would be affected by an exogenous manipulation of the instrument. In some cases, this local average
treatment effect (LATE) is of intrinsic interest, for example if the instrument itself represents an intervention or policy change of interest. On the other hand, in many situations,
the causal effect for individuals induced to treatment by the instrument at hand might
not be representative of the causal effect for those who would be induced to treatment
Magne Mogstad: magne.mogstad@gmail.com
Andres Santos: andres@econ.ucla.edu
Alexander Torgovitsky: torgovitsky@uchicago.edu
We thank the editor, four anonymous referees, Matt Masten, Derek Neal, Ed Vytacil, Chris Walters, and
seminar participants at several universities and conferences for valuable feedback and suggestions. Bradley
Setzler provided excellent research assistance. We are grateful to Pascaline Dupas for her help in accessing
and understanding the data used in a previous draft of this paper. A. Santos was supported in part by National
Science Foundation Grant SES-1426882. A. Torgovitsky was supported in part by National Science Foundation
Grant SES-1530538.
¬© 2018 The Econometric Society

https://doi.org/10.3982/ECTA15463

1590

M. MOGSTAD, A. SANTOS, AND A. TORGOVITSKY

by a given policy change of interest to the researcher. In these cases, the LATE is not the
relevant parameter for evaluating the policy change.
In this paper, we show how to use instrumental variables to draw inference about treatment parameters other than the LATE, thereby learning about causal effects for individuals other than those affected by the instrument at hand. Policy relevance and external
validity turn on the ability to do this reliably. Our setting is the canonical program evaluation problem with a binary treatment and a scalar, real-valued outcome.1 As in Imbens
and Angrist (1994), we assume existence of an exogenous instrument that encourages
all individuals to participate in treatment. This monotonicity condition is equivalent to
a separable selection equation (Vytlacil (2002)), which gives rise to the concept of the
marginal treatment effect (MTE) developed by Heckman and Vytlacil (1999, 2005). The
MTE can be interpreted as the average effect of treatment for persons on a margin of
indifference between participation in treatment and nonparticipation. An important feature of the model is that treatment effects are allowed to vary across individuals with the
same observable characteristics in a way that depends on the unobservable determinants
of treatment choice.
Our method builds on the observation that both the IV estimand and many treatment
parameters can be expressed as weighted averages of the MTE function (Heckman and
Vytlacil (1999, 2001a, 2001b, 2001c, 2005, 2007a, 2007b)). Since the weights are identified,
this observation implies that knowledge of the IV estimand places some restrictions on the
unknown MTE function, and hence on the possible values of treatment parameters other
than the LATE. We show how to extract information about these treatment parameters
from the IV estimand, and, more generally, from a class of ‚ÄúIV-like estimands.‚Äù
The class of IV-like estimands consists of any cross moment between the outcome and
an identified function of the treatment and the instrument. This class is general enough
to contain the estimands corresponding to any weighted linear IV estimator, including
the two stage least squares (TSLS), optimal generalized method of moments, and ordinary least squares (OLS) estimands. Each IV-like estimand provides a different weighted
average of the MTE function, and therefore carries some distinct information about the
possible values of the treatment parameter of interest (the target parameter). We show
how these IV-like estimands can be chosen systematically so as to provide the tightest possible bounds on the target parameter. We propose consistent estimators of these bounds
that can be computed using linear programming.
Our method has at least three applications. First, it can be used to construct nonparametric bounds on the average causal effect of a hypothetical policy change. Second, our
method enables extrapolation of the average effects for compliers to the average effects
for different or larger populations. Third, our method can be used to perform tests of
model specification and of individual behavior, such as testing the null hypotheses of
no selection bias and/or no selection on gains. In all of these applications, our method
provides a researcher the option to be fully nonparametric, or to impose shape and/or
parametric restrictions, if desired.
Our paper contributes to several literatures. A large body of work is concerned with using instrumental variables to draw inference about treatment parameters other than the
1
For discussions of heterogeneous effects IV models with multiple discrete treatments, we refer to Angrist
and Imbens (1995), Heckman, Urzua, and Vytlacil (2006), Heckman and Vytlacil (2007b), Heckman and
Urzua (2010), Kirkeboen, Leuven, and Mogstad (2016), and Lee and Salani√© (2016), among others. Heterogeneous effects IV models with continuous treatments have been considered by Angrist, Graddy, and
Imbens (2000), Chesher (2003), Florens, Heckman, Meghir, and Vytlacil (2008), Imbens and Newey (2009),
Torgovitsky (2015), Masten (2015), and Masten and Torgovitsky (2016), among others.

USING INSTRUMENTAL VARIABLES FOR INFERENCE

1591

LATE. Nonparametric point identification of these parameters generally requires a continuous instrument with large support (Heckman and Vytlacil (2005)). In practice, however, instruments have limited support and are often discrete or even binary. For these
situations, many common parameters of interest, such as the average treatment effect, are
not nonparametrically point identified. Analytic expressions for sharp bounds on the average treatment effect have been derived by Manski (1989, 1990, 1994, 1997, 2003), Balke
and Pearl (1997), Heckman and Vytlacil (2001b), and Kitagawa (2009), among others.2
Analytic expressions for bounds are useful because they provide intuition on the source
and strength of identification. However, it can be difficult to derive analytic bounds for
more complicated parameters, such as the policy relevant treatment effects (PRTEs)
studied by Heckman and Vytlacil (2001a, 2005) and Carneiro, Heckman, and Vytlacil
(2010, 2011). Our methodology is particularly useful in such settings. In addition, our
method provides a unified framework for imposing shape restrictions such as monotonicity, concavity, monotone treatment selection (Manski (1997), Manski and Pepper
(2000, 2009)), and separability between observed and unobserved factors in the MTE
function (Brinch, Mogstad, and Wiswall (2017)). It can be especially difficult to derive
analytic bounds for treatment parameters that incorporate these types of assumptions in
flexible combinations. In contrast, our general computational approach allows one to flexibly adjust the target parameter, as well as the maintained assumptions, without requiring
additional identification analysis.
In addition, our paper is related to recent work that considers extrapolation in instrumental variables models under additional assumptions. While our method delivers
bounds on the target parameter in general, these bounds nest important point identification results as special cases. For example, our method nests existing approaches that
extrapolate by assuming no unobserved heterogeneity in the treatment effect (Heckman
and Robb (1985), Angrist and Fernandez-Val (2013)), and those that parameterize this
unobserved heterogeneity (Heckman, Tobias, and Vytlacil (2003), Brinch, Mogstad, and
Wiswall (2017)). One attractive feature of our method is that the constraints in the linear
programs being solved require an MTE function to also yield the usual, nonparametrically
point identified LATE. Hence, our method allows for extrapolation to other parameters
of interest without sacrificing the internal validity of the LATE.
Our paper also relates to a literature on specification tests in settings with instrumental variables. This is a consequence of our method, since if there are no MTE functions
that are consistent with a set of IV-like estimands, then the model is misspecified. Balke
and Pearl (1997) and Imbens and Rubin (1997) noted that the assumptions used to point
identify the LATE have testable implications, while Machado, Shaikh, and Vytlacil (2013),
Huber and Mellace (2014), Kitagawa (2015), and Mourifi√© and Wan (2016) have developed this observation into formal statistical tests. Our method builds on the work of these
authors by allowing the researcher to maintain additional assumptions, such as parametric and/or shape restrictions. In addition to testing whether the model is misspecified,
our method can also be used to test null hypotheses such as no selection bias and/or no
selection on gains.
The remainder of the paper is organized as follows. In Section 2, we present the model
and develop our method for bounding a target parameter of interest while potentially
2
Note that Manski‚Äôs analyses did not impose the monotonicity condition of Imbens and Angrist (1994); see
Heckman and Vytlacil (2001b) and Kitagawa (2009) for further discussion. Also related is work by Shaikh and
Vytlacil (2011), Bhattacharya, Shaikh, and Vytlacil (2012), and Mourifi√© (2015), who augmented this monotonicity condition with a similar assumption for the potential outcomes.

1592

M. MOGSTAD, A. SANTOS, AND A. TORGOVITSKY

maintaining additional shape restrictions. We discuss implementation of our approach in
Section 3. In Section 4, we discuss key applications of our method, which we illustrate
in Section 5 with a numerical example. In Section 6, we provide a concluding discussion
on common empirical settings in which our approach is particularly useful. Our working
paper (Mogstad, Santos, and Torgovitsky (2017)) contains a method for hypothesis testing
and constructing confidence intervals, as well as an application to Dupas‚Äôs (2014) study
of the effects of price subsidies on the adoption and usage of an antimalarial bed net in
Kenya.
2. A GENERAL FRAMEWORK FOR IDENTIFICATION IN THE IV MODEL
2.1. Model
Our model is the canonical program evaluation problem with a binary treatment
D ‚àà {0 1} and a scalar, real-valued outcome, Y . Corresponding to the two treatment
arms are unobservable potential outcomes, Y0 and Y1 . These represent the realization
of Y that would have been experienced by an individual had their treatment status been
exogenously set to 0 or 1. The relationship between observed and potential outcomes is
given by
Y = DY1 + (1 ‚àí D)Y0 

(1)

Following Heckman and Vytlacil (1999, 2005), we assume that treatment is determined
by the weakly separable selection or choice equation


D = 1 ŒΩ(Z) ‚àí U ‚â• 0 
(2)
where ŒΩ is an unknown function, U is a continuously distributed random variable, and Z
is a vector of observable covariates.
The observable variables in the model are the outcome Y ‚àà R, the binary treatment
D ‚àà {0 1}, and the covariates Z ‚àà Rdz . We decompose Z into Z = (X Z0 ), where X ‚àà Rdx
are used as control variables and Z0 ‚àà Rdz0 will be assumed to be exogenous instruments.
Our focus in this section is on identification, so we assume throughout that the researcher
knows the joint distribution of (Y D Z). The unobservables are the potential outcomes
(Y0  Y1 ), and the variable U in the selection equation, which represents unobservable
factors that affect treatment choice. We maintain the following standard assumptions
throughout the paper.
ASSUMPTIONS I:
‚ä• denotes (conditional) statistical independence.
I.1 U ‚ä•
‚ä• Z0 |X, where ‚ä•
I.2 E[Yd |Z U] = E[Yd |X U] and E[Yd2 ] < ‚àû for d ‚àà {0 1}.
I.3 U is continuously distributed, conditional on X.
Assumptions I.1 and I.2 require Z0 to be exogenous with respect to both the selection
and outcome processes. Vytlacil (2002) showed that, given I.1, the assumption that the
index of the selection equation is additively separable as in (2) is equivalent to the assumption that Z0 affects D monotonically in the sense introduced by Imbens and Angrist
(1994). Hence, I.1 combined with (2) imposes substantive restrictions on choice behavior:
Conditional on X, changes in Z0 either weakly encourage or weakly discourage all agents
to choose D = 1. Assumption I.2 imposes an exclusion restriction that the conditional
means of Y0 and Y1 depend on Z = (Z0  X) only through the covariates X.

USING INSTRUMENTAL VARIABLES FOR INFERENCE

1593

Assumption I.3 is a weak regularity condition that enables us to impose a standard
normalization. As is well known, equation (2) may be rewritten as





 ‚â§
D = 1 FU|X (U|X) ‚â§ FU|X ŒΩ(Z)|X ‚â° 1 U
ŒΩ(Z) 
(3)
‚â°
where we are using the notation FU|X (u|x) ‚â° P(U ‚â§ u|X = x) and we have defined U
 is uniformly
FU|X (U|X) and 
ŒΩ(Z) ‚â° FU|X (ŒΩ(Z)|X). Under Assumptions I.1 and I.3, U
distributed on [0 1], conditional on Z = (Z0  X). Working with this normalized model
simplifies the analysis and does not affect its empirical content. Hence, we drop the tilde
and maintain throughout the paper the normalization that U itself is distributed uniformly
over [0 1] conditional on Z. A consequence of this normalization is that


p(z) ‚â° P(D = 1|Z = z) = FU|Z ŒΩ(z)|z = ŒΩ(z)
(4)
where p(z) is the propensity score.
It is important to observe what is not being assumed under Assumptions I. First, we do
not impose any conditions on the support of Z: Both the control (X) and exogenous (Z0 )
components of Z may be either continuous, discrete and ordered, categorical, or binary.
Second, the IV model as specified here allows for rich forms of observed and unobserved
heterogeneity. In particular, it allows Y1 ‚àí Y0 to vary not only across individuals with
different values of X, but also among individuals with the same X. The treatment D
may be statistically dependent with Y0 (indicating selection bias), or Y1 ‚àí Y0 (indicating
selection on the gain), or both, even conditional on X. Third, the model does not specify
why individuals make the treatment choice that they do, in contrast to a stylized Roy
model in which D = 1[Y1 > Y0 ]. However, the model also does not preclude the possibility
that individuals choose treatment with full or partial knowledge of the potential outcomes
(Y0  Y1 ). Any such knowledge will be reflected through dependence between the potential
outcomes, (Y0  Y1 ), and the unobserved component treatment choice, U. Assumptions I
do not restrict this dependence.
As observed by Heckman and Vytlacil (1999, 2005), a wide range of treatment parameters can be written as weighted averages of the underlying MTE function, which is defined
as
MTE(u x) ‚â° E[Y1 ‚àí Y0 | U = u X = x]
We use a slight generalization of their observation. Instead of working with the MTE
function directly, we consider treatment parameters that can be expressed as functions of
the two marginal treatment response (MTR) functions, defined as
m0 (u x) ‚â° E[Y0 | U = u X = x]

and

m1 (u x) ‚â° E[Y1 | U = u X = x]

(5)

Of course, each pair m ‚â° (m0  m1 ) of MTR functions generates an associated MTE function m1 ‚àí m0 . One benefit of working with MTR functions instead of MTE functions is
that it allows us to consider parameters that weight m0 and m1 asymmetrically. Another
benefit is that it allows the researcher to impose assumptions on m0 and m1 separately.
Our method allows the specification of MTR functions to be completely unrestricted,
but it also allows the researcher the ability to impose restrictions. For example, it is possible to maintain nonparametric shape restrictions, as discussed in Section 2.6. It is also
possible to parameterize the MTR functions. Polynomials are widely used as a parameterization in empirical work using MTEs (Moffitt (2008), French and Song (2014), Brinch,

1594

M. MOGSTAD, A. SANTOS, AND A. TORGOVITSKY

Mogstad, and Wiswall (2017)), but our method allows for other parameterizations as well.
The uniform normalization is convenient for interpreting these parameterizations, since it
allows U = u to be interpreted as a quantile of the distribution of latent willingness to pay
for treatment. An MTR specification that is, for example, linear in u, is interpretable as
imposing a linear relationship between average outcomes and the quantile of unobserved
willingness to pay. A higher order polynomial allows for a flexible but smooth relationship
between average outcomes and these quantiles.
2.2. What We Want to Know: The Target Parameter
We assume that the researcher is interested in a target parameter Œ≤ that can be written
for any candidate pair of MTR functions m ‚â° (m0  m1 ) as




1

Œ≤ ‚â°E

1

m0 (u X)œâ (u Z) dŒº (u) + E




0



0

m1 (u X)œâ1 (u Z) dŒº (u) 

(6)

0

where œâ0 and œâ1 are identified weighting functions, and Œº is an integrating measure that
is chosen by the researcher and usually taken to be the Lebesgue measure on [0 1]. For
example, to set Œ≤ to be the average treatment effect (ATE), observe that


E[Y1 ‚àí Y0 ] = E m1 (U X) ‚àí m0 (U X) = E





1

m1 (u X) du ‚àí E
0

1

m0 (u X) du 
0

take œâ1 (u z) = 1, œâ0 (u z) = ‚àí1, and let Œº be the Lebesgue measure on [0 1]. Similarly,
to set Œ≤ to be the ATE conditional on X lying in some known set X  , take



1
x
‚àà
X

œâ1 (u z) ‚â° œâ1 (u x z0 ) = 
P X ‚àà X
œâ0 (u z) = ‚àíœâ1 (u z), and let Œº be as before. The resulting target parameter is then the
population average treatment effect for individuals with covariates x ‚àà X  .
In Table I, we provide formulas for the weights œâ0 and œâ1 that correspond to a variety
of different treatment parameters. Any of these can be taken to be the target parameter Œ≤ . Examples include (i) the average treatment effect for the treated (ATT), that is,
the average impact of treatment for individuals who actually take the treatment; (ii) the
average treatment effect for the untreated (ATU), that is, the average impact of treatment for individuals who do not take treatment; (iii) LATE(u u), that is, the average
treatment effect for individuals who would take the treatment if their realization of the
instrument yielded p(z) = u, but not if p(z) = u; and (iv) the policy relevant treatment effect (PRTE), that is, the average impact on Y (either gross or per net individual affected)
due to a change from the baseline policy to some alternative policy.
For most of the parameters in Table I, the integrating measure Œº is Lebesgue measure on [0 1]. However, researchers are sometimes interested in the MTE function itself,
for example, Carneiro, Heckman, and Vytlacil (2011) and Maestas, Mullen, and Strand
(2013). Our specification of Œ≤ accommodates this by replacing Œº with the Dirac measure (i.e., a point mass) at some specified point u and taking œâ0 (u z) = ‚àíœâ1 (u z) =
‚àí1. The resulting target parameter is the MTE function averaged over X, that is,
E[m1 (u X) ‚àí m0 (u X)].

Leb.[0 1]

‚àíœâ1 (u z)
‚àíœâ1 (u z)
‚àíœâ1 (u z)
‚àí 1[u>p(z)]
P(D=0)

‚àíœâ1 (u z)
œâA0 (u z) + œâB0 (u z)

PRTE with Z  = Z and p (z) = p(z) + Œ±

PRTE with Z = Z and p (z) = (1 + Œ±)p(z)
PRTE with Z = Z + Œ±ej and p (z) = p(z)
E[Y0 |D = 1] ‚àí E[Y0 |D = 0]
E[Y1 ‚àí Y0 |D = 1] ‚àí E[Y1 ‚àí Y0 |D = 0]
Œ≤A + Œ≤B

Proportional PRTE with magnitude Œ±

PRTE for an additive Œ± shift of the jth
component of Z
Average Selection Bias
Average Selection on the Gain
Sum of two quantities Œ≤A , Œ≤B with
common measure Œº



1[u‚â§p(z)]
P(D=1)

Leb.[0 1]
1[u‚â§p(z+Œ±ej )]‚àí1[u‚â§p(z)]
E[p(Z+Œ±ej )]‚àíE[p(Z)]

‚àíœâ1 (u z)

E[Y  ]‚àíE[Y ]
E[D ]‚àíE[D]



1[u‚â§(1+Œ±)p(z)]‚àí1[u‚â§p(z)]
Œ±E[p(Z)]

‚àí1
‚àíœâ1 (u z)

E[Y1 ‚àí Y0 |U = u]
E[Y1 ‚àí Y0 |U ‚àà (u u]]



‚àíœâ1 (u z)

E[Y1 ‚àí Y0 |D = 0]



1[u‚â§p(z)+Œ±]‚àí1[u‚â§p(z)]
Œ±

‚àíœâ1 (u z)

0
‚àí 1[u>p(z)]
P(D=0)
œâA1 (u z) + œâB1 (u z)
1[u‚â§p(z)]
P(D=1)

P[u‚â§p (Z  )]‚àíP[u‚â§p(Z)]
E[p (Z  )]‚àíE[p(Z)]

1[u‚àà(uu]]
(u‚àíu)

1

1[u>p(z)]
P(D=0)

1[u‚â§p(z)]
P(D=1)

Leb.[0 1]
Leb.[0 1]
Common Œº

Leb.[0 1]

Leb.[0 1]

Dirac(u)
Leb.[0 1]

Leb.[0 1]

Leb.[0 1]

Leb.[0 1]
Leb.[0 1]
Leb.[0 1]
Leb.[0 1]

E[Y1 ‚àí Y0 |D = 1]

1[x‚ààX  ]
P(X‚ààX  )

0
1
1

1
0
‚àí1
‚àíœâ1 (u z)

Measure Œº

E[Y0 ]
E[Y1 ]
E[Y1 ‚àí Y0 ]
E[Y1 ‚àí Y0 |X ‚àà X  ]

œâ1 (u z) ‚â° œâ1 (u x z0 )

Average Untreated Outcome
Average Treated Outcome
Average Treatment Effect (ATE)
Average Treatment Effect (ATE) given
X ‚àà X
Average Treatment on the Treated
(ATT)
Average Treatment on the Untreated
(ATU)
Marginal Treatment Effect at u
Local Average Treatment Effect for
U ‚àà (u u] (LATE(u u))
Policy Relevant Treatment Effect
(PRTE) for new policy (p  Z  )
Additive PRTE with magnitude Œ±

Weights
œâ0 (u z) ‚â° œâ0 (u x z0 )

Target Parameter

Expression

WEIGHTS FOR A VARIETY OF TARGET PARAMETERS

TABLE I

USING INSTRUMENTAL VARIABLES FOR INFERENCE

1595

1596

M. MOGSTAD, A. SANTOS, AND A. TORGOVITSKY

2.3. What We Know: IV-Like Estimands
A key point for our method is that a set of identified quantities can also be written in a
form similar to (6). Consider, for example, the IV estimand that results from using Z as
an instrument for D in a linear instrumental variables regression that includes a constant
term, but which does not include any other covariates X. Assuming Cov(D Z) = 0, this
estimand is given by
Œ≤IV ‚â°

Cov(Y Z)

Cov(D Z)

(7)

For example, if Z ‚àà {0 1} is binary, then Œ≤IV reduces to the standard Wald estimand
Œ≤IV =

E[Y | Z = 1] ‚àí E[Y | Z = 0]

E[D | Z = 1] ‚àí E[D | Z = 0]

(8)

Heckman and Vytlacil (2005) showed that Œ≤IV can also be written in the form (6) as a
weighted average of the MTE function. This observation suggests that useful information
about Œ≤ can be extracted from knowledge of Œ≤IV . The next proposition shows that, more
generally, any cross moment of Y with an identified (or known) function of (D Z) ‚â°
(D X Z0 ) can also be expressed as the weighted sum of the two MTR functions, m0 and
m1 . We refer to such cross moments as IV-like estimands.
PROPOSITION 1: Suppose that s : {0 1} √ó Rdz ‚Üí R is an identified (or known) function
that is measurable and has a finite second moment. We refer to such a function s as an IVlike specification and to Œ≤s ‚â° E[s(D Z)Y ] as an IV-like estimand. If (Y D) are generated
according to (1) and (2) under Assumptions I, then




1

Œ≤s = E

m0 (u X)œâ0s (u Z) du + E
0



where œâ0s (u z) ‚â° s(0 z)1 u > p(z)


and œâ1s (u z) ‚â° s(1 z)1 u ‚â§ p(z) 

1

m1 (u X)œâ1s (u Z) du 
0

(9)

The weights in Proposition 1 can be shown to reduce to the weights for Œ≤IV derived by
Heckman and Vytlacil (2005) by taking
s(d z) ‚â° s(d x z0 ) =

z0 ‚àí E[Z0 ]

Cov(D Z0 )

(10)

which is an identified function of d (trivially) and z.3 As we elaborate further in Appendix S1 of the Supplemental Material (Mogstad, Santos, and Torgovitsky (2018)),
Proposition 1 applies more broadly to include any well-defined weighted linear IV estimand that uses some function of D and Z as included and excluded instruments for
3
An implication of (9) is that the IV-like specifications s(d z) = (z0 ‚àí E[Z0 ])/ Cov(D Z0 ) and sÃÉ(d z) =
(z0 ‚àíE[Z0 ]) differ by only a multiplicative constant, for example, Cov(D Z0 ), and so yield the same restrictions
on the MTR functions. As a result, if Œ≤IV is weakly identified, one might prefer to use the IV-like specification
sÃÉ(d z) = (z0 ‚àí E[Z0 ]) instead of (10).

1597

USING INSTRUMENTAL VARIABLES FOR INFERENCE
TABLE II
NOTABLE IV-LIKE ESTIMANDS
Estimand

Œ≤s

s(d z) ‚â° s(d x z0 )

IV slope

Cov(YZ0 )
Cov(DZ0 )
Cov(Yp(Z))
Cov(Dp(Z))
  ‚àí1

 ]
ej E[Z X ] E[ZY

z0 ‚àíE[Z0 ]
Cov(DZ0 )
p(z)‚àíE[p(Z)]
Cov(Dp(Z))
X
 ]‚àí1
ej E[Z
z

X
 ])‚àí1 (Œ†E[ZY
 ])
ej (Œ†E[Z

X
 ])‚àí1 Œ†
ej (Œ†E[Z
z

IV slope using p(Z)
IV (jth component)

TSLS (jth component)

Cov(YD)
Var(D)
  ‚àí1

OLS slope

 ]
ej E[X X ] E[XY

OLS (jth component)

d‚àíE[D]
Var(D)

X
 ]‚àí1
ej E[X
x

Notes

Z0 scalar
‚Äî
 ‚â° [1 D X ]
X
 ‚â° [1 Z X ]
Z
Z scalar
ej the jth unit vector
Z
 ]E[Z
Z
 ]‚àí1
Œ† ‚â° E[X
Z vector
‚Äî
 ‚â° [1 D X ]
X
ej the jth unit vector

a set of endogenous variables also constructed from D and Z.4 For example, the OLS
estimand corresponds to taking s to be
s(d z) =

d ‚àí E[D]

Var(D)

More generally, any subvector of the TSLS estimand can also be written as an IV-like
estimand. Table II contains expressions for some notable IV-like estimands.
2.4. From What We Know to What We Want to Know
We now show how to extract information about the target parameter Œ≤ from the general class of IV-like estimands introduced in Section 2.3. Let S denote some collection
of IV-like specifications (i.e., functions s : {0 1} √ó Rdz ‚Üí R) chosen by the researcher,
that each satisfy the conditions set out in Proposition 1. Corresponding to each s ‚àà S is
an IV-like estimand Œ≤s ‚â° E[s(D Z)Y ]. We assume that the researcher has restricted the
pair of MTR functions m ‚â° (m0  m1 ) to lie in some parameter space M contained in a
vector space. The parameter space incorporates assumptions that the researcher wishes
to maintain about m, such as parametric or shape restrictions. Our goal is to characterize bounds on the values of the target parameter Œ≤ that could have been generated by
MTR functions m ‚àà M that also could have delivered the collection of identified IV-like
estimands through (9).
To this end, we denote the weighting expression in Proposition 1 as a linear map Œìs :
M ‚Üí R, defined for any IV-like specification s ‚àà S as
 1
 1
m0 (u X)œâ0s (u Z) du + E
m1 (u X)œâ1s (u Z) du 
(11)
Œìs (m) ‚â° E
0

0

where we recall that œâ0s (u z) ‚â° s(0 z)1[u > p(z)] and œâ1s (u z) ‚â° s(1 z)1[u ‚â§ p(z)].
By Proposition 1, if (Y D) are generated according to (1) and (2) under Assumptions I,
4
The phrases ‚Äúincluded‚Äù and ‚Äúexcluded‚Äù instrument are meant in the sense typically introduced in textbook
treatments of the linear IV model without heterogeneity.

1598

M. MOGSTAD, A. SANTOS, AND A. TORGOVITSKY

then the MTR functions m ‚â° (m0  m1 ) must satisfy Œìs (m) = Œ≤s for every IV-like specification s ‚àà S . As a result, m must lie in the set

MS ‚â° m ‚àà M : Œìs (m) = Œ≤s for all s ‚àà S 
The target parameter, Œ≤ , can also be expressed as an identified linear map of the MTR
functions. From (6), we define this map as Œì  : M ‚Üí R, with




1

Œì  (m) ‚â° E

m0 (u X)œâ0 (u Z) dŒº (u) + E
0

1

m1 (u X)œâ1 (u Z) dŒº (u)  (12)
0

It follows that if (Y D) is generated according to (1) and (2) under Assumptions I, then
the target parameter must belong to the identified set

BS ‚â° b ‚àà R : b = Œì  (m) for some m ‚àà MS 
Intuitively, BS is the set of values for the target parameter that could have been generated
by MTR functions that satisfy the researcher‚Äôs assumptions and are also consistent with
the IV-like estimands. The next result shows that if M is convex, then BS is an interval
that can be characterized by solving two convex optimization problems.
PROPOSITION 2: Suppose that M is convex. Then either MS is empty, and hence BS is
empty, or else the closure of BS (in R) is equal to the interval [Œ≤  Œ≤ ], where
Œ≤ ‚â° inf Œì  (m) and Œ≤ ‚â° sup Œì  (m)
m‚ààMS

(13)

m‚ààMS

2.5. Information and Point Identification
The set MS consists of all MTR functions in M that are consistent with the IV-like
estimands chosen by the researcher. However, MS may not necessarily exhaust all of the
information available in the data. In particular, MS could contain MTR functions that
would be ruled out if S were expanded to include additional IV-like specifications. If this
is the case, then incorporating these further specifications can shrink BS .
We examine this issue by considering the conditional means of Y that would be generated through (1) and (2) under Assumptions I by a given MTR pair m = (m0  m1 ).
Whenever 0 < p(Z) < 1, these conditional means can be written as
 1
1

m0 (u X) du
E[Y |D = 0 Z] = E Y0 |U > p(Z) Z = 
1 ‚àí p(Z) p(Z)
 p(Z)


1
m1 (u X) du
E[Y |D = 1 Z] = E Y1 |U ‚â§ p(Z) Z =
p(Z) 0




and

(14)
(15)

MTR pairs that (almost surely) satisfy (14)‚Äì(15) are compatible with the observed conditional means of Y . Our next result shows that any such MTR pair will be in MS for any
choice of S . Moreover, we show that if S is chosen correctly, then MS will contain only
MTR pairs that are compatible with the observed conditional means of Y .

USING INSTRUMENTAL VARIABLES FOR INFERENCE

1599

1

PROPOSITION 3: Suppose that every m ‚àà M satisfies E[ 0 md (u X)2 du] < ‚àû for d ‚àà
{0 1}. If S contains functions that satisfy the conditions of Proposition 1, then
m ‚àà M : m satisfies (14) and (15) almost surely ‚äÜ MS 

(16)

Moreover, suppose that S ‚â° {s(d z) = 1[d = d ]f (z) for (d  f ) ‚àà {0 1} √ó F }, where F is
a collection of functions. If the linear span of F is norm dense in L2 (Z) ‚â° {f : Rdz ‚Üí
R s.t. E[f (Z)2 ] < ‚àû}, then
m ‚àà M : m satisfies (14) and (15) almost surely = MS 

(17)

Proposition 3 shows that if S is a sufficiently rich class of functions, then MS exhausts
the available data in the sense of being the smallest subset of M that is compatible with
the observed conditional means of Y . It follows that BS is also the smallest set of values
for the target parameter that are consistent with both the conditional means of Y and the
assumptions of the model. For example, if D ‚àà {0 1} and Z ‚àà {0 1}, then (17) holds if we
take F = {1[z = 0] 1[z = 1]}, so that

S = 1[d = 0 z = 0] 1[d = 0 z = 1] 1[d = 1 z = 0] 1[d = 1 z = 1] 
The information contained in the corresponding IV-like estimands is the same as that
contained in the coefficients of a saturated regression of Y on D and Z. More generally,
if Z is continuous, then (17) can be satisfied by taking F to be certain parametric families
of functions of Z. For example, if Z ‚àà Rdz , then one such family is the set of half spaces,
F = {1[z ‚â§ z ] : z ‚àà Rdz }. Other examples can be found in, for example, Bierens (1990)
and Stinchcombe and White (1998).
While we view partial identification as the standard case, we emphasize that our analysis
does not preclude point identification. Letting |S | denote the cardinality of S , notice that
the restrictions
Œìs (m) = Œ≤s

for all s ‚àà S

(18)

constitute a linear system of |S | equations in terms of m. As such, there are three possibilities for the cardinality of the solution set: Either there is a unique solution, there are an
infinite number of solutions, or there is no solution. These cases correspond respectively
to point identification of m, partial identification of m, and model misspecification. We
discuss the latter case in Section 4.3. In the case that m is point identified, note that then
any target parameter Œ≤ is also point identified.
These observations about point identification are implicit in the work of Brinch,
Mogstad, and Wiswall (2017). Those authors showed that if M is restricted to be a set
of polynomials, then point identification of the MTR functions can be established by considering regressions of Y on p(Z) and D. In terms of (18), this just means that S creates
at least as many non-redundant equations as the dimension of m. Their results allow for
Z to be discrete, but require the specification of M to be no richer than the support of
p(Z). For example, if Z is binary, their results require M to only contain MTR pairs that
are linear in u.5 In contrast, our results allow the researcher to specify M independently
of the data.
5
Recently, Kowalski (2016) has applied the linear case, which was studied in depth by Brinch, Mogstad, and
Wiswall (2012, 2017), to analyze the Oregon Health Insurance Experiment.

1600

M. MOGSTAD, A. SANTOS, AND A. TORGOVITSKY

In some situations, point identification of the target parameter, Œ≤ , can also be established when |S | is infinite and M is infinite dimensional. Indeed, relationships similar to
(14) and (15) have been used previously to establish point identification of the MTE function. For example, Heckman and Vytlacil (1999, 2001c, 2005) and Carneiro, Heckman,
and Vytlacil (2010, 2011) showed that if Z0 is continuously distributed, then the MTE is
point identified over the support of the propensity score. As a consequence, any target
parameter Œ≤ whose weights have support contained within the interior of the support of
the propensity score will also be point identified. Proposition 3 implies that the same is
true in our framework if S is chosen to be a sufficiently rich collection of functions.
2.6. Shape Restrictions
Our method allows researchers to easily impose shape restrictions either on the MTR
functions m = (m0  m1 ) or directly on the MTE function m1 ‚àí m0 . For example, to impose the monotone treatment response assumption considered by Manski (1997), that is,
that Y1 ‚â• Y0 with probability 1, the set M should be specified to only contain MTR pairs
for which m1 ‚àí m0 is nonnegative. Similarly, one could assume that m1 (¬∑ x) ‚àí m0 (¬∑ x)
is weakly decreasing for every x. This restriction would reflect the assumption that those
more likely to select into treatment (those with small realizations of U) are also more
likely to have larger gains from treatment, which is like the monotone treatment selection assumption of Manski and Pepper (2000). Maintaining combinations of assumptions
simultaneously (e.g., both monotone treatment response and monotone treatment selection) is simply a matter of imposing both restrictions on M at the same time.
Another type of nonparametric shape restriction that can be used to tighten the bounds
is separability between the observed (X) and unobserved (U) components. Although restrictive, separability of this sort is standard (often implicit) in applied work using instrumental variables.6 In our framework, separability between X and U can be imposed by
restricting M to only contain MTR pairs (m0  m1 ) that can be decomposed as
md (u x) = mUd (u) + mX
d (x)

for d = 0 1

(19)

where mUd and mX
d are functions that can themselves satisfy some shape restrictions. This
type of separability implies that the slopes of the MTR functions with respect to u do not
vary with x. Alternatively, if complete separability is viewed as too strong a restriction, it
is straightforward to interact u with only certain components of x. Specifications like (19)
can also be used to mitigate the curse of dimensionality, for example by specifying mX
d (x)
to be a linear function of x.
3. IMPLEMENTATION
In this section, we show how to implement Proposition 2. First, we discuss a tractable
computational approach for solving the optimization problems defined in (13). Then, in
Section 3.2, we propose a consistent estimator of the identified set for the target parameter, that is, Bid ‚â° [Œ≤  Œ≤ ].
6
In some settings, additive separability can be motivated by assumptions about primitives such as technology
or preferences. See Brinch, Mogstad, and Wiswall (2017) for examples.

1601

USING INSTRUMENTAL VARIABLES FOR INFERENCE

3.1. Computing the Bounds
Our approach for implementing Proposition 2 is to replace the possibly infinitedimensional parameter space of functions M by a finite-dimensional subset Mfd ‚äÜ M.7
The upper bound for the target parameter with this finite-dimensional subset is given by
Œ≤fd ‚â° sup Œì  (m)

for all s ‚àà S 

Œìs (m) = Œ≤s

s.t.

m‚ààMfd

(20)

while Œ≤fd is defined as the analogous infimum. Suppose that we specify Mfd as the finite
linear basis

Kd

Kd
Mfd ‚â° (m0  m1 ) ‚àà M : md (u x) =
Œ∏dk bdk (u x) for some {Œ∏dk }k=1  d = 0 1  (21)
k=1
d
are known basis functions and Œ∏ ‚â° (Œ∏0  Œ∏1 ) parameterizes functions in Mfd
where {bdk }k=1
with Œ∏d ‚â° (Œ∏d1      Œ∏dKd ) . The parameter space M generates a parameter space

K


Œò ‚â° (Œ∏0  Œ∏1 ) ‚àà R

K0

√óR

K1

:

K0

k=1

Œ∏0k b0k 

K1






Œ∏k1 b1k ‚àà M 

k=1

for the finite-dimensional parameter Œ∏. Using the linearity of the mappings Œì  and Œìs
defined in (11) and (12), we write (20) as
Œ≤fd ‚â°

K0


sup
(Œ∏0 Œ∏1 )‚ààŒò

s.t.

Œ∏0k Œì0 (b0k ) +

k=1

K0


K1


Œ∏1k Œì1 (b1k )

k=1

Œ∏0k Œì0s (b0k ) +

k=1

K1


Œ∏1k Œì1s (b1k ) = Œ≤s

(22)
for all s ‚àà S 

k=1

where we have decomposed Œì  (m) ‚â° Œì0 (m0 ) + Œì1 (m1 ) with

Œì (md ) ‚â° E

1

md (u X)œâd (u Z) dŒº (u)

for d = 0 1

(23)

and similarly for Œìs (m) = Œì0s (m0 ) + Œì1s (m1 ) with
 1
md (u X)œâds (u Z) dŒº (u)
Œìds (md ) ‚â° E

for d = 0 1

(24)


d

0

0

If Œò is a polyhedral set, and S is a finite set, then (22) is a finite-dimensional linear
program. Linear programs are used routinely in empirical work involving quantile regressions, for example, Abadie, Angrist, and Imbens (2002), in part because they can be solved
quickly and reliably. Whether a given shape restriction on M translates into Œò being polyhedral depends on the basis functions. In Appendix S2 of the Supplemental Material, we
7
This is as in sieve estimation methods (Chen (2007)), but our focus here is on computation rather than
regularization.

1602

M. MOGSTAD, A. SANTOS, AND A. TORGOVITSKY

discuss the Bernstein polynomial basis, which is particularly attractive in this regard. We
also observe there that for certain choices of bases, including the Bernstein polynomial
basis, one can compute the integrals in the definitions of Œìd (bdk ) and Œìds (bdk ) analytically.
For other cases, these one-dimensional integrals can be computed numerically.
In some situations, M can be replaced by a finite-dimensional set Mfd without affecting the bounds on the target parameter, that is, while ensuring Œ≤fd = Œ≤ . This can be
interpreted as an exact computational approach for determining nonparametric bounds
on the target parameter. Suppose that Z has discrete support and that the weight functions (u z) ‚Üí œâd (u z) for the target parameter are piecewise constant in u. Then define
a partition {Uj }Jj=1 of [0 1] such that œâd (u z) and 1[u ‚â§ p(z)] are constant (as functions
of u) on each Uj .8 Let {x1     xL } denote the support of X and then use
bjl (u x) ‚â° 1[u ‚àà Uj  x = xl ] for 1 ‚â§ j ‚â§ J and 1 ‚â§ l ‚â§ L

(25)

as the basis functions employed in the construction of Mfd in (21), with Kd = JL.
A linear combination of the basis functions (25) forms a constant spline as a function
of u over [0 1] for each x. The constant spline that provides the best mean squared error
approximation to a given function md (u x) can be shown to be
Œ†md (u x) ‚â°

L
J




E md (U xl )|U ‚àà Uj  X = xl bjl (u x)

(26)

j=1 l=1

This corresponds to taking Œ∏d(jl) = E[md (U xl )|U ‚àà Uj  X = xl ] for an element of (21),
with the slight abuse of notation that k = (j l). The next proposition uses (26) to show
that constant splines can reproduce the nonparametric bounds on the target parameter.
PROPOSITION 4: Suppose that Z has discrete support and that œâd (u z) are piecewise
constant in u. Let {Uj }Jj=1 be a partition of [0 1] such that œâd (u z) and 1[u ‚â§ p(z)] are
constant on u ‚àà Uj for any z. Suppose that Mfd is constructed using basis functions (25) and
that (Œ†m0  Œ†m1 ) ‚àà M for every (m0  m1 ) ‚àà M. Then Œ≤fd = Œ≤ and Œ≤fd = Œ≤ .
Proposition 4 shows that one can solve the infinite-dimensional problems defining Œ≤
and Œ≤ exactly by solving (20) with Mfd consisting of constant splines. Besides requiring Z
to have discrete support, the result also assumes (Œ†m0  Œ†m1 ) ‚àà M for every m ‚àà M.9
The second condition requires that the constant spline generated from a MTR pair
m ‚àà M through (26) still belong to the parameter space M. For certain shape restrictions, such as boundedness or monotonicity, (m0  m1 ) satisfying the restriction implies
the projection (Œ†m0  Œ†m1 ) will satisfy them as well. As a result, in such applications, the
8
For example, if u ‚Üí œâd (u z) is left-continuous, then we may set U1 ‚â° [u0  u1 ] and Uj ‚â° (uj‚àí1  uj ] for 2 ‚â§
j ‚â§ J, where {uj }Jj=0 are the ordered unique elements of the union of {0 1}, supp p(Z), and the discontinuity
points of {œâd (¬∑ z) : d ‚àà {0 1} z ‚àà supp Z}. Moreover, if Œº is absolutely continuous with respect to Lebesgue
measure, then it suffices that œâd (U z) and 1[U ‚â§ p(z)] be almost surely constant on Uj .
9
The assumption that œâd (u z) is piecewise constant in u for fixed z is not restrictive for common target
parameters; see Table I. The requirement that Z is discretely distributed can be relaxed, since when Z0 has a
continuous component, the MTR functions are point identified over the interior of the support of the propensity score. (This can be seen by slightly generalizing the local instrument variable argument of Heckman and
Vytlacil (1999) to (14) and (15).) One can then apply Proposition 4 to the portion of the MTR functions that
are not point identified by the continuous variation.

USING INSTRUMENTAL VARIABLES FOR INFERENCE

1603

assumption (Œ†m0  Œ†m1 ) ‚àà M is satisfied whenever M includes piecewise constant functions. The latter condition can be relaxed to the assumption that M includes functions
that can approximate (Œ†m0  Œ†m1 ) suitably well.10
3.2. Estimation
So far, we have assumed that the researcher knows the population joint distribution of
the observed data (Y D Z). In practice, researchers typically model the observed data
as a finite sample drawn from the population. Features of the distribution of observables
must then be viewed as estimators subject to statistical error. In this section, we propose
a modification of our procedure that allows for such error. In Appendix S3 of the Supplemental Material, we show that our proposed set estimator is consistent for the population
identified set under weak conditions. In our working paper (Mogstad, Santos, and Torgovitsky (2017)), we develop a procedure that can be used for hypothesis testing and for
constructing confidence intervals.
Suppose that ŒìÀÜ  , ŒìÀÜs , and Œ≤ÃÇs are consistent estimators of Œì   Œìs , and Œ≤s , respectively,
and that S has a finite number of elements. We discuss construction of these estimators
in Appendix S4 of the Supplemental Material. Using these estimators, we estimate Œ≤
with
ÀÜ  ‚â° sup ŒìÀÜ  (m)
Œ≤
m‚ààM

s.t.


  


ŒìÀÜs (m) ‚àí Œ≤ÃÇs  ‚â§ inf
ŒìÀÜs m ‚àí Œ≤ÃÇs  + Œ∫n 
s‚ààS

m ‚ààM

(27)

s‚ààS

where Œ∫n > 0 is a tuning parameter that converges to zero at an appropriate rate with
the sample size, n. The analogous minimization problem provides an estimator Œ≤ÃÇ for Œ≤ .
In addition to replacing Œì  , Œìs , and Œ≤s by estimators, these programs also differ from
those in Proposition 2 in the way they handle the set MS of observationally equivalent
MTR functions. Instead of constraining m to lie in this set as in (13), the constraint in (27)
restricts attention to the subset of m ‚àà M that come closest to satisfying these constraints,
up to a tolerance Œ∫n . This modification means that (27) will always have a feasible solution,
ÀÜ  and Œ≤ÃÇ always exist.
so that our estimators Œ≤
Our conditions for consistency in Appendix S3 of the Supplemental Material are quite
weak. In particular, they allow for |S | to be infinite and M infinite-dimensional. To handle
the former case, we generalize the constraint in (27) to allow for loss functions other
than a (finite) sum of absolute deviations. However, the absolute deviations loss in (27)
ÀÜ  in this case requires two
is attractive from a computational standpoint. Computing Œ≤
simple steps. First, one solves the program in the right-hand side of the constraint in (27).
This can be reformulated as a linear program by adding slack variables for the positive
and negative parts of ŒìÀÜs (m ) ‚àí Œ≤ÃÇs . Second, one solves (27) and the analogous problem for
Œ≤ÃÇ , both of which can similarly be reformulated as linear programs. Since Œ∫n > 0, these
programs will always be feasible. In practice, one would typically take M = Mfd , which
renders these programs finite-dimensional through the same argument as in (22) and (23).
Formally, if for every m = (m0  m1 ) ‚àà MS and Œ†m = (Œ†m0  Œ†m1 ) there is a sequence mn ‚àà MS such
that Œì  (mn ) ‚Üí Œì  (Œ†m), then Proposition 4 continues to hold. The assumption that (Œ†m0  Œ†m1 ) ‚àà M for
every m ‚àà M is simply a sufficient condition for this more general requirement.
10

1604

M. MOGSTAD, A. SANTOS, AND A. TORGOVITSKY

4. APPLICATIONS OF THE METHOD
4.1. Partial Identification of Policy Relevant Treatment Effects
The policy relevant treatment effect (PRTE) is the average causal effect on Y of changing from a baseline policy to an alternative policy that provides different incentives to participate in treatment (Heckman and Vytlacil (1999, 2005)). In many situations, this policy
comparison does not directly correspond to the variation in treatment induced by the instrument, so the PRTE is not point identified. In this section, we discuss how researchers
can use our method to construct bounds on the PRTE in such cases.
Consider a policy a that operates by changing factors that affect an agent‚Äôs treatment
decision. We follow Heckman and Vytlacil (1999, 2005) in assuming that a has no direct effect on the potential outcomes (Y0  Y1 ), and in particular that it does not affect the
parameter space M of admissible MTR functions. This assumption is similar to the exclusion restriction. The policy can then be summarized by a propensity score and instrument
pair (pa  Z a ). Treatment choice under policy a is given by

 
Da ‚â° 1 U ‚â§ pa Z a 
where U is the same unobservable term as in the selection equation for the status quo
policy, D. The outcome of Y that would be observed under the new policy is therefore


Y a = Da Y1 + 1 ‚àí Da Y0 
The PRTE of policy a1 relative to another policy a0 is defined as




E Y a1 ‚àí E Y a0


PRTE ‚â°  a 
E D 1 ‚àí E Da0

(28)

where we assume that E[Da1 ] = E[Da0 ].11
In Table I, we provide weights œâ0 and œâ1 that can be used to express the PRTE as
a target parameter Œ≤ with the form given in (6) for different policies a0 and a1 . After
choosing the weights that correspond to the policy comparison of interest, our method
can be used to estimate bounds for the PRTE. These bounds can be fully nonparametric,
but they can also incorporate parametric or shape restrictions if desired.
The way in which different policy comparisons translate into different weights is illustrated in Table I through the three specific examples considered by Carneiro, Heckman,
and Vytlacil (2011). Each of these comparisons is between a hypothetical policy a1 and the
status quo policy a0 , the latter of which is characterized by the pair (pa0  Z a0 ) = (p Z)
observed in the data. The comparisons are: (i) an additive Œ± change in the propensity
score, that is, pa1 = p + Œ±; (ii) a proportional (1 + Œ±) change in the propensity score, that
is, pa1 = (1 + Œ±)p; and (iii) an additive Œ± shift in the distribution the jth component of Z,
that is, Z a1 = Z + Œ±ej , where ej is the jth unit vector. The first and second of these represent policies that increase (or decrease) participation in the treatment by a given amount
Œ± or a proportional amount (1 + Œ±). The third policy represents the effect of shifting the
distribution of a variable that impacts treatment choice.
If this assumption is a concern, one can also define the PRTE as E[Y a1 ] ‚àí E[Y a0 ]; see Heckman and
Vytlacil (2001a) or pp. 380‚Äì381 of Carneiro, Heckman, and Vytlacil (2010). Our approach directly applies to
this definition as well.
11

USING INSTRUMENTAL VARIABLES FOR INFERENCE

1605

In all of these definitions, Œ± is a quantity that could either be hypothesized by the researcher, estimated from some auxiliary choice model, or extrapolated from the estimated
propensity score under parametric assumptions. For example, in the application in our
working paper (Mogstad, Santos, and Torgovitsky (2017)), we estimate the value of Œ± by
parametrically extrapolating a demand curve fit with experimentally varied prices. Since
Œ± is interpretable in terms of the change of treatment participation probability, a simpler
approach is to just specify a value of Œ± that represents an empirically interesting change
in the probability of choosing treatment.
4.2. Extrapolation of Local Average Treatment Effects
Imbens and Angrist (1994) showed that the LATE is point identified under the assumptions considered in this paper. As argued by Imbens (2010, pp. 414‚Äì415), it is desirable to
report both the LATE, with its high internal validity, but possibly limited external validity, and extrapolations of the LATE to larger or different populations. We now show how
to use our method to perform this type of extrapolation, thereby allowing researchers to
assess the sensitivity of a given LATE estimate to an expansion (or contraction) of the
complier subpopulation.
For doing this, it is useful to connect the LATE parameter to the PRTE. To see the
relationship, suppose that there are no covariates X, that is, Z = Z0 , and suppose that Z0
is binary. Consider the PRTE that results from comparing a policy a1 under which every
agent receives Z = 1 against a policy a0 under which every agent receives Z = 0. Choices
under these policies are




Da0 ‚â° 1 U ‚â§ p(0) and Da1 ‚â° 1 U ‚â§ p(1) 
where p(1) > p(0) are the propensity score values in the observed data. The PRTE for
this policy comparison is







E Da1 ‚àí Da0 (Y1 ‚àí Y0 )
E Y a1 ‚àí E Y a0



=
p(1) ‚àí p(0)
E Da1 ‚àí E Da0
(29)



= E Y1 ‚àí Y0 | U ‚àà p(0) p(1) 
where we used Da1 ‚àí Da0 = 1[U ‚àà (p(0) p(1)]]. The right-hand side of (29) is precisely
the LATE as defined by Imbens and Angrist (1994).
Extrapolation of the LATE amounts to changing p(0), p(1), or both. For example,
suppose that the researcher wants to examine the sensitivity of the LATE to an expansion of the complier subpopulation that includes individuals with lower willingness to pay
for treatment. This sensitivity check corresponds to shifting p(1) to p(1) + Œ± for Œ± > 0.
Arguing as in (29), the extrapolated LATE can be shown to be



(30)
PRTE(Œ±) = E Y1 ‚àí Y0 | U ‚àà p(0) p(1) + Œ± 
PRTE(Œ±) is still a LATE as defined by Heckman and Vytlacil (2005), but one that is not
point identified by the IV estimand unless Œ± = 0. As we discussed in the previous section,
we can use our method to bound PRTE(Œ±) for Œ± > 0.
To gain some intuition on the determinants of these bounds, we write PRTE(Œ±) as
PRTE(Œ±)


  p(1)+Œ±

1
p(1) ‚àí p(0)
LATE +
m1 (u) ‚àí m0 (u) du
=
Œ± + p(1) ‚àí p(0)
Œ± + p(1) ‚àí p(0) p(1)

1606

M. MOGSTAD, A. SANTOS, AND A. TORGOVITSKY

where LATE is the usual point identified LATE in (29). This decomposition shows that
the conclusions that can be drawn about PRTE(Œ±) depend on what can be said about
m1 (u) ‚àí m0 (u) for u ‚àà [p(1) p(1) + Œ±]. Therefore, restrictions on the parameter space
M of admissible MTR pairs translate directly into restrictions on the possible values of
PRTE(Œ±). For example, if we know bounds on the support of Y , which is always the
case if Y is binary or discrete, then even nonparametric bounds can be informative about
PRTE(Œ±).
Our method allows a researcher to formally and transparently balance their desire for
robust assumptions against their desire for broader extrapolation. Stronger assumptions
are reflected through a more restrictive parameter space M of admissible MTR pairs.
Less ambitious extrapolations are reflected through smaller values of Œ±. For a given Œ±,
more restrictive specifications of M yield smaller bounds, while for a given specification
of M, smaller values of Œ± also yield smaller bounds. Both margins can be smoothly adjusted, with point identification obtained as a limiting case as Œ± ‚Üí 0. We illustrate this
tradeoff in our numerical example in Section 5.
4.3. Testable Implications
If the set MS is empty, then the model is misspecified: There does not exist a pair of
MTR functions m that is in the parameter space (m ‚àà M), and which could have generated the observed data. If M is an unrestricted class of functions, then this is attributable
to a falsification of selection equation (2) together with Assumptions I. The testable implications of these assumptions for the IV model are well-known; see, for example, Balke
and Pearl (1997), Imbens and Rubin (1997), and Kitagawa (2015). On the other hand, if
other restrictions have been placed on M, then misspecification could be due either to
the failure of (2) with Assumptions I, or the specification of M, or both.
In our framework, this reasoning can be used more generally to provide testable implications about properties of the underlying MTR functions. For example, Table I reports
the weights that correspond to the quantity E[Y0 |D = 1] ‚àí E[Y0 |D = 0]. This quantity
is often described as a measure of selection bias, since it captures the extent to which
average untreated outcomes differ solely on the basis of treatment status. The weights


provide a linear mapping Œìsel
such that Œìsel
(m) indicates the amount of selection bias under an MTR pair m. Suppose that we restrict M to contain only MTR pairs m for which

Œìsel
(m) = 0. Then, rejecting the null hypothesis that MS is nonempty can be interpreted
as rejecting the hypothesis that there is no selection bias, as long as (2), Assumptions I,
and any other restrictions on M are not deemed suspect.
Alternatively, one might be interested in testing the joint hypothesis that there is no
selection on unobservables, that is, no selection bias and no selection on the gain. Weights
for a typical measure of selection on the gain are provided in Table I. These, too, provide a

linear mapping Œìgain
on the set of MTR pairs M. The hypothesis that there is no selection
on unobservables would be rejected if we were to reject the null hypothesis that MS

is nonempty when M is restricted to contain only MTR pairs m for which Œìsel
(m) =

Œìgain (m) = 0.
5. NUMERICAL ILLUSTRATION
In this section, we illustrate how to use our method to construct nonparametric bounds
on treatment parameters of interest, and how shape restrictions and parametric assumptions can be used to tighten these bounds.

USING INSTRUMENTAL VARIABLES FOR INFERENCE

1607

5.1. The Data Generating Process
We consider a simple example with a trinary instrument, Z ‚àà {0 1 2}, with P(Z = 0) =
05, P(Z = 1) = 04, and P(Z = 2) = 01. The propensity score is specified as p(0) =
035 p(1) = 06, and p(2) = 07. We take the outcome Y ‚àà {0 1} to be binary and restrict
M to contain only MTR pairs that are bounded between 0 and 1. The data are generated
using the MTR functions
m0 (u) = 06b20 (u) + 04b21 (u) + 03b22 (u)

and

m1 (u) = 075b20 (u) + 05b21 (u) + 025b22 (u)

(31)

where b2k is the kth Bernstein basis polynomial of degree 2.12
5.2. IV Estimand, Weights, and Target Parameter
Figure 1 contains two plots with two vertical axes. The left plot is for d = 0, while the
right plot is for d = 1, and both vertical axes apply to both plots. The left axis measures
weight functions, which are indicated in shades of gray and, for the sake of clarity, are
not drawn over regions where they are zero. The darker weights correspond to œâds when
s(D Z) is taken to be (10) so that Œ≤s is the IV slope coefficient estimand (7) from using
Z as an instrument for D. These weights are positive between the smallest and largest
values of the propensity score, that is, from p(0) = 035 to p(2) = 07, and they change
value at p(1) = 06.
As shown by Imbens and Angrist (1994), three LATEs are nonparametrically point
identified in this setting: LATE(035 06) LATE(035 07), and LATE(06 07). Suppose that the researcher wants to examine the sensitivity of these average causal effects to
an expansion of the complier subpopulation. Then they might be interested in the target

FIGURE 1.‚ÄîMTRs used in the data generating process (DGP).
12
Appendix S2 of the Supplemental Material contains the definition of the Bernstein polynomials, along
with a discussion of some useful properties of the Bernstein polynomial basis.

1608

M. MOGSTAD, A. SANTOS, AND A. TORGOVITSKY

parameter


LATE(035 09) ‚â° E Y1 ‚àí Y0 |U ‚àà (035 09] 
The weights for this parameter are drawn in medium gray in Figure 1. As shown in Table I,
the weights are constant over [035 09] with magnitude (09 ‚àí 035)‚àí1 ‚âà 181.
The right vertical axis in Figure 1 measures MTR functions for both the d = 0 and d = 1
plots. The MTR functions that were used to generate the data, that is, (31), are plotted
in black. These MTR functions imply a value of approximately 0074 for the IV slope
coefficient. By Proposition 1, this value is equal to the integral of the product of the black
and dark gray functions, summed over the d = 0 and d = 1 plots. Similarly, these MTR
functions imply a value of approximately 0046 for LATE(035 09) through an analogous
sum of integrals using the medium gray weights.
5.3. Bounds on the Target Parameter
Figure 2 is like Figure 1, except the MTR functions that are plotted yield the nonparametric upper bound on LATE(035 09), computed using a constant spline as discussed
in Section 3.1.13 The pair m ‚â° (m0  m1 ) in this plot is generated by trying to make m1
as large as possible, and m0 as small as possible, on the support of the medium gray
weights, while still yielding a value of 0074 for the IV slope coefficient determined by the
dark gray weights. These MTR functions imply a value of 05 for the target parameter
LATE(035 09), which is the largest value that is consistent with the IV slope estimand.
There are multiple pairs of MTR functions with this property. In particular, notice that
neither weight is positive over the region [0 035], so that MTR pairs may be freely adjusted on this region without changing the implied values of the IV slope estimand or

FIGURE 2.‚ÄîMaximizing MTRs when using only the IV slope coefficient.
13
This amounts to solving two linear programs. We wrote these programs in AMPL (Fourer, Gay, and
Kernighan (2002)) and solved them with Gurobi (Gurobi Optimization (2015)).

USING INSTRUMENTAL VARIABLES FOR INFERENCE

1609

FIGURE 3.‚ÄîMaximizing MTRs when using both the IV and OLS slope coefficients.

LATE(035 09). The lower bound of ‚àí0421 indicated in Figure 2 is obtained through
an analogous minimization problem that follows the same logic.
Figure 3 repeats this exercise while including a second IV-like estimand. The second
estimand is the OLS slope coefficient, whose weights are drawn in light gray. Notice that,
whereas the medium and dark gray weights are symmetric between d = 0 and d = 1 in
the sense of having the same magnitude but different signs, the light gray weights for
the OLS slope coefficient are asymmetric. A maximizing or minimizing MTR pair must
yield the implied values for both the IV slope coefficient and the OLS slope coefficient,
which is approximately 0253. In this DGP, the additional constraint from the OLS slope
coefficient has no effect on the upper bound of LATE(035 09), but does tighten the
lower bound slightly from ‚àí0421 to ‚àí0411.
In Figure 4, instead of using Z as a single instrument, we split Z into two binary indicators, 1[Z = 2] and 1[Z = 3], to create two IV slope estimands. This tightens both bounds
on LATE(035 09) considerably. The tightest possible nonparametric bounds are obtained in Figure 5, which includes a collection of six IV-like specifications that is rich
enough to satisfy the conditions of Proposition 3. The resulting bounds of [‚àí0138 0407]
are the sharp nonparametric bounds for LATE(035 09).
The bounds in Figure 5 can be tightened by imposing nonparametric shape restrictions. For example, in Figure 6, the MTR functions are restricted to be decreasing like
the DGP MTR functions shown in Figure 1. This tightens the sharp identified set for
LATE(035 09) by ruling out non-decreasing MTR pairs like the one shown in Figure 5.
Even tighter bounds can be obtained by also requiring the MTR functions to be smooth.
This may be a desirable a priori assumption if one believes that the jump-discontinuous
MTR pairs in Figure 6 are sufficiently poorly behaved as to be an unlikely description of
the relationship between selection unobservables, U, and potential outcomes, Y0 and Y1 .
For example, in Figure 7, the MTR functions are restricted to be decreasing and characterizable by a polynomial of order 9. This eliminates the possibility of non-smooth MTR
functions like those in Figure 6, and in this example reduces the bounds to [0 0067].

1610

M. MOGSTAD, A. SANTOS, AND A. TORGOVITSKY

FIGURE 4.‚ÄîMaximizing MTRs when breaking the IV slope into two components.

5.4. Tradeoffs Between Tightness and Extrapolation
Figure 8 illustrates how the bounds change as the parameter of interest changes. In
particular, instead of LATE(035 09), we construct bounds on


LATE(035 u) ‚â° E Y1 ‚àí Y0 |U ‚àà (035 u] 
for different values of u, using the same specification as in Figure 7. Sharp lower and upper bounds on this parameter are given by the gray curves. As evident from Figure 8, the

FIGURE 5.‚ÄîMaximizing MTRs when using all IV-like estimands (sharp bounds).

USING INSTRUMENTAL VARIABLES FOR INFERENCE

1611

FIGURE 6.‚ÄîMaximizing MTRs when restricted to be decreasing.

bounds collapse to a point for u = 06 and 07, that is, the two other points of support for
the propensity score. For these values of u, LATE(035 u) is a point identified LATE as
in Imbens and Angrist (1994). For other values of u, this parameter is not point identified,
such as for u = 09, which is indicated by the dotted vertical line. For u between 06 and
07, the bounds are very tight, as shown in the magnified region. As u decreases from 06
or increases above 07, the bounds widen.

FIGURE 7.‚ÄîMaximizing MTRs when further restricted to be a 10th-order polynomial.

1612

M. MOGSTAD, A. SANTOS, AND A. TORGOVITSKY

FIGURE 8.‚ÄîBounds on a family of PRTEs.

This property reflects the increasing difficulty of drawing inference about a parameter
the more dissimilar it is from what was observed in the data, that is, the more extrapolation
it requires. Given a desired tightness of the bounds, a more ambitious extrapolation can
be obtained only by imposing stronger assumptions. Given a set of assumptions, tighter
bounds can be obtained only by less ambitious extrapolations. Our framework allows the
researcher to achieve bounds that are as narrow as they desire, while requiring them to
honestly acknowledge the strength of their assumptions and the degree of extrapolation
involved in their counterfactual.
6. DISCUSSION: WHEN TO USE OUR METHOD
We have proposed a method for using instrumental variables to draw inference about
a wide range of treatment parameters other than the LATE. This enables researchers to
learn about causal effects for a broad range of individuals, not just those who are affected
by the instrument observed in the data. The ability to do this is critical to ensuring that estimates obtained through IV strategies are both externally valid and relevant to policy. An
important aspect of our method is that it allows the researcher a large amount of flexibility in choosing a parameter of interest, and in choosing auxiliary identifying assumptions
that can be used to help tighten their empirical conclusions.
Our method can be used to analyze conventional treatment parameters such as the
ATE, the ATT, and the ATU. These parameters are relevant for policy counterfactuals
that hypothesize mandating a choice of treatment. However, many policy discussions focus on interventions that change the costs or benefits of choosing certain activities, while
still allowing individuals to freely select into these activities. Our method is especially
useful for these settings, since it allows researchers to draw inference about target parameters in the class of PRTEs. These parameters are useful for analyzing interventions that
influence (but may not fully determine) an individual‚Äôs treatment choice, for example by

USING INSTRUMENTAL VARIABLES FOR INFERENCE

1613

changing the costs associated with the treatment alternatives. These types of interventions
will often involve extrapolation to new environments, which makes our focus on partial
identification natural.
Partial identification approaches are sometimes criticized for yielding empirical conclusions that are insufficiently informative for practitioners. Computational methods, such as
the one proposed in this paper, are useful tools for answering this criticism. The flexibility
of our framework means that a researcher can smoothly adjust their policy question (target parameter), or the assumptions they are willing to maintain, in a way that approaches
point identification as a special case. As a result, the tightness of the bounds they report
is at their discretion, while still being disciplined by the reality that stronger conclusions
require stronger assumptions.
One common empirical setting for which our method is particularly well suited is when
the instrument is based on the lack of pattern or predictability in a natural event that
cannot be shifted by policy, such as the weather (Angrist, Graddy, and Imbens (2000),
Miguel, Satyanath, and Sergenti (2004)), or the gender composition of children (Angrist
and Evans (1998), Black, Devereux, and Salvanes (2005)). Instruments derived from such
‚Äúnatural experiments‚Äù are popular in empirical work due to their apparent exogeneity.
However, the associated LATEs can have low external validity, since the group of individuals whose behavior is affected by a natural experiment is likely to be different from the
group of individuals who would be affected under an interesting policy counterfactual.
Our method can be used to rigorously address this critique by analyzing the sensitivity of
the empirical conclusions to the size or composition of the group affected by the natural
experiment.
Another common application for our method is when the instrument represents a past
policy change, but the researcher is interested in the effect of expanding or contracting the policy. In this case, standard IV methods already identify the causal effect for
individuals whose treatment choice was affected by the prior policy change. However,
using the previous change to inform about a new expansion requires extrapolation. Our
method can be used to conduct this extrapolation rigorously. For example, in our working
paper (Mogstad, Santos, and Torgovitsky (2017)), we apply our method to analyze how
actual and counterfactual price subsidies affect the adoption and usage of antimalarial
bed nets in Kenya. Our results there suggest that generous subsidy regimes encourage
usage among individuals who would otherwise not use a bed net, albeit at a high cost of
subsidizing other inframarginal individuals.
APPENDIX: PROOFS
PROOF OF PROPOSITION 1: Using equation (1), we first note that




Œ≤s = E s(D Z)DY1 + E s(D Z)(1 ‚àí D)Y0 

(32)

Using equation (2) with Assumptions I.1 and I.2, observe that the first term of (32) can
be written as






E s(D Z)DY1 = E s(D Z)1 U ‚â§ p(Z) E[Y1 |U Z]
(33)




‚â° E s(1 Z)1 U ‚â§ p(Z) m1 (U X) 

1614

M. MOGSTAD, A. SANTOS, AND A. TORGOVITSKY

where the first equality follows because s(D Z)D is a deterministic function of (U Z),
and the second equality uses the definition of m1 and I.2, together with the identity that


 
  



s(D Z)1 U ‚â§ p(Z) ‚â° s 1 U ‚â§ p(Z)  Z 1 U ‚â§ p(Z) = s(1 Z)1 U ‚â§ p(Z) 
Using the normalization that the distribution of U conditional on Z is uniformly distributed on [0 1] for any realization of Z, it follows from (33) that



 


E s(D Z)DY1 = E E s(1 Z)1 U ‚â§ p(Z) m1 (U X)|Z
 1


=E
s(1 Z)1 u ‚â§ p(Z) m1 (u X) du


0
1

‚â°E

œâ1s (u Z)m1 (u X) du 
0

The claimed result follows after applying a symmetric argument to the second term on
the right-hand side of equation (32).
Q.E.D.
PROOF OF PROPOSITION 2: Since Œìs : M ‚Üí R is linear for every s ‚àà S , it follows from
convexity of M that MS is convex as well. (Note that the empty set is trivially convex.)
If MS is empty, then by definition we also have BS = ‚àÖ. On the other hand, if MS = ‚àÖ,
then the linearity of Œì  : M ‚Üí R implies that BS ‚â° Œì  (MS ) ‚äÜ R is a convex set, and so
its closure is [infm‚ààMS Œì  (m) supm‚ààMS Œì  (m)] ‚â° [Œ≤  Œ≤ ].
Q.E.D.
PROOF OF PROPOSITION 3: For notational simplicity, we define the set

Mid ‚â° m ‚àà M : m satisfies (14) and (15) almost surely 
For any m ‚â° (m0  m1 ) ‚àà Mid and s ‚àà S , we obtain from the definition of Œ≤s that
 



E 1[D = d]s(d Z)E[Y |D = d Z] 
Œ≤s = E s(D Z)E[Y |D Z] =

(34)

d‚àà{01}

Examining the d = 0 term in the summation, we obtain


E 1[D = 0]s(0 Z)E[Y |D = 0 Z]

 1
1

= E 1[D = 0]s(0 Z) 
m0 (u X) du
1 ‚àí p(Z) p(Z)

 1
1

= E 1[D = 0] 
m0 (u X)œâ0s (u Z) du
1 ‚àí p(Z) 0
 1
=E
m0 (u X)œâ0s (u Z) du 

(35)

0

where the first equality follows from m ‚àà Mid satisfying (14), the second equality uses
the definition œâ0s (u z) ‚â° s(0 z)1[u > p(z)], and the final equality is implied by P(D =
0|Z) = 1 ‚àí p(Z). By analogous arguments, we also obtain
 1


m1 (u X)œâ1s (u Z) du 
(36)
E 1[D = 1]s(1 Z)E[Y |D = 1 Z] = E
0

1615

USING INSTRUMENTAL VARIABLES FOR INFERENCE

Together, (34), (35), and (36) imply that Œìs (m) = Œ≤s . In particular, since s ‚àà S and m ‚àà
Mid were arbitrary, we conclude that Mid ‚äÜ MS , as claimed.
Next, suppose S = {s(d z) = 1[d = d ]f (z) : (d  f ) ‚àà {0 1} √ó F } and that the closed
linear span of F is equal to L2 (Z). Then note that for any m ‚àà MS and s ‚àà S with the
structure s(d z) = 1[d = 0]f (z), we obtain by definition of Œ≤s and Œìs that


E Y 1[D = 0]f (Z) ‚â° Œ≤s = Œìs (m) = E



1

m0 (u X) du √ó f (Z) 

(37)

p(Z)

where the second equality follows from m ‚àà MS and the final equality is due to
œâ0s (u z) ‚â° 1[u > p(z)]s(0 z) and s(0 z) = 1[0 = 0]f (z). Furthermore, define






1

Œî(Z) ‚â° E Y 1[D = 0]|Z ‚àí

m0 (u X) du

(38)

p(Z)

and note that (37) implies that E[Œî(Z)f (Z)] = 0 for all f ‚àà F . Since E[Y02 ] < ‚àû by
Assumption I.2 and E[ m2d (u X) du] < ‚àû, Jensen‚Äôs inequality implies that Œî ‚àà L2 (Z).
Thus, since E[Œî(Z)f (Z)] = 0 for all f ‚àà F and the closed linear span of F equals L2 (Z),
we conclude that Œî(Z) = 0 almost surely. Equivalently, since P(D = 0|Z) = 1 ‚àí p(Z) by
definition of p(Z), we obtain whenever 1 ‚àí p(Z) > 0 that
1
E[Y |D = 0 Z] =
1 ‚àí p(Z)



1

m0 (u X) du

(39)

p(Z)

almost surely, that is, m0 satisfies (14). Analogous arguments imply that m1 satisfies (15).
Since (m0  m1 ) = m ‚àà MS was arbitrary, we conclude that MS ‚äÜ Mid , which together
with (16) establishes (17).
Q.E.D.
PROOF OF PROPOSITION 4: We prove the proposition for the upper bound of the target
parameter. The proof for the lower bound follows by identical arguments.
Observe that since Mfd ‚äÜ M by definition of Mfd , we can immediately conclude that
Œ≤fd ‚â§ Œ≤ . To establish the opposite inequality, we show that Œìds (Œ†md ) = Œìds (md ) for any
(m0  m1 ) ‚àà M, where Œ†md is defined as in (26). As shorthand, let Œºjl ‚â° E[md (U xl )|U ‚àà
Uj  X = xl ] in the definition of Œ†md . Then
 
Œìds (Œ†md ) ‚â° E

=E

 L


L
J





Œºjl bjl (u X) œâds (u Z) du

j=1 l=1

1[X = xl ]

l=1

=E



 L K
l

l=1 k=1



J 

j=1

Œºjl œâds (u Z) du

(40)

Uj

1[X = xl  Z = zlk ]

J 

j=1


Œºjl œâds (u zlk ) du 

Uj

where the second equality uses the definition of bjl in (25), and the third equality follows
Kl
. Since Uj is assumed
after enumerating the support of Z, conditional on X = xl , as {zlk }k=1

1616

M. MOGSTAD, A. SANTOS, AND A. TORGOVITSKY

to be constructed so that 1[u ‚â§ p(z)], and hence œâds (u z) are constant over Uj , it follows
that
J 

j=1

‚â°

Œºjl œâds (u zlk ) du
Uj

J 

Uj

j=1

=



E md (U xl )|U ‚àà Uj  X = xl œâds (u zlk ) du

J



E md (U xl )œâds (U zlk )|U ‚àà Uj  X = xl P[U ‚àà Uj ]

(41)

j=1

=

J 




md (u xl )œâds (u zlk ) du
Uj

j=1
1

=

md (u xl )œâds (u zlk ) du
0

where the second and third equalities used the normalization that U is uniformly distributed over [0 1], conditional on X. Substituting (41) into (40), we have
Œìds (Œ†md ) = E

 L K
l



1[X = xl  Z = zlk ]

md (u xl )œâds (u zlk ) du
0

l=1 k=1





1

1

md (u X)œâds (u Z) du ‚â° Œìds (md )

=E
0

as claimed. An identical argument yields Œìd (md ) = Œìd (Œ†md ). Given the assumption that
Œ†m ‚â° (Œ†m0  Œ†m1 ) ‚àà Mfd for every m ‚àà M, it follows that
Œ≤ ‚â° sup Œì  (m) s.t. Œìs (m) = Œ≤s for all s ‚àà S
m‚ààM

= sup Œì  (Œ†m) s.t. Œìs (Œ†m) = Œ≤s for all s ‚àà S
m‚ààM

(42)

‚â§ sup Œì  (mÃÉ) s.t. Œìs (mÃÉ) = Œ≤s for all s ‚àà S ‚â° Œ≤fd 
mÃÉ‚ààMfd

We conclude that Œ≤fd = Œ≤ .

Q.E.D.
REFERENCES

ABADIE, A., J. ANGRIST, AND G. IMBENS (2002): ‚ÄúInstrumental Variables Estimates of the Effect of Subsidized
Training on the Quantiles of Trainee Earnings,‚Äù Econometrica, 70 (1), 91‚Äì117. [1601]
ANGRIST, J. D., AND W. N. EVANS (1998): ‚ÄúChildren and Their Parents‚Äô Labor Supply: Evidence From Exogenous Variation in Family Size,‚Äù The American Economic Review, 88 (3), 450‚Äì477. [1613]
ANGRIST, J. D., AND I. FERNANDEZ-VAL (2013): ‚ÄúExtrapoLATE-ing: External Validity and Overidentification
in the LATE Framework,‚Äù in Advances in Economics and Econometrics: Volume 3, Econometrics: Tenth World
Congress, Vol. 51. Cambridge University Press, 401. [1591]

USING INSTRUMENTAL VARIABLES FOR INFERENCE

1617

ANGRIST, J. D., AND G. W. IMBENS (1995): ‚ÄúTwo-Stage Least Squares Estimation of Average Causal Effects
in Models With Variable Treatment Intensity,‚Äù Journal of the American Statistical Association, 90 (430), 431‚Äì
442. [1590]
ANGRIST, J. D., K. GRADDY, AND G. W. IMBENS (2000): ‚ÄúThe Interpretation of Instrumental Variables Estimators in Simultaneous Equations Models With an Application to the Demand for Fish,‚Äù The Review of
Economic Studies, 67 (3), 499‚Äì527. [1590,1613]
BALKE, A., AND J. PEARL (1997): ‚ÄúBounds on Treatment Effects From Studies With Imperfect Compliance,‚Äù
Journal of the American Statistical Association, 92 (439), 1171‚Äì1176. [1591,1606]
BHATTACHARYA, J., A. M. SHAIKH, AND E. VYTLACIL (2012): ‚ÄúTreatment Effect Bounds: An Application to
Swan‚ÄìGanz Catheterization,‚Äù Journal of Econometrics, 168 (2), 223‚Äì243. [1591]
BIERENS, H. J. (1990): ‚ÄúA Consistent Conditional Moment Test of Functional Form,‚Äù Econometrica: Journal
of the Econometric Society, 58 (6), 1443‚Äì1458. [1599]
BLACK, S. E., P. J. DEVEREUX, AND K. G. SALVANES (2005): ‚ÄúThe More the Merrier? The Effect of Family
Size and Birth Order on Children‚Äôs Education,‚Äù The Quarterly Journal of Economics, 120 (2), 669‚Äì700. [1613]
BRINCH, C. N., M. MOGSTAD, AND M. WISWALL (2012): ‚ÄúBeyond LATE With a Discrete Instrument,‚Äù Working
Paper. [1599]
(2017): ‚ÄúBeyond LATE With a Discrete Instrument,‚Äù Journal of Political Economy, 125 (4), 985‚Äì1039.
[1591,1593,1599,1600]
CARNEIRO, P., J. J. HECKMAN, AND E. VYTLACIL (2010): ‚ÄúEvaluating Marginal Policy Changes and the Average Effect of Treatment for Individuals at the Margin,‚Äù Econometrica, 78 (1), 377‚Äì394. [1591,1600,1604]
CARNEIRO, P., J. J. HECKMAN, AND E. J. VYTLACIL (2011): ‚ÄúEstimating Marginal Returns to Education,‚Äù
American Economic Review, 101 (6), 2754‚Äì2781. [1591,1594,1600,1604]
CHEN, X. (2007): ‚ÄúChapter 76 Large Sample Sieve Estimation of Semi-Nonparametric Models,‚Äù in Handbook
of Econometrics, Vol. 6, Part 2, ed. by J. J. Heckman and E. E. Leamer. Elsevier, 5549‚Äì5632. [1601]
CHESHER, A. (2003): ‚ÄúIdentification in Nonseparable Models,‚Äù Econometrica, 71 (5), 1405‚Äì1441. [1590]
DUPAS, P. (2014): ‚ÄúShort-Run Subsidies and Long-Run Adoption of New Health Products: Evidence From a
Field Experiment,‚Äù Econometrica, 82 (1), 197‚Äì228. [1592]
FLORENS, J. P., J. J. HECKMAN, C. MEGHIR, AND E. VYTLACIL (2008): ‚ÄúIdentification of Treatment Effects
Using Control Functions in Models With Continuous, Endogenous Treatment and Heterogeneous Effects,‚Äù
Econometrica, 76 (5), 1191‚Äì1206. [1590]
FOURER, R., D. M. GAY, AND B. W. KERNIGHAN (2002): AMPL: A Modeling Language for Mathematical Programming. Cengage Learning. [1608]
FRENCH, E., AND J. SONG (2014): ‚ÄúThe Effect of Disability Insurance Receipt on Labor Supply,‚Äù American
Economic Journal: Economic Policy, 6 (2), 291‚Äì337. [1593]
GUROBI OPTIMIZATION, INC. (2015): ‚ÄúGurobi Optimizer Reference Manual.‚Äù [1608]
HECKMAN, J., J. L. TOBIAS, AND E. VYTLACIL (2003): ‚ÄúSimple Estimators for Treatment Parameters in a
Latent-Variable Framework,‚Äù Review of Economics and Statistics, 85 (3), 748‚Äì755. [1591]
HECKMAN, J. J., AND R. ROBB, JR. (1985): ‚ÄúAlternative Methods for Evaluating the Impact of Interventions,‚Äù
in Longitudinal Analysis of Labor Market Data, ed. by J. J. Heckman and B. Singer. Cambridge University
Press. [1591]
HECKMAN, J. J., AND S. URZUA (2010): ‚ÄúComparing IV With Structural Models: What Simple IV can and
Cannot Identify,‚Äù Journal of Econometrics, 156 (1), 27‚Äì37. [1590]
HECKMAN, J. J., AND E. VYTLACIL (2001a): ‚ÄúPolicy-Relevant Treatment Effects,‚Äù The American Economic
Review, 91 (2), 107‚Äì111. [1590,1591,1604]
(2005): ‚ÄúStructural Equations, Treatment Effects, and Econometric Policy Evaluation,‚Äù Econometrica, 73 (3), 669‚Äì738. [1590-1593,1596,1600,1604,1605]
HECKMAN, J. J., AND E. J. VYTLACIL (1999): ‚ÄúLocal Instrumental Variables and Latent Variable Models for
Identifying and Bounding Treatment Effects,‚Äù Proceedings of the National Academy of Sciences of the United
States of America, 96 (8), 4730‚Äì4734. [1590,1592,1593,1600,1602,1604]
(2001b): ‚ÄúInstrumental Variables, Selection Models, and Tight Bounds on the Average Treatment
Effect,‚Äù in Econometric Evaluations of Active Labor Market Policies in Europe, ed. by M. Lechner and F.
Pfeiffer. Heidelberg and Berlin: Physica. [1590,1591]
(2001c): ‚ÄúLocal Instrumental Variables,‚Äù in Nonlinear Statistical Modeling: Proceedings of the Thirteenth International Symposium in Economic Theory and Econometrics: Essays in Honor of Takeshi Amemiya,
ed. by K. M. C. Hsiao and J. Powell. Cambridge University Press. [1590,1600]
(2007a): ‚ÄúChapter 70 Econometric Evaluation of Social Programs, Part I: Causal Models, Structural Models and Econometric Policy Evaluation,‚Äù in Handbook of Econometrics, Vol. 6, Part 2, ed. by J. J.
Heckman and E. E. Leamer. Elsevier, 4779‚Äì4874. [1590]

1618

M. MOGSTAD, A. SANTOS, AND A. TORGOVITSKY

(2007b): ‚ÄúChapter 71 Econometric Evaluation of Social Programs, Part II: Using the Marginal Treatment Effect to Organize Alternative Econometric Estimators to Evaluate Social Programs, and to Forecast
Their Effects in New Environments,‚Äù in Handbook of Econometrics, Vol. 6, Part 2, ed. by J. J. Heckman and
E. E. Leamer. Elsevier, 4875‚Äì5143. [1590]
HECKMAN, J. J., S. URZUA, AND E. VYTLACIL (2006): ‚ÄúUnderstanding Instrumental Variables in Models With
Essential Heterogeneity,‚Äù Review of Economics and Statistics, 88 (3), 389‚Äì432. [1590]
HUBER, M., AND G. MELLACE (2014): ‚ÄúTesting Instrument Validity for LATE Identification Based on Inequality Moment Constraints,‚Äù Review of Economics and Statistics, 97 (2), 398‚Äì411. [1591]
IMBENS, G. W. (2010): ‚ÄúBetter LATE Than Nothing: Some Comments on Deaton (2009) and Heckman and
Urzua (2009),‚Äù Journal of Economic Literature, 48 (2), 399‚Äì423. [1605]
IMBENS, G. W., AND J. D. ANGRIST (1994): ‚ÄúIdentification and Estimation of Local Average Treatment Effects,‚Äù Econometrica, 62 (2), 467‚Äì475. [1589-1592,1605,1607,1611]
IMBENS, G. W., AND W. K. NEWEY (2009): ‚ÄúIdentification and Estimation of Triangular Simultaneous Equations Models Without Additivity,‚Äù Econometrica, 77 (5), 1481‚Äì1512. [1590]
IMBENS, G. W., AND D. B. RUBIN (1997): ‚ÄúEstimating Outcome Distributions for Compliers in Instrumental
Variables Models,‚Äù The Review of Economic Studies, 64 (4), 555‚Äì574. [1591,1606]
KIRKEBOEN, L., E. LEUVEN, AND M. MOGSTAD (2016): ‚ÄúField of Study, Earnings and Self-Selection,‚Äù The
Quarterly Journal of Economics, 131 (3), 1057‚Äì1111. [1590]
KITAGAWA, T. (2009): ‚ÄúIdentification Region of the Potential Outcome Distributions Under Instrument Independence,‚Äù Cemmap Working Paper. [1591]
(2015): ‚ÄúA Test for Instrument Validity,‚Äù Econometrica, 83 (5), 2043‚Äì2063. [1591,1606]
KOWALSKI, A. (2016): ‚ÄúDoing More When You‚Äôre Running LATE: Applying Marginal Treatment Effect Methods to Examine Treatment Effect Heterogeneity in Experiments,‚Äù Working Paper 22363, NBER. [1599]
LEE, S., AND B. SALANI√â (2016): ‚ÄúIdentifying Effects of Multivalued Treatments,‚Äù Working Paper. [1590]
MACHADO, C., A. M. SHAIKH, AND E. J. VYTLACIL (2013): ‚ÄúInstrumental Variables and the Sign of the Average Treatment Effect,‚Äù Working Paper. [1591]
MAESTAS, N., K. J. MULLEN, AND A. STRAND (2013): ‚ÄúDoes Disability Insurance Receipt Discourage Work?
Using Examiner Assignment to Estimate Causal Effects of SSDI Receipt,‚Äù The American Economic Review,
103 (5), 1797‚Äì1829. [1594]
MANSKI, C. F. (1989): ‚ÄúAnatomy of the Selection Problem,‚Äù The Journal of Human Resources, 24 (3), 343‚Äì360.
[1591]
(1990): ‚ÄúNonparametric Bounds on Treatment Effects,‚Äù The American Economic Review, 80 (2),
319‚Äì323. [1591]
(1994): ‚ÄúThe Selection Problem,‚Äù in Advances in Econometrics, Sixth World Congress, Vol. 1, 143‚Äì170.
[1591]
(1997): ‚ÄúMonotone Treatment Response,‚Äù Econometrica, 65 (6), 1311‚Äì1334. [1591,1600]
(2003): Partial Identification of Probability Distributions. Springer. [1591]
MANSKI, C. F., AND J. V. PEPPER (2000): ‚ÄúMonotone Instrumental Variables: With an Application to the
Returns to Schooling,‚Äù Econometrica, 68 (4), 997‚Äì1010. [1591,1600]
(2009): ‚ÄúMore on Monotone Instrumental Variables,‚Äù Econometrics Journal, 12, S200‚ÄìS216. [1591]
MASTEN, M. A. (2015): ‚ÄúRandom Coefficients on Endogenous Variables in Simultaneous Equations Models,‚Äù
The Review of Economic Studies, 85, 1193‚Äì1250. [1590]
MASTEN, M. A., AND A. TORGOVITSKY (2016): ‚ÄúIdentification of Instrumental Variable Correlated Random
Coefficients Models,‚Äù Review of Economics and Statistics, 98, 1001‚Äì1005. [1590]
MIGUEL, E., S. SATYANATH, AND E. SERGENTI (2004): ‚ÄúEconomic Shocks and Civil Conflict: An Instrumental
Variables Approach,‚Äù Journal of Political Economy, 112 (4), 725‚Äì753. [1613]
MOFFITT, R. (2008): ‚ÄúEstimating Marginal Treatment Effects in Heterogeneous Populations,‚Äù Annales
d‚Äô√âconomie et de Statistique, 91 (91/92), 239‚Äì261. [1593]
MOGSTAD, M., A. SANTOS, AND A. TORGOVITSKY (2017): ‚ÄúUsing Instrumental Variables for Inference About
Policy Relevant Treatment Parameters,‚Äù Working Paper, NBER. [1592,1603,1605,1613]
(2018): ‚ÄúSupplement to ‚ÄòUsing Instrumental Variables for Inference About Policy Relevant Treatment Parameters‚Äô,‚Äù Econometrica Supplemental Material, 86, https://doi.org/10.3982/ECTA15463. [1596]
MOURIFI√â, I. (2015): ‚ÄúSharp Bounds on Treatment Effects in a Binary Triangular System,‚Äù Journal of Econometrics, 187 (1), 74‚Äì81. [1591]
MOURIFI√â, I., AND Y. WAN (2016): ‚ÄúTesting Local Average Treatment Effect Assumptions,‚Äù The Review of
Economics and Statistics, 99 (2), 305‚Äì313. [1591]
SHAIKH, A. M., AND E. J. VYTLACIL (2011): ‚ÄúPartial Identification in Triangular Systems of Equations With
Binary Dependent Variables,‚Äù Econometrica, 79 (3), 949‚Äì955. [1591]

USING INSTRUMENTAL VARIABLES FOR INFERENCE

1619

STINCHCOMBE, M. B., AND H. WHITE (1998): ‚ÄúConsistent Specification Testing With Nuisance Parameters
Present Only Under the Alternative,‚Äù Econometric theory, 14 (03), 295‚Äì325. [1599]
TORGOVITSKY, A. (2015): ‚ÄúIdentification of Nonseparable Models Using Instruments With Small Support,‚Äù
Econometrica, 83 (3), 1185‚Äì1197. [1590]
VYTLACIL, E. (2002): ‚ÄúIndependence, Monotonicity, and Latent Index Models: An Equivalence Result,‚Äù
Econometrica, 70 (1), 331‚Äì341. [1590,1592]

Co-editor Liran Einav handled this manuscript.
Manuscript received 25 June, 2017; final version accepted 31 May, 2018; available online 1 June, 2018.

