JOURNAL OF APPLIED ECONOMETRICS
J. Appl. Econ. 32: 56–79 (2017)
Published online 15 June 2015 in Wiley Online Library
(wileyonlinelibrary.com) DOI: 10.1002/jae.2473

SHARP IV BOUNDS ON AVERAGE TREATMENT EFFECTS ON
THE TREATED AND OTHER POPULATIONS UNDER
ENDOGENEITY AND NONCOMPLIANCE
MARTIN HUBER,a LUKAS LAFFERSb AND GIOVANNI MELLACEc*
a
Department of Economics, University of Fribourg, Switzerland
Department of Mathematics, Matej Bel University, Banská Bystrica, Slovakia
Department of Business and Economics, University of Southern Denmark, Odense, Denmark
b

c

SUMMARY
In the presence of an endogenous binary treatment and a valid binary instrument, causal effects are point identified
only for the subpopulation of compliers, given that the treatment is monotone in the instrument. With the exception
of the entire population, causal inference for further subpopulations has been widely ignored in econometrics. We
invoke treatment monotonicity and/or dominance assumptions to derive sharp bounds on the average treatment
effects on the treated, as well as on other groups. Furthermore, we use our methods to assess the educational
impact of a school voucher program in Colombia and discuss testable implications of our assumptions.Copyright
© 2015 John Wiley & Sons, Ltd.
Received 9 May 2012; Revised 16 February 2015
Supporting information may be found in the online version of this article.

1. INTRODUCTION
Endogeneity of the (binary) treatment variable and noncompliance to the treatment assignment in
randomized experiments are widespread phenomena in the evaluation of treatment effects (see, for
instance, Bloom (1984). Given a valid instrumental variable (IV) that is randomly assigned and has
no direct effect on the mean potential outcomes and (weakly) positive monotonicity of the treatment
in the instrument, Imbens and Angrist (1994) (see also Angrist et al., 1996) show that the average
treatment effect (ATE) is only identified in the subpopulation of compliers. The latter correspond to
those whose the treatment status is equal to (i.e. reacts on) the instrument if both the treatment and the
instrument are binary.
Whether the local average treatment effect (LATE) is a relevant parameter heavily depends on the
empirical context and has been controversially discussed in the literature (see, for instance, Imbens,
2009; Deaton, 2010; Heckman and Urzúa, 2010). Typically, researchers would like to identify the
ATEs on the treated or the entire population. Note that these parameters are themselves weighted averages of the ATEs on several subpopulations, including the always takers (always treated irrespective
of the instrument) and the never takers (never treated irrespective of the instrument). Maybe due to the
fact that in a nonparametric framework point identification is generally not feasible for the never takers,
always takers, the treated, and the entire population (unless the complier share is 100%), groups other
than the compliers have (apart from the entire population) been widely ignored in the econometric
literature.1
* Correspondence to: Giovanni Mellace, Department of Business and Economics, University of Southern Denmark, Campusvej,
55, 5230 Odense M, Denmark. E-mail: giome@sam.sdu.dk
1
An exception is Frölich and Lechner (2010), who also point identify the ATEs on the always takers and never takers. To
this end, they invoke both IV and selection on observables (or conditional independence (see, for instance, Imbens’, 2004,
assumptions). However, this identification strategy stands in contrast to virtually all other IV applications, where an instrument
is used exactly for the reason that no other source of identification (such as selection on observables) is available.

Copyright © 2015 John Wiley & Sons, Ltd.

SHARP IV BOUNDS ON AVERAGE TREATMENT EFFECTS

57

The main contribution of this paper is to derive nonparametric bounds on ATEs of populations
that are potentially more policy relevant than the LATE on the compliers, which may not be externally valid. In particular, we also consider the treated population, which is of major interest in the
program evaluation literature to assess the program effects on actual participants. In contrast to the
commonly invoked full independence between the instrument and the potential outcomes/treatment
states, we only assume mean independence between the instrument and the potential outcomes (within
subpopulations) as well as the subpopulations. Moreover, we discuss the identifying power of (i)
monotonicity of the treatment in the instrument and/or (ii) mean dominance of the potential outcomes
of one subpopulation over the others. Monotonicity and dominance, either w.r.t. the mean or to the
entire distribution (i.e. stochastic dominance), have also been considered in a different context, namely
under non-random sample selection and attrition (see, for instance, Zhang and Rubin, 2003; Lechner
and Melly, 2007; Blundell et al., 2007; Zhang et al., 2008; Lee, 2009; Huber and Mellace, 2015a). We
use the principal stratification framework suggested by Frangakis and Rubin (2002) to derive sharp
bounds for the ATEs on the always takers, never takers, the treated, the non-treated, and the entire
population.2 As a further contribution, we find testable implications of the IV mean independence
within subpopulations and mean dominance when monotonicity is invoked.
Partial identification of economic parameters in general goes back to Manski (1989, 1994) and
Robins (1989). Previous work on nonparametric bounds under treatment endogeneity, which is the
problem considered here, has almost exclusively focused on the ATE in the entire population,3 but
neglected further populations. For example, Manski (1990) bounds the ATE by solely relying on independence between the mean potential outcomes and the instrument.4 Considering binary outcomes,
Balke and Pearl (1997) provide sharp bounds for the ATE under full (rather than mean) independence
between the instrument and the potential values of the treatment (given the instrument) and the outcome (given the treatment) with and without monotonicity (see also Dawid, 2003) of the treatment
in the instrument. Shaikh and Vytlacil (2011) bound the ATE on the entire population in the binary
outcome case under monotonicity, too, and assume the treatment effect to be either weakly positive
or weakly negative for all individuals (while the direction is a priori not restricted) (see Bhattacharya
et al., 2008, for an application. Cheng and Small (2006) extend the results for binary outcomes to
three treatments (in contrast to the standard binary treatment framework considered here) under particular forms of (one-sided) noncompliance. Richardson and Robins (2010) is the only study apart from
ours that also bounds the effects on further populations (compliers, defiers, never takers, and always
takers). They assume full independence and a binary outcome, but do not consider monotonicity or
any form of mean dominance.
In contrast to much of the epidemiologic literature, Heckman and Vytlacil (2001) and Kitagawa
(2009) allow for both discrete and continuous outcomes. Kitagawa (2009) partially identifies the potential outcome distributions for the entire population under (various forms of) full independence between
the instrument and potential treatments/outcomes as well as monotonicity and derives bounds on the
ATE. Also, Heckman and Vytlacil (2001) assume full independence of the instrument, but invoke a
nonparametric threshold-crossing model characterizing the treatment choice instead of monotonicity
for deriving the bounds on the ATE. However, by the results of Vytlacil (2002), both approaches are
equivalent. One interesting finding of Heckman and Vytlacil (2001) and Kitagawa (2009) is that the
2

In addition, online Appendix A.8 (supporting information) provides the bounds for the treated subpopulations receiving and
not receiving the instrument.
3
For the derivation of semiparametric bounds on the ATE on the entire population, see Chiburis (2010) and the references
therein.
4
As it is the aim of this paper to provide bounds for further populations, we also need to assume that the proportions of the
subpopulations are independent of the instrument; otherwise the bounds on those populations might differ for different values
of the instrument.
Copyright © 2015 John Wiley & Sons, Ltd.

J. Appl. Econ. 32: 56–79 (2017)
DOI: 10.1002/jae

58

M. HUBER, L. LAFFERS AND G. MELLACE

width of their bounds is the same as those of Manski (1990), given that the monotonicity/threshold
crossing model assumptions are satisfied. The present work adds to the literature on nonparametric bounds under endogeneity by considering more populations and an extended set of identifying
assumptions than any of the previous studies.
The identifying power of monotonicity and mean dominance is demonstrated in an empirical application to Colombia’s ‘Programa de Ampliación de Cobertura de la Educación Secundaria’, which
provided pupils from low-income families with vouchers for private secondary schooling. Using experimental data previously analyzed by Angrist et al. (2002), we aim at assessing the program’s impact
on the educational achievement of various subpopulations. In particular, we find (in addition to the
point identified complier effect) a significantly positive ATE on the treated which lies within reasonably tight bounds. This is an interesting result because it suggests that this and similar interventions
have a positive effect on the participants, who are likely more policy relevant than the latent population
of compliers.
The remainder of this paper is organized as follows. Section 2 characterizes the endogeneity/noncompliance problem based on principal stratification. Section 3 discusses the identifying
assumptions and derives bounds on the ATEs for various populations. Section 4 briefly presents
the estimators. In Section 5, we consider an empirical application to experimental education data.
Section 6 concludes.
2. USING PRINCIPAL STRATIFICATION TO CHARACTERIZE NONCOMPLIANCE
Suppose that we want to estimate the effect of a binary treatment D 2 ¹1; 0º (e.g. a training activity) on
an outcome Y (e.g. labor market success such as employment or earnings) evaluated at some point in
time after the treatment. We use the experimental framework to motivate the problems of endogeneity
and noncompliance. Assume that individuals are randomly assigned into treatment or non-treatment
according to the binary assignment variable Z 2 ¹1; 0º, which will serve as instrument. Denote by
Di .´/ the potential treatment state for Z D ´ and by Yi .d / the potential outcome (see, for instance,
Rubin, 1974) of individual i under treatment D D d . Throughout the discussion we will rule out
interference between individuals or general equilibrium effects of the treatment by invoking the ‘stable
unit treatment value assumption’ (SUTVA) (see, for instance, Rubin, 1990). The SUTVA is formalized
in Assumption 1.
Assumption 1. Yi .d /?dj and Di .´/?´j 8j ¤ i; d 2 ¹0; 1º (SUTVA).
Even under Assumption 1, the individual effect Yi .1/  Yi .0/ can never be evaluated as individual
i is either treated or not treated, but cannot be observed in both states, i.e. the observed outcome
Yi D Di  Yi .1/ C .1  Di /  Yi .0/. However, under particular assumptions aggregate parameters
such as the average treatment effect (ATE)  D EŒY.1/  EŒY.0/ can be identified. For example,
assume that compliance in an experiment is perfect, such that Di .1/ D 1 and Di .0/ D 0 for all
individuals i . In this case and under successful randomization, EŒY jZ D 1  EŒY jZ D 0 D
EŒY jD D 1  EŒY jD D 0 D EŒY.1/  EŒY.0/ D , where the first equality follows from perfect
compliance and the second from random assignment; i.e. the ATE is identified because all individuals
are compliers. However, if post-assignment complications occur such that Di .´/ ¤ ´ for some ´ and
some individuals i , selection bias may flaw the validity of the evaluation in spite of the randomization
of the assignment. This is due to the potential threat that individuals systematically select themselves
into the treatment according to their potential outcomes.
Using the principal stratification framework advocated by Frangakis and Rubin (2002), the population can be divided into four principal strata, denoted by T , according to the choice of D as a reaction
of Z . Angrist et al. (1996) refer to the four groups as: (i) compliers, who react on the instrument in
Copyright © 2015 John Wiley & Sons, Ltd.

J. Appl. Econ. 32: 56–79 (2017)
DOI: 10.1002/jae

SHARP IV BOUNDS ON AVERAGE TREATMENT EFFECTS

59

Table I. Principal strata
Principal strata .T /
11
10
01
00

D(1)

D(0)

Notion

1
1
0
0

1
0
1
0

Always takers
Compliers
Defiers
Never takers

Table II. Observed subgroups and principal strata
Observed subgroups
¹i
¹i
¹i
¹i

W Zi
W Zi
W Zi
W Zi

D 1; Di
D 1; Di
D 0; Di
D 0; Di

D 1º
D 0º
D 1º
D 0º

Principal strata
Subject i
Subject i
Subject i
Subject i

belongs either to 11 or to 10
belongs either to 01 or to 00
belongs either to 11 or to 01
belongs either to 10 or to 00

the intended way by taking the treatment when Z D 1 and abstaining from it when Z D 0; (ii) always
takers, who are always treated irrespective of the assignment; (iii) never takers, who are never treated
irrespective of the assignment; and (iv) defiers, who are treated when not assigned, but not treated
when assigned. Table I visualizes this definition.
It is obvious that we cannot directly observe the principal stratum an individual belongs to as either
D.1/ or D.0/ is known. Therefore, without the imposition of further assumptions, neither the principal
strata proportions nor the distribution of Y within any stratum are identified. To see this, note that the
observed values of Z and D generate four observed subgroups which are all mixtures of two principal
strata. This implies that any individual i with a particular combination of Zi ; Di may belong to two
principal strata (see Table II).
As second identifying restriction maintained throughout the paper, we will assume Z to be independent of (i) the mean potential outcomes within principal strata and (ii) of the strata proportions, which
has also been considered in Frölich (2007).
Assumption 2.
(i) E.Y.d /jT D t; Z D 1/ D E.Y.d /jT D t; Z D 0/ D E.Y.d /jT D t / for d 2 ¹0; 1º and
t 2 ¹11; 10; 01; 00º (mean independence within principal strata);
(ii) Pr.T D t jZ D 1/ D Pr.T D t jZ D 0/ D Pr.T D t / for t 2 ¹11; 10; 01; 00º (unconfounded
strata proportions).
Assumption 2(i) postulates that mere assignment does not have any direct effect on the mean potential outcomes within any stratum other than through the treatment,5 i.e. mean independence within
principal strata.6 Taking assignment to a training as an example, it rules out that the average labor market success given T changes as a reaction to merely being assigned; i.e. what should matter is whether
the training is actually received. By Assumption 2(ii), the proportion of any stratum conditional on the
instrument is equal to its unconditional proportion in the entire population. This holds, for instance,
under random assignment, where Z is fully independent of the joint distribution of .D.1/; D.0//
and thus of T . Alternatively to the unconditional validity of Assumption 2, one may assume that it
5
However, in contrast to the full independence considered in Imbens and Angrist (1994) and Angrist et al. (1996), it may affect
higher moments.
6
For the case that mean independence is not satisfied, Flores and Flores-Lagunes (2013) derive bounds on the LATE in the presence of an invalid instrument. In contrast, we will assume the instrument to be valid (in the sense that it satisfies Assumption 2)
throughout the discussion.

Copyright © 2015 John Wiley & Sons, Ltd.

J. Appl. Econ. 32: 56–79 (2017)
DOI: 10.1002/jae

60

M. HUBER, L. LAFFERS AND G. MELLACE

Table III. Observed probabilities and principal strata
proportions
Observed cond. treatment prob.
P1j1
P0j1
P1j0
P0j0

D Pr.D
D Pr.D
D Pr.D
D Pr.D

D 1jZ
D 0jZ
D 1jZ
D 0jZ

D 1/
D 1/
D 0/
D 0/

Princ. strata proportions
11 C 10
01 C 00
11 C 01
10 C 00

only holds conditional on some observed pre-assignment variables X . This is closely related to the
framework of Frölich (2007), who shows point identification of the LATE under a conditionally valid
instrument (given X ). In the further discussion, conditioning on X will be kept implicit, such that all
results either refer to the experimental framework or to an analysis within cells of X .
Unfortunately, even under Assumptions 1 and 2, point identification is not obtained. Let t D
Pr.T D t / denote a particular proportion and Pd j´  Pr.D D d jZ D ´/ the observed treatment
probability conditional on assignment status. Under Assumption 2(ii), which ensures that the strata
proportions conditional on the instrument are equal to the unconditional strata proportions, the relation
between the observed Pd j´ and the latent t is as displayed in Table III. Likewise, any observed
conditional mean outcome is a mixture of the mean outcomes of two strata. For example:
11
 E.Y jZ D 1; D D 1; T D 11/
11 C 10
10
C
 E.Y jZ D 1; D D 1; T D 10/;
11 C 10
11
10
D
 E.Y jD D 1; T D 11/ C
 E.Y jD D 1; T D 10/;
11 C 10
11 C 10
11
10
D
 E.Y.1/jT D 11/ C
 E.Y.1/jT D 10/
11 C 10
11 C 10

E.Y jZ D 1; D D 1/ D

where the second equality follows from Assumption 2(i) and the third from the fact that the treatment is
unconfounded within each stratum consisting of individuals with identical (non)compliance behavior.
Thus point identification of causal effects would require us to invoke further assumptions. For
example, under monotonicity of D in Z and effect homogeneity, the ATE on the entire population is identified. Albeit used in much of the IV literature, effect homogeneity is a very unattractive
assumption given the rich empirical evidence on effect heterogeneity in the field of treatment evaluation. Under monotonicity and effect heterogeneity, the LATE on the compliers is identified, but this
effect may be ‘too local’ to be of policy interest. Fortunately, assumptions as monotonicity and mean
dominance also bear identifying power for further populations and may yield informative bounds, as
discussed in the next section.
3. ASSUMPTIONS AND INTERVAL IDENTIFICATION
3.1. Mean Independence within Principal Strata without Further Assumptions
The partial identification of ATEs on various populations will be based on bounding the mean potential
outcomes E.Y.1/jT D t /; E.Y.0/jT D t /, with t 2 ¹11; 10; 00; 01º. To this end, we assume that the
support Y of the outcome variable Y is bounded, i.e. Y D Œy LB ; y UB  with 1 < y LB < y UB < 1,
and that Y is continuous over Y (see online Appendix A.5 for discrete outcomes). Boundedness of Y
rules out infinite upper or lower bounds on the mean potential outcomes and, thus, on the ATE in any
Copyright © 2015 John Wiley & Sons, Ltd.

J. Appl. Econ. 32: 56–79 (2017)
DOI: 10.1002/jae

SHARP IV BOUNDS ON AVERAGE TREATMENT EFFECTS

61

population. We will refer to the bounds on any ATE as being informative if its identification region
does not coincide with (i.e. is tighter than) Œy LB  y UB ; y UB  y LB .
Partial identification is obtained in three steps. In the first step, we derive sharp bounds on the
principal strata proportions using Assumption 2(ii). As one can express three out of four proportions as a function of the remaining one, we only need to bound the latter. Therefore, all bounds
are computed as functions of the defier proportion, but choosing any other principal stratum would
entail the same results. The second step (which is mostly discussed in the online Appendix) gives the
bounds on the mean potential outcomes and the ATEs conditional on the defier proportion. It makes
use of the fact that each observed conditional mean outcome is a mixture of the mean potential outcomes of two principal strata, with the mixing probabilities corresponding to the relative principal
strata proportions:
E.Y jZ D 1; D D 1/ D

11
10
 E.Y.1/jT D 11/ C
 E.Y.1/jT D 10/
11 C 10
11 C 10

(1)

E.Y jZ D 0; D D 1/ D

11
01
 E.Y.1/jT D 11/ C
 E.Y.1/jT D 01/
11 C 01
11 C 01

(2)

E.Y jZ D 0; D D 0/ D

10
00
 E.Y.0/jT D 10/ C
 E.Y.0/jT D 00/
00 C 10
00 C 10

(3)

E.Y jZ D 1; D D 0/ D

01
00
 E.Y.0/jT D 01/ C
 E.Y.0/jT D 00/
00 C 01
00 C 01

(4)

Given the defier proportion (and thus, the mixing probabilities), the results of Horowitz and Manski
(1995) (see Section 3.2 and Proposition 4 therein) provide us with sharp bounds on the mean potential
outcomes within each of equations (1)–(4), whereas Assumption 2(i) allows further tightening of these
bounds across equations. Using an approach inspired by Kitagawa (2009), we derive sharp bounds
on the mean potential outcomes and the ATEs under Assumption 2(i) and conditional on the defier
proportion. Finally, taking the supremum (infimum) of the ATEs in the second step over admissible
defier proportions that satisfy Assumption 2(ii) yields the sharp upper (lower) bounds on the ATEs
(see online Appendix A.1.2).7 As the bounds are continuous in 01 (as shown in online Appendix
A.1.4) and the set of admissible shares of defiers is an interval (as shown in Lemma 1), the optima are
attained by the extreme value theorem.
Concerning the bounds on the defier proportion, note that under Assumptions 1 and 2 Table III
provides us with the following equations:
11 D P1j0  01

)

01  P1j0

00 D P0j1  01
10 D P1j1  P1j0 C 01

)
)

01  P0j1
01  P1j0  P1j1

(5)

and thus the defier proportion must lie in the following set:
01 2 P D Œmax.0; P1j0  P1j1 /; min.P1j0 ; P0j1 /

(6)

Note that these bounds are valid outer bounds, but they need not be sharp. Sharp bounds on the
proportion of defiers have to be constructed based on the joint distribution of .Y; D; Z/, rather than
7

It is worth noting that without further restrictions it is generally not possible that one particular value of 01 jointly optimizes
the bounds on all ATEs considered.
Copyright © 2015 John Wiley & Sons, Ltd.

J. Appl. Econ. 32: 56–79 (2017)
DOI: 10.1002/jae

62

M. HUBER, L. LAFFERS AND G. MELLACE

.D; Z/ alone. Under Assumptions 1 and 2, the condition 01 D 0 leads to testable implications as
studied in Huber and Mellace (2015b). However, in some cases zero may not be in the identified set of
the defier share. In online Appendix A.1.3, we show that admissibility of 01 is equivalent to checking
four moment inequalites that generalize those inequalities outlined in Huber and Mellace (2015b).
Furthermore, online Appendix A.1.1 presents a linear programming procedure for constructing sharp
bounds on 01 in the case of a discrete Y .8 Under discreteness, linear programming can also be used
for constructing sharp bounds on various types of ATEs, as was first pointed out by Balke and Pearl
(1997). This work was further extended to the case with continuous outcomes by Kitagawa (2009),
who derived a closed-form solution for the sharp bounds (rather than relying on linear programming).
Lafférs (2013) applied linear programming to bound ATEs under various sets of assumptions.
We denote by tmin and tmax the sharp lower and upper bounds of t ; t D 11; 10; 01; 00, respectively, and by P  the sharp identified set for 01 under Assumptions 1 and 2. In online Appendix A.1.1,
we show that P  is an interval. If P D P  , then the remaining strata proportions can be bounded by
min
min
substituting equation (6) into equation (5). It is easy to see that either 01
D 0 or 10
D 0 and either
min
min
11 D 0 or 00 D 0. The outer bounds P are equivalent to those derived in Richardson and Robins
(2010, equation (6) of Section 3.1, p. 9). In contrast to their paper, we only assume mean independence
within principal strata in Assumption 2, rather than full independence.
In order to bound the ATEs on the four populations, we introduce some additional notation.
We define YN´;d D E.Y jZ D ´; D D d / to be the conditional mean of Y given Z D ´
and D D d . Furthermore, FY´;d .y/ D Pr.Y  yjZ D ´; D D d / denotes the conditional
t
cumulative distribution factor of Y given Z D ´ and D D d . Let q´;d
denote the share of
individuals belonging to stratum T D t in the observed subgroup with Z D ´ and D D d .
t; max
t; min
max
t
If necessary, we will denote by q´;d01 and q´;d01 , the value of q´;d
when 01 is equal to 01


°
±
min
t
t
9
q´;d
D inf y W FY´;d .y/  q´;d
or 01
, respectively. Let FY1
be the conditional quantile
´;d
function of Y given Z D ´ and D D d . We can then define the lower and upper bounds of
E.Y jZ D ´; D D d; T D
by Assumption 2 corresponds
(see
 t /, which


to E.Y.d /jT
 D t/ 
t
t
N´;d max jq t
D E Y jZ D ´; D D d; Y  FY1
q

Y
and
Section 2), as YN´;d min jq´;d
´;d
´;d
´;d



t
E Y jZ D ´; D D d; Y  FY1
1  q´;d
, respectively. Finally, the ATEs on the various princi´;d
pal strata, the treated, the non-treated, and the entire population are denoted by t  E.Y.1/ 
Y.0/jT D t / with t 2 ¹11; 10; 01; 00º; DDd  E.Y.1/  Y.0/jD D d / with d 2 ¹1; 0º, and
  E.Y.1/  Y.0//, respectively. The superscripts UB and LB denote the sharp upper and lower
Q is defined
bounds on the respective parameters, where sharpness of the bounds on some parameter 
as follows.
Q LB and 
Q UB are sharp if
Definition 1. Given knowledge of the distribution of the observed data, 
LB Q UB
LB Q UB
Q
Q
Q
Œ ;   is the shortest interval such that, for every  2 Œ ;  , we can construct principal strata proportions Pr.T jZ/ W T D 11; 10; 01; 00; Z D 1; 0 and potential outcome distributions
f .Y.1/; Y.0/jT; Z/ W T D 11; 10; 01; 00; Z D 1; 0 that satisfy the imposed assumptions.

Considering the ATE on the compliers .10 /, if P1j0  P1j1 … P  , then the upper and lower bounds
are respectively
We thank an anonymous referee for pointing out the difference between P and P  and for suggesting the linear programming
tool.
9
We define FY1
.0/  y LB and FY1
.1/  y UB .
´;d
´;d
8

Copyright © 2015 John Wiley & Sons, Ltd.

J. Appl. Econ. 32: 56–79 (2017)
DOI: 10.1002/jae

63

SHARP IV BOUNDS ON AVERAGE TREATMENT EFFECTS

"
UB
10

D sup






11
11
; YN0;1 min jq0;1
P1j1  YN1;1  .P1j0  01 /  max YN1;1 min jq1;1

01 2P 



LB
10

D

inf

P1j1  P1j0 C 01
"





11
11
; YN0;1 max jq0;1
P1j1  YN1;1  .P1j0  01 /  min YN1;1 max jq1;1

01 2P 


11
where q1;1
D
P1j0 01
P1j0

P1j1  P1j0 C 01



 #

00
00
P0j0  YN0;0  .P0j1  01 /  min YN0;0 max jq0;0
; YN1;0 max jq1;0

P1j0 01
P1j1

;

(7)

P1j1  P1j0 C 01



 #

00
00
N
P0j0  Y0;0  .P0j1  01 /  max YN0;0 min jq0;0
; YN1;0 min jq1;0
P1j1  P1j0 C 01
11
(the share of always takers among those with Z D 1 and D D 1), q0;1
D

00
(the share of always takers among those with Z D 0 and D D 1), q1;0
D
00
q0;0

P0j1 01
P0j0

P0j1 01
P0j1

(the share

of never takers among those with Z D 0 and D D 1), and
D
(the share of never takers
among those with Z D 0 and D D 0). The proofs of the sharpness of these bounds as well as of any
other bounds proposed below are provided in the online Appendix. If 01 D P1j0  P1j1 2 P  , then
UB
LB
10 D 0 and the bounds are uninformative. Therefore, UB
 y LB and LB
 y UB . In
10 D y
10 D y
UB
LB
online Appendix A.1.4, we show that  .01 / and  .01 / are continuous in 01 .
Four points are worth noting concerning the derivation of these bounds. Firstly, and as already
mentioned, they make use of Proposition 4 of Horowitz and Manski (1995), which in general only
holds for continuous outcomes. Fortunately, it is easy to show that their results can also be applied to
discrete outcomes after a modification of the trimming function (see online Appendix A.5 for further
details). Secondly, equation (7) has to be optimized w.r.t. admissible defier proportions, given by P  .
Thirdly, mean independence within strata (Assumption 2(i)) gives rise to the maximum and minimum
operators. Note that in the first (third) line in equation (7) one computes the upper (lower) bound of
the compliers’ mean potential outcome under treatment by subtracting the lower (upper) bound of
the mean potential outcome of the always takers. As their lower (upper) bound under treatment is
not affected by the value of Z due to mean independence, the lower (upper) bound is the maximum
(minimum) of the always takers’ lower (upper) bounds for Z D 1 and Z D 0. An analogous result
holds for lines 2 and 4 w.r.t. the bounds on the potential mean outcomes under non-treatment of the
never takers. Finally, if P D P  , these bounds are informative only if P1j0 < P1j1 . This is equivalent
to 10 > 01 , saying that the share of compliers is larger than the share of defiers. The reason is that
min
min
if P1j0  P1j1 , then 01
D P1j0  P1j1 > 0, which implies that 10
D 0 (so that the non-existence
UB
LB
UB
LB
UB
of compliers cannot be ruled out) and 10 D y  y , 10 D y  y LB .
In a symmetric way one obtains the sharp upper and lower bounds on the ATE on the defiers, 01 .
If 0 … P  :
"





11
11
; YN0;1 min jq0;1
P1j0  YN0;1  .P1j0  01 /  max YN1;1 min jq1;1
UB
01 D sup
01
01 2P 



 #

00
00
P0j1  YN1;0  .P0j1  01 /  min YN0;0 max jq0;0
; YN1;0 max jq1;0

;
01
"
(8)





11
11
P1j0  YN0;1  .P1j0  01 /  min YN1;1 max jq1;1
; YN0;1 max jq0;1
LB
01 D inf 
01 2P
01



 #

00
00
N
P0j1  Y1;0  .P0j1  01 /  max YN0;0 min jq0;0
; YN1;0 min jq1;0

01
Copyright © 2015 John Wiley & Sons, Ltd.

J. Appl. Econ. 32: 56–79 (2017)
DOI: 10.1002/jae

64

M. HUBER, L. LAFFERS AND G. MELLACE

For the same reason mentioned above, if P D P  , these bounds are informative only if P1j0 > P1j1 ,
i.e. if there are more defiers than compliers. Therefore, without imposing further assumptions, the
bounds are informative either for the defiers or for the compliers, but never for both populations.
Furthermore, unless either P1j1  P1j0 D 0 or P ¤ P  , either positive (if P1j1  P1j0 > 0) or negative
(if P1j0  P1j1 > 0) monotonicity of D in Z can be consistent with the data, but not both at the
same time.
Concerning the always takers, note that their outcomes are only observed under treatment. The
shares of always takers in the observed groups with Z D 1; D D 1 and Z D 0; D D 1
are, respectively, 11 =.11 C 10 / D .P1j0  01 /=P1j1 and 11 =.11 C 01 / D .P1j0 
lower values of the mean potential
01 /=P1j0 . Therefore, we can bound the upper and 
 out11; max
11; max
come under treatment for this population by min YN1;1 max jq1;1 01 ; YN0;1 max jq0;1 01
and



max 
max 
11;01
11;01
; YN0;1 min jq0;1
max YN1;1 min jq1;1
, respectively. As already discussed, the intuition for
the optimization over different values of the instrument is that Z does not have a direct effect on
the mean potential outcomes. Therefore, the set of admissible potential outcomes for D D 1 is the
intersection of possible values under Z D 0 and Z D 1.
Since the outcomes of the always takers are never observed under non-treatment, we have to rely
on the upper and lower bounds in the support of Y; y UB and y LB . The sharp upper and lower bounds
for the ATE on the always takers 11 , are




max 
11;01
11; max
N
; YN0;1 max jq0;1 01
 y LB ;
UB
11 D min Y1;1 max jq1;1




max 
11;01
11; max
N
LB
; YN0;1 min jq0;1 01
 y UB
11 D max Y1;1 min jq1;1
max
It is easy to see10 that 01
 upper bound and minimizes the lower bound of 11 w.r.t.
maximizes the
max
11;01
P1j0 P0j1
01 , so that q´;1
D max 0; P1j´
. Similarly as for the compliers and defiers, these bounds
are only informative if P1j0 > P0j1 ) 11 > 00 , i.e. if the share of always takers is larger than the
share of never takers. The sampling process constraints the identification region of either the average
treatment effect on the always takers or of the one on the never takers. Once again if P1j0 < P0j1 then
max
min
01
D P1j0 , which implies that 11
D 0.
Using a symmetric argument as for the always takers, the sharp upper and lower bounds on the ATE
of the never takers, 00 , are respectively





00; max
00; max
UB
;
UB
 max YN1;0 min jq1;0 01 ; YN0;0 min jq0;0 01
00 D y



max 
max 
00;
00;
LB
LB
 min YN1;0 max jq1;0 01 ; YN0;0 max jq0;0 01
00 D y
max
01
maximizes the upper bound and minimizes the lower bound of 00 w.r.t. 01 , such that
max
00;01
P P
q´;0
D max 0; 0j1P0j´ 1j0 . The bounds are informative if P1j0 < P0j1 , i.e. if there are more never
max
takers than always takers in the population. Similar to before, if P1j0 > P0j1 ; 01
D P0j1 , which
min
11
implies that 00 D 0.
The identification results presented so far refer to latent strata defined by Z and D , populations that
are not directly observed in the data. However, in the program evaluation literature, most attention
seems to be devoted to the (observed) population receiving the treatment (see, for instance, Heckman







11
11
11
N
N
N
Both
 Y1;111max
 jq1;1 and Y0;1 max jq0;1 are non-decreasing functions of 01 . Similarly, both Y1;1 min jq1;1 and
YN0;1 min jq0;1 are non-increasing functions of 01 .
11
This demonstrates that it is generally not possible to have a value of 01 that jointly optimizes the bounds on the average
treatment effects of all principal strata.
10

Copyright © 2015 John Wiley & Sons, Ltd.

J. Appl. Econ. 32: 56–79 (2017)
DOI: 10.1002/jae

SHARP IV BOUNDS ON AVERAGE TREATMENT EFFECTS

65

et al., 1999), which generally appears more policy relevant than latent groups. As a major contribution of this paper, we therefore also derive sharp bounds on the ATEs on the treated, as well as the
non-treated and the entire population. The discussion below shows that for doing so, it suffices to
establish the sharp bounds on E.Y.1// and E.Y.0//, which for continuous outcomes are given by





 UB 


11; min
11; min
min
min
 y  P1j0  01
 max YN1;1 min jq1;1 01 ; YN0;1 min jq0;1 01
E.Y.1//UB D P0j1  01

E.Y.1//LB

C P1j0  YN0;1 C P1j1  YN1;1 ;





 LB 


11; min
11; min
min
min
 y  P1j0  01
 min YN1;1 max jq1;1 01 ; YN0;1 max jq0;1 01
D P0j1  01
C P1j0  YN0;1 C P1j1  YN1;1

(9)
and





 UB 


00; min
00; min
min
min
 y  P0j1  01
 max YN0;0 min jq0;0 01 ; YN1;0 min jq1;0 01
E.Y.0//UB D P1j0  01

E.Y.0//LB

C P0j0  YN0;0 C P0j1  YN1;0 ;





 LB 


00; min
00; min
min
min
 y  P0j1  01
 min YN0;0 max jq0;0 01 ; YN1;0 max jq1;0 01
D P1j0  01
C P0j0  YN0;0 C P0j1  YN1;0

(10)
respectively (see online Appendix A.1.5). If Y is not continuous, these bounds, and thus that on the
treated, non-treated, and the entire population, have to be optimized w.r.t. admissible defier proportions
01 , given by P  .
Considering the ATE on the treated, DD1 D E.Y.1/  Y.0/jD D 1/, note that because
E.Y.1/jD D 1/ D E.Y jD D 1/ is identified from the data, we only need to bound E.Y.0/jD D 1/.
Solving E.Y.0// D Pr.D D 1/  E.Y.0/jD D 1/ C Pr.D D 0/  E.Y.0/jD D 0/ for E.Y.0/jD D 1/
jDD0/
gives E.Y.0/jD D 1/ D E.Y .0//Pr.DD0/E.Y
. Letting E.Y.0//UB and E.Y.0//LB denote the
Pr.DD1/
sharp upper and lower bounds for E.Y.0//, respectively, it therefore follows that the sharp upper and
lower bounds on the ATE on the treated DD1 are given by
E.Y.0//LB  Pr.D D 0/  E.Y jD D 0/
;
Pr.D D 1/
E.Y.0//UB  Pr.D D 0/  E.Y jD D 0/
D E.Y jD D 1/ 
Pr.D D 1/

UB
DD1 D E.Y jD D 1/ 
LB
DD1

Since
Pr.D D 0/  E.Y jD D 0/ D Pr.Z D 0/  P0j0  YN0;0 C Pr.Z D 1/  P0j1  YN1;0

and
P0j0  YN0;0 C P0j1  YN1;0 D Pr.Z D 0/  P0j0  YN0;0 C Pr.Z D 1/  P0j1  YN1;0
C Pr.Z D 1/  P0j0  YN0;0 C Pr.Z D 0/  P0j1  YN1;0 ;
D Pr.D D 0/  E.Y jD D 0/ C Pr.Z D 1/  P0j0  YN0;0
C Pr.Z D 0/  P0j1  YN1;0
Copyright © 2015 John Wiley & Sons, Ltd.

J. Appl. Econ. 32: 56–79 (2017)
DOI: 10.1002/jae

66

M. HUBER, L. LAFFERS AND G. MELLACE

the bounds on DD1 correspond to

 LB
min
P1j0  01
 y C Pr.Z D 1/  P0j0  YN0;0 C Pr.Z D 0/  P0j1  YN1;0
UB
DD1 D E.Y jD D 1/ 
Pr.D D 1/




min 


00;01
00; min
min
N
N
; Y1;0 max jq1;0 01
P0j1  01  min Y0;0 max jq0;0
C
;
Pr.D D 1/


min
P1j0  01
 y UB C Pr.Z D 1/  P0j0  YN0;0 C Pr.Z D 0/  P0j1  YN1;0
LB
DD1 D E.Y jD D 1/ 
Pr.D D 1/




min 


00;01
00; min
min
N
N
; Y1;0 min jq1;0 01
P0j1  01  max Y0;0 min jq0;0
C
Pr.D D 1/
The bounds of the ATE on the non-treated, DD0 D E.Y.1/Y.0/jD D 0/, are obtained in a symjDD1/
metric way. As E.Y.0/jD D 0/ D E.Y jD D 0/ and E.Y.1/jD D 0/ D E.Y .1//Pr.DD1/E.Y
,
Pr.DD0/
they are
E.Y.1//UB  Pr.D D 1/  E.Y jD D 1/
 E.Y jD D 0/;
Pr.D D 0/
E.Y.1//LB  Pr.D D 1/  E.Y jD D 1/
 E.Y jD D 0/
D
Pr.D D 0/

UB
DD0 D
LB
DD0

Furthermore, since
Pr.D D 1/  E.Y jD D 1/ D Pr.Z D 0/  P1j0  YN0;1 C Pr.Z D 1/  P1j1  YN1;1

and
P1j1  YN1;1 C P1j0  YN0;1 D Pr.Z D 0/  P1j0  YN0;1 C Pr.Z D 1/  P1j1  YN1;1
C Pr.Z D 1/  P1j0  YN0;1 C Pr.Z D 0/  P1j1  YN1;1
D Pr.D D 1/  E.Y jD D 1/ C Pr.Z D 1/  P1j0  YN0;1
C Pr.Z D 0/  P1j1  YN1;1

the bounds on DD0 are given by

 UB
min
P0j1  01
 y C Pr.Z D 1/  P1j0  YN1;0 C Pr.Z D 0/  P1j1  YN1;1
UB
DD0 D
Pr.D D 0/







11; min
11; min
min
N
P1j0  01  max Y1;1 min jq1;1 01 ; YN0;1 min jq0;1 01
 E.Y jD D 0/;

Pr.D D 0/


min
P0j1  01
 y LB C Pr.Z D 1/  P1j0  YN1;0 C Pr.Z D 0/  P1j1  YN1;1
LB
DD0 D
Pr.D D 0/







11; min
11; min
min
N
P1j0  01  min Y1;1 max jq1;1 01 ; YN0;1 max jq0;1 01
 E.Y jD D 0/

Pr.D D 0/
Interestingly, the bounds on DD1 and DD0 are always informative despite the fact that either the
bounds for the compliers or the defiers and either the bounds for the always takers or the never takers
are not informative.
Copyright © 2015 John Wiley & Sons, Ltd.

J. Appl. Econ. 32: 56–79 (2017)
DOI: 10.1002/jae

SHARP IV BOUNDS ON AVERAGE TREATMENT EFFECTS

67

Finally, the bounds for the ATE on the entire population  D E.Y.1/  Y.0// are directly obtained
from the bounds on E.Y.1// and E.Y.0// in equations (9) and (10):


UB D E Y.1/UB  Y.0/LB
 LB

min
D P1j0  YN0;1  P1j0  01
 y C P1j1  YN1;1







11; min
11; min
min
 max YN1;1 min jq1;1 01 ; YN0;1 min jq0;1 01
 P1j0  01







00; min
00; min
min
 min YN0;0 max jq0;0 01 ; YN1;0 max jq1;0 01
C P0j1  01
 UB

min
 y  P0j0  YN0;0
 P0j1  YN1;0 C P0j1  01
and


LB D E Y.1/LB  Y.0/UB
 UB

min
 y C P1j1  YN1;1
D P1j0  YN0;1  P1j0  01







11; min
11; min
min
 min YN1;1 max jq1;1 01 ; YN0;1 max jq0;1 01
 P1j0  01







00; min
00; min
min
 max YN0;0 min jq0;0 01 ; YN1;0 min jq1;0 01
C P0j1  01
 LB

min
 y  P0j0  YN0;0
 P0j1  YN1;0 C P0j1  01

Again, these bounds are always informative no matter whether the bounds on the effect in some of
the principal strata are not informative. In online Appendix A.1.8 we show that it is possible to order
UB
the bounds on DD1 , DD0 and  with respect to their tightness. In particular, if UB
DD1 < DD0
LB
LB
(or equivalently, DD1 > DD0 ), the bounds on DD1 are tighter than those on , which are in
UB
LB
turn tighter than those on DD0 . The order is reversed if UB
DD1 > DD0 (or equivalently DD1 <
LB
DD0 ).
Furthermore, note that LB ; UB might be narrower than the IV bounds derived by Manski (1990).
The reason is that we assume mean independence within strata and unconfounded strata proportions
(see Assumption 2), whereas Manski imposes the weaker mean independence of the potential outcomes in the entire population: E.Y.d /jZ D 1/ D E.Y.d /jZ D 0/ for d 2 ¹0; 1º. In contrast, our
bounds may be wider than those of Kitagawa (2009), who invokes the stronger assumption of full
independence of the instrument and the potential treatment states and outcomes. A formal comparison
between the various bounds is given in online Appendices A.1.6 and A.1.7.
Without imposing additional restrictions, the bounds derived in this section are likely to be very
wide for most populations. Therefore, they are often not helpful for obtaining meaningful results in
applications. For this reason, we subsequently introduce further assumptions that appear plausible in
many empirical problems and might entail considerably tighter bounds.
3.2. Monotonicity
This subsection shows how assuming monotonicity of the treatment in the instrument in addition to
Assumptions 1 and 2 increases identifying power. (Weak) monotonicity of D in Z implies that the
treatment state under Z D 1 is at least as high as under Z D 0 for all individuals.
Assumption 3. Pr.D.1/  D.0// D 1 (monotonicity).
As the potential treatment state never decreases in the instrument, the existence of the defiers (stratum 01) is ruled out. A symmetric result is obtained by assuming Pr.D.0/  D.1// D 1, which
Copyright © 2015 John Wiley & Sons, Ltd.

J. Appl. Econ. 32: 56–79 (2017)
DOI: 10.1002/jae

68

M. HUBER, L. LAFFERS AND G. MELLACE

implies that stratum 10 does not exist. Note that assuming Pr.D.1/  D.0// D 1 (positive monotonicity) is only consistent with the data if P1j1  P1j0 > 0, otherwise stratum 01 must necessarily
exist. Similarly, Pr.D.0/  D.1// D 1 (negative monotonicity) requires that P1j0  P1j1 > 0 (see
Table III). Even though these are necessary conditions for the respective monotonicity assumption,
they are not sufficient. Owing to the symmetry of positive and negative monotonicity, we will only
focus on Assumption 3 (positive monotonicity) in the subsequent discussion.
In their seminal paper on the identification of the LATE, Imbens and Angrist (1994) (see also
Angrist et al., 1996) show that 10 is point identified under Assumptions 1, 2 and 3; i.e. the bounds
collapse to a single point given that 01 is equal to zero:
 

P0j0
P1j1
P1j0
P0j1
N
N
N
N
D
 Y1;1 
 Y0;1 
 Y0;0 
 Y1;0
P1j1  P1j0
P1j1  P1j0
P1j1  P1j0
P1j1  P1j0
.P1j1  YN1;1 C P0j1  YN1;0 /  .P1j0  YN0;1 C P0j0  YN0;0 /
D
P1j1  P1j0
Pr.D D 1jZ D 1/  E.Y jZ D 1; D D 1/ C Pr.D D 0jZ D 1/  E.Y jZ D 1; D D 0/
D
Pr.D D 1jZ D 1/  Pr.D D 1jZ D 0/
Pr.D D 1jZ D 0/  E.Y jZ D 0; D D 1/ C Pr.D D 0jZ D 0/  E.Y jZ D 0; D D 0/

Pr.D D 1jZ D 1/  Pr.D D 1jZ D 0/
E.Y jZ D 1/  E.Y jZ D 0/
D
E.DjZ D 1/  E.DjZ D 0/


10

The last equality gives the well-known result that the ATE on the compliers is just the ratio of two
differences in conditional expectations, namely the intention to treat effect divided by the share of compliers. Under monotonicity, the observed subgroup with Z D 0 and D D 1 consists of always takers
only and, therefore, YN0;1 immediately gives the mean
 potential
 outcome
 under treatment
 for the
always

11
11
; YN0;1 and min YN1;1 max jq1;1
; YN0;1
takers. Thus an optimization of the kind max YN1;1 min jq1;1
(with 01 D 0) as it was used for the bounds in Section 3.1 is not required here. Note, however,
that this comparison
gives a testable
implication
for the identifying assumptions. If it is satisfied,



11
11
 YN0;1  YN1;1 max jq1;1
YN1;1 min jq1;1
, otherwise Z has a direct effect on the outcomes of the
always takers. Similarly, YN1;0 is the mean potential outcome under non-treatment
for the

 never tak00
00
 YN1;0  YN0;0 max jq0;0
ers. Therefore, another testable implication is YN0;0 min jq0;0
. We refer to
Huber and Mellace (2015b) for a joint test of these implications.
In the absence of defiers, the bounds for the always takers and never takers (11 and 00 )
simplify to
LB
N
UB
11 D Y0;1  y ;
UB
N
LB
11 D Y0;1  y

and
UB
UB
 YN1;0 ;
00 D y
LB
LB
 YN1;0
00 D y

These bounds are sharp because E.Y jD D 1; T D 11/ and E.Y jD D 0; T D 00/ are now point
identified by YN0;1 and YN1;0 (if mean independence within strata holds). However, monotonicity does
not impose any restrictions on the distributions of Y jD D 0; T D 11 and Y jD D 1; T D 00, so that
the worst-case bounds y LB ; y UB have to be assumed.
Copyright © 2015 John Wiley & Sons, Ltd.

J. Appl. Econ. 32: 56–79 (2017)
DOI: 10.1002/jae

SHARP IV BOUNDS ON AVERAGE TREATMENT EFFECTS

69

As in the last section, the bounds on the ATEs on the treated .DD1 /, the non-treated .DD0 / and
the entire population ./ can be expressed as functions of the bounds on E.Y.1// and E.Y.0//. In the
online Appendix we show that under monotonicity
E.Y.1//UB D P0j1  y UB C P1j1  YN1;1 ;
E.Y.1//LB D P0j1  y LB C P1j1  YN1;1 ;
E.Y.0//UB D P1j0  y UB C P0j0  YN0;0 ;
E.Y.0//LB D P1j0  y LB C P0j0  YN0;0

so that the bounds on the various populations are given by
P1j0  y LB C Pr.Z D 1/  .P0j0  YN0;0 C P0j1  YN1;0 /
;
Pr.D D 1/
P1j0  y UB C Pr.Z D 1/  .P0j0  YN0;0 C P0j1  YN1;0 /
;
D E.Y jD D 1/ 
Pr.D D 1/
P0j1  y UB C Pr.Z D 0/  .P1j0  YN1;0 C P1j1  YN1;1 /
 E.Y jD D 0/;
D
Pr.D D 0/
P0j1  y LB C Pr.Z D 0/  .P1j0  YN1;0 C P1j1  YN1;1 /
 E.Y jD D 0/
D
Pr.D D 0/

UB
DD1 D E.Y jD D 1/ 
LB
DD1
UB
DD0
LB
DD0

and
UB D P0j1  y UB C P1j1  YN1;1  P1j0  y LB  P0j0  YN0;0 ;
LB D P0j1  y LB C P1j1  YN1;1  P1j0  y UB  P0j0  YN0;0

Balke and Pearl (1997), Heckman and Vytlacil (2001) and Kitagawa (2009) show that, under monotonicity, their bounds on the ATE in the entire population coincide with the bounds of Manski (1990),
who only invokes mean independence in the entire population; i.e. Assumption 3, if it is satisfied, does
not bring any additional identifying power for . Interestingly, this is also the case for our bounds on
the ATEs on the entire population, the treated and the non-treated. As all these bounds are optimized
min
D max.0; P1j0  P1j1 / (at least for continuous outcomes), it follows under a satisfaction of
at 01
min
monotonicity that P1j1  P1j0  0 and therefore, 01
D 0. For this reason, imposing the monotonicmin
ity assumption, which amounts to setting 01 D 01 , does not further tighten the bounds if a defier
proportion of zero is already a priori consistent with the data.
3.3. Mean Dominance
Mean dominance, or the stronger stochastic dominance assumption, has been used in the sample selection framework by Zhang and Rubin (2003), Lechner and Melly (2007), Blundell et al. (Blundell et al.
(2007)), Zhang et al. (Zhang et al. (2008)) and Huber and Mellace (2015a). We will show that mean
dominance also bears identifying power in the IV framework.
Assumption 4. EŒY.d /jT D 10  EŒY.d /jT D t 

8 d 2 ¹0; 1º; t 2 ¹11; 00º (mean dominance).

Assumption 4 states that the mean potential outcomes of the compliers under treatment and
non-treatment are at least as high as those of the always and never takers. Note that the particular mean
Copyright © 2015 John Wiley & Sons, Ltd.

J. Appl. Econ. 32: 56–79 (2017)
DOI: 10.1002/jae

70

M. HUBER, L. LAFFERS AND G. MELLACE

dominance assumption considered here is only one out of many possible relations between the potential outcomes of various strata. Its plausibility has to be judged in the light of the empirical application
and theoretical considerations. In Section 5, we present an example where the compliers are likely to
have weakly higher mean potential educational outcomes than both the always takers and the never
takers owing to plausibly being more able and/or motivated on average. As discussed in the next subsection, mean dominance has testable implications if it is jointly assumed with monotonicity. In the
application presented in Section 5 we will test Assumption 4 and show that it is not rejected at any
conventional significance level.
The bounds on the ATEs in the various principal strata as well as among the treated, non-treated
and entire populations are provided in the online Appendix. Under Assumptions 1, 2 and 4, online
Appendix A.3.2 outlines the moment inequalities that provide necessary and sufficient conditions for
the defiers’ proportion 01 being the identified set, denoted by P  . The construction of the latter
based on linear linear programming is presented in online Appendix A.3.1. Note that, in general,
P   P   P . Finally, we derive the bounds on the various ATEs as well as the mean potential
outcomes in online Appendix A.3.3.
3.4. Monotonicity and Mean Dominance
We subsequently derive the bounds under both monotonicity (Assumption 3) and mean dominance
(Assumption 4). Since 10 is point identified under Assumptions 1–3, Assumption 4 does not bring
any further improvement w.r.t. the compliers. For all other populations, the bounds become tighter
when invoking both assumptions.
The upper and lower bounds of the ATE on the always takers are now
LB
N
UB
11 D Y0;1  y ;


P0j0
P0j1
N
N
N
D
Y


Y


Y
LB
0;1
0;0
1;0
11
P1j1  P1j0
P1j1  P1j0

As under mean dominance, the upper bound of the always takers’ mean potential outcome under
non-treatment cannot be higher than the compliers’ upper bound under non-treatment. Furthermore,
P0j0
P0j1
monotonicity implies that the latter is point identified by P1j1 P
 YN0;0  P1j1 P
 YN1;0 . Again, LB
11
1j0
1j0
is sharp by Lemma 1 in online Appendix A.3. Similarly, the bounds for the never takers tighten to


P1j1
P1j0
N
N
N
UB
D

Y


Y
1;1
0;1  Y1;0 ;
00
P1j1  P1j0
P1j1  P1j0
LB
 YN1;0
LB
00 D y
P1j1
P1j0
By the monotonicity assumption, P1j1 P
 YN1;1  P1j1 P
 YN0;1 is the compliers’ mean potential
1j0
1j0
outcome under treatment. Under mean dominance, this is an upper bound for the never takers’ mean
potential outcome under treatment.
Under both monotonicity and mean dominance, the upper bounds of E.Y.0// and E.Y.1// become
!
P1j1  YN1;1  P1j0  YN0;1
UB
E.Y.1// D P0j1 
C P1j1  YN1;1 ;
P1j1  P1j0
!
N0;0  P0j1  YN1;0
P

Y
0j0
E.Y.0//UB D P1j0 
C P0j0  YN0;0
P1j1  P1j0

while the lower bounds are equivalent to those under monotonicity alone.
Copyright © 2015 John Wiley & Sons, Ltd.

J. Appl. Econ. 32: 56–79 (2017)
DOI: 10.1002/jae

71

SHARP IV BOUNDS ON AVERAGE TREATMENT EFFECTS

Therefore, the bounds on the ATEs on the treated, non-treated and the entire population are given by
UB
DD1 D E.Y jD D 1/ 

P1j0  y LB C Pr.Z D 1/  .P0j0  YN0;0 C P0j1  YN1;0 /
;
Pr.D D 1/


P YN P0j1 YN1;0
C Pr.Z D 1/  .P0j0  YN0;0 C P0j1  YN1;0 /
P1j0  0j0 P0;0
P
1j1
1j0

LB
;
DD1 D E.Y jD D 1/ 
Pr.D D 1/


P YN P1j0 YN0;1
P0j1  1j1 P1;1
C Pr.Z D 0/  .P1j0  YN1;0 C P1j1  YN1;1 /
P
1j1
1j0
 E.Y jD D 0/;
D
UB
DD0
Pr.D D 0/
P0j1  y LB C Pr.Z D 0/  .P1j0  YN1;0 C P1j1  YN1;1 /
LB
 E.Y jD D 0/
D
DD0
Pr.D D 0/

and
UB D P0j1 
LB



D P0j1  y

P1j1  YN1;1  P1j0  YN0;1
P1j1  P1j0
LB

!

C P1j1  YN1;1  P1j0 

C P1j1  YN1;1  P1j0  y LB  P0j0  YN0;0 ;
P0j0  YN0;0  P0j1  YN1;0
P1j1  P1j0

!
 P0j0  YN0;0

As a final remark, it is worth noting that under Assumptions 1–3, Assumption 4 (mean dominance)
has some testable implications. Recall that the always takers’ mean potential outcome is identified by
YN0;1 . Therefore, mean dominance of the compliers can be tested by comparing YN0;1 and YN1;1 , which
also encounters compliers and, therefore, has to dominate. Equivalently, YN1;0 is the never takers’ mean
potential outcome under non-treatment and must be dominated by YN0;0 , which contains never takers
and compliers. The intuition is that since the mean potential outcome of the always takers (never
takers) is not affected by Z under mean independence within strata, the observed mean outcome
consisting of both compliers and always takers (never takers) dominates the observed mean outcome
of the always takers (never takers) only. The respective null hypotheses to be tested are YN1;1  YN0;1
and YN0;0  YN1;0 . See Section 5 for an application of mean dominance tests.
4. ESTIMATION
Under Assumptions 1–3 or 1–4, estimators of the bounds can be constructed by using the sample
analogs of the bounds derived under the various assumptions, which is straightforward. To this end,
we define the following sample parameters:
Pn
Pn
Pn
iD1 Di  Zi
iD1 Di  Zi
iD1 Di  .1  Zi /
O
O
P
P
PO1j1 D P
;
P
D
1

;
P
D
;
0j1
1j0
n
n
n
iD1 Zi
iD1 Zi
iD1 .1  Zi /
Pn
Pn
Pn
iD1 Di  .1  Zi /
iD1 Yi  Di  Zi
iD1 Yi  Di  .1  Zi /
ON D P
ON D P
Y
Y
;
PO0j0 D 1  P
;
;
1;1
0;1
n
n
n
.1

Z
/
D

Z
i
i
i
iD1
iD1
iD1 Di  .1  Zi /
Pn
Pn
O
O
iD1 Yi  .1  Di /  Zi
iD1 Yi  .1  Di /  .1  Zi /
N
N
Y1;0 D Pn
; Y0;0 D P
;
n
iD1 .1  Di /  Zi
iD1 .1  Di /  .1  Zi /
±
°
Pn


t
Y

I
¹D
D
d
º

I
¹Z
D
´º

I
Y

y
O
i
i
1q´;d
iD1 i
t
± ;
°
YON´;d max jq´;d
D P
n
t
iD1 I ¹Di D d º  I ¹Zi D ´º  I Y  yO1q´;d
Copyright © 2015 John Wiley & Sons, Ltd.

J. Appl. Econ. 32: 56–79 (2017)
DOI: 10.1002/jae

72

M. HUBER, L. LAFFERS AND G. MELLACE

±
°
t
Y

I
¹D
D
d
º

I
¹Z
D
´º

I
Y

y
O
i
i
i
q
iD1
´;d
t
± ;
°
D P
YON´;d min jq´;d
n
t
I
¹D
D
d
º

I
¹Z
D
´º

I
Y

y
O
i
i
q´;d
iD1
Pn
³
²
Di  Zi  I ¹Yi  yº
t
; yO LB D min.Y /; yO UB D max.Y /
D min y W iD1 Pn
 q´;d
iD1 Di  Zi


t
yOq´;d



Pn

where I ¹º is the indicator function. Using these expressions instead of the population
parameters
p
in the various formulas for the bounds immediately yields feasible estimators. n-consistency and
asymptotic normality of these estimators follow immediately from the results of Lee (2009) and its
discussion is therefore omitted.
Under Assumptions 1 and 2 or 1, 2 and 4, however, estimation is non-standard due to the presence
of min/max and sup/inf operators. For example, the upper bound on the compliers under Assumptions 1 and 2 is constructed in two steps. First, the sharp upper

bound given
 01 is obtained
 as
N1;1 min jq 11 ; YN0;1 min jq 11 and
Y
the
minimum
of
the
four
possible
combinations
of
the
pairs
1;1
0;1





00
00
YN0;0 max jq0;0
; YN1;0 max jq1;0
, which are both functions of Z . In the second step, the upper
bound is derived by taking the sup of the bound over 01 .
0
UB
0 12
More generally, denote by LB
t .01 ; ´; ´ /; t .01 ; ´; ´ / the upper and lower bounds of any t
conditional on 01 ; Z D ´ in the first min (max) operator and Z D ´0 in the second one. To simplify
the exposition, we define
8
1 if ´ D 1; ´0 D 1
ˆ
ˆ
<
2 if ´ D 1; ´0 D 0
vD
ˆ 3 if ´ D 0; ´0 D 1
:̂
4 if ´ D 0; ´0 D 0
0
UB
0
LB
UB
This allows rewriting LB
t .01 ; ´; ´ /; t .01 ; ´; ´ / as t .01 ; v/; t .01 ; v/. Then, the
identification region of t is obtained by optimizing over admissible values of 01 2 P  and
v 2 V D ¹1; 2; 3; 4º:
²
²
³
³
 LB
 UB
inf  max t .01 ; v/  t  sup min t .01 ; v/ :
01 2P

v2V

01 2P 

v2V

Hirano and Porter (2012) show that for parameters that are non-differentiable functionals
of the data (such as min/max and sup/inf operators), asymptotically
unbiased
®
 LB estimators
¯ do
 maxv2V

not exist. ®Therefore,
the
sample
analog
estimators
of
inf
.
;
v/
and

2P
01
01
t

¯
sup01 2P  minv2V UB
may suffer from substantial bias. Similarly, the usual estimators
t .01 ; v/
of the standard deviations of such sample analog estimators, which are either based on asymptotic
approximation or the bootstrap, produce confidence regions with incorrect coverage probabilities.
However, note that the biases on bounds and confidence intervals induced by optimizing over the
defier proportion and the instrument go in opposite directions. Taking the supremum (infimum) of the
upper (lower) bounds over 01 yields overly conservative inference, while optimizing over Z produces bounds and confidence intervals that are too tight.13 For this reason, we ignore the first source
of bias due to 01 , but account for the second one due to Z by applying the method proposed in
12
This section as well as in online Appendix A.7 focuses on bounds that contain two min/max operators. If the bound contains
UB
only one min (max) operator, these expressions have to be replaced by LB
t .01 ; ´/; t .01 ; ´/. Estimation is then analogous
except that v D ´ and can therefore only take two (rather than four) values.
13
By optimizing over admissible defiers proportions P  (or P  ) we ignore the fact that P  is unknown and needs to be
estimated in practice. Developing a statistical inference procedure that would account for the sampling distribution of P  is,
however, beyond the scope of the present paper, which focuses on identification.

Copyright © 2015 John Wiley & Sons, Ltd.

J. Appl. Econ. 32: 56–79 (2017)
DOI: 10.1002/jae

SHARP IV BOUNDS ON AVERAGE TREATMENT EFFECTS

73

Chernozhukov et al. (2013) and also used in Chen and Flores (2012). In this way we obtain conservative (and half-median-unbiased) point estimates and confidence intervals for the bounds. The method
is described in online Appendix A.7.
5. APPLICATION
We apply the methods outlined in the previous sections to a school voucher experiment that was
conducted within Colombia’s ‘Programa de Ampliación de Cobertura de la Educación Secundaria’
(PACES) in order to evaluate the program’s impact on the educational achievement of various subpopulations. The PACES program targeted low-income families in Colombia and provided more than
125,000 pupils with vouchers covering somewhat more than half the cost of private secondary schooling. Its goals were, among others, to increase net enrollment rates in secondary education and to raise
quality compared to a public-only educational system (see King et al. (1997). We use a subsample
of the data previously analyzed by Angrist et al. (2002), which consists of 1201 pupils in the capital
Bogotá, whose average age was 12 years when they had applied for private school vouchers in 1995.
After randomly (not) being offered a voucher the applicants were re-interviewed in the second half of
1998 to measure the outcome variables of interest such as the highest grade completed and whether
grades had to be repeated.
Let Z denote the random assignment indicator, Y a dummy for never repeating a grade or the highest
grade completed, respectively, and D whether private schooling was actually received. As shown in
Table IV, compliance with the school voucher assignment was not perfect. Only 56.1% of the 629
pupils offered a school voucher actually went to private schools, while 43.9% did not. 94.4% of the 583
pupils that were randomized out did not receive private schooling, but 5.6% attended private schools
anyway. Table V reports the estimated bounds on the strata proportions without monotonicity and the
respective point estimates under Assumption 3 (monotonicity). In our application, P , the outer bounds
on the proportion of defiers based on the distribution of .D; Z/ (given by equation (6)) coincide with
the sharp bounds P  based on the distribution of .Y; D; Z/ under mean independence within principal
strata, which are obtained by linear programming as discussed in online Appendix A.1.1. They also
coincide with the sharp bounds P  under the additional assumption of mean dominance, which are
presented in online Appendix A.3.1.
We estimate bounds on the ATEs of the compliers, the always takers, the never takers, the
treated, and the total population under mean independence within strata, mean dominance, and/or
monotonicity. We do not consider defiers, because P D P  and PO1j1 > PO0j1 imply that the bounds
for the defiers are not informative when only invoking mean independence within strata. Furthermore,
Table IV. Observed strata proportions
Conditional treatment probability
P1j1
P0j1
P1j0
P0j0

D Pr.D
D Pr.D
D Pr.D
D Pr.D

D 1jZ
D 0jZ
D 1jZ
D 0jZ

Estimate

Standard error

0.561
0.439
0.056
0.944

(0.020)
(0.020)
(0.010)
(0.010)

D 1/
D 1/
D 0/
D 0/

Table V. Estimated (bounds on the) proportions of latent strata
Latent strata

Bounds without monotonicity

Proportions under monotonicity

[0.000, 0.056]
[0.505, 0.561]
[0.383, 0.439]
[0.000, 0.056]

0.056
0.505
0.439
—

Always takers
Compliers
Never takers
Defiers
Copyright © 2015 John Wiley & Sons, Ltd.

J. Appl. Econ. 32: 56–79 (2017)
DOI: 10.1002/jae

74

M. HUBER, L. LAFFERS AND G. MELLACE

defiers are ruled out under monotonicity (and under both monotonicity and mean dominance). Note
also that the bounds for the always takers are not informative under mean independence within strata
alone, because PO1j0 < PO0j1 such that the share of always takers is smaller than the share of never
takers. However, under monotonicity and/or mean dominance, informative bounds can be obtained for
this stratum.
Whenever optimization over the defier proportion is required,14 we use an equidistant grid of 100
values between the minimum (0) and maximum (0.056) possible shares. Under mean independence
within strata and/or mean dominance (without monotonicity), we apply the Chernozhukov et al. (2013)
procedure (see the previous section) for estimation and inference (using a nominal significance level
of 5%) using 5000 bootstraps and 200,000 simulations.15 Under monotonicity (with and without mean
dominance), which implies that standard asympotics apply to the bounds, we compute the 95% confidence intervals for the ATEs (rather than the bounds) based on the method described in Imbens and
Manski (2004):


O LB
O UB

O tLB ; 
O tUB
t  1:645  
t C 1:645  
O LB
O UB
where 
O tLB ; O tUB denote their respective estimated
t ; t are the estimated bounds in stratum t and 
16
standard errors, obtained from 5000 bootstrap replications. Concerning the worst-case bounds y UB
and y LB , note that the binary outcome ‘never repeating a grade’ is naturally bounded between 0 and
1. For the highest grade completed, we take the maximum and minimum values observed in the data,
which are 11 and 5 years of schooling, respectively.
Table VI presents the results for the outcome ‘never repeating a grade’ after the school voucher
assignment under the various assumptions. The bounds of the ATE estimates are given in square
brackets; the 95% confidence intervals are in round brackets. When only invoking Assumptions 1 and
2, the bounds are not informative for the always takers and quite wide for the never takers and the entire
population. For the treated, the estimated interval is positive, but the lower bound is not significantly
different from zero. For the compliers, the set is significantly positive (on a nominal level of 5%) and
suggests that private schooling decreases the probability to repeat a class by 7–21 percentage points.
This result suggests that mean independence within strata might have considerable identifying power
in applications even when other restrictions such as monotonicity do not appear plausible.
Mean dominance slightly narrows the bounds for the always takers, which are now informative,
but all in all the gains in identification are, if anything, modest. In contrast, monotonicity of D in Z
(such that defiers are ruled out) entails point identification of the ATE on the compliers. The positive
and significant estimate implies that grade repetition is reduced by roughly 12 percentage points when
attending a private school. Also the identification region of the ATE on the treated, which (from a
policy perspective) often represent the most interesting population, is now significantly positive. When
invoking both monotonicity and mean dominance, the lower bound for the treated is tightened further. The identification regions for the always takers, never takers, and the entire population shrink
somewhat too, but still include the possibility of a zero effect.
14
This concerns the compliers and—owing to the discreteness of the outcomes—also the treated and the entire population
under Assumptions 1 and 2, and all populations considered under Assumptions 1, 2 and 4.
15
We are indebted to Xuan Chen and Carlos Flores for providing us with their Matlab code implementing the Chernozhukov
et al. (2013) procedure and for their helpful advice concerning its implementation. As we have to estimate 100
variance–covariance matrices for each bound when optimizing over 01 (one for each value of the grid), some of them are close
to being singular. To overcome this problem we use the Matlab function ‘mchol’ by Brian Borchers (downloaded on 6 February
2013 from http://infohost.nmt.edu/~borchers/ldlt.html) for regularization.
16
The confidence intervals apply to cases where the distance between the upper and lower bound of the effect is bounded
away from zero (Stoye, 2009). Underpoint identification (as for the compliers
under monotonicity), the conventional two-sided

O t C 1:96  O t , where 
O t ; O t denote the point estimate of the effect
O t  1:96  O t ; 
confidence intervals are to be used: 
and the estimated standard error.

Copyright © 2015 John Wiley & Sons, Ltd.

J. Appl. Econ. 32: 56–79 (2017)
DOI: 10.1002/jae

75

SHARP IV BOUNDS ON AVERAGE TREATMENT EFFECTS

Table VI. ATE estimates on ‘never repeating a grade’ and confidence intervals
Assumptions

Compliers

Always takers

Never takers

Treated

Entire pop.

Assumptions 1 and 2 only

[0.072, 0.208]
(0.000, 0.281)

[1.000, 1.000]
Not informative

[0.783, 0.379]
(0.837, 0.426)

[0.044, 0.263]
(0.010, 0.333)

[0.261, 0.253]
(0.302, 0.286)

Mean dominance

[0.071, 0.207]
(0.005, 0.250)

[0.923, 0.966]
(1.000, 0.981)

[0.785, 0.350]
(0.811, 0.401)

[0.045, 0.266]
(0.009, 0.333)

[0.261, 0.255]
(0.302, 0.287)

Monotonicity

0.118
(0.032, 0.203)

[0.156, 0.844]
(0.263, 0.951)

[0.684, 0.316]
(0.730, 0.363)

[0.070, 0.245]
(0.010, 0.313)

[0.249, 0.245]
(0.293, 0.277)

Both

0.118
(0.032, 0.203)

[0.011, 0.844]
(0.138, 0.951)

[0.684, 0.289]
(0.730, 0.340)

[0.095, 0.245]
(0.025, 0.313)

[0.241, 0.234]
(0.287, 0.270)

Note: Bounds are in square brackets and confidence intervals in round brackets. Confidence intervals are based on 5000
bootstraps. The number of simulations for the half-median-unbiased estimators is 200,000.

Table VII. ATE estimates on ‘highest grade completed’ and confidence intervals
Assumptions

Compliers

Always takers

Never takers

Treated

Entire pop.

Assumptions 1 and 2 only

[0.149, 0.562]
(0.008, 0.721)

[6.000, 6.000]
Not informative

[2.512, 4.019]
(2.627, 4.248)

[0.353, 0.760]
(0.562, 0.952)

[1.026, 1.984]
(1.155, 2.143)

Mean dominance

[0.155, 0.549]
(0.001, 0.640)

[2.007, 3.012]
(2.624, 3.037)

[2.513, 1.019]
(2.576, 1.121)

[0.037, 0.810]
(0.084, 0.988)

[0.866, 0.734]
(0.984, 0.806)

Monotonicity

0.326
(0.126, 0.526)

[3.188, 2.813]
(3.457, 2.967)

[2.251, 3.749]
(2.362, 3.987)

[0.287, 0.760]
(0.506, 0.940)

[1.002, 1.968]
(1.133, 2.127)

Both

0.326
(0.126, 0.526)

[0.115, 2.813]
(0.112, 2.967)

[2.251, 0.773]
(2.362, 0.889)

[0.289, 0.760]
(0.122, 0.940)

[0.818, 0.661]
(0.943, 0.746)

Note: Bounds are in square brackets and confidence intervals in round brackets. Confidence intervals are based on 5000
bootstraps. The number of simulations for the half-median-unbiased estimators is 200,000.

Table VII shows the estimates for the outcome ‘highest grade completed”. Under Assumptions 1 and
2 alone, the estimated set for the ATE on the compliers is positive and almost significant. This suggests
that attending a private school increases the highest grade completed on average by 0.15–0.56 years
for this population. Mean dominance does little to shrink the complier bounds. Under monotonicity,
the point estimate suggests that schooling is on average raised by a third of a year. When invoking both
assumptions, also the ATE on the treated (between 0.29 and 0.76 years) is significantly positive. Even
the identification region for the always takers is larger than zero, but the effect is not significant at the
5% level. All in all, our results support the conclusion of Angrist et al. (2002) that pupils going to
private schools benefited from higher educational attainment. We find economically important positive
effects on the likelihood not to repeat grades and on the highest grade completed among the compliers,
but also among the treated population. The latter result is particularly relevant, because it suggests that
the program increases the outcomes of those actually participating, a group that is most likely of more
policy interest than the latent population of compliers.
As mentioned in Section 3.4, mean dominance of the compliers’ potential outcomes has testable
implications if monotonicity holds. We therefore bootstrap the sample analogs of EŒY.1/jT D 10
EŒY.1/jT D 11 and EŒY.0/jT D 10  EŒY.0/jT D 00 (with EŒY.1/jT D 10 D
P1j1 YN1;1 P1j0 YN0;1
P YN P0j1 YN1;0
; EŒY.0/jT D 10 D 0j0 P0;0
; EŒY.1/jT D 11 D YN0;1 and EŒY.0/jT D
P1j1 P1j0
0j0 P0j1
00 D YN1;0 ) to test whether the respective mean potential outcome of the compliers dominates that
Copyright © 2015 John Wiley & Sons, Ltd.

J. Appl. Econ. 32: 56–79 (2017)
DOI: 10.1002/jae

76

M. HUBER, L. LAFFERS AND G. MELLACE

Table VIII. Mean potential outcomes and mean dominance tests
Never repeating a grade

Highest grade completed

0.973
0.855
0.844
0.684
0.964
0.997
0.559

8.024
7.698
7.813
7.251
0.975
0.998
0.211

E ŒY .1/jT D 10
E ŒY .0/jT D 10
E ŒY .1/jT D 11
E ŒY .0/jT D 00
p -value for H0 W E ŒY .1/jT D 10  E ŒY .1/jT D 11
p -value for H0 W E ŒY .0/jT D 10  E ŒY .0/jT D 00
p -value for H0 W E ŒY .0/jT D 10  E ŒY .1/jT D 11

Note: p -values of mean dominance tests are based on 1999 bootstraps.

of the always takers under treatment and that of the never takers under non-treatment.17 Table VIII
reports the mean potential outcomes of the various populations and the p -values of the tests. The
results strongly support the mean dominance of the compliers over the always takers under treatment
and the mean dominance of the compliers over the never takers under non-treatment.
However, strictly speaking we also have to test whether the compliers dominate the always takers
under non-treatment and the never takers under treatment, respectively. Even though this is infeasible
(because always takers are never observed under non-treatment, just as never takers under treatment),
the mean potential outcomes provide indirect evidence that these assumptions are most likely satisfied. First of all, the hypothesis that the mean potential outcome of the compliers under non-treatment
dominates the mean potential outcome of the always takers under treatment cannot be rejected for
either outcome; i.e. if the ATE on the always takers is either positive or at least not negative by a sufficiently large amount, the mean potential outcome of the always takers under non-treatment cannot be
larger than that of the compliers. Furthermore, the never takers can only have a higher mean potential
outcome under treatment than the compliers if the ATE on the former is substantially larger than that
on the latter (as the mean potential outcome of the never takers under non-treatment is considerably
lower than that of the compliers for both outcome variables). In this case, however, it seems irrational
of the never takers not to take the treatment such that this scenario appears unlikely.
Given the results of the tests, the question arises under which circumstances it seems plausible that
the compliers’ mean educational achievement dominates those of the always and never takers. Suppose
that the private schooling decision is a function of (monetary and non-monetary) costs and utility
coming from educational achievement. Economic theory suggests that rational households should send
their children to private schools only if the expected utility is at least as high as the costs. Always taker
households may get a relatively higher utility from education, e.g. because the parents are themselves
better educated and therefore appreciate education more than the compliers. Furthermore, they may
represent the more wealthy households (as they send their children to private schools even without
vouchers) such that their relative costs for schooling are lower. This might again be correlated with
parental education. Both increased utility and lower relative costs will give relatively more pupils with
lower potential outcomes—related to lower ability and/or motivation—the chance to receive private
schooling. This line of argumentation is supported by the data, which also contain information on
fathers’ and mothers’ education and the possession of a phone, which may be regarded as a proxy for
17
Of course, this approach tests mean dominance conditional on the satisfaction of Assumptions 2 and 3 and is otherwise
a joint test of all three assumptions. Huber and Mellace (2015b) suggest tests (i) for Assumptions 2 and 3 alone and (ii)
(as also Kitagawa, 2014) for full independence of the instrument and potential treatments/outcomes and Assumption 3. For
the
p outcome ‘never repeating a grade’, using the method of Chen and Szroeter (2014) (with a normal smoothing function and
n=2 log.log.n// as tuning parameter for the selection of binding moments) to test (i) and (ii) (with two equidistant probability
measures) yields p -values of 1.000 and 0.999, respectively. For ‘highest grade completed’, the respective p -values are 0.993
and 0.851. Therefore, our data provide no evidence for a violation of (i) or (ii).

Copyright © 2015 John Wiley & Sons, Ltd.

J. Appl. Econ. 32: 56–79 (2017)
DOI: 10.1002/jae

SHARP IV BOUNDS ON AVERAGE TREATMENT EFFECTS

77

wealth. The means of these variables (which were measured before the assignment) are higher among
always takers than among compliers and the differences are significant at the 10 % level.18
In contrast, mean parental education and possessing a phone do not significantly differ between the
never takers and compliers. Given that they face similar utilities (for a particular level of education)
and relative costs as the compliers, it is plausible that the never taker households did not respond to
the vouchers because their children were probably less motivated and/or able and for this reason their
expected returns to private schooling were too small. This suggests that the never takers’ ATE (and
the mean potential outcomes) is lower than those of the compliers, as never taker households were not
even willing to pay less than half of the cost of private schooling (recall that the vouchers did not cover
the entire expenses).
6. CONCLUSION
This paper sheds light on the question of what can be learned about the ATE on various populations
under endogeneity/noncompliance when a valid IV is at hand that satisfies mean independence within
strata and ignorable assignment. Since the work by Imbens and Angrist (1994) it is well known that
a LATE on the compliers (who take the treatment if instrumented, but do not otherwise) is point
identified under monotonicity of the treatment in the instrument. Even though point identification is
not feasible for other groups, we show that informative bounds can be obtained for the always takers
(treated irrespective of the instrument), the never takers (not treated irrespective of the instrument), the
treated, the non-treated and the entire population. We also investigate the identifying power of mean
dominance of the potential outcomes of the compliers over those of the always takers and never takers.
The main contribution is the derivation of sharp bounds on the ATE of various populations under
monotonicity, mean dominance and under both assumptions. We also present an application to Colombia’s ‘Programa de Ampliación de Cobertura de la Educación Secundaria’, which provided pupils from
low-income families with vouchers for private secondary schooling, using experimental data previously analyzed by Angrist et al. (2002). We find (on top of the complier effect) a significantly positive
ATE on the educational achievement of the treated population, a group of major policy interest. As
valuable ‘by-products’ of our identification results we also obtain testable implications of the validity
of the instrument and of mean dominance, respectively.
ACKNOWLEDGEMENTS

We have benefited from comments by Sylvain Chabé-Ferret, Philipp Denter, Michael Lechner,
Fabbrizia Mealli, Christoph Rothe, Anthony Strittmatter, seminar/conference participants in St Gallen
(research seminar), Tor Vergata (lunch seminar), Engelberg (labor seminar 2011) and Vancouver
(SOLE 2011), Gothenburg (ESEM 2013), the editor Edward Vytlacil, and four anonymous referees.
REFERENCES

Angrist J, Imbens G, Rubin D. 1996. Identification of causal effects using instrumental variables (with discussion).
Journal of American Statistical Association 91: 444–472.
Angrist J, Bettinger E, Bloom E, King E, Kremer M. 2002. Vouchers for private schooling in Colombia: evidence
from a randomized natural experiment. American Economic Review 92: 1535–1558.
Balke A, Pearl J. 1997. Bounds on treatment effects from studies with imperfect compliance. Journal of the
American Statistical Association 92: 1171–1176.
Bhattacharya J, Shaikh AM, Vytlacil E. 2008. Treatment effect bounds under monotonicity assumptions: an
application to Swan-Ganz catheterization. American Economic Review 98: 351–356.
Bloom HS. 1984. Accounting for no-shows in experimental evaluation designs. Evaluation Review 8: 225–246.
18

The test statistics are available from the authors upon request.

Copyright © 2015 John Wiley & Sons, Ltd.

J. Appl. Econ. 32: 56–79 (2017)
DOI: 10.1002/jae

78

M. HUBER, L. LAFFERS AND G. MELLACE

Blundell R, Gosling A, Ichimura H, Meghir C. 2007. Changes in the distribution of male and female wages
accounting for employment composition using bounds. Econometrica 75: 323–363.
Chen LY, Szroeter J. 2014. Testing multiple inequality hypotheses: a smoothed indicator approach. Journal of
Econometrics 178: 678–693.
Chen X, Flores CA. 2012. Bounds on treatment effects in the presence of sample selection and noncompliance:
the wage effects of job corps. Working paper. Department of Economics, University of Miami.
Cheng J, Small DS. 2006. Bounds on causal effects in three-arm trials with noncompliance. Journal of the Royal
Statistical Society, Series B 68: 815–836.
Chernozhukov V, Lee S, Rosen A. 2013. Intersection bounds: estimation and inference. Econometrica 81:
667–737.
Chiburis RC. 2010. Semiparametric bounds on treatment effects. Journal of Econometrics 159: 267–276.
Dawid AP. 2003. Causal inference using influence diagrams: the problem of partial compliance (with discussion).
In Highly Structured Stochastic Systems, Green PJ, Hjort NL, Richardson S (eds). Oxford University Press:
Oxford; 45–81.
Deaton AS. 2010. Instruments, randomization, and learning about development. Journal of Economic Literature
48: 424–455.
Flores CA, Flores-Lagunes A. 2013. Partial identification of local average treatment effects with an invalid
instrument. Journal of Business and Economic Statistics 31: 534–545.
Frangakis CE, Rubin DB. 2002. Principal stratification in causal inference. Biometrics 58: 21–29.
Frölich M. 2007. Nonparametric IV estimation of local average treatment effects with covariates. Journal of
Econometrics 139: 35–75.
Frölich M, Lechner M. 2010. Combining matching and nonparametric IV estimation: theory and an application to
the evaluation of active labour market policies. Department of Economics discussion paper 2010-21. University
of St Gallen.
Heckman JJ, Urzúa S. 2010. Comparing IV with structural models: what simple IV can and cannot identify.
Journal of Econometrics 156: 27–37.
Heckman JJ, Vytlacil E. 2001. Instrumental variables, selection models, and tight bounds on the average treatment effects. In Econometric Evaluation of Labour Market Policies, Lechner M, Pfeiffer M (eds). Center for
European Economic Research: New York; 1–15.
Heckman JJ, LaLonde R, Smith J. 1999. The economics and econometrics of active labour market programs. In
The Handbook of Labor Economics, Ashenfelter O, Card D (eds). North-Holland: New York; 1865–2097.
Hirano K, Porter JR. 2012. Impossibility results for nondifferentiable functionals. Econometrica 80: 1769–1790.
Horowitz JL, Manski CF. 1995. Identification and robustness with contaminated and corrupted data. Econometrica 63: 281–302.
Huber M, Mellace G. 2015a. Sharp bounds on causal effects under sample selection. Oxford Bulletin of Economics
and Statistics 77: 129–151.
Huber M, Mellace G. 2015b. Testing instrument validity for late identification based on inequality moment
constraints. Review of Economics and Statistics 97: 398–411.
Imbens GW. 2004. Nonparametric estimation of average treatment effects under exogeneity: a review. Review of
Economics and Statistics 86: 4–29.
Imbens GW. 2009. Better late than nothing: some comments on Deaton (2009) and Heckman and Urzua (2009).
NBER working paper 14896.
Imbens GW, Angrist J. 1994. Identification and estimation of local average treatment effects. Econometrica 62:
467–475.
Imbens GW, Manski CF. 2004. Confidence intervals for partially identified parameters. Econometrica 72:
1845–1857.
King E, Rawlings L, Gutierrez M, Pardo C, Torres C. 1997. Colombias targeted education voucher program:
Features, coverage and participation. Working paper 3. Series on Impact Evaluation of Education Reforms,
Development Economics Research Group, World Bank.
Kitagawa T. 2009. Identification region of the potential outcome distribution under instrument independence.
CeMMAP working paper 30/09.
Kitagawa T. 2014. A test for instrument validity. CeMMAP working paper 34/14.
Lafférs L. 2013. A note on bounding average treatment effects. Economics Letters 120: 424–428.
Lechner M, Melly B. 2007. Earnings effects of training programs. IZA discussion paper 2926.
Lee DS. 2009. Training, wages, and sample selection: estimating sharp bounds on treatment effects. Review of
Economic Studies 76: 1071–1102.
Manski CF. 1989. Anatomy of the selection problem. Journal of Human Resources 24: 343–360.
Manski CF. 1990. Nonparametric bounds on treatment effects. American Economic Review, Papers and
Proceedings 80: 319–323.
Copyright © 2015 John Wiley & Sons, Ltd.

J. Appl. Econ. 32: 56–79 (2017)
DOI: 10.1002/jae

SHARP IV BOUNDS ON AVERAGE TREATMENT EFFECTS

79

Manski CF. 1994. The selection problem. In Advances in Econometrics: Sixth World Congress, Sims C (ed).
Cambridge University Press: Cambridge, UK; 143–170.
Richardson TS, Robins JM. 2010. Analysis of the binary instrumental variable model. In Heuristics, Probability and Causality: A Tribute to Judea Pearl, Dechter R, Geffner H, Halpern JY (eds). College Publications:
London; 415–440.
Robins J. 1989. The analysis of randomized and non-randomized AIDS treatment trials using a new approach to
causal inference in longitudinal studies. In Health Service Research Methodology: A Focus on AIDS, Sechrest
L, Freeman H, Mulley A (eds). US Public Health Service: Washington, DC; 113–159.
Rubin DB. 1974. Estimating causal effects of treatments in randomized and nonrandomized studies. Journal of
Educational Psychology 66: 688–701.
Rubin DB. 1990. Formal modes of statistical inference for causal effects. Journal of Statistical Planning and
Inference 25: 279–292.
Shaikh AM, Vytlacil EJ. 2011. Partial identification in triangular systems of equations with binary dependent
variables. Econometrica 79: 949–955.
Stoye J. 2009. More on confidence intervals for partially identified parameters. Econometrica 77: 1299–1315.
Vytlacil E. 2002. Independence, monotonicity, and latent index models: an equivalence result. Econometrica 70:
331–341.
Zhang J, Rubin DB. 2003. Estimation of causal effects via principal stratification when some outcome are
truncated by death. Journal of Educational and Behavioral Statistics 28: 353–368.
Zhang J, Rubin DB, Mealli F. 2008. Evaluating the effects of job training programs on wages through principal
stratification. In Advances in Econometrics: Modelling and Evaluating Treatment Effects in Econometrics,
Millimet D, Smith J, Vytlacil E (eds), Vol. 21. Elsevier: Amsterdam; 117–145.

Copyright © 2015 John Wiley & Sons, Ltd.

J. Appl. Econ. 32: 56–79 (2017)
DOI: 10.1002/jae

