Causal Inference with General Treatment Regimes: Generalizing the Propensity Score
Author(s): Kosuke Imai and David A. Van Dyk
Reviewed work(s):
Source: Journal of the American Statistical Association, Vol. 99, No. 467 (Sep., 2004), pp. 854866
Published by: American Statistical Association
Stable URL: http://www.jstor.org/stable/27590455 .
Accessed: 28/11/2012 09:59
Your use of the JSTOR archive indicates your acceptance of the Terms & Conditions of Use, available at .
http://www.jstor.org/page/info/about/policies/terms.jsp

.
JSTOR is a not-for-profit service that helps scholars, researchers, and students discover, use, and build upon a wide range of
content in a trusted digital archive. We use information technology and tools to increase productivity and facilitate new forms
of scholarship. For more information about JSTOR, please contact support@jstor.org.

.

American Statistical Association is collaborating with JSTOR to digitize, preserve and extend access to Journal
of the American Statistical Association.

http://www.jstor.org

This content downloaded by the authorized user from 192.168.72.229 on Wed, 28 Nov 2012 09:59:46 AM
All use subject to JSTOR Terms and Conditions

Causal

With

Inference

General

Treatment
Regimes:
the Propensity
Score

Generalizing
Imai and

Kosuke

A. van

David

Dyk

In this article we

the theoretical properties
of the propensity
is a generalization
of the propensity
score of
function, which
develop
score have long been used for causal inference in observational
and Rubin. Methods
based on the propensity
studies; they
are easy to use and can effectively
reduce the bias caused by nonrandom
treatment assignment. Although
treatment regimes need not be
score methods
are generally confined to binary treatment scenarios. Two
have been
binary in practice, the propensity
possible exceptions
treatments. In this article we develop theory and methods
that encompass
all of these techniques and
suggested for ordinal and categorical
widen
their applicability
function methods
them to
by allowing for arbitrary treatment regimes. We illustrate our propensity
by applying
two datasets; we estimate the effect of smoking on medical
expenditure and the effect of schooling on wages. We also conduct simulation

Rosenbaum

studies

to investigate

KEY WORDS:

of our methods.

the performance

Medical
Treatment

treatment

Nonrandom

expenditure;
effect.

1. INTRODUCTION
Establishing the effect of a treatment that is not
signed is a common goal in empirical research.
of random assignment means that groups with
els of the treatment variable can systematically
portant

other

ways

than

the observed

treatment.

randomly as
But the lack
different lev
differ in im

Because

these

differences may exhibit complex correlations with the outcome
variable,

the

ascertaining

causal

effect

of

may

be difficult. It is in this setting that the propensity score of
and Rubin (1983b) has found wide applicability
Rosenbaum
in empirical research; in particular, the method has rapidly be
come

in the

popular

social

sciences

Heckman,

(e.g.,

Ichimura,

and Todd 1998; Lechner 1999; Imai 2004).
The propensity score aims to control for differences between
the treatment groups when the treatment is binary; it is defined
as the conditional probability of assignment to the treatment
group given a set of observed pretreatment variables. Under the
of

assumption

strongly

treatment

ignorable

multi

assignment,

variate adjustment methods based on the propensity score have
the desirable property of effectively reducing the bias that fre
arises

quently

in observational

In fact,

studies.

there

exists

em

pirical evidence that in certain situations the propensity score
method produces more reliable estimates of causal effects than
other estimation methods (e.g., Dehejia andWahba 1999; Imai
2004).
The

score

propensity

conditional

on

assignment

and

the propensity
the

observed

(Rosenbaum and Rubin
tional

independence

tial outcomes
to obtain

matching

is called

score

balancing

the binary

score,
covariates

are

because,

treatment

between

treatment

estimates

or subclassification

of

assignment

covariates,
treatment

the randomization

score, adjusting

can

the variance

reduce

scheme

of

the

estimated

score

the propensity
a scalar, which
on many

sifying

amounts

easier

One

effect.

is that adjusting for
or

to matching

is significantly

score

propensity

treatment

true

the

specifies

for the estimated

of the principle advantages of this method

subclassifying
or subclas

on

than matching

covariates.

In this article we extend and generalize the propensity score
method so that it can be applied to arbitrary treatment regimes.
The original propensity score was developed to estimate the
causal

effects

vational

a

of

studies,

treatment;

binary

treatment

the

in many

however,
not

may

be

obser

or even

binary

cate

gorical. For example, in clinical trials, one may be interested in
estimating the dose-response function where the drug dose may
take

on

a continuum

of values

the

Alternatively,

treatment

where

school

(e.g.,

be

may

The

1995).

and

Feldman

is the effect
can

an

on

of schooling

as years

treatment

1991).

In economics,

ordinal.

is measured

schooling
Card

Efron

(e.g.,

of interest

important quantity
wages,

of

also

in

education

consist

of mul

tiple factors and their interactions. In political science, one may
be interested in the combined effects of different voter mobi
lization
(e.g.,

poten

as

such

strategies,
Gerber

and Green

calls

phone

2000).

and

door-to-door

can

Treatment

also

visits

be measured

in terms of frequency and duration, for example, the health ef
fects of smoking. These examples illustrate the need to extend

then it is possible
effects.

where

propensity

independent

and

Subclassification;

Rosenbaum
1987; Robins, Rotnitzky, and Zhao 1995; Rubin
and Thomas 1996; Heckmen et al. 1998; Hirano, Imbens, and
Ridder 2003); see also Section 5.3. Indeed, even in randomized

1983b). If we further assume the condi

given the observed

unbiased

a

to schooling;

studies; Return

propensity score, which is ordinarily generated by logistic re
gression (Rosenbaum and Rubin 1984, 1985). The advantage
of using estimated propensity scores in place of true propen
sity scores has been discussed at length in the literature (e.g.,

experiments

treatment

the

Observational

assignment;

In practice,

the propensity

is used to adjust for the estimated

ence,

to handle
able.

prominent

variable

use
that

treatment

of the propensity

a univariate

(We

the

term

takes

on

ordered

variable"
values,

infer

regimes.

score have been developed
or

categorical
"ordinal

of causal

methodology

to general

Two extensions
Kosuke
Imai is Assistant Professor, Department
of Politics, Princeton Uni
David A. van Dyk
versity, Princeton, NJ 08544 (E-mail: kimai@princeton.edu).
is Associate
of Statistics, University
of California,
Professor,
Department
92697-1250
The
authors
thank
Irvine, CA
(E-mail:
dvd@ics.uci.edu).
Joshua Angrist, Guido Imbens, Elizabeth Johnson, and Scott Zegar for provid
ing the dataseis used in this article. They also thank Jim Alt, Samantha Cook,
Jennifer Hill, Dan Ho, Gary King, Donald Rubin, Phil Schrodt,
Jas Sekhon,
and Elizabeth Stuart for helpful discussions.
The comments from the associate
editor and anonymous
referees significantly
improved this article. Research
Science Foundation
support was provided by National
grant DMS-01-04129,
the U.S. Census Bureau, and the Princeton University Committee
on Research
in the Humanities
and Social Sciences.

a

score,

for application

ordinal

treatment

whereas

vari

to a discrete

to refer
a

"categorical

variable"
(2000)

is discrete with possibly unordered values.) Imbens
suggested computing a propensity score for each level
?

2004 American
Statistical
of the American
Statistical
2004, Vol. 99, No. 467, Theory

Journal
September

Association
Association
and Methods

DOI 10.1198/016214504000001187

854

This content downloaded by the authorized user from 192.168.72.229 on Wed, 28 Nov 2012 09:59:46 AM
All use subject to JSTOR Terms and Conditions

Imai and van Dyk: Generalizing

of a categorical

treatment

mean

The

Score

that

variable;

is, he

855

com

recommends

of each treatment given the observed co

puting the probability
variates.

the Propensity

under

response

each

level

of

treatment

the

is estimated as the average of the conditional means given the
corresponding propensity score. The effect of the treatment can
be

studied

ous

by

comparing

the mean

levels.

an

treatment

For

under

responses
treatment

ordinal

the

vari
Joffe

variable,

and Rosenbaum (1999) proposed and Lu, Zanutto, Hornik, and
Rosenbaum (2001) applied amethod based on a scalar balanc
ing score; matching subjects on this score tends to balance the
covariates.

Both

of

these

extensions

an

maintain

ad

important

and Rubin (1983b);
vantage of the approach of Rosenbaum
co
balance a potentially high-dimensional
they effectively
variate by adjusting for a scalar propensity score. [Joffe and
Rosenbaum
(1999) proposed the possibility of adjusting for a
low-dimensional

linear

score

propensity

in the context

of

a uni

variate ordinal treatment. Imbens (2000) also suggested adjust
ing for several propensity scores, but with the scores adjusted
for one

at a time.]

In this article we develop methods and theory that encom
pass the generalized propensity scores of Imbens (2000) and
Joffe and Rosenbaum (1999). Our methods can establish causal
in observational

effects
ical,

studies

continuous,

ordinal,

where

treatment

the

or even

semicontinuous,

is categor
multivariate.

closely related to those of Joffe
emphasize techniques based on
on the matching used by Lu et
are able to effectively balance a
covariate by adjusting for a low-dimensional
high-dimensional
(though perhaps not scalar) propensity score.
This article is organized as follows. In Section 2 we describe
the propensity function, our generalization of the propensity
We

and

apply

our method

evaluate

using

a continuous

treatment in Section 3 and a bivariate treatment in Section 4.
In Section 5 we illustrate how our methods can improve bal
ance

in a randomized

design.

we

Finally,

give

some

status

of

concluding

remarks in Section 6.

another

unit

units

consider

and,

given

of

conditional

distribution

usually parametrically.

status.

(Thus

we

Because

observational

be
us

allows

to

the

suppress
treatment

the
studies

index,
assign

is unknown,

the

of TA given X needs to be modeled,
2 allows us to model TA
Assumption

on

conditioning

of interference

covariates,

of one unit to be independent

the article.)

in most

mechanism

without

observed

treatment

unit's

/, in the remainder

covariates.

the possibility

the

the potential outcomes

of another

ment

the observed

given

1 excludes

Assumption
tween

outcomes.

potential

Assumption 2: Strong Ignorability of Treatment Assignment
(Rosenbaum and Rubin 1983b). The distribution of the actual
treatment

not

does

on

depend

potential

outcomes

the ob

given

=
served covariates. Formally, p{TA\Y(tp),X]
p(TA\X)
all tp e T. Furthermore, 0 < p(JA e A\X) for all X e X
measurable sets A C T with positive measure.
In practice,
be made

Although, our methods are
and Rosenbaum
(1999), we
subclassification
rather than
al. (2001). Finally, we also

score.

1: Stable Unit Treatment Value Assumption
Assumption
(Rubin 1980, 1990). The distribution of potential outcomes for
one unit is assumed to be independent of potential treatment

is a nontrivial assumption

ignorability
with

only

care;

great

omitting

that should

can

covariates

for
and

seriously

bias estimates of causal effects (Rosenbaum and Rubin 1983a;
Drake 1993); see also Section 5. For clarity, we maintain As
sumptions 1 and 2 and discuss generalization of the propensity
score

method

under

these

assumptions.

When making causal inference, the distribution p{Y(tp)\X}
as a function of tp and for fixed X, or its average over the
=
is of primary
population, p{Y(tp)}
f p{Y(tp)\X}p(X)dX,
interest. The fundamental difficulty of causal inference in ob
servational studies is that we observe only one of the potential
in practice we must
outcomes, Y(TA = tp) e y. Therefore,
on

condition

the

treatment

observed

TA and X are not generally

p{Y(tp)\TA}

=

But

assignment.

independent,

because

inference on

basing

f p{Y(tp)\TA,X}p(X\TA)dX often leads to

lies in conditioning on the observed covari
2, p{Y(tp)\TA, X} oc p{Y(tp), JA\X} =
a p{Y(tp)\X}.
Thus the average causal
p{Y(tp)\X}p{TA\X}
=
=
effect E{Y(tp)
Y(tp)\X}
E{Y(tp)\TA
tf,X}
=
tp, X}, where tf # t?, and we obtain valid in
E{Y(tp)\TA
bias. The solution

2. METHODOLOGYAND THEORY
2.1

Framework
a

For
serve

a p

for Causal

of

for

the outcome

causal

that we

ob

the

pos

X;,

value of the treatment received, TA, and the

the Rubin

Using

Inference

random
of size n, suppose
sample
simple
x 1 vector
of pretreatment
covariates,

sibly multivariate
value

ates; by Assumption

variable

we

this

treatment,

Fz.

define

a

set

of

outcomes,

potential

=
g Tfori
where T is a set of po
y = {F/(tp),tp
1,...,?},
tential treatment values and Y?(tp) is a random variable that
a

maps
come.

We

treat

tp

(In our

variable.

as an ordinary

general

sibly multivariate
examples,

treatment,

potential

particular

however,

notation,

variable
we

to a potential

tp,

use

out

as a random
and
TzA
boldface
for the pos

treatment variables, TA and tp. In particular
these

variables

may

be univariate,

in which

case we do not use boldface. Thus, we use TA and tp in place
of TA and tp when the treatment is represented via a univariate
quantity.)
To
dard

evaluate
two

the

assumptions.

effect

of

served

the

treatment,

we

rely

on

the

stan

on X

conditional
treatment

but

even

when

we

on

condition

the

ob

assignment.

In principle, we

(Holland 1986) as a framework

causal model

inference,

with

associated

ference

can model

shows

experience

with

directly,

=tp,X}

p{Y(tp)\TA

even

that

binary

treatments,

stan

assumptions, such as linearity, do not suffice, and
can strongly bias causal inference (Drake
this misspecification

dard model

1993; Dehejia
niques
used.

exist;

and Wahba
matching
as

However,

1999). Various
and

the dimension

nonparametric

subclassification
of X

increases,

are

tech

commonly

matching

and

subclassification become impossible in practice. The propensity
score aids analysis in this regard by reducing the dimension of
the variable

that

is conditioned

upon

to a scalar.

In the next

sec

tion we generalize the propensity score so that it not only is
applicable to arbitrary treatment regimes, but also sufficiently
reduces the dimension of X to allow for efficient matching or
subclassification.

This content downloaded by the authorized user from 192.168.72.229 on Wed, 28 Nov 2012 09:59:46 AM
All use subject to JSTOR Terms and Conditions

use

Function

2.2 The Propensity

define the propensity function as the conditional prob
treatment given the
ability of the actual, perhaps multivariate,
We

observed

that

covariates,

where

is, pf(TA\X),

j/r parameter

izes this distribution. When TA is binary the propensity func
tion is determined by the propensity score, Pf(TA\X)\TA=x,
where TA is an indicator variable for the treatment. More
generally, the parametric model defines the propensity func
tion, ef(-\X) = pf(-\X). When the propensity function is un
of the model is possible, which may
known, misspecification
bias causal inference. Thus care must be taken both to identify
as many

as

covariates

to check

and

possible

for model

3: Uniquely

Assumption
tion.

For

e X,

X

every

Parameterized

but

Under

this

mension

In

than X.

some

cases,

is character

0

on

of

0 or any
of X.

the dimension

As

one-to-one
a

of 0,

function

generalization,

we

can

allow

to

a2

multivariate.

With

Example
also

a Categorical

encompasses

Treatment.

the propensity

The

scores

propensity

suggested

by

Imbens (2000) for a categorical treatment. Suppose that T =
{1,...,
?max}and we model Pf(TA |X) as a multinomial distri
?
bution with probability vector tt(X)
7Tmax(X)}.
{7Ti(X),...,
If for each X, k (X) is a probability vector without any addi
tional constraints, then 0f(X) = tt(X) is a tm?x-dimensional
parameter

that

corresponds

to the

set of

mechanism

assignment

our

under

necessary

variance

an ordinal

for
must

variance

residual

be

assumed.

framework,

general

the

increases

generally

Theory

even

a nonbinary

with

function,
not

does

on

depend

1: Propensity

the

is, given

of the actual

distribution

the covariates.
as a Balancing

Function

=

that

treatment;

the conditional

=

e(-\X)}

p{TA\X,

Score.

p{TA\e(.\X)}.

In practice, Result 1 can be checked, for example, by examining
the ?-statistics for the coefficient of TA in models that predict
each covariate while controlling for the estimated propensity
function. We use this diagnostic in Sections 3-5. We emphasize,
however, that diagnostics based solely on the t-statistics of a
do not detect all deviations

linear model
and
based

in some
on

cases

more

nonlinear

of

the

outcomes

ditionally

and

the

actual

treatment

example,

covariates)

required; see Section 3.2 and Appendix B.
We can now establish the key result, which
tential

(for

diagnostics

sophisticated

transformations

from independence,

states that the po
are

assignment

independent given the propensity

be

may

con

function.

regardless

be some function of X, but in this case Of (X) would usually be

function

score

ancing

p(TA\X)

Suppose that we
Example With a Continuous Treatment.
model the distribution of the treatment given a (p x 1) vec
where a2 is a
tor of covariates, X, as TA\X ? N(XT?,cr2)
scalar and ? is a (p x 1) vector. The propensity function,
is the Gaussian density function, }/r? (?, a2), and
e{-\0f(X)},
? XT
?. Given f, the propensity function is character
Of(X)
ized by the scalar, 0. Hence matching or subclassifying on the
or
propensity function can be easily accomplished by matching

treat

Under the analytical framework and assumptions given in
Sections 2.1 and 2.2, we derive theoretical results that closely
follow and extend those in of Rosenbaum and Rubin (1983b);
these results are verified in Appendix A. Throughout we as
sume that the propensity function including the parameters, i/r,
is known. Result 1 states that the propensity function is a bal

case

examples.

2004

September

a categorical

with

example

nonconstant

Large-Sample

Result

we write 6 in place of 0. To illustrate Assumption 3 and meth
ods based on the propensity function, we consider three simple

subclassifying

for

lower di

in which

is univariate,

Association,

of 0 f (X).

treatment

is typically of much

the

is not

allowing

propensity

e{-\0f(X)},

function

the propensity

assumption,

ized by the parameter 0, which

only

in the

constant

then

constraint

2.3

Func

on X

such that ef(-\X)
0 e 0,
depends
That
is, 0 uniquely represents
through Of(X).
which we may therefore write as e(- \0).
parameter,

to model

dimension

finite-dimensional

as

setup

but

treatment,

misspec

Propensity

a unique

exists

there

same

Statistical

ment, except that we model Jt(X) using an ordinal logistic
model (McCullagh and Neider 1989). In this case jt(X) is de
termined by the scalar XT ?, where ? is a (p x 1) parameter
?
= XT
vector; in the general framework f
?. Lu
? and Of(X)
et al. (2001) mentioned the possibility of using Gaussian linear

This

its parameterization.

regarding

assumption

the

regression

ification (Drake 1993); see also Section 5.
To simplify the representation of the propensity function and
and matching, we make the fol
to facilitate subclassification
lowing

of the American

Journal

856

imax propensity

Result 2: Strong Ignorability of Treatment Assignment Given
=
Function. p{Y(tp)\TA,
the Propensity
e(-\X)}
p{Y(tp)\
G
T.
?>(-|X)}foranytp
over the distribution of the
We can average p{Y(tp)\e(-\X)}
propensity function to obtain the distribution of primary inter
est, p{Y(tp)} as a function of tp. According to Result 2,

p{Y(tp)}

=

p{Y(tp)\TA

= tp, 0}p(0) dO,

(1)

j
where 0 = 0^(X)

uniquely

indexes the propensity

function.

scores

use nested logistic re
proposed by Imbens (2000). We might
or
amultinomial probit
in
Imbens
2000)
gression (as suggested
model (e.g., Imai and van Dyk 2004) to model the dependence
of n (X) on X; in either case, i/r represents the regression coef
ficients.

The propensity score
Example With an Ordinal Treatment.
for an ordinal treat
Rosenbaum
and
Joffe
(1999)
suggested by
ment is also a special case of the propensity function. We can

2.4

From Theory

to Practice

can approximate
the integration
We
Subclassification.
in (1) by subclassifying
similar values of 0. In particular, we
first model
and compute the estimate ^ of f, per
Pf(TA |X)
=
maximum
likelihood
(ML). We then compute 0
haps by
for each observation and subclassify observations with
0i(X)
the

same

or

of subclasses

similar

values

of 0

into

a moderate

of roughly equal size. Within

This content downloaded by the authorized user from 192.168.72.229 on Wed, 28 Nov 2012 09:59:46 AM
All use subject to JSTOR Terms and Conditions

number,

say

J,

each subclass, we

Imai and van Dyk: Generalizing

=

tp}, where 0 is an un
of the potential outcomes

parametrically model p(f){Y(tp)\TA
known parameter. The distributions
can

be

as a weighted

computed

857

Score

the Propensity

of

averages

Known Propensity Functions.
Even if the true propensity
function is known, adjusting for the estimated propensity func

p{Y(tp)}

=

be

rather

than

of

advantage

J
a)

in practice

appropriate

Imbens

(e.g.,

and

the

adjustment within

tice, additional

bias.

further

reduce

ing for

the covariates

of

coefficient

regression

For

on

Y(tp)

each subclass
some

example,

authors

tp.

In prac

to

is desirable
suggest

model

in the within-subclass

(e.g.,

tions

in our

models

we

In particular,

3-5.

and

simulations

over

compute

repeated

J

7

timated

then this procedure

each subclass,
of

estimate

the

effect.

causal

subclass

j.

Because

results

be

may

sensitive

in

results
we

In practice,

mate Wj by the relative proportion of the observations
into

esti

that fall

to the

num

and the choice of subclassification on 0, we
suggest conducting a sensitivity analysis, repeating the analysis
with different subclassification schemes.
ber of subclasses

compute

Coefficient Models.
0

separately

Under

in a number

of

subclassification,

subclasses.

This

we

strategy

it is inherently nonparametric; it avoids mod
on 0. Of course,
\TA?tp,0)
eling the dependence of p{Y(tp)
is robust because

other

nonparametric

are

strategies

also

possible.

One

particu

larly promising possibility was suggested by a referee. Rather
than fixing 0 in each of several subclasses, we can allow 0 to
vary smoothly as a function of 0 ; that is, by computing 0(0) us
ing a flexible

model,

such

as

penalized

regression

splines

(e.g.,

2003). In the context of linear regression, we can allow
the regression coefficients to vary with 0, in what is known
as a smooth coefficient model (DiNardo and Tobias 2001; Li,
Huang, Li, and Fu 2002; Yatchew 1998). We illustrate this strat
egy with a continuous treatment in Section 3.3 and with a bi

Wood

variate

treatment

systematic

in the dis

differences
of

would

nonetheless

in the

treatment

the

to 0

average
in any

present

par

for either the true or the estimated
for

systematic
but

treatment,
can

score

for

the

for

adjusting

only

account

es
ran

sample-specific

1992; Hill et al. 1999).
differences that covari

as ANCOVA,

such

methods,

between

relationships

are

to ana

used

lyze randomized experiments. But adjusting for the propensity
score rather than directly adjusting for the covariates has the
same

in randomized

advantage

vational

studies:

dimension

in randomized

allows

as matching

in Section

assignment

nonparamet

subclassification.
the

for

adjusting

esti

treatment

estimated

illustrate an application with

in obser

it has
for

and

experiments,
can improve

function

as

experiments
reduction

such

methods

propensity

ef

treatment

randomized

5.3.

3. EFFECTS OF SMOKING USING
A CONTINUOUS TREATMENT
3.1
As

a first

in Section

4.3.

and Previous

Data,

Background,
applied

we

example,

of smoking on annual medical
lawsuits

against

the

tobacco

Studies

estimate

the

expenditures.

recent

many

industry,

effect

average

Associated
studies

with
have

the effects of smoking on health and medical costs
Rubin
2000, 2001; Zeger, Wyant, Miller, and Samet
(see, e.g.,
references
2000;
therein). The lack of experimental data led
estimated

many

researchers

is confined
Smooth

random

dom differences
(Rubin and Thomas
It is to adjust for such sample-specific
adjustment

under

be

a

be

may

differences

are

but

the

propensity

be

random

accounts

and

can

1

= tp,
X} is the estimated model parameter
<j>j{Y(tp)\TA
in subclass j and the estimated causal effect is some function
of 0. If Wj is known and the estimate of the causal effect is
an unbiased

Such

score

where

unbiased within

stud

of the covariates and the

as a function

sampling

covariates

fects. We

(3)

there may

ticular sample. Adjusting
the

there

First,

the distribution

covariates

sample.

mated

0^07{W|TA=t^X}Wy,
=

the

ric adjustment
even
Thus,

in Sec

examples

of

observed

ate

adjust
Robins

and Rotnitzky 2001). We believe that this is generally a use
ful strategy for accounting for the within-subclass
variability
of 0, and thus we include available covariates when fitting the
within-subclass

propensity

observational

score

propensity

effects.

Second,

tribution

propensity

1997), more often they are summarized by the relevant
causal effect. This causal effect is generally a function of 0,
instance,

in both

score

two types of errors that can occur when

relationship between

Rubin
for

estimated

treatment

estimating

treatment.

sometimes

the

stood by identifying

where 0
is estimate of 0 in subclass j and Wj is the relative
of
subclass
j.
weight
how we can approximate the marginal
shows
(2)
Equation
distributions of the potential outcomes. Although these distrib
are

score

true propensity

the

on

literature

ies and randomized experiments (e.g., Rosenbaum
1987; Rubin
and Thomas 1992, 1996; Hill, Rubin, and Thomas 1999). The

-Y,p^{y(tp)\TA=tp}Wj,
7= 1

utions

is a large

there

Indeed,

advantageous.

the advantage of adjusting for the estimated

p{Y(tp)\TA=tp,0}p(0)dO
j

can

tion

the within-subclass

distributions with weights equal to the relative size of the sub
classes. Formally, we approximate (1) with

comparison
among

to use

smokers

the

causal

on

based

1999; Rubin 2001).
mate

scores.

propensity

Because

this method

to a binary treatment, the focus has been on the
of smokers and nonsmokers without distinguishing
how

much

they

smoke

effects

of

the

frequency

and

duration

Larsen

(e.g.,

In contrast, our proposed method

can esti
of

smok

ing.

We use the data that Johnson, Dominici, Griswold, and Zeger
(2003) extracted from the 1987 National Medical Expenditure
Survey (NMES). The advantages of the NMES are that it in
cludes detailed information about frequency and duration of
smoking, and that 1987 medical costs are verified by multi
ple interviews and additional data from clinicians and hospitals.
Our analysis includes the following subject-level covariates:
age at the times of the survey (19-94), age when the individ
ual started smoking, gender (male, female), race (white, black,
other),

marriage

status

(married,

widowed,

divorced,

This content downloaded by the authorized user from 192.168.72.229 on Wed, 28 Nov 2012 09:59:46 AM
All use subject to JSTOR Terms and Conditions

separated,

858

never

level

education

married),

high school graduate,
west,

South,

region

status

near

poverty

some

graduate,

(poor,

(Northeast, Mid
low

poor,

always/almost

income,

always).

As in the original study reported by Johnson et al. (2003),
we conduct a complete-case
analysis by discarding all individ
uals with nonresponse.
Johnson et al. (2003) noted that bet
ter accounting for the missing data using multiple
imputation
did not significantly affect their results. In general, complete
case analysis involving the propensity score produces biased
causal

inference

the

unless

are

data

missing

we

focus

on

the

analysis,

yielding

study did not directly

estimate

complete-case

a

The original

function,
of

smoking

on medical

the

Rather,

expenditure.

the effects
authors

of
es

first

timated the effects of smoking on certain diseases and then
examined how much those diseases increased medical costs. In
contrast, we directly estimate the effects of smoking on medical
We

expenditures.
two types of
cumulative

treatment

to how much
of

self-reported

and

the effects
explore
we use a measure
of

First,

to smoking

a measure

combines

smokers

variables.

exposure

ers according
proposed

on

focus

to differentiate

the

exposure

information

about

to

and

frequency

y

In this

section

we

use

on

to the overall

tions

we
Finally,
stant
treatment

treatment

the

we

the

actual

we

data,

(4)

variable.

conduct

the

In

effects.

this

treatment variables
lier. To
variable
treatment

assess
using

our methods,

the

in the NMES,
we

however,

known

functions

In particular,

we

various

variables.

use

we

simulation

collected

covariates

and

ear

of

the

follow

covariates

others

each

and

using

Rubin

(e.g.,

cator

1973, 1979; Rubin and Thomas 2000) and use an exponen
tial function to create models with varying degrees of non
linearity and nonadditivity. Specifically, we closely follow the
simulation studies described by Rubin and Thomas
(2000)
=
by constructing an additive model of the form Y? a? TA +
and a multiplicative model of the
ci (A.)
J2p=\ Xpexp(KpXip)
=
form, Yi a?TA
XpXip), where Y?9a?9 TA,
+c2(X)exp(??=1
and

Xip

are

the

response

the

variable,

treatment

the as

effect,

signed treatment, and the the pth covariate for unit /.
In both models the coefficient vector for covariates is repre
sented by X = (X\,...,
Xp), the constants c\ (X) and C2(X) de
termine
on

the relative

influence

of

the treatment

the response,
and each
component
?
ther + 1 or
1. In each
replication,

of k
every

and

the covariates

?
(/c,...,
component

Kp)
of

is ei
X

by regressing

covariates.

We

examine

three

the

outcome

simulated

variable

and

simulation

effect

two

under
treatment

variable

we

scenario,

Under

to be

set a/

con

scenarios,

effect.

the

same

the

for

effect

effect

this

we

to

the

let a? vary as a function
?
set ai =
(Xi
X)2/1,000,

of

smoking began and X is the sam

the

variable;

close

we

scenario,

In particular,

value

the

makes

scaling

in

used

the

treat

average

constant

treatment

scenario. We obtain 1,000 sets of simulated responses for each
of the 12 nonlinear models that correspond to the rows of Ta
ble 1 (see below in this section).
function method
First, we apply the propensity
using

ficients.

the outcome

generate

each of the

linear regression tomodel

variable

all

given

variable

of

changes

the

the distribution of the treat
X.

covariates,
the

among

Because

simulated

only

the
this

dataseis,

distribution is the same across the simulations and in the actual
data analysis described in Section 3.3. The estimated propen
sity function is uniquely determined by the linear predictor,
0 ? XJ?, where ? is the ML estimate of the regression coef

simulation

as described

of

is the age at which
of

Gaussian

studies to illustrate how subclassifying on the estimated propen
sity function can improve the statistical properties of estimated
causal

the

effect

covariates.

Study

analyze

conduct

treatment

the

response
Before

variance

treatment

where Xi

20
as

set of

cor

squared

is about 40%.

ment

log(packyear)

the

the

using

roughly equal to the variance of the observed outcome variable
in the dataset, the log transformation of positive medical expen
diture. This implies that the contribution of the nonlinear func

ment

3.2 A Simulation

functions

ple mean

In Section 4 we consider a bivariate treatment that assess
effects of both the duration and the frequency of smoking.

linearity

nonlinear

the

is defined as

x number of years smoked.

from

R2, calculated

variable

dura

number of cigarettes per day

=

2004

September

all individuals using the estimate from the direct Gaussian lin
ear regression model shown in Table 2 (see Sec. 3.3). In the

that

smoking

deviation

relation coefficient,

constant

they smoke. Johnson et al. (2003)

cumulative

tion of smoking. This variable, called packyear,

ypackyear

of

smok

among

Association,

degrees of nonlinearity: highly linear (R2 ^ .95), moderately
linear (R2 ^ .85), and moderately
nonlinear (R2 % .75). Ru
bin and Thomas (2000, p. 585) noted that detecting the degree
of nonlinearity corresponding to R2 % .85 is difficult in real
istic multivariate
settings. The constants c\(X) and C2(X) are
set such that the variance of the simulated outcome variable is

smokers.

9,073

measure

We

because

sample

Statistical

probability.

at

completely

random (D'Agostino
and Rubin 2000). Nonetheless,
our purpose is to illustrate the use of the propensity

of the American

drawn independently from a Gaussian distribution with mean 1
in the additive model and mean 0 in the multiplicative model;
the variance of the Gaussian distribution is specified so as to
achieve the desired degree of nonlinearity. Finally, each com
? 1
ponent of K is set to +1 or
independently and with equal

college,

income, high income), and seat belt usage (rarely, some

middle
times,

West),

(college

other), census

Journal

is

To

evaluate

covariate

logistic
and

on

the balance
the

treatment

of

linear and Gaussian

continuous

tion of continuous

covariates.

the

we

covariates,
TA?

variable,

linear regression
[We

use

the

regress

log(packyear),

log

for indi

transforma

covariates because

and each
\og(packyear)
covariate is necessarily uncorrelated given 0\ see App. B.] Fig
ure 1(a) shows a standard normal quantile plot of the /-statistics
(df = 9,071) for the coefficient of the treatment variable in each
regression. The lack of balance is evident in the magnitude of
the /-statistics; the treatment variable is highly correlated with
many of the covariates. Figure 1(b) is identical to the 1(a) ex
cept that we control for 0 in each regression. The figure shows
the substantial reduction in the /-statistics obtained by condi
tioning on the estimated propensity function, indicating that the
covariate balance is significantly improved. The quantile plots
in Figure 1 are constructed including the square of the two age
covariates. Including these variables improves the balance; if
they are not included, then the /-statistic for log(packyear) as a

This content downloaded by the authorized user from 192.168.72.229 on Wed, 28 Nov 2012 09:59:46 AM
All use subject to JSTOR Terms and Conditions

Imai and van Dyk: Generalizing

the Propensity

Score

859

(b)

(a)

i

~i

r

-2-1012

1. Standard

Figure
Controlling

Normal

for 6 and

normal quantiles

of t-Statistics

Plots

Quantile

standard

for the Coefficient

the Linear Predictor

fore,

(b) Controlling

the

resulting

estimated

score,

propensity

we

tions

all

covariates

to estimate

treatment

the

assess
and

the

of

subclassification

schemes,

we

use

then
the

3, 5,

on

to Direct

linear

treatment

efficient.

even

But

model

we

would

violated.

For

in practice,
to be

expect

in

linear
linear
nonlinear

Multiplicative

in our

example,

function

can

successfully

reduce

if the
sions;

are not

covariates
thus, we

the Estimated

Propensity

in the within-subclass

included

recommend

including

Function

the covariates.

Relative

Linear Regression
5 subclasses

MSE

Bias

67

20

82

10 subclasses

MSE

Bias

MSE

1 93
5-2

18
94

24

30

82
83-495
-12

-6

models

Highly
Moderately linear

linear

nonlinear

Moderately

treatment

52
80

26
26

69 75
24
912184
23

69

38

793788
43

16
17

26
24

29 16
26
304017
23

16

19

22
19

38
40

41
36 26
41
315120

22

31

4424
34
33

effect

models

Highly
Moderately linear
Moderately
Multiplicative

nonlinear

35
16 18

45

28

models

Highly
Moderately linear
Moderately

linear

nonlinear

linear

cases,

data

of
exam

bias

and

im

specification than direct linear regression. In this simulation, the
advantage of the propensity score method deteriorates markedly

Bias

67
69

these

the assumptions

models

Moderately
Moderately

addi

reduces bias. We

effect

Highly

Variable
Additive

less

indicates that subclassification

the propensity

3 subclasses

Constant
Additive

(i.e.,

appropriate

prove efficiency of a parametric model. It also indicates that the
propensity function method can be more robust to model mis

on

of Subclassification

the assump

ples in Sections 3.3 and 4.3, the treatment effect does not appear
to be constant. The simulation illustrates that subclassification

Table 1 compares the performance of subclassification on the
estimated propensity function with the direct Gaussian linear
regression of y on TA and X. In particular, we compute the
percent reduction in bias and mean squared error (MSE) under
times three subclassification
36 different settings (12 models
on the propensity function
subclassification
schemes). Overall,
the
regression estimate; it reduces bias
significantly improves

1. Pedormance

are

model

regression

generally

that

emphasize

10 subclasses.

Table

are

the simulation

average treatment effect by computing the
treatment effects. To
of
the within-subclass
average
sensitivity

(a) Without

Covariate,

It is not surprising that in cases when

the direct

methods

obtain the overall
weighted

Each

Predicting

tive models with a constant treatment effect), this model results
in more efficient estimates than subclassifying on the propen
sity function, which makes fewer model assumptions; robust

construct

We

effect.

of

2

Function.

Propensity

by 16-95%.

subclasses of roughly equal size. As suggested in Section 2.4,
within each subclass we fit the same Gaussian linear regression
using

in the Models

of log(packyear)

of the Estimated

predictor of the log of subject age is 6.33 even after controlling
for 0\ including the square terms reduces this ?-statistic to .40.
This is an example of a check of the propensity function as
suggested in Sections 2.2 and 2.3.
Using

1
normal quantiles

-2-10
standard

55

NOTE: This table shows the percent reduction in bias and MSE due to subclassification relative to direct linear regression. The covariates
and treatment variable are from the dataset of Johnson et al. (2003), and the results are based on 1,000 replications of the response variable
simulated under each of the 12models.

This content downloaded by the authorized user from 192.168.72.229 on Wed, 28 Nov 2012 09:59:46 AM
All use subject to JSTOR Terms and Conditions

regres

Journal

860

of the American

Statistical

Association,

2004

September

3.3 Data Analysis
We now turn to the observed response variable, self-reported
medical expenditure, denoted by Y. We use the same propen
sity function as that described in Section 3.2 and model Y
within each of 10 subclasses using the two-part model of
Duan, Manning, Morris, and Newhouse
(1983) for semicon
tinuous variables. In particular, within each subclass we first
model
the probability of spending some money on medical
=
care, Vx(Y > 0|7A,X),
given the treatment variable, TA
\og( packyear), and all covariates, X, using logistic regression.
We then model the conditional distribution of log(F), given
TA and X, for those individuals who reported positive medical
> 0, TA, X), using Gaussian linear re
expenditure, p(\og(Y)\Y
gression
2003).

(see also Olsen and Sch?fer 2001 ;Javaras and van Dyk

Using this two-part model, we estimate the effects of smok
ing on medical costs within each of the 10 subclasses. Finally,
we compute the weighted average of the 10 within-subclass
estimates to obtain the average causal effect; in each within
subclass analysis, we use the sampling weights provided in
the dataset. Using three subclasses produces similar results, as
given in Table 2. We also fit a smooth coefficient model by
letting the causal effect as well as an intercept vary smoothly
as a function of 0. In parallel with the aforementioned
two
we
use
the
additive
model
(Hastie and
part model,
generalized
Tibshirani 1990) with the binomial family and logistic link to
the probability of positive medical costs, and use the
model
Gaussian family and identity link tomodel the conditional dis
tribution of log(F). We fit these models using all of the co
variates with the R package mgcv developed by Simon Wood;
excluding the covariates in this model has little effect on the
fitted causal effects.
Table 2 presents the results from the methods based on
the propensity function as well as the results of the standard
linear and logistic regressions, both of which in
complete-case
clude all covariates. All methods agree that cumulative expo
sure to smoking, as measured by the packyear variable, has little
effect on the probability of spending some money on medical
care in 1987. In contrast, we find that smoking appears to in
crease medical expenditure among those who reported positive
medical cost. (As pointed out by a referee, this ignores the fact
that smoking can be fatal and potentially reduce medical ex
the two methods based on the propensity
penditure.) Moreover,

Table 2. Estimated

Effect
Causal
Average
on Medical
Costs

3 sub-

methods

10 sub-

coefficient

models

classes

classes

model

-.085
3.075

-.082
2.996

-.079
3.126

-.070
3.260

model

Logistic
regression
Coefficient
for TA
error
Standard

model
regression
causal
effect
Average
error
Standard

lines show
tical

two standard

lines

.044
.017

.048
.018

errors

division

From

the Smooth

Coefficient

above
into

and below

three

the estimate.

subclasses

ver

The

of equal
size.
the horizontal

The

represent
axis.
value ofe? are indicated
by short bars on
errors above and below
The gray bands correspond
the
to two standard
on the within-subclass
within-subclass
estimates
based
linear
Gaussian
regressions.

function yield a greater effect of smoking on medical expendi
ture than the standard linear regression analysis. In particular, if
packyear were to double, then we would expect annual medical
expenditure to increase by a factor of about 1.04.
Figure 2 illustrates an advantage of using the propensity
score methods in this example. The figure plots the estimated
causal effect from the smooth coefficient model as a function of
the estimated propensity function. The constant treatment effect
assumption of the standard regression models is not appropriate
here; the constant treatment effect model is rejected with ap
proximate p < .002 under the smooth coefficient model. (This
p value was computed with the mgcv package in R.) The two
propensity score methods presented in this section relax this
enables us to estimate the causal
assumption. Subclassification
effect separately within each subclass, whereas the smooth co
efficient model allows the causal effect to vary smoothly as a
function of 0. In this case, age is highly correlated with the as
signed treatment. Thus, roughly speaking, Figure 2 shows that
as age increases, the effect of \og(packyear)
on medical ex
also

penses

increases.

The Bivariate

.050
.017

NOTE: The logistic regression model presents the coefficient of the treatment variable for pre
dicting positive medical costs. The Gaussian regression model presents the estimated average
causal effects of log(packyear) on \og{medical expenditure) for individualswith positive medical
costs.

Treatment

Instead of combining frequency and duration into a single
measure, we can conduct an analysis with a bivariate treatment
composed of the duration of smoking (the log number of smok
ing months) and the frequency of smoking (the log number of
cigarettes per day).
4.2 A Simulation

Gaussian

.029
.017

Effect

observed

4.1
score

Causal

the causal
effect as a function of 6
represents
on the estimated
of log(packyears)
from the
and is based
coefficient
in Table 2. The dotted
smooth
coefficient
model
(Gaussian)
presented

of Increased

Smooth
Direct

2. Estimated
Figure
Model.
The solid curve

4. EFFECTS OF SMOKING USING
A BIVARIATETREATMENT

Smoking

Propensity

e

Study

Before analyzing the data using the bivariate treatment, we
conduct a simulation study using the same setup as in Sec
tion 3.2, except that the single treatment variable is replaced
by

the

sum

of

two

treatment

struct an additive model

variables.

In particular,

of the form Y? =
anT^

This content downloaded by the authorized user from 192.168.72.229 on Wed, 28 Nov 2012 09:59:46 AM
All use subject to JSTOR Terms and Conditions

we

con

+ #?2^2

"*"

Imai and van Dyk: Generalizing

the Propensity

861

Score

(a)

n-1-1-1-1-1-1-r
0.0

0.1

i-1-1-r

0.2

0.3

0.4

0.6

0.5

0.7

before subclassification

plot

Figure 3. Reduction
the absolute
value

average
variable

in Correlations

of the absolute
and

Between

of the correlations
value

the covariates,

the each

of the within-subclass

Variables

and a multiplicative model of the
^ptxP(KpXip)
+
+
c2(X) exp(J2p=\ XpXip), where
anTA
ai2TA
and
the the duration and the frequency of
TtA
T?A represent
smoking for individual i and an and a?2 are the correspond
ing treatment effects. As in Section 3.2, we simulate 1,000 sets
construct

for each of the 12 nonlinear models.
treatment

the variable

effect

to the variable treatment in Section
same manner

except

set a/1

To

equal

age

covariate.

two propensity functions, one function for
of smoking and one for the duration of smok

We first estimate
the frequency
ing.We model
Gaussian

the propensity functions using two independent
linear regression models and fit the models via ML

and the propensity functions summarized
?
?2 XT/?2, with ?x and ?2 representing
the

covariates

for

the

two models.

In addition

Propensity function
for frequency

Upper

by 6\ =XJ ?{ and
theML estimate of
to the

set of

co

third

Subclass I
duration:
.317 (.221)

third

-.223

frequency:

(.143)

ft = 324

between

third

duration:
frequency:

IV
.020 (.105)
.009 (.075)

n =1,162

Lower

Subclass VII
duration:
-.079
(.099)
.105 (.058)
frequency:

third

n =1,538

4. Within-Subclass

0.6

0.7

for (a) 3x 3 and (b) 4 x 4 Subclasses.
The panels
of the covariates
the
(horizontal
axis) against
indicate
the correlations
treatment
between
the duration

and

each

treatment

include

the

the

treatment

after

particular,
absolute

square

variable

and

terms

for

variables

and
on

subclassification
of

magnitude

than

the covariates.

the

two

variables

age

.1 for

all

the mean

variables

each

of

the

covariates.

In

function,

the

the propensity

within-subclass
one

except

is

correlation

of

the

variables,

age

whose correlation is reduced by 2/3.
We subclassify
the data into several subclasses based on
9\ and ?2. Each subclass contains units with a specific range
of both 0[ and 02. As Figure 4 illustrates, in the 3 x 3 table of
subclasses the first subclass contains units with 6\ and #2 lower
than their 33rd percentile, and the last subclass contains units
with both quantities above their 67th percentile. (In some cases,
classification
be

may
within

that are more

schemes
Next,

required.)
each

subclass

we

using

function for duration
Middle third

Subclass II
duration:
.075 (.092)
.125 (.075)

frequency:

Subclass
duration:

frequency:

-.011

than

complex

estimate

the

Gaussian

average

linear

Upper

a

simple

causal

regression.

grid
effects

Namely,

third

Subclass III
duration:
.016 (.078)
.093 (.067)
frequency:

n =1,160

Subclass
Middle

0.5

in both models to improve the balance given the two linear pre
dictors. Figure 3 shows the significant reduction in correlations

Propensity
Lower

we

vari?tes,

less

3.2 and construct a-l2 in the

the current

using

we

models,

0.4

the Covariates
variables

(vertical axis). The circles
the correlations
between
the frequency

represent

ci (A.)
J2p=\
form Yi =

of response variables

and

of the two treatment

correlations

the crosses

whereas

0.3

before subclassification

the Two Treatment

between

0.2

0.1

0.0

n =1,542

V

Subclass VI
(.092)

.123 (.076)
n = 9\0

Subclass VIII
duration:
-.178
(.096)
.016 (.072)
frequency:
n = 954

duration:

frequency:

-.182

(.100)

.208 (.080)
n = 952

Subclass XI
duration:
.018 (.138)
.026 (.106)
frequency:
n = 532

of the Causal
on Medical
Effects
of Smoking
a
Each
cell of the 3 x 3 table represents
Expenditure.
a particular
functions
for the two treatments.
The vertical and horizontal
lines that form
range of the propensity
are the 33rd and 67th percentiles
the subclasses
of the two propensity
functions.
The figures within each cell represent
the estimated
coefficients
from the within-subclass
Gaussian
linear regression
and the number
of within-subclass
errors are in parentheses,
standard
and
observations;
n represents
the subclass
sizes.
sample
Figure
subclass

within

which

units

Estimates

have

This content downloaded by the authorized user from 192.168.72.229 on Wed, 28 Nov 2012 09:59:46 AM
All use subject to JSTOR Terms and Conditions

Journal
3. Pedormanee

Table

of Subclassification
With

Compared
2x2

treatment
models

3x3

September

2004

Function

Propensity

4x4

subclasses

Duration

Frequency

72

53

subclasses

Duration

Frequency

87
74
81

96
97

86
1 82

22

21

linear
nonlinear

Frequency

43

92
82
87

92
88
30

80
77
98

24
29
38

86
72
75

3
54
21

77
22 77
2177

94
93
94

69
68
68

99
98
99

74
74
74

77
2277
2178

93
94
94

68
67
69

99
99
99

74
72
74

53

62
2466

models

Multiplicative

Highly linear

67

31

linear
nonlinear

Moderately
Moderately
Variable
Additive

Association,

effect

Highly linear
Moderately
Moderately

the Estimated

Statistical

Linear Regression

subclasses

Duration
Constant
Additive

on

of the American

treatment

18

effect

models

Highly linear
Moderately linear
Moderately nonlinear
models

Multiplicative

Highly linear
Moderately linear
Moderately nonlinear

NOTE:The figures show the percent reduction inbias due to subclassification on the estimated propensity function incomparison with linear regression.
The covariates and treatment variable are from the dataset of Johnson et al. (2003), and the results are based on 1,000 replications for each of the
36 simulations.

within
all

each

of

the

causal

we

subclass,
covariates.
as

effect

we

Finally,

the weighted

on

y

regress

a constant,

calculate
of

average

the

TA,

and

TA,

overall

average
es

the within-subclass

timates.

We

with

regress

the performance
of

that

Y on TA,

TA,

and

all

of the propensity
linear

Gaussian

regression,

covariates.

The

function
we

where

reduction

percent

case

often

4.3

Data Analysis

found

now

turn

in practice.

to the observed

variable.

response

each

subclass

using

the

same

two-part

model

as

use

We

same propensity functions as in Section 4.2 and model

the

Y within

in Section

3.3,

controlling for all covariates. We also fit the smooth coefficient
model by letting the effects of the two treatments be two sep
arate unknown smooth functions of both propensity functions.
As in Section 3.3, we use the generalized additive models with

Table 4. Estimated

Average

Causal

Effect

the

of

Duration
regression
Logistic
Coefficient
error
Standard
Gaussian
Coefficient
Standard

-.437
8.096

Frequency

.061
4.752

of

average

the within-subclass

the coefficients.

two

treatment

variables

no

have

significant

not.

does

smoking

For

an

example,

increase

-.010
.036

.078
.027

one

from

on

ciga

duration.

estimates of the causal
Figure 4 shows the within-subclass
effects under the 3 x 3 subclassification
scheme. The within
subclass standard errors are too large to distinguish the effects
the

among
efficient

subclasses.

model

allows

The

added

for more

structure
powerful

of

the

smooth

comparisons,

co
how

ever. Figure 5 illustrates contour plots of the treatment effects as

of Increased

Smoking
Functions

Duration

-.359
8.789

subclasses

on Medical

Expenditures

Smooth

Frequency

.026
5.470

Duration

-.419
7.654

coefficient
Frequency

.087
4.426

regression
error

impact

rette to one pack of cigarettes per day raises annual medical
expenditure by about 30%. The analysis of the bivariate treat
ments is more informative than the analysis in Section 3.3 in
that it demonstrates that the significant effect of packyear is at
tributable mostly to the frequency of smoking rather than to its

4x4

subclasses

of

the probability of spending some money on medical care. On
the other hand, they agree that the frequency of smoking in
creases medical expenditure significantly, whereas the duration

via the Two Propensity
3x3

the weighted

compute

Table 4 reports the results of the methods based on two
propensity functions. All methods indicate that among smok
ers,

in bias for 2 x 2, 3 x 3, and 4x4
subclassification schemes are
cases
In
in
all
considered
Table
3.
here, the biases for the
given
causal effect of duration are more than 70% smaller with the
propensity function method than with the standard linear re
gression adjustment. The gains offered by the propensity score
methods are especially large with variable treatment effects, the

We

we

nally,

estimates

compare

method

binomial family (logistic link) and Gaussian family (identity
link) and control for all the covariates as linear predictors. Fi

.027
.046

.068
.032

-.022
.088
.025.034

NOTE: The coefficients of two treatment variables, log(duration)and log(frequency), and their standard errors are reported.

This content downloaded by the authorized user from 192.168.72.229 on Wed, 28 Nov 2012 09:59:46 AM
All use subject to JSTOR Terms and Conditions

Imai and van Dyk: Generalizing

the Propensity

863

Score

(b)

(a)

1.5

2.0

Propensity
Figure

5. Estimated

Causal

Effects

2.5

3.0

function

of (a) Frequency

4.0

3.5

1.5

for duration
and

2.0

2.5

Propensity
From

(b) Duration

the Smooth

Coefficient

3-5

3.0

function

for

Model.

4.0

duration
The solid

curves

represent

the causal

effect as a function of the estimated propensity functions and are based on the estimated coefficients of log(frequency) and log(duration) from the
(Gaussian)
subclasses

smooth
used

coefficient

model

in the analysis

based

presented
on a3x

in Table

4. The points

3 subclassification

represent
see

scheme;

functions of the two propensity functions; we can reject the null
model of a constant treatment effect of duration with p < .04.
Our simulation results indicates that the propensity score meth
ods perform especially well relative to direct methods when the
treatment effect varies across the population. As with the analy
sis of the univariate treatment in Section 3.3, it is important to
remember the selection bias in the sample when interpreting
the causal effects; only smokers who survive are included in
the

sample.

5. EFFECTS OF SCHOOLINGON INCOME
5.1

Background

and Data

In this section we estimate the average causal effect of
the propensity
function
schooling on income by applying
an
vari
to
in
instruments
instrumental
balance
the
method
on
has
income
ables (IV) analysis. The effect of education
long
been an important topic in economics; researchers have quanti
fied the effect by comparing years of education and individual
in IV analyses (e.g., Angrist and Krueger 1991, 1992;
1995; Kling 2001). But the use of IV estimation in ob
servational studies is vulnerable to criticism concerning the va
lidity of the instrument (e.g., Bound, Jaeger, and Baker 1995).
Thus improving the performance of IV estimation has been a

wage
Card

focus of much recent literature (e.g., Angrist and Krueger 1995;
Staiger and Stock 1997; Angrist, Imbens, and Krueger 1999).
Here we show how the propensity function methods developed
in this article can potentially be used to improve IV estimation.
Angrist and Krueger (1995) used data collected from six
U.S. Current Population Surveys (CPSs) on men born between
1949 and 1953. Only the subsample of men born between 1949
to 1953 is publicly available, and we use this subsample in our
analysis. Wages and other information were recorded for one
of the years between 1979 and 1985 (excluding 1980); follow
ing the original article, we adjusted wages to 1978 dollars. The
dataset contains nine background variables: education in terms
of the highest grade completed (0-18), race (Black, Hispanic,
and others), year of birth (1949-1953), marital status (single
or married), veteran status (veteran or not a veteran), Vietnam
region of residence (9 regions),
lottery code (14 categories),

the observations,
4.

and

the gray

and white

areas

represent

the nine

Figure

and indicator variables for residence in a central city and em
statistical area. Following
ployment in a standard metropolitan
we
exclude those men who did not
Angrist and Krueger (1995),
work and/or recorded zero earnings as well as those who have
missing values for at least one variable. This yields a sample
size of 13,900 for our analysis.
5.2 Assumptions

and Previous

Analyses

Before we describe the IV analysis, we pause to consider an
analysis based directly on the propensity function, that is, an
analysis of the sort illustrated in Sections 3 and 4. In this case
we are interested in the effect of the treatment variable, highest
grade completed, on wages. The validity of the direct propen
2, that the
sity function analysis is predicated on Assumption
treatment and the potential outcomes are independent given the
the set of covariates
set of observed covariates. Unfortunately,
contains no measure of such important factors as underlying in
dividual intelligence or work ethic, both of which would seem
to affect the treatment and the potential outcomes. For example,
tend to
individuals who are intellectually gifted and motivated
attain higher levels of education and might be expected to earn
higher wages for any given level of education they might have
attained. Without controlling for a richer set of covariates (e.g.,
2 is unjustifiable. Our criticism of
Rouse 1995), Assumption
the ignorability assumption is substantive in nature; Rosenbaum
and Rubin (1983a) described a method for quantifying the sen
sitivity of results to Assumption 2.
Although an IV analysis requires certain other assumptions,
it does not require that the treatment assignment be ignorable.
Hence an IV analysis may be more appropriate here. To es
timate the causal effect of education on income, Angrist and
Krueger (1995) used two-stage least squares (TSLS), a type of
IV estimation. Specifically,
they assumed that
Yi=Xja0

+ Ti? + Viy+

i,

(5)

Ti=X[ai+Zj6i+Ui, (6)
and

Vi=Xja2

+ ZjS2 + w, (7)

where i= 1,..., n indexes individuals, Y? is log weekly wage,
X,- is a vector of covariates, 7} is the highest grade completed,

This content downloaded by the authorized user from 192.168.72.229 on Wed, 28 Nov 2012 09:59:46 AM
All use subject to JSTOR Terms and Conditions

is an

Vi

veteran

for

variable

indicator

status,

IVs that interact the assigned Vietnam
with

indicator

year-of-birth

resent

error

independent
of

effect

two

of

sists

on

education

terms.

the

First,

steps.

Here
The

wages.

?

and

6/,?;,

values,

m

the

represents

estimation

fitted

of

draft lottery code, ZA,
and

variables,

is a vector

Zz

rep
causal
con

procedure
and

7/

5.3

the least squares estimate of the average treatment effect, \, is

the

in constructing
level

education

form

veteran

whereas

IVs,

a bivariate

treatment.

To

status

balance

assign

and

(Angrist and Imbens 1995;
As Angrist and Krueger
Rubin
and
Imbens,
1996).
Angrist,
(1995) pointed out, the key here is that the assignment mecha
nism only for the lottery code (and not that for education level)
the treatment variables

through

needs to be strongly ignorable. They also argued, in reference
to requirement (b), that men with low draft lottery numbers,
who were likely to be drafted, had a strong incentive to stay
in school. Thus the key insight of the approach of Angrist and
Krueger (1995) is the use of the lottery code as an instrument.

the

Because
this

aged

men

there

are

as
to

assigned

domly

to go
two

was

code

lottery

scenario

a "natural

lottery

codes;
to

school

avoid

randomly

assigned,

experiment."

Men

some

of

the

draft.

variables:

"treatment"

the

these

we

encour

in a

Thus,

sense,
lot

assigned

tery code and the level of education. In this encouragement de
allows us to estimate the causal effect of
sign, IV methodology

the potential

of

levels

variable.

the education

out an IV analysis using the propensity
covariates
natural

across
experiment,

the

"treatment"

randomized

that

is, the

we

Thus,

variable

of

be

advantageous.

balances

assignment

the

co

the covariates

bring

each

regress

of

the

to exact

closer

is illustrated

in Figure 6
on

covariates

the

The

?-statistics

are

not

0,

because

the

is not

balance

Our goal is to improve the observed balance of the IV, ZA,
by first balancing the assigned lottery code, ZA. (Recall that
ZA represents the interaction terms of ZA with year-of-birth
indicator variable.) To do this, we condition on the estimated
function,

propensity

each

lottery

code

In particular,

p?(ZA\X).

to estimate

dinal logistic model
given

all of

the conditional

the available

we

an

use

or

of

probability

covariates

(see,

e.g.,

and Neider

1989). Given the estimated values of the
? XT
parameters, the scalar linear predictor, 6
?, completely
identifies the propensity function; ? takes the role of ^ in the
general framework. Figure 6(b) is identical to 6(a) except that
we control for the linear predictor, 0 = XT?, in each logistic re

McCullagh

The

?-statistics

resulting

are much

closer

to 0, because

is achieved by conditioning on 0.
Taking advantage of the improved balance, we subclassify
the sample on 0 into several subclasses of roughly equal size.
We then replicate the TSLS analysis of Angrist and Krueger
(1995) as specified in (5)-(7) within each subclass. Finally, we
obtain the estimate of the average treatment effect by computing

carry

function to balance

still

exact.

the level of education. But inference would be biased if lottery
codes were correlated with the potential outcomes (i.e, income)
or

can

sample. This
we

First,

example.

gression.

codes

randomly

this

can
ran

were

the Instrument

but by adjusting for the estimated

can

in the observed

variates.

[Veteran status is included in the treatment to help ensure that
requirement (c) ismet.]
view

2004

September

lottery code using logistic regression. (All covariates are indica
tor variables.) The 22 resulting ?-statistics (df = 13,898) appear
in a standard normal quantile plot in Figure 6(a). There is no
evidence that the lottery code is correlated with any of the co

a causal

interpretation to ?, the IVs must (a) be independent of both
the potential outcomes and potential treatment assignments
predictive of the treatment as
given X, (b) be monotonically
signment given X, and (c) affect only the outcome variable

treatment

we

function,

propensity

draft lottery code plays a

the Vietnam

Across

function

propensity
a randomized

variates only in expectation,

for

role

key

estimated

Briefly,

computed.

In this formulation,

Association,

Although the lottery code is randomly assigned and thus the
true propensity function,
is known and constant
pf(ZA\X),
as a function of X, as described in Section 2.4, adjusting for

ob

tained via the least squares fit of (6) and (7). Then 7/ and V?
in (5) are replaced with their fitted values from the first step and

Statistical

the Covariates

Balancing

the
are

V/,

of the American

Journal

864

the
the

instrument.

better balance

the weighted average of the within-subclass
estimates. Table 5
treatment
the
estimated
effects
of education,
average
displays
that is, the average effect of 1 additional year of education on
log weekly wage. Along with the results based on TSLS and
the propensity function, the table presents the estimates based
on the split-sample IV (SSIV) of Angrist and Krueger (1995).

(a)

_(b)_

(M -

y/

CO

/

B

/

b?
co ./'.

w

Ic

/

//

l^-1-1-1-r^
-2-10
standard
Normal Quantile
Figure 6. Standard
That (a) Do Not Control
for the Models

Plots
for and

normal quantiles

of t-Statistics

standard

for the Coefficient

(b) Do Control

for the Estimated

1
normal quantiles

of the Lottery Code Variable
Function.
Propensity

in the Models

2

Predicting

This content downloaded by the authorized user from 192.168.72.229 on Wed, 28 Nov 2012 09:59:46 AM
All use subject to JSTOR Terms and Conditions

Each

Covariate,

Imai and van Dyk: Generalizing
Table 5. Estimated

the Propensity
Treatment

Average

effect

on

of Education

Income

the

from

.063
.010

0 for TA.

function

=

p{TA\X,e(-\X)}

10 subclasses

.062
.015

of

sufficiency
the propensity

function

5 subclasses

.040
.037

.109
.034

865

Propensity

SSIV

TSLS
causal
error

Effect

models

Direct

Average
Standard

Score

the fact

Given

least

estimates.

squares

the

Balancing

errors

five

using

subclasses.

The

=

X.

of TA,

and Y(tp)

X,

is

1 to factor

Result

(A.2)

p{TA,X\e(-\X)}p{Y(tP)\TA,X,e(-\X)}.

and Assumption

the first

2

=

p{TA,X,Y(tp)\e(.\X)}

instruments

subclassification

|X)

p{TA,X,Y(tp)\e(-\X)}

Applying
of (A.2)

to rewrite

term

the

of

the

right-hand
term, we

second

p{TA\e(-\X)}p{X\e(-\X)}

side
have

p{Y(tp)\X,

two

terms of this expression
and integrat
and TA are independent.
<?(-|X), Y(tp),

the final

e(-\X)}.
Combining
ing over X, we find

using the estimated propensity function reduces the TSLS esti
mate, but it is still not as close to 0 as the SSIV estimate.
Table 6 reports the within-subclass
TSLS estimates and stan
dard

that

implies
p(T

the first equality follows

given

the joint distribution

e(-\X),

=
Angrist and Krueger used this estimator to overcome the finite
sample bias of TSLS. They noted that SSIV estimates tend to be
biased toward 0, whereas TSLS estimates tend to exhibit bias
the

is redundant

this

X,

because

Proof of Result 2

NOTE: The figures represent the average effect of a 1-year increase in the highest grade com
pleted on logweekly wage. (See Angrist and Krueger 1995 for a complete discussion of the
SSIV method.) Results forSSIV are based on 250 bootstrap samples.

toward

with

score,

where

p{TA\e(-\X)},

that e(-\X)

X

Replacing
is a balancing

that given

APPENDIX B: DIAGNOSTICSOF A LINEAR
REGRESSION PROPENSITY FUNCTION

standard

errors are smaller than those based on TSLS or SSIV.
If a linear

6. CONCLUDING REMARKS

ment

This article extends the propensity score of Rosenbaum and
Rubin (1983b) along with the generalizations
of Joffe and
Rosenbaum
(1999) and Imbens (2000) for application with
our

treatment

general

In particular,
regimes.
to estimate
causal
effects
by

researchers

allows

strategy
on

conditioning

propensity

a useful

such

the

analyzing

effects

Result

tool.

of

treatment

general

bias

is relatively
model

that

robust to model

results,

error

of

the

balance

resulting

of

covariates

of

after

predic
the
is balanced,

the model

specifi
in the following

XTT
each

set of covariates,
X =
(1, X\,...,
T is an n x 1 vector,
1 is an
T, where
is an n x 1 vector covariate
for each p. Let
rank

Xp
be the linear predictor

of T. The

is 0 given T, that is, the
Xp
is 0, where X = (1,
Xp, T).

the

identities

the result

follows

1TT =
from

1TT,

partial

second

correlation
of

component

into (X^r^T

=

XpT,
XjT
algebraic manipulations.

and TTT

=

TTT,

November

2002. Revised

January

2004.]

of Causal
Angrist, J. D., Imbens, G. W., and Rubin, D. B. (1996), "Identification
Effects Using Instrumental Variables"
Journal of the Amer
(with discussion),
ican Statistical Association,
91, 444^455.
J. D., and Krueger, A. B. (1991), "Does Compulsory
School Atten
Angrist,
dance Affect Schooling and Earnings?" Quarterly Journal of Economics,
106,
979-1014.

1

-

Attain
(1992), "The Effect of Age at School Entry on Educational
An Application
of Instrumental Variables With Moments
From Two
87, 328-336.
Samples," Journal of the American Statistical Association,
Instrumental Variables Estimates
of the Return
(1995), "Split-Sample
to Schooling,"
Journal of Business & Economic
Statistics,
13, 225-235.
Bound, J., Jaeger, D. A., and Baker, R. M. (1995), "Problems With Instrumental
Variables Estimation When
the Correlation Between
the Instruments and the
ment:

p{TA\e(-\X)}

=

in particular,

that^(-|X)
X = X.

.084 (.028)

Subclass

the definition

from

Table 6. Within-Subclass

I

p{TA\0(X)}

=

(A.l)

p(TA\X),

and for any X e X such that 0(X) = 0,
e(-\0),
The
in (A.l)
first equality
from As
follows

3; the second,

of Education

=

p(TA\0)
=

for 0 such

Subclass

is

J. D., and Imbens, G. W. (1995), "Two-Stage Least Squares Estima
Angrist,
tion of Average Causal Effects inModels With Variable Treatment Intensity,"
Journal of the American Statistical Association,
90, 431^442.
J. D., Imbens, G. W., and Krueger, A. B. (1999), "Jackknife Instru
Angrist,
mental Variables Estimation," Journal of Applied Econometrics,
14, 51-61.

con

have

sumption

variable
linear

REFERENCES

APPENDIX A: VERIFICATIONOF RESULTS 1AND 2
We

variable,

1 's, and

of

[Received

covariates.

Proof of Result

the

better

ditioning on the estimated propensity function, should always
be thoughtfully used. As with all methods based on covariate
adjustment, care must be taken to collect a sufficiently diverse
class

(XTX)~]

care must

however,

the

1 vector

T =

then

be taken when selecting the model form of the propensity func
tion and when computing the effect of the treatment conditional
on the propensity function. Model diagnostics, including the ex
amination

Xp)
n x

and use

reduction

Because

misspecification.

to better

lead

specifications

and

of
diagnostics
This
is formalized

Proof. If we substitute T = (XTX)_1XTT

Al

regimes.

our

suggest

given
covariate

as

function.

a full

3. Consider

(XTXr[XTT

can lead to biased results,

studies

that each

are not useful

a treatment

and

of T with

though severe model misspecification
simulation

covariate

is an indication

the propensity

for

each

result.

Subclassification on the propensity function can successfully
reduce bias and MSE relative to standard regression techniques
when

this

correlations

partial
cation

with

uncorrelated

necessarily
tor. Although

of the treat

a low

dimensional parameterization
of the the propensity function
rather than on typically high-dimensional
covariates. This for
mulation retains the powerful dimension reduction that makes
scores

is used to model
the dependence
regression
on a set of covariates,
then the treatment

variable

TSLS
on

Income
II

.063 (.035)

Estimates
for Each

Subclass

III

.020 (.028)

NOTE: Standard errors are given inparentheses.

of 0; and

the third,

of Average
Treatment
of Five Subclasses
Subclass

IV

.054 (.036)

from

Effect

Subclass

V

.090 (.036)

Endogenous
Explanatory Variable IsWeak," Journal of the American Statis
tical Association,
90,443-450.
and Ability Revisited," Research
in
Card, D. E. (1995), "Earnings, Schooling,
Labor Economics,
14, 23-48.
R. B., Jr., and Rubin, D. B. (2000), "Estimating and Using Propen
D'Agostino,
Statistical
sity Scores With Partially Missing Data," Journal of the American
Association,
95, 451, 749-759.
R. H., and Wahba,
S. (1999), "Causal Effects
in Nonexperimental
Dehejia,
Studies: Reevaluating
the Evaluation
of Training Programs," Journal of the
American
Statistical Association,
94, 1053-1062.

This content downloaded by the authorized user from 192.168.72.229 on Wed, 28 Nov 2012 09:59:46 AM
All use subject to JSTOR Terms and Conditions

Journal

866

and Regression
DiNardo,
J., and Tobias, J. L. (2001), "Nonparametric
Density
15, 11-28.
Estimation," Journal ofEconomic
Perspectives,
of the Propensity Score on Esti
Drake, C. (1993), "Effects of Misspecification
mators of Treatment Effect," Biometrics,
49, 1231-1236.
C. N., and Newhouse,
J. P. (1983),
Duan, N., Manning, W. G. J., Morris,
for the Demand
for Medical
of Alternative Models
"A Comparison
Care,"
Journal of Business & Economic
1, 115-126.
Statistics,
as an Explanatory Variable in
Efron, B., and Feldman, D. (1991), "Compliance
Journal of the American Statistical Associ
Clinical Trials" (with discussion),
ation,
Gerber,
Calls,
litical

86,9-17.
A. S., and Green, D. P. (2000), "The Effects of Canvassing,
Telephone
and Direct Mail on Voter Turnout: A Field Experiment," American Po
Science Review, 94, 653-663.
Additive Models, London:
Hastie, T. J., and Tibshirani, R. (1990), Generalized
Chapman & Hall.
J. J., Ichimura, H., and Todd, P. (1998), "Matching as an Econometric
Heckman,
Evaluation Estimator," Review of Economic
Studies, 65, 261-294.
Hill, J., Rubin, D. B., and Thomas, N. (1999), "The Design of the New York
in Research Designs:
In
School Choice Scholarship
Program Evaluation,"
ed. L. Bickman, Thousand Oaks, spired by the Work of Donald Campbell,
CA: Sage, pp. 155-180.
Hirano, K., Imbens, G., and Ridder, G. (2003), "Efficient Estimation of Average
Treatment Effects Using the Estimated Propensity Score," Econometrica,
71,
1307-1338.
Inference"
and Causal
P. W.
Holland,
(with discussion),
(1986), "Statistics
Journal of the American Statistical Association,
81, 945-960.
Calls Reduce Turnout? The Importance
Imai, K. (2004), "Do Get-Out-the-Vote
American Political Science Re for Field Experiments,"
of Statistical Methods
view, to appear.
of theMultinomial
Imai, K., and van Dyk, D. A. (2004), "A Bayesian Analysis
Journal of Econometrics, Probit Model Using Marginal Data Augmentation,"
to appear.
Score in Estimating Dose
Imbens, G. W. (2000), "The Role of the Propensity
87, 706-710.
Response Functions," Biometrika,
for
Imbens, G. W., and Rubin, D. B. (1997), "Estimating Outcome Distributions
Review of Economic
in Instrumental Variables Models,"
Studies,
Compilers
64, 555-574.
Javaras, K. N., and van Dyk, D. A. (2003), "Multiple Imputation for Incomplete
Journal of the American
Statistical
Data With Semicontinuous
Variables,"
Association,
98, 703-715.
P. R. (1999), "Propensity Scores," American
Joffe, M. M., and Rosenbaum,
Journal of Epidemiology,
150, 327-333.
F, Griswold, M., and Zeger, S. L. (2003), "Disease
Johnson, E., Dominici,
to Smoking: An Analysis
of
Costs Attributable
Cases and Their Medical
the National Medical
112,
Survey," Journal of Econometrics,
Expenditure
135-151.
of the Re
Kling, J. R. (2001), "Interpreting Instrumental Variables Estimates
turns to Schooling," Journal of Business &. Economic Statistics,
19, 358-364.
Larsen, M. D. (1999), "An Analysis of Survey Data on Smoking Using Propen
91-105.
Ser.
B, 61,
sity Scores," Sankhy?,
Effects of Continuous
Off
Lechner, M. (1999), "Earnings and Employment
Journal of Business &
the-Job Training in East Germany After Unification,"
Economic Statistics,
17, 74-90.
Smooth Co
Li, Q., Huang, C. J., Li, D., and Fu, T.-T (2002), "Semiparametric
Journal of Business & Economic
efficient Models,"
Statistics, 20, AX2-A22.
P. R. (2001), "Matching With
Lu, B., Zanutto, E., Hornik, R., and Rosenbaum,
Doses in an Observational
Study of aMedia Campaign Against Drug Abuse,"
Journal of the American Statistical Association,
96, 1245-1253.
Linear Models
P., and Neider, J. A. (1989), Generalized
(2nd ed.),
McCullagh,
London: Chapman & Hall.

of the American

Statistical

Association,

Olsen, M. K., and Schafer, J. L. (2001), "A Two-Part
for Semicontinuous
Data," Journal of
Longitudinal
Association,
96, 730-745.
Robins, J.M., and Rotnitzky, A. (2001), Comment on
metric Models:
and an Answer," by
Some Questions
Statistica S?nica, 11, 920-936.

September

2004

Model
Random-Effects
the American
Statistical
"Inference for Semipara
J. P. Bickel and J. Kwon,

J. M., Rotnitzky, A., and Zhao, L. P. (1995), "Analysis of Semipara
for Repeated Outcomes
in the Presence of Missing
Regression Models
Data," Journal of the American Statistical Association,
90, 106-121.
P. R. (1987), "Model-Based
Direct Adjustment,"
Journal of the
Rosenbaum,
American Statistical Association,
82, 387-394.
to an Un
P. R., and Rubin, D. B. (1983a), "Assessing Sensitivity
Rosenbaum,
observed Binary Covariate
in an Observational
Study With Binary Outcome,"

Robins,
metric

Journal

of the Royal Statistical Society, Ser B, 45, 212-218.
Score in Observational
(1983b), "The Central Role of the Propensity
Studies for Causal Effects," Biometrika,
70, 41-55.
Studies Using Subclassifica
(1984), "Reducing Bias in Observational
tion on the Propensity Score," Journal of the American Statistical Association,
79,516-524.

a Control Group Using Multivariate
Matched
(1985), "Constructing
That Incorporate the Propensity
Score," The American
Sampling Methods
Statistician,
39, 33-38.
or Diversion?
The Effect of Commu
Rouse, C. E. (1995), "Democratization
on Educational Attainment,"
Journal of Business & Economic
nity Colleges
Statistics,
13,217-224.
Rubin, D. B. (1973), "Matching
Biometrics,
29, 159-183.

to Remove

Bias

in Observational

Studies,"

Ad
and Regression
(1979), "Using Multivariate Matched
Sampling
Studies," Journal of the American
justment to Control Bias in Observational
Statistical Association,
74, 318-328.
on "Randomization
of Experimental
(1980), Comments
Analysis
Data: The Fisher Randomization
Test," by D. Basu, Journal of the American
Statistical Association,
75, 591-593.
on "On the Application
of Probability Theory to
(1990), Comments
Section 9," by J. Splawa
Agricultural
Essay on Principles.
Experiments.
and
translated from the Polish and edited by D. M. Dabrowska
Neyman,
T. P. Speed, Statistical Science, 5, 472-480.
Issues in the Estimation
of the Causal Effects of
(2000), "Statistical
Sci
Smoking Due to the Conduct of the Tobacco
Industry," in Statistical
ence in the Courtroom,
ed. J. L. Gastwirth,
New York: Springer-Verlag,
pp. 321-351.
inMedi
(2001), "Estimating the Causal Effect of Smoking," Statistics
1395-1414.
cine,^),
D. B., and Thomas, N. (1992), "Affinely Invariant Matching Methods
The Annals of Statistics, 20, 1079-1093.
Ellipsoidal Distributions,"
(1996), "Matching Using Estimated Propensity Scores: Relating The
52, 249-264.
ory to Practice," Biometrics,
Ad
(2000), "Combining Propensity Score Matching With Additional
for Prognostic
Statistical
Journal of the American
Covariates,"
justments
Association,
95, 573-585.
Staiger, D., and Stock, J. H. (1997), "Instrumental Variables Regression With

Rubin,
With

Weak Instruments," Econometrica,
65, 557-586.
S. (2003), "Thin Plate Regression
Wood,
Splines," Journal of the Royal Statis
tical Society, Ser. B, 65, 95-114.
in Economics,"
Yatchew, A. (1998), "Nonparametric
Regression
Techniques
Journal of Economic Literature, 36, 669-721.
on
Zeger, S., Wyant, T., Miller, L., and Samet, J. (2000), "Statistical Testimony
versus the Tobacco Industry" in Statistical Science in
inMinnesota
Damages
the Courtroom,
ed. J. L. Gastwirth, New York: Springer-Verlag,
pp. 303-320.

This content downloaded by the authorized user from 192.168.72.229 on Wed, 28 Nov 2012 09:59:46 AM
All use subject to JSTOR Terms and Conditions

