Journal of Business & Economic Statistics

ISSN: 0735-0015 (Print) 1537-2707 (Online) Journal homepage: https://www.tandfonline.com/loi/ubes20

The Finite Sample Performance of Estimators for
Mediation Analysis Under Sequential Conditional
Independence
Martin Huber, Michael Lechner & Giovanni Mellace
To cite this article: Martin Huber, Michael Lechner & Giovanni Mellace (2016) The Finite Sample
Performance of Estimators for Mediation Analysis Under Sequential Conditional Independence,
Journal of Business & Economic Statistics, 34:1, 139-160, DOI: 10.1080/07350015.2015.1017644
To link to this article: https://doi.org/10.1080/07350015.2015.1017644

Accepted author version posted online: 11
Mar 2015.
Published online: 20 Jan 2016.
Submit your article to this journal

Article views: 426

View Crossmark data

Citing articles: 2 View citing articles

Full Terms & Conditions of access and use can be found at
https://www.tandfonline.com/action/journalInformation?journalCode=ubes20

The Finite Sample Performance of Estimators for
Mediation Analysis Under Sequential
Conditional Independence
Martin HUBER
Department of Economics, University of Fribourg, Bd. de Pérolles 90, CH-1700 Fribourg, Switzerland
(martin.huber@unifr.ch)

Michael LECHNER
Swiss Institute for Empirical Economic Research, University of St. Gallen, Varnbüelstrasse 14, CH-9000,
St. Gallen, Switzerland (michael.lechner@unisg.ch)

Giovanni MELLACE
Department of Business and Economics, University of Southern Denmark, Campusvej 55, DK-5230
Odense M, Denmark (giome@sam.sdu.dk)
Using a comprehensive simulation study based on empirical data, this article investigates the finite sample
properties of different classes of parametric and semiparametric estimators of (natural) direct and indirect
causal effects used in mediation analysis under sequential conditional independence assumptions. The
estimators are based on regression, inverse probability weighting, and combinations thereof. Our simulation
design uses a large population of Swiss jobseekers and considers variations of several features of the datagenerating process (DGP) and the implementation of the estimators that are of practical relevance. We find
that no estimator performs uniformly best (in terms of root mean squared error) in all simulations. Overall,
so-called “g-computation” dominates. However, differences between estimators are often (but not always)
minor in the various setups and the relative performance of the methods often (but not always) varies with
the features of the DGP.
KEY WORDS: Causal channels; Causal mechanisms; Direct effects; Empirical Monte Carlo study;
Indirect effects; Simulation.

1.

INTRODUCTION

A vast empirical literature in statistical and social sciences is
concerned with the estimation of causal effects, both in randomized experiments and in observational studies. However, in many
studies not only the causal effect per se appears interesting, but
also the causal mechanisms through which it operates. Or, as
Gelman and Imbens (2013) argued, very often not only the effects of causes appear relevant, but also the causes of effects. For
example, when assessing the employment or earnings effects of
an active labor market program, policy makers might want to
know to which extent the total impact comes from increased
search effort, human capital, or other mediators that are themselves affected by the program. It is therefore no surprise that
the analysis of the causal mechanisms through which an initial
treatment variable affects an outcome of interest, also referred
to as mediation analysis, has become more relevant in empirical
work across disciplines such as economics, epidemiology, political science, and statistics. Identification requires controlling for
the potential endogeneity of the treatment and the intermediate
variables through which the causal mechanisms operate (i.e.,
through which the treatment ultimately affects the outcome of
interest), the so-called mediators. Under particular assumptions,
the (total) causal effect may then be disentangled in an indirect component related to one or several mediators and a direct

effect, which includes all remaining causal channels not covered
by the mediators of interest.
The majority of studies in mediation analysis assumes
that all potential confounders jointly affecting the treatment, the mediator, and the outcome (and thus potentially causing treatment and/or mediator endogeneity) are
observed (and are not a function of the treatment).1 This
amounts to assuming a sequential conditional independence
(or ignorability) assumption w.r.t. the mediator and the
treatment. It requires (i) that the potential outcomes and the
treatment are independent given the observed covariates, and
(ii) that the potential outcomes and the mediator are indepen-

© 2016 American Statistical Association
Journal of Business & Economic Statistics
January 2016, Vol. 34, No. 1
DOI: 10.1080/07350015.2015.1017644
Color versions of one or more of the figures in the article can be
found online at www.tandfonline.com/r/jbes.
1If

some confounders of the mediator are a function of the treatment, identification becomes more difficult; see for instance the discussion in Robins (2003),
Avin, Shpitser, and Pearl (2005), Albert and Nelson (2011), Imai and Yamamoto
(2013), and Huber (2014).

139

140

dent given the covariates and the treatment; see for instance Imai,
Keele, and Yamamoto (2010b) or the closely related assumptions in Pearl (2001) and Flores and Flores-Lagunes (2009).
Under this condition, various estimators of causal mechanisms
have been proposed that differ in terms of imposed functional
form assumptions. One popular approach is to estimate direct
and indirect effects by a system of linear equations characterizing the mediator (as function of the treatment and the covariates) and the outcome (as function of the mediator, treatment,
and the covariates). Consistency of the estimator requires that
both equations are correctly specified and thus linear, which appears ill-suited, for example, for binary mediators/outcomes. In
contrast, g-computation (suggested by Robins 1986, and considered in the context of direct and indirect effects, for instance,
in Zheng and van der Laan 2012) also allows for nonlinear
mediator and outcome models. It estimates the parameters of
interest by the sample analogs of the so-called mediation formula; see for instance Pearl (2001). The latter expresses direct
and indirect effects as functions of the conditional mean outcomes (given the mediator, the treatment, and the covariates)
and the conditional mediator densities (given the treatment and
the covariates), which are estimated by maximum likelihood
methods. Again, if either the conditional means or the conditional densities are incorrectly specified, g-computation is in
general inconsistent.
Several more flexible semiparametric methods have been suggested more recently. Huber (2014) used inverse probability
weighting (henceforth IPW; see the seminal paper by Horvitz
and Thompson (1952)) by treatment propensity scores (given the
mediator and the covariates or the covariates only, respectively)
to estimate causal mechanisms. Furthermore, “multiply robust”
estimators (the equivalent to doubly robust estimation in standard treatment effect models) have been proposed by Tchetgen
Tchetgen and Shpitser (2012) (based on the efficient influence
function) and Zheng and van der Laan (2012) (based on a targeted maximum likelihood approach). Although results about
the asymptotic behavior of most estimators are available, little
is known about their comparative performance in finite samples and their robustness to misspecification (which is almost
unavoidable in empirical applications) of model components.
The contribution of this article is to thoroughly assess the finite sample behavior of a range of common estimators of direct
and indirect effects under the assumption of sequential conditional independence.2 To this end, we apply a sophisticated
simulation design that is based on a large empirical dataset,
an approach also advocated in Huber, Lechner, and Wunsch
(2013) and named “Empirical Monte Carlo study” (EMCS)
therein. To be concise, we use linked jobseeker–caseworker
data from Switzerland, which allow disentangling the effect of
treatment “counseling style of caseworkers” (rigorous vs. cooperative style) on jobseekers’ employment into a direct effect and
an indirect effect running via assignment to active labor market
2While the finite sample performance of estimators of direct and indirect effects

appears underresearched up to date, several simulation studies compare various
parametric and semiparametric estimators of total (average) effects; see, for
instance, Frölich (2004), Lunceford and Davidian (2004), Zhao (2004), Huber,
Lechner, and Wunsch (2013), and Busso, DiNardo, and McCrary (in press a,b).
The latter two papers base the simulations (at least partly) on real-world data.

Journal of Business & Economic Statistics, January 2016

policies (see the companion paper Huber, Lechner, and Mellace,
2014, for an empirical evaluation). Basing the simulations on
empirical data is hopefully more closely related to real-world
applications than conventional Monte Carlo designs based on
completely artificial (and potentially arbitrary) data-generating
processes (DGPs).3 We vary several simulation parameters such
as sample size, effect heterogeneity, selection into the mediator, the share of individuals assigned to active labor market
policies (the mediator), and the type of outcome (binary and
nonbinary), which entails a large variety of models considered.
The estimators investigated include IPW (Huber 2014), “multiply robust” estimation (influence function-based estimation
of Tchetgen Tchetgen and Shpitser, 2012, and targeted maximum likelihood estimation (MLE) of Zheng and van der Laan
2012), estimation by a system of linear equations (see Baron
and Kenny 1986), g-computation, parametric estimation using
the “mediation” package for R by Tingley et al. (2014) (which is
consistent under the same assumptions as g-computation), and
a further flexible parametric approach based on regressions in
the subpopulations defined by the treatment state.
Our results do not point to a uniformly best performing estimator in all simulations in terms of the root mean squared
error (RMSE). Often (but not always), the differences between
particular estimators are minor and their relative performance
varies with the features of the DGP. For instance, g-computation
most frequently dominates the other methods (followed by targeted MLE) when estimating direct effects, but several estimators perform similarly well. With regard to the indirect effects,
flexible parametric regression always dominates in the nonbinary outcome case, but only under effect homogeneity when
the outcome is binary, while IPW and influence function-based
estimation are preferable under effect heterogeneity and binary
outcomes. We also investigate the performance of each method
when jointly estimating direct and indirect effects, based on the
norm of the joint RMSE matrix. For the nonbinary outcome,
g-computation and flexible parametric estimation dominate; for
the binary outcome, g-computation and influence-based estimation are slightly better than IPW and targeted MLE. Overall,
g-computation is the preferred method in our simulations.
The remainder of the article is organized as follows. The next
section describes the parameters of interest and the sequential
conditional independence (or ignorability) assumption required
3Recently

such a Monte Carlo approach has been criticized by Advani and
Sloczyński (2013), who compared the performance of various estimators in
the so-called LaLonde (1986) data with their performance in different Monte
Carlo designs. However, their paper suffers from several drawbacks: (a) The
experimental estimate in the LaLonde (1986) data is taken as the true effect. In
reality, however, it is only an unbiased estimate of the true effect. The ordering
of the estimators is therefore disturbed if some estimators are closer to the true
value than the experimental estimate (which is random). (b) The LaLonde data
are rather small. This implies (i) a noisy estimate of the estimated treatment
model used for the placebo simulations, and (ii) that the “population” to draw
from is rather small and generated samples may not reflect the statistical concept
of a “sample drawn from a infinite population” on which inference measures
are based upon. (c) The conditional independence of the treatment is most
likely not valid in the LaLonde data, given the limited number of observed
covariates. However, it is by construction valid in the simulated data of Advani
and Sloczyński (2013). Thus, the idea on which the EMCS is based, namely
that the selection and outcome processes in the true world and the EMCS data
are very similar, is likely violated for the selection process into treatment.

Huber, Lechner, and Mellace: Finite Sample Performance of Estimators for Mediation Analysis

141

Note that the average causal effect is the sum of the direct and
indirect effects defined upon opposite treatment states
 = E[Y (1, M(1)) − Y (0, M(0))]
= E[Y (1, M(0)) − Y (0, M(0))] + E[Y (1, M(1))
−Y (1, M(0))] = θ (0) + δ(1)

Figure 1. Graphical illustration of the mediation framework.

= E[Y (1, M(1)) − Y (0, M(1))] + E[Y (0, M(1))
for the consistency of the estimators. Section 3 discusses the
various classes of estimators considered in the simulations. Section 4 describes the empirical Monte Carlo design and the data
it is based upon. The main results are presented in Section 4,
while the further results and descriptive statistics are provided
in the Appendix. Section 5 concludes.

2.

PARAMETERS OF INTEREST AND IDENTIFYING
ASSUMPTIONS

Denote by D a binary intervention or treatment and by Y
the outcome variable of interest. Mediation analysis aims at
disentangling the causal effect of D on Y into a direct component and an indirect effect operating through some mediator
M, which may be discrete or continuous. Figure 1 provides a
graphical illustration of the evaluation framework considered
(where arrows represent causal effects from one variable to
another), however, omitting any confounders. To define the
parameters of interest, we use the potential outcome framework advocated by Rubin (1974) (among many others) and
considered in the direct and indirect effects framework for instance by Rubin (2004), Ten Have et al. (2007), and Albert
(2008). Let M(d), Y (d, M(d)) denote the potential mediator
state and the potential outcome under treatment d ∈ {0, 1}. For
each unit only one of the two potential mediator states and outcomes, respectively, is observed, because the realized outcome
and mediator values are M = D · M(1) + (1 − D) · M(0) and
Y = D · Y (1, M(1)) + (1 − D) · Y (0, M(0)).
The (total) average causal effect is given by  =
E[Y (1, M(1)) − Y (0, M(0))]. Exogenously varying the treatment but keeping the mediator fixed at its potential value for
some d ∈ {0, 1} gives the (average) direct effect:
θ (d) = E[Y (1, M(d)) − Y (0, M(d))],

d ∈ {0, 1}.

(1)

The (average) indirect effects is obtained by exogenously shifting the mediator to its potential values under treatment and
nontreatment but keeping the treatment fixed at d:4
δ(d) = E[Y (d, M(1)) − Y (d, M(0))],

d ∈ {0, 1}.

(2)

−Y (0, M(0))] = θ (1) + δ(0).

This follows from adding and subtracting E[Y (0, M(1))] after the second and E[Y (1, M(0))] after the fourth equalities.
Using the notation θ (1), θ (0) and δ(1), δ(0) points to potential
effect heterogeneity w.r.t. the treatment, that is, interaction effects between the treatment and the mediator. However, any
effect cannot be identified without further assumptions, because
either Y (1, M(1)) or Y (0, M(0)) is observed for any individual,
whereas Y (1, M(0)) and Y (0, M(1)) are never observed.
A good part of the literature based identification of direct and
indirect effects on a sequential conditional independence (or ignorability) assumption of the treatment and the mediator; see for
instance Imai, Keele, and Yamamoto (2010b), Tchetgen Tchetgen and Shpitser (2012), and Huber (2014). To this end, let X
denote a vector of observed covariates that potentially confound
the treatment and/or mediator effect(s) on the outcome.
Assumption 1 (conditional independence of the treatment).
{Y (d  , m), M(d)}⊥D|X = x for all d  , d ∈ {0, 1} and m, x in
the support of M, X.
Assumption 1 states that conditional on X, the treatment is
independent of the potential mediator states and the potential
outcomes, implying that there are no unobserved confounders
jointly affecting the treatment on the one hand and the mediator
and/or the outcome on the other hand given X. This is referred
to as conditional independence, selection on observables, or exogeneity in the treatment evaluation literature (see, for instance,
Imbens 2004).
Assumption 2 (conditional independence of the mediator).
Y (d  , m)⊥M|D = d, X = x for all d  , d ∈ {0, 1} and m, x in
the support of M, X.
Assumption 2 states that conditional on D and X, the mediator is independent of the potential outcomes. This implies that
there exist no unobserved confounders jointly causing the mediator and the outcome given the treatment and the covariates.
Assumption 2 would for instance be violated if unobserved pretreatment variables affected both M and Y directly, that is, not
only through D and X.
Assumption 3 (common support). Pr(D = d|M = m, X =
x) > 0 for all d ∈ {0, 1} and m, x in the support of M, X.
Assumption 3 is a common support restriction. The conditional probability to be treated given M, X, henceforth referred to as propensity score,5 must be larger than zero in either treatment state. This implies that Pr(D = d|X = x) > 0
5Rosenbaum

4Pearl

(2001) referred to these parameters as natural direct and indirect effects,
Robins and Greenland (1992) and Robins (2003) as total or pure direct and
indirect effects, and Flores and Flores-Lagunes (2009) as net and mechanism
average treatment effects, respectively.

(3)

and Rubin (1983) defined the propensity score as the probability of being treated conditional on pretreatment variables. Therefore, defining
Pr(D = 1|M, X) as “propensity score” is somewhat unconventional since we
also condition on posttreatment variables (i.e., the mediators). We thank an
anonymous referee for pointing this out.

142

Journal of Business & Economic Statistics, January 2016

must hold, too. By Bayes’ theorem, Assumption 3 also entails
Pr(M = m|D = d, X = x) > 0 or, in the case of a continuous
M, that the conditional density of M given D, X is larger than
zero: fM|D,X (m, d, x) > 0. In other words, conditional on X,
the mediator state must not be deterministically affected by the
treatment, otherwise comparable units in terms of mediator values across treatment states would not exist.

3.

ESTIMATORS

3.1 Overview

This section introduces the parametric and semiparametric
estimators of direct effects investigated in the simulations. The
parametric methods include estimation by a system of linear
equations (see Baron and Kenny 1986), a more flexible paraUnder these assumptions, the direct and indirect effects are metric approach based on regressions within each treatment
identified by the so-called mediation formulas, see for instance state, g-computation (suggested by Robins (1986), considered
Pearl (2001) and Imai, Keele, and Yamamoto (2010b), which in the context of direct/indirect effects for instance by Zheng and
represent the direct and indirect effects as functions of the con- van der Laan (2012)), and estimation based on simulating poditional mean of Y given D, M, X and the conditional density tential mediators and outcomes using the “mediation” package
for R by Tingley et al. (2014). Concerning semiparametric estiof M given D, X:
mation, we consider IPW (Huber 2014), and “multiply robust”

θ (d) = EX EM|D=d,X=x [E[Y |D = 1, M = m, X = x]
estimation based on the efficient influence function (Tchetgen
Tchetgen and Shpitser (2012); and targeted maximum likeli− E[Y |D = 0, M = m, X = x]|D = d, X = x]] , (4)
hood, Zheng and van der Laan (2012)) for assessing direct and

δ(d) = EX EM|D=1,X=x [E[Y |D = d, M = m, X = x]
indirect effects.
|D = 1, X = x]]

− EX EM|D=0,X=x [E[Y |D = d, M = m, X = x]
|D = 0, X = x]] .

3.2 Parametric Methods
(5)

Huber (2014) showed that the parameters of interest may alternatively be expressed as functions of the treatment propensity
scores Pr(D = 1|M, X) and Pr(D = d|X), which is useful for
estimation based on IPW.


Y (1 − D)
YD
−
θ (d) = E
Pr(D = 1|M, X) 1 − Pr(D = 1|M, X)

Pr(D = d|M, X)
×
,
(6)
Pr(D = d|X)


Y I {D = d}
Pr(D = 1|M, X)
δ(d) = E
Pr(D = d|M, X)
Pr(D = 1|X)

1 − Pr(D = 1|M, X)
.
(7)
−
1 − Pr(D = 1|X)
Note that the simulations focus on the estimation of θ (0) and
δ(1), while θ (1) and δ(0) are not considered. As the estimation
problems are symmetric, we would, however, expect that the
overall performance in estimating either θ (0), δ(1) or θ (1), δ(0)
is similar within a particular econometric method.
Albeit not required for nonparametric identification, a subset
of parametric estimators considered below is only consistent if
average treatment–mediator interaction effects on the outcome
are ruled out. This implies that average direct effects are homogeneous in the value of the mediator, as formally stated in
Assumption 4:
Assumption 4. E[Y (1, m)|X = x] − E[Y (0, m)|X = x] =
E[Y (1, m )|X = x] − E[Y (0, m )|X = x] for all m, m , x in the
support of M, X.
It follows that θ (1) = θ (0) = θ , because the direct effects are
identical under M(1) and M(0), and δ(1) = δ(0) = δ, because
δ =  − θ . We refer to Assumption 4 as “no interaction” in
the spirit of Robins (2003), who assumed no interaction effects
(between D and M) at the individual level, whereas we impose
this restriction at the population level conditional on X.

3.2.1 OLS Estimation of a System of Linear Equations.
Following Baron and Kenny (1986), most of the earlier studies
on mediation have estimated direct and indirect effects based
on linear equations characterizing the outcome and the mediator. When allowing for observed confounders, this amounts to
assuming the following models for the conditional expectations
of the outcome and the mediator:
E[Y |D, M, X] = α0 + αD D + αM M + X αX ,
E[M|D, X] = β0 + βD D + X βX ,

(8)
(9)

where α0 , αD , αM , αX denote the constant and the coefficients
on D, M, X in the outcome equation and β0 , βD , βX the constant
and the coefficients on D, X in the mediator equation. By its
parametric assumptions, this simple model does not allow for
interactions of D and M or X, D, and M and therefore implies
Assumption 4 (along with homogeneous θ , δ).
Throughout the discussion, we assume iid random sampling
from a large population and that all moments required for M and
Y exist and can be consistently estimated by sample analogs. Let
α̂D , α̂M , β̂D denote the OLS estimates of αD , αM , and βD , respectively. Then, the estimated direct effect, θ̂ , corresponds to
α̂D (the partial effect of D on Y after controlling for M, X)
while the indirect effect δ̂ corresponds to β̂D · α̂M , that is, the
first-stage effect of D on M times the second-stage effect of M
on Y. The drawback of this approach is its general inconsistency under nonlinear mediator or outcome models and/or in
the presence of interaction effects. Concerning the latter issue,
such models could, however, be easily made more flexible by
including interaction terms between M and D; see the discussion in Imai, Keele, and Yamamoto (2010b) and Imai, Keele,
and Tingley (2010a).
3.2.2 An Alternative, More Flexible Parametric Estimator.
As an alternative to using a system of linear equations, we also
consider a parametric approach that is somewhat more flexible in
terms of functional form assumptions because it estimates separate outcome models across treatment states. Specifically, the
conditional mean outcomes E[Y |D = 1, M = m, X = x] and

Huber, Lechner, and Mellace: Finite Sample Performance of Estimators for Mediation Analysis

E[Y |D = 0, M = m, X = x] are estimated by separate parametric regressions in the subpopulations with D = 1 and D = 0,
with μ̂Y (1, m, x), μ̂Y (0, m, x) denoting the respective estimates.
The estimated direct effect is obtained by their sample average
difference:
n
1
{μ̂Y (1, Mi , Xi ) − μ̂Y (0, Mi , Xi )} ,
(10)
θ̂ =
n i=1
where i denotes the index of an observation in an iid sample of
size n (i ∈ {1, . . . , n}).
In contrast to the linear model of Section 3.2.1, this approach
flexibly allows for interactions between D and X. However,
consistency requires the satisfaction of Assumption 4, so that
heterogeneity in average direct effects across mediator values
given X is ruled out. To see how assuming a constant average
direct effect across different m conditional on X permits consistent estimation of θ , note that the population analog of (10) is
EX,M {E[Y |D = 1, M = m, X = x]
− E[Y |D = 0, M = m, X = x]}

= EX EM|X=x [E[Y (1, m)|D = 1, M = m, X = x]
− E[Y (0, m)|D = 0, M = m, X = x]]}

= EX EM|X=x [E[Y (1, m)|D = 1, X = x]
− E[Y (0, m)|D = 0, X = x]]}

= EX EM|X=x [E[Y (1, m)|X = x] − E[Y (0, m)|X = x]]
= EX {E[Y (1, M)|X = x] − E[Y (0, M)|X = x]} = θ, (11)
where the first equality follows from the law of iterated expectations and the fact that E[Y |D = d, M = m, X = x] =
E[Y (d, m)|D = d, M = m, X = x], the second from Assumption 2, the third from Assumption 1, the fourth from the law of
iterated expectations, and the fifth from Assumption 4 and the
law of iterated expectations.
Concerning the indirect effect, one may first estimate the
total causal effect using estimates of E[Y |D = 1, X = x] and
E[Y |D = 0, X = x], which are denoted by φ̂Y (1, x), φ̂Y (0, x).
The latter come from separate parametric regressions in the
subpopulations with D = 1 and D = 0. The indirect effect is
then estimated as the difference between the total and the direct
effect:
n
1 
φ̂Y (1, Xi ) − φ̂Y (0, Xi ) − θ̂ .
(12)
δ̂ =
n i=1
In the simulations, we adapt the outcome specification to the
distribution of Y, using linear and probit models for the nonbinary and binary outcomes, respectively. Consistency relies
on the correct specification of the models and the absence of
treatment–mediator interactions.
3.2.3 g-Computation. In contrast to the previous two approaches, g-computation (going back to Robins 1986) allows for
arbitrary treatment–mediator interactions and estimates the mediation formulas in (4) and (5) based on MLE. Let μ̂Y (d, m, x),
fˆ(m|d, x) denote the estimates of the conditional mean outcome
E[Y |D = 1, M = m, X = x] and the conditional mediator density fM|D=d,X=x (m) (or conditional probability Pr(M = m|D =

143

d, X = x) if the mediator is discrete). The g-computation estimators of the direct and indirect effects are given by
1 
[μ̂Y (1, Mi , Xi ) − μ̂Y (0, Mi , Xi )] fˆ(Mi |d, Xi ) ,
n i=1
n

θ̂ (d) =

(13)
δ̂(d) =

1
n

n





μ̂Y (d, Mi , Xi ) fˆ(Mi |1, Xi ) − fˆ(Mi |0, Xi )

.

i=1

(14)

(see also Zheng and van der Laan 2012, sec. 4.2, for the direct
effect) In general, both the parametric models for E[Y |D =
1, M = m, X = x] and fM|D=d,X=x (m) need to be correctly
specified for consistency.
3.2.4 Estimation Based on Simulating Potential Mediators
and Outcomes. The estimation approach of Tingley et al.
(2014) as implemented in the “mediation” package for R is
based on (a) estimation of the mediator and outcome models
and (b) simulation of potential mediators and outcomes according to the estimated models to (c) estimate direct and indirect
effects. In particular, the idea is to simulate the potential outcomes Y (d, M(1 − d)), which can never be observed, but are
required for defining the direct and indirect effects in (1) and
(2). Among others, the “mediation” package offers the following bootstrap algorithm for effect estimation and inference (see
the description in Imai, Keele, and Tingley 2010a):
1. Draw a large number of bootstrap samples out of the original
data (the default of the package is 1000 bootstrap samples).
2. In each bootstrap sample: (i) fit models for the observed
outcomes and mediators; (ii) simulate the potential values of
the mediators according to the parameter estimates in (i) and
the mediator model; (iii) simulate the potential outcomes
given the simulated values of the mediator, the parameter
estimates in (i), and the outcome model; and (iv) estimate
the direct and indirect effects based on the simulated analogs
of (1) and (2).
3. Take averages of the estimates over all bootstrap samples
to obtain the estimated direct and indirect effects θ̂ , δ̂. and
confidence intervals.
Assuming, for instance, linear mediator and outcome models
with additive error terms, let μ̂Y (d, m, x) and μ̂M (d, x) denote estimates of E[Y |D = d, M = m, X = x], and E[M|D =
d, X = x], respectively.6 Furthermore, denote by Ỹi,k(b) (d, m),
M̃i,k(b) (d) the kth simulated potential outcome and mediator
(mimicking Y (d, m), M(d)) for observation i in bootstrap sample b under treatment and mediator values d, m. The simulated
potential mediators are obtained by
M̃i,k(b) (d) = μ̂M (d, Xi(b) ) + ˜i,k(b) ,

d ∈ {1, 0},

(15)

where Xi(b) denotes the covariate values of individual i in bootstrap sample b and ˜i,k(b) is the kth simulated error for this individual, drawn from the error distribution imposed by the parametric mediator model (e.g., standard normal). That is, k indexes
6This

example is only chosen for illustrative purposes. Note that the estimation approach of Tingley et al. (2014) also allows for nonlinear models with
nonadditive error terms.

144

Journal of Business & Economic Statistics, January 2016

a particular simulation replication of the potential mediator conditional on observation i and satisfies k ∈ {1, . . . , K}, with K
being the number of replications per observation. M̃i,k(b) (d) is
plugged into the outcome model and again, a simulated error
term ũi,k(b) is added to simulate the potential outcomes:

δ̂(1) =
−

n
i=1 Yi Di /p̂(Xi )
n
i=1 Di /p̂(Xi )
n
i=1 Yi Di (1 − ρ̂(Mi , Xi ))/[ρ̂(Mi , Xi )(1 − p̂(Xi )]
,
n
i=1 Di (1 − ρ̂(Mi , Xi ))/[ρ̂(Mi , Xi )(1 − p̂(Xi )]

Ỹi,k(b) (d  , M(d)) = μ̂Y (d  , M̃i,k(b) (d), Xi(b) ) + ũi,k(b) ,
d, d  ∈ {1, 0}.

(21)
(16)

The direct and indirect effects in bootstrap sample b, denoted
by θ̂b (d) and δ̂b (d), are obtained by averaging over simulations
and observations:
θ̂b (d) =

n
K
1   
Ỹi,k(b) (1, M(d)) − Ỹi,k(b) (0, M(d)) ,
nK i(b)=1 k(b)=1

(17)
δ̂b (d) =

n
K
1   
Ỹi,k(b) (d, M(1)) − Ỹi,k(b) (d, M(0)) .
nK i(b)=1 k(b)=1

(18)
Finally, the estimates of the direct and indirect effects are computed by averaging over the bootstrap samples, with B being the
number of bootstraps:
B
1 
θ̂ (d) =
θ̂b (d),
B b=1

B
1 
δ̂(d) =
δ̂b (d).
B b=1

(19)

In our simulations, we consider parametric models for the mediators and outcomes (in the same manner as for g-computation
introduced in Section 3.2.3).7 Consistency relies on the correct
specification of the mediator and outcome models, but does not
require Assumption 4 such that treatment–mediator interactions
are allowed for.
3.3 Semiparametric Methods
3.3.1 Inverse Probability Weighting. Huber (2014) suggested estimation based on IPW,8 using normalized versions of
the sample analogs of expressions (6) and (7), such that the
weights of the observations in either treatment state add up to
unity. For example, the estimators of the direct effects under
nontreatment and the indirect effect under treatment are given
by
n
i=1 Yi Di (1 − ρ̂(Mi , Xi ))/[ρ̂(Mi , Xi )(1 − p̂(Xi ))]
n
i=1 Di (1 − ρ̂(Mi , Xi ))/[ρ̂(Mi , Xi )(1 − p̂(Xi ))]

θ̂ (0) =

−

n
i=1 Yi (1 − Di )/(1 − p̂(Xi ))
,
n
i=1 (1 − Di )/(1 − p̂(Xi ))

(20)

where ρ̂(Mi , Xi ), p̂(Xi ) denote the respective estimates of
the propensity scores Pr(D = 1|Mi , Xi ), Pr(D = 1|Xi ) based
on probit specifications. These semiparametric IPW estimators (into which the propensity scores enter parametrically) can
be expressed as sequential GMM estimators where propensity
score estimation represents the first step and effect estimation
the second step
√ (see Newey 1984). It follows from these results
that IPW is n-consistent and asymptotically normal under
standard regularity conditions.9
3.3.2 Multiply Robust Estimation Based on the Efficient Influence Function. Tchetgen Tchetgen and Shpitser
(2012) suggested to base estimation on the sample analogue
of the efficient influence or score function (which is zero
in expectation) of the effect of interest. To this end, let
μ̂Y (d, m, x), fˆ(m|d, x), p̂(x), θ̂(d, x) denote estimates of
the conditional mean outcome E[Y |D = d, M = m, X = x],
the conditional mediator density fM|D=d,X=x (m) (or conditional probability if the mediator is discrete), the treatment
propensity score Pr(D = 1|X = x), and the conditional
direct effect (given X) θ (d, x) = EM|D=d,X=x [E[Y |D =
1, M = m, X = x] − E[Y |D = 0, M = m, X = x]|D = d,
X = x], which may for instance be obtained by regressing
μ̂Y (1, M, X) − μ̂Y (0, M, X) on X among those with D = d.
The direct effect under nontreatment is then for instance
estimated as

n
Di fˆ(Mi |0, Xi )
1
1 − Di
θ̂ (0) =
−
n i=1
p̂(Xi )fˆ(Mi |1, Xi ) 1 − p̂(Xi )
× [Yi − μ̂Y (Di , Mi , Xi )] +


× μ̂Y (1, Mi , Xi ) − μ̂Y (0, Mi , Xi ) − θ̂(0, Xi )

+ θ̂ (0, Xi ) .

point out that the method of Tingley et al. (2014) even allows for more
flexible specifications, namely generalized additive models.

8The idea of IPW goes back to Horvitz and Thompson (1952), who first proposed

an estimator of the population mean in the presence of nonrandomly missing
data.

(22)

As discussed by Zheng and van der Laan (2012), this estimator is (for instance in contrast to g-computation) “multiply
robust” in the sense that it remains consistent if only particular subsets of the model specifications are correct. Namely, it
needs to hold that at least either (i) E[Y |D, M, X] and θ (D, X),
(ii) E[Y |D, M, X] and Pr(D = 1|X), or (iii) Pr(D = 1|X) and
fM|D,X are correctly specified. If all three conditions hold,
9However,

7We

1 − Di
1 − p̂(Xi )

if the common support Assumption 3 is close to being violated,
estimation in finite samples may be unstable due to an explosion of the variance;
see for instance Khan and Tamer (2010) and Busso, DiNardo, and McCrary
(in press a,b). Furthermore, weighting may be less robust to propensity score
misspecification than other classes of estimators, as documented for instance in
Kang and Schafer (2007), Waernbaum (2012), and Huber, Lechner, and Wunsch
(2013).

Huber, Lechner, and Mellace: Finite Sample Performance of Estimators for Mediation Analysis

then multiply robust estimation reaches the semiparametric efficiency bound in the limit.
Let ψ(d, x) = EM|D=d,X=x [E[Y |D = 1, M = m, X = x]
|D = d, X = x] and ψ̂(d, x) denote its estimate. The indirect
effect is obtained by
δ̂(1) =

n
Di
fˆ(Mi |0, Xi )
1
Y − ψ̂(1, Xi ) −
n i=1 p̂(Xi )
fˆ(Mi |1, Xi )

Di fˆ(Mi |0,Xi )
1−D
with the predictor B̂(Di , Mi , Xi ) =[ p̂(X
− 1−p̂(Xi ) ] and γ̂1
ˆ
i
i )f (Mi |1,Xi )
being the coefficient estimate of B̂(D, M, X) when regressing μ̂Y (D, M, X) on B̂(D, M, X). Second, denote by
θ̂ ∗ (0, X) the estimate of the conditional direct effect under nontreatment using μ̂∗Y (1, M, X) − μ̂∗Y (0, M, X) (rather
than μ̂Y (1, M, X) − μ̂Y (0, M, X)), for instance by regressing
μ̂∗Y (1, M, X) − μ̂∗Y (0, M, X) on X among the nontreated. An
updated estimate of the conditional direct effect is obtained by

[Y − μ̂Y (1, Mi , Xi )]]
−

θ̂ ∗∗ (0, Xi ) = θ̂ ∗ (0, Xi ) + γ̂2 Ĉ(Di , Xi ),

1 − Di
[μ̂Y (1, Mi , Xi )] − ψ̂(0, Xi )]
1 − p̂(Xi )


+ ψ(1, Xi ) − ψ̂(0, Xi ) .

(23)

The estimator is consistent if either (i) E[Y |D, M, X] and
ψ(D, X), (ii) E[Y |D, M, X] and Pr(D = 1|X), or (iii) Pr(D =
1|X) and fM|D,X are correctly specified and asymptotically
semiparametrically efficient if all three conditions are satisfied.
It is worth mentioning that Tchetgen Tchetgen and Shpitser
(2012) (in their sec. 5) offered modifications to their original estimators that aim to improve stability when common support as
postulated in Assumption 3 is, at least in finite samples, (close to
being) violated. They also presented simulation evidence on the
merits of these modifications under a lack of common support
due to model misspecification. In our simulations, where serious
common support problems do not arise (see the minor differences between estimation with and without trimming influential
observations in Section 5), we only consider the original rather
than the modified estimators.
3.3.3 Multiply Robust Estimation Based on Targeted Maximum Likelihood. The final method considered is the targeted
maximum likelihood estimator (TMLE)10 of Zheng and van
der Laan (2012), which also possesses the “multiple robustness” property and asymptotically reaches the semiparametric
efficiency bound.11 For initial estimators of “ingredients” (conditional mean outcomes, mediator densities, treatment propensities) of the likelihood of the parameter of interest (direct or
indirect effects), it iteratively maximizes the likelihood along a
least favorable submodel through updating the initial estimators.
The parameter estimate is obtained by evaluating the parameter
map at the optimized estimator of the likelihood. For the direct
effect under nontreatment, TMLE relies on updated estimation
of μY (d, m, x) and θ (0, x), using further components of the efficient influence function as predictors for the updates. For ease of
exposition, we assume that both the conditional mean outcome
E[Y |D, M, X] and the conditional direct effect θ (0, X) are linear functions (even though the procedure can also be applied
to nonlinear models). Let μ̂Y (Di , Mi , Xi ) be the OLS estimate
of the conditional mean outcome for observation i. An updated
estimate is obtained by
μ̂∗Y (Di , Mi , Xi ) = μ̂Y (Di , Mi , Xi ) + γ̂1 B̂(Di , Mi , Xi ), (24)
10See

the seminal paper of van der Laan and Rubin (2006) for further details on
TMLE.

11We

145

are indebted to Mark van der Laan and Wen Zheng for providing us
with their R code of the estimator and giving helpful advice concerning its
implementation.

i
with the predictor Ĉ(Di , Xi ) =[ 1−1−D
p̂(Xi ) ] and γ̂2 being the coefficient estimate of Ĉ(D, X) when regressing θ̂ ∗ (0, X) on
Ĉ(D, X). Finally, the TMLE-based direct effect is estimated
as

1  ∗∗
θ̂ (0, Xi ).
n i=1
n

θ̂ (0) =

(25)

Estimation of the indirect effect again uses updated estimation of μ̂∗Y (Di , Mi , Xi ) as outlined (24), however now usˆ i |0,Xi )
Di
ing B̂(Di , Mi , Xi ) = [ p̂(X
(1 − ffˆ(M
)] as predictor. Fur(M |1,X )
i)
i

i

thermore, denote by ψ̂ ∗ (D, X) the estimate of ψ(D, X) using
μ̂∗Y (1, M, X) (rather than μ̂Y (1, M, X)). An updated estimate of
ψ̂ ∗ (Di , Xi ) is given by
ψ̂ ∗∗ (Di , Xi ) = ψ̂ ∗ (Di , Xi ) + γ̂2 Ĉ(Di , Xi ),

i −1
with Ĉ(Di , Xi ) = 2D
. Finally, the TMLE-based indirect efp̂(Xi )
fect is estimated as

1   ∗∗
ψ̂ (1, Xi ) − ψ̂ ∗∗ (0, Xi ) .
n i=1
n

δ̂(1) =

4.
4.1

(26)

MONTE CARLO DESIGN

Basic Idea of the Simulation Design

Similar to the approach advocated in Huber, Lechner, and
Wunsch (2013), we base our Monte Carlo simulations (at least
to a certain extent) on empirical data rather than on completely
artificial scenarios in which the DGP is entirely determined
by the researcher. In the latter case, the distributions of outcomes, mediators, and covariates as well as selection into the
treatment and the mediator often appear quite arbitrary. In our
EMCS, observed outcomes, mediators, and covariates (instead
of simulated ones) along with the empirically observed selection
processes are used with the hope to more closely mimic realworld applications. We nevertheless would like to vary some
key parameters in our EMCS approach, such as, for example,
the strength of selection into the mediator and the sample size,
to consider range of scenarios that are in the best case empirically relevant, albeit the generalizability of our results to other
real-world problems cannot be formally guaranteed. Furthermore, the data must be sufficiently large to be able to treat the
empirical data as the “population” (which is infinitely large in
conventional simulations with artificial DGPs).
We therefore base our EMCS on large-scale Swiss labor market data analyzed by Behncke, Frölich, and Lechner (2010a,
2010b) to estimate total treatment effects. Huber, Lechner, and

146

Mellace (2014) used this linked jobseeker–caseworker data for
the evaluation of causal mechanisms. Imposing a sequential conditional independence assumption, they disentangle the positive
effect of the treatment “counseling style of caseworkers” (rigorous vs. cooperative style) on jobseekers’ employment into a
direct effect and an indirect effect running via assignment to
active labor market policies (e.g., a training program).12 Our
EMCS is based on a very similar research question with a binary treatment/mediator and consists of three steps: First, we
estimate the selection processes into the treatment and the mediator in the data and use them as true propensity scores for the
simulations. Second, we repeatedly draw samples of observations with treatment and mediator equal to zero from the actual
data and simulate a (pseudo-)treatment and mediator for each
draw based on the empirically estimated selection processes. By
definition, the true direct and indirect effects are zero (as only
observations with zero treatment/mediator are considered) and
therefore homogeneous. To also consider heterogeneous effects
(with treatment–mediator interactions), we explicitly model the
outcome as a function of the treatment, mediator, and covariates (which comes at the cost of imposing more structure in the
simulations than in the case of homogeneous zero effects). In
addition, we vary further simulation parameters—as for instance
the sample size, the strength of selection into the mediator, or
the share of mediated observations—to obtain a rich set of different scenarios, all in all 128 DGPs. Third, we apply a range
of different estimators to each sample to evaluate their (relative)
performance (in terms of RMSE, bias, and variance) across and
within the simulation scenarios considered.
In the next subsections we present the details of how the
EMCS is implemented. We begin by describing the data sources
and the definition of the “population” on which all our simulations are based. We then define the outcomes, treatment, mediator, and the covariates and present descriptive statistics. Finally,
we describe the estimation of the “true” model underlying the
simulations and the implementation of the various parameters
that drive the properties of the DGPs considered.

Journal of Business & Economic Statistics, January 2016

including gender, mother tongue, qualification, information on
registration and deregistration of unemployment, employment
history, participation in active labor market programs, and an
employability rating by the caseworker. Regional (labor market
relevant) characteristics such as the cantonal unemployment rate
were matched to the individual information. Finally, these administrative data were linked to a caseworker survey based on a
written questionnaire that was sent to all caseworkers in Switzerland who were employed at an employment office in 2003 and
were still active in December 2004 at the time the questionnaire
was sent (see Behncke, Frölich, and Lechner 2010b, for further details). The questionnaire included questions about aims,
strategies, processes, and organization of the employment office and the caseworkers, among them the treatment variable on
caseworker cooperativeness.
The definition of the sample that serves as “population”
closely follows the sample selection criteria in Behncke, Frölich,
and Lechner (2010b) so that we refer to their paper for further
details. The only exception is that we exclude individuals who
were registered in the Italian-speaking part of Switzerland to reduce the number of language interaction terms to be included in
the model specifications. The final sample therefore consists of
93,076 unemployed persons (rather than 100,222 as in Behncke,
Frölich, and Lechner 2010b).
4.3 Treatment, Mediator, Outcomes, and Covariates

The data underlying our EMCS consist of individuals who
registered at Swiss regional employment offices anytime during
the year 2003, and have been previously considered in Behncke,
Frölich, and Lechner (2010b).13 Very detailed individual
information on the jobseekers is available from the databases of
the unemployment insurance system and social security records,

The caseworker questionnaire contains a question on how
important she considers cooperation with the client. As in the
main specification of Behncke, Frölich, and Lechner (2010b),
we define the treatment (D) to be one if the caseworker reports to
pursue a less cooperative strategy and zero otherwise. According
to this definition, 47%/43,669 observations (53%/49,407 observations) in our population are treated (not treated).14 Columns
1–4 in Table 1 report the means of selected observable characteristics across treatment states along with standardized biases
(SB) and stars indicating whether two-sample t-tests are significant at conventional levels of significance. We see that selection
into treatment is rather modest in our subsample of the Behncke,
Frölich, and Lechner (2010b) data.
The mediator (M) is defined in terms of the first participation
in an active labor market program (ALMP) within nine months
after the start of the unemployment spell. Possible ALMP states
in the data include job search training, personality course, language skill training, computer training, vocational training, employment program or internship, and nonparticipation in any

12The

14The

4.2 Data and Definition of the “Population”

motivation for the analysis in Huber, Lechner, and Mellace (2014) is
that the positive employment effect of less cooperative caseworkers found by
Behncke, Frölich, and Lechner (2010b) could be due to various causal mechanisms. Rigorous and cooperative caseworkers might for instance differ in the
assignment of active labor market programs or the imposition or threat of sanctions, among other dimensions of counseling. Therefore, Huber, Lechner, and
Mellace (2014) investigated whether the success of less cooperative case workers is driven by a more effective mix of active labor market programs (“indirect
effect”) or comes from any remaining counseling dimensions (“direct effect”),
possibly including (the threat of) sanctioning and pushing for accepting jobs.

13We deleted 102 individuals who registered with the employment office before

2003 but were nevertheless included in the sample of Behncke, Frölich, and
Lechner (2010b).

exact question was: “How important do you consider the cooperation
with the jobseeker, regarding placements in jobs and assignment of active labor market programs?” and could be answered according to a three-point scale
(very important, important, less important); see Behncke, Frölich, and Lechner
(2010b) for the exact formulation of the response options. It cannot be completely ruled out that due to the self-assessed nature of the treatment, being
cooperative or not could mean different things for different personality types
of caseworkers, albeit this issue should be mitigated by controlling for the
caseworker characteristics included in our analysis (see further below). Furthermore, note that the treatment is defined w.r.t. the cooperativeness of the first
caseworker a jobseeker is assigned to. As mentioned by Huber, Lechner, and
Mellace (2014), the same caseworker usually remains in charge of the jobseeker
for the entire spell of unemployment.

Huber, Lechner, and Mellace: Finite Sample Performance of Estimators for Mediation Analysis

147

Table 1. Difference in selected observables between treated and nontreated as well as mediated and nonmediated
Treatment status
Characteristics of the unemployed person
Female
Qualification: unskilled
Qualification: semiskilled
Qualification: skilled without degree
Qualification: skilled with degree
Employability rating: low
Employability rating: medium
Employability rating: high
Mother tongue other than German, French, Italian
Number of unemployment spells in last two years
Fraction of time employed in last two years
Noncooperative caseworker (D)

Mediator status

D=1

D=0

SB

M=1

M=0

SB

0.43
0.22
0.16
0.04
0.57
0.14
0.75
0.10
0.32
0.57
0.80
—

0.45
0.21
0.16
0.04
0.59
0.13
0.76
0.11
0.31
0.56
0.80
—

0.04
−0.04
0.00
−0.01
∗
0.04
−0.03
0.00
0.03
−0.02
−0.01
0.01
—

0.48
0.17
0.16
0.04
0.64
0.11
0.78
0.11
0.24
0.29
0.82
043

0.44
0.22
0.16
0.04
0.57
0.14
0.75
0.11
0.32
0.58
0.80
047

−0.08
∗∗∗
0.14
0.02
0.02
∗∗∗
−0.14
∗∗∗
0.08
∗∗∗
−0.05
−0.01
∗∗∗
0.19
∗∗∗
0.28
∗∗∗
−0.08
∗∗∗
008

∗∗∗

NOTE: SB stands for standardized bias. We use *,**,*** to indicate whether the p-value of a two sample t-test is smaller than 0.1, 0.05, and 0.01, respectively.

ALMP.15 In the simulations, the mediator is one if the first participation in the nine months window is either a computer course
or vocational training (7%/6601 observations) and zero otherwise (93%/86,475 observations). M is defined in this way to
distinguish between programs targeting relatively high-skilled
job seekers versus those for lower-skilled ones. The last three
columns in Table 1 provide the means of and test for differences in various observables across mediator states, this time
also including the treatment state. Job seekers with M = 1 have
on average significantly higher levels of qualification and employability, are more often female, are less likely to speak one
of the official languages in Switzerland as mother tongue, had
a lower number of unemployment spells and spent more time
in employment in the previous two years, and were less likely
assigned to a noncooperative caseworker than job seekers with
M = 0.
We consider two different outcomes (Y): a binary indicator
for employment in month 24 after the start of the unemployment spell and a nonbinary variable consisting of the cumulative
months an individual was a jobseeker between (and including)
month 10 and month 36 after start. The motivation for using
two distinct outcomes is that we would like to assess the performance of the various estimators for both dummy outcomes and
outcomes with a richer support. In month 24 about 55% of the
job seekers (50,725 observations) were employed. Figure A.1
in Appendix A.1 displays the distribution of the nonbinary outcome variable.
The covariates that we include as controls (X) have also
been used in Behncke, Frölich, and Lechner (2010b) and are
strong predictors of selection into the treatment and/or the mediator. A difference to Behncke, Frölich, and Lechner (2010b)
is, however, that no dummies or interaction terms for the Italianspeaking region are included, because the latter is not used in
our simulations. To predict the “true” selection models for the
treatment and the mediator (see Section 4.4), we all in all use
34 covariates: the constant, eight jobseeker characteristics (gen15We

refer to Gerfin and Lechner (2002) for a more detailed discussion of the
features of the various ALMPs in Switzerland.

der, qualification, labor market history, and employability—all
of which have been found to be relevant confounders in various empirical labor market studies; see, for instance, Lechner
and Wunsch 2013), 14 caseworker characteristics possibly related to both counseling style and usage of ALMPs (gender,
age, education, experience, organization of jobseeker allocation to caseworkers), the regional unemployment rate, a dummy
for French-speaking region, and nine interaction terms with the
French-speaking region. Table A.1 in Appendix A.1 provides
descriptive statistics for our covariates across treatment and mediator states.
4.4

Model, Simulation Parameters, and DGPs

To obtain the “true” models for treatment and mediator selection to be used in the simulations, we estimate probit specifications in which we regress (a) D on X and (b) M on D and
X in our “population.” The results of (a) and (b) are given in
Table A.2 in Appendix A.1. After that, all observations with
D = 1 and M = 1 (or both) are discarded and henceforth play
no role in the simulations, which leaves us with 45,644 observations. The next step is to draw independent Monte Carlo
samples with replacement from the “population” of nontreated
and nonmediated. We consider sample sizes (n) of 1000 √
and
4000 observations in our simulations. As all estimators are nconvergent, increasing sample sizes by a factor of four should
reduce the standard error by 50% (in large samples). Thus, our
choices of n facilitate checking whether the estimators already
attain this asymptotic convergence rate in finite samples.
Having drawn a particular Monte Carlo sample, the next step
consists of simulating the (pseudo-)treatment in this sample:
Di = I {Xi β̂pop + Ui > 0},
where I {A} is the indicator function, which is one if argument
A is satisfied and zero otherwise, β̂pop are the probit coefficient
estimates of the treatment model in the “population,” and Ui is
drawn from a standard normal distribution: Ui ∼ N (0, 1). This
entails a share of treated, which is on average roughly 45% in

148

Journal of Business & Economic Statistics, January 2016

Table 2. Pseudo-R2 for the DGPs in the nontreated/nonmediated
“population”
Selection
into mediator
Normal
Normal
Strong
Strong

Share of
M=1

Pseudo-R2 of probit
model for M

10%
50%
10%
50%

0.010
0.011
0.274
0.296

NOTE: The sample size is 45,644. The share of D = 1 is 0.453 and the pseudo-R2 of probit
model for D is 0.053 in all DGPs.

the simulations. Then, the (pseudo-)mediator is simulated by
Mi = I {λ(Di γ̂pop + Xi δ̂pop ) + α + Ui > 0},
where γ̂pop and δ̂pop are the probit coefficient estimates on D and
X of the mediator model in the “population’ and Vi ∼ N (0, 1).
Furthermore and in contrast to the treatment equation, λ allows
gauging the magnitude of selection into the mediator. In the
simulations, we consider λ = 1 (normal selection) and λ = 10
(strong selection). Finally, the additional constant α determines
the share of mediated individuals. We set α such that either
10% or 50% of the observations have a mediator equal to one.
Table 2 gives the pseudo-R2 of the mediator model16 for the four
different DGPs defined by selection into M (λ) and the share of
mediated (α), and—in the note underneath—the pseudo-R2 of
the treatment model.
Without further modifications of the outcome, the true direct
and indirect effects are homogeneous and equal to zero, as all
observations (even the pseudo-treated/mediated ones) are drawn
from the population neither treated nor mediated. To also consider heterogeneous effect with treatment–mediator interactions
or treatment–mediator–covariate interactions, we also consider
simulations in which we explicitly model the outcome as a function of D, M, X (with the caveat that the latter is arbitrary). In
the nonbinary outcome case,
Ỹi = g(Yi , Di , Mi , Xi ) = Yi + 0.6Di + 0.2Mi + 0.4Di Mi
− 0.3Di u2yrs2i − 0.2Mi u2yrs2i − 0.1Di Mi u2yrs3i ,
where Ỹi denotes the newly modeled outcome (while Yi is the
outcome initially observed) and u2yrsi is an element of Xi ,
namely the number of unemployment spells in the previous two
years (before the start of the unemployment spell in 2003). In
the binary outcome case,
Ỹi = I {g(Yi , Di , Mi , Xi ) > 0}.
The various combinations of the strength of selection into the
mediator, the share of mediated observations, binary or nonbinary outcomes, and homogeneous or heterogeneous effects
yield all in all 16 different DGPs.
use the Nagelkerke’s (see Nargelkerke 1991) pseudo-R2 , which is defined
as follows:
L
2/n
1 − ( intercept
Lfull )
pseudo-R2 =
2/n
1 − Lintercept

We investigate two further simulation parameters that concern
estimation rather than data generation. First, we either use all
of the confounders X included in the “true” treatment and mediator models in the various estimators or exclude several variables, namely the dummy for and all interactions with Frenchspeaking region as well as four of the dummies indicating how
jobseekers are assigned to caseworkers (by age, employability,
region, or other). The latter scenario implies that all estimators
are misspecified due to omitted variables. Second, we consider
estimation both with and without trimming observations that
receive a (too) “large” weight in some estimator. This problem
occurs, for instance, in IPW if the propensity scores of some
observations are that extreme that they heavily influence the estimate. In particular, a propensity score very close to zero that
enters the denominator in IPW may obtain a very large relative
weight in finite samples, if further observations with close to
zero propensity scores are rare or unavailable, which amounts
to a thin support problem.17
An econometric issue is that large weights may entail a large
variance of the estimator, as results might be quite sensitive to
the inclusion or exclusion of influential observations. Several
trimming procedures have therefore been proposed in the literature; see, for instance, Busso, DiNardo, and McCrary (in press
a) for a survey. Here, we use a trimming rule closely related to
that advocated in Huber, Lechner, and Wunsch (2013). Specifically, basing trimming on the IPW weights for the estimation
of direct and indirect effects, we require that observations in the
minuends and subtrahends of Equations (20) and (21) do not
exceed a particular relative weight (denoted by ω). Taking for
instance the minuend in (21), we discard any observation i that
does not satisfy
Di /p̂(Xi )
n
i=1 Di /p̂(Xi )

≤ ω,

with ω ∈ (0, 1]. In the simulations, we set ω = 0.05, so that the
relative weight of any observation must not exceed 5% in any
minuend or subtrahend.18 In contrast to other trimming methods
suggested in the literature, this does not introduce asymptotic
bias, as trimming vanishes in large samples if there is asymptotic common support, such that the estimation is asymptotically
unbiased. Note that we use this IPW-based trimming rule for all
estimators for the sake of comparability and ease of implementation (while a parallel use of different trimming procedures
would further complicate the analysis).
Combining the 16 DGPs with estimation using all or omitting
some covariates, with/without trimming, and the two different
sample sizes yields all in all 128 different scenarios. A final
parameter of the EMCS is the number of replications, which
is ideally as large as possible to minimize simulation noise.
The latter depends negatively on the number of replications and
positively on the variance of the estimators. Since the variance
is doubled when the sample size is reduced by half, and since

16We

where n is the sample size, and Lintercept and Lfull are the likelihood functions
of the model with the coefficients of all the variables (but the intercept) set to
zero and the full model, respectively.

17Note that the thin support problem vanishes asymptotically if common support

holds in the population, as postulated in Assumption 3. See Khan and Tamer
(2010) for the implications of asymptotic thin support problems, when common
support is close to being violated even in the population.
18After

discarding observations with too large weights, the remaining weights
are normalized again in the IPW estimator to add up to one.

Huber, Lechner, and Mellace: Finite Sample Performance of Estimators for Mediation Analysis

simulation noise is doubled when the number of replications is
reduced by half (at least for averages over the iid simulations),
we chose to make the number of replications proportional to the
sample size. We use 4000 replications for n = 1000 and 1000
for n = 4000, as the larger sample size is computationally more
expensive and has less variability of the results across different
simulation samples than the smaller one.
5.

RESULTS

5.1 Overview
In this section, we first discuss the implementation of the estimators introduced in Section 3 in terms of various modeling
options. After that, the results are presented, beginning with
simulation features that concern all estimators simultaneously,
namely DGP properties (effect homogeneity/heterogeneity,
strength of selection, share of mediated observations), estimation with all/omitting some covariates and with/without trimming, and sample size. In a next step, we analyze the impact
of different modeling options within particular classes of estimators. Finally, we compare estimators across different classes
for an overall assessment. Our conclusions mainly come from
analyzing the RMSE of the estimators. Appendix A.2 contains
further results concerning the absolute bias and the standard
deviation of the estimators, which helps understanding how the
RMSEs come about.
5.2 Implementation of Estimators
While Section 3 contains the general estimation approaches,
we present the details of the particular implementations of the
estimators in our EMCS hereafter. In OLS estimation based on a
system of linear equations, see Section 3.2.1, all variables enter
linearly as displayed in equations (8) and (9) and no modeling
options have to be considered. In contrast, for the more flexible parametric estimator with fewer functional form restrictions
(Section 3.2.2), g-computation (Section 3.2.3), and estimation
based on simulating potential mediators and outcomes (Section
3.2.4), we use different conditional outcome models depending on whether Y is binary or nonbinary. In the latter case, the
outcome equations are estimated based on linear models (with
Gaussian errors); in the former case, probit specifications are
used. For the estimators of Sections 3.2.3 and 3.2.4, the model
for the binary mediator is estimated by probit regression of M on
D and X. Furthermore, we vary the outcome models in terms of
treatment-mediator–covariate interactions. That is, we regress Y
on either (i) 1, D, M, and X or (ii) on 1, D, M, X, and interactions between D and M, D and X, M and X, and D, M, and
X. We therefore consider estimation based on both more parsimonious and more flexible outcome models in our simulations
when using g-computation or the method relying on simulating
potential mediators and outcomes.
Coming to the semiparametric estimators, IPW (Section
3.3.1) is implemented as outlined in Equations (20) and (21),
using probit specifications for the treatment propensity scores
(without any mediator–covariate interactions). Multiply robust
estimation using the efficient influence function (Section 3.3.2)

149

or TMLE (Section 3.3.3) is based on the same mediator and
outcome models (with both more parsimonious and more flexible outcome specifications) as g-computation and estimation
based on simulating potential mediators and outcomes. In total
we therefore consider 11 different estimators of each of the direct and indirect effects and binary/nonbinary outcomes: IPW,
two versions of each efficient influence function-based estimation, TMLE, g-computation, and simulation-based estimation,
and parametric estimation based on either a system of linear
equations or more flexible outcome regression within treatment
states.
5.3

Analysis Within Class of Estimators

Based on linear regressions, Tables 3 (nonbinary outcome)
and 4 (binary outcome) show how different features of the
DGPs and model choices affect the RMSEs of estimators
within four different classes of methods: IPW, multiply robust,
g-computation/simulation-based estimation, and OLS/flexible
parametric.19 Note that in the binary outcome case, the latter
has been multiplied by 100. The upper panels analyze the DGP
features that might affect various classes of estimators differentially: effect homogeneity (reference category) versus effect
heterogeneity, “normal” (reference category) versus “strong”
selection into the treatment, and a smaller (10%, reference category) versus a larger (50%) share of mediated observations. We
find that effect heterogeneity by and large increases the RMSE,
with the exception of some estimators of the indirect effect under the binary outcome. As Tables A.3–A.6 in Appendix A.2
show, effect heterogeneity entails a larger bias of any estimator,
whereas the influence on the estimators’ standard deviations is
less clear cut in several cases. Second, strong selection always
leads to an increase in the RMSE when estimating the indirect
effect, while the results are rather ambiguous for the direct effect (going in both directions under the nonbinary outcome and
being negative under the binary outcome).20 Finally, also the
direction of the impact of the share of mediated observations
varies over estimators, sample sizes, and types of outcomes.
Next, we consider two features relevant for estimation,
namely whether a correct specification or a model with missing variables is used, and whether observations with extreme
weights are trimmed. Concerning the latter, the results show
that trimming does generally not matter much for the RMSE.
This is likely a particularity of our data and the DGPs based
19The

regression-based analysis of various simulation parameters resembles
the idea of response surface analyses; see for instance the surveys of Hill and
Hunter (1966), Myers, Khuri, and Carter (1989), and Khuri and Mukhopadhyay
(2010). Note that if there were no interaction effects across the various simulation parameters, the constant terms in the regressions would correspond to the
average RMSEs of the reference estimators in the various classes of estimators
(i.e., those methods not represented by any dummy variable), when switching
off all other parameter dummies for effect heterogeneity, strong selection, 50%
mediated, misspecification, and trimming.

20A

more thorough investigation revealed that the negative impact of strong
selection on the RMSE of direct effect estimation under the binary outcome is
almost exclusively driven by the simulations with effect heterogeneity. In this
context, it needs to be pointed out that results for the binary outcome under
effect heterogeneity appear to be plagued by outliers.

150

Journal of Business & Economic Statistics, January 2016

Table 3. OLS analysis of determinants of RMSE for the nonbinary outcome
Direct effect
IPW
Estimator
Sample size

mult.robust

g-comp, simulation

OLS, flex. para

1000

4000

1000

4000

1000

4000

1000

4000

Constant
Effect heterogeneity
Strong selection
50% mediated
Misspecification
Trimming
TMLE/g-comp. parsimon.
TMLE/g-comp. flexible
DR/simulation parsimon.
OLS flexible
Number of observations
Adjusted R2

0.492
0.014
−0.003
0.005
−0.001
−0.001

0.241
0.014
−0.010
0.006
0.013
−0.001

0.683
0.013
0.124
−0.126
−0.091
0.000
−0.147
0.000
−0.147

0.245
0.013
−0.011
0.004
0.010
−0.001
−0.001
0.000
−0.001

0.609
0.022
0.072
−0.073
−0.053
−0.013
−0.096
0.014
−0.086

0.274
0.012
−0.010
0.002
0.006
−0.011
−0.024
−0.022
−0.000

0.558
0.043
0.018
0.095
0.001
−0.001

0.264
0.069
0.039
0.080
0.020
−0.001

32
0.491

32
0.612

128
128
0.299
0.587
Indirect effect

128
0.257

128
0.598

−0.145
64
0.618

−0.116
64
0.428

Constant
Effect heterogeneity
Strong selection
50% mediated
Misspecification
Trimming
TMLE/g-comp. parsimon.
TMLE/g-comp. flexible
DR/simulation parsimon.
OLS flexible
Adjusted R2

0.027
0.002
0.059
0.001
−0.002
0.001

0.004
0.002
0.034
0.000
0.004
0.004

0.313
0.005
0.207
−0.156
−0.098
0.003
−0.209
0.004
−0.235

0.023
0.006
0.041
−0.002
0.010
0.003
−0.012
−0.003
−0.025

0.126
0.003
0.089
−0.045
−0.025
0.002
−0.086
−0.024
−0.082

0.015
0.005
0.034
−0.000
0.008
0.002
−0.013
−0.013
−0.010

0.025
0.006
0.049
0.010
−0.003
0.001

0.003
0.007
0.034
0.005
0.003
0.005

0.966

0.871

0.427

0.770

0.504

0.841

−0.018
0.847

−0.011
0.678

NOTE: “TMLE/g-comp.” refers to TMLE in the case of “mult.robust” and to g-computation in the case of “g-comp, simulation.” “DR/simulation” refers to doubly robust estimation in
the case of “mult.robust” and to simulation-based estimation in the case of “g-comp, simulation.”

thereon, which obviously do not entail too influential observations, rather than a general property of the estimators. With
regard to misspecification, we expect a variance-bias trade-off,
as the (potentially more biased) misspecified models are more
parsimonious and may be estimated more precisely. This is by
and large confirmed when looking at the respective tables in
Appendix A.2: it appears that the two opposing effects cancel
each other out to a substantial extent in most cases.
Finally, for several estimators we consider more and less
flexible outcome models, which again entail finite sample biasvariance trade-offs. When looking at multiply robust estimation
(mult.robust), a clear finding is that using the parsimonious outcome model decreases the RMSE for both influence functionbased estimation and TMLE. Note that influence function-based
estimation using the flexible model is the reference category in
this comparison. Another striking result is that under the binary
outcome, TMLE with a flexible outcome model performs much
worse than any other method, which is driven by outliers in some
of the simulation draws. Also for g-computation (g-comp) and
simulation-based estimation (simulation), the parsimonious outcome model entails a smaller RMSE than the flexible one. When
comparing OLS and flexible parametric estimation, however,
the opposite holds true, with the latter always outperforming the
former, more rigid specification.

5.4 Comparisons Across Classes of Estimators
We subsequently compare the best performing estimators of each estimator class (IPW, multiply robust, gcomputation/simulation-based estimation, OLS/flexible parametric) with each other based on their RMSEs, both overall
and across different simulation features. For instance, among
the estimators based on g-computation/simulation-based estimation, we only include g-computation with the parsimonious
outcome model, which always weakly dominates the other estimators in this class; see Tables 3 and 4. For the same reason,
we also consider flexible parametric estimation, which clearly
outperforms OLS. Among the multiply robust methods, we for
the nonbinary outcome use TMLE based on the parsimonious
outcome model, which very slightly but consistently dominates (parsimonious) influence function-based estimation (even
though the differences in the various scenarios are minor). For
the binary outcome, however, we include (parsimonious) influence function-based estimation, which very clearly outperforms
TMLE.
Tables 5 and 6 present the results for the four respective estimators of direct and indirect effects. The first column (rel.rmse)
provides the relative difference/increase in the RMSE in percent
of a particular method when compared to the best performing

Huber, Lechner, and Mellace: Finite Sample Performance of Estimators for Mediation Analysis

151

Table 4. OLS analysis of determinants of RMSE for the binary outcome
Direct effect
IPW
Estimator
Sample size

mult.robust

g-comp, simulation

OLS, flex. para

1000

4000

1000

4000

1000

4000

1000

4000

Constant
Effect heterogeneity
Strong selection
50% mediated
Misspecification
Trimming
TMLE/g-comp. parsimon.
TMLE/g-comp. flexible
DR/simulation parsimon.
OLS flexible
Number of observations
Adjusted R2

3.972
0.120
−0.478
−1.050
−0.065
0.028

2.403
1.049
−0.611
−1.168
0.057
0.008

−4.009
16.367
−1.296
−0.771
0.672
−0.103
−0.209
32.749
−0.209

0.128
9.375
−1.712
−0.450
−3.337
−0.019
−0.008
16.736
−0.008

4.421
0.137
−0.468
−1.126
−0.073
−0.058
−0.429
−0.253
−0.310

2.615
1.057
−0.611
−1.227
−0.072
0.017
−0.092
−0.106
−0.071

4.250
3.515
−0.196
2.813
0.037
−0.092

2.433
4.602
−0.269
2.711
−0.027
−0.000

32
0.258

32
0.394

128
128
0.537
0.458
Indirect effect

128
0.338

128
0.454

−3.978
64
0.386

−3.824
64
0.435

Constant
Effect heterogeneity
Strong selection
50% mediated
Misspecification
Trimming
TMLE/g-comp. parsimon.
TMLE/g-comp. flexible
DR/simulation parsimon.
OLS flexible
Adjusted R2

0.210
−0.190
0.264
0.045
−0.012
0.019

0.052
−0.067
0.160
0.042
0.002
0.006

0.585
0.240
0.513
−0.004
−0.165
0.051
−0.195
0.657
−0.627

−0.109
0.252
0.349
0.116
0.031
0.007
0.175
0.375
−0.147

0.471
−0.143
0.294
0.031
−0.036
0.023
−0.249
−0.279
−0.214

0.025
0.015
0.228
0.071
0.016
−0.002
0.016
−0.078
0.030

−0.027
1.398
0.713
0.150
−0.102
0.079

−0.350
1.029
0.724
0.419
0.194
0.002

0.796

0.812

0.620

0.513

0.717

0.478

−0.196
0.815

−0.367
0.608

NOTE: The binary outcome has been multiplied by 100. “TMLE/g-comp.” refers to TMLE in the case of “mult.robust” and to g-computation in the case of “g-comp, simulation.”
“DR/simulation” refers to doubly robust estimation in the case of “mult.robust” and to simulation-based estimation in the case of “g-comp, simulation.”

Table 5. Relative and absolute RMSEs across simulation features, nonbinary outcome
All scenarios

No trimming

homog. effects

∗

heterog. effects

∗

∗

n = 1000

∗

n = 4000

Direct effect

r.rmse

rmse

r.rmse

rmse

r.rmse

rmse

r.rmse

rmse

r.rmse

rmse

r.rmse

rmse

IPW
TMLE pars.
g-comp. pars.
flex. parametric
Indirect effect

1.42
1.06
0
0.3
r.rmse

0.37
0.37
0.37
0.37
rmse

1.42
1.05
0
0.37
r.rmse

0.38
0.37
0.37
0.37
rmse

1.21
0.91
0
0.19
r.rmse

0.37
0.37
0.36
0.36
rmse

1.62
1.18
0
0.54
r.rmse

0.38
0.38
0.38
0.38
rmse

1.51
1.21
0
0.13
r.rmse

0.5
0.5
0.49
0.49
rmse

1.24
0.74
0
0.84
r.rmse

0.25
0.25
0.25
0.25
rmse

IPW
influence pars.
g-comp. pars.
flex. parametric

44.13
0.04
47.41
0.04
36.63
0.04
0
0.03
∗
normal sel.

45.86
0.04
49.22
0.04
38.22
0.04
0
0.03
∗
strong sel.

47.81
0.04
53.2
0.04
34.94
0.04
0
0.03
∗
correct spec.

43.99
0.04
45.42
0.04
41.35
0.04
0
0.03
∗
misspec.

48.73
0.06
48.64
0.06
32.49
0.05
0
0.04
∗
10% mediated

39.48
0.02
50.51
0.03
50.96
0.03
0
0.02
∗
50% mediated

Direct effect

r.rmse

rmse

r.rmse

rmse

r.rmse

rmse

r.rmse

rmse

r.rmse

rmse

r.rmse

rmse

IPW
TMLE pars.
g-comp. pars.
flex. parametric
Indirect effect

1.16
1
0
0.46
r.rmse

0.38
0.38
0.37
0.38
rmse

1.68
1.11
0
0.27
r.rmse

0.37
0.37
0.37
0.37
rmse

1.8
1.52
0
0.49
r.rmse

0.37
0.37
0.37
0.37
rmse

1.05
0.6
0
0.25
r.rmse

0.38
0.38
0.37
0.38
rmse

1.24
0.99
0
0.16
r.rmse

0.37
0.37
0.37
0.37
rmse

1.6
1.11
0
0.58
r.rmse

0.38
0.38
0.37
0.37
rmse

IPW
influence pars.
g-comp. pars.
flex. parametric

51.51
48.64
38.39
0

0.02
0.02
0.02
0.01

44.25
49.39
38.17
0

0.06
0.06
0.06
0.04

47.1
41.8
28.67
0

0.04
0.04
0.03
0.03

44.69
56.17
47.16
0

0.04
0.04
0.04
0.03

49.71
56.6
44.48
0

0.04
0.04
0.04
0.03

42.05
41.95
32.05
0

0.04
0.04
0.04
0.03

e −rmsemin ), where rmse is the RMSE of estimator e and rmse
NOTE: “r.rmse,” the relative RMSE of any estimator e is defined as 100 ∗ ( rmsermse
e
min is the minimum RMSE (of the best
min
performing estimator). *Only simulations without trimming are included.

152

Journal of Business & Economic Statistics, January 2016

Table 6. Relative and absolute RMSEs across simulation features, binary outcome
All scenarios

No trimming

homog. effects

∗

heterog. effects

∗

∗

n = 1000

∗

n = 4000

Direct effect

r.rmse

rmse

r.rmse

rmse

r.rmse

rmse

r.rmse

rmse

r.rmse

rmse

r.rmse

rmse

IPW
TMLE pars.
g-comp. pars.
flex. parametric
Indirect effect

1.05
0
0.7
3.1
r.rmse

2.66
2.63
2.65
2.71
rmse

0.96
0
0.57
2.85
r.rmse

2.65
2.63
2.64
2.70
rmse

0.82
0.74
0.07
0
r.rmse

2.36
2.36
2.34
2.34
rmse

1.68
0
1.58
5.77
r.rmse

2.94
2.89
2.94
3.06
rmse

1.87
0.79
0
3.35
r.rmse

3.24
3.2
3.18
3.28
rmse

0.79
0
2.69
3.33
r.rmse

2.07
2.05
2.11
2.12
rmse

IPW
influence pars.
g-comp. pars.
flex. parametric

0
0.2
0.03
0.2
29.17
0.26
244.41
0.68
∗
normal sel.

0
0.19
1.66
0.19
28.65
0.25
246.09
0.66
∗
strong sel.

Direct effect

r.rmse

rmse

r.rmse

rmse

r.rmse

IPW
TMLE pars.
g-comp. pars.
flex. parametric
Indirect effect

0.95
0.2
0
2.09
r.rmse

2.93
2.91
2.9
2.96
rmse

1.23
0
1.53
4.04
r.rmse

2.37
2.34
2.38
2.44
rmse

IPW
influence pars.
g-comp. pars.
flex. parametric

21.04
17.85
0
512.32

0.09
0.09
0.08
0.46

0
3.01
43.13
195.84

0.29
0.3
0.42
0.86

51.05
0.26
53.78
0.27
37.64
0.24
0
0.17
∗
correct spec.

0
0.12
1.34
0.12
109.01
0.26
845.22
1.15
∗
misspec.

0
0.26
2.49
0.27
9.98
0.29
227.53
0.86
∗
10% mediated

0.15
0.12
0
0.12
69.57
0.2
287.09
0.47
∗
50% mediated

rmse

r.rmse

rmse

r.rmse

rmse

r.rmse

rmse

0.82
0
1.21
5.67
r.rmse

2.65
2.63
2.67
2.78
rmse

1.18
0.07
0
0.09
r.rmse

2.65
2.62
2.62
2.62
rmse

2.18
1.23
0
1.87
r.rmse

3.23
3.2
3.16
3.22
rmse

1.01
0
3.38
6.33
r.rmse

2.07
2.05
2.12
2.18
rmse

0
0.43
28.22
257.1

0.2
0.2
0.25
0.7

0
2.94
29.10
234.66

0.19
0.19
0.24
0.63

0
3.33
20.51
219.13

0.17
0.18
0.21
0.56

0
0.25
35.48
268.69

0.21
0.21
0.28
0.77

e −rmsemin ), where rmse is the RMSE of estimator e and rmse
NOTE: “r.rmse,” the relative RMSE of any estimator e is defined as 100 ∗ ( rmsermse
e
min is the minimum RMSE (of the best
min
performing estimator). *Only simulations without trimming are included.

estimator with the smallest RMSE (therefore, rel.rmse is 0 for
the latter). The second column gives the values of the RMSEs
on which this comparison is based. The first panel shows the
average RMSEs over all specifications, followed by the results
for specifications with and without trimming. As trimming does
not importantly affect the RMSEs, all remaining subgroups of
specifications (homogeneous/heterogeneous effects, small/large
sample size, normal/strong selection, correct/incorrect specification, 10%/90% mediated) only include simulations without
trimming.
The first important observation is that for the direct effects, estimator choice does not matter much. Even though gcomputation dominates most often followed by TMLE (which
is best over all scenarios under the binary outcome), all methods have rather similar RMSEs and no estimator has decisively
outperformed. For the indirect effects, the picture looks more
complex, as the type of outcome variable, that is, binary versus
nonbinary, matters crucially. For the nonbinary outcome, the
flexible parametric specification of Section 3.2.2 outperforms
the competitors in all specifications, at least in terms of the relative RMSE (while absolute differences are often small). All
other estimators behave similarly well. For the binary outcome,
however, the flexible parametric estimator only dominates under
effect homogeneity. In scenarios with heterogeneous effects, the
misspecification of the parametric method (which does not allow
for effect heterogeneity) seems to be too substantial. Here, IPW
and influence function-based estimation (influence pars.) are by
and large the best or close to the best estimators, while flexible
parametric performs badly and g-computation is somewhere in
between. Thus, IPW and the influence function-based method

with the parsimonious model turn out to be the recommended
estimators in the binary case.
In addition to the RMSEs, we provide the relative and absolute biases and standard deviations of the selected estimators for
all scenarios and for simulations without trimming in Table 7.
For the direct effects, TMLE has overall the smallest absolute
bias. As the relative bias of any other estimator is below 15% in
the scenarios considered, we conclude that all methods perform
quite satisfactorily in terms of bias. For the indirect effects, IPW
and influence function-based estimation dominate under nonbinary and binary outcomes, respectively. It is noteworthy that
under the binary outcome, the absolute bias is comparably large
for g-computation, but even much more so for flexible parametric estimation. The latter result is driven by the estimator’s
poor performance in the simulations with effect heterogeneity,
as already noticed for the RMSE. Concerning the standard deviation, all estimators are very similar when considering the direct
effects. For the indirect effects, flexible parametric estimation
dominates the other methods under the nonbinary outcome but
is far worse under the binary outcome. The differences between
the other estimators are again moderate.
From an applied perspective, it appears most convenient to
have one estimation strategy instead of using two different estimators for the direct and indirect effects. As a measure for the
overall performance across effects, Table 8 therefore presents the
norms of the joint RMSE matrix of direct and indirect effects for
each estimator. Because trimming proved to have little effects,
the results are reported for setups without trimming only. For
the nonbinary outcome, g-computation and flexible parametric
estimation perform similarly well and dominate the remaining

Huber, Lechner, and Mellace: Finite Sample Performance of Estimators for Mediation Analysis

153

Table 7. Relative and absolute biases/standard deviations for all scenarios and without trimming
Nonbinary outcome
All scenarios

Binary outcome

No trimming

All scenarios

No trimming

Bias
Direct effect

r.bias

bias

r.bias

bias

r.bias

bias

r.bias

bias

IPW
TMLE pars.
g-comp. pars.
flex. parametric
Indirect effect

11.27
0
1.12
9.42
r.bias

0.05
0.05
0.05
0.05
bias

12.54
2.31
0
12.36
r.bias

0.05
0.05
0.05
0.05
bias

3.43
0
4.24
4.26
r.bias

1.20
1.16
1.21
1.21
bias

1.91
0
3.83
3.30
r.bias

1.18
1.16
1.20
1.19
bias

IPW
influence pars.
g-comp. pars.
flex. parametric

0
6.22
17.76
6.76

0.01
0.01
0.01
0.01

0
5.31
13.54
3.50

0.01
0.01
0.01
0.01

38.70
0
395.15
1355.64

0.04
0.03
0.13
0.40

5.79
0
365.61
1267.95

0.03
0.03
0.13
0.37

Nonbinary outcome
All scenarios

Binary outcome

No trimming

All scenarios

No trimming

Standard dev.
Direct effect

r.sd

sd

r.sd

sd

IPW
TMLE pars.
g-comp. pars.
flex. parametric
Indirect effect

1.18
1.03
0
0.08
r.sd

0.37
0.37
0.36
0.36
sd

1.12
0.98
0
0.05
r.sd

0.37
0.37
0.36
0.36
sd

1.80
1.04
0
1.54
r.sd

1.99
1.97
1.95
1.98
sd

1.73
0.93
0
1.67
r.sd

1.98
1.97
1.95
1.98
sd

IPW
Influence pars.
g-comp. pars.
Flex. parametric

54.53
54.61
40.36
0

0.04
0.04
0.04
0.03

55.35
55.16
40.98
0

0.04
0.04
0.04
0.02

12.25
15.77
0
174.05

0.19
0.19
0.17
0.46

12.59
15.56
0
175.48

0.19
0.19
0.17
0.46

r.sd

sd

r.sd

sd

e −biasmin ), where bias is the absolute bias of estimator e and bias
NOTE: “r.bias,” the relative absolute bias of any estimator e is defined as 100 ∗ ( biasbias
e
min is the minimum absolute bias (of
min
the best performing estimator). The same applies to “r.sd,” the relative standard deviation.

methods in all cases. In the nonbinary case, however, the flexible
parametric estimator is only competitive under homogeneous
effects and does worse than any other method in the other scenarios (driven by its weakness when estimating indirect effects
under effect heterogeneity). Differences between the remaining
methods are small, but g-computation and influence-based estimation perform best overall. As g-computation is competitive
under both nonbinary and binary outcomes, it appears to be the

preferred choice if one would like to use the same method for
direct and indirect effects.
Finally, it seems worth considering whether particular combinations of distinct estimators for the direct and indirect effects perform particularly well (in terms of the norm) to assess
the relative price to pay for the “convenience” of using just
one type of estimator for both effects. Therefore, Table A.7 in
Appendix A.2 compares the six respective best combinations of

Table 8. Norms of RMSEs when estimating direct and indirect effects jointly
nonbinary outc.

no trim.

hom. eff.

het. eff.

n = 1000

n = 4000

n. sel.

str. sel.

cor. spec.

misspec.

10% m.

50% m.

IPW
TMLE pars.
influence pars.
g-comp. pars.
flex. parametric
binary outc.

0.215
0.215
0.214
0.208
0.207
no trim.

0.208
0.208
0.206
0.201
0.200
hom. eff.

0.222
0.222
0.221
0.215
0.214
het. eff.

0.253
0.253
0.251
0.244
0.243
n = 1000

0.064
0.064
0.063
0.062
0.063
n = 4000

0.214
0.214
0.213
0.208
0.209
n. sel.

0.216
0.216
0.214
0.208
0.205
str. sel.

0.215
0.214
0.213
0.205
0.206
cor. spec.

0.215
0.215
0.214
0.211
0.209
misspec.

0.212
0.213
0.211
0.206
0.204
10% m.

0.218
0.217
0.216
0.210
0.210
50% m.

IPW
TMLE pars.
influence pars.
g-comp. pars.
flex. parametric

0.104
0.104
0.101
0.101
0.113

0.087
0.088
0.087
0.085
0.084

0.121
0.120
0.116
0.116
0.142

0.115
0.115
0.113
0.111
0.125

0.058
0.058
0.057
0.060
0.067

0.126
0.123
0.123
0.123
0.143

0.082
0.084
0.080
0.078
0.083

0.105
0.104
0.103
0.103
0.123

0.102
0.104
0.100
0.098
0.103

0.143
0.144
0.139
0.137
0.150

0.065
0.063
0.064
0.066
0.076

NOTE: Only simulations without trimming are considered.

154

Journal of Business & Economic Statistics, January 2016

distinct estimators to the five pure estimation strategies (using
the same method across outcomes). As the differences between
the respective best combined and pure methods are very small
to nonexistent in any scenario, the price for using the same approach for estimating direct and indirect effects is very low in
our EMCS.
6.

CONCLUSION

This article analyzed the finite sample performance (in terms
of the RMSE) of a variety of estimators of (natural or pure)
direct and indirect effects (IPW, multiply robust estimation,
g-computation, parametric estimation based on simulating potential mediators and outcomes, flexible parametric estimation,
OLS) using a simulation design based on empirical data from
Behncke, Frölich, and Lechner (2010b). Several features like
the distribution of the outcome variable, the sample size, effect
heterogeneity, selection into the mediator, the share of mediated,
the correct or incorrect specification of econometric models, and
the trimming of influential observations were varied to analyze
a comprehensive set of simulation designs. Not surprisingly, we
found that stronger selection into the mediator increased the
RMSE (in particular under the smaller sample size) and that
misspecifications in which confounders were omitted increased
the bias, but decreased the variance. In contrast, trimming influential observations did not matter much for the performance of
the estimators.
Our analysis did not point to a clear-cut best performing
estimator for all (binary and nonbinary) outcomes and (homogeneous/heterogeneous) direct and indirect effects considered.

Concerning the direct effects, g-computation most often dominated the other methods (followed by multiply robust targeted
MLE), but all estimators performed similarly well. With regard
to the indirect effects, flexible parametric estimation outperformed the competitors in all scenarios when the outcome was
nonbinary, but only under homogeneous effects when the outcome was binary. Under heterogeneous effects, IPW and (multiply robust) influence function-based estimation performed best
and were overall the preferred choices for the indirect effects
in the binary outcome case. Finally, we assessed the performance of each method when jointly estimating direct and indirect effects based on the norm of the joint RMSE matrix.
For the nonbinary outcome, g-computation and flexible parametric estimation performed similarly well and dominated the
remaining methods. For the binary outcome, g-computation and
influence function-based estimation were ahead, albeit weighting and targeted MLE came close. Even though g-computation
appeared to be the overall winner across our scenarios, the
differences between estimators were often (but not always)
minor. Future research may consider further estimation approaches and simulation designs that mimic empirically relevant problems different to this article to broaden the evidence
on the finite sample behavior of estimators of direct and indirect
effects.

A.
A.1.

APPENDIX

Descriptive Statistics

Figure A.1 Distribution of the nonbinary outcome (cumulative months jobseeking between months 10 and 36).

Huber, Lechner, and Mellace: Finite Sample Performance of Estimators for Mediation Analysis

155

Table A.1. Difference in observed covariates across treatment and mediator states
Treatment status
Characteristics of the unemployed person

Nonmediated

Mediated

0.45
0.43
(0.50)
(0.50)
0.21
0.22
(0.41)
(0.42)
0.16
0.16
(0.37)
(0.37)
0.04
0.04
(0.20)
(0.21)
0.59
0.57
(0.49)
(0.50)
0.13
0.14
(0.34)
(0.35)
0.76
0.75
(0.43)
(0.43)
0.11
0.10
(0.32)
(0.30)
0.31
0.32
(0.46)
(0.47)
0.56
0.57
(1.18)
(1.21)
0.80
0.80
(0.25)
(0.25)
Characteristics of the case worker

0.44
(0.50)
0.22
(0.41)
0.16
(0.37)
0.04
(0.20)
0.57
(0.49)
0.14
(0.35)
0.75
(0.43)
0.11
(0.31)
0.32
(0.47)
0.58
(1.22)
0.80
(0.25)

0.48
(0.50)
0.17
(0.37)
0.16
(0.36)
0.04
(0.19)
0.64
(0.48)
0.11
(0.32)
0.78
(0.42)
0.11
(0.31)
0.24
(0.43)
0.29
(0.78)
0.82
(0.25)

0.42
0.42
(0.49)
(0.49)
Age
45.1
43.78
(11.96)
(11.46)
Tenure in employment office (in years)
5.63
5.78
(3.06)
(3.43)
Own experience of unemployment
0.65
0.61
(0.48)
(0.49)
Education: vocational training
0.29
0.34
(0.45)
(0.47)
Education: above vocational training
0.47
0.42
(0.50)
(0.49)
Education: tertiary track (university or polytechnic)
0.24
0.24
(0.43)
(0.43)
Degree in vocational training for caseworkers
0.19
0.22
(0.39)
(0.42)
Indicator for missing caseworker characteristics
0.04
0.05
(0.19)
(0.21)
Allocation of unemployed to caseworkers

0.42
(0.49)
44.45
(11.77)
5.69
(3.24)
0.63
(0.48)
0.31
(0.46)
0.45
(0.50)
0.24
(0.43)
0.21
(0.41)
0.04
(0.20)

0.43
(0.50)
44.89
(11.41)
5.78
(3.28)
0.64
(0.48)
0.30
(0.46)
0.46
(0.50)
0.24
(0.43)
0.18
(0.39)
0.03
(0.18)

By industry

0.55
(0.50)
0.56
(0.50)
0.03
(0.18)
0.07
(0.26)
0.12
(0.33)
0.08
(0.27)

Female
Qualification: unskilled
Qualification: semiskilled
Qualification: skilled without degree
Qualification: skilled with degree
Employability rating: low
Employability rating: medium
Employability rating: high
Mother tongue other than German, French, Italian
Number of unemployment spells in last two years
Fraction of time employed in last two years

Nontreated

Mediation status

Treated

Female

By occupation
By age
By employability
By region
Other

0.52
(0.50)
0.52
(0.50)
0.03
(0.17)
0.08
(0.26)
0.12
(0.33)
0.08
(0.27)

0.58
(0.49)
0.61
(0.49)
0.04
(0.19)
0.07
(0.25)
0.12
(0.32)
0.08
(0.27)

0.53
(0.50)
0.56
(0.5)
0.04
(0.19)
0.06
(0.25)
0.09
(0.29)
0.08
(0.27)
(Continued on next page)

156

Journal of Business & Economic Statistics, January 2016

Table A.1. Difference in observed covariates across treatment and mediator states (continued)
Treatment status
Characteristics of the unemployed person

Nontreated

Mediation status
Treated

Nonmediated

Mediated

0.75
(0.43)
0.25
(0.43)
3.69
(0.86)

0.70
(0.46)
0.3
(0.46)
3.66
(0.84)

Local labor market characteristics
German speaking employment office
French speaking employment office
Cantonal unemployment rate

0.73
(0.45)
0.27
(0.45)
3.67
(0.84)

0.77
(0.42)
0.23
(0.42)
3.71
(0.88)

NOTE: Standard deviations in parentheses.

Table A.2. Probit estimates when regressing (a) D on X and (b) M on D and X
(a)
n = 93,076

Coefficients

Std errors

−0.22
0.36
—
—
1.40
0.71
Characteristics of the case worker

−1.33
−0.07
0.28

0.1
0.02
0.2

Age
0.00
0.00
∗
French
−0.02
0.01
Female
−0.04
0.10
∗
French
0.07
0.20
Tenure in employment office (in years)
0.02
0.02
∗
French
−0.03
0.03
Own experience of unemployment
−0.04
0.10
∗
French
−0.15
0.21
Indicator for missing caseworker characteristics
−0.10
0.25
Education: above vocational training
−0.20
0.11
∗
French
0.35
0.25
Education: tertiary track (university or polytechnic)
−0.20
0.14
∗
French
0.31
0.27
Special vocational training of caseworker
0.09
0.12
∗
French
0.30
0.35
Allocation of unemployed to caseworkers

0.00
0.00
0.00
0.06
0.01
−0.01
−0.02
0.01
−0.05
0.02
0.00
0.03
−0.10
−0.06
0.00

0.00
0.00
0.03
0.04
0.00
0.01
0.03
0.05
0.06
0.03
0.06
0.04
0.06
0.03
0.07

By industry
∗
French
By occupation
∗
French
By age
By employability
By region
Other

−0.03
0.00
−0.02
0.01
0.10
−0.05
−0.16
−0.01

0.03
0.05
0.03
0.05
0.05
0.04
0.03
0.04

Constant
Noncooperative caseworker
French speaking employment office

Female
∗
French
Mother tongue other than German, French, Italian
∗
French
Qualification:unskilled
∗
French
Qualification: semiskilled
∗
French
Qualification: skilled without degree
∗
French
Number of unemployment spells in last two years
∗
French

Coefficients

(b)
Std errors

0.14
0.10
−0.07
0.20
0.24
0.10
0.16
0.20
0.13
0.23
−0.09
0.17
0.01
0.14
−0.05
0.16
Characteristics of the unemployed person
−0.04
−0.10
−0.03
0.10
0.09
−0.13
0.04
−0.01
0.02
0.19
0.01
−0.01

0.03
0.07
0.04
0.06
0.04
0.08
0.05
0.08
0.05
0.09
0.01
0.01

0.08
0.02
−0.05
0.03
−0.11
0.02
−0.14
0.04
−0.07
0.02
−0.04
0.05
0.02
0.03
−0.05
0.05
−0.05
0.05
0.03
0.07
−0.12
0.01
−0.03
0.02
(Continued on next page)

Huber, Lechner, and Mellace: Finite Sample Performance of Estimators for Mediation Analysis

157

Table A.2. Probit estimates when regressing (a) D on X and (b) M on D and X (continued)
(a)
n = 93,076
Fraction of time employed in last two years
∗
French
Employability low
∗
French
Employability medium
∗
French

(b)

Coefficients

Std errors

Coefficients

Std errors

0.00
−0.12
0.02
0.15
0.00
0.02

0.03
0.06
0.11
0.17
0.09
0.14

0.20
−0.15
−0.03
−0.03
0.00
0.05

0.04
0.06
0.04
0.07
0.03
0.05

−0.06
0.01

0.01
0.03

Local labor market characteristics
Unemployment rate canton
∗
French

0.06
−0.18

0.06
0.11

NOTE: Standard errors are clustered at caseworker level.

A.2.

Further Results
Table A.3. OLS analysis of determinants of the abs. bias for the nonbinary outcome
Direct effect
IPW

Estimator
Sample size

mult.robust

g-comp, simulation

OLS, flex. para

1000

4000

1000

4000

1000

4000

1000

4000

Constant
Effect heterogeneity
Strong selection
50% mediated
Misspecification
Trimming
TMLE/g-comp. parsimon.
TMLE/g-comp. flexible
DR/simulation parsimon.
OLS flexible
Number of observations
Adjusted R2

0.036
0.017
−0.039
0.007
0.056
−0.001

0.016
0.030
−0.032
0.014
0.062
−0.003

0.028
0.024
−0.047
0.004
0.051
0.001
0.006
−0.000
0.006

0.024
0.028
−0.042
0.009
0.050
−0.004
0.001
−0.000
0.001

0.030
0.017
−0.039
0.003
0.051
0.002
0.006
0.000
0.005

0.024
0.025
−0.038
0.009
0.052
−0.002
−0.002
0.000
−0.002

0.018
0.110
0.045
0.061
0.053
−0.005

−0.008
0.128
0.056
0.071
0.067
−0.002

32
0.551

32
0.781

128
128
0.659
0.688
Indirect effect

128
0.606

128
0.672

−0.095
64
0.320

−0.100
64
0.363

Constant
Effect heterogeneity
Strong selection
50% mediated
Misspecification
Trimming
TMLE/g-comp. parsimon.
TMLE/g-comp. flexible
DR/simulation parsimon.
OLS flexible
Adjusted R2

−0.001
0.005
0.019
0.004
0.000
−0.002

−0.000
0.001
0.015
−0.001
0.002
0.003

−0.004
0.004
0.023
−0.002
0.018
0.001
−0.001
−0.002
−0.007

−0.013
0.004
0.025
−0.000
0.021
0.001
0.006
0.003
−0.002

−0.004
0.003
0.019
0.000
0.009
0.001
−0.001
0.000
−0.001

−0.008
0.004
0.019
0.001
0.011
0.001
0.003
−0.000
0.003

−0.002
0.013
0.028
0.009
−0.003
−0.001

−0.003
0.009
0.024
0.005
0.002
0.004

0.626

0.412

0.567

0.637

0.586

0.568

−0.008
0.508

−0.009
0.433

158

Journal of Business & Economic Statistics, January 2016

Table A.4. OLS analysis of determinants of the abs. bias for the binary outcome
Direct effect
IPW
Estimator
Sample size

mult.robust

g-comp, simulation

OLS, flex. para

1000

4000

1000

4000

1000

4000

1000

4000

Constant
Effect heterogeneity
Strong selection
50% mediated
Misspecification
Trimming
TMLE/g-comp. parsimon.
TMLE/g-comp. flexible
DR/simulation parsimon.
OLS flexible
Number of observations
Adjusted R2

1.008
2.194
−0.545
−1.339
0.031
0.069

0.978
2.158
−0.622
−1.274
0.137
0.027

−5.568
16.748
−2.107
−1.896
1.317
−0.352
−0.112
29.061
−0.112

0.618
5.986
−1.146
−0.779
−3.001
−0.036
0.020
7.683
0.020

1.245
2.180
−0.469
−1.570
−0.042
−0.009
−0.102
−0.055
−0.181

0.972
2.117
−0.623
−1.357
0.095
0.009
0.144
0.036
0.054

0.768
6.105
−0.185
2.604
0.113
−0.096

0.805
5.915
−0.199
2.586
0.030
−0.002

32
0.593

32
0.593

128
128
0.529
0.345
Indirect effect

128
0.596

128
0.598

−3.819
64
0.462

−3.765
64
0.480

Constant
Effect heterogeneity
Strong selection
50% mediated
Misspecification
Trimming
TMLE/g-comp. parsimon.
TMLE/g-comp. flexible
DR/simulation parsimon.
OLS flexible
Adjusted R2

−0.038
0.031
0.066
0.042
−0.012
0.029

−0.034
0.021
0.059
0.045
0.006
0.008

−0.075
0.447
0.264
0.011
−0.080
0.020
0.008
0.424
−0.226

−0.328
0.304
0.288
0.108
0.080
0.001
0.230
0.343
−0.038

−0.071
0.090
0.161
0.014
−0.018
0.015
0.070
−0.015
0.073

−0.152
0.110
0.148
0.068
0.033
−0.000
0.111
−0.004
0.118

−0.281
1.051
0.765
0.192
−0.022
0.098

−0.466
1.029
0.726
0.421
0.205
0.003

0.401

0.506

0.533

0.406

0.346

0.376

−0.371
0.605

−0.323
0.569

NOTE: The binary outcome has been multiplied by 100.

Table A.5. OLS analysis of determinants of the std. dev. for the nonbinary outcome
Direct effect
IPW
Estimator
Sample size

mult.robust

g-comp, simulation

OLS, flex. para

1000

4000

1000

4000

1000

4000

1000

4000

Constant
Effect heterogeneity
Strong selection
50% mediated
Misspecification
Trimming
TMLE/g-comp. parsimon.
TMLE/g-comp. flexible
DR/simulation parsimon.
OLS flexible
Number of observations
Adjusted R2

0.489
0.011
0.003
0.003
−0.009
−0.001

0.240
0.006
0.000
0.002
−0.002
−0.001

0.682
0.010
0.131
−0.127
−0.098
0.000
−0.148
0.000
−0.148

0.242
0.006
0.000
0.002
−0.002
−0.001
−0.002
0.000
−0.002

0.607
0.020
0.078
−0.074
−0.059
−0.013
−0.097
0.014
−0.087

0.271
0.006
0.000
−0.000
−0.005
−0.011
−0.025
−0.023
−0.000

0.566
0.008
−0.007
0.070
−0.004
−0.000

0.285
0.005
−0.006
0.035
0.001
−0.000

32
0.691

32
0.668

128
128
0.316
0.705
Indirect effect

128
0.275

128
0.651

−0.114
64
0.773

−0.061
64
0.789

Constant
Effect heterogeneity
Strong selection
50% mediated
Misspecification
Trimming
TMLE/g-comp. parsimon.
TMLE/g-comp. flexible
DR/simulation parsimon.
OLS flexible
Adjusted R2

0.028
0.001
0.056
−0.000
−0.002
0.002

0.005
0.001
0.030
0.000
0.004
0.003

0.316
0.004
0.203
−0.156
−0.101
0.003
−0.210
0.003
−0.236

0.029
0.005
0.031
−0.002
0.002
0.003
−0.015
−0.004
−0.025

0.128
0.003
0.086
−0.045
−0.027
0.002
−0.087
−0.025
−0.082

0.020
0.003
0.028
−0.001
0.004
0.002
−0.015
−0.013
−0.012

0.027
−0.000
0.040
0.006
−0.000
0.002

0.006
0.001
0.023
0.002
0.003
0.002

0.963

0.912

0.425

0.790

0.496

0.888

−0.015
0.926

−0.006
0.884

Huber, Lechner, and Mellace: Finite Sample Performance of Estimators for Mediation Analysis

159

Table A.6. OLS analysis of determinants of the std. dev. for the binary outcome
Direct effect
IPW
Estimator
Sample size

mult.robust

g-comp, simulation

OLS, flex. para

1000

4000

1000

4000

1000

4000

1000

4000

Constant
Effect heterogeneity
Strong selection
50% mediated
Misspecification
Trimming
TMLE/g-comp. parsimon.
TMLE/g-comp. flexible
DR/simulation parsimon.
OLS flexible
Number of observations
Adjusted R2

3.246
−1.055
0.037
−0.118
−0.057
0.019

1.582
−0.459
−0.003
−0.067
−0.012
−0.002

−0.862
5.492
0.799
1.123
−0.683
0.475
−0.104
13.503
−0.103

−0.750
6.816
−0.986
0.426
−2.125
−0.000
−0.012
14.578
−0.012

3.589
−1.063
0.047
−0.118
−0.024
−0.052
−0.378
−0.236
−0.227

1.886
−0.393
−0.002
−0.126
−0.146
0.017
−0.265
−0.191
−0.182

3.807
−0.896
0.019
0.332
−0.074
0.016

1.881
−0.414
−0.019
0.169
0.001
−0.001

32
0.981

32
0.971

128
128
0.462
0.472
Indirect effect

128
0.915

128
0.583

−0.827
64
0.849

−0.468
64
0.828

Constant
Effect heterogeneity
Strong selection
50% mediated
Misspecification
Trimming
TMLE/g-comp. parsimon.
TMLE/g-comp. flexible
DR/simulation parsimon.
OLS flexible
Adjusted R2

0.228
−0.204
0.248
0.031
−0.010
0.007

0.072
−0.084
0.140
0.022
0.003
0.001

0.657
0.060
0.422
−0.023
−0.136
0.045
−0.254
0.505
−0.569

0.160
0.042
0.146
0.024
−0.031
0.011
−0.011
0.153
−0.140

0.547
−0.213
0.216
0.013
−0.023
0.010
−0.318
−0.279
−0.280

0.156
−0.083
0.127
0.016
−0.001
−0.002
−0.081
−0.079
−0.070

0.155
0.803
0.186
0.027
−0.096
0.009

0.122
0.194
0.065
0.054
0.016
0.001

0.791

0.794

0.627

0.596

0.837

0.794

0.141
0.811

−0.130
0.727

NOTE: The binary outcome has been multiplied by 100.

Table A.7. Relative and absolute performances (direct and indirect effects jointly)
nonbinary outc.

no trim. hom. ef. het. ef. n = 1000 n = 4000 n. sel. str. sel. cor. sp.

mis.

10% m. 50% m.

DE: g-comp. pars. IE: TMLE flex.
0.209
0.203
0.215
0.246
0.062
DE: g-comp. pars. IE: influence flex.
0.207
0.202
0.213
0.243
0.063
DE: g-comp. pars. IE: flex. parametric 0.207
0.200
0.213
0.243
0.062
DE: flex. parametric IE: TMLE flex.
0.208
0.201
0.214
0.244
0.064
DE: flex. parametric IE: influence flex. 0.207
0.201
0.214
0.243
0.064
DE: flex. parametric IE: g-comp. pars. 0.207
0.201
0.214
0.243
0.064
Both: IPW
0.215
0.208
0.222
0.253
0.064
Both: TMLE pars.
0.215
0.208
0.222
0.253
0.064
Both: influence pars.
0.214
0.206
0.221
0.251
0.063
Both: g-comp. pars.
0.208
0.201
0.215
0.244
0.062
Both: flex. parametric
0.207
0.200
0.214
0.243
0.0630
binary outc.
no trim. hom. ef. het. ef. n = 1000 n = 4000

0.207 0.377 0.348
0.208 0.235 0.205
0.208 0.205 0.204
0.209 0.373 0.346
0.211 0.233 0.206
0.21
0.205 0.206
0.214 0.216 0.215
0.214 0.216 0.214
0.213 0.214 0.213
0.208 0.208 0.205
0.209 0.205 0.206
n. sel. str. sel. cor. sp.

0.211 0.368
0.210
0.209 0.233
0.209
0.21
0.204
0.209
0.208 0.366
0.210
0.209 0.232
0.209
0.209 0.205
0.210
0.215 0.212
0.218
0.215 0.213
0.217
0.214 0.211
0.216
0.211 0.206
0.210
0.209 0.204
0.210
mis. 10% m. 50% m.

DE: TMLE pars. IE: influence pars.
DE: TMLE pars. IE: flex. parametric
DE: g-comp. pars. IE: TMLE pars.
DE: g-comp. pars. IE: influence pars.
DE: g-comp. pars. IE: flex. parametric
Both: IPW
Both: TMLE pars.
Both: influence pars.
Both: g-comp. pars.
Both: flex. parametric

0.123
0.123
0.124
0.123
0.124
0.126
0.123
0.123
0.123
0.143

0.100
0.102
0.101
0.098
0.099
0.102
0.104
0.100
0.098
0.103

0.101
0.102
0.102
0.101
0.100
0.104
0.104
0.101
0.101
0.113

0.087
0.086
0.086
0.085
0.085
0.087
0.088
0.087
0.085
0.084

0.116
0.119
0.118
0.116
0.116
0.121
0.120
0.116
0.116
0.142

0.113
0.113
0.113
0.111
0.111
0.115
0.115
0.113
0.111
0.125

NOTE: DE = direct effect; IE = indirect effect. Only simulations without trimming are considered.

0.057
0.057
0.059
0.059
0.061
0.058
0.058
0.057
0.060
0.067

0.080
0.081
0.080
0.078
0.076
0.082
0.084
0.080
0.078
0.083

0.103
0.102
0.102
0.103
0.104
0.105
0.104
0.103
0.103
0.123

0.139
0.142
0.141
0.136
0.138
0.143
0.144
0.139
0.137
0.150

0.064
0.064
0.065
0.065
0.067
0.065
0.063
0.064
0.066
0.076

160

Journal of Business & Economic Statistics, January 2016

ACKNOWLEDGMENTS
Michael Lechner is a Research Fellow of CEPR and PSI, London, CES-Ifo,
Munich, IAB, Nuremberg, and IZA, Bonn. We have benefited from comments
and advice by Kosuke Imai, Eric Tchetgen Tchetgen, Mark van der Laan, Teppei
Yamamoto, Wen Zheng, an associate editor, and three anonymous referees. The
usual disclaimer applies.

FUNDING
Michael Lechner and Giovanni Mellace gratefully acknowledge financial
support from the Swiss National Science Foundation grant number 100018
137769.

[Received June 2014. Revised January 2015.]
REFERENCES
Advani, A., and Sloczyński, T. (2013), “Mostly Harmless Simulations? On
the Internal Validity of Empirical Monte Carlo Studies,” IZA Discussion Paper No. 7874, Bonn: Institute for the Study of Labor (IZA).
[140]
Albert, J. M. (2008), “Mediation Analysis via Potential Outcomes Models,”
Statistics in Medicine, 27, 1282–1304. [141]
Albert, J. M., and Nelson, S. (2011), “Generalized Causal Mediation Analysis,”
Biometrics, 67, 1028–1038. [139]
Avin, C., Shpitser, I., and Pearl, J. (2005), “Identifiability of Path-Specific
Effects,” in IJCAI-05, Proceedings of the Nineteenth International
Joint Conference on Artificial Intelligence, Edinburgh, UK, pp. 357–
363. [139]
Baron, R. M., and Kenny, D. A. (1986), “The Moderator-Mediator Variable
Distinction in Social Psychological Research: Conceptual, Strategic, and
Statistical Considerations,” Journal of Personality and Social Psychology,
51, 1173–1182. [140,142]
Behncke, S., Frölich, M., and Lechner, M. (2010a), “A Caseworker Like
Me: Does The Similarity Between The Unemployed and Their Caseworkers Increase Job Placements?” Economic Journal, 120, 1430–1459.
[145]
——— (2010b), “Unemployed and Their Caseworkers: Should They be Friends
or Foes?” Journal of the Royal Statistical Society, Series A, 173, 67–92.
[145,146,147,154]
Busso, M., DiNardo, J., and McCrary, J. (in press, a), “Finite Sample Properties
of Semiparametric Estimators of Average Treatment Effects,” Journal of
Business and Economic Statistics. [140,144,148]
——— (in press, b), “New Evidence on the Finite Sample Properties of Propensity Score Matching and Reweighting Estimators,” Review of Economics and
Statistics. [140,144]
Flores, C. A., and Flores-Lagunes, A. (2009), “Identification and Estimation of
Causal Mechanisms and Net Effects of a Treatment Under Unconfoundedness,” IZA Dicussion Paper No. 4237, Bonn: Institute for the Study of Labor
(IZA). [140,141]
Frölich, M. (2004), “Finite Sample Properties of Propensity-Score Matching
and Weighting Estimators,” Review of Economics and Statistics, 86, 77–90.
[140]
Gelman, A., and Imbens, G. (2013), “Why Ask Why? Forward Causal
Inference and Reverse Causal Questions,” NBER Working Paper No.
19614, Cambridge, MA: National Bureau of Economic Research.
[139]
Gerfin, M., and Lechner, M. (2002), “Microeconometric Evaluation of the Active
Labour Market Policy in Switzerland,” Economic Journal, 112, 854–893.
[147]
Hill, W. J., and Hunter, W. G. (1966), “A Review of Response Surface Methodology: A Literature Survey,” Technometrics, 8, 571–590. [149]
Horvitz, D. G., and Thompson, D. J. (1952), “A Generalization of Sampling
Without Replacement From a Finite Universe,” Journal of the American
Statistical Association, 47, 663–685. [140,144]
Huber, M. (2014), “Identifying Causal Mechanisms (Primarily) Based on Inverse Probability Weighting,” Journal of Applied Econometrics, 29, 920–
943. [139,140,141,142,144]
Huber, M., Lechner, M., and Mellace, G. (2014), “Why Do Tougher Caseworkers Increase Employment? The Role of Programme Assignment as a Causal
Mechanism,” Department of Economics Discussion Paper No. 2014-14,
University of St. Gallen. [140,146]

Huber, M., Lechner, M., and Wunsch, C. (2013), “The Performance of Estimators Based on the Propensity Score,” Journal of Econometrics, 175, 1–21.
[140,144,145,148]
Imai, K., Keele, L., and Tingley, D. (2010a), “A General Approach to Causal
Mediation Analysis,” Psychological Methods, 15, 309–334. [142,143]
Imai, K., Keele, L., and Yamamoto, T. (2010b), “Identification, Inference and
Sensitivity Analysis for Causal Mediation Effects,” Statistical Science, 25,
51–71. [140,141,142]
Imai, K., and Yamamoto, T. (2013), “Identification and Sensitivity Analysis for
Multiple Causal Mechanisms: Revisiting Evidence From Framing Experiments,” Political Analysis, 21, 141–171. [139]
Imbens, G. W. (2004), “Nonparametric Estimation of Average Treatment Effects
Under Exogeneity: A Review,” Review of Economics and Statistics, 86, 4–
29. [141]
Kang, J. D. Y., and Schafer, J. L. (2007), “Demystifying Double Robustness: A Comparison of Alternative Strategies for Estimating a
Population Mean From Incomplete Data,” Statistical Science, 22,
523–539. [144]
Khan, S., and Tamer, E. (2010), “Irregular Identification, Support Conditions, and Inverse Weight Estimation,” Econometrica, 78, 2021–2042.
[144,148]
Khuri, A. I., and Mukhopadhyay, S. (2010), “Response Surface Methodology,” Wiley Interdisciplinary Reviews: Computational Statistics, 2,
128–149. [149]
LaLonde, R. (1986), “Evaluating the Econometric Evaluations of Training Programs With Experimental Data,” American Economic Review, 76, 604–620.
[140]
Lechner, M., and Wunsch, C. (2013), “Sensitivity of Matching-Based Program
Evaluations to the Availability of Control Variables,” Labour Economics,
21, 111–121. [147]
Lunceford, J. K., and Davidian, M. (2004), “Stratification and Weighting via the
Propensity Score in Estimation of Causal Treatment Effects: A Comparative
Study,” Statistics in Medicine, 23, 2937–2960. [140]
Myers, R. H., Khuri, A. I., and Carter, W. H., Jr, (1989), “Response Surface
Methodology: 1966-1988,” Technometrics, 31, 137–157. [149]
Nargelkerke, N. J. D. (1991), “A Note on a General Definition of the Coefficient
of Determination,” Biometrika, 78, 691–692. [148]
Newey, W. K. (1984), “A Method of Moments Interpretation of Sequential
Estimators,” Economics Letters, 14, 201–206. [144]
Pearl, J. (2001), “Direct and Indirect Effects,” in Proceedings of the Seventeenth
Conference on Uncertainty in Artificial Intelligence, San Francisco, CA:
Morgan Kaufman, pp. 411–420. [140,141,142]
Robins, J. M. (1986), “A New Approach to Causal Inference in Mortality
Studies With Sustained Exposure Periods: Application to Control of the
Healthy Worker Survivor Effect,” Mathematical Modelling, 7, 1393–1512.
[140,142,143]
——— (2003), “Semantics of Causal DAG Models and the Identification of
Direct and Indirect Effects,” in Highly Structured Stochastic Systems, eds.
P. Green, N. Hjort, and S. Richardson, Oxford: Oxford University Press, pp.
70–81. [139,141,142]
Robins, J. M., and Greenland, S. (1992), “Identifiability and Exchangeability
for Direct and Indirect Effects,” Epidemiology, 3, 143–155. [141]
Rubin, D. B. (1974), “Estimating Causal Effects of Treatments in Randomized
and Nonrandomized Studies,” Journal of Educational Psychology, 66, 688–
701. [141]
——— (2004), “Direct and Indirect Causal Effects via Potential Outcomes,”
Scandinavian Journal of Statistics, 31, 161–170. [141]
Tchetgen Tchetgen, E. J., and Shpitser, I. (2012), “Semiparametric Theory for Causal Mediation Analysis: Efficiency Bounds, Multiple Robustness, and Sensitivity Analysis,” The Annals of Statistics, 40, 1816–1845.
[140,141,142,144,145]
Ten Have, T. R., Joffe, M. M., Lynch, K. G., Brown, G. K., Maisto, S. A.,
and Beck, A. T. (2007), “Causal Mediation Analyses With Rank Preserving
Models,” Biometrics, 63, 926–934. [141]
Tingley, D., Yamamoto, T., Hirose, K., Imai, K., and Keele, L. (2014), “Mediation: R Package for Causal Mediation Analysis,” Journal of Statistical
Software, 59, 1–38. [140,142,143,144]
van der Laan, M., and Rubin, D. (2006), “Targeted Maximum Likelihood Learning,” International Journal of Biostatistics, 2, Article 11. [145]
Waernbaum, I. (2012), “Model Misspecification and Robustness in Causal Inference: Comparing Matching With Doubly Robust Estimation,” Statistics
in Medicine, 31, 1572–1581. [144]
Zhao, Z. (2004), “Using Matching to Estimate Treatment Effects: Data Requirements, Matching Metrics, and Monte Carlo Evidence,” Review of Economics
and Statistics, 86, 91–107. [140]
Zheng, W., and van der Laan, M. J. (2012), “Targeted Maximum Likelihood
Estimation of Natural Direct Effects,” International Journal of Biostatistics,
8, 1–40. [140,142,143,144,145]

