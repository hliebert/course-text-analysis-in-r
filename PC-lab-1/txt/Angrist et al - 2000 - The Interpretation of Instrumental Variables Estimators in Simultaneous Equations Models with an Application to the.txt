The Interpretation of Instrumental Variables Estimators in Simultaneous Equations Models
with an Application to the Demand for Fish
Author(s): Joshua D. Angrist, Kathryn Graddy and Guido W. Imbens
Source: The Review of Economic Studies, Vol. 67, No. 3 (Jul., 2000), pp. 499-527
Published by: Oxford University Press
Stable URL: https://www.jstor.org/stable/2566964
Accessed: 08-10-2019 15:42 UTC
JSTOR is a not-for-profit service that helps scholars, researchers, and students discover, use, and build upon a wide
range of content in a trusted digital archive. We use information technology and tools to increase productivity and
facilitate new forms of scholarship. For more information about JSTOR, please contact support@jstor.org.
Your use of the JSTOR archive indicates your acceptance of the Terms & Conditions of Use, available at
https://about.jstor.org/terms

Oxford University Press is collaborating with JSTOR to digitize, preserve and extend access
to The Review of Economic Studies

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

Review of Economic Studies (2000) 67, 499-527 0034-6527/00/0000000$02.00

? 2000 The Review of Economic Studies Limited

The Interpretation of
Instrumental Variables
Estimators in Simultaneous
Equations Models with
an Application to the
Demand for Fish
JOSHUA D. ANGRIST
MIT and NBER

KATHRYN GRADDY

Exeter College, Oxford
and
GUIDO W. IMBENS
UCLA and NBER
First version received August 1997; final version accepted September 1999 (Eds.)

In markets where prices are determined by the intersection of supply and demand curves,
standard identification results require the presence of instruments that shift one curve but not the
other. These results are typically presented in the context of linear models with fixed coefficients
and additive residuals. The first contribution of this paper is an investigation of the consequences
of relaxing both the linearity and the additivity assumption for the interpretation of linear instrumental variables estimators. Without these assumptions, the standard linear instrumental variables
estimator identifies a weighted average of the derivative of the behavioural relationship of interest.
A second contribution is the formulation of critical identifying assumptions in terms of demand
and supply at different prices and instruments, rather than in terms of functional-form specific
residuals. Our approach to the simultaneous equations problem and the average-derivative
interpretation of instrumental variables estimates is illustrated by estimating the demand for fresh
whiting at the Fulton fish market. Strong and credible instruments for identification of this demand
function are available in the form of weather conditions at sea.

1. INTRODUCTION

Economists' interests in the analysis of competitive markets led to the development of
statistical models for simultaneous equations. The results of this research programme,
starting with Tinbergen (1930) and Haavelmo (1943), are now part of all econometric

textbooks (e.g. Amemiya (1985), Goldberger (1991), Davidson and MacKinnon (1993))
see Hendry and Morgan (1997) for a historical perspective. In markets where prices are

determined by the intersection of supply and demand curves, neither function can be
499

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

500 REVIEW OF ECONOMIC STUDIES
consistently estimated by comparing average quantities traded at different values of
observed (equilibrium) prices. Identification requires the presence of separate instruments

that shift either demand or supply but not both. These results are typically presented in
the context of linear models with fixed coefficients and additive residuals. Attempting to
relax the assumptions that have no firm grounding in economic theory (i.e. linearity,

additivity), researchers have considered identification in more general models. For
example, Roehrig (1988) and Newey, Powell and Vella (1999) show that full identification
requires the presence of continuously valued instruments. Even in this literature, however,

additivity of residuals has typically been maintained.'
The first contribution of this paper is an investigation of the consequences of relaxing

linearity and additivity assumptions for the interpretation of Instrumental Variables (IV)

estimators. We show that standard IV methods estimate a weighted average of the derivative of the behavioural relationship of interest. In addition, we show that different instruments lead to different weighted average derivatives. We discuss how the choice of
instruments can be governed by beliefs concerning the linearity and homogeneity of

behavioural relationships, and the extent to which data can be used to guide the choice
of instruments.

A second contribution is the formulation of critical assumptions underlying identifi-

cation of heterogenous, time-varying demand functions in terms of potential demand and

supply at different values of prices and instruments. This contrasts with most of the literature on simultaneous equations models, which casts critical assumptions in terms of unobservable functional-form-specific residuals. Our approach is similar to the potential
outcome approach to evaluation questions originating in the statistical literature on causality (Rubin (1974, 1978), Holland (1986)) and builds on our earlier work on instrumental
variables (Imbens and Angrist (1994), Angrist and Imbens (1995), Angrist, Imbens and
Rubin (1996), and Imbens and Rubin (1997a, b)).

The theoretical ideas in the paper are illustrated in a re-analysis of wholesale demand

for fresh whiting at the Fulton fish market in New York City, using data collected by
Graddy (1995). This application is useful for our purposes because strong and credible
instruments for identification of the demand function are available in the form of weather

conditions at sea. The quantity of fish brought to market is determined by many factors,
but the weather is an important determinant of supply since strong winds and high waves

make it difficult to catch fish. At the same time, it is unlikely that weather conditions at
sea affect the demand for fish.

2. THE MODEL

2.1. Demand and supply functions

In each of T markets, indexed by t = 1, . . ., T, we postulate the existence of a demand

and supply function, q d(p, z) and qt(p, z). These functions describe the quantities th
would be demanded and supplied in market t for all possible prices p and for all possible
values of a generic instrument z. Initially we take z to be binary. With no essential loss of
generality we could write demand and supply in market t as a common function of prices,

instruments and stochastic, market-specific residuals Ed and e', such that
1. Exceptions are Manski (1995, 1997) who investigates bounds on average demand and supply functions
without functional form and additivity assumptions, and Pearl (1994) who uses graphical methods akin to path
analysis.

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

ANGRIST ET AL. SIMULTANEOUS EQUATIONS MODELS 501

tq'(p, z) = qd(p, z, t) and qt(p, z) = qS(p, z, e). In Section 4 w
resentation to make connections to the literature on conventional linear and non-linear

simultaneous equations models. This representation is not used initially becase until the
residuals are defined explicitly in terms of observable quantities, it is difficult to judge the
plausibility of assumptions concerning their properties.
Demand or supply functions for any market are not observed. Rather, we observe

quantities traded, and realized values for prices and instruments. Market clearing is
assumed to determine which prices and quantities would be observed for any value of the
instrument. Let p'(z) be the equilibrium price as a function of the instrument, implicitly
defined by the market clearing condition equating demand and supply
q'(pe(z),

z)

=

qt(p'(z),

z).

(1)

Also define

qe(z) =q'(pe(z), z) = qt (pt(z), z), (2)
to be the equilibrium quantity as a function of the instrument. We assume that for all z
the equilibrium price and quantities exist and are unique in each market.

We observe the quadruple (zt, p', q', xt), where zt is the value of the instrument,

ptept(Zt) is the equilibrium price at the realized value of the instrument, qt=qt(zt) is the
quantity traded, and xt is a vector of covariates. The covariates describe characteristics of
markets that affect both supply and demand, as well as additional instruments. The

covariates are included for two reasons. First, and most importantly, the assumptions
underlying identification of demand and supply functions may be more plausible after

conditioning on covariates. Second, covariates can make inference more precise.
The demand and supply functions are assumed to satisfy regularity conditions such

as continuous differentiability in prices, but are otherwise unrestricted. Specifically the

demand and supply functions are allowed to change freely from one market to the next
according to some stochastic process. We assume their expected values or population

averages, at fixed prices and instruments and conditional *n covariates, are well defined

qd(p, z| x) E[qt(p, z) xt = X],
and

qS(p, z x) E [qt (p , Z) Xt = X].
We also assume that these population averages are consistently estimable by averaging
the demand and supply function at specific values for the prices and instruments over all
markets with identical values of the covariates. Similarly, population-average equilibrium
price and quantity functions are defined as

pe(z |x)-E[pt(Z) IXt =x],
and

qe(z x) _E[q'(z)Ixt =x]In our application, q d(p, Z) may be, for example, the demand function on Monday
December 6th, defined for all prices and weather conditions. One of the covariates in the

application is the day of the week. The average demand function, qd(p, z x) may be the
average demand function as a function of prices and weather conditions, averaged over
all Mondays.

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

502 REVIEW OF ECONOMIC STUDIES

2.2. Instrumental variables assumptions

We begin by laying out the assumptions regarding the relationship between the instruments and the heterogeneous and time-varying demand and supply functions. The first
assumption is:

Assumption 1. (Independence).
zt it { (qt (P ) t ( P, Z) } P z I Xt -

(Throughout the paper A 1I B denotes independence of A and B, and A 11 B I C den
conditional independence of A and B given C.) Assumption 1 means that the demand

function evaluated at p and z should be independent of the instrument zt. In our application, this amounts to assuming that although buyers and sellers come to the market

with a demand and supply function that may depend on the weather and prices, the
quantity demanded over the range of possible prices and weather conditions is independent of the value of the weather conditions actually realized. In other words, the weather

is as good as randomly assigned given covariates.

An implication of this assumption is that
zt H pt (z), qt (z)} xt,

for all z. Because the potential values of the equilibrium price p'(z) are independent of the

realized value of the instrument zt, the reduced form regression, that is, the average value
of the equilibrium price as a function of instrument and covariates, can be estimated by

averaging over markets with zt = z and xt = x:

pe(zIx) = E[p'(z)Ixt = x] = E[p'(z)Izt = z, xt = x] = E[pljzt = z, xt = x].
Here the first and third equality are by definition and the second by Assumption 1. A
similar result holds for equilibrium quantities:

qe(zIx) = E[q'(z)Ixt = x] = E[q'(z)Izt = z, xt = x] = E[q zt=z, x= x].
From this point on, we focus on the identification of the demand function. The

argument for identification of the supply function is analogous. As in linear simultaneous
equations models, a key identifying assumption is an exclusion restriction:
Assumption 2. (Exclusion).

qd(P, Z) = qd(P, Z'),
for all p, z, z', and t.

This assumption requires that, at any given price, there be no effect of the instrument

on demand.2 Given this assumption we can drop the instrument as argument in the

demand function and define qd(p I x) qd(p z x X) for all z.
2. A weaker version of this assumption, similar to the exclusion restrictions used in Hirano, Imbens, Rubin
and Zhou (1999), requires that

4t (p, Z') IL zt I xt, Pt (z),
for all p and z. This version of the exclusion restriction highlights the fact that in models with covariates only
conditional distributions need to be identical. For clarity of exposition, however, we use the stronger version of
the exclusion assumption.

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

ANGRIST ET AL. SIMULTANEOUS EQUATIONS MODELS 503
The next assumption requires the instrument to impact upon prices.
Assumption 3. (Nonzero effect of instruments on prices).
for some x, pe(z x) is a non-trivial function of z.

This guarantees that average prices in markets with instrument zt = 0 and covariates
xt = x differ from average prices in markets with instrument zt = 1 and covariates xt =
at least for some values of x. Because the instrument does not shift demand by virtue of
Assumption 2, any change in equilibrium prices must come from an effect of the instrument on the supply function.

The final assumption requires monotonicity of the equilibrium price in the
instruments.

Assumption 4. (Monotonicity).
For all pairs (z, z') either

Pr (p'(z)?p'(Z')Ixt) = 1,
or

Pr (p'(z)?'-p'(z')Ixt) = 1.
Without this condition the weights in our weighted average derivative representation
of the instrumental variables estimand can be negative. In the standard linear model,
monotonicity is a consequence of the constant-coefficients assumption. More generally,
monotonicity requires that if for at least one market changing the instrument from z = 0

to z = 1 increases the equilibrium price, then this change does not decrease the equilibrium
price for any other market.

Assumption 4 casts monotonicity in terms of the reduced form relationship between
prices and instruments. A version of this assumption based on the underlying structural
relationships is given in the following result.
Lemma 1. If in all markets t,

(i) demandfunctions q d(p) are decreasing in prices, and do not depend on the instrument z,

(ii) supply functions qt (p, z) are increasing in prices, and
(iii) for all prices

q't (p, 1):_-(--)q(p, 0)9
then the monotonicity assumption is satisfied, and

Proof. See Appendix. I
Upward-sloping supply and downward-sloping demand functions are assumed in
most economic discussions of demand and supply. Manski (1995, 1997) considers the

implications of these assumptions in his analysis of bounds on demand and supply
functions.

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

504 REVIEW OF ECONOMIC STUDIES

Although the assumptions of upward-sloping supply and downward-sloping demand

are common, the third requirement in Lemma 1 is less often made explicit. In our application this assumption requires that on any given day, and for any price p, supply does
not increase when the weather gets worse. Note that supply need not actually decrease in

every market and at every price, as long as it decreases when the weather gets worse in
some markets for some prices, as required by Assumption 3. However, we rule out a
scenario with markets in which supply is high because the weather is bad.

3. MAIN RESULTS

3.1. Identification of average derivatives of demand functions
Next, we use Assumptions 1-4 to interpret differences in average quantities and prices at
different values of the instruments. The following theorem presents the main result.
Theorem 1. Suppose Assumptions 1-4 hold. Then the Instrumental Variables (IV)

estimand, defined as the ratio of the difference in average quantities traded at two values of
the supply instrument to the difference in average prices at the same two values of the supply
instrument,
e (1 x) - q(Ox)

f3(x p I( x) pe(O IX)'
equals the following weighted average of the derivative of the demand function:

fE*(x) = E'(p) p(l)'pp0t(O), xt = px)dp,
where the weights
-Pr (p'(0) < p <p'(1) Ixt x)

oi(p I x) =f Pr (p'(0) <r <p'(1) I xt x)dr'
are nonnegative and integrate to one.

Proof. See Appendix. I
The result is stated for a given value of the covariates. In practice, it may not be

feasible to estimate separate slopes for all values of the covariates and one may wish to
average over the covariates. We return to this point in Section 3.5.
Theorem 1 describes the two types of averaging that characterize the instrumental
variables estimand in simultaneous equations models. First, there is averaging over some

of the markets at a given price. For any price p, only those markets whose equilibrium
prices p'(0) and p'(1) bracket this price p enter into the expectation. The implication is
that the more powerful an instrument is, the more markets will have equilibrium prices
bracketing any given price (as reflected in the larger conditioning set

{tlp'(0) <p <p'(1)}) and the more representative the IV estimand will

demand function at p. Second, there is averaging over different prices in the same market.

Averaging over different prices is reflected in the weighting function ( ). The weight
given to any particular price is proportional to the number of markets whose equilibrium
prices bracket this price.

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

ANGRIST ET AL. SIMULTANEOUS EQUATIONS MODELS 505
Because of the monotonicity condition, the weight function can be written as

Pr (p <p'(1) xt = x) -Pr (p <p'(0) xt = x)

w(Op
(PI

o

Ix)

[Pr

=

(r

-

<p'

(1)

lxt

=

Note that

Pr (p <p'(1) I xt = x) -Pr (p <pe(O) I xt = x)
= Pr (p <pe IXt = x, Zt = 1) -Pr (p <Pe IXt = x,zt = 0),
and hence the numerator of the weight function can be estimated as the difference in the

empirical distribution functions of pe evaluated at p for all markets with zt = 1 and zt = 0
An important aspect of Theorem 1 is that it does not require additive residuals, and
is therefore not tied to a specific functional form. To illustrate this point, consider the

corresponding result in logarithms. Let qe(Z I x) = E[ln q e(z) I xt = x
pe(z I X) = E[lnpe(z) xt = x]. Then we have.
Corollary 1. Suppose Assumptions 1-4 hold. The Instrumental Variables (IV) estimand in logarithms,

qe(1 x) -qe(0 Z)

(x) = pe(1 X) _Pe(o X)
equals:

/3(x) = { Eq{P) aqt ( ) |pe(l)?P ?pe(O), Xt = Xl Cd(pX)dp,
a weighted average of the demand elasticity, where

Ci)jd(px | 1X) = D/pPr ((e(l) p pe(O) I Xt x)
f~ hOlr -Pr ( pe(1) r ?pe(0)~ I=X x)dr'
Proof. See Appendix.

Of course, if the demand elasticity is constant across price levels, so the logarithm of

the market-specific demand function, ln q 'd(p zt), is linear in log prices with constant coef
ficients, then the IV estimand is equal to this constant elasticity.
The results in Theorem 1 and Corollary 1 provide a clear causal interpretation for
the standard linear instrumental variables estimator using a binary instrument. Another

important issue is whether it is possible to identify other aspects of the average demand

function, or its derivative, under Assumptions 1-4. Let the demand function in market t

be qd(p), with equilibrium price function pe(Z)). Note that the derivative of the deman
function in market t appears in the weighted average, /3*, only for values of p such that

Pt(0) -P -?(1)- Now, suppose we change the demand functions from qt'(p z) to
qtd(p, Z) such that

d ( )|=#t ( p,z) Pt (? =P=C t()

I z qd(P, Z) pe(O) >p p >pe(l),

without changing the supply functions. The old equilibrium price functions ple(Z) still clear
markets, and therefore if equilibrium prices are unique, the new equilibrium price

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

506 REVIEW OF ECONOMIC STUDIES

functions Pf(z) are identical to the old equilibr
and p, and hence equilibrium quantity functio
t and p.

20 -

15 I

10

5-

0

0

2

4

6

8

10

12

14

16

18

20

price
FIGURE 1

Changing demand functions outside the range of equilibrium prices

Figure 1 illustrates this point in a simple example with deterministic demand and

supply functions where the only stochastic component comes from the instrument. The

supply function is qt (p, z) = p + 4 z. The first demand function is qd'p) = 20 -p. In per
iods where zt = 0, the equilibrium price is 8 and the equilibrium quantity is 12. In period
where zt = 1, the equilibrium price is 10 and the equilibrium quantity is 10. The alternative
demand function is

24-3p p8,

t4(p)= t 20-p 8<p< 10,
t15 -2 p_: I11.
Between the equilibrium prices the two demand functions are identical, and therefore the
equilibrium prices and quantities for any value of the instrument are identical, so there
are no observable implications of the differences between the two demand functions.
In general, changing the demand function outside the range of equilibrium prices

leaves equilibrium prices unchanged. Hence the joint distribution of instruments, equilib-

rium prices and quantities is not affected by the change from qtd(p) to q4d(p). The new
distribution of demand functions is therefore observationally equivalent to the old distribution, and differences between them are not identified. Therefore, we cannot identify
average derivatives of the demand function that depend on derivatives at prices not

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

ANGRIST ET AL. SIMULTANEOUS EQUATIONS MODELS 507

included in the conditioning set in Theorem 1, that is, prices such that p <p'(O) or
p >pt(l).
3.2. Illustrating the two types of averaging

This section uses two examples to illustrate the role played by nonlinearity and nonaddi-

tivity in determining the nature of the IV estimand under Theorem 1. In particular, we
discuss how ,B*(x) is related to the population average demand function and its derivative.
For ease of exposition, we assume there are no covariates.
First, suppose that demand and supply are linear in prices and instruments but with

time-varying coefficients. As noted by Stoker (1993), such a model could arise as the
consequence of aggregating linear demand functions that differ across groups in the
population.3 Changes in the average demand slope over time would then be attributable

to changes in the distribution of the characteristics of buyers coming to market.
Corollary 2. Suppose that Assumptions 1-4 hold, and that
qd(p)= pto0+ ptl P,

q't(p, z) = ato + t? p + ?at2 ZThen

_ E[f3tj (p'(1) -p'(O))] Cov (Pt,, -at2/(at1 - Pt,))
E[p* (1)- p'(0)] Et-at2_at Ef-]

Proof. See Appendix.
In general, the IV estimand does not equal the slope of the average demand curve,

E[f3tl]. Periods when p'(l) -p'(O) is large get more weight in ,B* than in E[f3tI].

If we assume that the supply function has constant coefficients, that is, at, = a1

at2 = a2 > 0, then the covariance Cov (Pt,, -at2/(at, - Pt,)) is positive, and the IV

and ,B* is closer to zero than E[I3tj]. The intuition for this result is that when Pt, is

in absolute value (demand is elastic), the price gap p'(l) -p'(O) = -a2/(a1 - Plt), which
weights each derivative, is small.
Now, suppose that demand is given by a non-linear relationship, with the only source
of time-variation coming from an additive error term (as in, Roehrig (1988), Newey,
Powell, and Vella (1999)).

Corollary 3. Suppose Assumptions 1-4 hold and the demand function can be written
as

qd( p) = qd(p) + 'd
Then

* = {D qd(p) * (p)dp,
3. For example, the results in Graddy (1996) suggest that Asian and white buyers at the Fulton fish market
have different demand elasticities.

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

508 REVIEW OF ECONOMIC STUDIES
with weights

Pr (p'(0) <p <p'(1))

= fo Pr (p'(0) < r < p'(1))dr
Proofs. See Appendix. 11

Thus, when the demand function can be written as invariant across periods except

for an additive residual, ,B* is a weighted average of the slope of the average demand

function, aqd(p)/lp. In this case, the slope of the demand function at a specific p
involves no averaging because afqd(p)/lp = aqd( p)/lp at all prices p and for all mark
and s. The weights reflect how likely the instruments are to shift the equilibrium price
from below p to at least p.

3.3. Choosing between two binary instruments

Both types of averaging in Theorem 1 are specific to the instrument,. Two binary instruments can generate different ,B*s, either because the demand function is nonlinear, or
because there is heterogeneity in the slopes of the market-specific demand functions. When

studying a specific policy question, one instrument may therefore be more valuable than
another, even if both are valid in the sense of satisfying Assumptions 1-4. We illustrate
this point here using a stylized example, focusing on estimation of a demand function

with no covariates, using a single instrument that takes on three values. In Section 6 we
apply these ideas to the Fulton fish market data.
Wholesale fish markets, like agricultural markets, are sometimes regulated, in which
case a researcher may be interested in the difference in average demand at different prices.

Consider comparing p = 3 versus p = 2, or B* =_ qd(3) - qd(2). As in our empirical example,
the researcher has a single instrument zt (say, weather conditions) that takes on three

values, zt e {f, m, s } (fair, mixed, and stormy). Finally, suppose that in all markets the f
weather equilibrium price is pe(f) = 1, the mixed weather equilibrium price is pe(m) = 2, in

half the stormy weather equilibrium price is pe(S) = 2 and in the other half the stormy
weather equilibrium price is pe(S) = 3. The average equilibrium prices are therefore
pe(f) = 1 pe(m) = 2, and pe(S) = 2 x 1/2 + 3 x 1/2 = 5/2.
The researcher has a number of options in this case. First, she could use only the
observations with fair or mixed weather. Based on Theorem 1, the binary instrument
making a fair/mixed contrast estimates

pf/M - q e(m) - qe(f) = E[qd'(2)-q(1)] = q d(2) qd(l)

pe(M) _pe(f) E[t()-q 2

Alternatively, the researcher could decide to use only the mixed/stormy weather data.
The resulting instrumental variables estimand is

m/s q(S) - qe(m) = E[q d(3) - qd(2) lpe(S) = 3].

pe(S) _pe(M)

The unnormalized weight functions for these two strategies are shown in Figure 2 (solid
line for the weight function or pf/m and dashed line for J3m/S). For pf/m the unnormalized
weight function is

Pr (pe(f) p) -Pr (pe(m)?p) = 1 for 1 'p'2

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

ANGRIST ET AL. SIMULTANEOUS EQUATIONS MODELS 509

1.2

1.2

'D0.8-

O 0.6 -

C
C

0.4-

0.2-

ad0 otewie -hl -o - it is -qa -to
0

0.5

1

1.5

2

2.5

3

3.5

4

Price
FIGURE 2

Weight function (artificial example)

and 0 otherwise, while for pmm/sjt is equal to
Pr (p'(m)?--p) -Pr (p'(s) -:::p) = 1/2 for 2p?3,

and 0 otherwise. These differences in distribution functions can be estimated by the differences in the corresponding empirical distribution functions for the subpopulations with
the instrument equal to fair, mixed and stormy respectively.

If the demand function is linear in each market, that is, if qt'(p) = I3to + Pt, * p for all
markets t, with possibly market-specific coefficients pot and Olt, it follows that

pf/rn - E[qt'(2) -q '(1)] = E[ ] t E[qt'(3) qd(2)] - *
and the first strategy identifies the price effect of interest ,B*, though J3m/S would not
necessarily do so. If, on the other hand, the demand function is identical in each market

up to an additive shift Ed, or q d(p) = qd(p) + 8td, then
tm/S - E[qtd(3) - qd(2) jp'(s) = 3]

= E[qd(3) + t - qd(2) -_ d] = qd(3) - qd(2) = B*,
and the second strategy identifies the price effect of interest. If demand functions are

characterized by additive shifts as well as linearity in prices then both approaches identify
the same price effect, ,B*.
If demand functions are neither linear nor additive, the researcher must choose

between Pf/m, which is a population average derivative but at the wrong prices, and pm

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

510 REVIEW OF ECONOMIC STUDIES

which is the average derivative at the right prices but averaged only over a subset of the
population of interest. Alternatively some combination of these estimates might be used.
Two pieces of information are available to inform this decision. First, the difference

between estimates based on different valid instruments is informative about the amount
of nonlinearity and heterogeneity in demand functions. It would therefore be useful to

know that the alternative IV estimates are close. Second, as in the above example, the

weight functions are informative about the range that each IV estimator covers.
One implication of this discussion concerns the interpretation of over-identification
tests for the validity of instruments. Such tests typically rely on comparisons of estimates
based on different sets of instruments (e.g. Hausmann (1978)). In the current setting these

tests could be performed by comparing pf/m and J3m/S. Traditionally, significant differenc
have been interpreted as evidence of violations of the instrumental variables assumptions,

that is, of the independence or exclusion assumptions. This discussion suggests that differ-

ences between pf/m and pm/s can also arise from non-linearities and heterogeneity in
demand function, even when all instruments are valid.

3.4. Multiple instruments and two-stage-least-squares
The example above involved a comparison between estimands each based on a single

binary instrument. Often researchers use multi-valued or multiple instruments, combined
in a two-stage-least-squares procedure. In the first stage of two-stage-least-squares esti-

mation a single instrument is constructed based on the projection of the endogenous
regressor (price in our application) on a set of instruments. In the second stage, the instru-

mental variables estimator is obtained as the ratio of the covariance of the dependent
variable and the constructed instrument to the covariance of the endogenous regressor
and the single constructed instrument. In this section we explore the interpretation of such
procedures in the framework developed in this paper. Multiple, or multivalued, instru-

ments add an additional layer of averaging. In addition to averaging over markets and
prices, we now average over instruments. For ease of exposition covariates are ignored in
this section.

We start by considering the case with discrete instruments. In that case the number of
instruments is immaterial only the number of distinct values of the vector of instruments

matters. Let {zo, .. ., zK} denote the set of possible values for the instruments. We assume
that Assumptions 1-4 hold for all pairs (zk, Z'). Without loss of generality, let the points
of support be ordered by the value of the expected equilibrium price, that is

pe(zk) ?pe(zk+ 1) for all k. Define the IV estimand for each pair of instrument values

pzkzl q e(zk) - qe(Zl)
pe(Zk) _pe(Zl)-

This instrumental variables estimand can still be interpreted using Theorem 1.

Corollary 4. Suppose Assumptions 1-4 hold for the pair of instrument values (Zk, z')
with pe(zk) 'pe(zt). Then

zk'zl = ELqt (p, zt) pe(Zk) p Cp-P(Z')1. *o(p)dp, (3)

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

ANGRIST ET AL. SIMULTANEOUS EQUATIONS MODELS 511
with non-negative weights

Pr (p (z') Cp pt(zk))

(p Pr (p'(zl)'r-p(z ))dr
that integrate to one.

Proof. See Appendix. jj
Now consider the instrumental variables estimator based on the ratio of the covari-

ance of equilibrium quantities and some function g() of the instruments, to the covariance of equilibrium prices and the same function g( ) of the instruments:
p Coy (qe, g(Zt))

Cov (pe, g(Zt))(
The function g( ) may be based on a first stage regression of prices on a set of instruments,
or any other function of the instruments. Estimation of g( ) does not affect the probability
limit of the estimator, although it may affect its distribution. The following theorem gives
an interpretation for pg in nonlinear, heterogenous models.
Theorem 2. Suppose Assumptions 1-4 holdfor all pairs of instruments (Zk, z). Then
p = 1 Xk /3z
with

K (pe(Zk) _pe(Zk-1)). * l fz(z) (g(z') -E[g(zt)])
where fz (z) is the probability mass function of the instrument.

Proof. See Appendix. II
The weights in this case, 4k, are non-negative as long as ordering the instruments by
expected equilibrium price simultaneously orders the instruments by the value of g(z).
This happens, for example, if g(z) = pe(Z). Note also that the weights are proportional to
the first stage impact on prices at each successive contrast.

We have worked with discrete instruments so far. Now let demand, supply, equilibrium price and quantity functions and their expectations be continuously differentiable in
a continuous, scalar, instrument z. In this case, monotonicity requires that the derivative
of equilibrium price functions with respect to the instruments, at any value of the instrument, be either non-negative or non-positive for all markets. Define the limit of the binary
instrumental variables estimands as follows

/3(z) = limf3,z +dz.
dzJ-O

Theorem 3. Suppose Assumptions 1-4 hold for all pairs of values of the instrument.
Then

P(zP = Eraofpepe x).j

Proof. See Appendix. I

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

512 REVIEW OF ECONOMIC STUDIES
Now consider the ratio of the covariance of equilibrium quantities and some function

of a continuous instrument to the covariance of equilibrium prices and the same function
of the instrument, as in equation (4). The following theorem provides an interpretation
for this estimand.

Theorem 4. Suppose Assumptions 1-4 hold for all pairs of values of the instrument.
Then

p~-Coy (q', g(zt))
Cov (Pt, g(zt)) = f3(z) X(z)dz,
with weight function

- (z) J (g( y) - E[g(zt)]) fz( y)dy

J aP (v) J (g(y)-E[g(zt)] fz(y)dydv
Proof. See Appendix.

Again, the weights A(z) in this result are non-negative if g(z) is equal to the expected
value of the price given the instrument. In the standard linear simultaneous equations
model the choice of g( ) is usually determined by efficiency considerations, since different
choices of g( ) in that context all estimate the same quantity. Here different choices of
g(*) correspond to different estimands.

3.5. Estimation with covariates

One simple approach to controlling for covariates is to carry out the. analysis separately

for all values of the covariates and then report averages using the marginal or some
conditional distribution of the covariates. With a small sample and detailed covariates

such an approach is unlikely to be satisfactory. We therefore incorporate covariates by
assuming that they enter the average equilibrium price and quantity functions additively
and linearly.

Assumption 5. The average equilibrium price and quantity are linear and additive
in covariates.

pe(z x) = pe(Z) + yp x

qe(z x)= qe(z) + q X.
This assumption can be used to justify standard estimation procedures where in a
first stage the endogenous regressor (price in this case) is regressed on the instrument and
covariates, and in the second stage the outcome (quantity in this case) is regressed on the
predicted price and covariates.

Lemma 2. Suppose Assumptions 1-5 hold. Then the ratio of the expected value of the

instrument coefficient from a linear regression of the quantity on the instrument and

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

ANGRIST ET AL. SIMULTANEOUS EQUATIONS MODELS 513

covariates to the expected value of the instrument coefficient from a linear regression of the
price on the instrument and covariates is equal to

E - ( dP IJ )- t !, X)dtJ

and does not depend on x.
Proof. See Appendix. II

The most natural way to motivate the additive linear structure in Assumption 5 is
through linearity and additivity assumptions on the market specific demand and supply
functions. In the application, we apply Assumption 5 to a model in logarithms.

4. ADDITIVITY AND LINEARITY IN TRADITIONAL SIMULTANEOUS
EQUATION MODELS

4.1. Additive residuals

This section explores the relationship between the approach in Sections 2 and 3 and standard simultaneous equations models (SEM), which present critical assumptions in terms

of observed variables and unobserved residuals. Our starting point is a set of unrestricted

demand and supply functions qd'(p, z) and q (p, z), allowed to vary freely across markets.
Alternatively, we could write qd(p, z; Et and q(p, z; et) and formulate assumptions in
terms of the properties of the residuals Ed and es as in the traditional SEM. This raises
the question of what exactly these residuals represent in our framework. Most discussions
of SEM assume an additive model for residuals.
Assumption 6. (Additive residuals).

qd(p, z)= qd(p, ZIXt) + Ed
qs (p, z) = q(p, z I xt) + Et,

at all prices p, instruments z and for all markets t, where Ed and es are defined as
Et _ qe - qd(pte z I xt), Et -qt t, ZtlXt)

By definition, the demand residual satisfies

qd'(p, Z) = qd(p, zIxt) + d

at (p, z) = (Pe, zt). The additivity assumption requires this equation to hold at all other
values of the instrument and prices as well. Additivity therefore restricts the cross-market

heterogeneity in demand and supply functions, implying that the slope of the average and
the market-specific demand functions are identical.
Given additive residuals, our independence assumption (Assumption 1) is equivalent
to the following textbook version:
Assumption 7. (Independence).

t) t # ztIxt.

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

514 REVIEW OF ECONOMIC STUDIES

Without additive residuals, however, the re
and E= - qs(p, ztl xt) do not necessarily have this property. Consider the following
example:

qs(p, z) = a0 + a1 p + a2*Z,
qd(P, Z)= pot+ p Pt p.
Let Pot and Plt be independent of zt with expectations Po and 31. Using the definition
above the two residuals are

? = 0,
and

d? p po+(pt p) ' Pe =pot-_ aoO( P a2

Et potPo PtP)PPt PO?+ Jlti
,
\flpit
- p1- /t-a
Unless PI3t - P/I = 0, this residual is not independent of zt.
The assumption of additive residuals is difficult to assess because it is closely tied to

functional form. Assumptions formulated in terms of residuals as defined above typically
do not remain valid after transforming the dependent variable. For example, if the model
is additive in levels, it cannot be additive in logarithms and vice versa. Roehrig (1988)
recognizes the importance of this issue, without providing any solutions: "For once one

is willing to recognize the nonlinearities of the real world, one must begin to question the
assumption of a simple additive error term that is distributed independently of the exogenous variables. This paper provides some definite answers under the assumption of such
an error term but does not address the validity of this assumption." (p. 447)
The assumption of additive residuals can sometimes be tested in our framework.

Consider a variation on the example in Section 3.3 where ze {f, m, s}, pt(f) = 1, p
and Pr (pe(m) = 1) = Pr (pe(m) = 2) = 1/2. Then

pf/m = qe(M) - q = E[q(2)-q (1) p(m) = 1]
pe(M) _pe(f) Eq 2 t(
and

m= qe(S) - q e(M) d Ed~() ~(l) Ipe(M)=2]
pe(s) pe(m)

Both instruments move half the markets from an equilibrium price equal to 1 to an equi-

librium price equal to 2. However, the markets they affect are different. With the fair/
mixed instrument the markets averaged in the estimand are those with pe(m) = 1, while
with the mixed/stormy instrument the markets averaged are those with pe(m) = 2. With
additive residuals, the conditioning set does not affect the estimand and the two estimands
are identical. Testing the equality of the estimates based on the different instruments can,
conditional on the validity of the instruments, be interpreted as a test of additivity.

4.2. Linear simultaneous equations models
A second component of the traditional framework is linearity.

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

ANGRIST ET AL. SIMULTANEOUS EQUATIONS MODELS 515
Assumption 8. (Linearity in prices and instruments).

qt'(P, Z) = ftO + ftl P + Pt2*Z
q't(p, z)= ato + at? p + at2 * ZA third commonly used assumption requires the effect of covariates to be additive
and linear in the structural equations.
Assumption 9. (Linearity and additivity in covariates).

qd(p, z lx) = q (p, z) + /33x
qS(p, zlx)= qo(p, z) + a3 * x,
An implication of linearity and additivity is summarized in the following lemma.
Lemma 3. Suppose Assumptions 6, 8, and 9 hold. Then the demand and supply equa-

tions have the form

q't(P, Z) =PO + PI 'P + P2 *Z + P3 * t+?t (5)
qt(p, z) = o+ ?a, *p + 2 *z +3 * Xt + Et. (6)

Proof. See Appendix. 11
The nonlinear models considered by Roehrig (1988) and Newey, Powell and Vella
(1994), relax the linearity assumptions (Assumptions 8 and 9) but maintain additivity of

residuals (Assumption 6).
How does the textbook model fit our framework? Maintaining the LSEM assump-

tions 8-9, the earlier assumptions 1-4 can be reformulated in the textbook form as
follows.
Assumption 10. (Exclusion). The coefficient on the instrument in the demand func-

tion, P2, equals zero.
Assumption 11. (Nonzero effect of instruments on prices). The coefficient on the
instrument in the supply function a2, differs from zero.
Lemma 4. (Equivalence)

(i) Given Assumption 6, Assumption 7 is equivalent to Assumption 1.
(ii) Given Assumptions 6, 8 and 9, Assumption 10 is equivalent to Assumption 2.

(iii) Given Assumptions 6, 8, 9 and 10, Assumption 11 is equivalent to Assumption 3.

(iv) Given Assumptions 6, 8 and 9, Assumption 4 is automatically satisfied.
Proof. See Appendix. ||

Note that in textbook discussions, Assumptions 7 and 10 are often combined in a

single assumption requiring that E?d be independent of zt in a demand function that al
omits the instrument as an argument.

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

516 REVIEW OF ECONOMIC STUDIES

5. THE DEMAND FOR WHITING AT THE FULTON FISH MARKET

5.1. The Fulton fish market
Fish is sold by about 35 different dealers at the Fulton fish market, although only six of
the dealers regularly sell whiting. There are no posted prices, and each dealer is free to

charge a different price to each customer. Dealers can leave the Fulton market and new
dealers can rent stalls, although in practice this happens rarely and did not happen over
the sample period. The buyers at the Fulton market generally own retail fish shops or
restaurants.

Whiting is a good choice for a study of the wholesale fish market because more

transactions take place in whiting than almost any other fish. Whiting also vary less in

size and quality than other fish. Finally, there is probably very little substitution between
whiting and other fish. Whiting is a very cheap fish in large supply that is oily and distinctive tasting. Other fish would rarely be sold at a low enough price and in sufficient quantities to be attractive to retailers or restaurants as a substitute for whiting.
The data used in Graddy (1995) were obtained from a single dealer who supplied his

inventory sheets for the period December 2nd, 1991 through May 8th, 1992. Total price

and quantity for each transaction are recorded on the inventory sheets. These data are
supplemented by data that were collected by direct observation from the same dealer
during the period April 13th through May 8th, 1992. For this study, the prices and quantities are aggregated by day, for the 111 days the market was open between December
2nd and May 8th. The price variable used below is the quantity-weighted average daily

transaction price for the dealer observed. The quantity variable is the total quantity sold
by this dealer on each day. Table 1 presents summary statistics for the data used in this
paper.

Every day the demand for fish at the Fulton fish market is determined partly by

which customers decide to visit the market that day, as well as by how much they buy. A
number of customers visit the market every week on Mondays and Thursdays, and other

customers may visit the market every day of the week. Quantities purchased by individual

TABLE 1

Summary statistics (111 Obs.)
Variable

mean

s.d.

min

max

log (average daily price) -0 19 0 38 -1 11 0 66
log (quantity) 8 52 0 74 6 19 9 98
Stormy 029 046 0 1
Mixed
0
31
0
46
0
1
Fair
0
41
0
49
0
1
Rainy on shore 0 16 0 37 0 1
Cold on shore 0.50 0 50 0 1
Monday 0 19 0-39 0 1
Tuesday 0.21 0 41 0 1
Wednesday 0.19 0 39 0 1
Thursday 0.21 0 41 0 1
log (minimum daily price) -0 57 0-53 -2 30 0 41
log (maximum daily price) 0 06 0 31 -0 51 0 92
log (median daily price) -0 20 0 41 -1 39 0-69
Daily price range 0 48 0 28 0 00 2.00
Notes: Prices and quantities are daily observations for whiting at the Fulton fish market. Prices are dollars per pound and quantities are pounds
per day.

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

ANGRIST ET AL. SIMULTANEOUS EQUATIONS MODELS 517

wholesale customers with potentially different demand functions are aggregated to produce the daily aggregate demand for fish. Aggregation is therefore one source of shifts in
potential demand over time. For example, Graddy (1995) presents evidence which suggests
that Asian buyers have a more elastic demand for fish than Whites and that the ethnic

mix of buyers changes from day to day.
We begin our analysis with a demand function for the quantity demanded by customer c on day t
qtc( p).

The subscript c ranges over the list of customers who ever visited the Fulton fish market
during our sample period (c = 1, . . ., C). The total demand for market t is

qtd(p) = 1C I q d (p).
There are two complications in applying the methods discussed in this paper to the fish

market data. First, not all buyers pay the same price per pound of whiting. We ignore

this complication and assume that all buyers on the same day pay the same price pt,
constructed as the average of the individual transaction prices weighted by the quantities
traded

P = Xc= tPcc /= 1C tc
Second, we only have data for one of the dealers. We assume that this dealer has a
constant share of the market, so we can analyse his quantities as if they were market

quantities.

5.2. Reduced-form estimates
Tables 2 and 3 report reduced-form estimates of the relationship between log prices and

quantities and weather conditions. These are estimates of the functions pe(z, x) and qe(z, x)

for various choices of instruments and covariates. The dummy instrument, Stormy, indicates wave height greater than 4 5 feet and wind speed greater than 18 knots. A second

dummy instrument, Mixed, indicates wave height greater than 3.8 feet, wind speed greater
than 13 knots when Stormy equals zero. Wind speed and wave height are moving averages
of the last three days' wind speed and wave height before the trading day, as measured
off the coast of Long Island and reported in the New York Times boating forecast.

The reduced-form results show that Stormy is a statistically significant determinant

of both the price and quantity of fish sold at the Fulton market. Stormy weather decreases
TABLE 2

Reducedform estimates for log quantity (111 Obs.)
Variable

coef

(s.e.)

coef

(s.e.)

coef

(s.e.)

coef

(s.e.)

Stormy -0-36 (0.15) -0-38 (0.15) -0 45 (0-08) -0 43 (0.17)
Mixed
-0
20
(0.17)
-0
10
(0.16)
Monday
0.12
(0.19)
0
11
(0.19)
Tuesday

-0

Wednesday
Thursday

46

(0.

-0-54

0-07

19)

(020)

(0-16)

-0

45

-0-53
0

07

(0

19)

(0.20)
(0-16)

Good weather on shore 0 09 (0.15) 0-08 (0.17)
Rain on Shore -0-03 (0.14) -0-02 (0.14)
Note: All covariates and instruments are dummy variables.

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

518 REVIEW OF ECONOMIC STUDIES
TABLE 3

Reducedform estimates for log price (111 Obs)
Variable

coef

(s.e.)

coef

(s.e.)

coef

(s.e.)

coef

(s.e.)

Stormy 0-34 (0.07) 0 31 (0.08) 0-44 (0.08) 0-42 (0-08)
Mixed
0-24
(0.08)
0.23
(0.08)
Monday
-012
(01
1)
-011
(0.1
1)
Tuesday
-0-06
(0.
11)
-0-08
(0
11)
Wednesday -0-03 (0. 11) -006 (0.11)
Thursday
0-04
(0.11)
0-03
(0.
11)
Good weather on shore -0-02 (0.10) -0 01 (0 09)
Rain on shore 0 08 (0.07) 0-06 (0-07)
Note: Standard errors are reported in parentheses.

the quantity and increases the price. The covariates are not significant in the price equation, but they do show that the quantity traded on Tuesday and Wednesday is significantly
less than that traded on other days of the week. The coefficients on Mixed and Stormy
are increasing in absolute value, and jointly significant.

5.3. Estimates of the average elasticity

The next table reports estimates of the weighted average demand elasticity. The first column reports estimates of

- e(S)-q (ns)

pfe(s) _pe(ns)

We also present estimates comparing fair and mixed, and mixed and stormy weather:

f,m qe(M) - qe(f) and 3mS qe(S)-fe(m)
p e(m) _pe( f) p e(S) -p e(m)
respectively. Note that these estimates also correspond to the instrumental variables esti-

mates of f1 in a standard setup with the demand function equal to

ln q'(p) = Bo?+ I lnp + Ed,
using only observations with zt = z and zt = z' and using the binary indicator for zt = z' as
the instrument.

Table 4 shows estimates of fB(z, z', x) for the same combinations of z and z' as before.
The covariates include indicators for days of the week and for weather on shore. These

estimates are numerically identical to the instrumental variables estimates of f31 in tex
TABLE 4

Instrumental variables estimates of demandfunction
Stormy/Not-stormy Fair/Mixed Mixed/Stormy
Sample
size
111
79
66

Av. price effect -1 08 (0.48) -1 22 (0.55) -0 85 (0.70) -0 31 (0.59) -1 24 (0.97) -1 26 (0.87)
Monday -0 03 (0.17) 0 13 (0.21) -0 00 (0.34)
Tuesday -0 53 (0.18) -0 54 (0.20) -0 51 (0.30)
Wednesday -0 58 (0.20) -0 69 (0.18) -0 54 (0.28)
Thursday 0.12 (0.18) -0.03 (0.19) 0 26 (0.24)
Weather on shore 0 07 (0.16) -0 02 (0.18) -0 09 (0.23)
Rain

on

shore

0

07

(0.16)

0.23

(0.22)

-0

22

(0.17)

Notes: The excluded instruments are shown in the column headings. Standard errors are reported in parentheses.

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

ANGRIST ET AL. SIMULTANEOUS EQUATIONS MODELS 519
TABLE 5

Two-stage-least-squares estimates of demand function with stormy
and mixed as instruments
Variable est. (s.e.) est. (s.e.)

Av. price effect -1 01 (0 42) -0 947 (0.46)
Monday -0 013 (0.18)
Tuesday -0 51 (0.18)
Wednesday -0 56 (0.17)
Thursday 0 10 (0.17)
Weather on shore 0.02 (0.16)
Rain on shore 0 07 (0.16)
Note: Standard errors are reported in parentheses.

book versions of instrumental variables with the demand function equal to

ln q'(p) = o + P? 1 *lnp + ? 2X ,
again using observations with zt = z and zt = z' and using the indicator for zt =z as the
instrument. Note that under the additivity assumption (Assumption 5) the value of

,B9(z, z', x) does not vary with x.
Table 5 presents two-stage-least-squares estimates using both the stormy and mixed
instruments, with and without the additional regressors. These estimates are close to those
based on the single instruments, with slightly lower standard errors.

Table 6 provides some evidence on the robustness of the results. First we replace
average daily prices with the minimum, maximum, and the median of daily prices. Second,
we split the sample by period and transaction volume. The estimates do not vary much
across specifications.

5.4. Choosing between different instruments

This section discusses the choice of instruments. Figure 3 plots the three empirical log

price distribution functions, estimates of Fz(p) = Pr (logp'(z) 'p), for ze {f, m, s}. The difference between these distribution functions, presented in Figure 4, is equal to the unnor-

malized weight function for the estimands corresponding to using the fair/mixed data
only (solid line), and using the mixed/stormy data only (dashed line). In addition the
estimated demand functions for each of the two subsets of the data are presented in this
figure, assuming linearity. The estimated slope of the demand function in these two cases
is -0 85 and -1 24 respectively.
TABLE 6

Instrumental variables estimates of demandfunction using stormy/not stormy as instrument (alternat
Min Price Max Price Median Price First Half Second Half Low Vol. High Vol.

Sample

size

111

111

111

56

55

55

56

Price -1 46 (0.87) -1 29 (0.54) -1 15 (0 52) -1 87 (0.82) -1 27 (0.79) -1 00 (1.10) -1 52 (0 55)

Mon 0 18 (0.21) -0 04 (0.20) -0 04 (0.18) -0 14 (0.27) -000 (0.24) 0 09 (0.36) -0 15
Tue -0 47 (0.26) -0 50 (0.20) -0 54 (0.19) -0 63 (0.27) -0 53 (0.32) -0 28 (0.29) -0 76
Wed -0 43 (0.22) -0 58 (0.17) -0 56 (0.17) -0 68 (0.37) -0 52 (0.25) -0 40 (0.33) -0 65
Thur 0 27 (0.22) 0 07 (0.18) 0 13 (0.18) -0 18 (0.24) 0.32 (0.24) 0.32 (0.47) -0-11

(0.29)l
(0.24)
(0.25)
(0.16)

Weath. -0 06 (0.19) 0 08 (0.18) 0 06 (0.15) 0.13 (0.30) -0 07 (0.16) -0 04 (0.36) 0 16 (0.19)
Rain 0 30 (0.26) 0 03 (0.16) 0 09 (0.16) -0 15 (0.27) 0.21 (0.20) -0-11 (0.23) -0-11 (0.34)

Notes: The column headings describe alternative choices of endogenous regressor and subsamples. Standard errors are reported
in parentheses.

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

520 REVIEW OF ECONOMIC STUDIES

0.9
0.8

r

,'

f

6
0.7

tL

t;0.4

0.3

I

-

-

0.60

'i

-

/ ~~ _ .1

5

0.3

r.

0.2-

0.1

r

.

-1.2 -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.8
Log(Price)

FIGURE 3

Empirical distribution function of log prices by weather conditions

The fair/mixed and mixed/stormy weight functions capture different price ranges.
The fair/mixed instrument estimates a weighted average of the demand function with
most weight attached to prices between 55 and 100 cents per pound (log prices between
-0.6 and 0.0). The mixed/stormy instrument estimates a weighted average of the demand
function with most weight attached to prices between 82 and 150 cents (log prices between

-02 and 0 4). Neither instrument captures more than about a third of the total number
of markets at any particular price. (Recall that the height of the unnormalized weight

function at price p is an estimate of the proportion of the markets where equilibria span
p). The estimates may be of little value for predicting effects in markets where weather

conditions affect prices below 50 cents or above 150 cents, or in markets where weather
does not affect prices. On the other hand, the fact that the alternative estimates are reasonably close suggests that heterogeneity in demand may be limited.

6. CONCLUSION

This paper investigates the consequences of relaxing additivity and linearity assumptions
in simultaneous equations models. We show that without these assumptions, instrumental
variables methods still estimate weighted average derivatives of the functions of interest.
Averaging is across markets and along the nonlinear demand and supply function. The
exact nature of the averaging depends on the relationship between the equilibrium prices
and the instruments. The estimated weighted average therefore depends on the instrument
employed. On the other hand, much can be learned about the range of price variation

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

ANGRIST ET AL. SIMULTANEOUS EQUATIONS MODELS 521
1.2

X

X

,

,

-

I

1

0.8

.cn

0.6

.E

_

X~~~~~~~~~~

J

0.2

0

-0.2

-1.2

-1

I

I

-0.8

I

-0.6

-0.4

-0.2

0

0.2

0.4

0.6

0.8

Log(Price)
FIGURE 4

Weight and regression functions for different binary instruments

underlying each estimate, and the proportion of markets affected by the instrument at

each price. These results are obtained by formulating the simultaneous equations model
in terms of demand and supply at different prices and instruments, rather than in terms

of functional-form specific residuals. We illustrate the assumptions and theoretical results
by estimating the demand for Whiting at the Fulton fish market.

APPENDIX
Proof of Lemma 1.

Without loss of generality suppose qs(p, z) _ qt(p, z') for all p. Define the excess supply function
e4(p, z) = ft(p, z)- qd(p).

By definition of the equilibrium price pt(z),
et t(plz), z) = ?-

By assumption q (p, z)_ qS(t (p, z'), so that

e'(p (z') z) e'(4(z)z ?qS(pe(z'), Z) - qst(p'(z'), z') e'e(pe(Z'), Z) =0.
Hence,

es(Pe(z'), z') - es ( p (z'), z) 0 o
Using a mean value theorem, with pf between p'(z) and pe (z'), we have

ets(p(z'), z') - es(p'(z'), z)= -(, z) (p(z') -p,(z)) O.

t t f ~ ~ap I

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

522 REVIEW OF ECONOMIC STUDIES
The derivative of e( p, z) with respect to p is

ae,(p,z)=aq, z) aq, (p) > 0
ap ap ap

implying that

Proof of Lemma 2.
First consider the ratio

qe(1 x) - qe(0 x)
3*(x) = pe( 1 x) -pe(O>I X)
By Theorem 1 this is equal to

E a-(F P zt) p,(z) _p 'p(Z), x= X] 0d(p x)dp.

All we therefore have left to prove is that P*(x) does not depend on x and that it is equal to the ratio of redu
form slope coefficients.

Consider qe(z I x) and pe(z x X). By Assumption 5 this is equal to

qe(z x) = q'(z) + Yq* X,
and

pe(z I x) = po(z) + yp X,

respectively. Substituting this in P*(x) gives
*(X) q(1 - qO)

peo(l)-po() _Pe('

which proves the claim that P(x) does not vary with x.
Finally, consider again qe(Z x). With binary z, and using Assumption 5, this can be written as

E[elZ, x] = qe(Z I x) eq(Z) + Yq X = q(O) +Z. (q(l) -qe(0)) Yq
demonstrating that the coefficient on z in this linear regression is equal to the difference (qe(l) - qe(0).

Proof of Lemma 3.

By additivity of the residuals we can write the demand function as additive in the average demand function and
the residual

qd(p, Z) = qd(p, zlxt) ?
for all z and p. By linearity in prices and instruments we can write the demand function as
qt(p,Z) = tO + It'P + 2t*Z,

for all z and p. Combining these two assumptions implies that we can write the averag
qd(p, zx)= fo(X) + PI(X) p?+f2(X) Z.

Combining this with the assumption of linearity and additivity in covariates implies that PI(x) an
depend on x and we can write the average demand function as

qd(p Z x) = Po?+p p+ 2Z Z+ ?33X
Hence the demand function is

qd(p Z) = po?+fl P? +2Z+ l3Xt?+ Ed

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

ANGRIST ET AL. SIMULTANEOUS EQUATIONS MODELS 523
At the observed prices and instruments we therefore have
qt =Po +1 pt + 32 Zt + 03 Xt ,
and similar for the supply function.
Proof of Lemma 4.

(i) Given Assumptions 6, 8, and 9, Lemma 3 implies that the demand and supply function can be written
as

qt(pz) f0?+ pP +2 Z + 03 * t

q(p, z) = ao + a1 P + a2*Z + a3*Xt + ?t
Conditional on xt the only stochastic component of the demand and supply function is the pair of residuals
(el, t). Independence of the demand and supply functions of zt is therefore equivalent to independence of the
residuals and zt, proving the first part of Lemma 4.

(ii) The difference q d(p, z) - q d(p, z') is under these assumptions equal to a2 (Z -Z'), which can only be
zero if a2 = 0. This proves the second part of Lemma 4.
(iii) The equilibrium price at z = 0 and z= 1 are respectively

e(0 a f3 a3 -f3 e d_e s

Pt (0) = 0x 00 + Xt * - + ?t ?t

31 -a1
p
pi ?1-1
fl 1-a1

fl1-a15

a01) f3p0 +a?2-f2 + aX3-f3 ?t'-?t

? ? xt. ?

f1-a1 f1-a1 f1-a1 f1-a1
If these are to be different for any period it must be the case that a2- 82 differs from zero. Since Assumption

10 establishes that a2 = 0, it must be the case that P2 differs from zero. This establishes the third part of Lem
4.

(iv) The difference between pe(1) and pe(O) is (a2 - f2)/(AP - a1)- It does not change sign from one period
to the next because the coefficients are fixed. This proves the final part of Lemma 4.

Before proving Theorem 1, we state an additional lemma.

Lemma 5. Suppose Assumptions 1-4 hold with p (z') pe (z). In addition let gt () be any continuously differentiable function. Then:

E[g((pe(z)) -gt(Pe(Z))IXt = X]

{0 a (p) pe(Z) <p < e(z'), xt = xl Pr (pe(z) <p <pe(x') x)dpt
Proof of Lemma 5.

The expected difference E[gt(pe(z')) -gt(pe(z)) xt = x] can be written as

= [agt ( P) 1 fpte(Z) <p <pe(Z,)Ide xt = x|d

E[t(Pe (Z,))-gt (Pte(Z)) IXt = ]=E[ (p)p4Xt=X

= E ( p){p(z)<p<p(z')} xtx = x

= | E[8g' (p) X fpe'z) <P <P,(z,) xt = x 1

Pr(pe(Z)<p<p e(Z') Ixt = x)dp.

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

524 REVIEW OF ECONOMIC STUDIES
Proof of Theorem 1.

First apply Lemma 5 with gt(p) = p to get

p(z', x) _pe(z, X) = E[pte(Z) _P,(Z)IXt= = X] Pr (pe(z) <p <pe(z)IX = x)dp.
Second, apply Lemma 5 again with gt(p) = q d(p) to get

E[qd'(pe(Z')) dqt(pe(Z)) I X= X]

= { aq (p) pe(Z) < p < pe(Z'), x = xl Pr (pe(Z) < p < pe(Z') Ixt = x)dp.
Finally, taking the ratio of these two differences gives

q( Ix- q(zx= tl (p) pe(Z,) 'p _pe(Z)' Xt = X Pr( t(z Pt(l' )

pe(Z x)-_pe(ZX) ap f0 Pr(pe(z) <p <pe(z')Ixtt= x)dp

= yaqt (p) p(Z)pp(Z) Xt = X (p, z,
Proof of Theorem 2.

Corresponding to each pair of instrument values (zk zl) there is an instrumental variables estimand jykzI These
K(K+ 1)/2 estimands are related through the equality
(pe(V)P pe(Z)) f3p ' = (pe(V) _pe(W)) * pf,,v + (pe(W) _pe(Z)) pJv3Z
for all triples (v, w, z). Because
pk_kz= qe(zk) - qe(zl)

Pe(Zk) _pe(Zl)'

we can write

qe(zk) = qe(zo) + p,zk,z. (pe(Zk) _pe(Zo))

and substituting sequentially, this leads to

qe(Zk) qe(zO) + ,k Pzzr * (pe(Zn?),_ pe(Zn- 1))
The IV procedure estimates

C Cov (q , g(zt)) - E[qt (g(zt) -E[g(zt)])
- Coy (pr g(zt)) E[p (g(zt) - E[g(zt)])
First consider the numerator:

E[qt (g(zt) - E[g(zt)])] = fk(Z) = zk]= (g(zk)k- E[g(zt)])
= JkK= 0 fjzk) E[qt eIZ ] (g(zk )- Eg(zt)])

+K I f(z(k) k= f"z"' . (pe(zm)_ pe(Zm-1)) (g(Zk) -E[g(zt)])
fK plz--,z (pe(zfn) pe(Zm--)) K=,f(Z) f (g(zk) - E[g(zt)]).

The factor multiplying pzf Y z' is the numerator in Xk . Similarly the denominator E[pe_ (g(zt) - E[g(zt)])] can b
shown to be equal to the denominator in Zk. The weights Zk then clearly add up to one.
Proof of Theorem 3.

Take the limit of the two components of equation (3) separately. First:

lim
[
d '-Pte(Z)]
E q= aqt
t( p Zt) pe(Z) = ]
40t
a ( p Zt)E
pe (z
+ dz)-'_P
dz0
3p
a3p

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

ANGRIST ET AL. SIMULTANEOUS EQUATIONS MODELS 525
Second the weights:

lrn @(p) = uimO.rn? Pr (p'(z) ?p-p (z dz))
dz0 dz10 f Pr (p'(z) -?:p ?::p'(z ? dz))dp ~G)
Then taking the ratio of the two gives the desired result.

Proof of Theorem 4.
By definition,

qe(z ? dz) - qe(z) a ~qe lape
f3(z) =lim -(z - (z),
di_ope(Z + dz) _pe(Z) =aZ Jaz
and therefore we can write

q'(z) - qe(zo)= j f(y) aP (y)dy.
Now

E[q'(zt) (g(z,) - E[g(zt)])] = 0,
and hence

E[qe(zt) (g(z) -E[g(zt)]) = E[(qe(zt) - qe(zo)). (g(zt) - E[g(zt)])
J= Jt f3( ) (y) (g(z) - E[g(zt)])fz(z)dydz
0000 az
ape

= l(y) - (y) I (g(z) - E[g(zt)])fz(z)dzdy.

-G, ~az

A similar calculation for E[pe(Zt) (g(zt) - E[g(zt)]) completes the argument.

Proof of Corollary.

The corollary can be proven along the same lines as Theorem 1 with first applying Lemma 5 with gt( p) ln (p)
and then applying the same lemma with gt(p) = ln qd'(p).

Proof of Corollary 2.

The instrumental variables estimand is in this case without covariates equal to

Pf*(x) = qe(I) - qe(O)
Consider first the numerator. It can be written as

e(l) qe(o) E[qe(l) -qe(0)] = E[qd'(pe(l)) -qd(Pe(l))]
= .t ptl*Pe(l) _(pto + ptl .pe(?))]

= ptl * (pe(l) _-pe()).
By assumption the denominator is equal to E[pe(l) -pe(O)]. This proves the first equality.
The two equilibrium prices are equal to

e(0) -'tO- to

t tl - ?CtI

xe(l) = ftO 3 +0 at2
otl - Ctl + tl - (t

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

526 REVIEW OF ECONOMIC STUDIES
and their difference is

Pt() -pt(0) = at2
ati - Pt

so that

-* E[Il (p,(1)-P(0))] Egt +Covy (t,p,(l) -P(O)) E[fl] ?+CoV (Olt, -a2t/(alt - Olt))
E[pe(1) -Pe(O)] E[pe(1) -pe()] Ef-a2t/(axt- 31 t)]

Proof of Corollary 3.

If the demand function is additive in a function of price and a period specific component the derivative with

respect to the price is, aqd/ap(p), common to all periods. The only averaging is then over the periods with the
equilibrium prices bracketing p, leading to the IV estimand

aqd Pr ( p,() tp<p 1)

JOap f I0 Pr ( pe(O) < r <pe(1))dr
Proof of Corollary 4.

This follows directly from Theorem 1, applied at each pair of values of the instrument.

Acknowledgements. We are grateful for comments by Gary Chamberlain, David Cox, Kei Hirano, Don
Rubin, Tom Stoker, two referees and a managing editor. Imbens wishes to acknowledge financial support from
an Alfred P. Sloan Fellowship and by the National Science Foundation through grant SBR 9423018.
REFERENCES
AMEMIYA, T. (1985), Advanced Econometrics (Cambridge: Harvard University Press).

ANGRIST, J. D. and IMBENS, G. W. (1995), "Two-Stage Least Squares Estimation of Average Causal Effects
in Models with Variable Treatment Intensity", Journal of the American Statistical Association, 90, 431442.

ANGRIST, J., IMBENS, G. and RUBIN, D. (1996), "Identification of Causal Effects Using Instrumental
Variables" (with discussion), Journal of the American Statistical Association, 91, 444-472.
DAVIDSON, R. and MAcKINNON, J. (1993) Estimation and Inference in Econometrics (Oxford: Oxford University Press).

GRADDY, K. (1995), "Who Pays More? Essays on Bargaining and Price Discrimination" (PhD thesis, Department of Economics, Princeton University).

GRADDY, K. (1996), "Testing for Imperfect Competition at the Fulton Fish Market", RAND Journal of
Economics, 26, 75-92.

GOLDBERGER, A. (1991) A Course in Econometrics (Cambridge: Harvard University Press).
HAAVELMO, T. (1943), "Statistical Implications of a System of Simultaneous Equations", Econometrica, 11,
1-12.

HAUSMANN, J. (1978), "Specification Tests in Econometrics", Econometrica, 76, 1251-1271.
HENDRY, D. and MORGAN, M. (eds.) (1997) The Foundations of Econometric Analysis (Cambridge: Cambridge University Press).
HIRANO, K., IMBENS, G., RUBIN, D., and ZHOU, A. (2000), "Assessing the Effect of an Influenza Vaccine
in an Encouragement Design", Biostatistics, 1, 69-88.

HOLLAND, P. (1986), "Statistics and Causal Inference" (with discussion), Journal of the American Statistical
Association, 81, 945-970.
IMBENS, G. and ANGRIST, J. (1994), "Identification and Estimation of Local Average Treatment Effects",
Econometrica, 62, 467-476.

IMBENS, G. W. and RUBIN, D. B. (1997a), "Bayesian Inference for Causal Effects in Randomized Experiments with Noncompliance", Annals of Statistics, 25, 305-327.
IMBENS, G. W. and RUBIN, D. B. (1997b), "Estimating Outcome Distributions for Compliers in Instrumental
Variables Models", Review of Economic Studies, 64, 555-574.
MANSKI, C. (1995), "Simultaneity With Downward Sloping Demand", Chapter 6 in Identification Problems in
the Social Sciences (Cambridge: Harvard University Press).
MANSKI, C. (1997), "Monotone Treatment Response", Econometrica, 65, 1311-1334.
NEWEY, W., POWELL, J. and VELLA, F. (1999), "Nonparametric Estimation of Triangular Simultaneous
Equations Models", Econometrica, 67, 565-604.
PEARL, J. (1994), "Causal Diagrams in Empirical Research", Biometrika, 82, 669-710.

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

ANGRIST ET AL. SIMULTANEOUS EQUATIONS MODELS 527
ROEHRIG, C. (1988), "Conditions for Identification in Nonparametric and Parametric Models", Econometrica,
56, 433-447.
RUBIN, D. (1974), "Estimating Causal Effects of Treatments in Randomized and Non-randomized Studies",
Journal of Educational Psychology, 66, 688-701.
RUBIN, D. B. (1978), "Bayesian Inference for Causal Effects: The Role of Randomization", Annals of Statistics,
6, 34-58.
STOKER, T. (1993), "Empirical Approaches to the Problem of Aggregation Over Individuals", Journal of
Economic Literature, 31, 1827-1874.
TINBERGEN, J. (1930), "Determination and Interpretation of Supply Curves: An Example", Zeitschrift fur
Nationalokonomie, reprinted in: Hendry, D. F. and Morgan, M. S. (eds.), The Foundations of Econometric
Analysis (Cambridge: Cambridge University Press).

This content downloaded from 206.253.207.235 on Tue, 08 Oct 2019 15:42:08 UTC
All use subject to https://about.jstor.org/terms

