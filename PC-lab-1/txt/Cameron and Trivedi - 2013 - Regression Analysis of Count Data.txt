more information - www.cambridge.org/9781107014169

Regression Analysis of Count Data, Second Edition
Students in both social and natural sciences often seek regression methods to
explain the frequency of events, such as visits to a doctor, auto accidents, or
new patents awarded. This book provides the most comprehensive and up-to-date
account of models and methods to interpret such data. The authors have conducted
research in the field for more than 25 years. In this book, they combine theory
and practice to make sophisticated methods of analysis accessible to researchers
and practitioners working with widely different types of data and software in areas
such as applied statistics, econometrics, marketing, operations research, actuarial
studies, demography, biostatistics, and quantitative social sciences. The book may
be used as a reference work on count models or by students seeking an authoritative
overview. Complementary material in the form of data sets, template programs,
and bibliographic resources can be accessed on the Internet through the authors’
homepages. This second edition is an expanded and updated version of the first, with
new empirical examples and more than two hundred new references added. The
new material includes new theoretical topics, an updated and expanded treatment of
cross-section models, coverage of bootstrap-based and simulation-based inference,
expanded treatment of time series, multivariate and panel data, expanded treatment
of endogenous regressors, coverage of quantile count regression, and a new chapter
on Bayesian methods.
A. Colin Cameron is Professor of Economics at the University of California, Davis.
His research and teaching interests span a range of topics in microeconometrics.
He is a past director of the Center on Quantitative Social Science at UC Davis and
is currently an associate editor of the Stata Journal and Journal of Econometric
Methods.
Pravin K. Trivedi is Professor of Economics, University of Queensland, and Distinguished Professor Emeritus and J. H. Rudy Professor Emeritus of Economics
at Indiana University, Bloomington. During his academic career, he has taught
undergraduate and graduate-level econometrics in the United States, Europe, and
Australia. His research interests are in microeconometrics and health economics.
He served as coeditor of the Econometrics Journal from 2000 to 2007 and has been
on the board of Journal of Applied Econometrics since 1988.
Professors Cameron and Trivedi are coauthors of the first edition of Regression
Analysis of Count Data (Cambridge University Press, 1998), Microeconometrics:
Methods and Applications (Cambridge University Press, 2005), and Microeconomics Using Stata Revised Edition (2010).

Econometric Society Monographs
Editors:
Rosa L. Matzkin, University of California, Los Angeles
George J. Mailath, University of Pennsylvania
The Econometric Society is an international society for the advancement of economic theory in
relation to statistics and mathematics. The Econometric Society Monograph series is designed
to promote the publication of original research contributions of high quality in mathematical
economics and theoretical and applied econometrics.
Other titles in the series:
G. S. Maddala, Limited dependent and qualitative variables in econometrics, 9780521241434,
9780521338257
Gerard Debreu, Mathematical economics: Twenty papers of Gerard Debreu, 9780521237369,
9780521335614
Jean-Michel Grandmont, Money and value: A reconsideration of classical and neoclassical
monetary economics, 9780521251419, 9780521313643
Franklin M. Fisher, Disequilibrium foundations of equilibrium economics, 9780521378567
Andreu Mas-Colell, The theory of general equilibrium: A differentiable approach,
9780521265140, 9780521388702
Truman F. Bewley, Editor, Advances in econometrics – Fifth World Congress (Volume I),
9780521467261
Truman F. Bewley, Editor, Advances in econometrics – Fifth World Congress (Volume II),
9780521467254
Hervé Moulin, Axioms of cooperative decision making, 9780521360555, 9780521424585
L. G. Godfrey, Misspecification tests in econometrics: The Lagrange multiplier principle and
other approaches, 9780521424592
Tony Lancaster, The econometric analysis of transition data, 9780521437899
Alvin E. Roth and Marilda A. Oliviera Sotomayor, Editors, Two-sided matching: A study in
game-theoretic modeling and analysis, 9780521437882
Wolfgang Härdle, Applied nonparametric regression, 9780521429504
Jean-Jacques Laffont, Editor, Advances in economic theory – Sixth World Congress (Volume I),
9780521484596
Jean-Jacques Laffont, Editor, Advances in economic theory – Sixth World Congress (Volume II),
9780521484602
Halbert White, Estimation, inference and specification, 9780521252805, 9780521574464
Christopher Sims, Editor, Advances in econometrics – Sixth World Congress (Volume I),
9780521444590, 9780521566100
Christopher Sims, Editor, Advances in econometrics – Sixth World Congress (Volume II),
9780521444606, 9780521566094
Roger Guesnerie, A contribution to the pure theory of taxation, 9780521629560
David M. Kreps and Kenneth F. Wallis, Editors, Advances in economics and econometrics –
Seventh World Congress (Volume I), 9780521589833
David M. Kreps and Kenneth F. Wallis, Editors, Advances in economics and econometrics –
Seventh World Congress (Volume II), 9780521589826
David M. Kreps and Kenneth F. Wallis, Editors, Advances in economics and econometrics –
Seventh World Congress (Volume III), 9780521580137, 9780521589819
Donald P. Jacobs, Ehud Kalai, and Morton I. Kamien, Editors, Frontiers of research in economic
theory: The Nancy L. Schwartz Memorial Lectures, 1983–1997, 9780521632225,
9780521635387
Steinar Strom, Editor, Econometrics and economic theory in the 20th century: The Ragnar Frisch
Centennial Symposium, 9780521633239, 9780521633659
Continued on page following the index

Regression Analysis of Count Data
Second Edition
A. Colin Cameron
University of California, Davis

Pravin K. Trivedi
University of Queensland
Indiana University, Bloomington, Emeritus

CAMBRIDGE UNIVERSITY PRESS
Cambridge, New York, Melbourne, Madrid, Cape Town,
Singapore, São Paulo, Delhi, Mexico City
Cambridge University Press
32 Avenue of the Americas, New York, NY 10013-2473, USA
www.cambridge.org
Information on this title: www.cambridge.org/9781107667273
© A. Colin Cameron and Pravin K. Trivedi 1998, 2013
This publication is in copyright. Subject to statutory exception
and to the provisions of relevant collective licensing agreements,
no reproduction of any part may take place without the written
permission of Cambridge University Press.
First edition published 1998
Second edition published 2013
Printed in the United States of America
A catalog record for this publication is available from the British Library.
Library of Congress Cataloging in Publication Data
Cameron, Adrian Colin.
Regression analysis of count data / A. Colin Cameron, University of California, Davis,
Pravin K. Trivedi, Indiana University, Bloomington. – Second edition.
pages cm. – (Econometric society monographs)
Includes bibliographical references and index.
ISBN 978-1-107-01416-9 (hardback) – ISBN 978-1-107-66727-3 (paperback)
1. Regression analysis. 2. Econometrics. I. Trivedi, P. K. II. Title.
QA278.2.C36 2013
2012043350
519.5 36–dc23
ISBN 978-1-107-01416-9 Hardback
ISBN 978-1-107-66727-3 Paperback
Cambridge University Press has no responsibility for the persistence or accuracy of URLs for
external or third-party Internet web sites referred to in this publication and does not guarantee that
any content on such web sites is, or will remain, accurate or appropriate.

To Michelle and Bhavna

Contents

List of Figures

page xv

List of Tables

xvii

Preface

xxi

Preface to the First Edition

xxv

1

1.1
1.2
1.3
1.4
1.5

Introduction
Poisson Distribution and Its Characterizations
Poisson Regression
Examples
Overview of Major Issues
Bibliographic Notes

1
3
9
11
17
20

2

Model Specification and Estimation
2.1 Introduction
2.2 Example and Definitions
2.3 Likelihood-Based Models
2.4 Generalized Linear Models
2.5 Moment-Based Models
2.6 Testing
2.7 Robust Inference
2.8 Derivation of Results
2.9 Bibliographic Notes
2.10 Exercises

21
21
22
24
29
40
48
58
61
67
67

3

Basic Count Regression
3.1 Introduction
3.2 Poisson MLE, QMLE, and GLM
3.3 Negative Binomial MLE and QGPMLE
3.4 Overdispersion Tests
3.5 Use of Regression Results

69
69
71
80
89
92

ix

x

Contents

3.6
3.7
3.8
3.9
3.10

4

5

6

Ordered and Other Discrete-Outcome Models
Other Models
Iteratively Reweighted Least Squares
Bibliographic Notes
Exercises

98
102
108
108
109

4.1
4.2
4.3
4.4
4.5
4.6
4.7
4.8
4.9
4.10
4.11
4.12
4.13
4.14

Generalized Count Regression
Introduction
Mixture Models
Truncated Counts
Censored Counts
Hurdle Models
Zero-Inflated Count Models
Hierarchical Models
Finite Mixtures and Latent Class Analysis
Count Models with Cross-Sectional Dependence
Models Based on Waiting Time Distributions
Katz, Double Poisson, and Generalized Poisson
Derivations
Bibliographic Notes
Exercises

111
111
112
128
133
136
139
142
144
156
161
167
171
174
175

5.1
5.2
5.3
5.4
5.5
5.6
5.7
5.8
5.9

Model Evaluation and Testing
Introduction
Residual Analysis
Goodness of Fit
Discriminating among Nonnested Models
Tests for Overdispersion
Conditional Moment Specification Tests
Derivations
Bibliographic Notes
Exercises

177
177
178
188
196
200
207
220
222
223

Empirical Illustrations
6.1 Introduction
6.2 Background
6.3 Analysis of Demand for Health Care
6.4 Analysis of Recreational Trips
6.5 Analysis of Fertility Data
6.6 Model Selection Criteria: A Digression
6.7 Concluding Remarks
6.8 Bibliographic Notes
6.9 Exercises

225
225
226
228
245
253
257
260
260
261

Contents

7

8

9

xi

7.1
7.2
7.3
7.4
7.5
7.6
7.7
7.8
7.9
7.10
7.11
7.12
7.13
7.14

Time Series Data
Introduction
Models for Time Series Data
Static Count Regression
Serially Correlated Heterogeneity Models
Autoregressive Models
Integer-Valued ARMA Models
State Space Models
Hidden Markov Models
Dynamic Ordered Probit Model
Discrete ARMA Models
Applications
Derivations
Bibliographic Notes
Exercises

263
263
264
268
276
281
284
289
291
293
294
295
301
302
302

Multivariate Data
8.1 Introduction
8.2 Characterizing and Generating Dependence
8.3 Sources of Dependence
8.4 Multivariate Count Models
8.5 Copula-Based Models
8.6 Moment-Based Estimation
8.7 Testing for Dependence
8.8 Mixed Multivariate Models
8.9 Empirical Example
8.10 Derivations
8.11 Bibliographic Notes

304
304
305
310
311
317
325
327
333
336
338
339

Longitudinal Data
Introduction
Models for Longitudinal Data
Population Averaged Models
Fixed Effects Models
Random Effects Models
Discussion
Specification Tests
Dynamic Longitudinal Models
Endogenous Regressors
More Flexible Functional Forms for Longitudinal Data
Derivations
Bibliographic Notes
Exercises

341
341
342
349
351
360
364
366
368
378
379
381
383
384

9.1
9.2
9.3
9.4
9.5
9.6
9.7
9.8
9.9
9.10
9.11
9.12
9.13

xii

Contents

10 Endogenous Regressors and Selection
10.1 Introduction
10.2 Endogeneity in Recursive Models
10.3 Selection Models for Counts
10.4 Moment-Based Methods for Endogenous Regressors
10.5 Example: Doctor Visits and Health Insurance
10.6 Selection and Endogeneity in Two-Part Models
10.7 Alternative Sampling Frames
10.8 Bibliographic Notes

385
385
386
388
397
402
406
407
412

11 Flexible Methods for Counts
11.1 Introduction
11.2 Flexible Distributions Using Series Expansions
11.3 Flexible Models of the Conditional Mean
11.4 Flexible Models of the Conditional Variance
11.5 Quantile Regression for Counts
11.6 Nonparametric Methods
11.7 Efficient Moment-Based Estimation
11.8 Analysis of Patent Counts
11.9 Derivations
11.10 Bibliographic Notes

413
413
414
421
425
432
435
438
442
446
447

12 Bayesian Methods for Counts
12.1 Introduction
12.2 Bayesian Approach
12.3 Poisson Regression
12.4 Markov Chain Monte Carlo Methods
12.5 Count Models
12.6 Roy Model for Counts
12.7 Bibliographic Notes

449
449
449
453
454
460
464
467

13 Measurement Errors
13.1 Introduction
13.2 Measurement Errors in Regressors
13.3 Measurement Errors in Exposure
13.4 Measurement Errors in Counts
13.5 Underreported Counts
13.6 Underreported and Overrereported Counts
13.7 Simulation Example: Poisson with Mismeasured Regressor
13.8 Derivations
13.9 Bibliographic Notes
13.10 Exercises

468
468
469
479
485
488
494
496
498
499
499

Contents

xiii

A Notation and Acronyms

501

B Functions, Distributions, and Moments
B.1 Gamma Function
B.2 Some Distributions
B.3 Moments of Truncated Poisson

505
505
506
507

C Software

509

References

511

Author Index

543

Subject Index

553

List of Figures

1.1

Frequency distributions of counts for four types of events:
Doctor visits, generated Poisson data, recreational trips, and
page 12
number of children
1.2 Daily data on the number of hospital admissions for asthma
14
3.1 Doctor visits: Poisson and NB2 predicted probabilities
87
4.1 Two Crossing Theorem: Negative binomial compared with the
117
Poisson
4.2 Two-component mixture of Poissons
146
5.1 Takeover bids: Residual plots
187
6.1 Histograms for the four count variables
226
6.2 OFP visits: Directional gradients
237
6.3 Comparison of the fitted means for the two latent classes
239
6.4 Component densities from the FMNB-2 NB1 model
239
7.1 Strikes (left axis) and output (right axis) per month
273
7.2 Actual and predicted strikes from a static regression model
274
7.3 Strikes: Actual and predicted strikes from a dynamic
297
regression model
7.4 Histogram and time series of the number of trades
298
8.1 Samples from Clayton and Gumbel copulas with Poisson
320
marginals
11.1 Fitted values from four models plotted against actual value
447
12.1 The first 100 retained draws (first panel) and the first 2,000
retained draws (second panel) of β 2 from the Metropolis
457
algorithm
12.2 Estimate of posterior density of β 2 from 10,000 retained draws
458
of β 2 from the Metropolis algorithm

xv

List of Tables

1.1
3.1
3.2
3.3
3.4
3.5
3.6
3.7
4.1
4.2
4.3
5.1
5.2
5.3
5.4
5.5
5.6
5.7
6.1
6.2
6.3
6.4

Joint frequency distribution of emergency room visits and
page 17
hospitalizations
Doctor visits: Actual frequency distribution
78
Doctor visits: Variable definitions and summary statistics
78
Doctor visits: Poisson QMLE with different standard error
79
estimates
Doctor visits: NB2 and NB1 model estimators and standard
86
errors
Simulation: Estimators under alternative dgps
88
Doctor visits: Poisson QMLE mean effects and scaled
96
coefficients
Doctor visits: Alternative estimates and t ratios
106
Selected mixture models for count data
116
Patents: Frequencies for 1979 data
155
Patents: Poisson, NB2, and FMNB2(2) models with 1979 data
155
Takeover bids: Actual frequency distribution
184
Takeover bids: Variable definitions and summary statistics
185
Takeover bids: Poisson QMLE with robust sandwich standard
185
errors and t ratios
Takeover bids: Descriptive statistics for various residuals
186
Takeover bids: Correlations of various residuals
186
Takeover bids: Poisson MLE predicted and actual probabilities
196
Takeover bids: Information criteria for alternative parametric
200
models
OFP visits: Actual frequency distribution (n = 4,406)
230
OFP visits: Variable definitions and summary statistics
230
OFP visits: Likelihood ratio tests
234
OFP visits: Information criteria (AIC and BIC)
235

xvii

xviii

6.5
6.6
6.7
6.8
6.9
6.10
6.11
6.12
6.13
6.14
6.15
6.16
6.17
6.18
7.1
7.2
7.3
7.4
7.5
7.6
8.1
8.2
8.3
9.1
9.2
9.3
9.4
9.5
9.6
10.1
10.2

List of Tables

OFP visits: FMNB-2 NB1 model, actual and fitted
distributions, and goodness-of-fit test
OFP visits: FMNB-2 NB1 model fitted means and variances
OFP visits: FMNB-2 NB1 model estimates and t-ratios
OFP visits: NB2 hurdle model estimates and t-ratios
Recreational trips: Actual frequency distribution
Recreational trips: Variable definitions and summary statistics
Recreational trips: Poisson and NB2 model estimates and
t-ratios
Recreational trips: Finite mixture model estimates and t-ratios
Recreational trips: With zeros and hurdle model estimates and
t-ratios
Recreational trips: Actual and fitted cumulative frequencies
Number of children: Actual and fitted frequency distribution
for Swiss data (n = 1,878)
Number of children: Actual and fitted frequency distribution
for British data (n = 6,782)
Swiss fertility data: Fit of various models
Rejection frequencies at nominal 10% significance level
Strikes: Variable definitions and summary statistics
Strikes: Poisson QMLE with heteroskedastic and
autocorrelation robust standard errors
Strikes: Residuals autocorrelations and serial correlation tests
Strikes: Actual and fitted frequency distributions of Poisson
and NB2 regressions
Strikes: Zeger-Qaqish autoregressive model estimates and
diagnostics
Stock trades: Static and dynamic model estimates
Copulas: Five leading examples
Orthogonal polynomials: First and second order
ML estimates of bivariate negative binomial model and
NLSUR estimates
Patents awarded: Actual frequency distribution
Patents: Pooled and fixed effects estimates
Patents: Random effects estimates
Moment conditions for selected panel count models
Patents: Dynamic model pooled and random effects estimates
Patents: Dynamic model correlated effects estimates
Doctor visits: One endogenous regressor
Doctor visits: Two endogenous regressors

238
238
241
243
246
246
249
250
252
252
254
255
255
258
273
274
275
276
296
300
319
333
337
358
359
364
374
377
377
404
405

List of Tables

11.1 Patents: Poisson, NB2, FMNB2(2), and NB2P1 models with
1979 data
11.2 Patents: Actual versus nonparametric prediction
11.3 Patents: Summary of various fitted means
11.4 Patents: Correlations of various fitted means
12.1 Metropolis Poisson example: Posterior summary and ML
estimates
13.1 Simulation exercise: Poisson regression with one mismeasured
regressor

xix

443
444
445
446
458
497

Preface

Since Regression Analysis of Count Data was published in 1998, significant
new research has contributed to the range and scope of count data models. This
growth is reflected in many new journal articles, fuller coverage in textbooks,
and wide interest in and availability of software for handling count data models.
These developments (to which we have also contributed) have motivated us to
revise and expand the first edition. Like the first edition, this volume reflects an
orientation toward practical data analysis.
The revisions in this edition have affected all chapters. First, we have corrected the typographical and other errors in the first edition, improved the graphics throughout, and where appropriate we have provided a cleaner and simpler
exposition. Second, we have revised and relocated material that seemed better
placed in a different location, mostly within the same chapter though occasionally in a different chapter. For example, material in Chapter 4 (generalized count
models), Chapter 8 (multivariate counts), and Chapter 13 (measurement errors)
has been pruned and rearranged so the more mainstream topics appear earlier
and the more marginal topics have disappeared altogether. For similar reasons
bootstrap inference has moved to Chapter 2 from Chapter 5. Our goal here has
been to improve quality of synthesis and accessibility of material to the reader.
Third, the final few chapters have been reordered. Chapter 10 (endogeneity
and selection) has moved up from Chapter 11. It replaces the measurement
error chapter that now appears as Chapter 13. Chapter 11 now covers flexible
parametric models (previously Chapter 12). And the current Chapter 12, which
covers Bayesian methods, is a new addition. Fourth, we have removed material
that was of marginal interest and replaced it with material of potentially greater
interest, especially to practitioners. For example, as barriers to implementation of more computer-intensive methods have come down, we have liberally
sprinkled illustrations of simulation-based methods throughout the book. Fifth,
bibliographic notes at the end of every chapter have been refreshed to include
newer references and topics. Sixth, we have developed an almost complete set
of computer code for the examples in this book.
The first edition has been expanded by about 35%. This expansion reflects
the addition of a new Chapter 12 on Bayesian methods as well as significant
xxi

xxii

Preface

additions to most other chapters. Chapter 2 has new sections on robust inference
and empirical likelihood and includes material on the bootstrap and generalized estimating equations. In Chapter 3 and throughout the book, the term
“pseudo-ML” has been changed to “quasi-ML” and robust standard errors are
computed using the robust sandwich form. Chapter 4 improves the coverage
and discussion of how many alternative count models relate to each other. Censored, truncated, hurdle, zero-inflated, and especially finite mixture models are
now covered in greater depth, with a more uniform notation, and hierarchical
count models and models with cross-sectional and spatial dependence have
been newly added. Chapter 5 moves up presentation of methods for discrimination among nonnested models. Chapter 6 adds a new empirical example
of fertility data that poses a fresh challenge to count data modelers. The time
series coverage in Chapter 7 has been expanded to include more recently developed models, and there is some rearrangement so that the most often used
models appear first. The coverage of multivariate count models in Chapter 8
uses a broader and more modern range of dependence concepts and provides a
lengthy treatment of parametric copula-based models. The survey of count data
panel models in Chapter 9 gives greater emphasis to moment-based approaches
and has a more comprehensive coverage of dynamic panels, the role of initial
conditions, conditionally correlated random effects, flexible functional forms,
and specification tests. Chapter 10 provides an improved exposition of models
with endogeneity and selection, including consideration of latent factor and
two-part models as well as simulation-based inference and control function
estimators. A major new topic in Chapter 11 is quantile regression models for
count data, and the coverage of semiparametric and nonparametric methods
has been expanded and updated. As previously mentioned, the new Chapter
12 covers Bayesian analysis of count models, providing an entry to the world
of Markov chain Monte Carlo analysis of count models. Finally, Chapter 13
provides a comprehensive survey of measurement error models for count data.
As a result of the expanded coverage of old topics and appearance of new
ones, the bibliography is now significantly larger and includes more than
two hundred additional new references.
To emphasize its empirical orientation, the book has added many new examples based on real data. These examples are scattered throughout the book,
especially in Chapters 6–12. In addition, we have a number of examples based
on simulated data. Researchers, instructors, and students interested in replicating our results can obtain all the data and computer programs used to produce
the results given in this book via Internet from our respective personal web
sites.
This revised and expanded second edition draws extensively from our jointly
authored research undertaken with Partha Deb, Jie Qun Guo, Judex Hyppolite,
Tong Li, Doug Miller, Murat Munkin, and David Zimmer. We thank them all.
We also thank Joao Santos Silva for detailed comments on Chapter 10 and Jeff
Racine for detailed comments on Chapter 11. The series editor Rosa Matzkin
and an anonymous reviewer provided helpful guidance and suggestions for

Preface

xxiii

improvements for which we are grateful. As for the first edition, it is a pleasure
to acknowledge the overall editorial direction and encouragement of Scott Parris
of Cambridge University Press throughout the multiyear process of bringing
the project to completion.
A. Colin Cameron
Davis, CA
Pravin K. Trivedi
Bloomington, IN
August 2012

Preface to the First Edition

This book describes regression methods for count data, where the response
variable is a non-negative integer. The methods are relevant for analysis of
counts that arise in both social and natural sciences.
Despite their relatively recent origin, count data regression methods build
on an impressive body of statistical research on univariate discrete distributions. Many of these methods have now found their way into major statistical
packages, which has encouraged their application in a variety of contexts. Such
widespread use has itself thrown up numerous interesting research issues and
themes, which we explore in this book.
The objective of the book is threefold. First, we wish to provide a synthesis and integrative survey of the literature on count data regressions, covering
both the statistical and econometric strands. The former has emphasized the
framework of generalized linear models, exponential families of distributions,
and generalized estimating equations, while the latter has emphasized nonlinear regression and generalized method of moment frameworks. Yet between
them there are numerous points of contact which can be fruitfully exploited.
Our second objective is to make sophisticated methods of data analysis more
accessible to practitioners with different interests and backgrounds. To this end
we consider models and methods suitable for cross-section, time series, and
longitudinal data. Detailed analyses of several data sets as well as shorter illustrations, implemented from a variety of viewpoints, are scattered throughout
the book to put empirical flesh on theoretical or methodological discussion.
We draw on examples from, and give references to, works in many applied
areas. Our third objective is to highlight the potential for further research by
discussion of issues and problems that need more analysis. We do so by embedding count data models in a larger body of econometric and statistical work on
discrete variables and, more generally, on nonlinear regression.
The book can be divided into four parts. The first two chapters contain
introductory material on count data and a comprehensive review of statistical
methods for nonlinear regression models. Chapters 3, 4, 5, and 6 present models
and applications for cross-section count data. Chapters 7, 8, and 9 present
methods for data other than cross-section data, namely time series, multivariate
xxv

xxvi

Preface to the First Edition

and longitudinal or panel data. Chapters 10, 11, and 12 present methods for
common complications, including measurement error, sample selection and
simultaneity, and semiparametric methods. Thus the coverage of the book is
qualitatively similar to that in a complete single book on linear regression
models.
The book is directed toward researchers, graduate students, and other practitioners in a wide range of fields. Because of our own background in econometrics, the book emphasizes issues arising in econometric applications. Our
training and background also influence the organizational structure of the book.
But areas outside econometrics are also considered. The essential prerequisite
for this book is familiarity with the linear regression model using matrix algebra.
The material in the book should be accessible to people with a background in
regression and statistical methods up to the level of a standard first-year graduate econometrics text such as Greene’s Econometric Analysis. While basic
count data methods are included in major statistical packages, more advanced
analysis can require programming in languages such as Splus, Gauss, or Matlab.
Our own entry into the field of count data models dates back to the early
1980s when we embarked on an empirical study of the demand for health insurance and health care services at the Australian National University. Since then
we have been involved in many empirical investigations that have influenced
our perceptions of this field. We have included numerous data analytic discussions in this volume to reflect our own interest and those of readers interested in
real data applications. The data sets, computer programs, and related materials
used in this book will be available through Internet access to our individual
web sites. These materials supplement and complement this book and will help
new entrants to the field, especially graduate students, to make a relatively easy
start.
We have learned much on modeling count data through collaborations
with coauthors, notably Partha Deb, Shiferaw Gurmu, Per Johansson, Kajal
Mukhopadhyay, and Frank Windmeijer. The burden of writing this book has
been eased by help from many colleagues, coauthors, and graduate students. In
particular, we thank the following for their generous attention, encouragement,
help, and comments on earlier drafts of various chapters: Kurt Brännäs, David
Hendry, Primula Kennedy, Tony Lancaster, Scott Long, Grayham Mizon, Neil
Shephard, and Bob Shumway, in addition to the coauthors already mentioned.
We especially thank David Hendry and Scott Long for their detailed advice
on manuscript preparation using Latex software and Scientific Workplace. The
manuscript has also benefited from the comments of a referee and the series
editor, Alberto Holly, and from the guidance of Scott Parris of Cambridge
University Press.
Work on the book was facilitated by periods spent at various institutions.
The first author thanks the Department of Statistics and the Research School of
Social Sciences at the Australian National University, the Department of Economics at Indiana University in Bloomington, and the University of California
in Davis for support during extended leaves to these institutions in 1995 and

Preface to the First Edition

xxvii

1996. The second author thanks Indiana University and European University
Institute, Florence, for support during his tenure as Jean Monnet Fellow in
1996, which permitted a period away from regular duties. For shorter periods
of stay that allowed us to work jointly, we thank the Department of Economics
at Indiana University, SELAPO at University of Munich, and the European
University Institute.
Finally we would both like to thank our families for their patience and
forbearance, especially during the periods of intensive work on the book. This
work would not have been possible at all without their constant support.
A. Colin Cameron
Davis, CA
Pravin K. Trivedi
Bloomington, IN

CHAPTER 1

Introduction

God made the integers, all the rest is the work of man.
– Kronecker

This book is concerned with models of event counts. An event count refers
to the number of times an event occurs, for example, the number of airline
accidents or earthquakes. It is the realization of a nonnegative integer-valued
random variable. A univariate statistical model of event counts usually specifies
a probability distribution of the number of occurrences of the event known up to
some parameters. Estimation and inference in such models are concerned with
the unknown parameters, given the probability distribution and the count data.
Such a specification involves no other variables, and the number of events is
assumed to be independently identically distributed (iid). Much early theoretical
and applied work on event counts was carried out in the univariate framework.
The main focus of this book, however, is on regression analysis of event counts.
The statistical analysis of counts within the framework of discrete parametric distributions for univariate iid random variables has a long and rich history
(Johnson, Kemp, and Kotz, 2005). The Poisson distribution was derived as a
limiting case of the binomial by Poisson (1837). Early applications include
the classic study of Bortkiewicz (1898) of the annual number of deaths in the
Prussian army from being kicked by mules. A standard generalization of the
Poisson is the negative binomial distribution. It was derived by Greenwood and
Yule (1920), as a consequence of apparent contagion due to unobserved heterogeneity, and by Eggenberger and Polya (1923) as a result of true contagion.
The biostatistics literature of the 1930s and 1940s, although predominantly
univariate, refined and brought to the forefront seminal issues that have since
permeated regression analysis of both counts and durations. The development
of the counting process approach unified the treatment of counts and durations. Much of the vast literature on iid counts, which addresses issues such
as heterogeneity and overdispersion, true versus apparent contagion, and identifiability of Poisson mixtures, retains its relevance in the context of count
data regressions. This leads to models such as the negative binomial regression
model.
1

2

Introduction

Significant early developments in count models took place in actuarial science, biostatistics, and demography. In recent years these models have also
been used extensively in economics, political science, and sociology. The special features of data in their respective fields of application have fueled developments that have enlarged the scope of these models. An important milestone
in the development of count data models for regression was the emergence of
the “generalized linear models,” of which the Poisson regression is a special
case, first described by Nelder and Wedderburn (1972) and detailed in McCullagh and Nelder (1983, 1989). Building on these contributions, the papers by
Gourieroux, Monfort, and Trognon (1984a, b) and the work on longitudinal
or panel count data models by Hausman, Hall, and Griliches (1984) have also
been very influential in stimulating applied work in the econometric literature.
Regression analysis of counts is motivated by the observation that in many,
if not most, real-life contexts, the iid assumption is too strong. For example, the
mean rate of occurrence of an event may vary from case to case and may depend
on some observable variables. The investigator’s main interest therefore may
lie in the role of covariates (regressors) that are thought to affect the parameters
of the conditional distribution of events, given the covariates. This is usually
accomplished by a regression model for event count. At the simplest level we
may think of this task in the conventional regression framework in which the
dependent variable, y, is restricted to be a nonnegative random variable whose
conditional mean depends on some vector of regressors, x.
At a different level of abstraction, an event may be thought of as the realization of a point process governed by some specified rate of occurrence of the
event. The number of events may be characterized as the total number of such
realizations over some unit of time. The dual of the event count is the interarrival time, defined as the length of the period between events. Count data
regression is useful in studying the occurrence rate per unit of time conditional
on some covariates. One could instead study the distribution of interarrival
times conditional on covariates. This leads to regression models of waiting
times or durations. The type of data available – cross-sectional, time series, or
longitudinal – will affect the choice of the statistical framework.
An obvious first question is whether “special methods” are required to handle
count data or whether the standard Gaussian linear regression may suffice. More
common regression estimators and models, such as the ordinary least squares
in the linear regression model, ignore the restricted support for the dependent
variable. This leads to significant deficiencies unless the mean of the counts is
high, in which case normal approximation and related regression methods may
be satisfactory.
The Poisson (log-linear) regression not only is motivated by the usual considerations for regression analysis but also seeks to preserve and exploit as much
as possible the nonnegative and integer-valued aspect of the outcome. At one
level one might simply regard it as a special type of nonlinear regression that
respects the discreteness of the count variable. In some analyses this specific
distributional assumption may be given up, while preserving nonnegativity.

1.1 Poisson Distribution and Its Characterizations

3

In econometrics the interest in count data models is a reflection of the
general interest in modeling discrete aspects of individual economic behavior.
For example, Pudney (1989) characterizes a large body of microeconometrics
as “econometrics of corners, kinks and holes.” Count data models are specific
types of discrete data regressions. Discrete and limited dependent variable
models have attracted a great deal of attention in econometrics and have found
a rich set of applications in microeconometrics (Maddala, 1983), especially as
econometricians have attempted to develop models for the many alternative
types of sample data and sampling frames. Although the Poisson regression
provides a starting point for many analyses, attempts to accommodate numerous
real-life conditions governing observation and data collection lead to additional
elaborations and complications.
This introductory chapter presents the Poisson distribution and some of its
characterizations in section 1.1, the Poisson regression model in section 1.2,
and some leading examples of count data in section 1.3. An outline of the book
is provided in section 1.4.
The scope of count data models is very wide. This monograph addresses
issues that arise in the regression models for counts, with a particular focus on
features of economic data. In many cases, however, the material covered can
be easily adapted for use in other social sciences and in natural sciences, which
do not always share the peculiarities of economic data.
1.1 POISSON DISTRIBUTION AND ITS
CHARACTERIZATIONS
The benchmark parametric model for count data is the Poisson distribution. It is
useful at the outset to review some fundamental properties and characterization
results of the Poisson distribution (for derivations, see Taylor and Karlin, 1998).
If the discrete random variable Y is Poisson distributed with intensity or rate
parameter μ, μ > 0, and t is the exposure, defined as the length of time during
which the events are recorded, then Y has density
Pr[Y = y] =

e−μt (μt)y
,
y!

y = 0, 1, 2, . . . ,

(1.1)

where E[Y ] = V[Y ] = μt.
If we set the length of the exposure period t equal to unity, then
Pr[Y = y] =

e−μ μy
,
y!

y = 0, 1, 2, . . . .

(1.2)

The probabilities satisfy the recurrence relation
Pr[Y = y + 1](y + 1) = Pr[Y = y]μ.

(1.3)

The Poisson distribution has a single parameter μ and we refer to it as P[μ].
Its k th raw moment, E[Y k ], may be derived by differentiating the moment

4

Introduction

generating function (mgf) k times
M(t) ≡ E[etY ] = exp{μ(et − 1)},
with respect to t and evaluating at t = 0. This yields the following four raw
moments:
μ1 = μ
μ2 = μ + μ2
μ3 = μ + 3μ2 + μ3
μ4 = μ + 7μ2 + 6μ3 + μ4 .
Following convention, raw moments are denoted by primes, and central
moments without primes. The central moments around μ can be derived from
the raw moments in the standard way. Note that the first two central moments,
denoted μ1 and μ2 , respectively, are equal to μ. The central moments satisfy
the recurrence relation
μr+1 = rμμr−1 + μ

∂μr
,
∂μ

r = 1, 2, . . . ,

(1.4)

where μ0 = 0.
Equality of the mean and variance is referred to as the equidispersion
property of the Poisson. This property is frequently violated in real-life data.
Overdispersion (underdispersion) means that the variance exceeds (is less than)
the mean.
A key property of the Poisson distribution is additivity. This is stated by
the following Countable Additivity Theorem (for a mathematically precise
statement, see Kingman, 1993).
i = 1, 2, . 
. . are independent random variables, and
Theorem.
If Yi ∼ P[μi ],

if μi < ∞, then SY = Yi ∼ P[ μi ].
The binomial and the multinomial can be derived from the Poisson by
appropriate conditioning. Under the already stated conditions,
= yn | SY 
= s]
Pr[Y1= y1 , Y2 = y2 , .. . , Y
n
s − μ 
−μj yj
i
e
μ
μi e
n
j
=

j =1
yj !
s!


y1 
y2
μ
μ
s!
μ
1
2
=
··· n
μi
μi
μi
y1 !y2 ! . . . yn !
s!
y1 y2
yn
π π . . . πn ,
=
y1 !y2 ! . . . yn ! 1 2

yn

(1.5)



where s = Yi and π j = μj / μi . This is the multinomial distribution
m[s ; π 1 , . . . , π n ]. The binomial is the case n = 2.

1.1 Poisson Distribution and Its Characterizations

5

There are many characterizations of the Poisson distribution. Here we consider four. The first, the law of rare events, is a common motivation for the
Poisson. The second, the Poisson counting process, is very commonly encountered in an introduction to stochastic processes. The third is simply the dual of
the second, with waiting times between events replacing the count. The fourth
characterization, the Poisson-stopped binomial, treats the number of events as
repetitions of a binomial outcome, with the number of repetitions taken as
Poisson distributed.
1.1.1

Poisson as the Law of Rare Events

The law of rare events states that the total number of events will follow, approximately, the Poisson distribution if an event may occur in any of a large number
of trials, but the probability of occurrence in any given trial is small.
More formally, let Yn,π denote the total number of successes in a large
number n of independent Bernoulli trials, with the success probability π of
each trial being small. Then the distribution is binomial with

n k
π (1 − π )n−k , k = 0, 1, . . . , n.
Pr Yn,π = k =
k
In the limiting case where n → ∞, π → 0, and nπ = μ > 0 – that is, the
average μ is held constant while n → ∞ – we have


n
μ k
μk e−μ
μ n−k
=
,
1−
lim
n→∞
k
n
n
k!
the Poisson probability distribution with parameter μ, denoted as P[μ].
1.1.2

Poisson Counting Process

The Poisson distribution has been described as characterizing “complete randomness” (Kingman, 1993). To elaborate this feature, the connection between
the Poisson distribution and the Poisson process needs to be made explicit.
Such an exposition begins with the definition of a counting process.
A stochastic process {N (t), t ≥ 0} is defined to be a counting process if N (t)
denotes an event count up to time t. N (t) is nonnegative and integer valued
and must satisfy the property that N (s) ≤ N(t) if s < t, and N (t) − N (s) is
the number of events in the interval (s, t]. If the event counts in disjoint time
intervals are independent, the counting process is said to have independent
increments. It is said to be stationary if the distribution of the number of events
depends only on the length of the interval.
The Poisson process can be represented in one dimension as a set of points
on the time axis representing a random series of events occurring at points of
time. The Poisson process is based on notions of independence and the Poisson
distribution in the following sense.

6

Introduction

Define μ to be the constant rate of occurrence of the event of interest,
and N (s, s + h) to be the number of occurrences of the event in the time
interval (s, s + h]. A (pure) Poisson process of rate μ occurs if events occur
independently with constant probability equal to μ times the length of the
interval. The numbers of events in disjoint time intervals are independent, and
the distribution of events in each interval of unit length is P[μ]. Formally, as
the length of the interval h → 0,
Pr [N(s, s + h) = 0] = 1 − μh + o(h)

(1.6)

Pr [N (s, s + h) = 1] = μh + o(h),

where o(h) denotes a remainder term with the property o(h)/ h → 0 as h → 0.
N (h, s + h) is statistically independent of the number and position of events in
(s, s + h]. Note that in the limit the probability of two or more events occurring
is zero, whereas 0 and 1 events occur with probabilities of, respectively, (1 −
μh) and μh. For this process it can be shown (Taylor and Karlin, 1998) that the
number of events occurring in the interval (s, s + h], for nonlimit h, is Poisson
distributed with mean μh and probability
Pr [N (s, s + h) = r] =

e−μh (μh)r
r!

r = 0, 1, 2, . . . .

(1.7)

Normalizing the length of the exposure time interval to be unity, h = 1, leads
to the Poisson density given previously. In summary, the counting process N (t)
with stationary and independent increments and N (0) = 0, which satisfies (1.6),
generates events that follow the Poisson distribution.
1.1.3

Waiting-Time Distributions

We now consider a characterization of the Poisson that is the flip side of that
given in the preceding paragraph. Let W1 denote the time of the first event, and
Wr , r ≥ 1 the time between the (r − 1)th and r th event. The nonnegative random
sequence {Wr , r ≥ 1} is called the sequence of interarrival times, waiting times,
durations, or sojourn times. In addition to, or instead of, analyzing the number
of events occurring in the interval of length h, one can analyze the duration of
time between successive occurrences of the event, or the time of occurrence of
the r th event, Wr . This requires the distribution of Wr , which can be determined
by exploiting the duality between event counts and waiting times. This is easily
done for the Poisson process.
The outcome {W1 > t} occurs only if no events occur in the interval [0, t].
That is,
Pr[W1 > t] = Pr[N (t) = 0] = e−μt ,

(1.8)

which implies that W1 has exponential distribution with mean 1/μ. The
waiting time to the first event, W1 , is exponentially distributed with density

1.1 Poisson Distribution and Its Characterizations

7

fW1 (t) = μe−μt , t  0. Also,
Pr[W2 > t|W1 = s] = Pr[N(s, s + t) = 0|W1 = s]
= Pr[N (s, s + t) = 0]
= e−μt ,
using the properties of independent stationary increments. This argument can
be repeated for Wr to yield the result that Wr , r = 1, 2, . . ., are iid exponential
random variables with mean 1/μ. This result reflects the property that the
Poisson process has no memory.
In principle, the duality between the number of occurrences and time
between occurrences suggests that count and duration data should be covered in the same framework. Consider the arrival time of the r th event, denoted
Sr ,
Sr =

r


Wi ,

r ≥ 1.

(1.9)

i=1

It can be shown using results on sums of random variables of exponential
random variables that Sr has one-parameter gamma distribution with density
fSr (t) =

μr t r−1 −μt
e ,
(r − 1)!

t ≥ 0.

(1.10)

This is a special case of a more general result derived in Chapter 4.10. The
density (1.10) can also be derived by observing that
N(t) ≥ r ⇔ Sr ≤ t.

(1.11)

Hence
Pr [N (t) ≥ r] = Pr [Sr ≤ t]
=

∞

j =r

e−μt

(μt)j
.
j!

(1.12)

To obtain the density (1.10) of Sr , the cumulative distribution function (cdf)
given in (1.12) is differentiated with respect to t. Thus, the Poisson process
may be characterized in terms of the implied properties of the waiting times.
Suppose one’s main interest is in the role of the covariates that determine
the Poisson process rate parameter μ. For example, let μ = exp(x β). Then
from (1.8) the mean waiting time is given by 1/μ = exp(−x β), confirming the
intuition that the covariates affect the mean number of events and the waiting
times in opposite directions. This illustrates that, from the viewpoint of studying
the role of covariates, analyzing the frequency of events is the dual complement
of analyzing the waiting times between events.
The Poisson process is often too restrictive in practice. Mathematically
tractable and computationally feasible common links between more general
count and duration models are hard to find (see Chapter 4).

8

Introduction

In the waiting time literature, emphasis is on estimating the hazard rate, the
conditional instantaneous probability of the event occurring given that it has not
yet occurred, controlling for censoring due to not always observing occurrence
of the event. Andersen, Borgan, Gill and Keiding (1993), Kalbfleisch and
Prentice (2002), and Fleming and Harrington (2005) present, in great detail,
models for censored duration data based on the application of martingale theory
to counting processes.
We focus on counts. Even when duration is the more natural entity for
analysis, it may not be observed. If only event counts are available, count
regressions still provide an opportunity for studying the role of covariates in
explaining the mean rate of event occurrence. However, count analysis leads in
general to a loss of efficiency (Dean and Balshaw, 1997).
1.1.4

Binomial Stopped by the Poisson

Yet another characterization of the Poisson involves mixtures of the Poisson
and the binomial. Let n be the actual (or true) count process taking nonnegative
integer values with E[n] = μ, and V[n] = σ 2 . Let B1 , B2 , . . . , Bn be a sequence
of n independent and identically distributed Bernoulli trials, where each Bi takes
only two values, 1 or 0,with probabilities π and 1 − π , respectively. Define
the count variable Y = ni=1 Bi . For n given, Y follows a binomial distribution
with parameters n and π . Hence,
E[Y ] = E[E [Y |n]] = E[nπ ] = π E[n] = μπ
V[Y ] = V[E [Y |n]] + E[V [Y |n]] = (σ 2 − μ)π 2 + μπ .

(1.13)

The actual distribution of Y depends on the distribution of n. For Poissondistributed n it can be found using the following lemma.
Lemma. If π is the probability that Bi = 1, i = 1, . . . , n, and 1 − π the
probability that Bi = 0, and n ∼ P[μ], then Y ∼ P[μπ ].
To derive this result, begin with the probability generating function (pgf),
defined as g(s) = E[s B ], of the Bernoulli random variable B,
g(s) = (1 − π ) + π s,

(1.14)

for any real s. Let f (s) denote the pgf of the Poisson variable n, E[s n ]; that is,
f (s) = exp(−μ + μs).

(1.15)

Then the pgf of Y is obtained as
f (g(s)) = exp[−μ + μg(s)]
= exp[−μπ + μπ s],

(1.16)

which is the pgf of Poisson-distributed n with parameter μπ . This characterization of the Poisson has been called the Poisson-stopped binomial. This

1.2 Poisson Regression

9

characterization is useful if the count is generated by a random number of
repetitions of a binary outcome.
1.2 POISSON REGRESSION
The approach taken to the analysis of count data, especially the choice of the
regression framework, sometimes depends on how the counts are assumed to
arise. There are two common formulations. In the first, counts arise from a direct
observation of a point process. In the second, counts arise from discretization
(ordinalization) of continuous latent data. Other less used formulations appeal,
for example, to the law of rare events or the binomial stopped by Poisson.
1.2.1

Counts Derived from a Point Process

Directly observed counts arise in many situations. Examples are the number of
telephone calls arriving at a central telephone exchange, the number of monthly
absences at the place of work, the number of airline accidents, the number of
hospital admissions, and so forth. The data may also consist of interarrival
times for events. In the simplest case, the underlying process is assumed to
be stationary and homogeneous, with iid arrival times for events and other
properties stated in the previous section.
1.2.2

Counts Derived from Continuous Data

Count-type variables sometimes arise from categorization of a latent continuous
variable as the following example indicates. Credit rating of agencies may
be stated as “AAA,” “AAB,” “AA,” “A,” “BBB,” “B,” and so forth, where
“AAA” indicates the greatest credit worthiness. Suppose we code these as
y = 0, 1, . . . , m. These are pseudocounts that can be analyzed using a count
regression. But one may also regard this categorization as an ordinal ranking
that can be modeled using a suitable latent variable model such as ordered
probit. Section 3.6 provides a more detailed exposition.
1.2.3

Regression Specification

The standard model for count data is the Poisson regression model, which
is a nonlinear regression model. This regression model is derived from the
Poisson distribution by allowing the intensity parameter μ to depend on covariates (regressors). If the dependence is parametrically exact and involves exogenous covariates but no other source of stochastic variation, we obtain the
standard Poisson regression. If the function relating μ and the covariates is
stochastic, possibly because it involves unobserved random variables, then one
obtains a mixed Poisson regression, the precise form of which depends on the
assumptions about the random term. Chapter 4 deals with several examples of
this type.

10

Introduction

A standard application of Poisson regression is to cross-section data. Typical cross-section data for applied work consist of n independent observations,
the i th of which is (yi , xi ). The scalar dependent variable yi is the number of
occurrences of the event of interest, and xi is the vector of linearly independent
regressors that are thought to determine yi . A regression model based on this
distribution follows by conditioning the distribution of yi on a k-dimensional
vector of covariates, xi = [x1i , . . . , xki ], and parameters β, through a continuous function μ(xi , β), such that E[yi |xi ] = μ(xi , β).
That is, yi given xi is Poisson distributed with density
e−μi μi i
,
yi !
y

f (yi |xi ) =

yi = 0, 1, 2, . . .

(1.17)

In the log-linear version of the model the mean parameter is parameterized as
μi = exp(xi β),

(1.18)

to ensure μ > 0. Equations (1.17) and (1.18) jointly define the Poisson (loglinear) regression model. If one does not wish to impose any distributional
assumptions, (1.18) by itself may be used for (nonlinear) regression analysis.
For notational economy we write f (yi |xi ) in place of the more formal
f (Yi = yi |xi ), which distinguishes between the random variable Y and its
realization y. Throughout this book we refer to f (·) as a density even though
more formally it is a probability mass function.
By the property of the Poisson, V[yi |xi ] = E[yi |xi ], implying that the conditional variance is not a constant, and hence the regression is intrinsically
heteroskedastic. In the log-linear version of the model the mean parameter is
parameterized as (1.18), which implies that the conditional mean has a multiplicative form given by
E[yi |xi ] = exp(xi β)
= exp(x1i β 1 ) exp(x2i β 2 ) · · · exp(xki β k ),
with interest often lying in changes in this conditional mean due
 to changes
in the regressors. The additive specification, E[yi |xi ] = xi β = kj =1 xj i β j , is
likely to be unsatisfactory because certain combinations of β and xi will violate
the nonnegativity restriction on μi .
The Poisson model is closely related to the models for analyzing counted data
in the form of proportions or ratios of counts sometimes obtained by grouping
data. In some situations – for example when the population “at risk” is changing
over time in a known way – it is helpful to reparameterize the model as follows.
Let y be the observed number of events (e.g., accidents), N the known total
exposure to risk (i.e., number at risk), and x the known set of k explanatory
variables. The mean number of events μ may be expressed as the product of
N and π, the probability of the occurrence of event, sometimes also called
the hazard rate. That is, μ(x) = N(x)π(x, β). In this case the probability π is
parameterized in terms of covariates. For example, π = exp(x β). This leads

1.3 Examples

11

to a rate form of the Poisson model with the density
Pr [Y = y|N (x), x] =

e−μ(x) μ(x)y
,
y!

y = 0, 1, 2, . . . .

(1.19)

Variants of the Poisson regression arise in a number of ways. As was mentioned previously, the presence of an unobserved random error term in the conditional mean function, denoted ν i , implies that we specify it as E[yi |xi , ν i ].
The marginal distribution of yi , f (yi |xi ), will involve the moments of the distribution of ν i . This is one way in which mixed Poisson distributions may
arise.
1.3 EXAMPLES
Patil (1970), in earlier work, gives numerous applications of count data analysis
in the physical and natural sciences, but usually not in the regression context.
For count data regression there are now many examples of models that use
cross-sectional, time-series, or longitudinal data. Economics examples include
models of counts of doctor visits and other types of health care utilization;
occupational injuries and illnesses; absenteeism in the workplace; recreational
or shopping trips; automobile insurance rate making; labor mobility; entry and
exits from industry; takeover activity in business; mortgage prepayments and
loan defaults; bank failures; patent registration in connection with industrial
research and development; and frequency of airline accidents. Other social science applications include those in demographic economics, crime victimology,
marketing, political science and government, sociology, and so forth.
The data used in many of these applications have certain commonalities.
Events considered are often rare. Zero event counts are often dominant, leading
to a skewed distribution. Also there may be a great deal of unobserved heterogeneity in the individual experiences of the event in question. This unobserved
heterogeneity leads to overdispersion; that is, the actual variance of the process
exceeds the nominal Poisson variance even after regressors are introduced.
Several examples are described in the remainder of this section. The first
few examples are leading examples used for illustrative purposes throughout
this book.
1.3.1

Health Services

Health economics research is often concerned with the link between health
service utilization and economic variables such as income and price, especially
the latter, which can be lowered considerably by holding a health insurance
policy. Ideally one would measure utilization by expenditures, but if data come
from surveys of individuals it is more common to have data on the number
of times that health services are consumed, such as the number of visits to a
doctor in the past month and number of days in hospital in the past year, because
individuals can better answer such questions than those on expenditure.

Introduction

0

0

1000

1000

Frequency
2000 3000

Frequency
2000 3000

4000

4000

12

2
4
6
8
10
Number of doctor visits

12

0

2
4
6
8
10
Number of recreational trips

12

0
2
4
6
8
10
12
Generated Poisson with mean 0.3

0

0

500

100

Frequency
1000 1500

Frequency
200
300

2000

400

0

0

2

4
6
8
10
Number of children

12

Figure 1.1. Frequency distributions of counts for four types of events: Doctor
visits, generated Poisson data, recreational trips, and number of children.

Data sets with health care utilization measured in counts include the National
Health Interview Surveys and the Surveys on Income and Program Participation
in the United States, the German Socioeconomic Panel, and the Australian
Health Surveys.
The upper left panel of Figure 1.1 presents a histogram for data on the number
of doctor consultations in the past two weeks from the 1977–78 Australian
Health Survey. There is some overdispersion in the data, with the sample
variance of 0.64 approximately twice the sample mean of 0.30. This modest
overdispersion leads to somewhat more counts of zero (excess zeros) and fewer
counts of one or more than if the data were generated from the Poisson with
mean 0.30; see the histogram in the upper right panel of Figure 1.1. These
data from Cameron and Trivedi (1988) are analyzed in detail in Chapter 3, and
similar health use data are analyzed in Chapter 6.3.
There are numerous studies of the impact of insurance on health care use
as measured by the number of services. For example, Winkelmann (2004,
2006) studies the impact of health reform on doctor visits in Germany, using
data from the German Socioeconomic Panel, whereas Deb and Trivedi (2002)
analyze count data from the Rand Health Insurance Experiment.

1.3 Examples

1.3.2

13

Recreational Demand

In environmental economics, one is often interested in alternative uses of a
natural resource such as forest or parkland. To analyze the valuation placed on
such a resource by recreational users, economists often model the frequency of
the visits to a particular site as a function of the cost of usage and the economic
and demographic characteristics of the users.
The lower left panel of Figure 1.1 presents a histogram for survey data on the
number of recreational boating trips to Lake Somerville in East Texas. In this
case there is considerable overdispersion, with the sample variance of 39.59
much larger than the sample mean of 2.24. There is a very large spike at zero,
as well as a very long tail (the printed histogram was truncated at 12 trips).
Various models for these data from Ozuna and Gomaz (1995) are implemented
in Chapter 6.4.
1.3.3

Completed Fertility

Completed fertility refers to the total number of children born to a woman who
has completed childbearing. A popular application of the Poisson regression is
to model this outcome.
The lower right panel of Figure 1.1 presents a histogram for fertility data
from the British Household Panel Survey. In this case there is little overdispersion, with sample variance of 2.28 compared to the sample mean of 1.86; the
range of the data is quite narrow, with 98% of observations in the range 0–5
and the highest count being 11. Most notably, the data are bimodal, whereas
the Poisson is unimodal. Various models for these data are implemented in
Chapter 6.5.
1.3.4

Time Series of Asthma Counts

The preceding three examples were of cross-sectional counts. By contrast,
Davis, Dunsmuir, and Street (2003) and Davis, Dunsmuir, and Wang (1999)
analyze time series counts of daily admissions for asthma to a single hospital
at Campbelltown in the Sydney metropolitan area over the four years, 1990 to
1993. Figure 1.2 presents the frequency distribution of the count (upper left
panel), a time-series plot of the counts (upper right panel), and autocorrelation
coefficients of the counts (lower left panel) and of the squared counts (lower
right panel). The mean of the series is 1.94 and its variance is 2.71, so there
is some overdispersion. There is strong positive autocorrelation that is slow to
disappear. Furthermore, the time series exhibits some periodicity. The study by
Davis et al. (2003) confirms the presence of a Sunday effect, a Monday effect,
a positive linear time trend, and a seasonal effect. Thus the standard time series
data characteristics of continuous data also appear in this discrete data example.
Time series models are presented in Chapter 7.

Introduction

0

0

100

Frequency
200
300

Admissions for asthma
2
4

400

6

14

0

5
10
Admissions for asthma

5

10
Lag

15

15

0

20

40

60

80

100

Day

20

Autocorrelations of squared asthma
−0.10 0.00 0.10 0.20 0.30

Autocorrelations of asthma admissions
−0.10 0.00 0.10 0.20 0.30

0

0

5

10
Lag

15

20

Figure 1.2. Daily data on the number of hospital admissions for asthma.

1.3.5

Panel Data on Patents

The link between research and development and product innovation is an important issue in empirical industrial organization. Product innovation is difficult
to measure, but the number of patents is one indicator of it that is commonly
analyzed. Panel data on the number of patents received annually by firms in
the United States are analyzed by Hausman, Hall, and Griliches (1984), as well
as in many subsequent studies. Most panel studies estimate static models, but
some additionally introduce lagged counts as regressors. Panel data on patents
are studied in detail in Chapter 9.
1.3.6

Takeover Bids

In empirical finance the bidding process in a takeover is sometimes studied
either by using the probability of any additional takeover bids after the first
using a binary outcome model or by using the number of bids as a dependent
variable in a count regression. Jaggia and Thosar (1993) use cross-section data
on the number of bids received by 126 U.S. firms that were targets of tender
offers and actually taken over within one year of the initial offer. The dependent
count variable is the number of bids after the initial bid received by the target
firm. Interest centers on the role of management actions to discourage takeover,

1.3 Examples

15

the role of government regulators, the size of the firm, and the extent to which
the firm was undervalued at the time of the initial bid. These data are used in
Chapter 5.
1.3.7

Bank Failures

In insurance and finance, the frequency of the failure of a financial institution
and the time to failure of the institution are variables of interest. Davutyan
(1989) estimates a Poisson model for annual data on U.S. bank failures from
1947 to 1981. The focus is on the relation between bank failures and overall bank profitability, corporate profitability, and bank borrowings from the
Federal Reserve Bank. The sample mean and variance of bank failures are,
respectively, 6.343 and 11.820, suggesting some overdispersion. These time
series are obtained at much longer frequency than the daily asthma data, so
there are only 35 observations.
1.3.8

Accident Insurance

In the insurance literature the frequency of accidents and the cost of insurance
claims are often the variables of interest because they have an important impact
on insurance premiums. Dionne and Vanasse (1992) use data for 19,013 drivers
in Quebec on the number of accidents with damage in excess of $250 reported
to police over a one-year period. Most drivers had no accidents. The frequencies
are very low, with a sample mean of 0.070, though there are many observations.
The sample variance of 0.078 is close to the mean. Their paper uses crosssection estimates of the regression to derive predicted claims frequencies, and
hence insurance premiums, from data on different individuals with different
characteristics and records.
1.3.9

Credit Rating

How frequently mortgagees or credit card holders fail to meet their financial obligations is a subject of interest in credit ratings. Often the number of
defaulted payments is studied as a count variable. Greene (1994) analyzes
the number of major derogatory reports made after a delinquency of 60 days
or longer on a credit account, for 1,319 individual applicants for a major
credit card. Major derogatory reports are found to decrease with increases in
the expenditure-income ratio (average monthly expenditure divided by yearly
income). Age, income, average monthly credit-card expenditures, and whether
the individual holds another credit card are statistically insignificant.
1.3.10

Presidential Appointments

Univariate probability models and time series Poisson regressions have been
used to model the frequency with which U.S. presidents were able to appoint
U.S. Supreme Court Justices (King, 1987a). King’s regression model uses

16

Introduction

the exponential conditional mean function, with the number of presidential
appointments per year as the dependent variable. Explanatory variables are
the number of previous appointments, the percentage of population that was
in the military on active duty, the percentage of freshmen in the House of
Representatives, and the log of the number of seats in the Court. It is argued
that the presence of lagged appointments in the mean function permits a test for
serial independence. King’s results suggest negative dependence. However, it
is an interesting issue whether the lagged variable should enter multiplicatively
or additively. Chapter 7 considers this issue.
1.3.11

Criminal Careers

Nagin and Land (1993) use longitudinal data on 411 men for 20 years to study
the number of recorded criminal offenses as a function of observable traits of
criminals. These observable traits include psychological variables (e.g., IQ, risk
preference, neuroticism), socialization variables (e.g., parental supervision or
attachments), and family background variables. The authors model an individual’s mean rate of offending in a period as a function of time-varying and timeinvariant characteristics, allowing for unobserved heterogeneity among the
subjects. Furthermore, they also model the probability that the individual may
be criminally “inactive” in the given period. Finally, the authors adopt a nonparametric treatment of unobserved interindividual differences (see Chapter 4
for details). This sophisticated modeling exercise allows the authors to classify
criminals into different groups according to their propensity to commit crime.
1.3.12

Doctoral Publications

Using a sample of about 900 doctoral candidates, Long (1997) analyzes the
relation between the number of doctoral publications in the final three years of
Ph.D. studies and gender, marital status, number of young children, prestige of
Ph.D. department, and number of articles by mentor in the preceding three years.
He finds evidence that scientists fall into two well-defined groups: “publishers”
and “nonpublishers.” The observed nonpublishers are drawn from both groups
because some potential publishers may not have published just by chance,
swelling the numbers who will “never” publish. The author argues that the
results are plausible as “there are scientists who, for structural reasons, will not
publish” (Long, 1997, p. 249).
1.3.13

Manufacturing Defects

The number of defects per area in a manufacturing process is studied by Lambert
(1992) using data from a soldering experiment at AT&T Bell Laboratories. In
this application components are mounted on printed wiring boards by soldering
their leads onto pads on the board. The covariates in the study are qualitative,

1.4 Overview of Major Issues

17

Table 1.1. Joint frequency distribution of
emergency room visits and hospitalizations
ER\HOSP

0

1

2 or more

0
1
2 or more

72.4
6.4
1.2

7.3
5.0
1.0

1.5
1.4
3.8

being five types of board surface, two types of solder, nine types of pads, and
three types of panel. A high proportion of soldered areas had no defects, leading
the author to generalize the Poisson regression model to account for excess
zeros, meaning more zeros than are consistent with the Poisson formulation.
The probability of zero defects is modeled using a logit regression, jointly
with the Poisson regression for the mean number of defects (see Chapter 4 for
details).
1.3.14

Bivariate Data on Health Services

Munkin and Trivedi (1999) consider the joint modeling of two count variables
suspected of being strongly associated. Using a sample of 4,406 observations
obtained from the National Medical Expenditure Survey conducted in 1987
and 1988, the authors consider joint modeling of the number of emergency
room visits (ER) and the number of hospitalizations (HOSP). These variables
should be positively correlated across individuals because a stay in a hospital
often follows an emergency room visit. Table 1.1 presents an extract of their
joint frequency distribution. A feature of the data is that much of the probability
mass is concentrated at a relatively few pairs of realized outcomes.
1.4 OVERVIEW OF MAJOR ISSUES
We have introduced a number of important terms, phrases, and ideas. We now
indicate where in this book they are further developed.
Chapter 2 covers issues of estimation and inference that not only are relevant
to the rest of the monograph but also arise more generally. One issue concerns
the two leading frameworks for parametric estimation and inference, namely,
maximum likelihood and the moment-based methods. The former requires
specification of the joint density of the observations, and hence implicitly of all
population moments; the latter requires a limited specification of a certain number of moments, usually the first one or two only, and no further information
about higher moments. The discussion in this chapter has focused on distributional models. The moment-based approach makes weaker assumptions,
but generally provides less information about the data distribution. Important

18

Introduction

theoretical issues concern the relative properties of these two broad approaches
to estimation and inference. There are also issues of the ease of computation
involved. Chapter 2 addresses these general issues and reviews some of the
major results that are used in later chapters. This makes the monograph relatively self-contained.
Chapter 3 is concerned with the Poisson and negative binomial models
for count regression. These models have been the most widely used starting
points for empirical work. The Poisson density is only a one-parameter density
and is generally found to be too restrictive. A first step is to consider lessrestrictive models for count data, such as the negative binomial and generalized
linear models, which permit additional flexibility by introducing an additional
parameter or parameters and breaking the equality restriction between the conditional mean and the variance. Chapter 3 provides a reasonably self-contained
treatment of estimation and inference for these two basic models, which can
be easily implemented using widely available packaged software. This chapter
also includes issues of practical importance such as interpretation of coefficients and comparison and evaluation of goodness of fit of estimated models.
For many readers this material will provide an adequate introduction to single
equation count regressions.
Chapter 4 deals with mixed Poisson and related parametric models that are
particularly helpful when dealing with overdispersed data. One interpretation
of such processes is as doubly stochastic Poisson processes with the Poisson
parameter treated as stochastic (see Kingman, 1993, chapter 6). Chapter 4 deals
with a leading case of the mixed Poisson, the negative binomial. Overdispersion
is closely related to the presence of unobserved interindividual heterogeneity,
but it can also arise from occurrence dependence between events. Using crosssection data it may be practically impossible to identify the underlying source
of overdispersion. These issues are tackled in Chapter 4, which deals with
models, especially overdispersed models, that are motivated by non-Poisson
features of data that can occur separately or jointly with overdispersion, for
example, an excess of zero observations relative to either the Poisson or the
negative binomial, or the presence of censoring or truncation.
Chapter 5 deals with statistical inference and model evaluation for single
equation count regressions estimated using the methods of earlier chapters. The
objective is to provide the user with specification tests and model evaluation
procedures that are useful in empirical work based on cross-section data. As in
Chapter 2, the issues considered in this chapter have relevance beyond count
data models.
Chapter 6 provides detailed analysis of three empirical examples to illustrate
the single equation modeling approaches of earlier chapters, especially the
interplay of estimation and model evaluation that dominate empirical modeling.
Chapter 7 deals with time-series analysis of event counts. A time-series count
regression is relevant if data are T observations, the t th of which is (yt , xt ),
t = 1, . . . , T . If xt includes past values of yt , we refer to it as a dynamic count
regression. This involves modeling the serial correlation in the count process.

1.4 Overview of Major Issues

19

Both the static time-series count regression and dynamic regression models are
studied. This topic is still relatively underdeveloped.
Multivariate count models are considered in Chapter 8. An m-dimensional
multivariate count model is based on data on (yi , xi ), where yi is an (m × 1)
vector of variables that may all be counts or may include counts as well as other
discrete or continuous variables. Unlike the familiar case of the multivariate
Gaussian distribution, the term “multivariate” in the case of count models has
several different definitions. Hence, Chapter 8 deals more with a number of
special cases and provides relatively few results of general applicability.
Another class of multivariate models uses longitudinal or panel data, which
are analyzed in Chapter 9. Longitudinal count models have attracted much
attention, following the work of Hausman, Hall, and Griliches (1984). Such
models are relevant if the regression analysis is based on (yit , xit ), i = 1, . . . , n,
t = 1, . . . , T , where i and t are individual and time subscripts, respectively.
Dynamic panel data models also include lagged y variables as regressors. Unobserved random terms may also appear in multivariate and panel data models.
The usefulness of longitudinal data is that without such data it is extremely
difficult to distinguish between true contagion and apparent contagion.
Chapters 10 through 13 contain material based on more recent developments
and areas of current research activity. Some of these issues are actively under
investigation; their inclusion is motivated by our desire to inform the reader
about the state of the literature and to stimulate further effort. Chapter 10 deals
with models with simultaneity and nonrandom sampling, including sample
selection. Such models are often estimated with either less parametric nonlinear
instrumental variable type estimators or fully parametric maximum likelihood
methods. In Chapter 11, we review several flexible modeling approaches to
count data, including quantile methods adapted to counts and other methods that
are based on series expansion of densities. These methods permit considerable
flexibility in the variance-mean relationships and in the estimation of probability of events and may be described as “semiparametric.” Chapter 12 analyzes a
selected number of count models from a Bayesian perspective. Finally, Chapter 13 deals with the effects of measurement errors in either exposure or covariates, and with the problem of underrecorded counts.
We have attempted to structure this monograph, keeping in mind the interests
of researchers, practitioners, and new entrants to the field. The last group
may wish to gain a relatively quick understanding of the standard models and
methods, practitioners may be interested in the robustness and practicality of
methods, and researchers wishing to contribute to the field presumably want an
up-to-date and detailed account of the different models and methods. Wherever
possible we have included illustrations based on real data. Inevitably, in places
we have compromised, keeping in mind the constraints on the length of the
monograph. We hope that the bibliographic notes and exercises at the ends of
chapters will provide useful complementary material for all users.
In cross-referencing sections we use the convention that, for example, Chapter 3.4 refers to section 4 in Chapter 3. Vectors are defined as column vectors,

20

Introduction

with transposition giving a row vector, and are printed in bold lowercase.
Matrices are printed in bold uppercase.
Appendix A lists the acronyms that are used in the book. Some basic mathematical functions and distributions and their properties are summarized in
Appendix B. Appendix C provides some software information.
1.5 BIBLIOGRAPHIC NOTES
Johnson, Kemp, and Kotz (2005) is an excellent reference for statistical properties of the univariate Poisson and related models. A lucid introduction to
Poisson processes is provided in earlier sections of Kingman (1993). A good
introductory textbook treatment of Poisson processes and renewal theory is
Taylor and Karlin (1998). A more advanced treatment is in Feller (1971).
Another comprehensive reference on Poisson and related distributions with
full bibliographic details until 1967 is Haight (1967). Early applications of the
Poisson regression include Cochrane (1940) and Jorgenson (1961). Count data
analysis in the sciences is surveyed in a comprehensive three-volume collective
work edited by Patil (1970). Although volume 1 is theoretical, the remaining
two volumes cover many applications in the natural sciences.
In both biostatistics and econometrics, especially in health, labor, and environmental economics, there are many regression applications of count models,
which are mentioned throughout this book and especially in Chapter 6. Early
examples of applications in criminology, sociology, political science, and international relations are, respectively, Grogger (1990), Nagin and Land (1993),
Hannan and Freeman (1987), and King (1987a, 1987b). Basic references for
count regression are provided in Chapter 3.9.

CHAPTER 2

Model Specification and Estimation

2.1 INTRODUCTION
This chapter presents the general modeling approaches most often used in
count data analysis – likelihood-based, generalized linear models, and momentbased. Statistical inference for these nonlinear regression models is based on
asymptotic theory, which is also summarized.
The models and results vary according to the strength of the distributional
assumptions made. Likelihood-based models and the associated maximum likelihood estimator require complete specification of the distribution. Statistical
inference is usually performed under the assumption that the distribution is
correctly specified.
A less parametric analysis assumes that some aspects of the distribution of
the dependent variable are correctly specified, whereas others are not specified
or, if they are specified, are potentially misspecified. For count data models,
considerable emphasis has been placed on analysis based on the assumption of
correct specification of the conditional mean or of correct specification of both
the conditional mean and the conditional variance. This is a nonlinear generalization of the linear regression model, in which consistency requires correct
specification of the mean and efficient estimation requires correct specification of the mean and variance. It is a special case of the class of generalized
linear models that is widely used in the statistics literature. Estimators for
generalized linear models coincide with maximum likelihood estimators if the
specified density is in the linear exponential family. But even then the analytical distribution of the same estimator can differ across the two approaches if
different second moment assumptions are made. The term “quasi- (or pseudo-)
maximum likelihood estimation” is used to describe the situation in which
the assumption of correct specification of the density is relaxed. Here the first
moment of the specified linear exponential family density is assumed to be
correctly specified, whereas the second and other moments are permitted to be
incorrectly specified.
An even more general framework, which permits estimation based on any
specified moment conditions, is that of moment-based models. In the statistics
21

22

Model Specification and Estimation

literature this approach is known as estimating equations. In the econometrics
literature this approach leads to generalized method of moments estimation,
which is particularly useful if some regressors are endogenous rather than
exogenous.
Results for hypothesis testing also depend on the strength of the distributional assumptions. The classical statistical tests – Wald, likelihood ratio, and
Lagrange multiplier (or score) – are based on the likelihood approach. Analogs
of these hypothesis tests exist for the generalized method of moments approach.
Finally, the moments approach introduces a new class of tests of model specification, not just of parameter restrictions, called conditional moment tests.
Section 2.2 presents the simplest count model and estimator, the maximum
likelihood estimator of the Poisson regression model. It also explains the notation used throughout the book. The three main approaches – maximum likelihood, generalized linear models, and moment-based models – and associated
estimation theory are presented in, respectively, sections 2.3 through 2.5. Testing using these approaches is summarized in section 2.6. Section 2.7 considers
robust inference that adjusts standard errors for nonindependent observations
due to within-cluster correlation, time-series correlation, or spatial correlation. Throughout, statistical inference based on first-order asymptotic theory
is given, with results derived in section 2.8, except for the bootstrap with
asymptotic refinement, which is presented in section 2.6.5.
Basic count data analysis uses maximum likelihood extensively and also
generalized linear models. For more complicated data situations presented
in the second half of the book, generalized linear models and moment-based
models are increasingly used, as well as more complex likelihood-based models
that are estimated using simulation methods.
This chapter is a self-contained source, to be referred to as needed when
reading later chapters. It is also intended to provide a bridge between the statistics and econometrics literatures. Of necessity, the presentation is relatively
condensed and may be challenging to read in isolation, although motivation
for results is given. It assumes a background at the level of Davidson and
MacKinnon (2004) or Greene (2011).
2.2 EXAMPLE AND DEFINITIONS
2.2.1

Example

The starting point for cross-section count data analysis is the Poisson regression
model. This assumes that yi given the vector of regressors xi is independently
Poisson distributed with density
e−μi μi i
,
yi !
y

f (yi |xi ) =

yi = 0, 1, 2, . . . ,

(2.1)

and mean parameter
μi = exp(xi β),

(2.2)

2.2 Example and Definitions

23

where β is a k × 1 parameter vector. Counting process theory provides a motivation for choosing the Poisson distribution; taking the exponential of xi β in
(2.2) ensures that the parameter μi is nonnegative. This model implies that the
conditional mean is given by
E[yi |xi ] = exp(xi β),

(2.3)

with interest often lying in changes in this conditional mean due to changes
in the regressors. It also implies a particular form of heteroskedasticity, due to
equidispersion or equality of the conditional variance and conditional mean,
V[yi |xi ] = exp(xi β).

(2.4)

The standard estimator for this model is the maximum likelihood estimator
(MLE). Given independent observations, the log-likelihood function is
L(β) =

n


{yi xi β − exp(xi β) − ln yi !}.

(2.5)

i=1

Differentiating (2.5) with respect to β yields the Poisson MLE β̂ as the solution
to the first-order conditions
n

(yi − exp(xi β))xi = 0.

(2.6)

i=1

These k equations are nonlinear in the k unknowns β, and there is no analytical
solution for β̂. Iterative methods, usually gradient methods such as NewtonRaphson, are needed to compute β̂. Such methods are given in standard texts.
Another consequence of there being no analytical solution for β̂ is that
exact distributional results for β̂ are difficult to obtain. Inference is accordingly
based on asymptotic results, presented in the remainder of this chapter. There are
several ways to proceed. First, we can view β̂ as the estimator maximizing (2.5)
and apply maximum likelihood theory. Second, we can view β̂ as being defined
by (2.6). These equations have a similar interpretation to those for the ordinary
least squares (OLS) estimator. That is, the unweighted residual (yi − μi ) is
orthogonal to the regressors. It is therefore possible that, as for OLS, inference
can be performed under assumptions about just the mean and possibly variance.
This is the generalized linear models approach. Third, because (2.3) implies
E[(yi − exp(xi β))xi ] = 0, we can define an estimator that is the solution to the
corresponding moment condition in the sample, that is, the solution to (2.6).
This is the moment-based models approach.
2.2.2

Definitions

We use the generic notation θ ∈ R q to denote the q × 1 parameter vector
to be estimated. In the Poisson regression example, the only parameters are
the regression parameters, so θ = β and q = k. In the simplest extensions,

24

Model Specification and Estimation

an additional scalar dispersion parameter α is introduced, so θ  = (β  α) and
q = k + 1.
We consider random variables θ̂ that converge in probability to a value θ ∗ ,
p

θ̂ → θ ∗ ,
or equivalently the probability limit (plim) of θ̂ equals θ ∗ ,
plim θ̂ = θ ∗ .
The probability limit θ ∗ is called the pseudotrue value. If the data generating
process (dgp) is a model with θ = θ 0 , and the pseudotrue value actually equals
θ 0 , so θ 0 = θ ∗ , then θ̂ is said to be consistent for θ 0 .
Estimators θ̂ used are usually root-n consistent
√ for θ ∗ and asymptotically
normally distributed. Then the random variable n(θ̂ − θ ∗ ) converges in distribution to the multivariate normal distribution with mean 0 and variance C,
√

d

n(θ̂ − θ ∗ ) → N[0, C],

(2.7)

where C is a finite positive definite matrix. It is sometimes notationally convenient to express (2.7) in the simpler form
a

θ̂ ∼ N[θ ∗ , D],

(2.8)

where D = n1 C. That is, θ̂ is asymptotically normal distributed with mean θ ∗
and variance D = n1 C. The division of the finite matrix C by the sample size
makes it clear that as the sample size goes to infinity the variance matrix n1 C
p
goes to zero, which is to be expected because θ̂ → θ ∗ .
The variance matrix C may depend on unknown parameters, and the result
(2.8) is operationalized by replacing C by a consistent estimator Ĉ. In many
cases C = A−1 BA−1 , where A and B are finite positive definite matrices. Then
Ĉ = Â−1 B̂Â−1 , where Â and B̂ are consistent estimators of A and B. This
is called the sandwich form, because B is sandwiched between A−1 and A−1
transposed. A more detailed discussion is given in section 2.5.1.
Results are expressed using matrix calculus. In general, the derivative
∂g(θ )/∂θ of a scalar function g(θ) with respect to the q × 1 vector θ is a
q × 1 vector with j th entry ∂g(θ)/∂θ j . The derivative ∂h(θ)/∂θ  of an r × 1
vector function h(θ) with respect to the 1 × q vector θ  is an r × q matrix with
j k th entry ∂hj (θ )/∂θ k .
2.3 LIKELIHOOD-BASED MODELS
Likelihood-based models are models in which the joint density of the dependent
variables is specified. For completeness a review is presented here, along with
results for the less standard case of maximum likelihood with the density
function misspecified.

2.3 Likelihood-Based Models

25

We assume that the scalar random variable yi given the vector of regressors
xi and parameter vector θ is distributed with density f (yi |xi , θ ). The likelihood
principle chooses as estimator of θ the value that maximizes the joint probability of observing the sample values y1 , . . . , yn . This probability, viewed as a
function of parameters conditional on the data, is called the likelihood function
and is denoted
n

f (yi |xi , θ ),
(2.9)
L(θ) =
i=1

where we suppress the dependence of L(θ ) on the data and have assumed
independence over i. This definition implicitly assumes cross-section data but
can easily accommodate time-series data by extending xi to include lagged
dependent and independent variables.
Maximizing the likelihood function is equivalent to maximizing the loglikelihood function
L(θ) = ln L(θ) =

n


ln f (yi |xi , θ ).

(2.10)

i=1

In the following analysis we consider the local maximum, which we assume to
also be the global maximum.
2.3.1

Regularity Conditions

The standard results on consistency and asymptotic normality of the MLE hold
if the so-called regularity conditions are satisfied. Furthermore, the MLE then
has the desirable property that it attains the Cramer-Rao lower bound and is
fully efficient. The following regularity conditions, given in Crowder (1976),
are used in many studies.
1. The pdf f (y, x, θ ) is globally identified and f (y, x, θ (1) ) =
f (y, x, θ (2) ), for all θ (1) = θ (2) .
2. θ ∈ , where  is finite dimensional, closed, and compact.
3. Continuous and bounded derivatives of L(θ ) exist up to order three.
4. The order of differentiation and integration of the likelihood may be
reversed.
5. The regressor vector xi satisfies
(a) xi xi < ∞
E[w 2 ]
∂ ln f (yi |xi , θ )
(b)  i 2 = 0 for all i, where wi ≡ xi
∂θ
i E[w
ni ]
2
i=1 E[wi | i−1 ]
(c) lim
n
= 1, where i−1 = (x1 , x2 , . . . , xi−1 ).
2
n→∞
i=1 E[wi ]
The first condition is an obvious identification condition, which ensures
that the limit of n1 L has a unique maximum. The second condition rules out
possible problems at the boundary of , and it can be relaxed if, for example,

26

Model Specification and Estimation

L is globally concave. The third condition can often be relaxed to existence
up to second order. The fourth condition is a key condition that rules out
densities for which the range of yi depends on θ . The final condition rules out
any observation making too large a contribution to the likelihood. For further
details on regularity conditions for commonly used estimators, not just the
MLE, see Newey and McFadden (1994).
2.3.2

Maximum Likelihood

We consider only the case in which the limit of n1 L is maximized at an interior
point of . The MLE θ̂ ML is then the solution to the first-order conditions,
∂L  ∂ ln fi
=
= 0,
∂θ
∂θ
i=1
n

(2.11)

where fi = f (yi |xi , θ ) and ∂L/∂θ is a q × 1 vector.
The asymptotic distribution of the MLE is usually obtained under the
assumption that the density is correctly specified. That is, the data generating process (dgp) for yi has density f (yi |xi , θ 0 ), where θ 0 is the true parameter
p
value. Then, under the regularity conditions, θ̂ → θ 0 , so the MLE is consistent
for θ 0 . Also,
√
d
n(θ̂ ML − θ 0 ) → N[0, A−1 ],
(2.12)
where the q × q matrix A is defined as
 n
 
 ∂ 2 ln fi 
1

A = − lim E
.
n→∞ n
∂θ∂θ  θ 0
i=1

(2.13)

A consequence of regularity conditions three and four is the information
matrix equality


∂ 2L
∂L ∂L
E
=
−E
,
(2.14)
∂θ ∂θ 
∂θ ∂θ 
for all values of θ ∈
over i and defining

. This is derived in section 2.8. Assuming independence

 n

 ∂ ln fi ∂ ln fi 
1

B = lim E
,
n→∞ n
∂θ
∂θ  θ 0
i=1

(2.15)

the information equality implies A = B.
To operationalize these results, one needs a consistent estimator of the
variance matrix in (2.12). There are many possibilities. The expected Fisher
information estimator takes the expectation (2.13) under the assumed density
and evaluates at θ̂ . The Hessian estimator simply evaluates (2.13) at θ̂ without
taking the expectation. The outer product (OP) estimator evaluates (2.15) at
θ̂ without taking the expectation. It was proposed by Berndt, Hall, Hall, and

2.3 Likelihood-Based Models

27

Hausman (1974) and is also called the BHHH estimator. A more general form
of the variance matrix of θ̂ ML , the sandwich form, is used if the assumption of
correct specification of the density is relaxed (see section 2.3.4).
As an example, consider the MLE for
the Poisson regression model presented
in section 2.2. In this case ∂L/∂β = i (yi − exp(xi β))xi and

exp(xi β)xi xi .
∂ 2 L/∂β∂β  = −
i

It follows that we do not even need to take the expectation in (2.13) to obtain


1 


A = lim
exp(xi β 0 )xi xi .
n→∞ n
i
Assuming E[(yi − exp(xi β 0 ))2 |xi ] = exp(xi β 0 ) – that is, correct specification
of the variance – leads to the same expression for B. The result is most conveniently expressed as
⎛
 n
−1 ⎞

a
⎠.
(2.16)
exp(xi β 0 )xi xi
β̂ ML ∼ N ⎝β 0 ,
i=1

In this case the Fisher information and Hessian estimators of V[θ̂ ML ] coincide
and differ from the outer-product estimator.
2.3.3

Profile Likelihood

Suppose the likelihood depends on a parameter vector λ in addition to θ, so the
likelihood function is L(θ, λ). The profile likelihood or concentrated likelihood
eliminates λ by obtaining the restricted MLE λ̂(θ) for fixed θ . Then
Lpro (θ) = L(θ , λ̂(θ)).

(2.17)

This approach can be used in all situations, but it is important to note that
Lpro (θ) is not strictly a log-likelihood function and that the usual results need
to be adjusted in this case (see, for example, Davidson and MacKinnon, 1993,
chapter 8).
The profile likelihood is useful if λ is a nuisance parameter. For example,
interest may lie in modeling the conditional mean that is parameterized by θ,
with variance parameters λ not intrinsically of interest. In such circumstances,
there is an advantage to attempting to estimate θ alone, especially if λ is of
high dimension.
For scalar θ the profile likelihood can be used to form a likelihood ratio
100(1 − α)% confidence region for θ , {θ : Lpro (θ )>L(θ̂, λ̂) − χ 21 (α)}, where
L(θ̂, λ̂) is the unconstrained maximum likelihood. This need not be symmetric
around θ̂ , unlike the usual confidence interval θ̂ ± zα/2 se[θ̂], where se[θ̂] is
the standard error of θ̂.

28

Model Specification and Estimation

Other variants of the likelihood approach can be used to eliminate nuisance
parameters in some special circumstances. The conditional likelihood is the
joint density of θ conditional on a sufficient statistic for the nuisance parameters
and is used, for example, to estimate the fixed effects Poisson model for panel
data. The marginal likelihood is the likelihood for a subset of the data that may
depend on θ alone. For further discussion, see McCullagh and Nelder (1989,
chapter 7).
2.3.4

Misspecified Density and Quasi-MLE

A weakness of the ML approach is that it assumes correct specification of the
complete density. To see the role of this assumption, it is helpful to begin with
an informal proof of consistency of the MLE in the usual case of correctly
specified density.
The MLE solves the sample moment condition ∂L/∂θ = 0, so an intuitive
necessary condition for consistency is that the same moment condition holds
in the population or E[∂L/∂θ] = 0, which holds if E[∂ ln fi /∂θ] = 0. Any
density f (y|x, θ ) satisfying the regularity conditions has the property that

∂ ln f (y|θ)
f (y|θ)dy = 0,
(2.18)
∂θ
see section 2.8 for a derivation. The consistency condition E[∂ ln f (y|x,
θ)/∂θ] = 0 is implied by (2.18), if the expectations operator is taken using
the assumed density f (y|x, θ ).
Suppose instead that the dgp is the density f ∗ (yi |zi , γ ) rather than the
assumed density f (yi |xi , θ ). Then (2.18) no longer implies the consistency
condition E[∂ ln f (y|x, θ )/∂θ] = 0, which now becomes

∂ ln f (y|x, θ ) ∗
f (y|z, γ )dy = 0,
∂θ
because the expectation should be with respect to the dgp density, not the
assumed density. Thus misspecification of the density may lead to inconsistency.
White (1982), following Huber (1967), obtained the distribution of the
MLE if the density function is incorrectly specified. Then the ML estimator
is called the quasi-MLE or pseudo-MLE, which we denote θ̂ QML . In general
p
θ ∗ , where the pseudotrue value θ ∗ is the value of θ that maximizes
θ̂ QML →
1 n
plim n i=1 ln f (yi |xi , θ ) and the probability limit is obtained under the dgp
f ∗ (yi |zi , γ ). Under suitable assumptions,
√
d
−1
n(θ̂ QML − θ ∗ ) → N[0, A−1
(2.19)
∗ B∗ A∗ ],
where

 n
 
 ∂ 2 ln fi 
1

A∗ = − lim E∗
n→∞ n
∂θ∂θ  θ ∗
i=1

(2.20)

2.4 Generalized Linear Models

and

 n
 
 ∂ ln fi ∂ ln fi 
1

,
B∗ = lim E∗
 
n→∞ n
∂θ
∂θ
θ∗
i=1

29

(2.21)

where fi = f (yi |xi , θ ) and the expectations E∗ are with respect to the dgp
f ∗ (yi |zi , γ ).
The essential point is that if the density is misspecified the MLE is in
general inconsistent. Generalized linear models, presented next, are the notable
exception. These models include the Poisson.
A second point is that the MLE has the more complicated variance function
with sandwich form (2.19), because the information matrix equality (2.14)
no longer holds. The sandwich estimator of the variance matrix of θ̂ ML is
Â−1 B̂Â−1 . Different estimates of Â and B̂ can be used (see section 2.3.2),
depending on whether or not the expectations in A∗ and B∗ are taken before
evaluation at θ̂ ML . The robust sandwich estimator does not take expectations.
2.4 GENERALIZED LINEAR MODELS
Although the MLE is in general inconsistent if the density is incorrectly specified, for some specified densities consistency may be maintained even given
partial misspecification of the model. A leading example is maximum likelihood estimation in the linear regression model under the assumption that yi
is independently N[xi β 0 , σ 2 ] distributed. Then β̂ ML equals the OLS estimator, which may be consistent even given nonnormality and heteroskedasticity,
because the essential requirement for consistency is correct specification of the
conditional mean: E[yi |xi ] = xi β 0 .
A similar situation arises for the Poisson regression model. Consistency
essentially requires that the population analog of (2.6) holds:
E[(yi − exp(xi β 0 ))xi ] = 0.
This is satisfied if E[yi |xi ] = exp(xi β 0 ). More generally such results hold for
ML estimation of models with specified density that is a member of the linear
exponential family, and estimation of the closely related class of generalized
linear models.
Although consistency in these models requires only correct specification
of the mean, misspecification of the variance leads to invalid statistical inference due to incorrect reported t-statistics and standard errors. For example,
in the linear regression model the usual reported standard errors for OLS are
incorrect if the error is heteroskedastic rather than homoskedastic. Adjustment
to the usual computer output needs to be made to ensure correct standard
errors. Furthermore, more efficient generalized least squares (GLS) estimation
is possible.
We begin with a presentation of results for weighted least squares for linear
models, results that carry over to generalized linear models. We then introduce

30

Model Specification and Estimation

generalized linear models by considering linear exponential family models.
These models are based on a one-parameter distribution, which in practice is
too restrictive. Extensions to two-parameter models have been made in two
ways – the linear exponential family with nuisance parameter and generalized
linear models. Further results for generalized linear models are then presented
before concluding with extended generalized linear models.
2.4.1

Weighted Linear Least Squares

Consider the linear regression model for yi with nonstochastic regressors xi .
In the linear model the regression function is xi β 0 . Suppose it is believed
that heteroskedasticity exists and as a starting point can be approximated by
V[yi ] = vi , where vi is known. Then one uses the weighted least squares (WLS)
estimator with weights 1/vi , which solves the first-order conditions
n

1
(yi − xi β)xi = 0.
v
i
i=1

(2.22)

We consider the distribution of this estimator if the mean is correctly specified, but the variance is not necessarily vi . It is helpful to express the first-order
conditions in matrix notation as
X V−1 (y − Xβ) = 0,

(2.23)

where y is the n × 1 vector with i th entry yi , X is the n × k matrix with i th
row xi , and V is the n × n weighting matrix with i th diagonal entry vi . These
equations have the analytical solution
β̂ WLS = (X V−1 X)−1 X V−1 y.
To obtain the mean and variance of β̂ WLS , we assume y has mean Xβ 0 and
variance matrix . Then it is a standard result that E[β̂ WLS ] = β 0 and
V[β̂ WLS ] = (X V−1 X)−1 X V−1 V−1 X(X V−1 X)−1 .

(2.24)

One familiar example of this is OLS. Then V = σ 2 I and V[β̂ WLS ] =
(X X)−1 X X(X X)−1 , which simplifies to σ 2 (X X)−1 if  = σ 2 I. A second
familiar example is GLS, with V = , in which case V[β̂ WLS ] = (X −1 X)−1 .
It is important to note that the general result (2.24) represents a different
situation from that in standard textbook treatments. One begins with a working
hypothesis about the form of the heteroskedasticity, say vi , leading to a working
variance matrix V. If V is misspecified then β̂ WLS is still unbiased, but it is
inefficient and most importantly has a variance matrix of the general form
(2.24), which does not impose V = . One way to estimate V[β̂ WLS ] is to
specify  to be a particular function of regressors and parameters and obtain
ˆ
consistent estimates of these parameters and hence a consistent estimator 
of . Alternatively, White (1980) and Eicker (1967) gave conditions under
which one need not specify the functional form for the variance matrix , but


2.4 Generalized Linear Models

31

 = Diag[(yi − x β̂ WLS )2 ], where Diag[ai ] denotes
can instead use the matrix 
i
the diagonal matrix with i th diagonal entry ai . The justification is that even
 is not consistent for , the difference between the k × k matrices
though 
1  −1  −1
 V X and n1 X V−1 V−1 X has probability limit zero.
X
V
n
These same points carry over to generalized linear models. One specifies
a working variance assumption such as variance-mean equality for the Poisson. The dependence of vi (and hence V) on μi does not change the result
(2.23). The estimator retains consistency if the mean is correctly specified, but
variance-mean inequality will lead to incorrect inference if one does not use
the general form (2.24). Generalized linear models have an additional complication, because the mean function is nonlinear. This can be accommodated
by generalizing the first-order conditions (2.22). Because in the linear case
μi = xi β, (2.22) can be reexpressed as
n

1
∂μ
(yi − μi ) i = 0.
v
∂β
i=1 i

(2.25)

The first-order conditions for generalized linear models such as the Poisson are
of the form (2.25). It can be shown that the preceding discussion still holds,
with the important change that the matrix X in (2.23) and (2.24) is now defined
to have i th row ∂μi /∂β  .
There is considerable overlap in the next three subsections, which cover different representations and variations of essentially the same model. In sections
2.4.2 and 2.4.3, the density is parameterized in terms of the mean parameter;
in section 2.4.4, the density is parameterized in terms of the so-called canonical parameter. The latter formulation is used in the generalized linear models
literature. To those unfamiliar with this literature, the mean parameter formulation may be more natural. For completeness both presentations are given here.
Other variations, such as different ways in which nuisance scale parameters are
introduced, are discussed at the end of section 2.4.4.
2.4.2

Linear Exponential Family Models

This presentation follows Cameron and Trivedi (1986), whose work was based
on Gourieroux, Monfort, and Trognon (1984a). A density fLEF (y|μ) is a member of a linear exponential family (LEF) with mean parameterization if
fLEF (y|μ) = exp{a(μ) + b(y) + c(μ)y},

(2.26)

where μ = E[y], and the functions a(·) and c(·) are such that
E[y] = − c (μ)

−1

a  (μ),

(2.27)

where a  (μ) = ∂a(μ)/∂μ and c (μ) = ∂c(μ)/∂μ, and
V[y] = c (μ)

−1

.

(2.28)

32

Model Specification and Estimation

The function b(·) is a normalizing constant. Different functional forms for a(·)
and c(·) lead to different LEF models. Special cases of the LEF include the
normal (with σ 2 known), Poisson, geometric, binomial (with number of trials
fixed), exponential, and one-parameter gamma.
For example, the Poisson density can be written as exp{−μ + y ln μ −
ln y!}, which is an LEF model with a(μ) = −μ, c(μ) = ln μ and b(y) = − ln
y! Then a  (μ) = −1 and c (μ) = 1/μ, so E[y] = μ from (2.27) and V[y] = μ
from (2.28).
Members of the exponential family have density f (y|λ) = exp{a(λ) +
b(y) + c(λ)t(y)}. The LEF is the special case t(y) = y, hence the qualifier
linear. The natural exponential family has density f (y|λ) = exp{a(λ) + λy}.
Other exponential families come from the natural exponential family by oneto-one transformations x = t(y) of y.
A regression model is formed by specifying the density to be fLEF (yi |μi )
where
μi = μ(xi , β),

(2.29)

for some specified mean function μ(·). The MLE based on an LEF, β̂ LEF ,
maximizes
LLEF

n

=
{a(μi ) + b(yi ) + c(μi )yi }.

(2.30)

i=1

The first-order conditions using (2.27) and (2.28) can be rewritten as
n

1
∂μ
(yi − μi ) i = 0,
v
∂β
i=1 i

(2.31)

where
vi = c (μi )

−1

(2.32)

is the specified variance function that is a function of μi and hence β. These
first-order conditions are of the form (2.25), and as seen subsequently we obtain
results similar to (2.24).
It is helpful at times to rewrite (2.31) as
n

(yi − μi ) 1 ∂μi
= 0,
√
√
vi
vi ∂β
i=1

(2.33)

which shows that the standardized residual is orthogonal to the standardized
regressor.
Under the standard assumption that the density is correctly specified, so the
dgp is fLEF (yi |μ(xi , β 0 )), application of (2.12) and (2.13) yields
√
d
n(β̂ LEF − β 0 ) → N[0, A−1 ],

(2.34)

2.4 Generalized Linear Models

where


n
1  1 ∂μi ∂μi 
.
n→∞ n
v ∂β ∂β  β 0
i=1 i

A = lim

33

(2.35)

Now consider estimation when the density is misspecified. Gourieroux,
Monfort, and Trognon. (1984a) call the estimator in this case the pseudomaximum likelihood (PML) estimator. Other authors call such an estimator
a quasimaximum likelihood estimator. Throughout this book we use the term
“quasi-ML,” because this has become the common terminology. Note that this
is a departure from the first edition of this book.
Assume (yi , xi ) is independent over i, the conditional mean of yi is correctly
specified as E[yi |xi ] = μ(xi , β 0 ), and
V[yi |xi ] = ωi

(2.36)

is finite but ωi = vi necessarily. Thus the mean is correctly specified, but other
features of the distribution such as the variance and density are potentially
p
misspecified. Then Gourieroux et al. (1984a) show that β̂ LEF → β 0 , so the MLE
is still consistent for β 0 . The intuition is that consistency of β̂ LEF essentially
requires that

 
∂μi 
1
(yi − μi )
E
= 0,
vi
∂β β 0
so that the conditions (2.31) hold in the population. This is the case if the
conditional mean is correctly specified because then E[yi − μ(xi , β 0 )|xi ] = 0.
Also
√
d
n(β̂ LEF − β 0 ) → N[0, A−1 BA−1 ],
(2.37)
where A is defined in (2.35) and

n
1  ωi ∂μi ∂μi 
.
B = lim
n→∞ n
vi2 ∂β ∂β  β 0
i=1

(2.38)

Note that vi is the working variance, the variance in the specified LEF density
for yi , whereas ωi is the variance for the true dgp. Note also that (2.37) equals
(2.24), where X is the n × k matrix with i th row ∂μi /∂β  , V = Diag[vi ],
and  = Diag[ωi ], confirming the link with results for weighted linear least
squares.
There are three important results. First, regardless of other properties of the
true dgp for y, the QMLE based on an assumed LEF is consistent provided the
conditional mean is correctly specified. This result is sometimes misinterpreted.
It should be clear that it is the assumed density that must be LEF, whereas the
true dgp need not be LEF.
Second, correct specification of the mean and variance is sufficient for the
usual maximum likelihood output to give the correct variance matrix for the

34

Model Specification and Estimation

QMLE based on an assumed LEF density. Other moments of the distribution
may be misspecified.
Third, if the only part of the model that is correctly specified is the conditional
mean, the MLE is consistent, but the usual ML output gives an inconsistent
estimate of the variance matrix, because it uses A−1 rather than the sandwich
form A−1 BA−1 . This is correct only if B = A, which requires ωi = vi , that is,
correct specification of the conditional variance of the dependent variable.
Correct standard errors are obtained by using as variance matrix n1 Â−1 B̂Â−1
where Â and B̂ equal A and B defined in, respectively, (2.35) and (2.37), eval−1
uated at μ̂i = μ(xi , β̂ LEF ), v̂i2 = c (μ̂i ) , and ω̂i . The estimate of the true
variance ω̂i can be obtained in two ways. First, if no assumptions are made
about the variance one can use ω̂i = (yi − μ̂i )2 by extension of results for the
OLS estimator given by White (1980). Even though ω̂i does not converge to ωi ,
p
under suitable assumptions B̂ → B. Second, a structural model for the variance
can be specified, say as ωi = ω(xi , β, α), where α is a finite dimensional nuisance parameter. Then we can use ω̂i = ω(xi , β̂ LEF , α̂), where α̂ is a consistent
estimate of α. Particularly convenient is ωi = αvi , because then B = αA so
that A−1 BA−1 = αA−1 .
As an example, consider the Poisson regression model with exponential
mean function μi = exp(xi β). Then ∂μi /∂β = μi xi . The Poisson specifies the
variance to equal the mean, so vi = ωi . Substituting in (2.35) yields
1
μ xi x ,
A = lim
n i i i
and similarly substituting in (2.38) yields
1
ωi xi xi .
B = lim
n i
In general for the correctly specified conditional mean, the Poisson QML estimator is asymptotically normal with mean β 0 and variance n1 A−1 BA−1 . If
additionally ωi = vi = μi so that the conditional variance of yi is correctly
specified, then A = B and the variance of the estimator simplifies to n1 A−1 .
2.4.3

LEF with Nuisance Parameter

Given specification of a true variance function, so ωi = ω(·), one can potentially
obtain a more efficient estimator, in the same way that specification of the
functional form of heteroskedasticity in the linear regression model leads to the
more efficient GLS estimator.
Gourieroux et al. (1984a) introduced the more general variance function
ωi = ω(μ(xi , β), α)

(2.39)

by defining the LEF with nuisance parameter (LEFN)
fLEFN (y|μ, α) = exp{a(μ, α) + b(y, α) + c(μ, α)y},

(2.40)

2.4 Generalized Linear Models

35

where μ = E[y] , ω(μ, α) = V[y], and α = ψ(μ, ω), where ψ(·) is a differentiable function of α and ω and ψ(·) defines for any given μ a one-to-one
relationship between α and ω. For a given α this is an LEF density, so the functions a(·) and c(·) satisfy (2.27) and (2.28), with c(μ, α) and a(μ, α) replacing
c(μ) and a(μ).
Gourieroux et al. (1984a) proposed the quasigeneralized pseudomaximum
likelihood (QGPML) estimator β̂ LEFN based on LEFN, which maximizes with
respect to β

μi , 
α )) + b(yi , ω(
μi , 
α ))
LLEFN = ni=1 {a(μi , ω(
(2.41)
μi , 
α ))yi }
+ c(μi , ω(
where 
μi = μ(xi , 
β) and 
β and 
α are root-n consistent estimates of β and α.
The first-order conditions can be reexpressed as
n

1
∂μ
(yi − μi ) i = 0.

ω
∂β
i
i=1

(2.42)

Assume (yi , xi ) is independent over i, and the conditional mean and variance of yi are correctly specified, so E[yi |xi ] = μ(xi , β 0 ) and V[yi |xi ] =
p
ω(μ(xi , β 0 ), α 0 ). Then β̂ LEFN → β 0 , so the QGPMLE is consistent for β 0 .
Also
√
d
n(β̂ LEFN − β 0 ) → N[0, A−1 ],
(2.43)
where


n
1  1 ∂μi ∂μi 
A = lim
.
n→∞ n
ωi ∂β ∂β  β 0
i=1

(2.44)

A consistent estimate for the variance matrix is obtained by evaluating A
α ). One can, of course, guard against
at μ̂i = μ(xi , β̂ LEFN ) and ω̂i = ω(μ̂i , 
possible misspecification of ωi in the same way that possible misspecification
of vi was handled in the previous subsection.
The negative binomial model with mean μ and variance μ + αμ2 is an
example of an LEFN model. The QGPMLE of this model is considered in
Section 3.3.
2.4.4

Generalized Linear Models

Generalized linear models (GLMs), introduced by Nelder and Wedderburn
(1972), are closely related to the LEFN model. Differences include a notational one due to the use of an alternative parameterization of the exponential
family, as well as several simplifications, including the use of more restrictive
parameterizations of the conditional mean and variance than (2.29) and (2.39).
A very useful simple summary of GLMs is presented in McCullagh and Nelder
(1989, chapter 2).

36

Model Specification and Estimation

A density fGLM (y|θ , φ) is a member of a linear exponential family with
canonical (or natural) parameter θ and nuisance parameter φ if


θ y − b(θ )
fGLM (y|θ , φ) = exp
+ c(y, φ) .
(2.45)
a(φ)
The function b(·) is such that
E[y] = b (θ ),

(2.46)



where b (θ) = ∂b(θ )/∂θ. The function a(φ) is such that
V[y] = a(φ)b (θ ),

(2.47)

where b (θ) = ∂ 2 b(θ )/∂θ 2 . Usually a(φ) = φ. The function c(·) is a normalizing constant. Different functional forms for a(·) and b(·) lead to different
GLMs. Note that the functions a(·), b(·), and c(·) for the GLM are different
from the functions a(·), b(·), and c(·) for the LEF and LEFN.
As an example, the Poisson is the case b(θ ) = exp(θ), a(φ) = 1, and
c(y, φ) = ln y!. Then (2.46) and (2.47) yield E[y] = V[y] = exp(θ).
Regressors are introduced in the following way. Define the linear predictor
η = x β.

(2.48)

The link function η = η(μ) relates the linear predictor to the mean μ. For
example, the Poisson model with mean μ = exp(x β) corresponds to the log
link function η = ln μ. A special case of the link function of particular interest
is the canonical link function, when
η = θ.

(2.49)

For the Poisson the log link function is the canonical link function, because
b(θ) = exp(θ ) implies μ = b (θ) = exp(θ), so η = ln μ = ln (exp(θ )) = θ.
The concept of link function can cause confusion. It is more natural to consider the inverse of the link function, which is the conditional mean function.
Thus, for example, the log link function is best thought of as being an exponential conditional mean function. The canonical link function is most easily
thought of as leading to the density (2.45) being evaluated at θ = x β.
The MLE based on a GLM, β̂ GLM , maximizes

n 

θ(xi β)yi − b(θ (xi β))
LGLM =
(2.50)
+ c(yi , φ) .
a(φ)
i=1
The first-order conditions can be reexpressed as
n

1
∂μ
(yi − μi ) i = 0,
ωi
∂β
i=1

(2.51)

where the variance function
ωi = a(φ) υ(μ(xi β)),

(2.52)

2.4 Generalized Linear Models

37

and
υ(μi ) = b (θ i ).

(2.53)

The first-order conditions (2.51) for the GLM are of similar form to the
first-order conditions (2.42) for the LEFN. This is because these two models
are essentially the same. To link the two models, invert μ = b (θ) to obtain
θ = d(μ). Then (2.45) can be rewritten as


−b(d(μ))
d(μ)
+ c(y, φ) +
y ,
(2.54)
fGLM (y|μ, φ) = exp
a(φ)
a(φ)
which is clearly of the form (2.40), with the restriction that in (2.40) a(μ, φ) =
a1 (μ)/a2 (φ) and c(μ, φ) = c1 (μ)/c2 (φ). This simplification implies that the
GLM variance function ω(μ(xi β), φ) is multiplicative in φ, so that the firstorder conditions can be solved for β without knowledge of φ. This is not
necessarily a trivial simplification. For example, for Poisson with a nuisance
parameter the GLM model specifies the variance function to be of multiplicative
form a(φ)μ. The LEFN model, however, allows variance functions such as the
quadratic form μ + φμ2 .
The same asymptotic theory as in section 2.4.3, therefore, holds. Assume
(yi , xi ) is independent over i, and the conditional mean and variance of yi are
correctly specified, so E[yi |xi ] = μ(xi , β 0 ) and V[yi |xi ] = a(φ 0 ) υ(μ(xi , β 0 )).
p
Then β̂ GLM → β 0 , so the MLE is consistent for β 0 . Also
√
d
n(β̂ GLM − β 0 ) → N[0, A−1 ]
(2.55)
where


n
1  1 ∂μi ∂μi 
.
n→∞ n
ωi ∂β ∂β  β 0
i=1

A = lim

(2.56)

A consistent estimate of the variance matrix is obtained by evaluating A at
μ̂i = μ(xi , β̂ GLM ) and ω̂i = a(φ̂) υ(μ̂i ). The standard estimate of φ is obtained
from
n

(yi − μ̂i )2
ˆ = 1
.
(2.57)
a(φ)
n − k i=1 υ(μ̂i )
Usually a(φ) = φ.
In summary, the basic GLM model is based on the same density as the LEF
and LEFN models presented in sections 2.4.2 through 2.4.3. However, it uses
a different parameterization of the LEF, canonical and not mean, that is less
natural if interest lies in modeling the conditional mean. The only real difference
in the models is that the basic GLM model of Nelder and Wedderburn (1972)
imposes some simplifying restrictions on the LEFN model that Gourieroux et
al. (1984a) consider.
First, the conditional mean function μ(xi , β) is restricted to be a function of
a linear combination of the regressors and so is of the simpler form μ(xi β). This

38

Model Specification and Estimation

specialization to a single-index model simplifies interpretation of coefficients
(see section 3.5) and permits computation of β̂ GLM using an iterative weighted
least squares procedure that is detailed in McCullagh and Nelder (1989, chapter
2) and is presented for the Poisson model in section 3.8. Thus GLMs can be
implemented even if one only has access to an OLS procedure. Given the
computational facilities available at the time the GLM model was introduced,
this was a considerable advantage.
Second, a particular parameterization of the conditional mean function, one
that corresponds to the canonical link, is preferred. It can be shown that then
∂μi /∂β = υ(μi )xi , so the first-order conditions (2.51) simplify to
n


(yi − μi )xi = 0,

(2.58)

i=1

which makes computation especially easy. The QGPMLE for the LEFN defined
in (2.42) does not take advantage of this simplification and instead solves
n

i=1

1
(yi − μi )υ(μi )xi = 0.
υ(
μi )

It is, however, asymptotically equivalent.
Third, the GLM variance function is of the simpler form ωi = a(φ) v(μi ),
which is multiplicative in the nuisance parameter. Then one can estimate β̂ GLM
without first estimating φ. A consequence is that with this simplification the
QGPMLE of β equals the QMLE. Both can be obtained by using a maximum
likelihood routine, with correct standard errors (or t-statistics) obtained by
multiplying (or dividing) the standard maximum likelihood output by the square
ˆ which is easily estimated using (2.57).
root of the scalar a(φ),
2.4.5

Extensions

The LEFN and GLM densities permit more flexible models of the variance
than the basic LEF density. Extensions to the LEF density that permit even
greater flexibility in modeling the variance, particularly regression models for
the variance, are extended quasilikelihood (Nelder and Pregibon, 1987), double
exponential families (Efron, 1986), exponential dispersion models (Jorgensen,
1987), and varying dispersion models (Smyth, 1989). A survey is provided by
Jorgensen (1997).
The presentation of GLMs has been likelihood based, in that the estimator
of β maximizes a log-likelihood function, albeit one possibly misspecified. An
alternative way to present the results is to take as starting point the first-order
conditions (2.51)
n

1
∂μ
(yi − μi ) i = 0.
ω
∂β
i
i=1

(2.59)

2.4 Generalized Linear Models

39

One can define an estimator of β to be the solution to these equations without
defining an underlying objective function whose derivative with respect to β
is (2.59). These estimating equations have many properties similar to those
of a log-likelihood derivative, and accordingly the left-hand side of (2.59) is
called a quasiscore function. For completeness one can attempt to integrate
this to obtain a quasilikelihood function. Accordingly, the solution to (2.59) is
called the quasilikelihood (QL) estimator. For further details, see McCullagh
and Nelder (1989, chapter 9).
It follows that the estimator of β in the GLM model can be interpreted either
(1) as a quasi-MLE or pseudo-MLE, meaning that it is an MLE based on a
possibly misspecified density, or (2) as a QL estimator, meaning that it is the
solution to estimating equations that look like those from maximization of an
unspecified log-likelihood function. It should be clear that in general the terms
QML and QL have different meanings.
The recognition that it is sufficient to simply define the QL estimating
equations (2.59) has led to generalizations of (2.59) and additional estimating
equations to permit, for example, more flexible models of the variance functions
that do not require specification of the density.
2.4.6

Generalized Estimating Equations

Suppose we generalize the GLM model to one with E[yij |xij ] = μij =
μ(xij , β), where data are independent over i but correlated over j . Leading
examples are longitudinal data on individual i in time period j , and grouped
data on, for example, individual j in village i. Then we can consistently estimate β, using the preceding methods that ignore the correlation over j , and
then we can obtain correct standard errors that control for the correlation over
j using the robust inference methods given in section 2.7.
More efficient estimation is possible if one models the correlation over
j and estimates by a method analogous to a nonlinear version of feasible
generalized least squares. Let yi = [yi1 , . . . , yiJ ] , μi (β) = [μi1 , . . . , μiJ ] ,
and Xi = [xi1 , . . . , xiJ ] , where for simplicity we considered balanced grouping
though the extension to Ji observations in the i th group is immediate. Let
i (α, β) denote the working variance matrix that is a model for V[yi |Xi ]. For
example, if data are equicorrelated then Cov yij , yik |Xi = ρσ ij σ ik , where
σ 2ij is a model for V yij |xij such as φμij for overdispersed Poisson (in this
example, α = [ρ φ] ). Then Liang and Zeger (1986) proposed the generalized
estimating equations estimator (GEE) estimator β̂ GEE , which solves
n

∂μi (β)
i=1

∂β 

ˆ −1
i (yi − μi (β)) = 0,

(2.60)

where ˆ i = i (α̂, β̂) and α̂ and β̂ are first-stage estimates of α and β. These
first-order conditions are a natural extension of the weighted linear least squares

40

Model Specification and Estimation

first-order conditions (2.22), and if i = V[yi |Xi ] are those for the optimal
GMM estimator derived below in section 2.5.3.
√
p
Given correct specification of μ(xij , β), β̂ GEE → β 0 and n(β̂ GEE −


d

β 0 ) → N[0, A−1 BA −1 ], where
1  ∂μi
A = lim
n→∞ n
∂β
i=1
n



 ,
∂β θ 0

−1 ∂μi

i

θ 0 = [α β] , and
1  ∂μi
B = lim
n→∞ n
∂β
i=1
n

−1
i V[yi |Xi ]

(2.61)



 .
∂β θ 0

−1 ∂μi

i

(2.62)

A consistent estimate for A is obtained by evaluation of (2.61) at θ̂, whereas
for B we use


n

1  ∂μi  ˆ −1
 ∂μi 
(y
−
μ̂
)(y
−
μ̂
)
.
(2.63)
B̂ =
i
i
i
i
i

n i=1 ∂β β̂
∂β β̂
In the special case that V[yi |Xi ] =
N[0, A−1 ].

i,

results simplify to

√

d

n(β̂ GEE − β 0 ) →

2.5 MOMENT-BASED MODELS
The first-order conditions (2.6) for the Poisson MLE can be motivated by noting
that the specification of the conditional mean, E[yi |xi ] = exp(xi β), implies the
unconditional population moment condition
E[(yi − exp(xi β))xi ] = 0.
A method of moments estimator for β is the solution to the corresponding
sample moment condition
n


(yi − exp(xi β))xi = 0.

i=1

In this example, the number of moment conditions equals the number of
parameters, so a numerical solution for β̂ is possible. This is a special case of the
estimating equations approach, presented in section 2.5.1. More generally, there
may be more moment conditions than parameters. Then we use the generalized
method of moments estimator, which minimizes a quadratic function of the
moment conditions and is presented in section 2.5.2.
2.5.1

Estimating Equations

We consider the q population moment conditions
E[gi (yi , xi , θ )] = 0,

i = 1, . . . , n,

(2.64)

2.5 Moment-Based Models

41

where gi is a q × 1 vector with the same dimension as θ . The estimator θ̂ EE
solves the corresponding estimating equations
n


gi (yi , xi , θ ) = 0,

(2.65)

i=1

a system of q equations in q unknowns. The term “estimating equations” here
should not be confused with the term GEE introduced in the preceding section.
If (2.64) holds at θ 0 and regularity conditions are satisfied,
√
d
n(θ̂ EE − θ 0 ) → N[0, A−1 BA−1 ],
(2.66)
where

 n
 
 ∂gi (yi , xi , θ ) 
1

A = lim E


n→∞ n
∂θ
θ0
i=1

(2.67)

 n



1

gi (yi , xi , θ )gi (yi , xi , θ ) θ 0 ,
B = lim E
n→∞ n
i=1

(2.68)

assuming independent observations.
The variance matrix in (2.66) is consistently estimated by Â−1 B̂Â−1 , where
Â and B̂ are any consistent estimates of A and B. Such estimators are called
sandwich estimators, because B̂ is sandwiched between Â−1 and Â−1 . Throughout the book we use the term robust sandwich (RS) estimator for the special
case when the consistent estimators of A and B are

n
1  ∂gi (yi , xi , θ ) 
(2.69)
Â =
 ,
n
∂θ 
i=1

θ̂ EE

and, assuming independence of the data over i,
1
gi (yi , xi , θ̂ EE )gi (yi , xi , θ̂ EE ) .
B̂ =
n i=1
n

(2.70)

This has the special property that it is robust to misspecification of the dgp, in
the sense that the expectations in (2.67) and (2.68) have been dropped. Section
2.7.1 presents adaptations of B̂ for correlated observations.
For example, the OLS estimator sets gi (yi , xi , β) = (yi − xi β)xi ; see (2.22)
with vi = 1. Then
1
E[(yi − xi β)2 ]xi xi .
B=
n i
A consistent estimator of B that makes no assumptions on E[(yi − xi β)2 ] is
1
B̂ =
(yi − xi β̂)2 xi xi .
n i

42

Model Specification and Estimation

White (1980), building on work by Eicker (1967), proposed this estimator to
guard against heteroskedasticity in models assuming homoskedasticity. Huber
(1967) and White (1982) proposed the sandwich estimator, see (2.19), to guard
against misspecification of the density in the maximum likelihood framework.
The robust sandwich estimator is often called the Huber estimator or EickerWhite estimator.
The estimating equation approach is general enough to include maximum
likelihood and GLM as special cases. GEE presented in section 2.4.6 is a mild
extension. Optimal estimating equations based on the first few moments of
the dependent variable are given in Chapter 11. Such extensions have tended
to be piecemeal and assume that the number of moment conditions equals the
number of parameters. A very general framework, widely used in econometrics
but rarely used in other areas of statistics, is generalized methods of moments.
This is now presented.
2.5.2

Generalized Methods of Moments

We consider the r population moment (or orthogonality) conditions
E[hi (yi , xi , θ )] = 0,

i = 1, . . . , n,

(2.71)

where hi is an r × 1 vector and r ≥ q, so that the number of moment conditions potentially exceeds the number of parameters. Overidentified instrumental
variables estimation, see section 2.5.4, is a leading example.
Hansen (1982) proposed the generalized methods of moments (GMM) estimator θ̂ GMM , which makes the sample moment corresponding to (2.71) as small
as possible in the quadratic norm


 n
 n


hi (yi , xi , θ ) Wn
hi (yi , xi , θ ) ,
(2.72)
i=1

i=1

where Wn is a possibly stochastic symmetric positive definite r × r weighting
matrix, which converges in probability to a nonstochastic matrix W. The GMM
estimator is calculated as the solution to the first-order conditions

 n

 n
 ∂h

i
hi = 0,
Wn
(2.73)
∂θ
i=1
i=1
where hi = hi (yi , xi , θ ). The solution will generally require an iterative technique. The parameter θ is identified if (2.73) has a unique solution.
p
Under suitable assumptions θ̂ → θ 0 , where θ 0 is the value of θ that
minimizes the probability limit of n−2 times the objective function (2.72).
Also
√

d

n(θ̂ GMM − θ 0 ) → N[0, A−1 BA−1 ],

(2.74)

2.5 Moment-Based Models

43

where the formulas for A and B are

where

A = H WH

(2.75)

B = H WSWH

(2.76)

 n
 
 ∂hi 
1

H = lim E

n→∞ n
∂θ
θ0
i=1

(2.77)

 n



1

S = lim E
hi hi θ 0 .
n→∞ n
i=1

(2.78)

The expression for S assumes independent observations. Note that substitution
of (2.75) and (2.76) into (2.74) yields an expression for the variance matrix of
the GMM estimator of the same form as (2.24) for the linear WLS estimator.
For a given choice of population moment condition hi (yi , xi , θ ) in (2.71), the
optimal choice of weighting matrix Wn in (2.72) is the inverse of a consistent
2step
estimator Ŝ of S. The two-step GMM estimator θ̂ GMM minimizes


 n
 n


−1
hi (yi , xi , θ ) Ŝ
hi (yi , xi , θ ) .
(2.79)
i=1

Then

i=1

√ 2step
d
n(θ̂ GMM − θ 0 ) → N[0, A−1 ],

(2.80)

A = H S−1 H.

(2.81)

where

A standard procedure is, first, to estimate the model by GMM with weighting
matrix Wn = Ir to obtain initial consistent estimates of θ and hence Ŝ, and,
second, to estimate again by GMM using Wn = Ŝ−1 .
It is important to note that this optimality is limited, because it is for a given
moment condition hi (yi , xi , θ ). Some choices of hi (yi , xi , θ ) are better than
others; see section 2.5.3. If the distribution is completely specified, the MLE is
optimal and
∂ ln f (yi |xi , θ )
.
∂θ
This is pursued further in section 2.5.3.
To operationalize, these results require consistent estimates of H and S. For
H use

n
1  ∂hi 
.
(2.82)
Ĥ =
n
∂θ  
hi (yi , xi , θ ) =

i=1

θ̂ GMM

44

Model Specification and Estimation

When observations are independent over i, one uses

1
hi hi θ̂ GMM .
n i=1
n

Ŝ =

(2.83)

See section 2.7 for extensions of Ŝ to correlated observations.
The GMM results simplify if r = q, in which case we have the estimating equations presented in the previous subsection. Then hi (yi , xi , θ ) =
gi (yi , xi , θ), H = A, B = S, where B assumes independence over i, and the
results are invariant to the choice of weighting matrix Wn . The estimating
equations estimator defined by (2.65) is the GMM estimator that minimizes
  n

 n


gi (yi , xi , θ )
gi (yi , xi , θ ) .
i=1

i=1

Unlike the general case r > q, this quadratic objective function takes value 0
at the optimal value of θ when r = q.
In the case that r > q the GMM objective function is nonzero, leading to
the overidentifying restrictions (OIR) test statistic


 n
 n

1 
2step
2step
−1
hi (yi , xi , θ̂ GMM ) Ŝ
hi (yi , xi , θ̂ GMM ) , (2.84)
TOIR =
n i=1
i=1
which is n−1 times the objective function (2.72). Hansen (1982) showed that
TOIR is asymptotically χ 2 (r − q) under H0 : E[hi (yi , xi , θ 0 )] = 0. Too large a
value of TOIR is interpreted as rejection of the moment conditions (2.71). It is
important to note that this test can be used only if estimation is by two-step
GMM.
2.5.3

Optimal GMM

We have already considered a limited form of optimal GMM. Given a choice
2step
of h(yi , xi , θ) in (2.71), the optimal GMM estimator is θ̂ GMM defined in (2.79),
which uses as a weighting matrix a consistent estimate of S defined in (2.78).
Now we consider the more difficult question of the optimal specification
of h(yi , xi , θ ) in the cross-sectional case or panel case where yi , xi are iid.
This is analyzed by Chamberlain (1987) and Newey (1990a), with an excellent
summary given in Newey (1993). Suppose interest lies in estimation based on
the conditional moment restriction
E[ρ(yi , xi , θ )|xi ] = 0,

i = 1, . . . , n,

(2.85)

where ρ(·) is a residual-type s × 1 vector function.
For example, let s = 2 with the components of ρ(·) being ρ 1 (yi , xi , θ ) =
yi − μi and ρ 2 (yi , xi , θ ) = (yi − μi )2 − σ 2i , where μi = μ(xi , θ ) and σ 2i =
ω(xi , θ ) are specified conditional mean and variance functions.

2.5 Moment-Based Models

45

Typically s is less than the number of parameters, so GMM estimation based
on (2.85) is not possible. Instead we introduce an r × s matrix of functions
D(xi ), where r ≥ q, and note that by the law of iterated expectations,
E[D(xi )ρ(yi , xi , θ )] = 0,

i = 1, . . . , n.

(2.86)

θ can be estimated by GMM based on (2.86), because there are now r ≥ q
moment conditions.
The variance of the GMM estimator can be shown to be minimized, given
(2.85), by choosing D(xi ) equal to the q × s matrix
 
−1

∂ρ(yi , xi , θ ) 
∗

.
D (xi ) = E
 xi E ρ(yi , xi , θ )ρ(yi , xi , θ ) |xi
∂θ
Premultiplication of D∗ (xi ) by an s × s matrix of constants (not depending on
xi ) yields an equivalent optimal estimator. It follows that the optimal choice of
h(yi , xi , θ ) for GMM estimation, given (2.85), is
 
∂ρ(yi , xi , θ ) 
h∗i (yi , xi , θ) = E
 xi
∂θ
−1

ρ(yi , xi , θ ). (2.87)
× E [ρ(yi , xi , θ )ρ(yi , xi , θ ) |xi ]
Note that here r = k, so h∗i (yi , xi , θ ) is q × q and the estimating equation results
of section 2.5.1 are applicable. The optimal GMM estimator is the solution to
n


h∗i (yi , xi , θ ) = 0.

i=1

The limit distribution is given in (2.66)–(2.68), with gi (·) = h∗i (·).
This optimal GMM estimator is applied, for example, to models with specified conditional mean and variance functions in Chapter 11.7.2.
2.5.4

Instrumental Variables Estimators

Hansen’s GMM estimator is based on earlier work on instrumental variables
by Sargan (1958) in the linear case and Amemiya (1974) in the nonlinear case.
Consider the linear regression model yi = xi β + ui . The OLS estimator
is inconsistent if E[ui |xi ] = 0, because then regressors are correlated with the
error. To obtain a consistent estimator, we assume the existence of instruments zi
satisfying E[ui |zi ] = 0, which in turn implies E[zi ui ] = E[zi (yi − xi β)] = 0.
In the case that dim[z] = dim[x], the model is
said to be just identified, and
the corresponding sample moment conditions ni=1 zi (yi − xi β) = 0 can be
solved to yield the linear instrumental variables (IV) estimator
 n
−1 n



zi xi
zi yi .
β̂ IV =
i=1

i=1

46

Model Specification and Estimation

If dim[z] > dim[x], 
the model is said to be overidentified and estimation is
by GMM, with hi (·) = ni=1 zi (yi − xi β). The two-stage least squares estima−1
 
tor (2SLS) is obtained using the weighting matrix Wn = n1 ni=1 zi zi
in (2.72). If errors are heteroskedastic the optimal GMM estimator uses
−1
 
Wn = n1 ni=1 û2i zi zi , where ûi = yi − xi β̂ and β̂ is a consistent estimator
such as 2SLS.
In many applications only one component of xi is correlated with ui . Then
IV estimation requires finding at least one instrument for that component, while
the remaining components of xi can be used as instruments for themselves. If
there are more instruments than necessary, then too large a value of the OIR
test in (2.84) is interpreted as rejection of the validity of the excess instruments.
For the nonlinear regression model yi = μ(xi β) + ui , Amemiya (1974) proposed the nonlinear two-stage least squares or nonlinear instrumental variables
(NLIV) estimator, which minimizes
 n
−1  n

 n







(yi − μ(xi β))zi
zi zi
(yi − μ(xi β))zi , (2.88)
i=1

i=1

i=1

where zi is an r × 1 set of instruments such that E[yi − μ(xi β)|zi ] = 0.
This is a GMM estimator where hi (·) = (yi − μ(xi β))zi in (2.72). The
weightingmatrix in (2.88) is optimal if V[yi |zi ] = σ 2 , because then S =
σ 2 lim n1 ni=1 zi zi , and the variance of the estimator from (2.81) is H S−1 H

where H = lim n1 ni=1 zi ∂μi /∂β  . For further details, see Burguette, Gallant,
and Souza (1982), Hansen (1982), and Newey (1990a). This estimator is used,
for example, in Chapter 10.4, which also considers extension to heteroskedastic
errors.
2.5.5

Sequential 2-Step Estimators

The GMM framework is quite general. One example of its application is to
sequential two-step estimators. Consider the case in which a model depends
on vector parameters θ 1 and θ 2 , and the model is estimated
 sequentially: (1)
θ 1) =
Obtain a root-n consistent estimate 
θ 1 of θ 1 that solves ni=1 h1i (yi , xi , 

0,
and
(2)
obtain
a
root-n
consistent
estimate
θ̂
of
θ
given
θ
that
solves
2
2
1
n

i=1 h2i (yi , xi , θ 1 , θ̂ 2 ) = 0.
In general, the distribution of θ̂ 2 given estimation of 
θ 1 differs from, and
is more complicated than, the distribution of θ̂ 2 if θ 1 is known. Statistical
inference is invalid if it fails to take into account this complication. Newey
(1984) proposed obtaining the distribution of θ̂ 2 by noting that (θ 1 , θ 2 ) jointly
solve the equations
n

h1i (yi , xi , θ 1 ) = 0
n

i=1

i=1

h2i (yi , xi , θ 1 , θ 2 ) = 0.

2.5 Moment-Based Models

47

This is simply a special case of
n


hi (yi , xi , θ ) = 0,

i=1

defining θ = (θ 1 θ 2 ) and hi = (h1i h2i ) . This is a GMM estimator with
Wn = W = I. Applying (2.74) with A and B partitioned similarly to θ and hi
yields a variance matrix for θ̂ 2 that is quite complicated, even though simplification occurs because ∂h1i (θ)/∂θ 2 = 0. The expression is given in Newey
(1984), Murphy and Topel (1985), Pagan (1986), and several texts. See also
Pierce (1982). It is often easier to bootstrap; see section 2.6.4.
A well-known exception to the need to take account of the randomness due
to estimation of 
θ 1 is feasible GLS, where θ 1 corresponds to the first-round
estimates used to consistently estimate the variance matrix, and θ 2 corresponds
to the second-round feasible GLS estimates of the regression parameters for
the conditional mean.
Such simplification occurs whenever E[∂h2i (θ)/∂θ 1 ] = 0. This simplification holds for the GLM and LEFN models. To see this for LEFN, from (2.42)
θ1 = 
α
with θ̂ 2 = β̂ LEFN and 
h2i (θ) =

1

ωi (
θ 1)

(yi − μi (θ 2 ))

∂μi (θ 2 )
,
∂θ 2

it follows that E[∂h2i (θ)/∂θ 1 ] = 0.
This simplification also arises in the ML framework for jointly estimated θ 1
and θ 2 if the information matrix is block-diagonal. Then the variance of θ̂ 1,ML
is simply the inverse of −E[∂ 2 L(θ)/∂θ 1 ∂θ 1 ] = E[∂(∂L(θ)/∂θ 1 )/∂θ 1 ]. An
example is the negative binomial distribution with quadratic variance function;
see Chapter 3.3.1.
2.5.6

Empirical Likelihood

The moment-based approaches do not require complete specification of the
conditional density. The empirical likelihood approach, due to Owen (1988),
is an alternative estimation procedure based on the same moment conditions as
those in (2.64) or (2.71).
For scalar iid random variable y with density f (y), a completely nonparametric approach seeks to estimate the density f (y) evaluated at each of the
sample values of y. Let π i = f (yi ) denote the probability that the i th observation on y takes the realized value
 yi . Then the goal is to maximize the so-called
empirical likelihood function i π i , or equivalently to maximize the
empirical
log-likelihood function n−1 i ln π i , subject to the constraint that i π i = 1.
Some algebra yields the estimated density function fˆ(y) with mass 1/n at
each of the realized values yi , i = 1, . . . , n, and estimate F̂ (y) that is the usual
empirical distribution function.
For regression, a moment-based estimator adds the additional structure that
E[gi (yi , xi , θ )] = 0. For simplicity we consider the just-identified case where

48

Model Specification and Estimation

g(·) and θ are of the same dimension, although the method extends to GMM. The
maximum empirical likelihood
(EL) estimator θ̂ MEL maximizes
 the empirical

to
the
constraint
likelihood function n−1 i ln π i subject
i π i = 1 and the

additional sample constraint that i π i gi (yi , xi , θ ) = 0. Thus we maximize
with respect to π = (π 1 , . . . , π n ) , η, λ, and θ, using the Lagrangian
 n

n
n


1
ln π i − η
π i − 1 − λ
π i gi (yi , xi , θ ),
LEL (π, η, λ, θ ) =
n i=1
i=1
i=1
(2.89)
where the Lagrangian multipliers are a scalar η and column vector λ of the
same dimension as g(·).
Qin and Lawless (1994) show that θ̂ MEL has the same limit distribution
as θ̂ EE given in (2.66). The difference is that inference is based on sample
estimates

n
∂hi 
π̂ i
(2.90)
Â =
i=1
∂θ θ̂
n
π̂ i hi (θ̂)hi (θ̂) ,
B̂ =
i=1

that weight by the estimated probabilities π̂ i rather than the proportions 1/n
(see (2.69) and (2.70)). This leads to different finite sample properties, and in
some examples EL outperforms the estimating equations and GMM estimators.
EL is computationally more burdensome, however, so is not implemented
very often. The most commonly used estimator is the continuous updating
estimator (CUE) of Hansen, Heaton, and Yarron (1996) that minimizes


 n
 n


hi (yi , xi , θ ) S(θ )−1
hi (yi , xi , θ ) ,
i=1



i=1

where S(θ) is a model for Var[ i hi (θ)]. From (2.72) this is GMM with a
weighting matrix WN = S(θ )−1 that also depends on θ , and the CUE can be
shown to be a generalized EL estimator. For further details, see the survey by
Imbens (2002) and Cameron and Trivedi (2005, pp. 202–206).
2.6 TESTING
We consider the three classical tests for likelihood-based models, Wald tests
for general models, and conditional moment tests. We additionally present the
bootstrap, without and with asymptotic refinement.
2.6.1

Likelihood-Based Models

There is a well-developed theory for testing hypotheses in models in which
the likelihood function is specified. Then there are three “classical” statistical

2.6 Testing

49

techniques for testing hypotheses – the likelihood ratio, Wald, and Lagrange
multiplier (or score) tests.
Let the null hypothesis be
H0 : r(θ 0 ) = 0,
where r is an h × 1 vector of possibly nonlinear restrictions on θ, h ≤ q. Let
the alternative hypothesis be
Ha : r(θ 0 ) = 0.
For example, rl (θ) = θ 3 θ 4 − 1 if the l th restriction is θ 3 θ 4 = 1. We assume
the restrictions are such that the h × q matrix ∂r(θ)/∂θ  , with the lj th element
∂rl (θ)/∂θ j , has full rank h. This is the analog of the assumption of linearly
independent restrictions in the case of linear restrictions.
Let L(θ) denote the likelihood function, θ̂ u denote the unrestricted MLE that
maximizes L(θ ) = ln L(θ), and 
θ r denote the restricted MLE under H0 that
maximizes L(θ) − λ r(θ), where λ is an h × 1 vector of Lagrangian multipliers.
We now present the three standard test statistics. Under the regularity conditions they are all asymptotically χ 2 (h) under H0 , and H0 is rejected at significance level α if the computed test statistic exceeds χ 2 (h; α).
The likelihood ratio (LR) test statistic is
θ r ) − L(θ̂ u )].
TLR = −2[L(

(2.91)

The motivation for TLR is that, if H0 is true, the unconstrained and constrained
maxima of the likelihood function should be the same and TLR  0. The test is
called the likelihood ratio test because TLR equals −2 times the logarithm of
the likelihood ratio L(
θ r )/L(θ̂ u ).
The Wald test statistic is


 −1


1
∂r(θ) 

−1 ∂r(θ ) 
r(θ̂ u ) ,
(2.92)
Â(θ̂ u )
TW = r(θ̂ u )
 

∂θ θ̂ u n
∂θ θ̂ u
where Â(θ̂ u ) is a consistent estimator of the variance matrix defined in (2.13)
evaluated at the unrestricted MLE. This tests how close r(θ̂ u ) is to the hypothesized value of 0 under H0 . By a first-order Taylor series expansion of r(θ̂ u ) about
a
θ 0 , it can be shown that under H0 , r(θ̂ u ) ∼ N[0, Vr ] where Vr is the matrix in
braces in (2.92). This leads to the chi-square statistic (2.92).
The Lagrange multiplier (LM) test statistic is



n
n

∂ ln fi 
1   −1  ∂ ln fi 
,
(2.93)
A( θ r )
TLM =
∂θ  θ r n
∂θ θ r
i=1
i=1
where 
A( 
θ r ) is a consistent estimator of the variance matrix defined in (2.13)
evaluated at the restricted MLE. Motivation of TLM is given next.

50

Model Specification and Estimation

To motivate TLM , first define the score vector
∂L  ∂ ln fi
s(θ) =
=
.
∂θ
∂θ
i=1
n

(2.94)

For the unrestricted MLE the score vector s(θ̂ u ) = 0. These are just the firstorder conditions (2.11) that define the estimator. If H0 is true, then this maximum should also occur at the restricted MLE, because imposing the constraint
will then have little impact on the estimated value of θ . That is, s(
θ r ) = 0.
TLM measures the closeness of this derivative to zero. The distribution of TLM
a
follows from s(
θ r ) ∼ N [0, n1 A] under H0 . Using this motivation, TLM is called
the score test because s(θ) is the score vector.
An alternative motivation for TLM is to measure the closeness to zero of
the expected value of the Lagrange multipliers of the constrained optimization
problem for the restricted MLE. Maximizing L(y, θ ) − λ r(θ), the first-order
θ r )
λ, where R(θ) = ∂r(θ ) /∂θ .
conditions with respect to θ imply s(
θ r ) = R(
Tests based on s(
θ r ) are equivalent to tests based on the estimated Lagrange
multipliers 
λ because R(
θ r ) is of full rank. So TLM is also called the Lagrange
multiplier test. Throughout this book, we refer to TLM as the LM test. It is
exactly the same as the score test, an alternative label widely used in the
statistics literature.
In addition to being asymptotically χ 2 (h) under H0 , all three test statistics are
noncentral χ 2 (h) with the same noncentrality parameter under local alternatives
Ha : r(θ ) = n−1/2 δ, where δ is a vector of constants. So they all have the same
local power. The choice of which test statistic to use is, therefore, mainly one
of convenience in computation or small sample performance.
TLR requires estimation of θ under both H0 and Ha . If this is easily done,
then the test is very simple to implement because one need only read off the
log-likelihood statistics routinely printed out, subtract, and multiply by 2. TW
requires estimation only under Ha and is best to use if the unrestricted model
is easy to estimate. TLM requires estimation only under H0 and is attractive if
the restricted model is easy to estimate.
θ r)
An additional attraction of the LM test is easy computation. Let si (
be the i th component of the summation forming the score vector (2.94) for
the unrestricted density evaluated at the restricted MLE. An asymptotically
equivalent version of TLM can be computed as the uncentered explained sum
of squares, or n times the uncentered R 2 , from the auxiliary OLS regression
θ r ) γ + ui .
1 = si (

(2.95)

The uncentered explained sum of squares from regression of y on X is
y X(X X)−1 X y, and the uncentered R 2 is y X(X X)−1 X y/y y.

2.6 Testing

2.6.2

51

Wald Tests

The preceding results are restricted to hypothesis tests based on MLEs. The
Wald test can be extended to any consistent estimator θ̂ that does not impose
the restrictions being tested. The only change in (2.92) is that θ̂ replaces θ̂ u and
V[θ̂] replaces n1 Â(θ̂ u )−1 . We test H0 : r(θ 0 ) = 0 using
TW = r(θ̂ )






 
∂r(θ )  −1
∂r(θ) 
V[θ̂ ]
r(θ̂ ),
∂θ θ̂
∂θ  θ̂

(2.96)

which is χ 2 (h) under H0 . Reject H0 : r(θ 0 ) = 0 against Ha : r(θ 0 )= 0 if TW >
χ 2α (h). Although such generality is appealing, a weakness of the Wald test is
that in small samples it is not invariant to the parameterization of the model,
whereas LR and LM tests are invariant.
For multiple exclusion restrictions, such as testing whether a set of indicator
variables for occupation or educational level is jointly statistically significant,
H0 : Rθ = 0, where R is an h × q matrix whose rows each have entries of zero
except for one entry of unity corresponding to one of the components of β
that is being set to zero. Then r(θ) = Rθ , and one uses (2.96) with r(θ̂) = Rθ̂
and ∂r(θ ) /∂θ = R. This is the analog of the F -test in the linear model under
normality.
The usual t-test for significance of the j th regressor is the square root of the
Wald chi-square test. To see this, note that for H0 : θ j = 0, r(θ ) = θ j , ∂r(θ)/∂θ
is a q × 1 vector with unity in the j th row and zeroes elsewhere, and (2.96)
yields TW = θ̂ j [V̂jj ]−1 θ̂ j , where V̂jj is the j th diagonal entry in V[θ̂ ] or the
estimated variance of θ̂ j . The square root of TW ,
θ̂ j
,
TZ = !
V̂jj

(2.97)

is standard normal (the square root of χ 2 (1)). We reject H0 against Ha : θ j = 0
at significance level α if |TZ | > zα/2 .
This test is usually called a t-test, following the terminology for the corresponding test in the linear model with normal homoskedastic errors, though
its distribution is only obtained using asymptotic theory that yields the standard normal. For nonlinear models such as count models, some packages use
standard normal critical values, whereas others use critical values from the
t(n − q) distribution. The latter leads to more conservative inference because
the t(n − q) has fatter tails. For similar reasons some packages report an F -test
statistic version of the test in (2.96), with F = TW / h, and use critical values
from the F (h, n − q) distribution.
The test statistic TZ can be used in one-sided tests. Reject H0 : θ j = 0
against Ha : θ j > 0 at significance level α if TZ > zα , and reject H0 : θ j = 0
against Ha : θ j < 0 at significance level α if TZ < −zα .

52

Model Specification and Estimation

The Wald approach can be adapted to obtain the distribution of nonlinear
functions of parameter estimates, such as individual predictions of the conditional mean. Suppose interest lies in the function λ = r(θ ), and we have
a
available the estimator θ̂ ∼ N[θ ,V[θ̂ ]]. By the delta method
a

where

λ̂ = r(θ̂) ∼ N[λ, V[λ̂]],

(2.98)



∂r(θ) 
∂r(θ) 
V[λ̂] =
V[θ̂]
.
∂θ θ̂
∂θ  θ̂

(2.99)

This can be used in the obvious way to get standard errors and construct
confidence intervals for λ. For example, if λ is scalar, then a 95% confidence
interval for λ is λ̂ ± 1.96 se(λ̂), where se(λ̂) equals the square root of the scalar
in the right-hand side of (2.99).
The LM and LR hypothesis tests have been extended to GMM estimators by
Newey and West (1987b). See this reference or Cameron and Trivedi (2005) or
Wooldridge (2010) for further details.
2.6.3

Conditional Moment Tests

The results so far have been restricted to tests of hypotheses on the parameters.
The moment-based framework can be used to instead perform tests of model
specification. A model may impose a number of moment conditions, not all
of which are used in estimation. For example, the Poisson regression model
imposes the constraint that the conditional variance equals the conditional
mean, which implies
E[(yi − exp(xi θ ))2 − yi ] = 0.
Because this constraint is not imposed by the MLE, the Poisson model could
be tested by testing the closeness to zero of the sample moment
n


{(yi − exp(xi θ̂))2 − yi )}.

i=1

Such tests, called conditional moment tests, provide a general framework
for model specification tests. These tests were introduced by Newey (1985) and
Tauchen (1985) and are given a good presentation in Pagan and Vella (1989).
They nest hypothesis tests such as Wald, LM, and LR, and specification tests
such as information matrix tests. This unifying element is emphasized in White
(1994).
Suppose a model implies the population moment conditions
E[mi (yi , xi , θ 0 )] = 0,

i = 1, . . . , n,

(2.100)

where mi (·) is an r × 1 vector function. Let θ̂ be a root-n consistent estimator
that converges to θ 0 , obtained by a method that does not impose the moment

2.6 Testing

53

condition (2.100). The notation mi (·) denotes moments used for the tests,
whereas gi (·) and/or hi (·) denote moments used in estimation.
The correct specification of the model can be tested by testing the closeness
to zero of the corresponding sample moment
m(θ̂) =

n


mi (yi , xi , θ̂ ).

(2.101)

i=1

Suppose θ̂ is the solution to the first-order conditions
n


gi (yi , xi , θ̂ ) = 0.

i=1

If E[gi (yi , xi , θ 0 )] = 0 and (2.100) holds, then
d

n−1/2 m(θ̂) → N[0, Vm ]

(2.102)

Vm = HJH ,

(2.103)

where
⎡
n

1 ⎣ i=1 mi mi
J = lim E 
n
n→∞ n
gi m
i=1

i

 ⎤
mi gi 
 ⎦,
n
 
g
g
i
i θ0
i=1

n

i=1

(2.104)

the vectors mi = mi (yi , xi , θ ) and gi = gi (yi , xi , θ ), and
H = Ir

− CA−1 ,

(2.105)

 n

 ∂mi 
1

,
C = lim E
n→∞ n
∂θ  θ 0
i=1

(2.106)

 n

 ∂gi 
1

.
A = lim E
n→∞ n
∂θ  θ 0
i=1

(2.107)

The formula for Vm is quite cumbersome because there are two sources of
stochastic variation in m(θ̂ ) – the dependent variable yi and the estimator θ̂ .
See Section 2.8.5 for details.
The conditional moment (CM) test statistic
TCM = n m(θ̂ ) V̂m −1 m(θ̂),

(2.108)

where V̂m is consistent for Vm , is asymptotically χ 2 (r). Moment condition
(2.100) is rejected at significance level α if the computed test statistic exceeds
χ 2 (r; α). Rejection is interpreted as indicating model misspecification, although
it is not always immediately apparent in what direction the model is misspecified.

54

Model Specification and Estimation

Although the CM test is in general difficult to implement due to the need to
obtain the variance Vm , it is simple to compute in two leading cases. First, if
the moment mi (·) satisfies

∂mi
= 0,
(2.109)
E
∂θ 

then from section 2.8.5 Vm = lim n1 E[ i mi mi ], which can be consistently

estimated by V̂m = n1 i m̂i m̂i . For cross-section data, this means
 n
−1 n
n



TCM =
(2.110)
m̂i
m̂i m̂i
m̂i .
i=1

i=1

i=1

This can be computed as the uncentered explained sum of squares, or as n times
the uncentered R 2 , from the auxiliary regression
1 = mi (yi , xi , θ̂ ) γ + ui .

(2.111)

If E[mi mi ] is known, the statistic
 n
−1 n
n





 
E[mi m ]
m̂
m̂i
i

i=1

i

i=1

θ̂

i=1

is an alternative to (2.110).
A second case in which the CM test is easily implemented is if θ̂ is the MLE.
Then it can be shown that an asymptotically equivalent version of the CM test
can be calculated as the uncentered explained sum of squares or, equivalently,
as n times the uncentered R 2 , from the auxiliary regression
1 = mi (yi , xi , θ̂ ) γ 1 + si (yi , xi , θ̂ ) γ 2 + ui ,

(2.112)

where si is the i th component of the score vector (2.94) and uncentered R 2 is
defined after (2.95). This auxiliary regression is a computational device with
no physical interpretation. It generalizes the regression (2.95) for the LM test.
Derivation uses the generalized information matrix equality that


∂ ln fi (θ)
∂mi (θ)
= −E mi (θ )
,
(2.113)
E
∂θ 
∂θ 
provided E[mi (θ)] = 0. The resulting test is called the outer product of the gradient (OPG) form of the test because it sums mi (θ) × ∂ ln fi (θ)/∂θ  evaluated
at θ̂.
A leading example of the CM test is the information matrix (IM) test of
White (1982). This tests whether the information matrix equality holds, or
equivalently whether the moment condition

 2
∂ ln fi ∂ ln fi
∂ ln fi
+
=0
E vech
∂θ∂θ 
∂θ
∂θ 

2.6 Testing

55

is satisfied, where fi (y, θ ) is the specified density. The vector-half operator vech(·) stacks the components of the symmetric q × q matrix into
a q(q + 1)/2 × 1 column vector. The OPG form of the IM test is especially advantageous in this example because otherwise one needs to obtain
∂mi (θ)/∂θ  , which entails third derivatives of the log-density.
Despite their generality, CM tests other than the three classical tests (Wald,
LM, and LR) are rarely exploited in applied work, for three reasons. First,
the tests are unconventional in that there is no explicit alternative hypothesis.
Rejection of the moment condition may not indicate how one should proceed
to improve the model. Second, implementation of the CM test is in general
difficult, except for the MLE case in which a simple auxiliary regression can
be run. But this OPG form of the test has been shown to have poor small
sample properties in some leading cases (although a bootstrap with asymptotic
refinement, see section 2.6.5, may correct for this). Third, with real data and a
large sample, testing at a fixed significance level that does not vary with sample
size will always lead to rejection of sample moment conditions implied by a
model and to a conclusion that the model is inadequate. A similar situation
also exists in more classical testing situations. With a large enough sample,
regression coefficients will always be significantly different from zero. But
in this latter case this may be precisely the news that researchers want to
hear.
Two model specification tests that are used more often are the Hausman test,
detailed in Chapter 5.6.6, and the overidentifying restrictions test presented in
section 2.5.2.
2.6.4

Bootstrap

The bootstrap, introduced by Efron (1979), is a method to obtain the distribution of a statistic by resampling from the original data set. An introductory
treatment is given by Efron and Tibsharani (1993). Horowitz (2001) gives a
comprehensive treatment with an emphasis on common regression applications.
Here we focus on methods applicable to cross-section count data regression
models, using the bootstrap pairs procedure under the assumption that (yi , xi )
is iid.
We begin with the use of the bootstrap to estimate standard errors. Let
θ̂ j denote the estimator of the j th component of the parameter vector θ . The
bootstrap pairs procedure is as follows:
1. Form a new pseudosample of size n, (yl∗ , x∗l ), l = 1, . . . , n,
by sampling with replacement from the original sample (yi , xi ),
i = 1, . . . , n.
2. Obtain the estimator, say θ̂ 1 with j th component θ̂ j,1 , using the pseudosample data.
3. Repeat steps 1 and 2 B times giving B estimates θ̂ j,1 , . . . , θ̂ j,B .

56

Model Specification and Estimation

4. Estimate the standard deviation of θ̂ j using the usual formula for the
sample standard deviation of θ̂ j,1 , . . . , θ̂ j,B , or
&
'
B
' 1 
(θ̂ j,b − θ j )2
(2.114)
seBoot [θ̂ j ] = (
B − 1 b=1
where θ j is the usual sample mean θ j = (1/B)

B
b=1

θ̂ j,b .

The estimated standard error is the square root of V̂Boot [θ̂ j ], where
1 B

V̂Boot [θ̂] = B−1
b=1 (θ̂ b − θ)(θ̂ b − θ ) .
This bootstrap is very easy to implement, given a resampling algorithm and
a way to save parameter estimates from the B simulations. The bootstrap (with
B → ∞) yields standard errors asymptotically equivalent to robust sandwich
standard errors. For standard error estimation, B = 400 is usually more than
adequate; see, for example, Cameron and Trivedi (2005, p. 361). Given the
bootstrap standard error we can perform Wald hypothesis tests and calculate
confidence intervals in the usual way.
The bootstrap is useful when it is difficult to otherwise compute the standard error of an estimator. For example, for the sequential two-step estimation
problem of section 2.5.5 the distribution of θ̂ 2 is complicated by first-step estimation of 
θ 1 . Then in each of the B resamples we perform both steps of the
two-step estimation, yielding B second-step estimates θ̂ 2,1 , . . . , θ̂ 2,B and hence
the bootstrap standard error of θ̂ 2 .
The bootstrap is easily adapted to statistics other than an estimator – replace
θ̂ by the statistic of interest. For example, a bootstrap can be used to compute
the standard error of θ̂ 2 × θ̂ 3 , or of the predicted exponential conditional mean
Ê[y|x = x∗ ] = exp(x∗ β̂), without resort to the delta method of section 2.6.2.
As another example, the bootstrap can estimate the standard deviation of a
standard error. Let se[θ̂ j ] be a standard error computed using, for example, the
robust sandwich method. Then bootstrap B times to obtain B different values
of se[θ̂ j ] and use the standard deviation of these values. And the bootstrap
can be used to estimate other features of the distribution of a statistic than its
standard deviation.
For most purposes bootstrap pairs (or nonparametric) resampling is adequate, but there are other ways to resample. A parametric bootstrap holds the
regressors xi fixed and generates resamples yi by making draws from a fitted
parametric model f (yi |xi , θ̂ ). A residual bootstrap that holds the regressors
fixed and resamples residuals is relevant to linear regression but not for count
models that are nonlinear. A leave-one-out jackknife creates n resamples by
dropping in turn each of the n observations in the sample.
A key requirement for validity of the bootstrap is that resampling be done
on a quantity that is iid. The bootstrap pairs procedure for independent crosssection data ensures this, resampling jointly the pairs (yi , xi ) that are assumed to
be iid. For correlated observations the resampling methods are more complex,
except for clustered observations (see section 2.7.1) for which one resamples

2.6 Testing

57

over entire clusters rather than over observations. And it is assumed
√ that the
estimator is one where the usual asymptotic theory applies so that N (θ̂ − θ 0 )
has a limit normal distribution and the statistic of interest is a smooth function
of θ̂ .
2.6.5

Bootstrap with Asymptotic Refinement

An appropriately constructed bootstrap can additionally provide improved estimation of the distribution of a statistic in finite samples, in the sense that
as n → ∞ the bootstrap estimator converges faster than the usual first-order
asymptotic theory. These gains occur because in some cases it is possible to
construct the bootstrap as a numerical method to implement an Edgeworth
expansion, which is a more refined asymptotic theory than the usual firstorder theory. A key requirement for improved finite-sample performance of
the bootstrap is that the statistic being considered is asymptotically pivotal,
which means that the asymptotic distribution of the statistic does not depend
on unknown parameters.
We present a version of the bootstrap for hypothesis tests that yields
improved small-sample performance. Consider testing the hypothesis H0 :
θ j = θ j 0 against H0 : θ j = θ j 0 , where estimation is by a standard method
such as Poisson QMLE. The t statistic used is tj = (θ̂ j − θ j 0 )/sj , where sj is
the robust sandwich standard error estimate for θ̂ j which assumes that (yi , xi )
is iid. On the basis of first-order asymptotic theory, we would reject H0 at level
α if |tj | > zα/2 .
The percentile-t method tests H0 as follows:
1. Form a new pseudosample of size n, (yl∗ , x∗l ), l = 1, . . . , n, by sampling with replacement from the original sample (yi , xi ), i = 1, . . . , n.
2. Obtain the estimator θ̂ j,1 , the standard error sj,1 , and the t statistic
tj,1 = (θ̂ j,1 − θ̂ j )/sj,1 for the pseudosample data.
3. Repeat steps 1 and 2 B times, yielding tj,1 , . . . , tj,B .
4. Order these B t statistics and calculate tj,[α/2] and tj,[1−α/2] , the lower
and upper α/2 percentiles of tj,1 , . . . , tj,B .
5. Reject H0 at level α if tj , the t statistic from the original sample, falls
outside the interval (tj,[α/2] , tj,[1−α/2] ).
Note that in step 2 the t statistic is centered around the original sample estimate θ̂ j and not the hypothesized value θ j 0 . The reason is that
the bootstrap treats the sample as the population and resamples from this
population. The corresponding 100(1 − α)% bootstrap confidence interval is
∗
∗
sj , θ̂ j + tj,[1−α/2]
sj ).
(θ̂ j + tj,[α/2]
This bootstrap procedure leads to an improved finite-sample performance
in the following sense. Let α be the nominal size for a test procedure. Usual
asymptotic theory produces t tests with actual size α + O(n−1/2 ), whereas
this bootstrap produces t tests with actual size α + O(n−1 ). This refinement
is possible because it is the t statistic, whose asymptotic distribution does not

58

Model Specification and Estimation

depend on unknown parameters, that is bootstrapped. For both hypothesis tests
and confidence intervals, the number of iterations should be larger than for
standard error estimation and such that α(B + 1) is an integer, say B = 999 for
a 5% test.
The percentile-t method can potentially overcome the poor finite-sample
performance of the auxiliary regressions used to implement LM tests and conditional moment tests, and the lack of invariance of the Wald test to transformations of θ. In practice, however, the bootstrap is mainly used without asymptotic
refinement to compute standard errors as in section 2.6.4.
An alternative bootstrap method for tests and confidence intervals is the
percentile method. This calculates θ j,[α/2] and θ j,[1−α/2] , the lower and upper
α/2 percentiles of θ̂ j,1 , . . . , θ̂ j,B . Then reject H0 : θ j = θ j 0 against Ha : θ j =
θ j 0 if θ j 0 does not lie in (θ j,[α/2] , θ j,[1−α/2] ), and use (θ j,[α/2] , θ j,[1−α/2] ) as the
100(1 − α)% confidence interval. This alternative procedure is asymptotically
valid, but is no better than using the usual asymptotic theory because it is based
on the distribution of θ̂ j , which unlike tj depends on unknown parameters.
Similarly, using the usual hypothesis tests and confidence intervals, with the
one change that sj is replaced by a bootstrap estimate, is asymptotically valid,
but is no better than the usual first-order asymptotic methods.
A bootstrap with asymptotic refinement can also be used for correction of
bias in an asymptotically consistent estimator. This is rarely done in practice,
however, because the resulting bias-corrected estimate is considerably noisier
than the original biased estimator; see Efron and Tibsharani (1993, p. 138).
2.7 ROBUST INFERENCE
By robust inference we mean computation of standard errors and of subsequent
Wald test statistics and confidence intervals that are robust to departures from
some of the assumptions made to motivate the estimator θ̂ . In particular, we
relax the assumption of independence across observations to consider withincluster correlation, time-series correlation, and spatial correlation. Doing so
leads to alternative consistent estimators of the middle matrix B in the sandwich
variance matrix A−1 BA−1 or, for GMM, the matrix S defined in (2.78).
Correlation of observations can also lead to specification and estimation
of different models. In the time-series case, for example, a dynamic model
introduces lagged dependent variables as regressors to model E[yt |yt−1 , xt ],
rather than E[yt |xt ]. Such additional complications are considered elsewhere
(e.g., in Chapter 7 for time-series correlation). Here we suppose the model and
estimator are unchanged and focus on consistent estimation of the variance
matrix of the estimator.
2.7.1

Estimating Equations

We assume that the general theory
results for the estimating equations estimator
θ̂ of section 2.5.1, which solves ni=1 gi (yi , xi , θ ) = 0, hold. So θ̂ is consistent

2.7 Robust Inference

59

√
d
for θ 0 , n(θ̂ − θ 0 ) → N[0, A−1 BA−1 ], and A and Â are as defined in (2.67)
and (2.69). The one point of departure is to permit some correlation across
observations, which leads to changes in B and B̂.
Given completely unstructured correlation across observations, (2.68)
becomes
⎡
⎤
n
n
1 ⎣ 
(2.115)
gi (yi , xi , θ 0 )gj (yj , xj , θ 0 ) ⎦ .
B = lim E
n→∞ n
i=1 j =1
Some structure is needed to simplify (2.115). Essentially we need
1 
B = lim
wij E gi (yi , xi , θ 0 )gj (yj , xj , θ 0 ) ,
n→∞ n
i=1 j =1
n

n

(2.116)

where the weights wij are zero, or asymptote to zero, for a substantially large
fraction of the observations. Different types of correlation lead to different
weights wij .
In section 2.5.1, we assumed independence of observations, in which case
wij = 1 if i = j and wij = 0 otherwise. From (2.70) the resulting estimate

of B is B̂Het = n1 ni=1 gi (θ̂)gi (θ̂) ; a common finite-sample adjustment is to
divide by n − q rather than n. This is called a heteroskedastic-robust estimator
because it does not require assumptions on the exact form of E gi (θ 0 )gi (θ 0 ) .
One alternative to independent observations is that observations fall into
clusters, where observations in different clusters are independent, but observations within the same cluster are no longer independent. For example, individuals may be grouped into villages, with correlation within villages but not
across villages.
The first-order conditions (2.65) can be summed within each cluster and
reexpressed as
C
gc (θ̂) = 0,
(2.117)
c=1

where c denotes the cth cluster, there are C clusters, and gc (θ) =

that E[gi (θ )gj (θ) ] = 0 if i and
i:i∈c gi (yi , xi , θ ). The key assumption is
1
j are in different clusters. Then B = lim n Cc=1 E gc (θ 0 )gc (θ 0 ) , and we use
n→∞
the cluster-robust estimator
C 1
gc (θ̂)gc (θ̂) .
(2.118)
B̂Clus =
c
C−1n
This estimator was proposed by Liang and Zeger (1986), and the scaling
C/(C − 1) is a more recent ad hoc degrees of freedom correction. The estimator
assumes that the number of clusters C → ∞. Cameron and Miller (2011) and
Cameron, Gelbach, and Miller (2011) present an easily computed extension to
clustering in two or more nonnested dimensions.
The estimator (2.118) is also applicable to panel data where observations
are independent across the n individuals but are correlated over time for a given

60

Model Specification and Estimation

individual. Then the term panel-robust estimator is sometimes used, and we
require a long panel with n → ∞. Arellano (1987) showed that (2.118) can
also be used to obtain a panel-robust variance estimator for the fixed effects
estimator in the linear panel model.
For time series data it is simplest to assume that only observations up to
m periods apart are correlated, as is the case for a vector moving average
process of order m. Then wij = 0 if |i − j | > )m, and (2.115) simplifies
* to B =
m
n

1

0 + j =1 (j + j ), where j = lim n E
i=j +1 gi (θ )gi−j (θ) . Newey
n→∞
and West (1987a) proposed the heteroskedastic and autocorrelation-consistent
(HAC) estimator
ˆ0+
B̂ = 

m

(1 −
j =1

j
ˆ  ),
ˆj +
)(
j
m+1

(2.119)

where
n
1 
ˆ
gi (θ̂)gi−j (θ̂ ) .
j =
n i=j +1

(2.120)

This estimator of B is the obvious estimator of this quantity, aside from multiplication by (1 − j/(m + 1)) that ensures that B̂ is positive definite.
For cross-section data that are spatially correlated, dependence decays with
economic or physical “distance” between observations, rather than time. Thus
Conley (1999) proposes the spatial-consistent estimator
B̂ =

n 
n


Kn (si , sj )gi (θ̂)gi−j (θ̂) ,

i=1 j =1

where si and sj are the locations of individuals i and j , and Kn (si , sj ) is a
kernel function that weights pairs of observations so that nearby observations
receive weight close to 1 and observations far apart receive weight of 0. A
simple example is a cutoff function so Kn (si , sj ) = 1 if |si − sj | < m and
Kn (si , sj ) = 0 otherwise. Conley (1999) also proposes alternatives that ensure
that B̂ is positive definite.
For panel data that are spatially correlated, Driscoll and Kraay (1998) present
a robust variance matrix estimator that treats each time period as a cluster,
additionally allows observations in different time periods to be correlated for a
finite time difference, and assumes a long panel with T → ∞.
2.7.2

Generalized Method of Moments

The robust estimators of the variance matrix for the estimating equations estimator extend easily to GMM. Indeed the already-cited estimators of Newey and
West (1987a), Driscoll and Kraay (1998), and Conley (1999) were proposed
for the GMM estimator.

2.8 Derivation of Results

61

n

From section 2.5.2, the GMM estimator minimizes
i=1 hi (yi , xi , θ )
n
−1
−1
Wn
as in (2.74),
i=1 hi (yi , xi , θ ) . The limit variance matrix is A BA


where A = H WH and B = H WSWH. We continue to estimate H by Ĥ given
in (2.82), and estimate Wn by W. With correlated observations
⎡
⎤
n
n
1 ⎣ 
S = lim E
hi (yi , xi , θ )hj (yj , xj , θ ) ⎦ .
n→∞ n
i=1 j =1
Then for the various forms of correlation we use estimator Ŝ that is the same
as B̂ given in section 2.7.1, with gi (θ̂) replaced by hi (θ̂).
2.8 DERIVATION OF RESULTS
Formal proofs of convergence in probability of an estimator θ̂ to a fixed value
θ ∗ are generally difficult and not reproduced here. A clear treatment is given in
Amemiya (1985, chapter 4), references to more advanced treatment are given
in Cameron and Trivedi (2005) and Wooldridge (2010), and a comprehensive
treatment is given in Newey and McFadden (1994). If θ̂ maximizes or minimizes
an objective function, then θ ∗ is the value of θ that maximizes the probability
limit of the objective function, where the objective function is appropriately
scaled to ensure that the probability limit exists. For example, for maximum
likelihood the objective function is the sum of n terms and
 is therefore divided
by n. Then θ̂ converges to θ ∗ , which maximizes plim n1 ni=1 ln fi , where the
probability limit is taken with respect to the dgp which is not necessarily fi .
It is less difficult and more insightful to obtain the asymptotic distribution of θ̂. This is first done in a general framework, with specialization to
likelihood-based models, generalized linear models, and moment-based models in remaining subsections.
2.8.1

General Framework

A framework that covers the preceding estimators, except GMM, is that the
estimator θ̂ of the q × 1 parameter vector θ is the solution to the equations
n


gi (θ) = 0,

(2.121)

i=1

where gi (θ) = gi (yi , xi , θ ) is a q × 1 vector, and we suppress dependence on
the dependent variable and regressors. In typical applications (2.121) are the
first-order conditions from maximization or minimization of a scalar objective
function, and gi is the vector of first derivatives of the i th component of the
objective function with respect to θ . The first-order conditions (2.6) for the
Poisson MLE are an example of (2.121).

62

Model Specification and Estimation

By an exact first-order Taylor series expansion of the left-hand side of
(2.121) about θ ∗ , the probability limit of θ̂, we have

n
n


∂gi (θ) 
gi (θ ∗ ) +
(θ̂ − θ ∗ ) = 0,
(2.122)
∂θ  θ ∗∗
i=1
i=1
√
for some θ ∗∗ between θ̂ and θ ∗ . Solving for θ̂ and rescaling by n yields
 n
 −1
n
√
1 
1  ∂gi (θ ) 
n(θ̂ − θ ∗ ) = −
gi (θ ∗ )
(2.123)
√
n i=1 ∂θ  θ ∗∗
n i=1

where it is assumed that the inverse exists.
It is helpful at this stage to recall the proof of the asymptotic normality of
the OLS estimator in the linear regression model. In that case
 n
−1
n
√
1 
1 
n(θ̂ − θ ∗ ) =
xi xi
xi (yi − xi θ )
√
n i=1
n i=1
which is of the same form as (2.123). We therefore proceed in the same way
as in the OLS case, where the first term in the right-hand side converges
in probability to a fixed matrix and the second term in the right-hand side
converges in distribution to the normal distribution.
Specifically, assume the existence of the q × q matrix

n
1  ∂gi (θ) 
,
(2.124)
A = − plim
n i=1 ∂θ  θ ∗
where A is positive definite for a minimization problem and negative definite
for a maximization problem. Also assume
1 
d
gi (θ ∗ ) → N[0, B],
√
n i=1
n

(2.125)

where
B = plim

n
n

1 
gi (θ)gj (θ) θ ∗
n i=1 j =1

(2.126)

is a positive definite q × q matrix. √
From (2.124) through (2.126), n(θ̂ − θ ∗ ) in (2.123) is an N[0, B] distributed random variable premultiplied by minus the inverse of a random matrix
that converges in probability to a matrix A. Under appropriate conditions
√
d
n(θ̂ − θ ∗ ) → N[0, A−1 BA−1 ],
(2.127)
or
1
a
θ̂ ∼ N[θ ∗ , A−1 BA−1 ].
n

(2.128)

2.8 Derivation of Results

63

The assumption (2.124) is verified by a law of large numbers because the
right-hand side of (2.124) is an average. The assumption (2.125) is verified by
a multivariate central limit theorem because the left-hand side of (2.125) is a
rescaling of an average. This average is centered around zero (see below) and
hence
⎡
⎤


n



1
1
gi = E ⎣
gi gj  ⎦ ,
V √
n i j
n i=1
which is finite if there is not too much correlation between gi and gj , i = j.
Note that the definition of B in (2.126) permits correlation across observations,
and the result (2.128) can potentially be applied to time series data.
Finally, 
note that by (2.123) convergence of θ̂ to θ ∗ requires centering around
zero of √1n i gi (θ ∗ ). An informal proof of convergence for estimators defined

by (2.121) is therefore to verify that E∗
i gi (θ ∗ ) = 0, where the expectation
is taken with respect to the dgp.
2.8.2

Likelihood-Based Models

For the MLE given in section 2.3, (2.123) becomes
 n

 −1
n
√
1  ∂ ln fi 
1  ∂ 2 ln fi 
n(θ̂ ML − θ ∗ ) = −
.
√
n i=1 ∂θ ∂θ  θ ∗∗
n i=1 ∂θ θ ∗
(2.129)
where fi = f (yi |xi , θ ). An informal proof of consistency of θ̂ to θ 0 , that
is θ ∗ = θ 0 , requires E ∂ ln fi /∂θ |θ 0 = 0. This is satisfied if the density is
correctly specified, so the expectation is taken with respect to f (yi |xi , θ 0 ), and
the density satisfies the fourth regularity condition. +
To see this, note that any +density f (y|θ ) satisfies f (y|θ )dy = 1. Differentiating with respect to θ, ∂θ∂ f (y|θ )dy = 0. If the range of
+ y does not depend
on θ, the derivative can be taken inside
the
integral
and
(∂f (y|θ)/∂θ)dy =
+
0, which can be reexpressed as (∂ ln f (y|θ )/∂θ) f (y|θ )dy = 0, since
∂ ln f (y|θ)/∂θ = (∂f (y|θ )/∂θ) (1/f (y|θ)). Then E[∂ ln f (y|θ )/∂θ] = 0,
where E is taken with respect to f (y|θ ).
The variance matrix of θ̂ ML is n1 A−1 BA−1 where A and B are defined
in (2.124) and (2.126) with g(yi |xi , θ ) = ∂ ln f (yi |xi , θ )/∂θ. Simplification
occurs if the density is correctly specified and the range of y does not depend
on θ . Then the information matrix
equality A = B holds.
+
To see this, differentiating (∂ ln f (y|θ )/∂θ) f (y|θ )dy = 0 with respect to
θ yields
E ∂ 2 ln f (y|θ)/∂θ ∂θ  = −E ∂ ln f (y|θ )/∂θ ∂ ln f (y|θ )/∂θ 
after some algebra, where E is taken with respect to f (y|θ).

64

Model Specification and Estimation

If the density is misspecified, it is no longer the case that such simplifications
occur, and the results of section 2.8.1 for g(θ ) = ln f (yi |xi , θ ) yield the result
given in section 2.3.4.
2.8.3

Generalized Linear Models

For the QMLE for the LEF given in section 2.4.2, (2.123) becomes
√
n(β̂ LEF − β 0 )
(2.130)
 n
 −1
1 1
∂μi ∂μi
∂ 2 μi
yi − μi ∂μi ∂vi 
=−
{−
+ (yi − μi )
−
}
n i=1 vi
∂β ∂β 
∂β∂β 
vi
∂β ∂β  β 0

n
1  1
∂μi 
×√
{yi − μi }
.
∂β β 0
n i=1 vi

An informal proof of convergence of β̂ LEF to β 0 is that the second term in
the right-hand side is centered around 0 if E yi − μ(xi , β 0 ) = 0, or that the
conditional mean is correctly specified. The first term on the right-hand side
converges in probability to
A = lim


n
1  1 ∂μi ∂μi 
n i=1 vi ∂β ∂β  β 0

because E yi − μ(xi , β 0 ) = 0, and the second term converges in distribution
to the normal distribution with variance matrix

n
1  ωi ∂μi ∂μi 
B = lim
,
n i=1 vi2 ∂β ∂β  β
0

where ωi = E (yi − μ(xi , β 0 ))2 . Then V[β̂ LEF ] = n1 A−1 BA−1 .
For the QGPMLE for the LEFN density in section 2.4.3, we have
√
n(β̂ LEFN − β 0 )
 n
 −1
1 1
∂μi ∂μi
∂ 2 μi 
=−
{−
+ (yi − μi )
}
n i=1 
ωi
∂β ∂β 
∂β∂β  β 0

n
1  1
∂μ 
×√
(yi − μi ) i  ,
ωi
∂β β 0
n i=1 

(2.131)

β), 
α ). Then vi in A and B given earlier is replaced by ωi ,
where 
ωi = ω(μ(xi , 
which implies A = B.
Derivation for the estimator in the GLM of section 2.4.4 is similar.

2.8 Derivation of Results

2.8.4

65

Moment-Based Models

Results for estimating equations given in section 2.5.1 follow directly from
section 2.8.1.
The GMM estimator given in section 2.5.2 solves the equations



 n
n
1 
1  ∂hi (yi , xi , θ )
hi (yi , xi , θ ) = 0,
(2.132)
Wn √
n i=1
∂θ
n i=1
on multiplying by an extra scaling parameter n−3/2 . Taking a Taylor series
expansion of the third term similar to (2.122) yields



 n

n
n
1  ∂hi  √
1 
1  ∂hi
hi |θ ∗ +
n(θ̂ GMM − θ ∗ ) = 0,
Wn √
n i=1 ∂θ
n i=1 ∂θ  θ ∗∗
n i=1
where hi = hi (yi , xi , θ ). Solving yields
√
n(θ̂ GMM − θ ∗ ) =




 n
 −1
n
1  ∂hi
1  ∂hi 
(2.133)
Wn
n i=1 ∂θ
n i=1 ∂θ  θ ∗

 n
n
1 
1  ∂hi
hi |θ ∗∗ .
Wn √
×
n i=1 ∂θ
n i=1

Equation (2.133) is the key result for obtaining the variance of the GMM
estimator. It is sufficient to obtain the probability limit of the first five terms
and
the limit distribution
of the last
 term in the right-hand side of (2.133). Both


1 
1 
i ∂hi /∂θ and n
i ∂hi /∂θ θ ∗ converge in probability to the matrix H
n
defined
 in (2.77), and by assumption plim Wn = W. By a central limit theorem
√1
i hi |θ ∗∗ converges in distribution to N[0, S] where
n
⎡
⎤

1 ⎣ 
hi hj θ ⎦ .
S = lim E
∗
n→∞ n
i
j
√
Thus from (2.133)
n(θ̂ GMM − θ ∗ ) has the same limit distribution
as
√
(H WH)−1 H W times a random variable that is N[0, S]. Equivalently, n(θ̂ −
d

θ ∗ ) → N[0, A−1 BA−1 ], where A = H WH and B = H WSWH.
The optimal GMM estimator can be motivated by noting that the variance
is exactly the same matrix form as that of the linear WLS estimator given
in (2.24), with X = H, V−1 = W, and  = S. For given X and  the linear
WLS variance is minimized by choosing V = . By the same matrix algebra,
for given H and S the GMM variance is minimized by choosing W = S−1 .
Analogously to feasible GLS, one can equivalently use Wn = Ŝ−1 , where Ŝ is
consistent for S.

66

Model Specification and Estimation

2.8.5

Conditional Moment Tests

For the distribution of the conditional moment test statistic (2.101), we take a
first-order Taylor series expansion about θ 0
1 
1
1  ∂mi (θ 0 ) √
mi (θ 0 ) +
n(θ̂ − θ 0 ),
√ m(θ̂) = √
n i=1 ∂θ 
n
n i=1
n

n

(2.134)


where mi (θ 0 ) = mi (yi , xi , θ 0 ) and ∂mi (θ 0 )/∂θ  = ∂mi (yi , xi , θ 0 )/∂θ  θ 0 . We
suppose that θ̂ is the solution to the first-order conditions
n


gi (θ̂ ) = 0,

i=1

where gi (θ) = gi (yi , xi , θ ). Replacing
side of (2.123) yields

√
n(θ̂ − θ 0 ) in (2.134) by the right-hand

1 
1
mi (θ 0 )
√ m(θ̂ ) = √
n
n i=1
n

(2.135)

1  ∂mi (θ 0 )
×−
n i=1 ∂θ 
n



1  ∂gi (θ 0 )
n i=1 ∂θ 
n

−1

1 
gi (θ 0 ).
√
n i=1
n

It follows from some algebra that
1
LD
√ m(θ̂) = Ir
n


− CA

−1

n

√1
i=1 mi (θ 0 )
n
,
n
√1
i=1 gi (θ 0 )
n

(2.136)

LD

where = means has the same limit distribution as the right-hand expression,
and
 n
 
 ∂mi 
1

C = lim E
,
n→∞ n
∂θ  θ 0
i=1
and

 n

 ∂gi 
1

A = lim E
.
n→∞ n
∂θ  θ 0
i=1

Equation (2.136) is the key to obtaining the distribution of the CM test
statistic. By a central limit theorem the second term in the right-hand side of
(2.136) converges to N[0, J], where
 n

n

 
1
i=1 mi mi
i=1 mi gi 
J = lim E n
 .
n
n→∞ n
gi m
gi g 
i=1

i

i=1

i

θ0

2.10 Exercises

67
d

It follows that n−1/2 m(θ̂) → N[0, Vm ], where
Vm = HJH ,
J is defined already, and
H = Ir

− CA−1 .

The CM test can be operationalized by dropping the expectation and evaluating
the expressions above at θ̂ .

In the special case in which
n (2.109) holds, that is, E[∂mi /∂θ ] = 0, C = 0

1
so Vm = HJH = lim n E[ i=1 mi mi ] leading to the simplification (2.110).
For the OPG auxiliary regression (2.112) if θ̂ is the MLE, see, for example,
Pagan and Vella (1989).
2.9 BIBLIOGRAPHIC NOTES
Standard references for estimation theory for cross-sectional data are T.
Amemiya (1985), Cameron and Trivedi (2005), Wooldridge (2010), and Greene
(2011). A comprehensive treatment is given in Newey and McFadden (1994).
For maximum likelihood estimation, see also Hendry (1995). The two-volume
work by Gourieroux and Monfort (1995) presents estimation and testing theory
in considerable detail, with considerable emphasis on the QML framework.
Reference to GLM is generally restricted to the statistics literature, even
though it nests many common nonlinear regression models, including the linear, logit, probit, and Poisson regression models. Key papers are Nelder and
Wedderburn (1972), Wedderburn (1974), and McCullagh (1983); the standard reference is McCullagh and Nelder (1989). The book by Fahrmeier
and Tutz (1994) presents the GLM framework in a form amenable to
econometricians.
Ziegler, Kastner, and Blettner (1998) provide many references to the GLM
and GEE literatures. The estimating equation approach is summarized by
Carroll et al. (2006). For GMM, emphasized in the econometrics literature,
key papers are Hansen (1982) and Newey and West (1987a). Detailed textbook
treatments of GMM include Davidson and MacKinnon (1993, chapter 17),
Ogaki (1993), Hamilton (1994, chapter 14), and Hayashi (2000). Ziegler (2011)
presents both GLM/GEE and GMM approaches.

2.10 EXERCISES
2.1 Let the dgp for y be y = Xβ 0 + u, where X is nonstochastic and u ∼(0, ).
Show by substituting out y that the WLS estimator defined in (2.23) can be
expressed as β̂ WLS = β 0 + (X V−1 X)−1 X V−1 u. Hence, obtain V[β̂ WLS ] given
in (2.24).

68

Model Specification and Estimation

2.2 Let y have the LEF density f (y|μ) given in (2.26), where the range of
the y does not depend
on μ ≡ E[y]. Show by differentiating with respect
+
to μ the identity f (y|μ)dy = 1 that E[a  (μ) + c (μ)y] = 0. Hence obtain
E[y]
given in (2.27). Show by differentiating with respect to μ the identity
+
yf (y|μ)dy = μ that E[a  (μ)y + c (μ)y 2 ] = 1. Hence obtain V[y] given in
(2.28).
2.3 For the LEF log-likelihood defined in (2.29) and (2.30), obtain the firstorder conditions for the MLE β̂ ML . Show that these can be reexpressed as (2.31)
using (2.27) and (2.28). From (2.31) obtain the first-order conditions for the
MLE of the Poisson regression model with exponential mean function.
2.4 Consider the geometric density f (y|μ) = μy (1 + μ)−y−1 , where y =
0, 1, 2, . . . and μ = E[y]. Write this density in the LEF form (2.26). Hence
obtain the formula for V[y] using (2.28). In the regression case in which
μi = exp(xi β), obtain the first-order conditions for the MLE for β. Give the
distribution for this estimator, assuming correct specification of the variance.
2.5 Consider the geometric density f (y|μ) = μy (1 + μ)−y−1 , where y =
0, 1, 2, . . . and μ = E[y]. Write this density in the canonical form of the LEF
(2.45). Hence obtain the formula for V[y] using (2.47). Obtain the canonical
link function for the geometric, verifying that it is not the log link function.
In the regression case with the canonical link function obtain the first-order
conditions for the MLE for β. Give the distribution for this estimator, assuming
correct specification of the variance.
2.6 Models with exponential mean function exp(xi β), where β and xi are
k × 1 vectors, satisfy E[(yi − exp(xi β))xi ] = 0. Obtain the first-order conditions for the GMM estimator that minimizes (2.72), where h(yi , xi , β) =
(yi − exp(xi β))xi and W is k × k of rank k. Show that these first-order conditions are a full-rank k × k matrix transformation of the first-order conditions
(2.6) for the Poisson MLE. What do you conclude?
2.7 For the Poisson regression model with exponential mean function exp(xi β),
consider tests for exclusion of the subcomponent x2i of xi = [x1i , x2i ], which
are tests of β 2 = 0. Obtain the test statistic TLM given (2.93). State how to
compute an asymptotically equivalent version of the LM test using an auxiliary
regression. State how to alternatively implement Wald and LR tests of β 2 = 0.
2.8 Show that variance-mean equality in the Poisson regression model
with exponential mean implies that E[{yi − exp(xi β)2 − yi }2 ] = 0. Using
this moment condition, obtain the conditional moment test statistic TCM
given (2.110), first showing that the simplifying condition (2.109) holds if
yi ∼ P[exp(xi β)]. State how to compute TCM by an auxiliary regression. Does
√
β̂ need to be the MLE here, or will any n−consistent estimator do?

CHAPTER 3

Basic Count Regression

3.1 INTRODUCTION
This chapter is intended to provide a self-contained treatment of basic crosssection count data regression analysis. It is analogous to a chapter in a standard
statistics text that covers both homoskedastic and heteroskedastic linear regression models.
The most commonly used count models are Poisson and negative binomial.
For readers interested only in these models, it is sufficient to read sections 3.1
to 3.5, along with preparatory material in sections 1.2 and 2.2.
As indicated in Chapter 2, the properties of an estimator vary with the
assumptions made on the dgp. By correct specification of the conditional
mean or variance or density, we mean that the functional form and explanatory
variables in the specified conditional mean or variance or density are those of
the dgp.
The simplest regression model for count data is the Poisson regression
model. For the Poisson MLE, the following can be shown:
1. Consistency requires correct specification of the conditional mean. It
does not require that the dependent variable y be Poisson distributed.
2. Valid statistical inference using default computed maximum likelihood standard errors and t statistics requires correct specification of
both the conditional mean and variance. This requires equidispersion,
that is, equality of conditional variance and mean, but not Poisson
distribution for y.
3. Valid statistical inference using appropriately computed standard
errors is still possible if data are not equidispersed, provided the conditional mean is correctly specified.
4. More efficient estimators than Poisson MLE can be obtained if data
are not equidispersed.
Properties 1 through 4 are similar to those of the OLS estimator in the
classical linear regression model, which is the MLE if errors are iid normal. The
Poisson restriction of equidispersion is directly analogous to homoskedasticity
69

70

Basic Count Regression

in the linear model. If errors are heteroskedastic in the linear model, one would
use alternative standard errors to those from the usual OLS output (property 3)
and preferably estimate by WLS (property 4).
In practice count data are often overdispersed, with conditional variance
exceeding the conditional mean. There are then several ways to proceed.
1. Poisson quasi-MLE (QMLE) with corrected standard errors.
2. Poisson quasi-generalized pseudo-MLE (QGPMLE) with corrected
standard errors. Estimation is based on the same conditional mean as
for the Poisson quasi-MLE, but on a different conditional variance
function.
3. MLE of a better parametric model for counts, such as the negative
binomial.
Approaches 1 and 2 are valid provided the conditional mean is correctly
specified, usually as exp(x β). Analysis focuses on how this conditional mean
changes as regressors change. Approach 2 has the advantage over approach 1
of yielding potentially more efficient estimation; however, with cross-sectional
data this gain can often be relatively small, so approach 1 is used more often.
Approach 3 generally requires that the parametric model is correctly specified, not just the conditional mean. This stronger assumption can lead to more
efficient estimation and allows one to analyze how conditional probabilities
such as Pr[y ≥ 4|x], rather than just the conditional mean, change as regressors
change.
It is important that such modifications to the Poisson MLE be made. Count
data are often very overdispersed, which causes default computed Poisson ML
t statistics to be considerably overinflated. This can lead to very erroneous and
overly optimistic conclusions of statistical significance of regressors.
The various Poisson regression estimators are presented in section 3.2, and
negative binomial regression estimators are given in section 3.3. Tests for
overdispersion are presented in section 3.4. Practical issues of interpretation of
coefficients with an exponential, rather than linear, specification of the conditional mean, as well as use of estimates for prediction, are presented in section
3.5.
An alternative approach to count data is to assume an underlying continuous
latent process, with higher counts arising as the continuous variable passes successively higher thresholds. Ordered probit and related discrete choice models
are presented in section 3.6. Least squares methods are the focus of section 3.7.
These are nonlinear least squares with exponential conditional mean function,
and OLS with the dependent variable a transformation of the count data y
to reduce heteroskedasticity and asymmetry. Given the simplicity of standard
count models, there is generally no reason to use these least squares methods
that ignore the count nature of the data.
For completeness, many different models, regression parameter estimators,
and standard error estimators are presented in this chapter. The models emphasized are the Poisson and two variants of the negative binomial – NB1 and

3.2 Poisson MLE, QMLE, and GLM

71

NB2. The estimators considered include MLE, QMLE, and QGPMLE. An
acronym such as NB2 MLE is shorthand for the NB2 model maximum likelihood estimator. Throughout this chapter, the methods presented are applied to
a regression model for the number of doctor visits, introduced in section 3.2.6.
For many analyses the Poisson QMLE with corrected standard errors, the
negative binomial MLE (NB2), and the ordered probit MLE are sufficient.
The most common departures from these standard count models, such as
hurdle models, zero-inflated models, the Poisson-Normal mixture model, and
finite mixtures models, are presented in the next chapter.
3.2 POISSON MLE, QMLE, AND GLM
Many of the algebraic results presented in this chapter need to be modified if
the conditional mean function is not exponential.
3.2.1

Poisson MLE

From section 1.2.3, the Poisson regression model specifies that yi given xi is
Poisson distributed with density
e−μi μi i
,
yi !
y

f (yi |xi ) =

yi = 0, 1, 2, . . .

(3.1)

and mean parameter
E[yi |xi ] = μi = exp(xi β).

(3.2)

The specification (3.2) is called the exponential mean function. The model
comprising (3.1) and (3.2) is usually referred to as the Poisson regression model,
a terminology we also use, although more precisely it is the Poisson regression
model with exponential mean function. In the statistics literature the model is
also called a log-linear model, because the logarithm of the conditional mean
is linear in the parameters: ln E[yi |xi ] = xi β.
Given independent observations, the log-likelihood is
ln L(β) =

n

{yi xi β − exp(xi β) − ln yi !}.

(3.3)

i=1

The Poisson MLE β̂ P is the solution to the first-order conditions
n

(yi − exp(xi β))xi = 0.

(3.4)

i=1

Note that if the regressors include a constant term then the residuals yi −
exp(xi β̂ P ) sum to zero by (3.4).
The standard method for computation of β̂ P is the Newton-Raphson iterative
method. Convergence is guaranteed, because the log-likelihood function is
globally concave. In practice often fewer than 10 iterations are needed. The

72

Basic Count Regression

Newton-Raphson method can be implemented by iterative use of OLS as
presented in section 3.8.
If the dgp for yi is indeed Poisson with mean (3.2), we can apply the usual
maximum likelihood theory as in Chapter 2.3.2. This yields
)
*
a
(3.5)
β̂ P ∼ N β, VML [β̂ P ]
where
VML [β̂ P ] =

 n


−1
μi xi xi

,

(3.6)

i=1


using E[∂ 2 lnL/∂β∂β  ] = − ni=1 μi xi xi . Strictly speaking, we should assume
that the dgp evaluates β at the specific value β 0 and replace β by β 0 in (3.5).
This more formal presentation is used in Chapter 2. In the rest of the book we
use a less formal presentation, provided the estimator is indeed consistent.
Most statistical programs use Hessian maximum likelihood standard errors
(MLH) using (3.6) evaluated at μ̂i = exp(xi β̂ P ). By the information matrix
equality, one can instead use the summed outer product of the first derivatives
(see Chapter 2.3.2), leading to the maximum likelihood outer product (MLOP)
estimator
 n
−1

2

(yi − μi ) xi xi
,
(3.7)
VMLOP [β̂ P ] =
i=1

evaluated at μ̂i . A general optimization routine may provide standard errors
based on (3.7), which asymptotically equals (3.6) if data are equidispersed.
In practice, data are not equidispersed, in which case neither (3.6) nor (3.7)
should be used.
3.2.2

Poisson Quasi-MLE

The assumption of a Poisson distribution is stronger than necessary for statistical inference based on β̂ P defined by (3.4). As discussed in Chapter 2.4.2, whose
results are used extensively here, consistency holds for the MLE of any specified LEF density such as the Poisson, provided the conditional mean function
(3.2) is correctly specified. An intuitive explanation is that consistency requires
the left-hand side of the first-order conditions (3.4) to have expected value zero.
This is the case if E[yi |xi ] = exp(xi β), because then E[(yi − exp(xi β))xi ] = 0.
Furthermore, according to this first-order condition y need not even be a count.
It is sufficient that y ≥ 0.
Given this robustness to distributional assumptions, we can continue to use
β̂ P even if the dgp for yi is not the Poisson. If an alternative dgp is entertained,
the estimator defined by the Poisson maximum likelihood first-order conditions
(3.4) is called the Poisson quasi-MLE (QMLE) or the Poisson pseudo-MLE.
This terminology means that the estimator is like the Poisson MLE in that

3.2 Poisson MLE, QMLE, and GLM

73

the Poisson model is used to motivate the first-order condition defining the
estimator, but it is unlike the Poisson MLE in that the dgp used to obtain
the distribution of the estimator need not be the Poisson. Here we assume the
Poisson mean, but relax the Poisson restriction of equidispersion.
The Poisson QMLE β̂ P is defined to be the solution to (3.4). If (3.2) holds
then
)
*
a
(3.8)
β̂ P ∼ N β, VQML [β̂ P ] ,
where
VQML [β̂ P ] =

 n

i=1

μi xi xi

−1  n


ωi xi xi

 n


i=1

−1
μi xi xi

(3.9)

i=1

and
ωi = V[yi |xi ]

(3.10)

is the conditional variance of yi . Implementation of (3.9) depends on what
functional form, if any, is assumed for ωi .
Poisson QMLE with Robust Standard Errors
The variance matrix (3.9) can be consistently estimated without specification of a functional form for ωi . We need to estimate for unknown ωi the
middleterm in VQML [β̂ P ] defined in (3.9). Formally, a consistent estimate of
lim n1 ni=1 E[(yi − μi )2 |xi ]xi xi is needed. It can be shown that if (yi , xi ) are

iid this k × k matrix is consistently estimated by n1 ni=1 (yi − μ̂i )2 xi xi , even
though it is impossible to consistently estimate each of the n scalars ωi by
(yi − μ̂i )2 . This yields the variance matrix estimate
 n
−1  n
 n
−1




2


μi xi xi
(yi − μi ) xi xi
μi xi xi
,
VRS [β̂ P ] =
i=1

i=1

i=1

(3.11)
which is evaluated at μ̂i . Usually the variance matrix is multiplied by the
finite-sample adjustment n/(n − k).
The estimator (3.11) is the RS estimator discussed in sections 2.5.1 and
2.7. It builds on the work by Eicker (1967), who obtained a similar result
in the nonregression case, and White (1980), who obtained this result in the
OLS regression case and popularized its use in econometrics. See Robinson
(1987a) for a history of this approach and for further references. This method
is used extensively throughout this book, in settings much more general than
the Poisson QMLE with cross-section data. As shorthand we refer to standard
errors as robust standard errors whenever a similar approach is used to obtain
standard errors without specifying functional forms for the second moments of
the dependent variable.

74

Basic Count Regression

An alternative way to proceed when the variance function ωi is not specified
is to bootstrap. This approach estimates properties of the distribution of β̂ P
and performs statistical inference on β by resampling from the original data
set. Bootstrapping the pairs (yi , xi ), see Chapter 2.6.4, leads to standard errors
asymptotically equivalent to those based on (3.11).
For equidispersed data, with E[(yi − μi )2 |xi ] = μi , the RS variance
 estimator is similar
to
the
MLH
and
MLOP
estimators
because
then
i (yi −

μi )2 xi xi  i μi xi xi . But in the common case that data are overdispersed,
with E[(yi − μi )2 |xi ] > μi , the correct RS variance estimator will be larger
than the incorrect MLH and MLOP estimators. These differences become larger
the greater the overdispersion.
3.2.3

NB1 and NB2 Variance Functions

In the Poisson regression model yi has mean μi = exp(xi β) and variance μi . We
now consider alternative models for the variance, because data almost always
reject the restriction that the variance equals the mean, while maintaining the
assumption that the mean is exp(xi β).
It is natural to continue to model the conditional variance ωi defined in
(3.10) as a function of the mean, with
ωi = ω(μi , α)

(3.12)

for some specified function ω(·) and where α is a scalar parameter. Most models
specialize this to the general variance function
p

ωi = μi + αμi ,

(3.13)

where the constant p is specified. Analysis is usually restricted to two special
cases, in addition to the Poisson case of α = 0.
First, the NB1 variance function sets p = 1. Then the variance
ωi = (1 + α)μi ,

(3.14)

is a multiple of the mean. In the GLM framework this is usually rewritten as
ωi = φμi ,

(3.15)

where φ = 1 + α.
Second, the NB2 variance function sets p = 2. Then the variance is
quadratic in the mean
ωi = μi + αμ2i .

(3.16)

In both cases the dispersion parameter α is a parameter to be estimated.
Cameron and Trivedi (1986), in the context of negative binomial models,
used the terminology NB1 model to describe the case p = 1 and NB2 model
to describe the case p = 2. Here we have extended this terminology to the
variance function itself.
These variance functions can be used in two ways. First, they can lead
to estimators that are more efficient than the Poisson QMLE; see subsequent

3.2 Poisson MLE, QMLE, and GLM

75

sections. Second, they can be used to obtain alternative standard errors for the
Poisson QMLE, as outlined in the remainder of this section. Common practice
is to nonetheless use the robust sandwich form (3.11) because it does not require
assuming a model for ωi .
Poisson QMLE with Poisson Variance Function
If the conditional variance of yi is that for the Poisson, so ωi = μi , then the
variance matrix (3.9) simplifies to (3.6). Thus the usual Poisson ML inference
is valid provided the first two moments are those for the Poisson.
Poisson QMLE with NB1 Variance Function
The simplest generalization of ωi = μi is the NB1 variance function (3.15).
Since ωi = φμi the variance matrix in (3.9) simplifies to
 n
−1


μi xi xi
= φVML [β̂ P ],
(3.17)
VNB1 [β̂ P ] = φ
i=1

where VML [β̂ P ] is the maximum likelihood variance matrix given in (3.6).
Thus, the simplest way to handle overdispersed or underdispersed data is to
begin with the computed Poisson maximum likelihood output. Then, multiply
maximum
likelihood output by φ to obtain the correct variance
√ matrix, multiply
√
by φ to obtain the correct standard errors, and divide by φ to get the correct
t statistics.
The standard estimator of φ is
n
1  (yi − μ̂i )2
.
(3.18)
φ̂ NB1 =
n − k i=1
μ̂i
The motivation for this estimator is that variance function (3.15) implies
E[(yi − μi )2 ] = φμi and hence φ = E[(yi − μi )2 /μi ]. The corresponding sample moment is (3.18), where division by (n − k) rather than n is a degrees-offreedom correction. This approach to estimation is the GLM approach presented
in Chapter 2.4.3; see also section 3.2.4. Poisson regression packages using the
GLM framework often use (3.17) for standard errors; most others instead use
(3.6) as the default.
Poisson QMLE with NB2 Variance Function
A common alternative specification for the variance of yi is the NB2 variance function (3.16). Then because ωi = μi + αμ2i , the variance matrix (3.9)
becomes
 n
−1  n
 n
−1




2


μi xi xi
(μi + αμi )xi xi
μi xi xi
.
VNB2 [β̂ P ] =
i=1

i=1

i=1

(3.19)

76

Basic Count Regression

This does not simplify and computation requires matrix routines. One of several
possible estimators of α is
α̂ NB2 =

n
1  {(yi − μ̂i )2 − μ̂i }
.
n − k i=1
μ̂2i

(3.20)

The motivation for this estimator of α is that (3.16) implies E[(yi − μi )2 −
μi ] = αμ2i and hence α = E[{(yi − μi )2 − μi }/μ2i ]. The corresponding sample moment with degrees-of-freedom correction is (3.20). This estimator was
proposed by Gourieroux et al. (1984a, 1984b).
Alternative estimators of φ and α for NB1 and NB2 variance functions
are given in Cameron and Trivedi (1986). In practice, studies do not present
estimated standard errors for φ̂ NB1 and α̂ NB2 , although they can be obtained
using the delta method given in Chapter 2.6.2. A series of papers by Dean (1993,
1994) and Dean, Eaves and Martinez (1995) considers different estimators for
the dispersion parameter and consequences for variance matrix estimation.
Some different estimators of α NB2 are discussed after Table 3.4.
3.2.4

Poisson GLM

Generalized linear models are defined in section 2.4.4. For the Poisson with
mean function (3.2), which is the canonical link function for this model, the
Poisson GLM density is
 

xi β yi − exp(xi β)
(3.21)
+ c(yi , φ) ,
f (yi |xi ) = exp
φ
where c(yi , φ) is a normalizing constant. Then V[yi ] = φμi , which is the NB1
variance function.
The Poisson GLM estimator β̂ PGLM maximizes with respect to β the corresponding log-likelihood, with first-order conditions
n

1
(yi − exp(xi β))xi = 0.
φ
i=1

(3.22)

These first-order conditions coincide with (3.4) for the Poisson QML, except
for scaling by the constant φ. Consequently β̂ PGLM = β̂ P , and the variance
matrix is the same as (3.17) for the Poisson QML with NB1 variance function
 n
−1

μi xi xi
.
(3.23)
V[β̂ PGLM ] = φ
i=1

To implement this last result for statistical inference on β, GLM practitioners
use the consistent estimate φ̂ NB1 defined in (3.18).
A more obvious approach to estimating the nuisance parameter φ is to
maximize the log-likelihood based on (3.21) with respect to both β and φ.
Differentiation with respect to φ requires an expression for the normalizing

3.2 Poisson MLE, QMLE, and GLM

77

constant c(yi , φ), however, and the restriction that probabilities sum to unity


∞

1 

exp
(x β yi − exp(xi β)) + c(yi , φ) = 1
φ i
y =0
i

has no simple solution for c(yi , φ). One therefore uses the estimator (3.18),
which is based on assumptions about the first two moments rather than the
density. More generally the density (3.21) is best thought of as merely giving
a justification for the first-order conditions (3.22), rather than as a density that
would be used, for example, to predict the probabilities of particular values
of y.
3.2.5

Poisson EE

A quite general estimation procedure is to use the estimating equation presented
in Chapter 2.4.5,
n

1
∂μ
(yi − μi ) i = 0,
ωi
∂β
i=1

which generalizes linear WLS. Consider a specific variance function of the form
α be a consistent estimator of α. For the exponential
ωi = ω(μi , α), and let 
mean function ∂μi /∂β = μi xi , so β̂ EE solves the first-order conditions
n

i=1

1
(yi − μi )μi xi = 0.
ω(μi , 
α)

If the variance function is correctly specified, then it follows that
 n
−1

1
2

.
μ xi x
VEE [β̂ EE ] =
ω(μi , α) i i
i=1

(3.24)

(3.25)

Because this estimator is motivated by specification of the first two moments,
it can also be viewed as a method of moments estimator, a special case of
GMM whose more general framework is unnecessary here because the number
of equations (3.24) equals the number of unknowns. The first-order conditions
nest as special cases those for the Poisson MLE and GLM, which replace
α ) by μi or φμi .
ω(μi , 
3.2.6

Example: Doctor Visits

Consider the following example of the number of doctor visits in the past
two weeks for a single-adult sample of size 5,190 from the Australian Health
Survey 1977–78. This and several other measures of health service utilization
such as days in hospital and number of medicines taken were analyzed in
Cameron, Trivedi, Milne, and Piggott (1988) in the light of an economic model
of joint determination of health service utilization and health insurance choice.

78

Basic Count Regression

Table 3.1. Doctor visits: Actual frequency distribution
Count
0
1
2
3
4
5
6
7
8
9
Frequency
4,141 782 174 30
24
9
12
12
5
1
Relative frequency 0.798 0.151 0.033 0.006 0.005 0.002 0.002 0.002 0.001 0.000

The particular data presented here were also studied by Cameron and Trivedi
(1986). The analysis of this example in this chapter (see also sections 3.3.5,
3.4.2, 3.5.2, and 3.7.5) is more detailed and covers additional methods.
Table 3.1 summarizes the dependent variable DVISITS. There are few large
counts, with 98% of the sample taking values of 0, 1, or 2. The mean number of
doctor visits is 0.302 with variance 0.637. The raw data are therefore overdispersed, although inclusion of regressors may eliminate the overdispersion.
The variables are defined and summary statistics given in Table 3.2. Regressors can be grouped into four categories: (1) socioeconomic: SEX, AGE,
AGESQ, INCOME; (2) health insurance status indicators: LEVYPLUS, FREEPOOR, and FREEREPA, with LEVY (government Medibank health insurance)
the omitted category; (3) recent health status measures: ILLNESS, ACTDAYS;
and (4) long-term health status measures: HSCORE, CHCOND1, CHCOND2.
The Poisson maximum likelihood estimates defined by (3.4) are given in
the first column of Table 3.3. These estimates are by definition identical to
the Poisson QML estimates. Various estimates of the standard errors are given
Table 3.2. Doctor visits: Variable definitions and summary statistics
Variable
DVISITS
SEX
AGE
AGESQ
INCOME
LEVYPLUS
FREEPOOR
FREEREPA
ILLNESS
ACTDAYS
HSCORE
CHCOND1
CHCOND2

Definition
Number of doctor visits in past two weeks
Equals 1 if female
Age in years divided by 100
AGE squared
Annual income in tens of thousands of dollars
Equals 1 if private health insurance
Equals 1 if free government health
insurance due to low income
Equals 1 if free government health insurance
due to old age, disability, or veteran status
Number of illnesses in past two weeks
Number of days of reduced activity in past
two weeks due to illness or injury
General health questionnaire score using
Goldberg’s method
Equals 1 if chronic condition not limiting
activity
Equals1 if chronic condition limiting activity

Mean

Standard
deviation

0.302
0.521
0.406
0.207
0.583
0.443
0.043

0.798
0.500
0.205
0.186
0.369
0.497
0.202

0.210

0.408

1.432
0.862

1.384
2.888

1.218

2.124

0.403

0.491

0.117

0.321

3.2 Poisson MLE, QMLE, and GLM

79

Table 3.3. Doctor visits: Poisson QMLE with different standard
error estimates
Coefficient
Variable
ONE
SEX
AGE
AGESQ
INCOME
LEVYPLUS
FREEPOOR
FREEREPA
ILLNESS
ACTDAYS
HSCORE
CHCOND1
CHCOND2
−ln L

Poisson PMLE
−2.224
0.157
1.056
−0.849
−0.205
0.123
−0.440
0.080
0.187
0.127
0.030
0.114
0.141
3355.5

Standard errors
RS
0.254
0.079
1.364
1.460
0.129
0.095
0.290
0.126
0.024
0.008
0.014
0.091
0.123

t statistic

MLH MLOP NB1 NB2 Boot
0.190
0.056
1.001
1.078
0.088
0.072
0.180
0.092
0.018
0.005
0.010
0.067
0.083

0.144
0.041
0.750
0.809
0.062
0.056
0.116
0.070
0.014
0.004
0.007
0.051
0.059

0.219
0.065
1.153
1.242
0.102
0.083
0.207
0.106
0.021
0.006
0.012
0.077
0.096

0.207
0.062
1.112
1.210
0.096
0.077
0.188
0.102
0.021
0.006
0.012
0.071
0.092

0.271
0.076
1.391
1.477
0.129
0.100
0.293
0.132
0.024
0.008
0.014
0.087
0.120

RS
−8.74
1.98
0.77
−0.58
−1.59
1.29
−1.52
0.63
7.81
16.33
2.11
1.26
1.15

Note: Different standard error estimates are due to different specifications of ω, the conditional
variance of y. RS, unspecified ω robust sandwich estimate; MLH, ω = μ Hessian estimate; MLOP,
ω = μ summed outer product of first derivatives estimate; NB1, ω = φμ = (1 + α)μ where
α = 0.382; NB2, ω = μ + αμ2 where α = 0.286; and Boot, unspecified ω bootstrap estimate.

in the remainder of the table, under different assumptions about the variance
of y, where throughout it is assumed that the conditional mean is correctly
specified as in (3.2). Standard errors are presented rather than t statistics to
allow comparison with the precision of alternative estimators given in later
tables.
The column labeled RS lists the preferred robust sandwich estimates given
in (3.11). The column labeled Boot lists bootstrap standard errors, based on
bootstrap pairs resampling with 400 repetitions, that are generally within 5%
of the RS standard errors, as expected.
The column labeled MLH gives standard errors, which are often the default
standard errors following Poisson regression, that are based on the inverse
of the Hessian (3.6). They are on average 70% of the RS standard errors,
a consequence of the overdispersion in the data as discussed at the end of
section 3.2.2.
If instead one uses the summed outer product of the first derivatives, the
resulting MLOP standard errors using (3.7) are in this example on average
an additional 25% lower than MLH standard errors. Comparison of (3.6) and
(3.7) shows that this difference
in standard errors is consistent with E[(yi −
√
μi )2 |xi ] = φμi , where 1/ φ  0.75 or α = (φ − 1)  0.78. More generally
for overdispersed data the MLOP standard errors will be biased downward
even more than the usual MLH standard errors (3.6).

80

Basic Count Regression

The columns labeled MLH, NB1, and NB2 specify that the variance of y
equals, respectively, the mean, a multiple of the mean, and a quadratic function
of the mean. The standard errors NB1 are 1.152 times MLH standard errors,
because φ̂ NB1 = 1.328 using (3.18), which has square root 1.152. The standard
errors NB2 are obtained using (3.9), where (3.20) yields α̂ NB2 = 0.286. These
estimated values of α are not reported in the table, because they are not used in
forming an estimate of β. Those values are used only to obtain standard errors.
Although the NB1 and NB2 standard errors are preferred to MLH, they
are still substantially downward biased compared to the preferred RS standard
errors. In principle specifying a model for ωi does have the advantage of yielding more precise standard error estimates (i.e., a smaller variance of V̂[β̂ P ]). In
results not reported in Table 3.3, we used the bootstrap method to estimate the
standard deviation of the standard error estimates as discussed in section 2.6.4.
The standard deviation of NB1 standard errors was on average 3% of the average NB1 standard error, whereas the standard deviation of RS standard errors
was on average 6% of the average RS standard error. This lower variability for
NBI standard errors is not enough to compensate for the downwards bias.
Other count applications yield similar results. In the usual case in which data
are overdispersed, the MLH (and MLOP) standard errors are smaller than RS
standard errors and should not be used. The differences can be much greater than
in this example if data are greatly overdispersed. One should never use MLH
or MLOP here. The NB1 (or NB2) standard errors are an improvement, and
historically NB1 standard errors were very appealing due to the computational
advantage of being a simple rescaling of MLH standard errors often reported
by ML routines. But it is safest and common practice to use RS standard errors.
The final column of Table 3.3 gives t statistics based on the RS standard
errors. By far the most statistically significant determinants of doctor visits in
the past two weeks are recent health status measures – the number of illnesses
and days of reduced activity in the past two weeks – with positive coefficients,
confirming that sicker people are more likely to visit a doctor. The long-term
health status measure HSCORE and the socioeconomic variable SEX are also
statistically significant at significance level 5%. Discussion of the impact of
these variables on the number of doctor visits is deferred to section 3.5.
3.3 NEGATIVE BINOMIAL MLE AND QGPMLE
The Poisson QML estimator handles overdispersion or underdispersion by
moving away from complete distributional specification. Instead estimation
is based on specification of the first moment and inference that adjusts for
departures from equidispersion.
Here we consider two methods that can lead to more efficient estimation.
The first is to specify a more appropriate parametric model to account for
overdispersion. In this chapter we consider the standard model that accommodates overdispersion, the negative binomial, which is motivated and derived in
Chapter 4.

3.3 Negative Binomial MLE and QGPMLE

81

The second method is a less parametric method that bases estimation on
specification of the first two moments, where the variance is modeled using the
NB2 variance.
NB2 Model and MLE

3.3.1

The most common implementation of the negative binomial is the NB2 model,
with mean μ and NB2 variance function μ + αμ2 defined in (3.16). It has
density
(y + α −1 )
f (y|μ, α) =
(y + 1)(α −1 )



α −1
α −1 + μ

α −1



μ
α −1 + μ

y

,

α ≥ 0, y = 0, 1, 2, . . . .

(3.26)

This reduces to the Poisson if α = 0 (see section 3.3.4).
The function (·) is the gamma
function, defined in Appendix B, where it
y−1
is shown that (y + a)/ (a) = j =0 (j + a), if y is an integer. Thus,

ln

(y + α −1 )
(α −1 )

=

y−1


ln(j + α −1 ).

(3.27)

j =0

Substituting (3.27) into (3.26), the log-likelihood function for exponential
mean μi = exp(xi β) is therefore
ln L(α, β) =

n 

yi −1
i=1

j =0

ln(j + α −1 ) − ln yi !

(3.28)


− (yi + α −1 ) ln(1 + α exp(xi β)) + yi ln α + yi xi β .
The NB2 MLE (β̂ NB2 , α̂ NB2 ) is the solution to the first-order conditions
n

yi − μi
xi = 0
1
+ αμi
i=1
 
n

y −1
1
1
ln(1 + αμi ) − j i=0
2
α
(j
+
α −1 )
i=1

(3.29)
yi − μi

+ 
α 1 + αμi

= 0.

Given correct specification of the distribution


β̂ NB2
α̂ NB2



⎛  ⎡
⎤⎞
V
β
[
β̂
]
Cov
[
β̂
,
α̂
]
ML
NB2
ML
NB2
NB2
a
⎦⎠
∼ N⎝
,⎣
α
VML [α̂ NB2 ]
CovML [β̂ NB2 , α̂ NB2 ]
(3.30)

82

Basic Count Regression

where
VML [β̂ NB2 ] =

 n

i=1

μi
xi xi
1 + αμi

−1
(3.31)

,

⎛
⎞−1
⎞2
⎛
yi −1
n

1
μ
⎜ 1 ⎝
⎟
⎠ +
 i
⎠ ,
ln(1+αμi )−
VML [α̂ NB2 ] = ⎝
4
−1
2
α
(j
+
α
)
1+αμ
α
i
i=1
j =0
(3.32)
and
CovML [β̂ NB2 , α̂ NB2 ] = 0.

(3.33)

This result is obtained by noting that the information matrix is block-diagonal,
because differentiating the first term in (3.29) with respect to α yields
 n


 yi − μi
∂ 2 ln L

μ xi x = 0,
=E −
E
(3.34)
∂β∂α
(1 + αμi )2 i i
i=1
as E[yi |xi ] = μi . This simplifies analysis because then the general result in
Chapter 2.3.2 for the maximum likelihood variance matrix specializes to
⎤
⎤−1 ⎡ ) ) 2 **−1
⎡ ) 2 *
∂ ln L
∂ ln L
E
0
0
E ∂β∂β


⎥
∂β∂β
) 2 *⎦ = ⎢
⎣
) ) 2 **−1 ⎦ .
⎣
∂ ln L
∂
ln
L
0
E ∂α2
0
E
2
∂α

Many packages offer this negative binomial model as a standard option.
Alternatively, one can use a maximum likelihood routine with user-provided
log-likelihood function and possibly derivatives. In this case, potential computational problems can be avoided by using the form of the log-likelihood
function given in (3.28) or by using the log-gamma function rather than first
calculating the gamma function and then taking the natural logarithm. If instead
one tries to directly compute the gamma functions, numerical calculation of
(z) with large values of z may cause an overflow, for example, if z > 169 in
the matrix program GAUSS. The restriction to α positive can be ensured by
instead estimating α ∗ = ln α and then obtaining α = exp(α ∗ ).
3.3.2

NB2 Model and QGPMLE

The NB2 density can be reexpressed as


f (y|μ, α) = exp −α −1 ln(1 + αμ) + ln

+ y ln

αμ
1 + αμ


.

(y + α −1 )
(y + 1)(α −1 )
(3.35)

3.3 Negative Binomial MLE and QGPMLE

83

If α is known this is an LEF density defined in Chapter 2.4.2 with a(μ) =
−α −1 ln(1 + αμ) and c(μ) = ln(αμ/(1 + αμ)). Because a  (μ) = −1/(1 +
αμ) and c (μ) = 1/μ(1 + αμ) it follows that E[y] = μ and V[y] = μ + αμ2 ,
which is the NB2 variance function.
If α is unknown, this is an LEFN density defined in Chapter 2.4.3. Given a
consistent estimator 
α of α, such as (3.20), the QGPMLE β̂ QGPML maximizes


n 


α μi
ln LLEFN =
α μi ) + yi ln
α) .
−
α −1 ln(1 + 
+ b(yi , 
1 +
α μi
i=1
(3.36)
For exponential conditional mean (3.4), the first-order conditions are
n

yi − μi
xi = 0.
1 +
α μi
i=1

(3.37)

Using results from Chapter 2.4.3, or noting that (3.37) is a special case of the
estimating equation (3.24), β̂ QGPML is asymptotically normal with mean 0 and
variance
 n
−1
 μi

xi xi
.
(3.38)
V[β̂ QGPML ] =
1 + αμi
i=1
This equals VML [β̂ NB2 ] defined in (3.31), so that β̂ QGPML is fully efficient for
β if the density is NB2, although 
α is not necessarily fully efficient for α.
The NB2 density with α known is a member of the GLM class. So we could
alternatively call β̂ QGPML the NB2 GLM estimator.
The GLM literature sometimes uses a specification of the conditional mean
other than exponential. Given (3.31) with α known, the canonical link function
αμ
), leading to conditional mean function
(see Chapter 2.4.4) is η = ln( 1+αμ
E[yi |xi ] = μGLM,i =

exp(xi β)
,

α (1 − exp(xi β))

(3.39)

This functional form has the advantage that
 maximization of (3.36) when μi =
μGLM,i leads to first-order conditions ni=1 (yi − μGLM,i )xi = 0 that can be
interpreted as the residual is orthogonal to the regressors. But the parameters β
in specification (3.39) are not easily interpreted, with ∂μGLM,i /∂β = (μGLM,i +

α μ2GLM,i )xi . And the computational method needs to ensure that xi β < 0 so
μGLM,i > 0. This limits the usefulness of this parameterization.
3.3.3

NB1 Model and MLE

Cameron and Trivedi (1986) considered a more general class of negative binop
mial models with mean μi and variance function μi + αμi . The NB2 model,

84

Basic Count Regression

with p = 2, is the standard formulation of the negative binomial model. Models with other values of p have the same density as (3.26), except that α −1 is
replaced everywhere by α −1 μ2−p .
The NB1 model, which sets p = 1, is also of interest because it has the
same variance function, (1 + α)μi = φμi , as that used in the GLM approach.
The NB1 log-likelihood function is
⎧⎛
⎞
n ⎨ y
i −1

⎝
ln(j + α −1 exp(xi β)⎠ − ln yi !
ln L(α, β) =
⎩
i=1

j =0


− (yi + α −1 exp(xi β)) ln(1 + α) + yi ln α .
The NB1 MLE solves the associated first-order conditions
⎧⎛
⎫
⎞
n ⎨ y
i −1
⎬
−1

α
μ
i
⎠ xi + α −1 μi xi = 0
⎝
⎩
⎭
(j + α −1 μi )
i=1
j =0

⎫
⎧ ⎛
⎞
yi −1
n
⎬
⎨


1
μi
⎠ − α −2 μi ln(1 + α) − α + yi α = 0.
⎝
−
⎭
α2 ⎩
(j + α −1 )
1+α
i=1
j =0

Estimation based on the first two moments of the NB1 density yields the
Poisson GLM estimator, which we also call the NB1 GLM estimator.
3.3.4

Discussion

One can clearly consider negative binomial models other than NB1 and NB2.
The generalized event count model, presented in Chapter 4.11.1, includes the
p
negative binomial with mean μi and variance function μi + αμi , where p is
estimated rather than set to the value 1 or 2. And we could generalize α to
α i = exp(zi α).
The NB2 model has a number of special features not shared by other models
in this class, including block diagonality of the information matrix, being a
member of the LEF if α is known, robustness to distributional misspecification,
and nesting as a special case of the geometric distribution when α = 1.
The NB2 MLE is robust to distributional misspecification, due to membership in the LEF for specified α. Thus, provided the conditional mean is
correctly specified, the NB2 MLE is consistent for β. This can be seen by
directly inspecting the first-order conditions for β given in (3.29), whose lefthand side has an expected value of zero if the mean is correctly specified. This
follows because E[yi − μi |xi ] = 0.
The associated maximum likelihood standard errors of the NB2 MLE are,
however, generally inconsistent if there is any distributional misspecification.
First, they are inconsistent if (3.16) does not hold, so the variance function
is incorrectly specified. Second, even if the variance function is correctly
specified, in which case it can be shown that V[β̂ NB2 ] is again that given in
(3.31), failure of the negative binomial assumption leads to evaluation of (3.31)

3.3 Negative Binomial MLE and QGPMLE

85

at an inconsistent estimate of α. From (3.29)
consistency of α̂ NB2
requires
yi −1
n
{ln(1
+
αμ
)
−
both E[yi − μi |xi ] = 0 and, in expectation,
i
i=1
j =0 1/
(j + α −1 )} = 0. This last condition holds only if in fact y is negative
binomial.
For this reason it is best to use robust standard errors for the NB2 MLE.
Essentially we treat the NB2 MLE as a quasi-MLE and use the variance matrix
estimate given in section 3.2.4.
Negative binomial models other than NB2 are not at all robust to distributional misspecification. Then, consistency of the MLE for β requires that the
data are negative binomial. Correct specification of the mean and variance is
not enough.
Another variation in negative binomial models is to allow the overdispersion
parameter to depend on regressors. For example, for the NB2 model α can be
replaced by α i = exp(zi γ ), which is ensured to be positive. Then the first-order
conditions with respect to γ are similar to (3.29), with the term in the sum
in the second line of (3.29) multiplied by ∂α i /∂γ i . In this book we present
a range of models with the dispersion parameter entering in different ways,
but for simplicity we generally restrict the dispersion parameter to be constant.
Jorgensen (1997) gives a general treatment of models with the dispersion
parameter that depends on regressors.
It is not immediately clear that the Poisson is a special case of the negative
binomial. To see this for NB2, we use the gamma recursion and let a = α −1 .
The NB2 density (3.26) is
⎞
⎛

y−1
a
y

1
a
1
⎠
⎝
(j + a)
μy
f (y) =
y!
a
+
μ
a
+
μ
j =0
⎛

⎞
 j +a  a
⎠
= ⎝
a
+
μ
a+μ
j =0
⎛

=

y−1

⎞

+1
1
⎠
μ
1
+
1
+
a
j =0

y−1 j

a
⎝

→ 1 e−μ μy

1
y!

a

μy

1
y!

a
μ
a

μy

1
y!

as a → ∞.

y−1
The second equality uses (1/(a + μ))y = j =0 1/(a + μ). The third equality
involves some rearrangement. The last equality uses lim (1 + x/a)a = ex . The
a→∞

final expression is the Poisson density. So Poisson is the special case of NB2
where α = 0.
If a negative binomial model or other parametric model correctly specifies
the distribution, it has the advantage of enabling predictions about individual
probabilities. This allows analysis of tail behavior, for example, rather than
only the conditional mean.

86

Basic Count Regression

Table 3.4. Doctor visits: NB2 and NB1 model estimators and standard errors
Estimators
NB2
Variable
ONE
SEX
AGE
AGESQ
INCOME
LEVYPLUS
FREEPOOR
FREEREPA
ILLNESS
ACTDAYS
HSCORE
CHCOND1
CHCOND2
α
−ln L

MLE

QGP

−2.190
0.217
−0.216
0.609
−0.142
0.118
−0.497
0.145
0.214
0.144
0.038
0.099
0.190
1.077
3198.7

−2.203
0.188
0.511
−0.227
−0.174
0.113
−0.461
0.100
0.198
0.132
0.034
0.104
0.159
0.286
3226.8

Standard errors
NB1

NB2

NB1

MLE

GLM

MLE

QGP

MLE

GLM

−2.202
0.164
0.279
0.021
−0.135
0.212
−0.538
0.208
0.196
0.112
0.036
0.132
0.174
0.455

−2.224
0.157
1.056
−0.849
−0.205
0.123
−0.440
0.080
0.187
0.127
0.030
0.114
0.141
0.328

0.249
0.074
1.367
1.473
0.122
0.091
0.254
0.121
0.024
0.009
0.014
0.083
0.117
0.117

0.252
0.076
1.362
1.459
0.126
0.094
0.276
0.124
0.024
0.008
0.014
0.087
0.120

0.228
0.071
1.208
1.315
0.110
0.084
0.254
0.113
0.022
0.007
0.013
0.080
0.107
0.057

0.254
0.079
1.364
1.460
0.129
0.095
0.290
0.126
0.024
0.008
0.013
0.091
0.123

Note: NB1 variance function is ω = φμ = (1 + α)μ; NB2 is ω = μ + αμ2 .

3.3.5

Example: Doctor Visits (Continued)

Table 3.4 presents estimates and standard errors using the most common generalizations of Poisson regression for count data. In all cases we present robust
sandwich standard errors. If these standard errors are needed for the NB1 MLE,
however, then there is a more fundamental problem of estimator inconsistency,
whereas the other estimators retain consistency provided the conditional mean
is correctly specified.
The various estimators of the regression coefficients β tell a consistent story,
although they differ for some variables by more than 20% across the different
estimation methods. The signs of AGE and AGESQ vary across estimators,
although all can be shown to imply that the number of doctor visits increases
with age for ages in the range of 20–60 years.
The robust sandwich standard errors reveal some efficiency gain to using
estimators other than Poisson (equivalent to NB1 GLM in the final column). The
efficiency gain is greatest for NB1 MLE with standard errors that are 10%–15%
lower than Poisson. From results not given in Table 3.4, the preferred robust
standard errors are larger than the default nonrobust standard errors, which
assume correct specification of the variance function. The difference is 5% for
the ML estimators and a substantial 25% for the QGPML estimators.
The first column of Table 3.4 gives the NB2 MLE for overdispersed data,
whereas the second column gives the NB2 QGPMLE. The difference between
the two is due to different estimates of α: α̂ = 1.077 for the MLE and α̂ = 0.286

87

Sample frequency
NB2 no regressors
NB2 with regressors

0

0

Sample frequency
Poisson no regressors
Poisson with regressors

Sample and predicted frequencies
.2
.4
.6

Sample and predicted frequencies
.2
.4
.6

.8

.8

3.3 Negative Binomial MLE and QGPMLE

0

1

2

3

4

0

1

2

3

4

Figure 3.1. Doctor visits: Poisson and NB2 predicted probabilities.

for the QGPMLE estimate from first estimating β by Poisson regression and
then using (3.20). For NB2 QGPMLE or, equivalently, NB2 GLM, there are
many different ways to estimate α. The GLM literature suggests choosing α so
that the Pearson statistic or deviance statistic, see Chapter 5.3, equals n − k.
Using the Pearson statistic this leads to α̂ = 1.080, which is considerably
different from the value 0.286 used in Table 3.4; using the deviance statistic
yields α̂ = 0 because the deviance is less than n − k for all α̂ ≥ 0.
The third column gives the NB1 MLE for overdispersed data, whereas the
fourth column gives the NB1 QGPMLE. For the NB1 variance function, the
maximum likelihood and moment-based estimates α̂ = 1 − φ̂ of, respectively,
0.455 and 0.328 are quite similar, unlike for the NB2 variance function. The
moment-based estimates for NB1 use (3.18). Another moment-based method,
that given in Cameron and Trivedi (1986, p. 46), yields α̂ = 0.218. Such differences in estimates of α have received little attention in the literature, in part
because interest lies in estimation of β, with α a nuisance parameter. But these
estimates can lead to different results.
Within the maximum likelihood framework, the NB2 model is preferred
here to NB1 because it has considerably higher log-likelihood, −3198.7 >
−3226.6, with the same number of parameters. In practice, most studies use
either NB2 MLE or Poisson QMLE (equivalent to NB1 GLM).
Fully parametric models permit computation of predicted probabilities
rather than just the predicted conditional mean. Let pij = Pr[yi = j |xi , θ ]
and p̂ij = Pr[yi = j |xi , θ̂ ]. For example, for the Poisson model pij =

model check is to compare the
e− exp(xi β) exp(j xi β)/j ! A useful parametric

average fitted probabilities p̂j = n1 ni=1 p̂ij for j = 0, 1, 2, . . . with the corresponding sample frequencies.
Figure 3.1 compares sample frequencies to predicted probabilities from
the Poisson model (using (3.1)) and negative binomial (NB2) model (using
(3.26)), without and with regressors. From the first panel, the intercept-only

88

Basic Count Regression

Table 3.5. Simulation: Estimators under alternative dgps
Estimators and standard errors
Data generated from NB2

Data generated from NB1

Variable

Poiss

NB1

NB2

Poiss

NB1

ONE

−0.008
(0.037)
2.021
(0.062)

0.497
(0.028)
1.218
(0.043)
1.941
(0.051)

−0.009
(0.034)
2.022
(0.057)

0.019
(0.026)
1.978
(0.037)

0.014
(0.024)
1.985
(0.034)
.
(1.62)

x
α for NB1
α for NB2
−ln L

7.224
(0.181)
−37,654 −21,449 −21,381

NB2

NB2def

0.017
0.017
(0.027) (0.022)
1.981
1.981
(0.039) (0.035)
0.141
(1.15)
0.601
0.601
(0.015) (0.016)
−24,982 −21,399 −21,666 −21,666

Note: Simulation with intercept 0, slope 2, α = 2, and n = 10,000 observations. Poiss is Poisson
MLE, NB1 is NB1 MLE, and NB2 is NB2 MLE. Reported standard errors are all robust sandwich,
except for the last column, which uses the MLE default standard errors.

Poisson clearly underpredicts zero counts and overpredicts ones. The inclusion
of regressors reduces but not does not eliminate this difference. This is the
“excess zeros” phenomenon that often arises when the Poisson is applied to
overdispersed data. From the second panel, the negative binomial does not have
this weakness, at least for these data, and the inclusion of regressors leads to
better prediction of counts greater than zero. Such comparisons also form the
basis of a formal goodness-of-fit test; see Chapter 5.3.4.
3.3.6

Simulation: Estimator properties given known dgp

We consider estimation given a known data generating process with 10,000
observations. The purpose of the exercise is to demonstrate the theoretical
result that Poisson QMLE and NB2 MLE estimators are consistent provided
only that the conditional mean is correctly specified, whereas the NB1 MLE
additionally requires correct specification of the conditional variance (and even
then it would additionally require correct specification of the distribution).
In the first three columns of Table 3.5, the data are generated from an
NB2 model with mean μi = exp(0 + 2xi ) and variance μi + 2μ2i , where xi ∼
U[0, 1]. The counts have mean 3.2 and variance 35.2, and they range from 0
to 102. From the second column, the NB1 MLE is inconsistent, with slope
coefficient 1.218 rather than 2.0. Comparing the first and second columns, the
NB2 MLE is somewhat more efficient than Poisson, with a standard error for
the slope coefficient of 0.057 compared to 0.062.
In the final four columns of Table 3.5, the data are generated from an
NB1 model with mean μi = exp(0 + 2xi ) and variance μi + 2μi , where xi ∼
U[0, 1]. The counts have mean 3.2 and variance 12.4, and they range from

3.4 Overdispersion Tests

89

0 to 27. All three estimators, including the NB2 MLE, are consistent for the
regression parameters. The NB1 MLE is most efficient as expected, with a
standard error for the slope coefficient of 0.034 compared to 0.037 for Poisson and 0.039 for NB2 MLE. The final column of Table 3.5 shows that the
default standard errors for the NB2 MLE are smaller than the robust standard
errors, being 0.035 versus 0.039 for the slope coefficient. This demonstrates
that, although the NB2 MLE remains consistent if the variance function is
misspecified, robust rather than default standard errors should then be used.
This mirrors the result for the Poisson MLE.
3.4 OVERDISPERSION TESTS
Failure of the Poisson assumption of equidispersion has similar qualitative
consequences to failure of the assumption of homoskedasticity in the linear
regression model, but the magnitude of the effect on reported standard errors
and t statistics can be much larger. To see this, suppose ωi = 4μi . Then by
equation (3.17) the variance matrix of the Poisson QML estimator is four times
the reported maximum likelihood variance matrix using (3.6). As a result the
default MH Poisson maximum likelihood t statistics need to be deflated by a
factor of two. Overdispersion as large as ωi = 4μi arises, for example, in the
recreational trips data (Chapter 1.3) and in health services data on length of
hospitalization.
The easiest way to deal with overdispersion is to view the Poisson MLE
as a quasi-MLE and to base inference on the robust standard errors given in
section 3.2.2. The tests for overdispersion presented in this section should be
employed if instead one wants to take a full parametric approach and view the
estimator as an MLE and base inference on default ML standard errors.
3.4.1

Overdispersion Tests

Data are overdispersed if the conditional variance exceeds the conditional mean.
An indication of the magnitude of overdispersion or underdispersion can be
obtained simply by comparing the sample mean and variance of the dependent
count variable. Subsequent Poisson regression somewhat decreases the conditional variance of the dependent variable. The average of the conditional mean
will be unchanged, however, because the average of the fitted means equals the
sample mean. This follows because Poisson residuals sum to zero if a constant
term is included. If the sample variance is less than the sample mean, the data
necessarily are even more underdispersed once regressors are included. If the
sample variance is more than twice the sample mean, then data are likely to
remain overdispersed after the inclusion of regressors. This is particularly so
for cross-section data, for which regressors usually explain less than half the
variation.
The standard models for overdispersion have already been presented. These
are the NB1 variance function ωi = μi + αμi as in (3.14) or NB2 variance

90

Basic Count Regression

function ωi = μi + αμ2i as in (3.16). If one takes the partially parametric meanvariance approach (GLM), it is easier to use the NB1 variance function, which
leads to the Poisson QMLE. If one takes the fully parametric negative binomial
approach, it is customary to use NB2.
A sound practice is to estimate both Poisson and negative binomial models
if software is readily available. The Poisson is the special case of the negative
binomial with α = 0. The null hypothesis H0 : α = 0 can be tested against the
alternative α > 0 using the hypothesis test methods presented in Chapter 2.6.1.
An LR test uses −2 times the difference in the fitted log-likelihoods of the
two models. Alternatively a Wald test can be performed, using the reported t
statistic for the estimated α in the negative binomial model.
The distribution of these statistics is nonstandard, due to the restriction that
α cannot be less than zero. This complication is usually not commented on, a
notable exception being Lawless (1987). One way to see problems that arise
is to consider constructing a Monte Carlo experiment to obtain the distribution
of the test statistic. We would draw samples from the Poisson, because this is
the model under the null hypothesis of no overdispersion. Roughly half of the
time the data will be underdispersed. Then the negative binomial MLE for α
is zero, the negative binomial parameter estimates equal the Poisson estimates,
and the LR test statistic takes a value of 0. Clearly this test statistic is not χ 2
distributed, because half its mass is at zero. Similar problems arise for the Wald
test statistic. A general treatment of hypothesis testing at boundary values is
given by Moran (1971). The asymptotic distribution of the LR test statistic
has probability mass of one-half at zero and a half-χ 2 (1) distribution above
zero. This means that if testing at level δ, where δ > 0.5, one rejects H0 if
the test statistic exceeds χ 21−2δ (1) rather than χ 21−δ (1). The Wald test is usually
implemented as a t-test statistic, which here has mass of one-half at zero and a
normal distribution for values above zero. In this case one continues to use the
usual one-sided test critical value of z1−δ . Essentially the only adjustment that
needs to be made is an obvious one to the χ 2 critical values, which arises due
to performing a one-sided rather than two-sided test.
If a package program for negative binomial regression is unavailable, one can
still test for overdispersion by estimating the Poisson model, constructing fitted
values μ̂i = exp(xi β̂), and performing the auxiliary OLS regression (without
constant)
(yi − μ̂i )2 − yi
= α μ̂i + ui ,
μ̂i

(3.40)

where ui is an error term. The reported t statistic for α is asymptotically
normal under the null hypothesis of no overdispersion against the alternative
of overdispersion of the NB2 form. To test overdispersion of the NB1 form,
replace (3.40) with
(yi − μ̂i )2 − yi
= α + ui .
μ̂i

(3.41)

3.4 Overdispersion Tests

91

These auxiliary regression tests coincide with the score or LM test for Poisson
against negative binomial. They additionally test for underdispersion, can be
given a more general motivation based on using only the specified mean and
variance (see Chapter 5), and can be made robust to non-Poisson third and
fourth moments of y under the null by using robust sandwich standard errors
for the test of α = 0.
Beyond rejection or nonrejection of the null hypothesis of equidispersion,
interest may lie in interpreting the magnitude of departures from equidispersion.
Estimates of α for the NB1 variance function (1 + α)μi are easily interpreted,
with underdispersion when α < 0, modest overdispersion when, say, 0 < α <
1, and considerable overdispersion if, say, α > 1. For the NB2 variance function
μi + αμ2i underdispersion also occurs if α < 0. The NB2 variance function
can be inappropriate for underdispersed data, because the estimated variance is
negative for observations with α < −1/μi . For interpretation of the magnitude
of overdispersion, it is helpful to rewrite the NB2 variance as (1 + αμi ) μi .
Then values of considerable overdispersion arise when, say, αμi > 1, because
then the multiplier 1 + αμi > 2. Thus a value of α equal to 0.5 would indicate
modest overdispersion if the dependent variable took mostly values of 0, 1, and
2, but great overdispersion if counts of 10 or more were often observed.
Most often count data are overdispersed rather than underdispersed, and
tests for departures from equidispersion are usually called overdispersion tests.
Note that the negative binomial model can only accommodate overdispersion.
3.4.2

Example: Doctor Visits (Continued)

From Table 3.1 the data before inclusion of regressors are overdispersed, with a
variance-mean ratio of 0.637/0.302 = 2.11. The only question is whether this
overdispersion disappears on inclusion of regressors.
We first consider tests of Poisson against NB2 at a significance level of
1%. Given the results in Tables 3.3 and 3.4, the LR test statistic is 2(3355.5 −
3198.7) = 313.6, which exceeds the 1% critical value of χ 2.98 (1) = 5.41. The
Wald test statistic from Table 3.4 is 1.077/0.117 = 9.21, which exceeds the
1% critical value of z.99 = 2.33. Finally, the LM test statistic computed using
the auxiliary regression (3.40) is 7.50 and exceeds the 1% critical value of
z.99 = 2.33. Therefore all three tests strongly reject the null hypothesis of
Poisson, indicating the presence of overdispersion. Note that these tests are
asymptotically
equivalent, yet there is quite a difference in their realized values
√
of 313.6 = 17.69, 9.21, and 7.50.
Similar test statistics for Poisson against NB1 are TLR = 2 × (3355.5 −
3226.8) = 257.4, TW = 0.455/0.057 = 7.98, and TLM = 6.54 on running the
auxiliary regression (3.41). These results again strongly reject equidispersion.
Clearly some control is necessary for overdispersion. Possibilities include
the Poisson QMLE with RS standard errors, see Table 3.3, which corrects
the standard errors for overdispersion, and the various estimators presented in
Table 3.4, most notably NB2 MLE.

92

Basic Count Regression

3.5 USE OF REGRESSION RESULTS
The techniques presented to date allow estimation of count data models and
performance of tests of statistical significance of regression coefficients. We
have focused on tests on individual coefficients. Tests of joint hypotheses such
as overall significance can be performed using the Wald, LM, and LR tests
presented in Chapter 2.6. Confidence intervals for functions of parameters can
be formed using the delta method in Chapter 2.6.2.
We now turn to interpretation of regression coefficients and prediction of
the dependent variable.
3.5.1

Marginal Effects and Interpretation of Coefficients

An important issue is interpretation of regression coefficients. For example,
what does β̂ j = 0.2 mean? This is straightforward in the linear regression
model E[y|x] = x β. Then ∂E[y|x]/∂xj = β j , so β̂ j = 0.2 means that a oneunit change in the j th regressor increases the conditional mean by 0.2 units.
We consider the exponential conditional mean
E[y|x] = exp(x β),

(3.42)

where for exposition the subscript i is dropped. We consider the effect of
changes in xj , the j th regressor.
Marginal Effects
Differentiating with respect to a continuous variate xj yields the marginal effect
(ME)
MEj =

∂E[y|x]
= β j exp(x β).
∂xj

(3.43)

For example, if β̂ j = 0.2 and exp(xi β̂) = 2.5, then a one-unit change in the j th
regressor increases the expectation of y by 0.5 units. This is interpreted as the
marginal effect of a unit change in xj . Calculated values differ across individuals, however, due to different values of x. This variation makes interpretation
more difficult.
One procedure is to estimate the typical value by first aggregating over all
individuals and then calculating the average response. The average marginal
effect (AME) is defined as
1  ∂E[yi |xi ]
1
=
β exp(xi β).
n i=1 ∂xij
n i=1 j
n

AMEj =

n

(3.44)

In the special case that one uses the Poisson MLE or QMLE, and the regression
includes an intercept term, this expression simplifies to
AMEj = β j y

(3.45)

3.5 Use of Regression Results

93



because the first-order conditions (3.4) imply i exp(xi β) = i yi . The preceding gives the sample-average ME. For a population-average ME one uses
population weights in computing (3.44).
A second procedure is to calculate the response for the individual with
average characteristics. The marginal effect at the mean (MEM) is defined as

∂E[y|x] 
= β j exp(x β).
(3.46)
MEMj =
∂xj x
Because exp(·) is a convex function, by Jensen’s inequality the average of
exp(·) evaluated at several points exceeds exp(·) evaluated at the average of
the same points. So (3.46) gives responses smaller than (3.44). Due to the need
for less calculation, it is common in nonlinear regression to report responses
at the sample mean of regressors. It is conceptually better, however, to report
the average response (3.44) over all individuals. And it is actually easier to do
so in the special case of Poisson with intercept included, because (3.45) can be
used.
A third procedure is to calculate (3.43) for select values of x of particular
interest. The marginal effect at a representative value (MER) is defined as

∂E[y|x] 
= β j exp(x∗ β).
(3.47)
MERj =
∂xj x∗
This is perhaps the best method. The values of x∗ of particular interest vary
from application to application.
These marginal effects are interpreted as the effect of a one-unit change in
xj , which is not free of the units used to measure xj . One method is to scale
by the sample mean of xj , so use β̂ j x j , which given (3.43) is a measure of
the elasticity of E[y|x] with respect to xj . An alternative method is to consider
semi-standardized coefficients that give the effect of a one-standard-deviation
change in xj , so use β̂ j sj , where sj is the standard deviation of xj . Such
adjustments, of course, need to be made even for the linear regression model.
Treatment Effects
An additional complication arises from the presence of binary regressors. Often
these regressors are a treatment variable, a regressor equal to 1 if the individual
is treated and 0 if not. An example is having health insurance versus not having
it – the LEVYPLUS regressor in the doctor visits example. Of interest is the
treatment effect, the marginal effect on the conditional mean as the indicator
variable, say d, changes from 0 to 1.
Let x = [d z], where z denotes all regressors other than the binary regressor
d. Then the treatment effect is defined by
TE = E[y|d = 1, z] − E[y|d = 0, z]
= exp(β d + z β z ) − exp(z β z ).

(3.48)

94

Basic Count Regression

This method of computation is sometimes called the finite-difference method
and for a nonlinear conditional mean leads to somewhat different estimate than
the earlier calculus method.
The treatment effect varies with z. The average treatment effect (ATE) is
obtained by averaging TE across the individuals in the sample. The average
treatment effect on the treated (ATET) is obtained by instead averaging TE over
those individuals who actually received the treatment (i.e., for the subsample
for which d = 1).
Direct Interpretation of Coefficients
It is useful to note that direct interpretation of the coefficients is possible without
such additional computations.
r For exponential conditional mean models, the coefficient β equals
j
the proportionate change in the conditional mean if the j th regressor changes by one unit. This follows from rewriting (3.43) as
∂E[y|x]/∂xj = β j E[y|x], using (3.42), and hence
βj =

∂E[y|x] 1
.
∂xj E[y|x]

(3.49)

This is a semi-elasticity, which can alternatively be obtained by rewriting (3.42) as lnE[y|x] = x β and differentiating with respect to xj .
r The sign of the response ∂E[y|x]/∂x is given by the sign of β ,
j
j
because the response is β j times the scalar exp(x β), which is always
positive.
r If one regression coefficient is twice as large as another, then the effect
of a one-unit change of the associated regressor is double that of the
other. This result follows from
β j exp(x β)
βj
∂E[y|x]/∂xj
=
.
=

∂E[y|x]/∂xk
β k exp(x β)
βk

(3.50)

A single-index model is one for which E[y|x] = g(x β), for monotonic
function g(·). The last two properties hold more generally for any single-index
model.
For a binary regressor the treatment effect given in (3.48) can instead be
interpreted in relative terms as
exp(β d + z β z )
E[y|d = 1, z]
=
= exp(β d ).
E[y|d = 0, z]
exp(z β z )
So the conditional mean is exp(β d ) times larger if the indicator variable is
unity rather than zero. If we instead used calculus methods, then (3.49) predicts
a proportionate change of β d or, equivalently, that the conditional mean is
(1 + β d ) times larger. This is a good approximation for small β d , say β d < 0.1,
because then exp(β d )  1 + β d . More generally for a discrete one-unit change

3.5 Use of Regression Results

95

in any regressor xj the exponential mean is exp(β j ) times larger, so some
programs present exponentiated coefficients.
Logarithmic and Interactive Regressors
Sometimes regressors enter logarithmically in (3.42). For example, we may
have
E[y|x] = exp(β 1 ln(x1 ) + x2 β 2 )
= x1 1 exp(x2 β 2 ).
β

Then β 1 is an elasticity, giving the percentage change in E[y|x] for a 1% change
in x1 . This formulation is particularly appropriate if x1 is a measure of exposure,
such as number of miles driven if modeling the number of automobile accidents
or population size if modeling the incidence of a disease. Then we expect β 1
to be close to unity.
The conditional mean function may include interaction terms. For example,
suppose
E[y|x] = exp(β 1 + β 2 x2 + β 2 x3 + β 4 x2 x3 ).
Then the proportionate change in the conditional mean due to a one-unit change
in x3 equals (β 2 + β 4 x2 ), because
∂E[y|x] 1
= (β 2 + β 4 x2 ).
∂x3 E[y|x]
Thus even the semi-elasticity measuring the effect of changes in x3 varies
according to the value of regressors – here x2 .
3.5.2

Example: Doctor Visits (Continued)

Various measures of the magnitude of the response of the number of doctor
visits to changes in regressors are given in Table 3.6. These measures are based
on the Poisson QML estimates given earlier in Table 3.3.
The coefficient estimates given in the column labeled QMLE using (3.49)
can be interpreted as giving the proportionate change in the number of doctor
visits due to a one-unit change in the regressors (though it is more precise
to use eβ j − 1 rather than β j ). If we consider ACTDAYS, the most highly
statistically significant regressor, an increase of one day of reduced activity in
the preceding two weeks leads to a .127 proportionate change or 12.7% change
in the expected number of doctor visits. More complicated is the effect of
age, which appears through both AGE and AGESQ. For a 40-year-old person,
AGE = 0.4 and AGESQ = 0.16 and an increase of one year or 0.01 units leads to
a 0.01 × (1.056 − 2 × 0.849 × 0.40) = 0.0038 proportionate change or .38%
change in the expected number of doctor visits.
The columns AME and MEM give two different measures of the change
in the number of doctor visits due to a one-unit change in regressors. First,

96

Basic Count Regression

Table 3.6. Doctor visits: Poisson QMLE mean effects and scaled coefficients
Summary Statistics
Variable
ONE
SEX
AGE
AGESQ
INCOME
LEVYPLUS
FREEPOOR
FREEREPA
ILLNESS
ACTDAYS
HSCORE
CHCOND1
CHCOND2

Coefficient
QMLE
−2.224
1.157
1.056
−0.849
−0.205
0.123
−0.440
0.080
0.187
0.127
0.030
0.114
0.141

Mean effect
AME
MEM

OLS

Scaled Coeffs
Elast
SSC

Mean

0.047
0.035
0.034
0.082
0.078 0.521
0.319
0.241
0.203
0.430
0.216 0.406
−0.256 −0.193 −0.062 −0.176 −0.157 0.207
−0.062 −0.047 −0.057 −0.120 −0.076 0.583
0.037
0.028
0.035
0.055
0.061 0.443
−0.133 −0.100 −0.103 −0.019 −0.089 0.043
0.024
0.018
0.033
0.017
0.033 0.210
0.056
0.043
0.060
0.268
0.259 1.432
0.038
0.029
0.103
0.109
0.366 0.862
0.009
0.007
0.017
0.037
0.064 1.218
0.034
0.026
0.004
0.046
0.056 0.403
0.043
0.032
0.042
0.016
0.045 0.117

Standard
deviation
0.500
0.205
0.186
0.369
0.497
0.202
0.408
1.384
2.888
2.124
0.491
0.321

Note: AME, average over sample of effect of y of a one-unit change in x; MEM, effect on y of a one-unit change
in x evaluated at average regressors; OLS, OLS coefficients; Elast, coefficients scaled by sample mean of x;
SSC, coefficients scaled by standard deviation of x.

the column AME gives the average of the individual responses, using (3.45).
Second, the column MEM gives the response for the individual with regressors
equal to the sample mean values, computed using (3.46). The preferred AME
estimates are about 30% larger than those of the “representative” individual, a
consequence of the convexity of the exponential mean function. An increase of
one day of reduced activity in the preceding two weeks, for example, leads on
average to an increase of 0.038 doctor visits. The t statistics for the estimates of
AME and MEM, not presented, are essentially the same as those for β̂ j , which
is to be expected because they are just multiples of β j . When the marginal
effect for age is correctly computed allowing for the quadratic in age, the AME
is .076 and the MEM is 0.086. And the AME and MEM are slightly larger for
binary regressors when we calculate using the treatment effect in (3.48) rather
than the ME in (3.43).
The column OLS gives coefficient estimates from OLS of y on x. Like the
preceding two columns, it gives estimates of the effects of a one-unit change
of xj on E[y|x], the difference being in different functional forms for the
conditional mean. The three columns are generally similar, with OLS closer to
the AME as is usually the case.
All these measures consider the effect of a one-unit change in xj , but it
is not always clear whether such a change is a large or small change. The
Elast column gives β̂ j x j , where x j is given in the second-to-last column of
the table. Given the exponential mean function, this measures the elasticity of
E[y|x] with respect to changes in regressors. The SSC column gives β̂ j sj ,
which instead scales by the standard deviation of the regressors, given in the
last column of the table. Both measures highlight the importance of the health
status measures ILLNESS, ACTDAYS, and HSCORE much more clearly than do

3.5 Use of Regression Results

97

the raw coefficient estimates and the estimates of ∂E[y|x]/∂xj . For example,
the estimates imply that a 1% increase in illness days leads to a .268% increase
in expected doctor visits, and a 1-standard-deviation increase in activity days
leads to a 0.259% increase in expected doctor visits.
3.5.3

Prediction

We begin by considering, for an individual observation with x = xp , prediction
of the conditional mean μp = E[y|x = xp ].
For the exponential conditional mean function, the mean prediction is
μ̂p = exp(xp β̂).

(3.51)

A 95% confidence interval, which allows for the imprecision in the estimate
β̂, can be obtained using the delta method given in Chapter 2.6.2. Consider
estimation procedures that additionally estimate a scalar nuisance parameter, α,
to accommodate overdispersion. Because ∂μp /∂β = μp xp and ∂μp /∂α = 0,
we obtain
!
(3.52)
μp ∈ μ̂p ± z.025 μ̂2p xp V[β̂]xp ,
a

for estimator β̂ ∼ N[β,V[β̂]]. As expected, greater precision in the estimation
of β leads to a narrower confidence interval.
One may also wish to predict the actual value of y, rather than its predicted
mean. This is considerably more difficult, because the randomness of y needs
to be accounted for, in addition to the randomness in the estimator β̂. For low
counts in particular, individual values are poorly predicted due to the intrinsic
randomness of y.
For an individual observation with x = xp , and using the exponential conditional mean function, the individual prediction is
ŷp = exp(xp β̂).

(3.53)

Note that while ŷp equals μ̂p , it is being used as an estimate of yp rather than μp .
If we consider variance functions of the form (3.12), the estimated variance of yp
is ω(μ̂p , α̂). Adding this to the earlier variance due to imprecision in the estimate
β̂, the variance of ŷp is consistently estimated by ω(μ̂p , α̂) + μ̂2p xp V[β̂]xp . A
two-standard error interval is
!
(3.54)
yp ∈ ŷp ± 2 ω(μ̂p , α̂) + μ̂2p xp V[β̂]xp .
This can be used as a guide, but is not formally a 95% confidence interval
because yp is not normally distributed even in large samples.
The width of this interval is increasing in μ̂p , because ω(μ̂p , α̂) is increasing
in μ̂p . The interval is quite wide, even for low counts. For example, consider
the Poisson distribution, so ω(μ, α) = μ, and assume a large sample size,
so that β is6very precisely estimated and V[β̂]  0. Then (3.54) becomes
yp ∈ ŷp ± 2 ŷp . Even for ŷp = 4 this yields (0, 8). If y is Poisson and β is

98

Basic Count Regression

known it is better to directly use this knowledge, rather than the approximation
(3.54). Then because Pr 1 ≤ yp ≤ 8 = 0.0397 when yp is Poisson distributed
with μp = 4, a 96.03% confidence interval for yp is [1, 8].
Interest can also lie in predicting the probabilities of particular values of
y occurring, for an individual observation with x = xp . Let pk denote the
probability that yp = k if x = xp . For the Poisson, for example, this is estimated
by p̂k = exp(−μ̂p )μ̂kp /k!, where μ̂p is given in (3.51). The delta method can
be used to obtain a confidence interval for pk . Most parametric models include
an overdispersion parameter α. Because ∂pk /∂α = 0 the delta method does not
yield an interval as simple as (3.52).
A fourth quantity that might be predicted is the change in the conditional
mean if the j th regressor changes by one unit. From (3.43) the predicted change
is β̂ j μ̂p . Again the delta method can be used to form a confidence interval.
As the sample size gets very large, the variance of β̂ goes to zero, and
the confidence intervals for predictions of the conditional mean, individual
probabilities, and changes in predicted probabilities collapse to a point. The
confidence intervals for predictions of individual values of y, however, can
remain wide as demonstrated earlier. Thus, within-sample individual predictions of y differ considerably from the actual values of y, especially for small
counts. If interest lies in assessing the usefulness of model predictions, it can
be better to consider predictions at a more aggregated level. This is considered
in Chapter 5.
The preceding methods require the use of a computer program that saves the
variance matrix of the regression parameters and permits matrix multiplication.
It is generally no more difficult to use the bootstrap instead.
More problematic in practice is deciding what values of xp to use in prediction. If, for example, there are just two regressors, which are both binary
regressors, one would simply predict for each of the four distinct values of x.
But in practice there are many different distinct values of x, and it may not be
obvious which few values to focus on. Such considerations also arise in the
linear regression model.
3.6 ORDERED AND OTHER DISCRETE-OUTCOME
MODELS
Count data can alternatively be modeled using discrete outcome methods surveyed in Cameron and Trivedi (2005). This is particularly natural if most
observed counts take values zero and one, with few counts in excess of one.
Then one might simply model whether the count is zero or nonzero, using a
binary outcome model such as logit or probit.
Extending this to just a few low observed counts, say 0, 1, and 2 or more,
the natural discrete outcome model is an ordered multinomial model, usually
ordered probit or ordered logit, that accounts for the natural ordering of the
discrete outcomes. These models treat the data as generated by a continuous
unobserved latent variable, which on crossing a threshold leads to an increase of

3.6 Ordered and Other Discrete-Outcome Models

99

one in the observed outcome. This is a representation of the dgp quite different
from the Poisson process that leads to the Poisson density for counts. In theory,
one should use an ordered model for data for which the underlying dgp is felt
to be a continuous latent variable.
Such alternatives to the count model may provide a better fit to the data
in cases where the support of the distribution is limited to a few values (e.g.,
the fertility example in Chapter 1). For time series of counts it can be difficult to formulate reasonable dynamic models, and one possibility is a dynamic
ordered multinomial model; see Jung, Kukuk, and Liesenfeld (2006). In addition, a dynamic ordered multinomial model can be applied to an integer-valued
dependent variable that may take negative values; see the end of section 3.6.2.
3.6.1

Binary Outcome Models

Let yi be the count variable of interest. Define the indicator variable
di = 1
=0

if yi > 0
if yi = 0.

(3.55)

This equals the count variable except that yi values of 2 or more are recoded to
1. Other partitions are possible, such as yi > k and yi ≤ k.
The general form of such a binary outcome model is
Pr[di = 1] = F (xi β)
Pr[di = 0] = 1 − F (xi β),

(3.56)

where 0 < F (·) < 1. It is customary to let the probability be a transformation
of a linear combination of the regressors rather than to use the more general
functional form F (xi , β). By construction the probabilities sum to one. A parsimonious way to write the density given by (3.56) is F (xi β)di (1 − F (xi β))1−di ,
which leads to the log-likelihood function
ln L =

n


di ln F (xi β) + (1 − di ) ln(1 − F (xi β)).

(3.57)

i=1

Different binary outcome models correspond to different choices of the function
F (·). Standard choices include the logit model, which corresponds to F (z) =
exp(z)/(1 + exp(z)), and the probit model, which corresponds to F (z) = (z),
where (·) is the standard normal cdf.
There is a loss of efficiency due to combining all counts in excess of zero
into a single category. Suppose yi are Poisson distributed with mean μi . Then
Pr[di = 1] = Pr[yi > 0] = 1 − exp(−μi ), so for μi = exp(xi β)
F (xi β) = 1 − exp(− exp(xi β)).

(3.58)

The binary Poisson MLE β̂ BP maximizes (3.57) with this specification of
F (·). The model is identical to the complementary log-log model, used as an
alternative to the logit and probit models when the outcome is mostly 0 or

100

Basic Count Regression

mostly 1. It can be shown that
 n
−1


ci μi xi xi
,
V[β̂ BP ] =
i=1

n

 −1
where ci = μi exp(−μi )/(1 − exp(−μi )). V[β̂ BP ] exceeds
,
i=1 μi xi xi
the variance matrix of the Poisson MLE from (3.6), because ci < 1 for μi > 0.
As expected, the relevant efficiency loss is increasing in the Poisson mean. For
example, for μi = 0.5 and 1, respectively, ci = 0.77
√ and 0.58. In the Poisson
iid case with μ = 0.5, the standard error of β̂ BP is 1/0.77 = 1.14 times that
of the Poisson MLE, even though less than 10% of the counts will exceed unity.
3.6.2

Ordered Multinomial Models

The Poisson and negative binomial models treat discrete data as being the
result of an underlying point process. One could instead model the number
of doctor visits, for example, as being due to a continuous process that on
crossing a threshold leads to a visit to a doctor. Crossing further thresholds
leads to additional doctor visits. Before specializing to threshold models such
as ordered probit, we first present general results for multinomial models.
Suppose the count variable yi takes values 0, 1, 2, . . . , m. Define the m + 1
indicator variables
dij = 1
=0

yi = j
yi = j.

(3.59)

Also define the corresponding probabilities
Pr dij = 1 = pij ,

j = 0, . . . , m,

(3.60)

where pij may depend on regressors and parameters. Then the density function
for the i th observation can be written as
f (yi ) = f (di0 , di1 , . . . , dim ) =

m


d

pijij ,

(3.61)

j =0

and the log-likelihood function is
ln L =

n 
m


dij ln pij .

(3.62)

i=1 j =0

Different multinomial models arise from different specifications of the probabilities pij . The most
is the multinomial logit model, which specifies
 common

pij = exp(xi β j )/( m
k=0 xi β k ) in (3.62). This model is inappropriate for count
data for which the outcome – the number of occurrences of an event – is naturally ordered. One way to see this is to note that a property of multinomial
logit is that the relative probabilities of any two outcomes are independent of
the probabilities of other outcomes. For example, the probability of one doctor

3.6 Ordered and Other Discrete-Outcome Models

101

visit, conditional on the probability of zero or one visit, would not depend on
the probability of two visits. But one expects that this conditional probability
will be higher the higher the probability of two visits. It is better to use a
multinomial model that explicitly incorporates the ordering of the data.
The ordered probit model, presented for example in Maddala (1983), introduces a latent (unobserved) random variable
yi∗ = xi β + ε i ,

(3.63)

where εi is N[0, 1]. The observed discrete data variable yi is generated from
the unobserved yi∗ in the following way:
yi = j

if α j < yi∗ ≤ α j +1 ,

j = 0, . . . , m,

(3.64)

where α 0 = −∞ and α m+1 = ∞. It follows that
pij = Pr[α j < yi∗ ≤ α j +1 ]
= Pr[α j −

xi β

< εi ≤ α j +1 −

(3.65)
xi β]

= (α j +1 − xi β) − (α j − xi β),
where (·) is the standard normal cdf, j = 0, 1, 2, . . . , m, and α m+1 = ∞. The
log-likelihood function (3.62) with probabilities (3.65) is
ln L =

n 
m


dij ln (α j +1 − xi β) − (α j − xi β) .

(3.66)

i=1 j =0

Estimation of β and α 1 , . . . , α m by maximum likelihood is straightforward.
Identification requires a normalization, such as 0, for one of α 1 , . . . , α m or for
the intercept term in β.
If there are many counts and/or few observations for a given count, then
some aggregation of count data may be necessary. For example, if there are
few observations larger than 3, one might have categories of 0, 1, 2, and 3 or
more. As an alternative to the ordered probit, one can use the ordered logit
model, in which case (·) is replaced by the logistic cdf L(z) = ez /(1 + ez ).
More generally if εi in (3.63) has a nonnormal distribution the log-likelihood
function is (3.66) with (·) replaced by the cdf of εi .
The ordered discrete outcome model has the additional advantage of being
applicable to count data that are negative. Such data may arise if instead of
directly modeling a count variable, one differences and models the change
in the count. For example, some U.S. stock prices are a count, because they
are measured in units of a tick, or one-eighth of a dollar. Hausman, Lo, and
MacKinlay (1992) model price changes in consecutive time-stamped trades of
a given stock using the ordered probit model, generalized to allow εi to be
N[0, σ 2i ], where the variance σ 2i is itself modeled by a regression equation.

102

Basic Count Regression

3.6.3

Binomial Model

In some cases the count has an upper value. For example, we might model the
number of children in a family who attend college. The natural model for these
data is the binomial.
We suppose that yi is the number of successes in Ni trials, each with
probability of success pi . Then yi is binomial distributed with density
f (yi |pi ) =

Ni !
y
p i (1 − pi )Ni −yi ,
pi !(1 − pi )! i

(3.67)

where pi = F (xi β) is most often modeled as a logit or probit model.
In this model the conditional mean
E[yi |xi ] = Ni F (xi β).

(3.68)

The binomial with known number of trials is a member of the linear exponential
family, so consistent estimation of β requires only correct specification of the
conditional mean, and inference is best based on a robust estimate of the
variance matrix. The model is included in statistical software for generalized
linear models.
3.7 OTHER MODELS
In this section we consider whether least squares methods might be usefully
applied to count data y. Three variations of least squares are considered. The
first is linear regression of y on x, making no allowance for the count nature
of the data aside from using heteroskedasticity robust standard errors. The
second is linear regression of a nonlinear transformation of y on x, for which
the transformation leads to a dependent variable that is close to homoskedastic
and symmetric. Third, we consider nonlinear least squares regression with the
conditional mean of y specified to be exp(x β). The section finishes with a
discussion of estimation using duration data, rather than count data, if the data
are generated by a Poisson process.
3.7.1

OLS without Transformation

The OLS estimator is clearly inappropriate because it specifies a conditional
mean function x γ that may take negative values and a variance function that is
homoskedastic. If the conditional mean function is, in fact, exp(x β), the OLS
estimator is inconsistent for β, and the computed OLS output gives the wrong
asymptotic variance matrix.
Nonetheless, OLS estimates in practice give results qualitatively similar
to those for Poisson and other estimators using the exponential mean. The
ratio of OLS slope coefficients is often similar to the ratio of Poisson slope
coefficients, with the OLS slope coefficients approximately y times the Poisson slope coefficients, and the most highly statistically significant regressors

3.7 Other Models

103

from OLS regression, using usual OLS output t statistics, are in practice the
most highly significant using Poisson regression. This is similar to comparing
different models for binary data such as logit, probit, and OLS. In all cases
the conditional mean is restricted to be of form g(x β), which is a monotonic
transformation of a linear combination of the regressors. The only difference
across models is the choice of function g, which leads to a different scaling of
the parameters β.
A first-order Taylor series expansion of the exponential mean exp(x β)
around the sample mean y – that is, around x β = ln y – yields exp(x β) =
y + y(x β − ln y). For models with intercept, this can be rewritten as exp(β 1 +
x2 β 2 ) = γ 1 + x2 γ 2 , where γ 1 = y + β 1 y − ln y and γ 2 = β 2 y. So linear
mean slope coefficients are approximately y times the exponential slope
coefficients. This approximation will be more reasonable the less dispersed
the predicted values exp(xi β̂) are about y.
The OLS estimator can be quite useful for preliminary data analysis, such
as determining key variables, in simple count models. Dealing with more complicated count models for which no off-the-shelf software is readily available
would be easier if one could first ignore the count aspect of the data and do the
corresponding adjustment to OLS. For example, if the complication is endogeneity, then do linear two-stage least squares as a potential guide to the impact
of endogeneity. But experience is sufficiently limited that one cannot advocate
this approach.
3.7.2

OLS with Log Transformation

For skewed continuous data such as that on individual income or on housing
prices, a standard transformation is the log transformation. For example, if y is
log-normal distributed then ln y is by definition exactly normally distributed,
so the log transformation induces constant variance and eliminates skewness.
The log transformation may also be used for count data that are often
skewed. However, there is usually no benefit to doing so. First, the assumption that E[ln y|x] = x β does not imply that E[y|x] = exp(x β), a problem
called retransformation bias, and interest usually lies in marginal effects and
predictions for E[y|x] rather than E[ln y|x]. Second, if some counts are 0, then
ln 0 is not defined. A standard solution is to add a constant term, such as 0.5,
and to model ln(y + 0.5) by OLS. This model has been criticized by King
(1989b) as performing poorly numerically, and marginal effects with respect to
E[ln(y + 0.5)|x] are not of interest.
A common application of the log transformation is to a dependent variable
that is a rate (y/z), such as state-level data on murders (y) per 100,000 people
(z). One approach is OLS regression of ln(y/z) on x. If data are available for
both y and z, rather than just on the rate y/z, then it is better to explicitly model y
as a count. Then E[y|x, z] = z × exp(x β) = exp(ln z + x β), and we perform
count regression of y on ln z and x with the coefficient of ln z restricted to
unity, a restriction that count regression commands often permit. Furthermore,

104

Basic Count Regression

this restriction can be easily tested. The regressor z is a measure of exposure,
discussed in section 3.5.1.
Going the other way, for a right-skewed continuous nonnegative dependent
variable, there are reasons for using the Poisson QMLE rather than the more
customary OLS in a log-linear model. A leading example is expenditure data
with some zero observations, in which case there is a problem for the loglinear model because ln 0 is not defined. Modeling ln(y + 0.5) has already
been criticized. A two-part model that separately models whether y = 0 and
then models ln y when y ≥ 0 is another possible approach, but marginal effects
are difficult to obtain. Poisson regression for the model ln E[y|x] = x β has no
problem with y = 0, does not require that y be a count (see section 3.2.2), and
easily yields marginal effects (see section 3.5.1). How well this model works
will vary with the application. Santos Silva and Tenreyro (2006) advocate the
use of Poisson regression rather than log-linear modeling with application to
the gravity model for international trade flows.
3.7.3

OLS with Other Transformations

An alternative transformation is the square root transformation. Following
McCullagh and Nelder (1989, p. 236), let y = μ(1 + ε). Then a fourth-order
Taylor series expansion around ε = 0 yields

1
1
1
5 4
ε .
y 1/2  μ1/2 1 + ε − ε2 + ε 3 −
2
8
16
128
For the Poisson, ε = (y − μ)/μ has first four moments 0, 1/μ, 1/μ2 , and
√
√
√
(3/μ2 + 1/μ3 ). It follows that E[ y]  μ(1 − 1/8μ + O(1/μ2 )), V[ y] 
√
√
√
(1/4)(1 + 3/8μ + O(1/μ2 )), and E[( y− E[ y])3 ]  −(1/16 μ)(1 +
√
O(1/μ)). Thus if y is Poisson then y is close to homoskedastic and is close
to symmetric. The skewness index is the third central moment divided by vari√
ance raised to the power 1.5. Here it is approximately −(1/16 μ)/(1/4)1.5 =
√
−(1/2 μ). By comparison for the Poisson y is heteroskedastic with variance
√
μ and asymmetric with skewness index 1/ μ. The square-root transformation
works quite well for large μ.
√
√
One therefore models y by OLS, regressing yi on xi . The usual OLS
t statistics can be used for statistical inference. More problematic is the interpretation of coefficients. These give the impact of a one-unit change in xj on
√
√
E[ y] rather than E[y], and by Jensen’s inequality E[y] = (E[ y])2 . A similarly problem arises in prediction, although the method of Duan (1983) can be
√
used to predict E[yi ], given the estimated model for yi .
3.7.4

Nonlinear Least Squares

The nonlinear least squares (NLS
 ) estimator with exponential mean minimizes
the sum of squared residuals i (yi − exp(xi β))2 . The estimator β̂ NLS is the

3.7 Other Models

105

solution to the first-order conditions
n

xi (yi − exp(xi β)) exp(xi β) = 0.

(3.69)

i=1

This estimator is consistent if the conditional mean of yi is exp(xi β). It is
inefficient, however, because the errors are certainly not homoskedastic, and
the usual reported NLS standard errors are inconsistent. β̂ NLS is asymptotically
normal with variance
 n
−1  n
 n
−1



μ2i xi xi
ωi μ2i xi xi
μ2i xi xi
, (3.70)
V[β̂ NLS ] =
i=1

i=1

i=1

where ωi = V[yi |xi ]. The robust sandwich estimate of V[β̂ NLS ] is (3.70), with
μi and ωi replaced by μ̂i and (yi − μ̂i )2 .
The NLS estimator can, therefore, be used, but more efficient estimates can
be obtained using the estimators given in sections 3.2 and 3.3.
3.7.5

Example: Doctor Visits (Continued)

Coefficient estimates of binary Poisson, ordered probit, OLS, OLS of trans√
formations of y (both ln(y + 0.1) and y), Poisson QMLE, and NLS with
exponential mean are presented in Table 3.7. The associated t statistics reported
are based on RS standard errors, except for binary Poisson and ordered probit.
The skewness and kurtosis measures given are for model residuals zi − ẑi ,
√
where zi is the dependent variable, for example, zi = yi , and are estimates
of, respectively, the third central moment divided by s 3 and the fourth central
moment divided by s 4 , where s 2 is the estimated variance. For the standard
normal distribution the kurtosis measure is 3.
We begin with estimation of a binary outcome model for the recoded variable
d = 0 if y = 0 and d = 1 if y ≥ 1. To allow direct comparison with Poisson
estimates, we estimate the nonstandard binary Poisson model introduced in
section 3.6.1. Compared with Poisson estimates in the Poiss column, the BP
results for health status measures are similar, although for the statistically
insignificant socioeconomic variables AGE, AGESQ, and INCOME there are
sign changes. Similar sign changes for AGE and AGESQ occur in Table 3.4 and
are discussed there. The log-likelihood for BP exceeds that for Poisson, but
this comparison is meaningless due to the different dependent variable. Logit
and probit, not reported, lead to similar log-likelihood and qualitatively similar
estimates to those from binary Poisson, so differences between binary Poisson
and Poisson can be attributed to aggregating all positive counts into one value.
The ordered probit model normalizes the error variance to 1. To enable
comparison with OLS estimates, we multiply these by s = 0.714, the estimated
standard deviation of the residual from OLS regression. Also, because only one
observation took the value 9, it was combined into a category of 8 or more. The
intercept was normalized to 0, and the rescaled threshold parameter estimates

106

Basic Count Regression

Table 3.7. Doctor visits: Alternative estimates and t ratios
Estimators and t statistics
Discrete outcome
Variable

BP

−2.312
(9.76)
SEX
0.206
(2.87)
AGE
−1.001
(0.78)
AGESQ
1.474
(1.05)
INCOME
0.002
(0.02)
LEVYPLUS
0.222
(2.55)
FREEPOOR −0.572
(2.46)
FREEREPA
0.346
(2.82)
ILLNESS
0.207
(8.90)
ACTDAYS
0.099
(12.04)
HSCORE
0.044
(2.87)
CHCOND1
0.120
(1.50)
CHCOND2
0.227
(2.08)
−ln L
2303.8
Skewness
Kurtosis
ONE

OrdProb
−
0.094
(2.97)
−0.381
(0.65)
0.612
(0.95)
−0.044
(0.88)
0.098
(2.62)
−0.247
(2.55)
0.127
(2.39)
0.107
(9.75)
0.072
(15.45)
0.023
(3.36)
0.044
(1.26)
0.097
(1.92)
3138.1

OLS of transformations
√
y
ln y
y
0.028
(0.38)
0.034
(1.47)
0.203
(0.45)
−0.062
(0.12)
−0.057
(1.64)
0.035
(1.61)
−0.103
(2.17)
0.033
(0.77)
0.060
(6.03)
0.103
(10.59)
0.017
(2.37)
0.004
(0.20)
0.042
(0.90)

−2.115
(21.43)
0.081
(2.73)
−0.566
(0.97)
0.877
(1.31)
−0.019
(0.43)
0.080
(2.58)
−0.182
(3.17)
0.139
(2.45)
0.110
(8.52)
0.106
(13.56)
0.029
(3.30)
0.022
(0.70)
0.102
(1.80)

0.070
(1.54)
0.034
(2.47)
−0.161
(0.60)
0.292
(0.94)
−0.017
(0.80)
0.039
(2.40)
−0.081
(2.99)
0.054
(2.06)
0.048
(8.11)
0.054
(13.05)
0.013
(3.17)
0.009
(0.61)
0.043
(1.62)

3.6
26.4

1.2
4.0

1.4
5.5

Exponential mean
Poiss
−2.224
(8.74)
0.157
(1.98)
1.056
(0.77)
−0.849
(0.58)
−0.205
(1.59)
0.123
(1.29)
−0.440
(1.52)
0.080
(0.63)
0.187
(7.81)
0.127
(16.33)
0.030
(2.11)
0.114
(1.25)
0.141
(1.15)
3355.5
3.1
25.6

NLS
−2.234
(6.13)
−0.057
(0.42)
3.626
(1.82)
−3.676
(1.70)
−0.394
(2.02)
0.214
(1.47)
−0.232
(0.54)
−0.003
(0.02)
0.140
(3.63)
0.121
(14.19)
0.023
(1.03)
0.079
(0.55)
−0.055
(0.31)

Note: BP, MLE for binary√Poisson; OrdProb,
MLE for rescaled Ordered Probit; y, OLS for y;
√
ln y, OLS for ln(y + 0.1); y, OLS for y; Poiss, Poisson QMLE; NLS, NLS with exponential
mean. The t statistics are robust sandwich for all but BP and OrdProb. Skewness and kurtosis are
for model residuals.

are .98, 1.58, 2.07, 2.21, 2.38, 2.47, 2.67, and 2.98, with t statistics all in excess
of 9. Despite the rescaling there is still considerable difference from the OLS
estimates. It is meaningful to compare the ordered probit log-likelihood with
that of other count data models; the change of one observation from 9 to 8 or
more in the ordered probit should have little effect. The log-likelihood is higher
for this model than for NB2, because −3138.1> −3198.7, although six more
parameters are estimated.
The log transformation ln(y + 0.1) was chosen on grounds of smaller skewness and kurtosis than ln(y + 0.2) or ln(y + 0.4). The skewness and kurtosis

3.7 Other Models

107

√
are somewhat smaller for ln y than y. Both transformations appear quite successful in moving toward normality, especially compared with residuals from
OLS or Poisson regression with y as dependent variables. Much of this gain
appears even before the inclusion of regressors, because the inclusion of regressors reduces skewness and kurtosis by about 20% in this example. All models
give similar results regarding the statistical significance of regressors, although
interpretation of the magnitude of the effect of regressors is more difficult if
√
the dependent variable is ln(y + 0.1) or y.
The NLS estimates for exponential mean lead to similar conclusions as
Poisson for the health-status variables, but quite different conclusions for
socioeconomic variables, with considerably larger coefficients and t statistics
for AGE, AGESQ, and INCOME and a sign change for SEX.
3.7.6

Exponential Duration Model

For a Poisson point process the number of events in a given interval of time
is Poisson distributed. The duration of a spell, the time from one occurrence
to the next, is exponentially distributed. Here we consider modeling durations
rather than counts.
Suppose that for each individual in a sample of n individuals we observe the
duration of one complete spell, generated by a Poisson point process with rate
parameter γ i . Then ti has exponential density f (ti ) = γ i exp(−γ i ti ) with mean
E[ti ] = 1/γ i . For regression analysis it is customary to specify γ i = exp(xi β).
The exponential MLE, β̂ E , maximizes the log-likelihood function
ln L =

n


xi β − exp(xi β)ti .

(3.71)

i=1

The first-order conditions can be expressed as
n

(1 − exp(xi β)ti )xi = 0,

(3.72)

i=1

and application of the usual maximum likelihood theory yields
 n
−1


VML [β̂ E ] =
xi xi
.

(3.73)

i=1

If instead we modeled the number of events from a Poisson point process
with rate parameter γ i = exp(xi β) we obtain
 n
−1


γ i xi xi
.
VML [β̂ P ] =
i=1

The two variance matrices coincide if γ i = 1. Thus if we choose intervals
for each individual so that individuals on average experience one event such
as a doctor visit, the count data have the same information content, in terms of

108

Basic Count Regression

precision of estimation of β, as observing for each individual one completed
spell such as the time between successive visits to the doctor. More simply, one
count conveys the same information as the length of one complete spell.
3.8 ITERATIVELY REWEIGHTED LEAST SQUARES
Most of the models and estimators in this book require special statistical packages for nonlinear models. An exception is the Poisson QMLE, which can be
computed in the following way.
In general at the s th iteration, the Newton-Raphson method updates the
current estimate β̂ s by the formula β̂ s+1 = β̂ s − Ĥ−1
s ĝs , where g = ∂ lnL/∂β
and H = ∂ 2 lnL/∂β∂β  are evaluated at β̂ s . Here this becomes
 n
−1 n



β̂ s+1 = β̂ s +
μ̂is xi xi
xi (yi − μ̂is ),
i=1

i=1

where we consider the exponential mean function so μ̂is = exp(xi β̂ s ). This can
be rewritten as
 n
−1
6
6
( μ̂is xi )( μ̂is xi )
β̂ s+1 =
i=1



n

6
6 (yi − μ̂is ) 6

×
( μ̂is xi )
μ̂is
+ μ̂is xi β̂ s ,
μ̂is
i=1
which is the formula for the OLS estimator from the regression


6
6
(yi − μ̂is )
μ̂is
+ xi β̂ s = ( μ̂is xi ) β s+1 + ui ,
μ̂is

(3.74)

where ui is an error term. Thus the Poisson QMLE can be calculated by this
iterative OLS regression. Equivalently, it can be estimated
6 by WLS regression
of {((yi − μ̂is )/μ̂is ) + xi β̂ s } on xi , where the weights μ̂is change at each
iteration.
For the general conditional mean function μ̂i = μ(xi , β), the method of scoring, which replaces H by E[H ], yields a similar regression, with the dependent
−1/2
−1/2
variable μ̂is {(yi − μ̂is ) + ∂μi /∂β  |β̂ s β̂ s } and regressor μ̂is ∂μi /∂β  |β̂ s .
3.9 BIBLIOGRAPHIC NOTES
This chapter provides considerable detail on the early literature on basic count
regression. Over time the literature has settled on two basic estimators for
count data: the Poisson QMLE (with robust sandwich standard errors) and
the NB2 MLE. The latter estimator is only applicable to count data that are
overdispersed, even after inclusion of regressors, but this is often the case.

3.10 Exercises

109

An early application of the Poisson regression model is by Jorgenson (1961).
In the statistical literature much of the work on the Poisson uses the GLM
approach. The key reference is McCullagh and Nelder (1989), with Poisson
regression detailed in Chapter 6. In biostatistics a brief survey of clinical trials
and epidemiological studies is provided by Kianifard and Gallo (1995). An
early review of count models in marketing is Morrison and Schmittlein (1988).
In econometrics early influential papers were by Gourieroux et al. (1984a,
1984b). The first paper presented the general theory for LEFN models; the
second paper specialized analysis to count data. Cameron and Trivedi (1986)
presented both LEFN and negative binomial maximum likelihood approaches,
with a detailed application to the doctor visits data used in this chapter. The
paper by Hausman, Hall, and Griliches (1984) is also often cited. It considers
the more difficult topic of panel count data and is discussed in Chapter 9.
The books by Maddala (1983), Gourieroux and Monfort (1995), Cameron
and Trivedi (2005, 2011), Wooldridge (2010), and Greene (2011) provide brief
to chapter-length treatments of Poisson regression. Surveys by Winkelmann and
Zimmermann (1995), Cameron and Trivedi (1996), and Winkelmann (1995)
cover the material in Chapter 3 and also some of the material in Chapter 4.
The survey by Gurmu and Trivedi (1994) provides a condensed treatment of
many aspects of count data regression. Wooldridge (1997b) emphasizes robust
QML estimation. The survey by Trivedi and Munkin (2010) focuses on recent
developments. The book by Winkelmann (2008) provides detailed analysis
of count models for cross-section data and a briefer treatment of models for
time-series, multivariate, and longitudinal data.
3.10 EXERCISES

n
= 0,
3.1 The first-order conditions for the Poisson
QMLE are
i=1 gi (β)

where gi (β) = (yi − exp(xi β))xi . Find E ni=1 ∂gi (β)/∂β  and E[ ni=1
gi (β)gi (β) ] if yi has mean μi and variance ωi . Hence verify that the asymptotic
variance is (3.9), using the general results in Chapter 2.8.1.
3.2 Obtain the expression for the asymptotic variance of φ̂ NB1 defined in (3.18),
using the delta method given in Chapter 2.6.2.
3.3 The geometric model is the special case of NB2 if α = 1. Give the density
of the geometric model if μi = exp(xi β)/[1 − exp(xi β)], and obtain the firstorder conditions for the MLE of β. This functional form for the conditional
mean corresponds to the canonical link function.
3.4 Using a similar approach to that of Exercise 3.1, obtain the asymptotic
variance for the QGPMLE of the NB2 model defined as the solution to (3.37)
if in fact yi has variance ωi rather than (μi + αμ2i ). Hence, give the RS estimator
for the variance matrix.
3.5 For regression models with exponential conditional mean function, use
the delta method in Chapter 2.6.2 to obtain the formula for a 95% confidence

110

Basic Count Regression

interval for the change in the conditional mean if the j th regressor changes by
one unit.
3.6 For the ordered probit model, give the log-likelihood function if εi ∼
N[0, σ 2i ] rather than εi ∼ N[0, 1].

3.7 Consider the NLS estimator that minimizes i (yi − exp(xi β))2 . Show
that the first-order conditions for β are those shown in (3.69). Using a similar
approach to that of Exercise 3.1, show that the asymptotic variance of the NLS
estimator is (3.70).

CHAPTER 4

Generalized Count Regression

4.1 INTRODUCTION
The most commonly used models for count regression, Poisson and negative
binomial, were presented in Chapter 3. In this chapter we introduce richer
models for count regression using cross-section data. For some of these models
the conditional mean retains the exponential functional form. Then the Poisson QMLE and NB2 ML estimators remain consistent, although they may
be inefficient and may not be suitable for predicting probabilities, rather than
the conditional mean. For many of these models, however, the Poisson and
NB2 estimators are inconsistent. Then alternative methods are used, ones that
generally rely heavily on parametric assumptions.
One reason for the failure of the Poisson regression is that the Poisson process has unobserved heterogeneity that contributes additional randomness. This
leads to mixture models, the negative binomial being only one example. A second reason is the failure of the Poisson process assumption and its replacement
by a more general stochastic process.
Some common departures from the standard Poisson regression are as
follows.
1. Failure of the mean-equals-variance restriction: Frequently the conditional variance of data exceeds the conditional mean, which is usually
referred to as extra-Poisson variation or overdispersion relative to the
Poisson model. Overdispersion may result from neglected or unobserved heterogeneity that is inadequately captured by the covariates in
the conditional mean function. It is common to allow for random variation in the Poisson conditional mean by introducing a multiplicative
error term. This leads to families of mixed Poisson models.
2. Truncation and censoring: The observed counts may be left truncated (zero truncation is quite common) leading to small counts being
excluded, or right censored, by aggregating counts exceeding some
value.
3. The “excess zeros” or “zero inflation” problem: The observed data
may show a higher relative frequency of zeros or of some other integer
111

112

Generalized Count Regression

4.

5.

6.

7.

8.

than is consistent with the Poisson model. The higher relative frequency of zeros is a feature of all Poisson mixtures obtained by convolution.
Multimodality: Observed univariate count distributions are sometimes
bimodal or multimodal. If this is also a feature of the conditional
distribution of counts, perhaps because observations may be drawn
from different populations, then extensions of the Poisson, notably
finite mixture models, are desirable.
Correlated observations: Even in a cross-section setting, observations
may be correlated due to clustering or spatial correlation. In a time
series, correlation is even more likely.
Waiting times between event occurrences not exponential: Then the
process is not a Poisson process, and stochastic process theory leads
to count models other than the Poisson.
Trends: The mean rate of event occurrence, the intensity function, may
have a trend or some other deterministic form of time dependence that
violates the simple Poisson process assumption.
Simultaneity and sample selection: Some covariates may be jointly
determined with the dependent variable or the included observations
may be subject to a sample selection rule.

The first five considerations generally maintain the assumption of an underlying
Poisson process, while making concessions to the characteristics of observed
data. These considerations are dealt with in detail in this chapter, except for
the correlation in the case of time series. This chapter also deals with the sixth
departure, which is a failure of the Poisson process assumption. The remaining
two complications are presented in, respectively, Chapters 7 and 10.
Section 4.2 presents unobserved heterogeneity and mixture models in detail,
a Poisson-gamma mixture leading to the NB model being a leading example.
Sections 4.3 and 4.4 consider the case in which the range of observed counts
is restricted by either truncation or censoring. Sections 4.5 and 4.6 present
two classes of modified count models, hurdle models and zero-inflated models,
that give special treatment to zero counts. These models combine elements
of both mixing and truncation. Hierarchical models that allow for quite rich
modeling of unobserved heterogeneity are presented in section 4.7, whereas
finite mixture or latent class models are presented in section 4.8. Models with
cross-section dependence are presented in section 4.9. Count models based on
an underlying duration model of the time between occurrences of an event are
presented in section 4.10. In section 4.11, we present additional models for
counts that generally do not rely on mixing. A brief application is provided in
section 4.8, with more extensive applications provided in Chapter 6.
4.2 MIXTURE MODELS
Regression models partially control for heterogeneity, since specifying
μ = exp(x β) allows different individuals to have different Poisson means. In

4.2 Mixture Models

113

practice there is still unexplained heterogeneity, and many parametric models
for counts are obtained by additionally introducing unobserved heterogeneity
into the Poisson model.
Unobserved heterogeneity is usually introduced as a multiple of the Poisson
mean. Then y|μ, ν ∼ P[μν], and the random heterogeneity term ν > 0 is
integrated out to obtain the distribution of y given μ. Such models are called
doubly stochastic Poisson by Cox (1955) and a Cox process by Kingman
(1993), and they are the basis for the random effects Poisson for panel data
presented in Chapter 9.
Several leading models set E[ν] = 1, the multiplicative analog to the linear
model case of additive heterogeneity y = μ + u with E[u] = 0. When E[ν] =
1, the mean remains E[y] = μ while V[y] > μ so that the count data become
overdispersed. Different distributions for ν lead to different generalizations
of the Poisson, and we present several leading models including the negative
binomial, analyzed here in more detail than in Chapter 3. We also discuss
estimation when the integral has no closed-form solution.
The multiplicative heterogeneity model is a special case of a mixture model.
General results from the mixture literature, including conditions for identification, are also presented in this section. Finally, additive heterogeneity, less
appropriate for count data that are necessarily positive, is briefly discussed.
4.2.1

Unobserved Heterogeneity and Overdispersion

We consider mixing based on multiplicative heterogeneity that on average
(formally, in expectation) leaves the Poisson mean unchanged. Then there is
increased variability in the Poisson mean that in turn can be expected to increase
the variability of the count. Intuitively this will lead to overdispersion and to
increased probabilities of the occurrence of low counts and of high counts. In
this subsection, we confirm that this is indeed the case.
Multiplicative Heterogeneity
The starting point is the Poisson with multiplicative unobserved heterogeneity
νi ,
yi |μi , ν i ∼ P[μi ν i ],

(4.1)

so E[yi |μi , ν i ] = μi ν i and V[yi |μi , ν i ] = μi ν i using the equidispersion of the
Poisson.
For count regression μi depends on observables. The standard Poisson model
specifies an exponential conditional mean and includes an intercept term. Then
μi = exp(β 0 + x1i β 1 ) and
μi ν i = exp(β 0 + x1i β 1 )ν i
= exp(β 0 + x1i β 1 + ln ν i )
= exp((β 0 + ui ) + x1i β),

(4.2)

114

Generalized Count Regression

where ui = ln ν i . For an exponential conditional mean model, multiplicative
heterogeneity is equivalent to a random intercept model.
The random heterogeneity term ν i is assumed to be iid with the following
properties:
E[ν i |μi ] = E[ν i ]

(4.3)

E[ν i ] = 1
V[ν i |μi ] = σ 2ν i .
The first assumption in (4.3) is that ν i is mean independent of μi . Then from
(4.2) ν i enters the conditional mean function only through the random intercept
term; we refer to this as the separability property of unobserved heterogeneity
because the random effect is separable from that due to variation in xi . If
instead ν i enters through a random slope coefficient, the conditional mean
contains terms that are products of xi and ν i so that xi and ν i are no longer
separable. The second assumption in (4.3) is just a normalization that is needed
since the model depends on μi and ν i only through the product μi ν i , and
μi ν i is unchanged if we double ν i and halve μi . Alternatively, from (4.2) it is
clear that with an exponential conditional mean we can only identify the sum
β 0 + E[ui ]. The third assumption in (4.3) potentially allows V[ν i |μi ] to vary
with μi .
Overdispersion
Under assumptions (4.3) the first two moments of yi conditional on μi , but
unconditional on ν i , are
E[yi |μi ] = μi ,

(4.4)

using Ey|μ [y|μ] = Eν|μ [Ey|μ,ν [y|μ, ν]] = Eν|μ [μν] = μEν|μ [ν] = μ × 1 =
μ, and
V yi |μi = μi + σ 2ν i μ2i ,

(4.5)

using Vy|μ [y|μ] = Eν|μ [Vy|μ,ν [y|μ, ν]]+Vν|μ [Ey|μ,ν [y|μ, ν]] = Eν|μ [νμ]
+ Vν|μ [νμ] = μEν|μ [ν] + μ2 Vν|μ [ν].
By the results of Chapter 2.4, consistency of the Poisson MLE requires only
the correct specification of μi = E[yi |xi ]. Result (4.4) implies that the Poisson MLE with a correctly specified conditional mean, usually μi = exp(xi β),
remains a consistent estimator in the presence of unobserved heterogeneity
satisfying (4.3). This result will not necessarily hold under alternative specifications of unobserved heterogeneity, such as nonseparability considered later.
The unobserved heterogeneity has induced overdispersion, however,
because by (4.5), V yi |μi ≥ μi . Inference based on the Poisson QMLE needs
to be based on standard errors that control for this overdispersion.

4.2 Mixture Models

115

The overdispersion appears to be of the NB2 form defined in Chapter 3.2.3,
with variance a quadratic function of the mean. This is indeed the case if
σ 2ν i = α, which occurs often. But more generally we can let σ 2ν i = αg(μi ) for
then V yi |μi =
some specified function g(·). For example if σ 2ν i = αμk−2
i
k
μi + αμi . Examples given later include overdispersion of NB1 form and of
cubic form V yi |μi = μi + αμ3i .
The presence of overdispersion opens up the possibility of more efficient
estimation. The moment conditions (4.4) and (4.5) provide the basis for
sequential quasi-likelihood estimation (McCullagh, 1983; Gourieroux et al.,
1984b; Cameron and Trivedi, 1986) and moment estimation (Moore, 1986); see
Chapter 2.5.
Poisson Mixtures
More often, however, a fully parametric approach is taken, with a distribution
for the unobserved heterogeneity specified. Let f (yi |μi , ν i ) denote the Poisson
probability mass function parameterized by μi ν i (rather than μi ), so
f (y|μ, ν) =

e−μν (μν)y
,
y!

(4.6)

and let g(ν i |μi ) denote the probability density function of ν i |μi . The mixed
marginal density of yi |μi is derived by integrating with respect to ν i , so

h(y|μ) =

f (y|μ, ν)g(ν|μ)dν.

(4.7)

The precise form of this mixed Poisson distribution depends on the specific
choice of g(ν|μ), although in all cases mixing leads to overdispersion. If g(·)
and f (·) are conjugate families, the resulting compound model is expressible
in a closed form.
The class of mixture models generated through different assumptions about
ν are also known as mixed and/or multilevel models. There is a large literature
devoted to this class of models; see, for example, Skrondal and Rabe-Hesketh
(2004). There are many special cases such as latent class models, regime
switching models, and hidden Markov models that have been found useful in
empirical analysis.
Table 4.1 summarizes several leading examples of mixture models for counts
that are presented in this chapter. The first five models are mixtures of the
Poisson with unobserved heterogeneity that is separable so that E[y] = μ,
where usually μ = exp(x β). These models are presented in this section. The
remaining three models have a more general form of mixing that changes the
conditional mean. These latter models are presented in later sections of this
chapter.

116

Generalized Count Regression

Table 4.1. Selected mixture models for count data
Distribution

f (y) = Pr[Y = y]

Mean; variance

1. Poisson

e−μ μy /y!

μ; μ

2. NB1

As in NB2 below with α −1 replaced by α −1 μ

μ; (1 + α)μ

3. NB2

(α −1 + y)
(α −1 )(y + 1)

4. P-IG

See section 4.2.5

5. Poissonnormal

6. Hurdle

7. Zero-inflated
8. Finite mixture

+∞

−∞





α −1
α −1 + μ

exp −ex β+σ ν

α −1

m

j =1

π j fj (y|θ j )

μ
μ + α −1

y

μ; (1 + αμ)μ
μ; μ + μk /τ





ex β+σ ν

y

⎧
if y = 0,
⎨f1 (0)
1 − f1 (0)
⎩
f2 (y) if y ≥ 1.
1 − f2 (0)

π + (1 − π)f2 (0) if y = 0,
(1 − π )f2 (y)



if y ≥ 1.

2

1 √1
− ν2
y! 2π e

2

2

dν μ; μ + (eσ − 1)eσ μ2

1−f1 (0)
1−f2 (0) μ2

(1 − π )μ2 ;
(1 − π )(σ 22 + π μ22 )



j

π j μj ;

π j [μj + σ 2j ]

−( j π j μj )2
j

Excess Zeros
In the remainder of this subsection we assume ν i is independent of μi , so
g(ν|μ) = g(ν), and that mixing leads to no change in the conditional mean, so
E[y|μ] = μ.
Then for any nondegenerate heterogeneity distribution g(·), mixing defined
in (4.7) increases the proportion of zero counts
h(0|μi ) > f (0|μi , ν i ).

(4.8)

Feller (1943) and Mullahy (1997a) provide proofs of this result. Mullahy
shows that this property follows from strict convexity of f (0|μ, ν) in μν, and
the result generalizes to many count models other than the Poisson, such as
the negative binomial. In most instances the frequency of y = 1 is less in the
mixture distribution than in the parent distribution, so h(1|μi ) < f (1|μi , ν i ).
Finally, the mixture exhibits thicker right tail than the parent distribution. These
properties of the Poisson mixtures may be used for constructing specification
tests of departures from the Poisson (Mullahy, 1997a).

117

.15

4.2 Mixture Models

0

Probability that Y = y
.05
.1

NB μ = 10 α = .2
Poisson μ = 10

0

5

10
y

15

20

Figure 4.1. Two Crossing Theorem: Negative binomial compared with the
Poisson.

The result of mixing leading to fatter left and right tails is a special case of a
general result on exponential family mixtures referred to as the Two Crossings
Theorem by Shaked (1980).
Two Crossings Theorem: For the random variable y, continuous or discrete,
let f (y|μ, ν) denote an exponential family conditional (on ν) model density
and let E[ν] = 1. Then the mixed (marginal with respect to ν) distribution
h(y|μ) = Eν [f (y|μ, ν)] will have heavier tails than f (y|μ, ν) in the sense
that the sign pattern of marginal minus the conditional, h(y|μ) − f (y|μ, ν), is
{+, −, +} because y increases on its support.
That is, for the same mean, any marginal distribution must “cross” the
original conditional distribution twice, first from above and then from below.
The first crossing accounts for a relative excess of zeros, and the second accounts
for greater thickness of the right tail. A sketch of the proof of this theorem is
given in section 4.12.
Figure 4.1 illustrates these results, comparing h(·) for a Poisson-gamma
mixture or negative binomial with f (·) for a Poisson, where both have the same
mean 10. As expected, the mixture has a higher probability of zeroes, fatter
right tail, and greater variation.
4.2.2

Negative Binomial as Poisson-Gamma Mixture

The interpretation and derivation of the negative binomial as a Poisson-gamma
mixture are an old result (Greenwood and Yule, 1920), but the precise parameterization of the gamma may lead to different variance functions (Cameron

118

Generalized Count Regression

and Trivedi, 1986). Here we work with the most popular parameterization,
which leads to a quadratic-in-mean variance function.
Begin by specifying the heterogeneity term ν to have a two-parameter
gamma distribution g(ν|δ, φ) = (φ δ / (δ))ν δ−1 e−νφ , δ > 0, φ > 0. Then
E[ν] = δ/φ, and V[ν] = δ/φ 2 . To satisfy the normalization that E[ν] = 1 in
(4.3), set δ = φ so that ν has the one-parameter gamma distribution
g(ν|δ) =

δ δ δ−1 −νδ
ν e , δ > 0,
(δ)

(4.9)

with V[ν] = 1/δ. The Poisson model with heterogeneity is y|μ, ν ∼ P[μν],
and it is convenient to work with θ ≡ μν. So in (4.9) transform from ν to
θ using θ = μν and the Jacobian transformation term 1/μ. The pdf for the
heterogeneous term θ = μν is then the gamma density

θ δ−1 − μθ δ
1 δδ
e
(4.10)
g(θ |δ, μ) =
μ (δ) μ
δ
=

δ
μ

θ δ−1 e− μ .
δθ

(δ)

The Poisson-gamma mixture is

h(y|μ, δ) = f (y|θ )g(θ|δ, μ)dθ


−θ y

δ
μ

(4.11)

δ

δθ
e θ
−
×
θ δ−1 e μ dθ
y!
(δ)
δ
δ
 

μ
δ
y+δ−1
=
exp − 1 +
θ
θ dθ
(δ)y!
μ
δ
δ

μ
δ −(δ+y)
=
(δ + y).
1+
(δ)(y + 1)
μ

=

The last line uses the following properties of the gamma function:
 ∞
(a) =
t a−1 e−t dt, for any a > 0
0

(a − 1) = a!,
for any a > 0
 ∞
b−a (a) =
t a−1 e−bt dt, for any b > 0.
0

Defining α = 1/δ and rearranging, (4.11) becomes
(α −1 + y)
h(y|μ, α) =
(α −1 )(y + 1)



α −1
−1
α +μ

α −1



μ
−1
α +μ

y

. (4.12)

4.2 Mixture Models

119

This is the negative binomial distribution originally defined in Chapter 3.3.1.
As noted there,
E[y|μ, α] = μ
V[y|μ, α] = μ(1 + αμ) > μ,

since α > 0.

Maximum likelihood estimation of this model is discussed in Chapter 3.3.
Note that the Poisson QMLE is also consistent here, since E[y|μ] = μ due to
the separability assumption on unobserved heterogeneity.
4.2.3

Other Characterizations of the Negative Binomial

The characterization of the NB distribution as a Poisson-gamma mixture is
only one of a number of chance mechanisms that can generate that distribution.
Boswell and Patil (1970) list 13 distinct stochastic mechanisms for generating
the NB. These include the NB as a waiting-time distribution, as a Poisson sum
of a logarithmic series of random variables, as a linear birth and death process,
as the equilibrium of a Markov chain, and as a group-size distribution.
An Alternative Parameterization of NB
A parametrization of the NB used in many references, as well as in algorithms
to generate draws from the negative binomial, is the following:

r +y−1
(4.13)
Pr[Y = y] =
(1 − p)r py , y = 0, 1, 2, . . . ,
r −1
where 0 < p < 1 and r > 0. Then E[Y ] = pr/(1 − p) and V[Y ] = pr/(1 −
p)2 . Letting r = 1/α and p = αμ/(1 + αμ) yields the parameterization of the
NB given in (4.12).
NB as a Poisson-Stopped Log-Series Distribution
Many counted events can occur in spells (e.g., doctor visits arise from each of
several spells of illness). Then there is a distribution of the random variable S
(spells) and a distribution of events (Rj ) within the j th spell, conditional on a
spell occurring.
Suppose the number of spells is generated according to the Poisson distribution with parameter λ, while the number of events (which may be dependent)
within a given spell is generated by a log-series probability law defined as
aθ r
, r = 1, 2, . . . ,
r
where 0 < θ < 1 and a = −1/(ln(1 − θ )). The first two moments are E[R] =
aθ/(1 − θ) and V[R] = aθ (1 − aθ )/(1 − θ )2 . A feature of the log-series distribution is that the probability mass function has a maximum at R = 1, and
Pr[R = r + 1] always exceeds Pr[R = r].
Pr[R = r] =

120

Generalized Count Regression

Combining the Poisson and log-series assumptions gives the marginal distribution

aλ + y − 1
Pr[Y = y] =
(1 − θ )aλ θ y , y = 0, 1, 2, . . . , (4.14)
aλ − 1


where Y = Sj=1 Rj = S + Sj=1 (Rj − 1), and Rj denotes the number of
events in spell j . This is a negative binomial density, equaling (4.13) with
r = aλ and p = θ. The first two moments are E[Y ] = aλθ/(1 − θ ) and V[Y ] =
aλθ/(1 − θ)2 = E[Y ]/(1 − θ ). Because the variance is linear in the mean, this
is the NB1 negative binomial. The standard NB1 regression model can be
obtained by assuming λ = exp(x β) and treating both a and θ as constants.
This mixture distribution is also known as the Poisson-stopped log-series
distribution or stopped-sum distribution; see Johnson, Kemp, and Kotz (2005).
The zeros of this model imply that a spell did not occur; conversely, if a spell
does occur then the event of interest must be observed at least once because
the log-series distribution has no mass at zero. This condition is potentially
restrictive. For example, in practice a spell of illness may occur, but no doctor
visit may result.
Santos Silva and Windmeijer (2001) implement this model for data on the
total number of doctor visits, so only Y is observed and not its subcomponents
Rj , j = 1, . . . , S. They compare results with those from a hurdle model, defined
in section 4.5, which can be viewed as a single-spell model. They point out
that additional flexibility can result from further parameterizing θ as a logistic
function of the form exp(z γ )/(1 + exp(z γ )), where z are regressors that affect
doctor visits once a spell occurs, whereas x are factors influencing the number
of spells.
NB as a limiting Polya Distribution
A special mention should be made of Eggenberger and Polya’s (1923) derivation
of the NB as a limit of an urn scheme. The idea here is that an urn scheme can
be used to model true contagion in which the occurrence of an event affects the
probability of later events.
Consider an urn containing N balls of which a fraction p are red and fraction
q = 1 − p are black. A random sample of size n is drawn. After each draw the
ball drawn is replaced and k = θ N balls of the same color are added to the urn.
Let Y be the number of red balls in n trials. Then the distribution of Y is the
Polya distribution defined for y = 0, 1, . . . , n as

Pr[Y = y] =

n p(p + θ) · · · [p + (y − 1)θ ] q(q + θ) · · · [q + (n − y)θ ]
,
1(1 + θ ) · · · [1 + (n − 1)θ]
y

Let n → ∞, p → 0, θ → 0, with np → η and θn → bη, for some constant
b. Then the limit of the Polya distribution can be shown to be the NB with

4.2 Mixture Models

parameters k ≡ 1/b and 1/(1 + bη); that is,


k+y−1
η−k
Pr[Y = y] =
η
k−1

121

k



k
η

y

,

(4.15)

where for convenience we take k = θ N to be an integer (see Feller, 1968;
pp. 118–145; Boswell and Patil, 1970). This is (4.13) with r = k and p = k/η.
The Polya urn scheme can be interpreted in terms of the occurrence of
social or economic events. Suppose an event of interest, such as an accident,
corresponds to drawing a red ball from an urn. Suppose that subsequent to
each such occurrence, social or economic behavior increases the probability of
the next occurrence. This is analogous to a scheme for replacing the red ball
drawn from the urn in such a way that the proportion of red balls to black balls
increases. If, however, after a ball is drawn, more balls of the opposite color are
added to the urn, then the drawing of a ball reduces the probability of a repeat
occurrence at the next draw.
Of course, there can be many possible replacement schemes in the urn problem. Which scheme one uses determines the nature of the dependence between
one event and the subsequent ones. This shows that the NB distribution can
arise due to occurrence dependence, called true contagion. Alternatively, as
seen earlier the NB distribution can arise when different individuals experience
an event with constant but different probabilities. This is analogous to individuals having separate urns with red and black balls in different proportions.
For each person the probability of drawing a red ball is constant, but there is a
distribution across individuals. In the aggregate one observes apparent dependence, called spurious contagion, due to heterogeneity. This topic is pursued
further in section 4.10.1.
4.2.4

Poisson-Lognormal Mixture

The Poisson-gamma mixture is popular because it leads to a closed-form solution, the NB, for the mixture distribution. But heterogeneity distributions other
than the gamma may be more natural choices and may provide a Poisson
mixture model that better fits the data.
An obvious choice is the lognormal distribution for ν i , with ln ν ∼ N[0, σ 2 ].
In the case of an exponential model for μ, similar to (4.2) we have
μν = exp(x β + ln ν)
= exp(x β + σ ε),
where ε ∼ N[0, 1]. The marginal distribution obtained by integrating out ε is
+∞
h(y|x, β, σ ) = −∞ f (y|x, β, σ , ε)g(ε)dε
+∞
2
= −∞ f (y|x, β, σ , ε) √12π e−ε /2 dε
(4.16)
+∞
 x β+σ ε   x β+σ ε y 1 1 −ε2 /2
√ e
= −∞ exp −e
−e
dε
y! 2π

122

Generalized Count Regression

since f (·) is the P[μν] and g(ε) is the standard normal density. The model is
variously called the Poisson-lognormal model, because ν is lognormal, or the
Poisson-normal model, because ε is normal distributed.
There is no closed-form solution for h(y|x, β, σ ), unlike for the Poissongamma, but numerical methods work well. There are several ways to proceed.
Simulated Maximum Likelihood
Because the marginal distribution is a mathematical expectation with respect
to density g(ε), the expression in (4.16) can be approximated by making draws
of ε from g(ε), here the N[0, 1] distribution, evaluating f (y|x, β, σ , ε) at these
(S)
draws, and averaging. Then for the i th observation with S draws ε (1)
i , . . . , εi ,
we use
ĥ(yi |xi , β, σ ) =

S
1
f (yi |xi , β, σ , ε (s)
i ).
S s=1

(4.17)

This method is also called Monte Carlo integration.
The simulated likelihood function can be built up using n terms like that
above. The maximum simulated likelihood estimator maximizes the simulated
log-likelihood function
L̂(β, σ ) =

n

i=1

ln ĥ(yi |xi , β, σ )

(4.18)


S
1
(s)
ln
f (yi |xi , β, σ , ε i ) .
=
S s=1
i=1
n




It is known that if S is held fixed while n → ∞, the resulting estimator of
(β, σ ) is biased (McFadden and Ruud, 1994; Gourieroux
√ and Monfort, 1997).
However, if S and n tend to infinity in such a way that S/n → 0, the estimator
is both consistent and asymptotically efficient.
An active area of research is concerned with generating ε(s)
i such that the
effective size of S becomes large while the nominal number of draws remains
manageable, because this avoids the computationally burdensome task of letting
S go to infinity. For example, quasi-random draws of ε (s)
i are substituted for
pseudorandom draws. Another modification is to incorporate a bias correction
term in the approximation to the density using finite S (Munkin and Trivedi,
1999). For simple problems such as this example where draws are with respect
to the univariate standard normal, however, there is no practical problem in
simply using a very high value of S.
The simulation approach is flexible and potentially very useful in the context
of truncated or censored models with unobserved heterogeneity and also for
structural models. An example is given in Chapter 10.3.1.

4.2 Mixture Models

123

An alternative simulation procedure to maximum simulated likelihood is to
use Bayesian methods. They are treated separately in Chapter 12, and Bayesian
analysis of the Poisson-lognormal model is presented in Chapter 12.5.2.
Gaussian Quadrature
The integral in (4.16) may be evaluated using numerical integration, rather than
simulation. An alternative estimation procedure may be based on numerical
integration. For univariate integrals, a method that works well is Gaussian
quadrature, specifically Gauss-Hermite quadrature for (4.16) since integration
∞). In general m-point
Gauss-Hermite quadrature approximates
+is∞over−x(−∞,
2
m
e
r(x)
by
the
weighted
sum
j =1 wj r(xj ), where the weights wj and
−∞
evaluation points xj are given in tables in Stroud and Secrest (1966), for
example, or can be generated using computer code given in Press, Teukolsky,
Vetterling, and Flannery (2008).
√
√ To apply this method here we transform from ε to x = ε/ 2 with Jacobian
2, and rewrite the second line in (4.16) as
 ∞
√
2 1
e−x √ f (y|x, β, σ , 2x)dx.
h(y|x, β, σ ) =
π
−∞
The Gauss-Hermite approximation for the i th observation is
ĥ(yi |xi , β, σ ) =

m


√
1
wj √ f (y|xi , β, σ , 2xj ).
π
j =1

(4.19)

Note that scalar evaluation points xj here
 should not be confused with the
regressors xi . The MLE then maximizes ni=1 ln ĥ(yi |xi , β, σ ). An example is
given in Chapter 10.3.1.
This approach was used by Hinde (1982) and Winkelmann (2004) for the
Poisson-lognormal model. Many software packages offer this model as an
option. Given the relative simplicity of one-dimensional numerical integration,
any distribution for unobserved heterogeneity that a user finds appealing can
be handled by numerical integration so there is no compelling justification for
sticking to closed-form mixtures.
4.2.5

Poisson-Inverse Gaussian Mixture

The statistical literature has documented that the NB model has limitations in
modeling long-tailed data. For example, based on research on word frequencies, Yule (1944) conjectures that the compound Poisson model provides a way
to tackle the problem, but he rejects the NB model because of its poor performance. Sichel (1971) suggests a distribution suitable for modeling long-tailed
frequency data that has been mainly used in biology (Ord and Whitmore, 1986)
and linguistics (Sichel, 1974, 1975). However, these studies involve only the
univariate version, whereas we are interested in the regression model.

124

Generalized Count Regression

A special case of the Sichel distribution is the Poisson-inverse Gaussian (PIG) distribution. Willmot (1987) discusses the properties and interpretations
of the P-IG model and its attractiveness relative to the NB model in some
univariate actuarial applications. Although on a priori grounds P-IG appears
to be a useful model in a variety of contexts, it has not been used much in
econometrics.
The random variable ν is positive-valued and follows the inverse Gaussian
(IG) distribution, with pdf
7

τ
τ (ν − λ)2
exp
−
,
(4.20)
f (ν|τ , λ) =
2π ν 3
2λ2 ν
where ν > 0, τ > 0, and λ > 0. The IG is a two-parameter exponential family with shape similar to a chi-squared distribution. As the shape parameter
τ → ∞, the IG becomes more normal in shape. It can be shown that the IG
distribution has mean λ and variance λ3 /τ . Alternative equivalent parameterizations and other properties of the IG are given in Tweedie (1957).
We present a P-IG regression model due to Guo and Trivedi (2002). As
usual y|μ, ν ∼ P[μν]. To normalize E[ν] = 1, see (4.3), set λ = 1 in (4.20);
then V[ν] = 1/τ . The P-IG model is obtained as
 ∞
exp(−νμ)(νμ)y
f (ν|τ , λ)dν.
(4.21)
Pr[Y = y] =
y!
0
The resulting mean and variance are E[Y ] = μ and V[Y ] = μ + μ3 /τ , and the
P-IG approaches the standard Poisson as τ → ∞. In contrast to the quadratic
variance of the standard NB model, this version of the P-IG has a cubic
variance function that permits a high rate of increment that may better model
highly overdispersed data.
From Chapter 3.3.3 a range of NB models can be obtained according to how
the overdispersion parameter is parameterized. A range of P-IG models can
similarly be obtained. Guo and Trivedi (2002) reparameterize the overdispersion parameter τ in (4.20) as μ2 /η. Then the P-IG distributed random variable
has mean μ, variance μ + μη, and probability mass function
) 
*
√
Pr[Y = 0] = exp μη 1 − 1 + 2η
y

μ
Pr[Y = y] = Pr[Y = 0] (y+1)
(1 + 2η)−y/2 ×
j
y−1 (y+j )
η
(1 + 2η)−j/2 ,
× j =0 (y−j
)(j +1) 2μ

(4.22)

for y = 1, 2, . . . . The details of the derivation, which involves considerable
algebra, are omitted; see Willmot (1987). Because the score equations for the
P-IG model are very nonlinear, an iterative solution algorithm is needed to
implement ML estimation. Application is to two data sets, one on the number
of patent applications and one on the number of patents awarded.
Dean, Lawless, and Willmot (1989) use an alternative version of the P-IG
model for which the variance of Y is μ + ημ2 . Then in (4.22) replace η by ημ.

4.2 Mixture Models

125

They argue that this model provides an attractive framework for handling longer
tailed distributions. They applied the model to the number of motor insurance
claims made in each of 315 risk groups.
4.2.6

General Mixture Results

The statistics literature contains many examples of generalized count models
generated by mixtures. An historical account can be found in Johnson, Kemp,
and Kotz (2005). In addition to NB, which is the most popular mixture, and
P-IG and Poisson-lognormal, already covered, other mixtures include discrete
lognormal (Shaban, 1988), generalized Poisson (Consul and Jain, 1973; Consul, 1989), and Gauss-Poisson (Johnson, Kemp, and Kotz, 2005). Additional
flexibility due to the presence of parameters of the mixing distribution generally
improves the fit of the resulting distribution to observed data.
It is useful to distinguish between continuous mixtures (convolutions) and
finite mixtures.
Definition. Suppose F (y|θ ) is a parametric distribution depending on θ, and
let π (θ |α) define a continuous mixing distribution.
Then a convolution (con+∞
tinuous mixture) is defined by F (y|α) = −∞ π (θ|α)F (y|θ)dθ .
Definition. 
If Fj (y|θ j ), j = 1, 2, . . . , m, isa distribution function then
m
F (y|π j ) = m
j =1 π j Fj (y|θ j ), 0 < π j < 1,
j =1 π j = 1, defines an mcomponent finite mixture.
Note that although these definitions are stated in terms of mixtures of the
cdf rather than the pdf, definitions in terms of the latter are feasible (and have
been used so far in section 4.2). The second definition is a special case of the
first, if π (θ|α) is discrete and assigns positive probability to a finite number
of parameter values θ 1 , . . . , θ m . In this case π j , the mixing proportion, is the
probability that an observation comes from the j th population. By contrast,
in a continuous mixture the parameter θ of the conditional density is subject
to chance variation described by a density with an infinite number of support
points. Estimation and inference for convolutions involve the parameters (θ , α)
and for finite mixtures the parameters (π j , θ j ; j = 1, . . . , m).
The Poisson with multiplicative heterogeneity is the special case where
θ = (θ 1 , θ 2 ) = (μ, ν) and a mixing distribution is only specified for θ 2 . The
more general formulation here leads naturally to hurdle, zero-inflated, and finite
mixture models that are presented in subsequent sections.
4.2.7

Identification

Identifiability, or unique characterization, of mixtures should be established
before estimation and inference. A mixture is identifiable if there is a unique
correspondence between the mixture and the mixing distribution, usually in the
presence of some a priori constraints (Teicher, 1961).

126

Generalized Count Regression

The probability generating function (pgf) of a mixed Poisson model, denoted
P (z), can be expressed as the convolution integral
 ∞
exp(μ(z − 1))π (μ)dμ,
(4.23)
P (z) =
0

where exp(μ(z − 1)) is the pgf of the Poisson distribution and π (μ) is the
assumed distribution for μ.
Mixture models, being akin to “reduced-form” models, are subject to an
identification problem. The same distribution can be obtained from more than
one mixture. For example, the negative binomial mixture can be generated as a
Poisson-gamma mixture by allowing the Poisson parameter μ to have a gamma
distribution (see section 4.2.2). It can also be generated by taking a random sum
of independent random variables in which the number of terms in the sum has a
Poisson distribution; if each term is discrete and has a logarithmic distribution
and if the number of terms has a Poisson distribution, then the mixture is
negative binomial (Daley and Vere-Jones, 1988). In this case, identification
may be secured by restricting the conditional event distribution to be Poisson.
This follows from the uniqueness property of exponential mixtures (Jewel,
1982).
A practical consideration is that in applied work, especially that based on
small samples, it may be difficult to distinguish between alternative mixing
distributions, and the choice may be largely based on the ease of computation.
Most of the issues are analogous to those that have been discussed extensively
in the duration literature; see Lancaster (1990, chapter 7) for the proportional
hazard model. In the examples in the duration literature, finiteness of the
mean of the mixing distribution is required for identifiability of the mixture.
For counts, it is possible to obtain Poisson-gamma (NB) and Poisson-inverse
Gaussian (P-IG) mixtures with the same mean and variance, see sections 3.3.1
and 4.2.5, so the two mixing distributions can only be distinguished using
information about higher moments. This may be empirically challenging given
typical sample sizes.
Although more flexible count distributions are usually derived by mixing,
it may sometimes be appropriate to directly specify flexible functional forms
for counts, without the intermediate step of introducing a distribution of unobserved heterogeneity. For example, this may be convenient in aggregate timeseries applications. In microeconometric applications, however, mixing seems
a natural way of handling heterogeneity.
4.2.8

Computational Considerations

Under certain conditions, parametric mixture distributions based on the Poisson
are straightforward to estimate using standard optimizers. The relative simplicity of optimization in this case is a consequence of unimodality of the likelihood
function. This property of unimodality is realized under the conditions of the
following theorem due to Holgate (1970).

4.2 Mixture Models

127

Definition. Let g(μ) be the probability density function of an absolutely continuous random variable. Then the nonnegative+ integer-valued random variable
−μ y
with probability mass function Pr [Y = y] = e y!μ g(μ)dμ, y ≥ 0, is a unimodal lattice variable.
By this theorem continuous mixtures based on the Poisson, such as the
NB and P-IG distributions, have unimodal likelihood functions. Hence an
application of a standard gradient-based algorithm will globally maximize the
likelihood function. This is an attractive feature of the parametric mixtures
considered earlier, even examples such as Poisson-lognormal that do not have
a closed-form solution for the mixture density.
4.2.9

Consequences of Misspecified Heterogeneity

In the duration literature, in which the shape of the hazard function is of central
interest, there has been an extensive discussion of how misspecified unobserved
heterogeneity can lead to inconsistent estimates of the hazard function; see
Heckman and Singer (1984) and Lancaster (1990, pp. 294–305) for a summary.
Under the assumption of correct conditional mean specification, the consequences of misspecified separable heterogeneity were dealt with in Chapters 2
and 3 in the context of an uncensored distribution. The Poisson and NB2 MLEs
remain consistent, since they are in the LEFN, although a robust variance
matrix estimator needs to be used. The MLE in other NB models, P-IG and
Poisson-lognormal models, will be inconsistent.
When the data distribution is truncated or censored, the robustness of Poisson
and NB2 to misspecification disappears. Suppose the dgp is NB2, a Poissongamma mixture, but the data are truncated at zero. Then the appropriate model
is the zero-truncated NB2, and the MLE for the zero-truncated Poisson is
inconsistent; see section 4.3.2. The neglect of unobserved heterogeneity is no
longer relatively innocuous and is not remedied by the use of a robust variance
matrix estimator. A similar conclusion will apply to finite mixture-type models
in which unobserved heterogeneity does not enter separably. A fuller treatment
of these issues is provided in Sections 4.3–4.8.
4.2.10

Additive Heterogeneity

The preceding discussion of Poisson mixtures focused on multiplicative continuous unobserved heterogeneity. The additive case has also been considered.
A Poisson model with a conditional mean function that incorporates additive
independent nonnegative unobserved heterogeneity ν > 0 is
y|μ, ν ∼ P[μ + ν]
∼ P[μ] + P[ν].
The second line uses the result that the sum of independent Poissons is Poisson
with mean the sum of the means. Taking expectation with respect to ν, so

128

Generalized Count Regression

that conditioning is just on μ, additive heterogeneity increases the mean of y
from μ to μ+ E[ν], and the variance from μ to μ+ E[ν] + V[ν]. Unlike the
multiplicative case with E[ν] = 1, the mean necessarily increases. The variance
also increases and by more than the mean so there is overdispersion.
As an example, suppose ν ∼ Gamma[α, β], a two-parameter gamma that
is not restricted to have E[ν] = 1. Then
y|μ ∼ P[μ] + P[Gamma[α, β]],
a marginal distribution that goes by the name Delaporte distribution. A special
case is when α = 1, so E[ν] = 1, when we have a sum of Poisson and negative
binomial. See Vose (2008) for additional detail and examples and Fé (2012)
for theory and application to production frontier analysis.
4.3 TRUNCATED COUNTS
Models for incompletely observed count data due to truncation and censoring
are presented, respectively, in this section and the subsequent section. Failure to
control for truncation or censoring leads to inconsistent parameter estimation,
because the observed data will have a conditional distribution and mean that
differ from those of the underlying dgp for the count. Linking the two relies on
strong parametric assumptions. Analysis usually needs to be based on richer
models than the Poisson, such as NB, though for illustrative purposes we often
use the Poisson.
Truncated and censored count models are discrete counterparts of truncated
and censored models for continuous variables, particularly the Tobit model for
normally distributed data, that have been used extensively in the economics
literature (Maddala, 1983; Amemiya, 1984). Sample selection counterparts
of these models are discussed in Chapter 10. Truncated models are also a
component of the hurdle model presented in section 4.5.
4.3.1

Standard Truncated Models

Truncation arises if observations (yi , xi ) in some range of yi are totally lost.
In particular, for some studies involving count data, inclusion in the sample
requires that sampled individuals have been engaged in the activity of interest
or, as Johnson and Kotz (1969, p. 104) put it, “the observational apparatus
become[s] active only when a specified number of events (usually one) occurs.”
Examples of left truncation include the number of bus trips made per week in
surveys taken on buses, the number of shopping trips made by individuals
sampled at a mall, and the number of unemployment spells among a pool
of unemployed. Right truncation occurs if high counts are not observed. For
simplicity we focus on left truncation. Analogous results for right truncation
can be derived by adapting those for left truncation.

4.3 Truncated Counts

129

The following general framework for truncated count models is used. Let
h(y|θ ) = Pr[Y = y]

(4.24)

H (y|θ) = Pr[Y ≤ y]

denote the pdf and cdf of the nonnegative integer-valued random variable Y ,
where θ is a parameter vector.
Left Truncation
If realizations of y less than a positive integer, say r, are omitted, then the
ensuing distribution is called left truncated or truncated from below. The lefttruncated (at r) count distribution is given by
f (y|θ, y ≥ r) =

h(y|θ)
,
1 − H (r − 1|θ )

y = r, r + 1, . . . .

(4.25)

A special case is the left-truncated NB2 model. Then h(y|θ) is the NB2
density defined in (4.12) and θ ≡ (μ, α). The resulting truncated NB2 density
has truncated mean γ and truncated variance σ 2 defined by
γ = μ+δ
σ 2 = μ + αμ2 − δ(γ − r)
δ = μ [1 + α(r − 1)] λ(r − 1|μ, α)
λ(r − 1|μ, α) = h(r − 1|μ, α)/[1 − H (r − 1|μ, α)],

(4.26)

see Gurmu and Trivedi (1992).
For the NB2 model, the relation between the truncated mean and the mean
of the parent distribution can be expressed as
E[y|y ≥ r] = E[y] + δ,
where δ > 0. The truncated mean exceeds the untruncated mean. Furthermore,
the difference between the truncated and untruncated means depends on model
parameters directly and via λ(r − 1|μ, α). The adjustment factor δ plays a
useful role, analogous to the Mill’s ratio in continuous models, in the estimation
and testing of count models. For the variance
V[y|y ≥ r] = V[y] − δ(γ − r),
so truncation decreases the variance, since the truncated mean γ necessarily
exceeds the truncation point r.
The Poisson is the limiting case of NB2 as α → 0. The left-truncated
Poisson density is
f (y|μ, y ≥ r) =
1−

e−μ μy
r−1 e−μ μj 
j =0

j!

,

y = r, r + 1, . . . ,

y!
(4.27)

130

Generalized Count Regression

with truncated mean γ and truncated variance σ 2 given by
γ = μ+δ
σ 2 = μ − δ(γ − r)
δ = μλ(r − 1|μ)
λ(r − 1|μ) = h(r − 1|μ)/1 − H (r − 1|μ).

(4.28)

As for the NB2 density, truncation leads to a higher mean and to a lower
variance. Note that the truncated variance does not equal the truncated mean.
Comparing the Poisson to NB2, the truncated means differ, whereas they
were equal in the untruncated case. This shows that when truncation occurs,
the method of moments estimators based on the truncated mean will be highly
dependent on correct specification of the untruncated distribution H (y|θ). The
left-truncated NB2 incorporates overdispersion in the sense that the variance
of truncated NB2, given in (4.26), exceeds that for truncated Poisson.
Left Truncation at Zero
The most common form of truncation in count models is left truncation at
zero, in which case r = 1 (Gurmu, 1991). That is, the observation apparatus is
activated only by the occurrence of an event.
In general the zero-truncated moments are related to the untruncated
moments E[y] and V[y] by
E[y|y > 0] =

E[y]
Pr[y > 0]

V[y|y > 0] =

Pr[y = 0](E[y])2
V[y]
,
−
Pr[y > 0]
(Pr[y > 0])2

(4.29)

where the second expression is obtained after some algebra given in section
4.12. Left truncation at zero decreases the mean, and the first two truncated
moments depend crucially on Pr[y > 0] which varies with the parametric model
for y.
For Poisson-without-zeros the truncated mean given in (4.28) simplifies to
μ
,
(4.30)
E[y|y > 0] =
1 − e−μ
using r = 1 so λ(r − 1) = λ(0) = h(0)/(1 − h(0)) = e−μ /(1 − e−μ ) as h(0) =
e−μ . Alternatively we could use (4.29) and Pr[y > 0] = 1 − e−μ . Also

μ
μe−μ
,
(4.31)
V[y|y > 0] =
1
−
1 − e−μ
1 − e−μ
since from (4.28) the truncated variance σ 2 = μ − δ(γ − 1) = μ − δ(μ + δ −
1) = μ(1 − δ) + δ(1 − δ) = γ (1 − δ). As noted already E[y|y > 0] depends
on the parametric model, which here sets Pr[y = 0] = e−μ . Misspecification of
this probability leads to a misspecified truncated mean, leading to inconsistent
estimation of the untruncated mean μ.

4.3 Truncated Counts

131
−1

−1

For NB2-without-zeroes, h(0) = (1 + αμ)−α , so λ(0) = (1 + αμ)−α /
−1
(1 − (1 + αμ)−α ). The truncated mean given in (4.26) simplifies to
μ
E[y|y > 0] =
(4.32)
1 − (1 + αμ)−α−1
and, the truncated variance σ 2 = μ + αμ2 − δ(γ − 1) = γ (1 − δ) + αμ2 is


−1
μ
μ(1 + αμ)−α
V[y|y > 0] =
1 + αμ −
. (4.33)
1 − (1 + αμ)−α−1
1 − (1 + αμ)−α−1
In practice the process generating zero counts may not be the same as that
for the positive counts. In the truncated case there are no data at all for zeros, so
there is no alternative but to assume the processes are the same. Then analysis
is given a restricted interpretation. For example, if hunting trips are observed
only for those who hunt at least once, then we interpret the truncated zeros
as being due to hunters who this year chose not to hunt, rather than being for
the entire population, which will include many people who never hunt. The
untruncated mean μ is interpreted as the mean number of trips by hunters.
Right Truncation
With right truncation, or truncation from above, we lose data when y is greater
than c. For the general count model with cdf H (y|θ), the right truncated
density is
f (y|θ , y ≤ c) =

h(y|θ)
,
H (c|θ)

y = 0, 1, . . . , c.

(4.34)

For the Poisson the right-truncated mean γ 1 is
γ 1 = μ − μh(c|θ)/H (c|θ).

(4.35)

Other moments of right-truncated distributions can be obtained from the corresponding moments of the left-truncated distribution, already given, by simply
replacing r − 1, δ, and λ in (4.26) or (4.28) by, respectively, c, δ 1 , and λ1 . Right
truncation results in a smaller mean and variance relative to the parent distribution. Detailed analysis of the moments of left- and right-truncated negative
binomial models is given in Gurmu and Trivedi (1992).
It is actually more common to observe right censoring, often due to aggregation of counts above a specified value, than right truncation. Censoring is
studied in section 4.4.
4.3.2

Maximum Likelihood Estimation

Standard count estimators such as those for Poisson and NB2 models are
inconsistent in the presence of truncation. For example, for the iid Poisson the
mean of the truncated-at-zero sample will converge to its expected value of
μ/(1 − e−μ ), see (4.30), and therefore is inconsistent for the desired untruncated mean μ. Since the expression for the untruncated mean depends on

132

Generalized Count Regression

parametric assumptions, the standard approach is to be fully parametric and
estimate by maximum likelihood.
We consider ML estimation of left-truncated Poisson models with mean
μi , usually exp(xi β). Using (4.27), the log-likelihood based on n independent
observations is
⎛
⎞
⎤
⎡
n
r−1


j
−μ
⎣yi ln μi − μi − ln ⎝1 − e i
L(β) =
μi /j !⎠ − ln yi !⎦ .
j =0

i=1

(4.36)
The MLE of β is the solution of the following equation:
n

i=1

yi − μi − δ i μ−1
i

∂μi
= 0,
∂β

(4.37)

where, from (4.28), δ i = μi h(r, μi )/[1 − H (r − 1, μi )]. The information
matrix is
 
n


∂ 2 L(β)
∂μi ∂μi
I(β) = −E
μi − δ i μi + δ i − r μ−2
.
=

i
∂β∂β
∂β ∂β 
i=1
(4.38)
The MLE β̂ is asymptotically normal with mean β and covariance matrix
I(β)−1 .
Rewriting (4.37) as

n

yi − μi − δ i
1 ∂μi
= 0,
(4.39)
√
√
μi ∂β
μi
i=1
and recalling from (4.28) that the truncated mean is μi + δ i , this score equation
is an orthogonality condition between the standardized truncated residual and
standardized gradient vector of the conditional mean. This interpretation parallels that for the normal truncated regression. For the exponential specification
μi = exp(xi β), ∂μi /∂β = μi xi , and (4.37) reduces to an orthogonality condition between the regressors xi and the residual, here yi − μi − δ i given truncation. This qualitative similarity with the untruncated Poisson arises because
the truncated Poisson is also an LEF density.
The coefficients β can be directly interpreted in terms of the untruncated mean. Thus if μi = exp(xi β), the untruncated conditional mean E[yi |xi ]
changes by a proportion β̂ j in response to a one-unit change in xij . Rearranging
(4.29), for left-truncation at zero the untruncated mean
E[y|x] = E [y|y > 0, x] Pr[y > 0|x].
So the change in the untruncated mean may be decomposed into a part that
affects the mean of the currently untruncated part of the distribution and a part

4.4 Censored Counts

133

that affects the probability of truncation
∂E [y|y > 0, x]
∂ Pr[y > 0|x]
∂E[y|x]
=
Pr[y > 0|x] + E [y|y > 0, x]
.
∂xj
∂xj
∂xj
In ML estimation of truncated models, a misspecification of the underlying
distribution leads to inconsistency due to the presence of the adjustment factor
δ i . Suppose that the counts in the parent distribution are conditionally NB2
distributed and α > 0. If the misspecified distribution is the truncated Poisson, rather than the truncated NB2, then the conditional mean is misspecified
(compare (4.28) with (4.26)) and the MLE will be inconsistent. To reiterate,
ignoring overdispersion in the truncated count model leads to inconsistency,
not just inefficiency. Thus, the result that neglected overdispersion does not
affect the consistency property of the correctly specified untruncated Poisson
conditional mean function does not carry over to the truncated Poisson.
The negative binomial is a better starting point for analyzing data that
would be overdispersed in the absence of truncation. For the NB2 model,
Pr[y = 0] = (1 + αμ)−1/α . So for the most common case of left truncation at
zero (r = 1), the truncated NB2 model has log-likelihood
n 

yi −1
ln(j + α −1 ) − ln yi ! + yi ln α + yi xi β
(4.40)
L(β, α) =
i=1

j =0



− (yi + α −1 ) ln(1 + α exp(xi β)) − ln 1 − (1 + α exp(xi β))−1/α .
4.4 CENSORED COUNTS
Censoring arises if observations (yi , xi ) are available for a restricted range of
yi , but those for xi are always observed. This is in contrast to truncation, where
all data are lost for some range of values of yi . Hence, censoring involves the
loss of information that is less serious than with truncation.
As with truncation, however, failure to control for censoring leads to inconsistent parameter estimation, and adjustments to yield consistent estimates rely
on fully parametric models.
4.4.1

Standard Censored Models

Censoring of count observations may arise from aggregation or may be imposed
by survey design; see, for example, Terza (1985). Alternatively, censored samples may result if high counts are not observed, the case we consider here.
The counts y ∗ are assumed to be generated by density h(y ∗ |θ) = h(y ∗ |x, θ),
such as Poisson or NB2, with corresponding cdf H (c|θ) = Pr[y ∗ ≤ c|θ ]. But
these latent counts are not completely observed. Instead, for right censoring at
c we observe the dependent variable yi , where

yi∗ if yi∗ < c
(4.41)
yi =
c
if yi∗ ≥ c,
where c is a known positive integer.

134

Generalized Count Regression

Define a binary censoring indicator as follows:

1 if yi∗ < c,
di =
0 if yi∗ ≥ c.

(4.42)

The probability of censoring the i th observation is then
Pr[yi∗ ≥ c ] = Pr[di = 0] = 1 − Pr[di = 1] = 1 − E[di ].

(4.43)

It is assumed that the regressors xi are observed for all i = 1, . . . , n.
For y ∗ < c we observe y and the density of y is simply the usual
h(y|θ ). For y ∗ ≥ c we observe only this fact, which occurs with probability Pr[y ∗ ≥ c|θ ] = 1 − Pr[y ∗ ≤ c − 1|θ] = 1 − H (c − 1|θ ). A parsimonious
way to combine these two terms is the following:
f (y|θ) = h(y|θ)d [1 − H (c − 1|θ )]1−d ,

(4.44)

where d is the indicator variable defined in (4.42).
The censored conditional mean is
E[y] = Pr[y ∗ < c] × E[y ∗ |y ∗ < c] + Pr[y ∗ ≥ c] × c
= H (c − 1|θ ) × E[y ∗ |y ∗ < c] + (1 − H (c − 1|θ)) × c,
where E[y ∗ |y ∗ < c] is the right-truncated mean discussed in section 4.3.
4.4.2

Maximum Likelihood Estimation

Given (4.44), the log-likelihood function for n independent observations is
L(θ) =

n




ln h(yi |xi , θ )di [1 − H (c − 1|xi , θ )]1−di

i=1

=

n


{di ln h(yi |xi , θ ) + (1 − di ) ln[1 − H (c − 1|xi , θ )]} .

(4.45)

i=1

Maximization of the log-likelihood is straightforward using gradient-based
methods such as Newton-Raphson.
The coefficients θ are directly interpreted in terms of the uncensored model.
Thus if μi = exp(xi β), the uncensored conditional mean E[yi |xi ] changes by
a proportion β̂ j in response to a one-unit change in xij .
For the right-censored Poisson model the ML first-order conditions can be
shown to be
n

i=1

di (yi − μi ) + (1 − di ) δ i μ−1
i

∂μi
= 0,
∂β

where
δ i = μi h(c − 1|μi )/ 1 − H (c − 1|μi )

(4.46)

4.4 Censored Counts

135

is the adjustment factor associated with the left-truncated Poisson model.
Because (yi − μi ) is the error for the uncensored Poisson model and δ i =
E[yi − μi |yi ≥ c], see (4.28), the term [di (yi − μi ) + (1 − di ) δ i ] in (4.46) is
interpreted as the generalized error (Gourieroux et al., 1987a) for the rightcensored Poisson model. The score equations imply that the vector of generalized residuals is orthogonal to the vector of exogenous variables.
The ML procedure is easily adapted for interval-recorded counts. For example, if the number of sexual partners is recorded as 0, 1, 2 − 5, and more
than 5, then the corresponding contributions to the likelihood function are,
respectively, Pr[y = 0], Pr[y = 1], Pr[2 ≤ y ≤ 5], and Pr[y ≥ 5].
ML estimation of censored count models raises issues similar to those in
Tobit models (Terza, 1985; Gurmu, 1993). Applications of censored count
models include provision of hospital beds for emergency admissions (Newell,
1965) and the number of shopping trips (Terza, 1985; Okoruwa, Terza, and
Nourse, 1988).
4.4.3

Expectation-Maximization Algorithm

An alternative way to estimate θ in (4.45) is to use the expectation-maximization
(EM) algorithm based on expected likelihood.
Expected likelihood, EL(θ), treats di as unobserved random variables and
takes the expected value of L(θ) with respect to di , conditional on data yi , xi ,
and parameters θ . Since (4.45) is linear in di , this is equivalent here to replacing
di in (4.45) by E[di |yi , xi , θ ]. Then

EL(θ ) =

n

{E[di |xi , θ ] ln h(yi |xi , θ )
i=1

+ (1 − E[di |xi , θ ]) ln (1 − H (c − 1|xi , θ )}.

(4.47)

The expected likelihood is a weighted sum of pdf and cdf with E[di |yi , xi , θ ],
the probability of data being censored, as the weight.
In the EM algorithm, the estimates are obtained iteratively by replacing
E[di |xi , θ ] in (4.47) by
E[di |xi , θ ] = E[yi∗ < c|xi , θ ] = H (c − 1|xi , θ ),
evaluated at the current estimate of θ , and then maximizing the expected likelihood (4.47) with respect to θ. Given the new estimate of θ , the expected
value of di , can be recomputed, the expected likelihood remaximized, and
so on.
The EM method is often used to estimate more complicated censored models
and finite mixtures models.

136

Generalized Count Regression

4.5 HURDLE MODELS
The Poisson mixture models of section 4.2 can accommodate overdispersion.
But it is still common for there to be excess zeros, meaning more zero counts
in the data than predicted by a fitted parametric model such as Poisson or NB2.
Modified count data models, proposed by Mullahy (1986), are two-part
models that specify a process for the zero counts that differs from that for the
positive counts. We present hurdle models in this section and zero-inflated count
models in the next section. Both models can be viewed as discrete mixtures,
rather than the continuous mixtures emphasized in section 4.2.
4.5.1

Two-Part Structure of Hurdle Models

Suppose individuals participate in an activity, with positive counts, once a
threshold is crossed. The threshold is not crossed with probability f1 (0), in
which case we observe a count of 0. If the threshold is crossed, we observe
positive counts, with probabilities coming from the count density f2 (y) with
the associated truncated density f2 (y)/(1 − f2 (0)) that needs to be multiplied
by (1 − f1 (0)) to ensure probabilities sum to one.
This leads to the hurdle model
⎧
if j = 0
⎨ f1 (0)
Pr[y = j ] = 1 − f1 (0)
(4.48)
⎩
f2 (j ) if j > 0.
1 − f2 (0)
The model collapses to the standard model only if f1 (0) = f2 (0). The model
clearly allows for excess zeros if f1 (0) > f2 (0), though in principle it can also
model too few zeros if f1 (0) < f2 (0). The density f2 (·) is a count density such
as Poisson or NB2, whereas f1 (·) could also be a count data density, or more
simply, the probabilities f1 (0) and 1 − f1 (0) may be estimated from logit or
probit models.
An alternative motivation for this model is that zero counts arise from
two sources. For instance, in response to the question, “How many times did
you go fishing in the last two months?” zero responses would be recorded
from never fishers and from fishers who happened not to fish in the past two
months. Then f1 (0) incorporates zeros from both of these sources, whereas
f2 (0) corresponds only to fishers who happened not to fish in the past two
months. This interpretation is also related to the with-zeros model, covered in
the next section.
The model (4.48) can be viewed as a finite mixture model, see section 4.2.6,
with two components. The mixture weights for the two components are f1 (0)
and 1 − f1 (0). One component is a degenerate probability mass function f3 (y)
with f3 (j ) = 1 if j = 0 and f3 (j ) = 0 if j > 0. The other component is the
zero-truncated probability mass function f2 (y)/(1 − f2 (0)). By contrast, for the
finite mixture models presented in section 4.8, none of the component densities
are degenerate.

4.5 Hurdle Models

137

The hurdle model is a modified count model in which the two processes
generating the zeros and the positives are not constrained to be the same. In
the context of a censored normal density (the Tobit model) the hurdle model
was proposed by Cragg (1971). The basic idea is that a binomial probability governs the binary outcome of whether a count variate has a zero or a
positive realization. If the realization is positive, the hurdle is crossed, and
the conditional distribution of the positives is governed by a truncated-at-zero
count data model. Mullahy (1986) provided the general form of hurdle count
regression models, together with application to daily consumption of various
beverages. The hurdle model is the dual of the split-population survival time
model (Schmidt and Witte, 1989) where the probability of an eventual ‘death’
and the timing of ‘death’ depend separately on individual characteristics.
The moments of the hurdle model are determined by the probability of
crossing the threshold and by the moments of the zero-truncated density. The
conditional mean is
E[y|x] = Pr[y > 0|x] × Ey>0 [y|y > 0, x],

(4.49)

where the second expectation is taken relative to the zero-truncated density.
Given (4.48), it follows that
E[y|x] =

1 − f1 (0|x)
μ (x),
1 − f2 (0|x) 2

(4.50)

where μ2 (x) is the untruncated mean in density f2 (y|x). Following estimation,
marginal effects can be obtained by differentiating (4.50) with respect to x.
In section 4.12, it is shown that the hurdle model variance is
V[y] =

(1 − f1 (0|x))(f1 (0|x) − f2 (0|x))
1 − f1 (0|x) 2
(μ2 (x))2 ,
σ 2 (x) +
1 − f2 (0|x)
(1 − f2 (0|x))2
(4.51)

where σ 22 (x) is the untruncated variance in density f2 (y|x).
4.5.2

Maximum Likelihood Estimation

Define a binary censoring indicator as follows:

1 if yi > 0,
di =
0 if yi = 0.
Then the density for the typical observation can be written as
d
1 − f1 (0)
1−d
f (y) = f1 (0)
×
f2 (y)
1 − f2 (0)

f2 (y) d
= f1 (0)1−d (1 − f1 (0))d ×
.
1 − f2 (0)

(4.52)

(4.53)

138

Generalized Count Regression

Introducing regressors, let the probability of zero be f1 (0|x, θ 1 ) and the
positives come from density f2 (y|x, θ 2 ). Then using (4.53) the log-likelihood
function for the observations splits into two components, thus,
L(θ 1 , θ 2 ) = L1 (θ 1 ) + L2 (θ 2 )
=

(4.54)

n


[(1 − di ) ln f1 (0|xi , θ 1 ) + di ln(1 − f1 (0|xi , θ 1 ))]

i=1

+

n


di [ln f2 (yi |xi , θ 2 ) − ln(1 − f2 (0|xi , θ 2 ))].

i=1

Here L1 (θ 1 ) is the log-likelihood for the binary process that splits the observations into zeros and positives, and L2 (θ 2 ) is the log-likelihood function for the
truncated count model for the positives. Because the two mechanisms are specified to be independent, conditional on regressors, the joint likelihood can be
maximized by separately maximizing each component. Practically this means
that the hurdle model can be estimated using software that may not explicitly
include the hurdles option.
Although marginal effects for E[y|x] are based on (4.50), interest may also
lie in marginal effects for each of the two components: the probability 1 − f (0)
of crossing the hurdle and the mean E[y|x] of the count density f2 (y|x); see
section 4.5.3 for an example.
In his original paper, Mullahy (1986) specified f1 (·) and f2 (·) to be from
the same family and with the same regressors, so that a test of θ 1 = θ 2 is a test
of whether there is a need for a hurdle model, since the two processes are the
same if θ 1 = θ 2 . Mullahy also proposed a Hausman test and for implementation
considered both Poisson and geometric specifications. For the geometric Pr[y =
0|x] = (1 + μ1 )−1 , so that if μ1 = exp(x β 1 ), the binary hurdle process is a logit
model.
For a hurdle model with zero counts determined by NB2 with mean μ1i =
exp(xi β 1 ) and dispersion parameter α 1 , and positive counts determined by NB2
with mean μ2i = exp(xi β 2 ) and dispersion parameter α 2 , we have
−1/α1

f1 (0|xi , β 1 , α 1 ) = 1 + α 1 μ1i
−1/α2

f2 (0|xi , β 1 , α 2 ) = 1 + α 2 μ2i
(4.55)
α−1
yi
2
 (yi +α −1
α −1
μ2i
2 )
2
f2 (yi |xi , β 2 , α 2 ) =  α−1 (y +1) α−1 +μ
α −1
( 2 ) i
2i
2
2 +μ2i
Common practice now is to presume that there is a need for a hurdle model
and to specify different processes for f1 (·) and f2 (·). The binary process for
f1 (0) is specified to be a standard logit or probit model, whereas f2 (·) is an NB
density, or Poisson if a Poisson hurdle is sufficient to handle any overdispersion
present in a nonhurdle model. Then one estimates a logit model, yielding β̂ 1 for
whether or not the count is positive, and separately estimates a left-truncatedat-zero NB model, yielding estimates β̂ 2 and α̂ 2 . The log-likelihood for the
truncated NB2 is given in (4.40).

4.6 Zero-Inflated Count Models

139

Winkelmann (2004) proposed an extension of the hurdle model that permits
correlation across the two components. Specifically the hurdle is crossed if
the latent variable x1i β 1 + ε 1i > 0, the base count density is Poisson with
mean exp(x2i β 2 + ε2i ), and (ε1i , ε 2i ) are joint normally distributed. The model
simplifies to a probit first part and Poisson lognormal second part if ε1i and ε 2i
are uncorrelated.
4.5.3

Example: Hurdles and Two-Part Decision Making

Pohlmeier and Ulrich (1995) developed a count model of the two-part decisionmaking process in the demand for health care in West Germany. The model
postulates that “while at the first stage it is the patient who determines whether
to visit the physician (contact analysis), it is essentially up to the physician to
determine the intensity of the treatment (frequency analysis)” (Pohlmeier and
Ulrich, 1995, p. 340). Thus the analysis is in the principal-agent framework
where the physician (the agent) determines utilization on behalf of the patient
(the principal). This contrasts with the approach in which the demand for health
care is determined primarily by the patient.
Pohlmeier and Ulrich estimate an NB1 hurdle model. They use cross-section
data from the West German Socioeconomic Panel. The binary outcome model
of the contact decision separates the full sample (5,096) into those who did
or did not have zero demand for physician (or specialist) consultations during
the period under study. The second stage estimates the left-truncated-at-zero
NB1 model for those who had at least one physician (or specialist) consultation
(2,125 or 1,640). The authors point out that under the then-prevalent system
in West Germany, the insured individual was required to initiate the demand
for covered services by first obtaining a sickness voucher from the sickness
fund each quarter. The demand for specialist services was based on a referral
from a general practitioner to the specialist. The authors argue that such an
institutional set-up supports a hurdle model that allows initial contact and
subsequent frequency to be determined independently.
The authors test the Poisson hurdle and NB1 hurdle models against the
Poisson and reject the latter. Then they test the first two models against a lessrestrictive NB1 hurdle model, which is preferred to all restrictive alternatives on
the basis of Wald and Hausman specification tests. The authors report “important differences between the two-part decision making stages.” For example,
the physician-density variable, which reflects accessibility to service, has no
significant impact on the contact decision. But it does have a significant positive impact on the frequency decision in the general practitioner and specialist
equations.
4.6 ZERO-INFLATED COUNT MODELS
Zero-inflated count models provide an alternative way to model count data with
excess zeros.

140

Generalized Count Regression

4.6.1

Zero-Inflated Models

Suppose the base count density is f2 (y), using the same notation as for the
hurdle model, but this predicts too few zeros. An obvious remedy is to add a
separate component that inflates the probability of a zero by, say, π. Then the
zero-inflated model or with-zeroes model specifies

π + (1 − π )f2 (0), if j = 0
(4.56)
Pr[y = j ] =
if j > 0.
(1 − π )f2 (j )
In (4.56) the proportion of zeros, π, is added to the baseline distribution, and the
probabilities from the base model f2 (y) are decreased by the proportion (1 − π )
to ensure that probabilities sum to one. The probability π may be set as a
constant or may depend on regressors via a binary outcome model such as
logit or probit. One possible justification for this model is that observations are
misrecorded, with the misrecording concentrated exclusively in the zero class.
The model (4.56) can be viewed as a finite mixture model with two components. The mixture weights for the two components are π and 1 − π . One
component is a degenerate probability mass function f1 (y) with f1 (j ) = 1 if
j = 0 and f1 (j ) = 0 if j > 0. The other component is the untruncated probability mass function f2 (y).
For this model the uncentered moments E[y k ] are simply (1 − π ) times the
corresponding moments in the base density f2 (y); see section 4.12. Thus the
mean
E[y] = (1 − π)μ2 ,

(4.57)

where μ2 is the mean in the base density f2 (y). In regression application both
π and μ2 are functions of x, and following estimation marginal effects can be
obtained by differentiating (4.50) with respect to x.
The variance
V [y] = E[y 2 ] + (E[y])2
= (1 − π )(σ 22 − μ22 ) + [(1 − π)μ2 ]2
= (1 − π )(σ 22 + π μ22 ),

(4.58)

where σ 22 is the variance in the base density f2 (y); see section 4.12.2.
4.6.2

Maximum Likelihood Estimation

Define a binary censoring indicator in the same way as for the hurdle model:

1 if yi > 0,
di =
(4.59)
0 if yi = 0.
Note that di = 0 with probability π i and di = 1 with probability 1 − π i . Then
the density for the typical observation can be written as
f (y) = [π + (1 − π)f2 (0)]1−d × [(1 − π )f2 (y)]d .

(4.60)

4.6 Zero-Inflated Count Models

141

Introducing regressors, let π = π (x, θ 1 ) and the base density be f2 (y|x, θ 2 ).
Then using (4.60) the log-likelihood function is
L(θ 1 , θ 2 ) =

n

(1 − di ) ln[π(xi , θ 1 ) + (1 − π (xi , θ 1 ))f2 (0|xi , θ 2 )]
i=1

+

n


di ln[(1 − π(xi , θ 1 ))f2 (yi |xi , θ 2 )].

(4.61)

i=1

In his original paper, Mullahy (1986) specified f2 (·) to be Poisson or geometric, and π = f1 (0), where f1 (·) is also Poisson or geometric. Mullahy also
noted that, regardless of the models used, in the intercept-only case (so no
regressors appear in either part of the model) the with-zeros model is equivalent to the hurdle model, with estimation yielding the same log-likelihood and
fitted probabilities.
Lambert (1992) considered an application to soldering components onto
printed wiring boards, with y the number of leads improperly soldered. Lambert
proposed a with-zeroes model where the probability π is logit and the base count
density is Poisson. Then
π i (xi , β 1 ) = exp(xi β 1 )/[1 + exp(xi β 1 )]
f2 (yi |xi , β 2 ) = exp(− exp(xi β 2 ))(exp(xi β 2 ))yi /yi !
Lambert suggested using the EM algorithm to maximize the likelihood. As
in the censored example of section 4.4.3, the indicator variables di in (4.61)
are replaced by current-round estimates of their expected values, the resulting
expected likelihood function is then maximized with respect to θ, yielding new
estimates of E[di ], and so on. Alternatively, the usual Newton-Raphson method
may be used.
Although the logistic functional form is convenient, generalizations of the
logistic such as Prentice’s F distribution (Stukel, 1988) may also be used. For
economics data it is often the case that there is still overdispersion, and it is better
to use the NB model as the base count density. The increased generality comes
at the cost of a more heavily parameterized model, some of whose parameters
can be subject to difficulties of identification. Consequently, convergence in
ML estimation may be slow.
Both the hurdle and zero-inflated models are motivated by a desire to explain
excess zeros in the data. As already noted in section 4.5.1, the hurdle model
can also explain too few zeros. The with-zeros model can similarly explain too
few zeros, if π < 0. This is possible because the model remains valid, with
probabilities between 0 and 1 that sum to 1 provided −f2 (0)/(1 − f2 (0)) ≤
π ≤ 1. If π is parameterized as logit or probit, however, then necessarily
0 ≤ π ≤ 1, and only excess zeros can be explained.

142

Generalized Count Regression

4.7 HIERARCHICAL MODELS
The Poisson-mixture models of section 4.2 can be viewed as Poisson models
with an intercept that varies across observations according to a specified continuous distribution. Additionally the slope parameters may similarly vary. A
natural setting for such richer models is when data come from a sample survey
collected using a multilevel design. An example is state-level data that are further broken down by counties, or province-level data clustered by communes;
see Chang and Trivedi (2003).
When multilevel covariate information is available, hierarchical modeling
becomes feasible. Features of these models include relaxation of the assumption that observations are statistically independent and heterogeneity in slope
coefficients, not just intercepts. Such models have been widely applied to the
generalized linear mixed model (GLMM) class of which Poisson regression is
a member.
4.7.1

Two-Level Poisson-Lognormal Model

Wang, Yau, and Lee (2002) consider a hierarchical Poisson mixture regression to account for the inherent correlation of outcomes of patients clustered
within hospitals. In their set-up the data are in 
m clusters, each cluster has nj
observations, j = 1, . . . , m, and there are n = j nj observations in all.
The standard Poisson-lognormal mixture of section 4.2.4 can be interpreted
as a one-level hierarchical model, with
yij ∼ P[μij ]
ln μij = xij β + εij ,

ε ij ∼ N[0, σ 2ε ],

(4.62)

for observations i = 1, . . . , nj , in clusters j = 1, . . . , m.
A two-level hierarchical model, also known as a hierarchical Poisson mixture, that incorporates covariate information at both levels is as follows:
yij ∼ P[μij ]
ln μij = xij β j + ε ij ,
β lj =

wlj γ

+ vlj ,

ε ij ∼ N[0, σ 2ε ],
vlj ∼

(4.63)

N[0, σ 2v ],

for observations i = 1, . . . , nj , in clusters j = 1, . . . , m, and for the coefficients of regressors l = 1, . . . , L.
In this two-level model the regression coefficients β j now vary by clusters.
The cluster-specific variables wkj enter at the second level to determine these
first-level parameters β j with l th component β lj . The errors vlj induce correlation of observations within the same cluster. The parameter vector γ , also
called the hyperparameter, is the target of statistical inference. Both classical
(Wang et al., 2002) and Bayesian analyses can be applied.

4.7 Hierarchical Models

4.7.2

143

Three-Level Poisson-Lognormal Model

We consider a specific three-level example. Students are grouped (nested) in
classes which make up schools. The lowest level labeled i is made of students.
These students are grouped in classes, the second level labeled j . These classes
are in turn grouped to form schools, the highest level labeled k.
A three-level hierarchical model with regressors at the first and third levels
is
yij k ∼ P[μij k ]
ln μij k = xij k β k + ε ij k ,
β lk =

wlk γ

+ vlk ,

ε ij k ∼ N[0, σ 2ε ],
vlj k ∼

(4.64)

N[0, σ 2v ],

for regressors l = 1, . . . , L. Stacking β k = [β 1k · · · β Lk ] , Wk = [w1k · · · wLk ] ,
and vk = [v1k · · · vLk ] , and then substituting β k in (4.64) yields
ln μij k = xij k Wk γ + xij k vk + ε ij k .

(4.65)

As a specific example, let k = 1, 2; j = 1, 2; and i = 1, 2, 3. This means
the data are obtained from two schools, each of them has two classes, and each
class contains three students. Let yij k be the response variable for each student.
For each level, the data can be stacked recursively as
⎡
⎤
 (2) 
 (3) 
y1j k
y1k
y1
⎢
⎥
(2)
(3)
k = 1, 2; y =
.
yj k = ⎣ y2j k ⎦ j = 1, 2; yk =
(2)
y2k
y2(3)
y3j k
The conditional density for class j in school k is denoted f (y(2)
j k |vk , ε ij k ), the
(3)
density for each school is denoted f (yk |εij k ), and the marginal density for the
whole sample is f (y). Under appropriate independence assumptions at each
level, we can write the three densities as follows. For class j in school k,
f (y(2)
j k |vk , ε ij k ) =

3


f (yij k |vk , ε ij k ).

(4.66)

f (yj k(2) |vk , ε ij k )g(vk |ε ij k )dvk

(4.67)

i=1

For school k



f (y(3)
j k |ε ij k )

=

=

2

j =1

2 
3

j =1 i=1

f (yij k |vk , ε ij k )g(vk |εij k )dvk .

And aggregating across all,
 2

f (y(3)
f (yj k ) =
k |ε ij k )h(ε ij k )dε ij k

=

k=1

2

k=1



2

j =1



3


i=1

(4.68)



f (yij k |vk , ε ij k )g(vk |εij k )dvk

h(εij k )dεij k .

144

Generalized Count Regression

The log-likelihood function for a single observation is ln f (y). ML estimation
is computationally demanding because of the integrals. Standard methods of
handling these integrals numerically include Monte Carlo simulation (similar to
that in section 4.2.4 for the Poisson-Normal mixture), quadrature (section 4.2.4)
and Laplace approximation. See Skrondal and Rabe-Hesketh (2004, ch.6.3.2)
for additional details.
Note that this model leads to a change in the conditional mean. From (4.65)
we have
E[yij k |xij k , Wk ] = E[exp(xij k Wk γ + xij k vk + ε ij k )]
= E[exp(xij k Wk γ )]E[exp(xij k vk )]E[exp(εij k )]
= exp(xij k Wk γ ) exp(σ 2v xij k xij k /2) exp(σ 2ε /2)
= exp(xij k Wk γ + (σ 2v xij k xij k + σ 2ε )/2),
using, for example, xij k vk ∼ N[0, σ 2v xij k xij k ] and E[exp(z)] = exp(μ + σ 2 /2)
for z ∼ N[μ, σ 2 ].
An alternative approach developed by Lee and Nelder (1996) in the context
of the class of generalized linear models, which includes the Poisson-lognormal
and Poisson-gamma as special cases, uses the concept of hierarchical likelihood
or h-likelihood, which involves a particular approximation to the marginal
likelihood. Here one works with the joint density of (vk , ε ij k ) after defining a
new vector of random variables ξ ij k = xij k vk + εij k . Again, given appropriate
independence assumptions, the marginal density is
2 
2 
3 

f (yij k |ξ ij k )f (ξ ij k )dξ ij k
(4.69)
f (y) =
k=1 j =1 i=1

The h-likelihood of Lee and Nelder (1996) corresponding to equation (4.69),


2 
2 
3

f (yij k |ξ ij k )f (ξ ij k )dξ ij k
ln
(4.70)
k=1 j =1 i=1

is approximated by
2 
2 
3

{ln f (yij k |vk , ε ij k ) + ln g(vk |εij k ) + ln h(εij k )}.

(4.71)

k=1 j =1 i=1

In this set-up the random effects vk and εij k considered as if they were additional
parameters, and the numerical integration is thereby avoided.
4.8 FINITE MIXTURES AND LATENT
CLASS ANALYSIS
The formal definition of a finite mixture is given in section 4.2.6. The hurdle and
zero-inflated models can be viewed as two-component finite mixture models,

4.8 Finite Mixtures and Latent Class Analysis

145

but the mixing is of a limited form that focuses on a separate treatment of the
zeros. We now consider general finite mixture models where each component
density may give positive probability to all possible values of the counts and
there may be more than two component densities.
4.8.1

Finite Mixtures

In a finite mixture model a random variable is postulated as a draw from
a superpopulation that is an additive mixture of C distinct populations with
. , fC (y|θ 1 ), in proportions
component (subpopulation) densities f1 (y|θ 1 ), . .
π 1 , . . . , π C , where π j  0, j = 1, . . . , C, and Cj=1 π j = 1. The mixture
density for the i th observation is given by
f (yi |) =

C


π j fj (yi |θ j ).

(4.72)

j =1

In general the π j are unknown and are estimated along with all other parameters, denoted  = (θ 1 , . . . , θ C , π 1 , . . . , π C−1 ). For identifiability, we use
the labeling restriction that π 1 ≥ π 2 ≥ . . . . ≥ π C . This can always be satisfied
by postestimation rearrangement, so this restriction is generally not imposed
in estimation.
The uncentered (or raw) moments of a finite mixture distribution are simply
the weighted sum of the corresponding moments of the component densities:
E[y r ] =

C


π j E[y r |fj (·)],

(4.73)

j =1

where E[y r |fj (·)] denotes the r th uncentered moment given density fj (y)
(Johnson, Kemp, and Kotz, 2005). The central moments of the mixture can
than be derived using standard relations between the raw and central moments.
Note that this result means that mixing will change the conditional mean,
unless E[y] is the same in all component densities, whereas the continuous
heterogeneous mixing of section 4.2.1 did not change the mean.
Finite mixtures of some standard univariate count models are discussed in
Titterington, Smith, and Makov (1985). An attraction of a finite mixture model
is that it can model data that are multimodal. As an example, Figure 4.2 shows
the probability mass function for the univariate mixture of 0.50×P[0.2] +
0.50×P[6], where P[μ] denotes the Poisson with mean μ. The mixture is
multimodal – a common feature of mixtures in which the components are well
separated.
The mixture model has a long history in statistics; see McLachlan and
Basford (1988), Titterington et al. (1985), and Everitt and Hand (1981). For
fixed C the model is essentially a flexible parametric formulation. The constraint

Generalized Count Regression

0

.1

Density
.2

.3

.4

146

0

5
10
X is .5xP[0.2] + .5xP[6.0]

15

Figure 4.2. Two-component mixture of Poissons.

0 < π j < 1 can be imposed by using a multinomial model, with
πj =

exp(λj )
,
C−1
1 + k=1 exp(λk )

j = 1, . . . , C − 1,

(4.74)


and π C = C−1
k=1 π k .
Although there have been many univariate applications, there are also many
applications with regression components; see McLachlan and Peel (2000).
In regression applications the component densities fj (yi |θ j ) = fj (yi |xi , θ j )
depend on regressors. Although in principle the component distributions may
come from different parametric families, in practice it is usual to restrict them
to come from the same families. In the analysis that follows, we consider only
proportions π j that do not vary with regressors. Even then the finite mixture
class offers a flexible way of specifying mixtures. Extension to the case where
the proportions π j may also depend on regressors is deferred to section 4.8.7.
An interesting special case is the random intercept model. For the j th component density let θ j = [θ 1j θ 2 ], where θ 1j is the intercept, which can vary
with j , whereas slope parameters θ 2 are restricted to be the same across components. That is, subpopulations are assumed to differ randomly only with respect
to their location parameter. This is sometimes referred to as a semiparametric
representation of unobserved heterogeneity, because unlike in section 4.2.1,
a parametric assumption about the distribution of unobserved heterogeneity
is avoided. Discrete specifications of heterogeneity is used in Laird (1978),
Lindsay (1983), and Heckman and Singer (1984).
The more general model allows for full heterogeneity by permitting all
parameters in the C components to differ. This case is sometimes referred to as

4.8 Finite Mixtures and Latent Class Analysis

147

a mixture with random effects in the intercept and the slope parameters (Wedel,
DeSarbo, Bult, and Ramaswamy, 1993).
A key advantage of a finite mixture model, rather than a continuous mixing
distribution, is that it provides a natural and intuitively attractive representation
of heterogeneity in a finite, usually small, number of latent classes, each of
which may be regarded as a “type” or a “group”; see section 4.8.2. The choice
of the number of components in the mixture determines the number of “types,”
whereas the choice of the functional form for the density can accommodate
heterogeneity within each component.
The latent class interpretation is not essential, however, and the finite mixture
can always be viewed simply as a way of flexibly and parsimoniously modeling
the data, with each mixture component providing a local approximation to
some part of the true distribution. As such the approach is an alternative to
nonparametric estimation.
Other advantages of using a discrete rather than a continuous mixing distribution include the following. A finite mixture is semiparametric because it does
not require any distributional assumptions for the mixing variable. From the
results of Laird (1978) and Heckman and Singer (1984), finite mixtures may
provide good numerical approximations even if the underlying mixing distribution is continuous. And the commonly used continuous mixing densities
for parametric count models can be restrictive and computationally intractable
except when the conditional (kernel) and mixing densities are from conjugate
families that yield a marginal density with closed functional form. By contrast, there are several practical methods available for estimating finite mixture
models (Böhning, 1995).
4.8.2

Latent Class Analysis

The finite mixture model is related to latent class analysis (Aitkin and Rubin,
1985; Wedel et al., 1993). In practice, the number of latent components has
to be estimated, but initially we assume that the number of components in the
mixture, C, is given.
Let di = (di1 , . . . , diC ) define indicator (dummy) variables such that

1 if yi is drawn from latent class j with density f (yi |θ j )
(4.75)
dij =
0 if yi is not drawn from latent class j,

j = 1, . . . , C, where Cj=1 dij = 1. That is, each observation may be regarded
as a draw from one of the C latent classes or “types,” each with its own
distribution. The classes are called latent classes because they are hidden and
not directly observed.
It follows from (4.75) that yi |di , θ has density
f (yi |di , θ ) =

C

j =1

f (yi |θ j )dij ,

(4.76)

148

Generalized Count Regression

where θ = (θ 1 , . . . , θ C ). The unobserved variables di are assumed to be iid
(over i) with multinomial distribution
g(di |π) =

C


d

π j ij ,

0 < π j < 1,

j =1

C


π j = 1,

(4.77)

j =1

where π  = (π 1 , . . . , π C ). Using f (yi , di ) = f (yi |di )g(di ), (4.76) and (4.77)
imply that
f (yi , di |θ, π ) =

C


d

π j ij fj (y|θ j )dij ,

0 < π j < 1,

j =1

C


π j = 1,

j =1

(4.78)
Hence the complete data likelihood function is
L(θ, π |y, d) =

n 
C


d
π j ij [fj (y|θ j )]dij ,

0 < π j < 1,

i=1 j =1

C


π j = 1.

j =1

(4.79)
The likelihood expression in (4.79) is referred to as the full-data or completedata likelihood because it depends on both the observed data and the latent class
indicators. By contrast, the likelihood based only on observed data is referred
to as the marginal likelihood. Note that for simplicity we have suppressed
dependence on regressors xi in the preceding expressions.
Since dij is unobserved,
it is relevant to also consider the marginal density
of yi . In general f (yi ) = di f (yi , di ), and summing (4.78) over all possible
values of the mutually exclusive indicators di yields
f (yi |xi , θ , π) =

C


π j fj (yi |xi , θ j ),

(4.80)

j =1

where we now introduce regressors xi . This is the C-component mixture density
given in (4.72).
The probability mass function f (dij |yi ) of dij conditional on yi , is also of
interest. This gives the so-called posterior probability that the i th observation
is in class j , denoted zij , with
zij = Pr[observation i belongs to class j |yi ]
= Pr[dij = 1|yi ]
= Pr[dij = 1|yi ]/f (yi )
= π j fj (yi |xi , θ j )/f (yi |xi , θ , π)
π j fj (yi |xi , θ j )
,
= C
j =1 π j fj (yi |xi , θ j )

(4.81)

4.8 Finite Mixtures and Latent Class Analysis

149

where the last equality uses (4.80). The average value of zij over i is the marginal
probability that a randomly chosen individual belongs to subpopulation j .
Given (4.81) this is simply π j , so
E zij = π j .
4.8.3

(4.82)

Nonparametric Maximum Likelihood

An important distinction is made between whether or not the number of components C is known. In the case where C is unknown, C is also a parameter that
needs to be estimated. Let L(π, θ , C |y) denote the likelihood based on (4.72)
with C distinct parametrically specified components. The probability distribution f (yi |θ̂; Ĉ) that maximizes L(π , θ , C|y) is called the semiparametric
maximum likelihood estimator. Lindsay (1995) has discussed its properties.
In some cases C may be given. Then the problem is to maximize
L(π, |C, y). It is easier to handle estimation by maximizing log-likelihood
for a selection of values of C and then using model-selection criteria to choose
among estimated models.
4.8.4

Estimation

A widely recommended procedure for estimating the finite mixture model
is the EM procedure. This seeks to obtain the MLE based on the likelihood
L(θ, π |y, d), with the unobserved variables dij treated as missing data as
follows.
If the dij were observable, from (4.79) the log-likelihood of the model
would be
n 
C

(4.83)
dij ln fj (yi |θ j ) + ln π j ,
L(π, θ |y, d) =
i=1 j =1

where we suppress dependence of fj (·) on regressors xi . Let π̂ and θ̂ be the
current estimates of π and θ . The E-step of the EM algorithm replaces L(π , θ |y)
by its expected value conditional on observed data and π̂ and θ̂. Since (4.83)
is linear in dij , this entails replacing the unobserved dij with its expected value
given yi , π̂, and θ̂. Now E dij |yi = Pr[dij = 1|yi ] = zij . So the expected loglikelihood replaces dij in (4.83) by ẑij equal to zij defined in (4.81) evaluated
at π̂ and θ̂. The resulting expected log-likelihood is
EL(θ , π |y, π̂ , θ̂ ) =

n 
C


ẑij ln fj (yi |θ j ) + ln π j .

(4.84)

i=1 j =1

The M-step of the EM procedure then maximizes (4.84) with respect to π and
θ. This leads to
n
1
ẑij , j = 1, . . . , C,
(4.85)
π̂ j =
n i=1

150

Generalized Count Regression

while θ̂ 1 , . . . , θ̂ C solve the first-order conditions
C 
n


ẑij

j =1 i=1

∂ ln fj (yi |θ j )
= 0.
∂θ j

(4.86)

The algorithm returns to the E-step, recomputing ẑij given the new parameter
estimates π̂ and θ̂, and then to the M-step, re-maximizing (4.84) given the new
ẑij , and so on.
The EM algorithm may be slow to converge, especially if the starting values
are poorly chosen. Other approaches such as the Newton-Raphson or BroydenFletcher-Goldfarb-Shanno may also be worth considering. These work directly
with the original finite mixture density representation (4.72) and maximize with
respect to π and θ the log-likelihood function

L(π , θ |y) =

n


⎛
ln ⎝

i=1

C


⎞
π j fj (yi |θ j )⎠ .

(4.87)

j =1


To ensure 0 < π j < 1 and Cj=1 π j = 1, the reparameterization of π j given
in (4.74) can be used. A discussion of reliable algorithms is in Böhning (1995).
The applications in this section and in Chapter 6 use the Newton-Raphson
algorithm to maximize (4.87).
For C given, the covariance matrix of estimated parameters is obtained by
specializing the results in Chapter 2.3.2. Alternative estimators for the variance,
including the sandwich and robust sandwich estimators, are also available.
However, they should be used with caution, especially if C is likely to be
misspecified.
Finally we note that in the special case of a C−component finite mixture
model with exponential conditional means for each component and only the
intercept varying across the components, the overall conditional mean
E[yi |xi ] =

C


π j exp(δ j + wi γ )

j =1

= exp ln

C

j =1



π j exp(δ j ) + wi γ .

The intercept of the constrained finite mixture involves a weighted combination
of the intercepts, with weights determined by the population proportions. Hence
in the case of Poisson mixtures, the usual Poisson QMLE yields consistent
estimates of the slope parameters γ , though only an estimate of a weighted
component of the intercepts and not the individual components that we need to
estimate subpopulation means.

4.8 Finite Mixtures and Latent Class Analysis

4.8.5

151

Unknown C

If the number of components is unknown, then effectively this is the case of
an unknown mixing distribution. The justification for using a discrete mixing
distribution then follows from Lindsay (1995), who has shown that, provided
the data set has sufficient variation and the likelihoods f (y|θ) are bounded
in θ , a discrete mixing distribution with the number of components (support
points) at most equal to the number of distinct data points in the sample is
observationally equivalent to the true unknown mixing distribution. This result
implies that a potentially difficult problem of nonparametric estimation of a
mixing density can be reduced to an estimation problem in finite dimension.
This still leaves open the question of whether a specified value of C in a
particular application is sufficiently large. We revisit this issue in the context
of an empirical example in Chapter 6.
4.8.6

Inference on C

The preceding account has not dealt with the choice of the parameter C. Two
approaches have been widely considered in the literature.
The first is to use a likelihood ratio test to test whether C = C ∗ versus
C = C ∗ + 1. This is equivalent to the test of H0 : π C ∗ +1 = 0 versus H1 :
π C ∗ +1 = 0. Unfortunately, the likelihood ratio test statistic in this case does not
have the standard chi-square distribution because the regularity conditions for
likelihood-based inference are violated.
For example, let C = 2, and suppose we wish to test
H0 : f (yi |) = P [θ 1 ] ,
where P [θ ] denotes Poisson with mean θ, against
H1 : f (yi |) = (1 − π )P [θ 1 ] + π P [θ 2 ] ,
where  = (π , θ 1 , θ 2 ) ∈ [0, 1] × (0, ∞) × (0, ∞) , with θ 1 = θ 2 . The null
holds not only if π = 0 but also if θ 1 = θ 2 . That is, the parameter space under
H0 is
0 = (π , θ 1 , θ 2 ) ∈ {[0] × (0, ∞) × (0, ∞)} ∪ {[0, 1] × (0, ∞)}.
This is the entire (θ 1 , θ 2 ) space when π = 0, and the line segment π ∈ [0, 1]
when θ 1 = θ 2 . Under the null hypothesis the parameter π is not identifiable
because it is on the boundary of the parameter space. The standard assumption for likelihood-based testing assumes regularity conditions stated in Chapter 2.3. This includes the condition that  is in the interior of parameter space.
Hence the standard asymptotic distribution theory does not apply. As a result,
when testing a model against a more general mixture model with h additional
parameters, the critical values and p-values for the LR test statistic cannot be
obtained from the usual χ 2 (h) distribution.

152

Generalized Count Regression

One solution is to use a parametric bootstrap to obtain the critical values of
the LR test statistic. This bootstrap, where the bootstrap resamples are obtained
by draws from the fitted parametric model under H0 , is detailed in Chapter 6.6.2.
Feng and McCulloch (1996) prove that the MLE in the more general H1 model
converges to the subset of the parameter set with distributions indistinguishable
from those under H0 (i.e., same density values). This should ensure that this
bootstrap will yield an empirical estimate, without asymptotic refinement, of
the distribution of the LR test statistic, though to date there appears to be no
formal proof of this conjecture.
A second solution is to apply the results of Vuong (1989), see Chapter 5.4.2,
that yield a sum of weighted χ 2 (1) distributions for the LR test statistic. Lo,
Mendell, and Rubin (2001) prove that this is applicable in the special case of
mixture of normals with the same variance, though Jeffries (2003) argues that
Lo et al. (2001) make assumptions that are too strong to cover cases of practical
interest.
A third approach is to use information criteria, see Chapter 5.4.1, that
penalize the log-likelihood in models with more parameters. In that case it is
common to first fix the largest value of C one is prepared to accept, often a
small number like two, three, or four. The model is estimated for all values
of C ≤ C ∗ . The model with the smallest BIC or related measure is chosen.
Chapter 6 contains examples and further discussion.
Much of the evidence to support these methods is based on simulation
evidence, primarily for mixture models based on the normal distribution. A
recent example is Nylund, Asparouhov, and Muthén (2007). The consensus
appears to be that bootstrapped critical values do well, and among information
criteria BIC does reasonably well. BIC is often used because it has the advantage
of simplicity and computational speed compared to bootstrapping or using
Vuong’s method.
In an unconstrained model, adding components can easily lead to overparameterization in two senses. The total number of parameters may be large.
Then the number of components may also be too large relative to the information in the data. Because the problem is akin to classification into “types,”
doing so reliably requires that interindividual differences are large in the relevant sense. In the case of a constrained mixture, such as the random intercept
model, the resulting increase in the number of parameters is small, but in the
unconstrained model in which all parameters are allowed to vary, the total
number of parameters can be quite large (see Chapter 6 for an example).
If the model is overparameterized, one can expect difficulties in estimation
due to a flat log-likelihood. This problem is further compounded by the possible
multimodality of the mixture likelihood. Thus it is possible for an estimation
algorithm to converge to a local rather than a global maximum. In practical
applications of finite mixtures, therefore, it is important to test for the presence
of mixture components. If the evidence for mixture is weak, identification is a
problem. It is also important to test whether a global maximum of the likelihood
is attained. These important issues are reconsidered in Chapter 6.

4.8 Finite Mixtures and Latent Class Analysis

4.8.7

153

Extensions

The MLE of finite mixture models is overly influenced by outlying observations.
For example, for count data in the nonregression case, one unusually large count
may lead to a model with an extra component simply to handle this outlier. In
this subsection we present an alternative, more robust estimator than the MLE.
We also consider extension to models where the mixing proportions π j may
vary with regressors.
Minimum Distance Estimators
This chapter has emphasized ML estimation. The recent biometric literature
has proposed alternative, more robust minimum distance estimators for finite
mixture models.
The Hellinger distance criterion has been found attractive because it is less
influenced by outlying observations. For mixture models, it is defined as

D(π, θ ) =

m
k=0



 1/2
pk
−

 
n
1
f (yi = k|xi , θ , π )
i=1
n


1/2 2

(4.88)
where m = max{yi , i = 1, . . . , n}, pk is the fraction of observations with
yi = k, and f (yi |xi , θ , π) is the mixture density defined in (4.72). In general
the squared Hellinger distance between two continuous densities g(y) and f (y)
+ √
2
√
g(y) − f (y) dy. In (4.88), g(y) is the sample density, f (y) =
is 12
1 n
i=1 f (y|xi ), where f (y|xi ) is the specified mixture density, and we have
n
adapted+ to√the discrete case. The squared Hellinger distance can be reexpressed
g(y)f (y), so minimizing D(π, θ ) is equivalent to maximizing
as 1 −
m  1 n
D (π, θ) =
pk
f (yi = k|xi , θ , π )
k=0
i=1
n
∗

1/2

.

This latter representation is used to obtain the estimating equations for θ
and π.
Lu, Hui, and Lee (2003), following Karlis and Xekalaki (1998), who consider the nonregression case, present minimum Hellinger distance estimation
(MHDE) for finite mixtures of Poisson regressions and also a computational
algorithm that has some similarities with the EM algorithm. Xiang, Yau, Van
Hui, and Lee (2008) use MHDE for estimating a k-component Poisson regression with random effects. The attraction of MHDE relative to MLE is that it is
expected to be more robust to the presence of outliers. It is also claimed to do
better when mixture components are not well separated and/or when the model
fit is poor.

154

Generalized Count Regression

Smoothly Varying Mixing Proportions
The mixing proportions 
may depend on observable variables, denoted z. To
ensure 0 ≤ π j ≤ 1, and Cj=1 π j = 1, let
π j (zi , α) =

1+

exp(zi α 1 )

exp(zi α j )
.
+ exp(zi α 2 ) + · · · + exp(zi α C−1 )

Then the finite mixture density is given by
f (yi |xi , zi , θ , α) =

C


π j (zi , α)fj (yi |xi , θ j ).

j =1

The full data likelihood can be written using an expression similar to that in
(4.79). Although this generalization provides obvious additional model flexibility, it can make it more difficult to use a latent class interpretation of the
finite mixture model.
In a multiperiod pooled or population-averaged sample, it may be realistic to
allow for transitions between latent classes. An observation assigned to group
j may transit to another group k. In the macroeconomic literature on business
cycles, where latent classes are often referred to as regimes, this transition is
called regime switching; see Hamilton (1989) and Kim and Nelson (1999).
In time-series analysis of count data (see Chapter 7) observations may be
treated as mixtures of realizations from different regimes, each regime being
characterized by its own probability law. When the transitions between regimes
follow a first-order Markov chain the structure is called a hidden Markov model
(HMM); see MacDonald and Zucchini (1997). In the analysis given earlier, this
imposes a Markovian structure on the dij , the indicator variable for observation
i belonging to class j . The HMM structure can be extended also to panel data;
see Chapter 9.10.1.
4.8.8

Example: Patents

Hausman et al. (1984) consider the relationship between the number of patents
awarded to a firm and current and past research and development (R&D)
expenditures, using a short panel. Here we use the data illustratively. Because
the emphasis of this chapter is on cross-section data, we use only the 1979 data
(the last year of the panel) on 346 firms as in Hall, Griliches, and Hausman
(1986).
Several features of the data indicate that these are difficult data to model.
First, from Table 4.2 even though there is a significant proportion of zeros, the
right tail of the distribution is very long. The overall mean is about 32 and
the maximum is more than 500! Second, there are some very large values that
contribute substantially to overdispersion. These two features in combination
make it difficult to specify a model with a conditional mean and variance that
capture the main features of the data. In that sense the example is pathological.

4.8 Finite Mixtures and Latent Class Analysis

155

Table 4.2. Patents: Frequencies for 1979 data
Count
0
1
2–5 6–20 21–50 51–100 101–300 300–515
Frequency
76
41
74
51
43
30
27
4
Relative frequency 0.220 0.119 0.214 0.147 0.124 0.087
0.078
0.012

The conditional mean is specified as exp(xi β). The regressor of interest
is the logarithm of total research over the current and preceding five years,
ln R&D. Given the logarithmic transformation and the exponential conditional
mean, the coefficient of ln R&D is an elasticity, so that the coefficient should
equal unity if there are constant returns to scale. To control for firm-specific
effects, the estimated model includes two time-invariant regressors: ln SI ZE,
the logarithm of firm book value in 1972, which is a measure of firm size, and
DSCI , which is a sector indicator variable equal to one if the firm is in the
science sector. Therefore, the starting point is the Poisson and NB2 models
presented in section 4.2. The third model is a two-component finite mixture of
NB2, henceforth referred to as FMNB2(2).
Table 4.3 presents ML estimates for three models. It is clear that the basic
Poisson regression will completely fail to provide a reasonable fit to the data,
due to the overdispersion in the data. This is indeed the case, and a negative
binomial model (NB2) leads to the log-likelihood increasing from −3366 to
−1128. For both models the coefficient of ln R&D is statistically significant
but is also statistically significantly less than one. The coefficient varies across
Table 4.3. Patents: Poisson, NB2, and FMNB2(2) models with 1979 data
FMNB2(2)
Variable

Poisson

Intercept

−0.340
(0.190)
0.475
(0.064)
0.271
(0.055)
0.467
(0.155)

ln R&D
ln SIZE
DSCI
α

NB2
−0.811
(0.180)
0.816
(0.083)
0.115
(0.069)
−0.090
(0.138)
0.885
(0.100)

π
Number of parameters
log-likelihood
AIC
BIC

4
−3366
6740
6755

5
−1128
2265
2284

Note: Robust standard errors are given in parentheses.

Component 1

Component 2

−1.274
(0.161)
0.918
(0.063)
0.065
(0.057)
0.103
(0.142)
0.651
(0.080)
0.929
(0.022)
11
−1106
2234
2277

1.516
(0.191)
0.352
(0.090)
0.277
(0.062)
−0.573
(0.346)
0.062
(0.047)

156

Generalized Count Regression

the two models: 0.82 for the NB2 model compared to 0.84 for Poisson (and
compared to 0.49 for the NB1 model which is not reported in the table).
Clearly the magnitude is sensitive to the functional form used. As a basis
for comparison we note that the fixed effect models for panel count data, as
estimated by Hausman et al. (1984) and others, see Chapter 9, yield relatively
low estimates of around 0.6. Also from Chapter 9, other authors using GMM
methods obtain even lower estimates such as 0.3 that are even more strongly
indicative of decreasing returns to scale. These panel applications expand on
the model estimated here by including as six separate regressors the natural
logarithm of R&D expenditures in the current and each of the past five years, and
then calculating the overall elasticity as the sum of the six coefficients. When
we estimate this richer specification here, the coefficients for each lagged year
are noisily estimated, but the sum of the coefficients is close to that for the
ln R&D variable in Table 4.3 and there is little gain in the log-likelihood. It is
difficult to parse out the individual contribution of each year.
The final columns of Table 4.3 report estimates from a two-component
finite mixture of NB2. The first component has slope coefficients similar to
the NB2 model and occurs with probability 0.93. The second component has
slope coefficients similar to the Poisson model and an overdispersion parameter
close to zero. The model fit is improved, with log-likelihood increasing by 22
compared to the NB2 model. Using information criteria presented in Chapter
5.4.1 that penalize for model size, the FMNB2(2) model is preferred to the
more parsimonious NB2 model on the grounds of lower AIC and BIC.
4.9 COUNT MODELS WITH CROSS-SECTIONAL
DEPENDENCE
The assumption of cross-sectionally independent observations was routine in
the early econometric count data literature. Recent theoretical and empirical
work pays greater attention to the possibility of dependence even with crosssection data.
Such dependence is likely to arise whenever data come from a complex
survey, a common source of data for social science research, because complex
surveys are designed to interview individuals in clusters to lower the cost
of sampling. For example, rather than randomly choose individuals from the
population, a set of villages (or census blocks) is randomly chosen; then within
a chosen village (or census block) a set of multiple households is randomly
chosen, and possibly all individuals in a chosen household are interviewed.
This sampling scheme is likely to generate correlation within clusters due to
variation induced by common unobserved cluster-specific factors.
Cross-sectional dependence also arises when the count outcomes have a
spatial dimension, as when the data are drawn from geographical regions. Then
outcomes of units that are spatially contiguous may not be independent of each
other.

4.9 Count Models with Cross-Sectional Dependence

157

It is essential to control for cross-sectional dependence. Estimator standard
errors based on the assumption of independence are likely to be underestimates,
and estimator precision can be greatly overestimated. The intuition in the cluster
case is that observations are usually positively correlated within clusters, so an
additional observation from the same cluster no longer provides a completely
independent piece of new information. Furthermore, it is possible that the mean
outcome for an individual depends on that of other individuals in the sample.
Then the usual conditional mean is no longer correctly specified and the usual
estimators are inconsistent.
The issues for clustered data are qualitatively similar to those detailed in
Chapter 9 for panel data. In that case an observation is an individual-time
pair, and observations may be correlated over time for a given individual. The
treatment here is brief, and Chapter 9 provides considerable additional detail.
The issues for spatial correlation are qualitatively similar to those for time-series
correlation.
4.9.1

Cluster Error Correlation

By cluster error correlation we mean that the conditional mean of the count
is unaffected by other observations, but counts from the same cluster are conditionally correlated. Thus the usual estimators retain their consistency, but
standard errors should be adjusted and more efficient estimation is possible.
Consider a sample falling in C distinct clusters with 
the cth cluster having
nc observations, c = 1, . . . , C, and the sample size n = Cc=1 nc . Let (yic , xic )
denote data for individual i in cluster c. We assume the conditional mean is
unchanged, so
E[yic |yj c , xic , xj c ] = E[yic |xic ] all c, c and i = j.

(4.89)

We assume that observations from the same cluster are correlated, whereas
those in different clusters are uncorrelated. Then
Cov[yic , yj c |xic , xj c ] = 0
Cov[yic , yj c |xic , xj c ] = 0 if c = c .

(4.90)

The simplest correction, and that most common in econometrics applications, is to use a pooled regression that ignores any clustering, but then obtain
cluster-robust standard errors presented
  inc Chapter 2.7. Suppose the estimating
g(yic , xic , θ̂ ) = 0. For example, for
equations conditions for θ̂ are Cc=1 ni=1
the usual Poisson QMLE, gic (·) = (yic − exp(xic β))xic . Then
⎤
 C n
−1 ⎡ C n n
−1
nc
C 
c
c 
c




∂gic
∂gic

⎣
V[θ̂ ] =
gic gj c ⎦
,
∂θ 
∂θ
c=1 i=1
c=1 i=1 j =1
c=1 i=1
(4.91)

158

Generalized Count Regression

and standard errors are obtained by evaluating V[θ̂] at θ = θ̂ . This variance
matrix estimator requires C → ∞, so is appropriate when there are a large
number of clusters.
More efficient estimates can be obtained by specifying a model for the
within-cluster correlation and then estimating the regression using methods
that make use of this model. For specificity, we consider Poisson regression
with exponential conditional mean exp(xic β).
The generalized estimating equations (GEE) method specifies a model for
within-cluster correlation, such as equicorrelation with Cor[yic , yj c |xic , xj c ] =
ρσ ic σ j c , where σ 2ic = Var[yic |xic ]. The GEE estimator uses pooled Poisson
regression to obtain consistent but inefficient estimate β̂, uses this to obtain
estimate ρ̂ (and estimates of any additional parameters determining σ 2ic ), and
then efficiently estimates β by feasible nonlinear GLS. Standard errors can then
be obtained that are robust to misspecification of the model for Cor[yic , yj c ].
Chapters 2.4.6 and 9.3.2 detail GEE estimation.
A random intercept model assumes
E[yic |xic , α c ] = exp(α c + α + xic β)
= δ c exp(α +

(4.92)

xic β),

where α c is iid [0, σ 2α ] and hence δ c = exp(α c ) is iid [1, σ 2δ ]. A distribution
for δ c is specified, and estimation is by MLE. If δ c is one-parameter gamma
distributed, then there is a closed-form expression for the likelihood function
(unconditional on δ c ) and ML estimation is straightforward. If instead α c is normally distributed, so δ c is lognormal, then ML estimation requires computation
of a one-dimensional integral. See sections 9.5.1 and 9.5.2 for further details.
A random parameters model additionally allows for the slope parameters
to vary across clusters. Then β in (4.92) is replaced by β c ∼ N[β, β ], and
estimation is by MLE. This is a special case of a hierarchical model presented
in section 4.7. Note that in this model the conditional mean is no longer
E[yic |xic ] = exp(α + xic β); see Chapter 9.5.3.
Demidenko (2007) compares these various approaches for the Poisson
regression model.
4.9.2

Spatial Error Correlation

By spatial error correlation we mean that the conditional mean of the count is
unaffected by other observations, but different observations are conditionally
spatially correlated. This is similar to the cluster case, except here the correlation
is determined by the spatial distance between observations, rather than whether
or not they belong to the same cluster.
We still maintain correct specification of the conditional mean, so
E[yi |yj , xi , xj ] = E[yi |xi ]. Spatial correlation means that
Cov[yi , yj |xi , xj ] = wij σ i σ j ,

0 ≤ wij ≤ 1,

(4.93)

4.9 Count Models with Cross-Sectional Dependence

159

where σ 2i = V[yi |xi ] and wij is a function of the spatial distance between
observations i and j . For example, if data are from different regions then the
spatial distance is the distance between the regions. We specify wij = 1 when
i = j and require that wij → 0 as the spatial distance between i and j becomes
large.

Then for pooled estimator θ̂ solving ni=1 g(yi , xi , θ̂ ) = 0, we have
⎤
 n
−1
−1 ⎡ n n
n
 ∂gi


∂gi
⎦
⎣
V[θ̂] =
wij gi gj
,
∂θ 
∂θ
i=1
i=1 j =1
i=1

(4.94)

and standard errors are obtained by evaluating V[θ̂] at θ = θ̂ .
Mechanically the variance matrix (4.91) with clustering is the special case
of (4.94) where wij equals one if observations i and j are in the same cluster,
and wij equals zero otherwise. But the asymptotic theory is quite different. The
cluster case requires independence across clusters and C → ∞. The spatial
case requires dampening in wij analogous to dampening time series correlation
as n → ∞; see Conley (1999).
More efficient estimation is possible by specifying a functional form for wij
and estimating by nonlinear feasible GLS. For example, negative exponential
distance decay specifies wij = exp(−γ dij ) for i = j , where dij is the distance
between observations i and j .
4.9.3

Cluster-Specific Fixed Effects

We now relax the assumption that the conditional mean is unaffected by clustering.
The cluster-specific fixed effects model allows the conditional mean to
depend in part on the other observations in the cluster. The model specifies
E[yic |x1c , . . . , xnc ,c , α c ] = α c exp(xic β).

(4.95)

The cluster-specific effect α c may be correlated with xic , unlike the random
intercept model (4.92). As a result, pooled Poisson regression of yic on xic will
lead to inconsistent parameter estimates. An alternative estimator is needed.
In Chapter 9.4.1 it is shown that (4.95) implies
E[(yic − (λic /λ̄c )ȳc )|x1c , . . . , xnc ,c , α c ] = 0,


(4.96)


where ȳc = n1c i λic , λic = exp(xic β), and λ̄c = n1c i λic . The expression
(4.96) has eliminated α i . The Poisson cluster-specific fixed effects estimator of
β solves the corresponding sample moment conditions

ȳc
xic yic − λic
λ̄
c
i=1

nc
C 

c=1

= 0.

(4.97)

160

Generalized Count Regression

It is shown in Chapter 9.4.2 that equivalently one can perform regular pooled
Poisson regression of yic on xic and a set of mutually exclusive cluster-specific
dummy variables.
Expression (4.96) implies

ȳc
exp(xic β),
E[yic |x1c , . . . , xnc ,c ] =
λ̄c
so we can view the other observations in the cluster as changing the conditional
mean by the multiple ȳc /λ̄c .
4.9.4

Spatial Lag Dependence

Spatial lag models permit the conditional mean for a given observation to
depend on the outcomes of other observations. The term “spatial lag” is used
by analogy to time-series lag dependence, where yt depends on yt−1 .
Griffith and Haining (2006) survey the early literature on spatial Poisson
regression and a number of its modern extensions. For simplicity we consider
the pure spatial case where there are no exogenous regressors.
Besag (1974) defined a general class of “auto-models” suitable for different
types of spatially correlated data. Let Ni denote the set of observations in the
neighborhood of i (not including i itself) that determine, in part, yi . The “autoPoisson” model specifies yi as being Poisson distributed with mean μi that
depends on observations yj in the neighborhood of i. Thus
f (yi |yj , j ∈ Ni ) =

y

e−μi μi i
yi !

μi = exp α i +


β
y
j ∈Ni ij j ,



(4.98)

where the parameter α i is an area-specific effect, and β ij = β j i . The standard
set-up specifies β ij = γ wij , where γ is a spatial autoregressive parameter, wij
(= 0 or 1) represents the neighborhood structure, and wii = 0.
 The difficulty with this auto-Poisson model is that the restriction
i f (yi |yj , j ∈ Ni ) = 1 implies γ ≤ 0, which permits only negative spatial correlation. The spatial count literature has evolved in different directions
to overcome this difficulty; see Kaiser and Cressie (1997) and Griffith and
Haining (2006). One line of development uses spatial weighting dependent on
assumptions about the spatial dependence structure.
An alternative approach is based on a Poisson model with a mixture specification. The conditional mean function in (4.98) is defined as
μi = exp(α i + Si ),

(4.99)

where Si is a random effect defined by a conditional spatial autoregressive
model. For example,
Si ∼ N[0, σ 2 (In − τ W)−1 ],

(4.100)

4.10 Models Based on Waiting Time Distributions

161

where the spatial weighting matrix W has ij th entry equal to the spatial weight
wij . This model can capture negative or positive dependence between outcomes
through the spatial autoregressive parameter τ . The resulting model is essentially a Poisson mixture model with a particular dependence structure. ML estimation of this mixture specification will typically require simulation because
the likelihood cannot be expressed in a closed form. Griffith and Haining (2006)
suggest Bayesian Markov chain Monte Carlo methods; they compare the performance of several alternative estimators for the Poisson regression applied to
georeferenced data.
Note that spatial random effect models such as (4.99) and (4.100) actually
change the conditional mean so that it depends on values of other y  s in the
neighborhood of observation i. It is easiest to see this by analogy to the linear
times-series model with an AR(1) error. Then yt = xt β + ut with ut = ρut−1 +
εt and εt iid with mean zero implies
E[yt |yt−1 , xt , xt−1 ] = ρyt−1 + xt β − ρxt−1 β,
so the conditional mean is no longer simply xt β.
4.10 MODELS BASED ON WAITING TIME
DISTRIBUTIONS
Chapter 1.1.3 studied the duality between waiting time distributions and event
count distributions in the simple case of a Poisson process for which the
waiting times between each event occurrence are independent. Then durations
are exponentially distributed and counts are Poisson distributed. We pursue this
issue in greater detail here, when richer models for the waiting time distributions
are specified, leading to alternative models for the counts.
4.10.1

True versus Apparent Contagion

The main thrust of this chapter has been to presume an underlying count model
arising from a Poisson process, with departures from the Poisson arising due to
unobserved heterogeneity that leads to overdispersion. An alternative reason for
departures from the Poisson, raised in section 4.2.3 for the negative binomial,
is that there is dependence between each occurrence of the event.
Such discussion of heterogeneity and overdispersion is related to a longstanding discussion in the biostatistics literature on the important distinction
between true contagion and apparent contagion. True contagion refers to dependence between the occurrence of successive events. The occurrence of an event,
such as an accident or illness, may change the probability of the subsequent
occurrence of similar events. True positive contagion implies that the occurrence of an event shortens the expected waiting time to the next occurrence of
the event, whereas true negative contagion implies that the expected waiting
time to the next occurrence of the event is longer. Apparent contagion or spurious contagion arises when there is no dependence between the occurrence

162

Generalized Count Regression

of successive events, but different individuals have different propensities to
experience the event, so that when we aggregate over individuals it appears
that experiencing an event once makes it more likely that the event will happen
again. For example, it may appear in analyzing aggregated data that experiencing an accident once makes it more likely that an accident is more likely to
happen again, when in fact the true explanation is one of unobserved heterogeneity – some people are prone to accidents, whereas others are not. Rather
than true contagion the contagion is spurious.
Another mode of dynamic dependence is present in the notion that events
occur in “spells” that themselves occur independently according to some probability law. Events within a given spell follow a different probability law and
may be dependent.
The discussion of accident proneness of individuals in the early statistical
literature emphasized the difficulty of distinguishing between true accident
proneness and effects of interindividual heterogeneity. In reference to Neyman
(1939), Feller (1943) pointed out that the same negative binomial model had
been derived by Greenwood and Yule (1920), using the assumption of population heterogeneity and by Eggenberger and Polya (1923), who assumed true
contagion. He observed, “Therefore, the possibility of its interpretation in two
ways, diametrically opposite in their nature as well as their implications is of
greatest statistical significance” (Feller, 1943, p. 389). Neyman (1965, p. 6)
emphasized that the distinction between true and apparent contagion would
become possible “if one has at one’s disposal data on accidents incurred by
each individual separately for two periods of six months each”; clearly this
refers to longitudinal data. These issues are further pursued in Chapter 9.
4.10.2

Renewal Process

Renewal theory deals with functions of iid nonnegative random variables that
represent time intervals between successive events (renewals). The topic was
introduced in Chapter 1.1.3.
A renewal process is the sequence Wk , where Wk denotes the length of time
between the occurrences of events (k − 1) and k. Denote the sum of waiting
times for r events
Sr =

r


Wk ,

r ≥ 1.

(4.101)

k=1

The cdf of Sr , denoted Fr (t) = Pr[Sr ≤ t], gives the probability that the cumulative waiting time for r events to occur or, equivalently, the arrival time of the
r th event is less than t.
The associated counting process, {N (t), t ≥ 0}, measures the successive
occurrences of an event in the time interval (0, t]. Renewal theory derives
properties of random variables associated with the number of events, N (t), or
associated with the waiting times, Sr , for a given specification of the distribution
of the waiting times.

4.10 Models Based on Waiting Time Distributions

163

Given these definitions, N (t) < r if and only if Sr > t . It follows that the
cdf of the number of events to time t is
Pr[N(t) < r] = Pr[Sr > t]
= 1 − Fr (t),

(4.102)

and the probability mass function of N(t) is
Pr[N(t) = r] = Pr[N (t) < r + 1] − Pr[N (t) < r]
= (1 − Fr+1 (t)) − (1 − Fr (t))
= Fr (t) − Fr+1 (t),

(4.103)

which is the fundamental relation between the distribution of waiting times
and that of event counts. This relation may form the basis of a count model
corresponding to an arbitrary waiting time model.
From (4.103) it follows that the mean number of occurrences in the interval
(0, t], called the renewal function, is
m(t) = E [N (t)]
=

∞


r [Fr (t) − Fr+1 (t)]

r=1

=

∞


Fr (t).

(4.104)

r=1

The variance of the number of occurrences in the interval (0, t] is
∞
2
∞


2
r [Fr (t) − Fr+1 (t)] −
Fr (t) .
V [N (t)] =
r=1

4.10.3

(4.105)

r=1

Waiting-Time Models for Counts

Let yi denote the number of event occurrences for individual i in the interval (0, t]. Conditioning on exogenous variables xi , (4.103) implies that the
likelihood for n independent observations is defined by
L=

n

i=1

Fyi (t|xi ) − Fyi +1 (t|xi ) .

(4.106)


Recall that Fr (t) is the cdf of Sr = rk=1 Wk . The practical utility of (4.106)
depends in part on whether the cdf of Sr can be easily evaluated. In the special
case that the waiting times Wk are iid exponential distributed with mean 1/μ,
with density given in Chapter 1.1.3 and correspondSr has gamma
distribution
−μt tj
μ /j ! It follows that Fr (t) − Fr+1 (t) = e−μt μtr /r! so
ing cdf 1 − r−1
k=1 e
setting t = 1 the term in brackets in (4.106) is simply the Poisson probability
of r = yi events with Poisson with mean equal to μ(xi ).

164

Generalized Count Regression

A broad class of parametric models for the waiting times Wk for individual
i, denoted ti , can be generated by the regression
ln ti = xi β + αεi

(4.107)

with the specified distribution of ε i . If ε i is iid extreme value distributed with
density f (ε) = eε exp(−eε ) and α = 1, then by a change of variable it can be
shown that t is exponentially distributed with mean exp(x β). As already noted
after (4.106), exponentially distributed waiting times lead to a Poisson model
for yi counts, with the mean in this case of exp(−x β).
If more generally α > 0 is unspecified in (4.107), while εi is again extreme
value distributed, then the waiting times are Weibull distributed. In this case,
there is no closed-form expression for the distribution of counts. However,
McShane, Adrian, Bradlow, and Fader (2008) have proposed a generalized
model for count data based on an assumed Weibull interarrival process. The
Poisson and negative binomial models are special cases of this generalized
model. To overcome the computational intractability, the authors derive the
Weibull count model, using a polynomial expansion, with integration being
carried out on a term-by-term basis. This leads to a computationally tractable
regression model for count data that accommodates either overdispersion or
underdispersion.
Lee (1997) proposed a model with k th weighting time Wk for individual i
generated by
ln tki = xi β + ε ki − ui ,

(4.108)

where the ε ki are iid extreme value distributed, while ui is a common
shock across all spells for individual i that is a log-gamma random variable.
Specifically, v = u − ln α has density f (v) = exp v/α − exp(v) / (1/α)
(Kalbfleisch and Prentice, 1980). This choice leads to an NB2 count model
with mean exp(−x β) and overdispersion parameter α (Lee, 1997). Essentially
conditional on ui , the waiting times tki are exponential, leading to Poisson for
the cumulative waiting time yi , and then integrating out log-gamma ui leads to
NB2 for yi .
Even when no closed-form expression for the cdf Fr (t) is available,
computer-intensive methods could be used as suggested by Lee (1997). Furthermore, the approach can be extended to generalized renewal processes. For
example, we may allow the waiting time distribution of the first event to differ
from that of subsequent events (Ross, 1996) – a case analogous to the hurdle
count model.
4.10.4

Gamma Waiting Times

As an example of generating a count model from a richer waiting time model
than the exponential, we present a model due to Winkelmann (1995).

4.10 Models Based on Waiting Time Distributions

165

Winkelmann (1995) considered gamma-distributed waiting times. Then the
density of W is given by
f (W |φ, α) =

αφ
W φ−1 e−αW ,
(φ)

W > 0.

(4.109)

This gamma distribution with shape parameter φ and scale parameter 1/α has
mean φ/α and variance φ/α 2 . It is a generalization of the exponential, the
special case φ = 1.
The hazard function gives the conditional instantaneous probability of the
event occurring at time t, given that it has not yet occurred by time t. A
benchmark is a constant hazard, the case for the exponential. For the density in
(4.109), the hazard function is
h(W ) =

f (W )
1 − F (W )

(α φ / (φ))W φ−1 e−αW
= +∞ φ
φ−1 e−αv dv
W (α / (φ))v
+∞
= W e−α(v−W ) (v/W )φ−1 du
+∞
= 0 e−αu (1 + u/W )φ−1 du

−1
−1

,

by change of variables u = v − W . The hazard function does not have a closedform expression. But it can be shown to be monotonically increasing in W for
φ > 1, constant (and equal to α) when φ = 1, and monotonically decreasing
for φ < 1. A decreasing hazard, for example, implies negative duration dependence, with the spell less likely to end the longer it lasts. An attraction of the
gamma specification is that we can determine positive or negative dependence
according to whether φ > 1 or φ < 1.
The distribution of Sr is the sum of r iid waiting times, each with density
f (W |φ, α) given in (4.109). In section 4.12, it is shown that Sr is also gamma
distributed, with parameters rφ and α. So the density fr (t) of Sr is
fr (t|φ, α) =

α rφ rφ−1 −αt
e ,
t
(rφ)

(4.110)

and the corresponding cdf Fr (t) = Pr[Sr ≤ t] is


t

α rφ rφ−1 −αs
e ds
s
0 (rφ)
 αt
1
=
u(rφ)−1 e−u du
(rφ) 0

Fr (t|φ, α) =

≡ G(rφ, αt),

(4.111)

166

Generalized Count Regression

where the second equality uses the change of variable to u = αs. The integral is
an incomplete gamma integral that can be numerically evaluated, and G(rφ, αt)
is the incomplete gamma ratio. Using (4.103) and normalizing t = 1, it follows
that the gamma waiting time distribution model implies count distribution
Pr[N = r] = G(rφ, α) − G(rφ + φ, α)

for r = 0, 1, 2, . . . , (4.112)

where G(0, α) = 1. The MLE is obtained by substituting (4.112) into the likelihood function (4.106), where each term in the likelihood involves two incomplete gamma integrals that can be evaluated numerically.
Result (4.112) simplifies to the Poisson with mean α if φ = 1, as expected
since then the waiting times are exponential distributed. But the model allows
for positive duration dependence if φ > 1 and negative duration dependence if
φ < 1 (Winkelmann, 1995). For any α > 0, it can be shown that φ > 1 leads
to underdispersion and φ < 1 to overdispersion.
4.10.5

Dependence and Dispersion

This relationship between duration dependence and count dispersion is not
specific to gamma waiting times. It applies whenever the waiting time hazard
function is monotonic in time.
Let W denote the waiting time distribution for one spell and N (t) denote
the number of events in the interval (0, t]. Cox (1962b, p. 40) shows that
W ∼ [μw , σ 2w ]
a

⇒ N (t) ∼ N[t/μw , tσ 2w /μ3w ],

(4.113)

where the approximation is good if E[W ] is small relative to t.
The coefficient of variation (CV) for the waiting time distribution is
σw
CV =
.
(4.114)
μw
For waiting time distributions with monotonic hazards, it can be shown (Barlow
and Proschan, 1965, p. 33) that
CV < 1 ⇒ increasing duration dependence
CV > 1 ⇒ decreasing duration dependence.
a

In the borderline case that CV= 1, σ 2w /μ2w = 1 so (4.113) simplifies to N (t) ∼
N[t/μw , t/μw ] and the count is equidispersed. If CV < 1 then V[N (t)] < t/μw
and the count is underdispersed. Thus
CV < 1 ⇒ underdispersion
CV > 1 ⇒ overdispersion.
Thus overdispersion (or underdispersion or equidispersion) in count models is
consistent with negative- (or positive- or zero-) duration dependence of waiting
times. The intuition is that with negative dependence a spell is less likely to
end the longer the spell lasts, so the number of event occurrences will not be
very dispersed.

4.11 Katz, Double Poisson, and Generalized Poisson

167

Although this result provides a valuable connection between models of
counts and durations, the usefulness of the result for interpreting estimated
count models depends on whether the underlying assumption of monotone
hazards and the absence of other types of model misspecification is realistic.
4.10.6

Clustering and Dispersion

In this section we have assumed that event occurrences are independent, with
any dependence introduced via the waiting time distribution for each spell. An
alternative approach is to directly model the probabilities of each occurrence
of the event as being correlated.
Consider the binomial-stopped-by Poisson characterization, introduced in
Chapter 1.1.4, but relax the independence assumption to allow
 the sequence of
binary outcome variables to be correlated. The count is Y = ni=1 Bi , where Bi
is a binary 0/1 random variable that takes the value 1 with probability π if the
event occurs. The correlated binomial model, denoted CB[n, π , ρ], assumes
that the pairs (Bi , Bj ), i = j, have covariance ρπ (1 − π ), 0 ≤ ρ < 1, so all
pairs have constant correlation ρ (Dean, 1992; Luceño, 1995).
Assuming a random number of events n → ∞ in a given period and π → 0
while nπ = μ, the CB[n, π , ρ] model generates the correlated Poisson model,
denoted CP[μ(1 − ρ), (1 − ρ)(μ + ρμ2 )], where the arguments are, respectively, the mean and the variance of the CP model. Note that the variance-mean
ratio in this case has the same form as the NB2 model, with ρ replacing the
parameter α. Clearly, clumping or correlation of events can generate overdispersion. This phenomenon is of potential interest in time-series count models.
Luceño (1995) noted some limitations of this correlated Poisson model. He
proposed a generalized partially correlated Poisson model that assumes events
occur in clusters. These clusters are independent of each other, though within
each cluster there is dependence due to a correlated binomial model induced
by clusters, and the number of clusters N → ∞ while N π is constant.
4.11 KATZ, DOUBLE POISSON, AND GENERALIZED
POISSON
Multiplicative mixtures lead to overdispersion. However, sometimes it is not
evident that overdispersion is present in the data. It is then of interest to consider
models that have variance functions flexible enough to cover both over- and
underdispersion. In this section we consider several nonmixture models that
have this property. Additional cross-sectional models with a similar underlying
motivation are discussed in Chapter 11.
4.11.1

The Katz System

Some extensions of the Poisson model that can permit both over- and underdispersion can be obtained by introducing a variance function with additional
parameters.

168

Generalized Count Regression

For the overdispersed case Cameron and Trivedi (1986) suggested the variance function
V[y|x] = E[y|x] + α(E[y|x])2−p ,

α > 0.

(4.115)

This specializes to that for the Poisson, NB1, and NB2 for p = 2, 1, and 0,
respectively.
To cover overdispersion as well as underdispersion, Winkelmann and Zimmermann (1991), following King (1989b), reparameterized this variance function as


V[y|x] = E[y|x] + σ 2 − 1 (E[y|x])k+1 ,

σ 2 > 1,

(4.116)

where −p = k − 1 and α = σ 2 − 1. The restriction σ 2 − 1 = 0 yields the
Poisson case, and σ 2 > 0 implies overdispersion. Underdispersion arises if
0 < σ 2 < 1 and additionally (E[y|x])k ≤ 1/(1 − σ 2 ).
The variance specification (4.116) arises if the distribution of y is in the
Katz family of distributions. Katz (1963) studied the system of distributions
for nonnegative integer-valued random variables defined by the probability
recursion
Pr[y + 1] = Pr [y]

ω + γy
,
1+y

ω + γ y ≥ 0, μ > 0, γ < 1,

(4.117)

which has mean μ = ω/ (1 − γ ) and variance ω/(1 − γ )2 . Special cases
include the Poisson (γ = 0) and the negative binomial (0 < γ < 1). Setting
ω/ (1 − γ ) = μ and the Katz family variance ω/(1 − γ )2 equal to the righthand side of (4.116) and solving for (ω, γ ) as a function of (σ 2 , μ) yields
 2

σ − 1 μk

;
γ = 2
σ − 1 μk + 1

ω= 

σ2

μ

.
− 1 μk + 1

Substituting these back into (4.116) and solving for the pdf of y yields the
so-called generalized event count (GEC[k]) density (Winkelmann and Zimmermann, 1995).
King (1989b) originally proposed this model in the special case that k = 1,
in which case dispersion is of the NB1 form. Winkelmann and Zimmermann
(1991) considered the more general case and proposed treating k as an unknown
parameter. The likelihood is based on the probabilities given by the recursion
(4.117). The MLE maximizes the log-likelihood with respect to β, σ 2 , and
k, where as usual E[y|x] = exp(x β). In the underdispersed case the Katz
distribution restricts y to be less than the integer immediately greater than
μ1−k /(1 − σ 2 ), or less than μ1−k /(1 − σ 2 ) if μ1−k /(1 − σ 2 ) is an integer. This
is a departure from the ML regularity conditions in that the range of y does not
depend on parameters.

4.11 Katz, Double Poisson, and Generalized Poisson

4.11.2

169

Double Poisson Model

Overdispersion is far more common than underdispersion. However, there are
examples of underdispersion in empirical work, and there is a role for models
specifically for underdispersed counts or those that are flexible enough to capture this phenomenon; see Ridout and Besbeas (2004). Efron’s (1986) double
Poisson model is an example of such a model.
The double Poisson distribution was proposed by Efron (1986) within the
context of the double exponential family. This distribution is obtained as an
exponential combination of two Poisson distributions, y ∼ P[μ] and y ∼ P[y].
Then

−μ y φ
μ
e−y y y 1−φ
1/2 e
,
(4.118)
f (y, μ, φ) = K(μ, φ)φ
y!
y!
where K(μ, φ) is a normalizing constant that ensures f (·) sums to 1, with

1
1−φ
1
1+
1+
.
K(μ, φ)
12φμ
φμ
On some rearrangement of (4.118), the double Poisson density is
 −y y 
e y
eμ
f (y, μ, φ) = K(μ, φ)φ 1/2 exp(−φμ) exp
y!
y

φy

.
(4.119)

This distribution has mean value approximately μ and variance approximately
μ/φ (Efron 1986, p. 715). The parameter μ is similar to the Poisson mean
parameter, whereas φ is a dispersion parameter. The double Poisson model
allows for overdispersion (φ < 1), as well as underdispersion (φ > 1), and
reduces to the Poisson if φ = 1. Another advantage of the double Poisson
regression model is that both the mean and the dispersion parameters may
depend on observed explanatory variables. Thus, it is possible to model the
mean and dispersion structure separately, as is sometimes done for a heteroskedastic normal linear regression model and for exponential dispersion
models considered by Jorgensen (1987).
Efron (1986) shows that the constant K(μ, φ) in (4.119) nearly equals
1. Because it is a source of significant nonlinearity, the approximate density
obtained by suppressing it is used in approximate maximum likelihood estimation. Ignoring the term K(μ, φ), ln f (y, μ, φ) in (4.119) equals −φμ + φy ln μ
plus terms not involving μ. Letting μi = exp(xi β), the ML first-order conditions for β are
n

(yi − μi ) ∂μi
= 0.
(μi /φ i ) ∂β 
i=1

(4.120)

If φ i = φ is a constant then (4.120) yields the usual Poisson QMLE. Furthermore, in that case the ML estimate of φ is simply the average value of the

170

Generalized Count Regression

deviance measure,

{yi ln yi /μ̂i − (yi − μ̂i )}.
φ̂ = n−1

(4.121)

Because the estimating equations for β are the same as in the Poisson case, the
Poisson QMLE is consistent even if the dgp is double Poisson. A simple way
of adjusting its default variance is to scale the estimated variance matrix by
multiplying by 1/φ̂. However, to calculate the event probabilities the expression
in (4.119) should be used.
4.11.3

Neyman’s Contagious Distributions

Neyman (1939) developed his type A distribution, as well as generalizations to
type B and type C distributions, to handle a form of clustering that is common
in the biological sciences.
These distributions can be thought of as compound Poisson distributions
that involve two processes. For example, suppose that the number of events
(e.g., doctor visits) within a spell (of illness), denoted y, follows the Poisson
distribution, and the random number of spells within a specified period, denoted
z, follows some other discrete distribution. Then the marginal distribution of
events is compound Poisson.
One variant of the Neyman type A with two parameters is obtained when
y ∼ P[φz] and independently z ∼ P[λ]. Then

Pr[y = k] = ∞
j =1 Pr[y = k|z = j ] Pr[z = j ]
∞ e−φz (φz)k
−λ j
= j =1 k! × e j !λ .
Johnson, Kemp, and Kotz (2005) give an excellent account of the properties
of Neyman type A and further references. In univariate cases Neyman type A
and negative binomial are close competitors. There are few regression applications of Neyman type A. A notable exception is Dobbie and Welsh (2001),
who apply the model to counts of a particular animal at 151 different sites.
4.11.4

Consul’s Generalized Poisson

Consul (1989) has proposed a distribution that can accommodate both over and
underdisperion. The distribution is
⎧
⎨ exp(−μ − γ y) × (μ + γ y)y−1
, y = 0, 1, . . . ,
f (yi |xi ) =
y!
⎩
0 for y > N , when γ < 0,
(4.122)
where max(−1, −μ/N) < γ ≤ 1 and N is the largest positive integer that
satisfies the inequality μ + N γ > 0 if μ is large. For this distribution
E[y] = μ(1 − γ )−1 and V[y] = μ(1 − γ )−3 . The distribution is underdispersed if max(−1, −μ/N) < γ ≤ 0, equidispersed if γ = 0, and overdispersed
if 0 < γ < 1.

4.12 Derivations

171

This model does not appear to have been used much in regression contexts.
Because for this distribution the range of the random variable depends on the
unknown parameter γ , it violates one of the standard conditions for consistency
and asymptotic normality of the maximum likelihood estimation.
4.12 DERIVATIONS
4.12.1

Two Crossings Theorem

We sketch a proof of the Two Crossings Theorem, following Shaked (1980).
We consider just a one-parameter exponential family, but it nonetheless covers
many distributions including the Poisson.
For the random variable y, y ∈ Ry , let f (y|θ ) = exp{a(θ) + c(θ )y} denote
the exponential family density.
+ We suppose θ is random with nondegenerate
density π (θ ) and mean τ = θ π (θ)dθ . This leads to mixture density,

h(y) = exp{a(θ ) + c(θ )y}π (θ)dθ .
Ignoring overdispersion, we instead use the original density evaluated at
τ = E[θ ]
f (y) ≡ f (y|τ ) = exp{a(τ ) + c(τ )y}.
The Two Crossings Theorem studies the sign pattern of h(y) − f (y),
assuming that the parent and the mixture distributions have the same mean;
that is,


yf (y|τ )dy = yh(y)dy.
(4.123)
Let S − (h − f ) denote the number of sign changes in h − y over the set
Ry . The number of sign changes of h − f is the same as the number of sign
changes of the function
h(y)
−1
f (y)

= exp {(a(θ ) − a(τ )) + (c(θ ) − c(τ )) y } π (θ)dθ − 1.

r(y) =

Because r(y) is convex on the set Ry it must be that S − (h − f ) ≤ 2. Obviously
S − (h − f ) = 0.
−
To show that S − (h − f ) = 1, assume, on the contrary
+ y that S (h − f ) = 1.
If the sign sequence is {+, −} then the cdfs H (y) = −∞ h(x)dx and F (y) =
+y
−∞ f (x)dx satisfy H (y) ≥ F (y) for all y. This result, together with h = f ,
implies


yh(y)dy < yf (y)dy,

172

Generalized Count Regression

which contradicts assumption (4.123) of equal means. Similarly if the sequence
is { −, +}, (4.123) is also contradicted. Thus S − (h − f ) = 1 and hence S − (h −
f ) = 2. The sign sequence {+, −, +} follows from the convexity of r(y).
This proof considers heterogeneity in the canonical parameters θ. This is
equivalent to heterogeneity in μ, because there is a one-to-one correspondence
between μ and θ , which in turn is equivalent to heterogeneity in μv, where μ
is fixed and ν is random independent of μ.
4.12.2

Mean and Variance for Modified Count Models

We derive general expressions for the mean and variance for left truncation at
zero, hurdle models, and zero-inflated models.
Consider the count random variable with density f (y). The density given
left truncation at zero is f (y)/[1 − f (0)], using Pr[y > 0] = 1 − f (0), with
k th uncentered moment

k f (y)
E[y k |y > 0] = ∞
y=1 y 1−f (0)

k
= 1−f1 (0) ∞
y=0 y f (y)
= 1−f1 (0) E[y k ],

∞ k
k
k
using ∞
y=1 y f (y) =
y=0 y f (y) since 0 × f (0) = 0. The result (4.29)
follows immediately for the truncated mean, whereas for the truncated variance
V[y|y > 0] = E[y 2 |y > 0] − (E[y|y > 0])2
2
= 1−f1 (0) E[y 2 ] − 1−f1 (0) E[y]
=
=

1
(V[y] + (E[y])2 ) − 1−f1 (0)
1−f (0)
f (0)
1
V[y] − (1−f
(E[y])2 .
1−f (0)
(0))2

2

(E[y])2

For the hurdle model with density given in (4.48), the k th uncentered moment
is


k 1−f1 (0)
E[y k ] = 0k × f (0) + ∞
y=1 y 1−f2 (0) f2 (y)
∞ k
1 (0)
= 1−f
y=0 y f2 (y)
1−f2 (0)
=

1−f1 (0)
E [y k ],
1−f2 (0) 2

where E2 [y k ] denotes expectation with respect to f2 (y). The mean given in
(4.50) follows immediately. For the variance given in (4.51),
V[y] = E[y 2 ] − (E[y])2
=
=
=

1−f1 (0)
E [y 2 ]
1−f2 (0) 2

−

2

1−f1 (0)
E [y]
1−f2 (0) 2

2
1−f1 (0)
1−f1 (0)
2
(V
[y]
+
(E
[y])
)
−
(E2 [y])2
2
2
1−f2 (0)
1−f2 (0)
1−f1 (0)
1 (0)−f2 (0))
V [y] + (1−f1 (0))(f
(E2 [y])2 .
1−f2 (0) 2
(1−f2 (0))2

4.12 Derivations

173

For the zero-inflated model with density given in (4.56), the k th uncentered
moment is
E[y k ] = 0 × [π + (1 − π)f2 (0)] +

f
= (1 − π) ∞
y=0 y2 k(y)

∞
y=1

y k (1 − π )f2 (y)

= (1 − π )E2 [y k ].
The result (4.57) follows immediately for the zero-inflated mean, whereas for
the corresponding variance given in (4.58)
V[y] = E[y 2 |y > 0] − (E[y|y > 0])2
= (1 − π)E[y 2 ] − ((1 − π)E[y])2
= (1 − π)(V[y] + (E[y])2 ) − (1 − π)2 (E[y])2
= (1 − π)V[y] + π(1 − π)(E[y])2 .
4.12.3

Distribution of Sum of Waiting Times

We use the Laplace transform, the analog for nonnegative random variables
of the moment generating function. The density f (W ) defined in (4.109) has
Laplace transform
LW (z) = E[ezW ]
+∞
= 0 ezw f (w)dw
+∞
αφ
= 0 ezw (φ)
w φ−1 e−αw dw
+ ∞ αφ φ−1 −(α−z)w
= 0 (φ) w e
dw.
Now change variables to y = (α − z)w, z < α, so w = y/(α − z) and the
Jacobian is (α − z)−1 . Then

LW (z) =
=
=
=

∞


1 φ−1 φ−1 −y
y e (α
α−z
0
 ∞
 1 φ
αφ
y φ−1 e−y dy
(φ) α−z
0
 α φ
α−z
φ
1
,
1−z/α
αφ
(φ)





− z)−1 dy

∞

y φ−1 e−y dy and the Laplace

transform is defined for z < α. The Laplace transform of Sr = rj =1 Wj , where
where the second to last equality uses (φ) =

0

174

Generalized Count Regression

Wj are iid with density (4.109), is therefore
LSr (z) = E[exp(zSr )]
)
*
r
= E exp z
W
j
j =1
r
=
E exp zWj
i=1
φ
r
1
=
1−z/α
i=1
rφ
1
= 1−z/α
.
This is the Laplace transform of the gamma density (4.109) with parameters
rφ and α, so Sr has density
f (t|φ, α) =

α rφ rφ−1 −αt
e .
t
(rφ)

Note that the exponential is the special case of gamma with φ = 1, in which
αr
t r−1 e−αt , as given in Chapter 1.1.3.
case f (Sr |φ, α) =
(r − 1)!
4.13 BIBLIOGRAPHIC NOTES
Feller (1971) is a classic reference for several topics discussed in this chapter.
Cox processes are concisely discussed in Kingman (1993, pp. 65–72). Mullahy
(1997a) provides an accessible discussion of the Two Crossings Theorem of
Shaked (1980). Gelfand and Dalal (1990, p. 57) extend Shaked’s two crossings analysis from a one-parameter exponential family to a two-parameter
exponential family by exploiting convexity as in Chapter 8.9. Applications
of MSL estimation to Poisson models with lognormal heterogeneity include
Hinde (1982), Crepon and Duguet (1997b), and Winkelmann (2004). A quite
general treatment of heterogeneity based on simulation is given in Gourieroux
and Monfort (1991).
Detailed analysis of the moment properties of truncated count regression
models include Gurmu (1991), who considers the zero-truncated Poisson, and
Gurmu and Trivedi (1992), who deal with left or right truncation in general and
also with tests of overdispersion in truncated Poisson regression. Applications
of truncated count regression include Grogger and Carson (1991), Creel and
Loomis (1990), and Brännäs (1992). Censored Poisson regression was analyzed in some detail by Gurmu (1993), who obtains estimates using the EM
algorithm. T. Amemiya (1985) provides a good exposition of the EM algorithm. Mullahy (1997a) presents both hurdle and zero-inflated models, with
an application. Surveys by Winkelmann and Zimmermann (1995), Cameron
and Trivedi (1996), Winkelmann (2008), and Greene (2011) and the book by
Winkelmann (2008) cover most of the material in sections 4.2 to 4.6.

4.14 Exercises

175

For hierarchical generalized linear models, see Bryk and Raudenbush (2002)
and Skrondal and Rabe-Hesketh (2004). For a recent survey on inference with
clustered data, see Cameron and Miller (2011).
For a succinct statement of the deeper issues of identification and inference
in finite mixture models, see Lindsay and Stewart (2008), who also provide a
discussion of the links between mixture models and some nonlinear time-series
models. The monograph by McLachlan and Peel (2000) gives a good treatment
of finite mixtures, and Wedel et al. (1993) and Deb and Trivedi (1997) provide
econometric applications. Brännäs and Rosenqvist (1994) and Böhning (1995)
have outlined the computational properties of alternative algorithms. Finite
mixtures can be handled in a Bayesian framework using Markov chain Monte
Carlo methods as in Robert (1996) and Frühwirth-Schnatter (2001).
Chapters 4 and 5 in Lancaster (1990) contain material complementary to
that here on models based on waiting time distributions. Lee (1997) provides a
further development and important extensions of this approach, using simulated
maximum likelihood to estimate the model. Gourieroux and Visser (1997)
also use the duration model to define a count model, and they consider the
heterogeneity distribution arising from the presence of both individual and
spell-specific components. Luceño (1995) examines several models in which
clustering leads to overdispersion.
4.14 EXERCISES
4.1 The Katz family of distributions is defined by the probability recursion
μ + γy
Pr[y + 1]
=
Pr[y]
1+y

for y = 0, 1, . . . , and μ + γ y ≥ 0.

Show that this yields overdispersed distributions for 0 < γ < 1 and underdispersed distributions for γ < 0.
4.2 Using the NB2 density show that the density collapses to that of the Poisson
as the variance of the mixing distribution approaches zero.
4.3 The Poisson-lognormal mixture is obtained by considering the following
model in which μ is normally distributed with mean x β and variance 1. That is,
given y|μν ∼ P[μν ], ln μν = x β + σ ν, and ν ∼ N[0, 1], show that although
the Poisson-lognormal mixture cannot be written in a closed form, the mean
of the mixture distribution is shifted by a constant. Show that the first two
moments of the marginal distribution are

1
E[y|x] = exp x β + σ 2
2

1

V[y| x ] = exp(2x β) exp(2σ 2 ) − exp(σ 2 ) + exp x β + σ 2 .
2
4.4 Compare the variance function obtained in 4.3 with the quadratic variance
function in the NB2 case.

176

Generalized Count Regression

4.5 (a) Suppose y takes values 0, 1, 2, . . . , with density f (y) and mean μ. Find
E[y|y > 0].
(b) Suppose y takes values 0, 1, 2, . . . , with hurdle density given by
Pr[y = 0] = f1 (0) and Pr[y = k] = (1 − f1 (0)) / (1 − f2 (0)) f2 (0),
k = 1, 2, . . .


where the density f2 (y) has untruncated mean μ2 , i.e. ∞
k=0 kf (k) = μ2 . Find
E[y].
(c) Introducing regressors, suppose the zeros are given by a logit model and
positives by a Poisson model; that is,
f1 (0) = 1/ 1 + exp(x β 1 )
f (k) = exp[− exp(x β 2 )][exp(x β 2 )k /y!], k = 1, 2, . . . ;
give an expression for E[y|x].
(d) Hence obtain an expression for ∂E[y|x]/∂x for the hurdle model.
4.6 Derive the information matrix for μ and φ in the double Poisson case.
Show how its block-diagonal structure may be exploited in devising a computer
algorithm for estimating these parameters.
4.7 Let y denote the zero-truncated Poisson-distributed random variable with
density
f (y|μ) = μy e−μ / y!(1 − e−μ ) ,

μ > 0.

Let μ be a random variable with distribution
g(μ) = c(1 − e−μ )e−θ μ μη−1 /y!
where the normalizing constant c = (η)θ −η 1 + [θ /(1 + θ)]η . Show that
the marginal distribution of y is zero-truncated NB distribution. (This example
is due to Boswell and Patil (1970), who emphasized that in this case the mixing
distribution is not a gamma distribution.)

CHAPTER 5

Model Evaluation and Testing

5.1 INTRODUCTION
It is desirable to analyze count data using a cycle of model specification,
estimation, testing, and evaluation. This cycle can go from specific to general
models – for example, it can begin with Poisson and then test for the negative
binomial – or one can use a general-to-specific approach, beginning with the
negative binomial and then testing the restrictions imposed by Poisson. In
terms of inclusion of regressors in a given count model, either approach might
be taken; for the choice of the count data model itself, other than simple choices
such as Poisson or negative binomial, the former approach is most often useful.
For example, if the negative binomial model is inadequate, there is a very
wide range of models that might be considered, rendering a general-to-specific
approach difficult to implement.
The preceding two chapters have presented the specification and estimation components of this cycle for cross-section count data. In this chapter we
focus on the testing and evaluation aspects of this cycle. This includes residual
analysis, goodness-of-fit measures, and model specification tests, in addition
to classical statistical inference.
Residual analysis, based on a range of definitions of the residual for heteroskedastic data such as counts, is presented in section 5.2. A range of
measures of goodness of fit, including pseudo R-squareds and a chi-square
goodness-of-fit statistic, is presented in section 5.3. Discrimination among
nonnested models is the subject of section 5.4. Many of the methods are illustrated using a regression model for the number of takeover bids, which is
introduced in section 5.2.5. The remainder of the chapter considers in detail
previously introduced tests of model specification. Tests for overdispersion
are analyzed in section 5.5, and conditional moment tests are presented in
section 5.6.
The presentation here is in places very detailed. For the practitioner, the use
of simple residuals such as Pearson residuals is well established and can be
quite informative. For overall model fit in fully parametric models, chi-square
goodness-of-fit measures are straightforward to implement. The standard
177

178

Model Evaluation and Testing

methods for discriminating between nonnested models have been adapted to
count data. In testing for overdispersion in the Poisson model, the overdispersion tests presented in Chapter 3.4 often are adequate. The current chapter gives
a more theoretical treatment. Conditional moment tests are easily implemented,
but their interpretation if they are applied to count data is quite subtle due to
the inherent heteroskedasticity.
The treatment of many of these topics, as with estimation, varies according to whether we use a fully parametric maximum likelihood framework or
a moment approach based on specification of the first one or two conditional
moments of the dependent variable. Even within this classification results may
be specialized, notably maximum likelihood methods to LEF and moment
methods to GLMs. Also, most detailed analysis is restricted to cross-section
data. Many of the techniques presented here have been developed only for
such special cases, and their generality is not always clear. There is considerable scope for generalization and application to a broader range of count data
models.
5.2 RESIDUAL ANALYSIS
Residuals measure the departure of fitted values from actual values of the
dependent variable. They can be used to detect model misspecification; outliers,
or observations with poor fit; and influential observations, or observations with
a big impact on the fitted model.
Residual analysis, particularly visual analysis, can potentially indicate the
nature of misspecification and ways that it may be corrected, as well as provide
a feel for the magnitude of the effect of the misspecification. By contrast, formal
statistical tests of model misspecification can be black boxes, producing only a
single number that is then compared to a critical value. Moreover, if one tests
at the same significance level (usually 5%) without regard to sample size, any
model using real data will be rejected with a sufficiently large sample even if it
does fit the data well.
For linear models a residual is easily defined as the difference between
actual and fitted values. For nonlinear models the very definition of a residual
is not unique. Several residuals have been proposed for the Poisson and other
GLMs. These residuals do not always generalize in the presence of common
complications, such as censored or hurdle models, for which it may be more
fruitful to appeal to residuals proposed in the duration literature. We present
many candidate definitions of residuals because there is no one single residual
that can be used in all contexts.
We also give a brief treatment of detection of outliers and influential observations. This topic is less important in applications in which data sets are large
and the relative importance of individual observations is small. And if data
sets are small and an influential or outlying observation is detected, it is not
always clear how one should proceed. Dropping the observation or adapting
the model simply to better fit, one observation creates concerns of data mining
and overfitting.

5.2 Residual Analysis

5.2.1

179

Pearson, Deviance, and Anscombe Residuals

The natural residual is the raw residual
ri = (yi − μ̂i ),

(5.1)

where the fitted mean μ̂i is the conditional mean μi = μ(xi β) evaluated at β =
p
β̂. Asymptotically this residual behaves as (yi − μi ), because β̂ → β implies
p
μ̂i → μi . For the classical linear regression model with normally distributed
homoskedastic error (y − μ) ∼ N[0, σ 2 ], so that in large samples the raw
residual has the desirable properties of being symmetrically distributed around
zero with constant variance. For count data, however, (y − μ) is heteroskedastic
and asymmetric. For example, if y ∼ P[μ] then (y − μ) has variance μ and
third moment μ. So the raw residual even in large samples is heteroskedastic
and asymmetric.
For count data there is no one residual that has zero mean, constant variance,
and symmetric distribution. This leads to the use of several different residuals
according to which of these properties is felt to be most desirable.
The obvious correction for heteroskedasticity is the Pearson residual,
pi =

(yi − μ̂i )
,
√
ω̂i

(5.2)

where ω̂i is an estimate of the variance ωi of yi . The sum of the squares of these
residuals is the Pearson statistic, defined in (5.16). For the Poisson, GLM, and
NB2 models, respectively, one uses ω = μ, ω = αμ, and ω = μ + αμ2 . In
large samples this residual has zero mean and is homoskedastic (with variance
unity), but it is asymmetrically distributed. For example, if y is Poisson then
√
√
E[((y − μ)/ μ)3 ] = 1/ μ.
If y is generated by an LEF density one can use the deviance residual, which
is
6
(5.3)
di = sign(yi − μ̂i ) 2{l(yi ) − l(μ̂i )},
where l(μ̂) is the log-density of y evaluated at μ = μ̂ and l(y) is the log-density
evaluated at μ = y. A motivation for the deviance residual is that the sum of
the squares of these residuals is the deviance statistic, defined in (5.18), which
is the generalization for LEF models of the sum of raw residuals in the linear
model. Thus, for the normal distribution with σ 2 known, di = (yi − μi )/σ , the
usual standardized residual. For the Poisson this residual equals
6
(5.4)
di = sign(yi − μ̂i ) 2{yi ln(yi /μ̂i ) − (yi − μ̂i )},
where y ln y = 0 if y = 0. Most other count data models are not GLMs, so this
residual cannot be used. A notable exception is the NB2 model with α known.
Then
!


di = sign(yi − μ̂i ) 2{yi ln(yi /μ̂i ) − (yi + α −1 ) ln (yi + α −1 )/(μ̂i + α −1 ) }.
(5.5)

180

Model Evaluation and Testing

The Anscombe residual is defined to be the transformation of y that is closest
to normality, which is then standardized to mean zero and variance 1. This
transformation has been obtained for LEF densities. If y is Poisson distributed,
the function y 2/3 is closest to normality, and the Anscombe residual is
2/3

ai =

1.5(yi

2/3

− μi )

1/6

μi

.

(5.6)

The Pearson, deviance, and Anscombe residuals for the Poisson can all
√
√
be reexpressed
as μ times a function of y/μ. Specifically, p = μ(c −
√
√ √
1), d = μ 2(c ln c − (c − 1)), and a = μ1.5(c2/3 − 1). McCullagh and
Nelder (1989, p. 39) tabulate these residuals for selected values of c = y/μ.
All three residuals are zero when y = μ (i.e., c = 1) and are increasing in y/μ .
There is very little difference between the deviance and Anscombe residuals.
The Pearson residuals are highly correlated with the other two residuals, but are
scaled quite differently, being larger for c > 0 and smaller in absolute value for
√
√
√
c < 0. For example, p = 5 μ, d = 3.39 μ, and a = 3.45 μ when y = 5μ,
√
√
√
whereas p = −0.80 μ, d = −0.98 μ, and a = −0.99 μ for y = 0.2μ.
Pierce and Schafer (1986) consider these residuals in some detail.
5.2.2

Generalized Residuals

Cox and Snell (1968) define a generalized residual to be any function
Ri = Ri (xi , θ̂ , yi ),

(5.7)

subject to some weak restrictions. This quite broad definition includes Pearson,
deviance, and Anscombe residuals as special cases.
Many other possible residuals satisfy (5.7). For example, consider a count
data model with conditional mean function μ(xi , θ ) and multiplicative error,
that is, yi = μ(xi , θ )ε i , where E[εi |xi ] = 1. Solving for ε i = yi /μ(xi , θ ) suggests the residual Ri = yi /μ(xi , θ̂ ). An additive error leads one instead to the
raw residual yi − μ(xi , θ̂ ) presented in the previous section.
Another way to motivate a generalized residual is to make comparison to
least squares first-order conditions. For single-index models with log-density
li = l(yi , η(xi , θ )) the first-order conditions are
n

∂ηi ∂li
= 0.
(5.8)
∂θ ∂ηi
i=1

Comparison with ni=1 xi (yi − xi β) = 0 for the linear model suggests interpreting ∂ηi /∂θ as the regressors and using

Ri = ∂li /∂ηi

(5.9)

as a generalized residual. For the Poisson model with ηi = μi = μ(xi , θ ), this
√
leads to the residual (yi − μi )/μi . The Pearson residual (yi − μi )/ μi arises if
Ri is standardized to have unit variance. This last result, that the Pearson residual

5.2 Residual Analysis

181

6
equals ∂li /∂ηi / V[∂li /∂ηi ], holds for all LEF models. More problematic is
how to proceed in models more general than single-index models. For the NB2
and ordered probit models the log-density is of the form li = l(yi , η(xi , β), α),
and one might again use Ri = ∂li /∂ηi by considering the first-order conditions
with respect to β only.
For regression models based on a normal latent variable, several authors have
proposed residuals. Chesher and Irish (1987) propose using Ri = E[ε∗i |yi ] as
the residual where ε ∗i = yi∗ − μi , yi∗ is an unobserved variable that is distributed
as N[μi , σ 2 ], and the observed variable yi = g(yi∗ ). Different functions g(·) lead
to probit, censored tobit, and grouped normal models. This approach can be
applied to ordered probit (or logit) models for count data. Gourieroux, Monfort,
Renault, and Trognon (1987a) generalize this approach to LEF densities. Thus,
let the log of the LEF density of the latent variable be li∗ = l ∗ (yi∗ , η(xi , θ )). If
yi∗ was observed one could use Ri∗ = ∂li∗ /∂ηi as a generalized residual. Instead
one uses Ri = E[Ri∗ |yi ]. An interesting result for LEF densities is that Ri =
∂li /∂ηi , where li is the log-density of the observed variable. Thus the same
residual is obtained by applying (5.9) to the latent variable model and then
conditioning on observed data as is obtained by directly applying (5.9) to the
observed variable.
A count application is the left-truncated Poisson model, studied by Gurmu
and Trivedi (1992), whose results were summarized in Chapter 4.3. Then
yi∗ ∼ P[μi ] and we observe yi = yi∗ if yi∗ ≥ r. For the latent variable model
Ri∗ = (yi∗ − μi )/μi . Since E[yi∗ |yi∗ ≥ r] = μi + δ i , where the correction factor
δ i is given in section 4.3.1, the residual for the observed variable is Ri =
E[Ri∗ |yi∗ ≥ r] = (yi − μi − δ i )/μi . Alternatively, inspection of the ML firstorder conditions given in Chapter 4.3.2 also leads to this residual.
5.2.3

Using Residuals

Perhaps the most fruitful way to use residuals is by plotting residuals against
other variables of interest. Such plots include residuals plotted against predicted
values of the dependent variable, for example to see whether the fit is poor for
small or large values of the dependent variable; against omitted regressors, to
see whether there is any relationship in which case the residuals should be
included; and against included regressors, to see whether regressors should
enter through a different functional form than that specified.
For the first plot it is tempting to plot residuals against the actual value of
the dependent variable, but such a plot is not informative for count data. To
see this, consider this plot using the raw residual. Because Cov[y − μ, y] =
V[y], which equals μ for Poisson data, there is a positive relationship between
y − μ and y. Such plots are more useful for the linear regression model under
classical assumptions, in which case V[y] is a constant and any pattern in the
relationship between y − μ and y is interpreted as indicating heteroscedasticity.
For counts we instead plot residuals against predicted means and note that
Cov[y − μ, μ] = 0. A variation is to plot the actual value of y against the

182

Model Evaluation and Testing

predicted value. This plot is difficult to interpret, however, if the dependent
variable takes only a few values.
If there is little variation in predicted means, the residuals may also be lumpy
due to lumpiness in y, making it difficult to interpret plots of the residuals
against the fitted mean. A similar problem arises in the logit and other discrete
choice models. Landwehr, Pregibon, and Shoemaker (1984) propose graphical
smoothing methods (see also Chesher and Irish, 1987). For the probit model
based on a normal latent variable, Gourieroux, Monfort, Renault, and Trognon
(1987b) propose the use of simulated residuals as a way to overcome lumpiness,
but this adds considerable noise. The approach could be applied to ordered
probit and logit models for count data for which the underlying latent variable
is discrete. An ad hoc solution is to “jitter” the residuals by adding random
uniform noise.
Even if the variables being plotted are not lumpy, it can still be difficult to
detect a relationship, and it is preferable to perform a nonparametric regression
of R on x, where R denotes the residual being analyzed and x is the variable it
is being plotted against. One can then plot the predictions R̂ against x, where
R̂ is the estimate of the potentially nonlinear mean E[R|x].
There are a number of methods for such nonparametric regression. Let yi
be a dependent variable (in the preceding discussion a model residual), and xi
be a regressor (in the preceding discussion the dependent variable, fitted mean,
or model regressor). We wish to estimate E[yl |xl ], where the evaluation points
xl may or may not be actual sample values of x. The nonparametric estimator
of the regression function is
ŷl = Ê[yl |xl ] =

 n

i=1


wil yi 



n



wil ,

(5.10)

i=1

where the weights wil are decreasing functions of |xi − xl |. Different methods
lead to different weighting functions, with kernel, local linear, lowess, and
nearest-neighbors methods particularly popular.
An overall test of adequacy of a model may be to see how close the residuals
are to normality. This can be done by a normal scores plot, which orders the
residuals ri from smallest to largest, and plots them against the values predicted
if the residuals were exactly normally distributed; that is, plot the ordered ri
against
rnormi = r + sr −1 ((i − .5)/n),

(5.11)

i = 1, . . . , n, where sr is the sample standard deviation of r and −1 is the
inverse of the standard normal cdf. If the residuals are exactly normal this
produces a straight line. Davison and Gigli (1989) advocate using such normal
scores plots with deviance residuals to check distributional assumptions.

5.2 Residual Analysis

5.2.4

183

Small Sample Corrections and Influential Observations

The preceding motivations for the various residuals have implicitly treated μ̂i as
μi , ignoring estimation error in μ̂i . Estimation error can lead to quite different
small-sample behavior between, for example, the raw residual (yi − μ̂i ) and
(yi − μi ), just as it does in the linear regression model.
In the linear model, y = X β + u, it is a standard result that the OLS residual
vector (y − μ̂) = (I − H)u, where H = X(X X)−1 X . Under classic assumptions that E[uu ] = σ 2 I it follows that E[(y − μ̂)(y − μ̂) ] = σ 2 (I − H). Therefore, (yi − μ̂i ) has variance (1 − hii )σ 2 , where hii is the i th diagonal entry of
H. For very large n, hii → 0 and the OLS residual has variance σ 2 as expected.
But for small n the variance may
best to use the
6 be quite different, and it1is 
2
studentized residual (yi − μ̂i )/ (1 − hii )s 2 , where s 2 = (n−k)
i ûi and studentization means dividing by the standard deviation of the residual. Some
authors additionally replace s 2 by si2 obtained from regression with the i th
observation deleted.
The matrix H also appears in detecting influential observations. Because in
the linear model estimated by OLS μ̂ = ŷ = Hy, H is called the hat matrix.
If hii , the i th diagonal entry in H, is large, then the design matrix X, which
determines H, is such that yi has a big influence on its own prediction.
Pregibon (1981) generalized this analysis to the logit model. The logit results
in turn have been extended to GLMs (see, e.g., Williams, 1987, and McCullagh
and Nelder, 1989, for a summary). For GLMs the hat matrix is
H = W1/2 X(X WX)−1 X W1/2 ,

(5.12)

where W = Diag[wi ], a diagonal matrix with i th entry wi , and wi =
(∂μi /∂xi β)2 /V[yi ]. For the Poisson with exponential mean function wi = μi ,
so H is easily calculated. As in the linear model the n × n matrix H is idempotent with trace equal to its rank k, the number of regressors. So the average
value of hii is k/n, and values of hii in excess of 2k/n are viewed as having
high leverage. The studentized Pearson residual is
6
(5.13)
pi∗ = pi / 1 − hii
and the studentized deviance residual is
6
di∗ = di / 1 − hii .
pi∗

di∗

(5.14)

and
standardized residuals. Other smallNote that some authors call
sample corrections for generalized residuals are given by Cox and Snell (1968).
See also Davison and Snell (1991), who consider GLM and more general
residuals.
A practical problem in implementing these methods is that H is of dimension
n × n, so that if one uses the obvious matrix commands to compute H the data
set cannot be too large, due to the need to compute a matrix with n2 elements.
Some ingenuity may be needed to calculate the diagonal entries in H.

184

Model Evaluation and Testing

Table 5.1. Takeover bids: Actual frequency distribution
Count
0
1
2
3
4
5
6
7
8
9
10
Frequency
9
63
31
12
6
1
2
1
0
0
1
Relative frequency 0.071 0.500 0.246 0.095 0.048 0.008 0.016 0.008 0.001 0.000 0.008

These asymptotic approximations are for small n. Some authors also consider so-called small-m asymptotics, which correct for not having multiple
observations on y for each value of the regressors. Such corrections lead to
an adjusted deviance residual that is closer to the normal distribution than the
deviance residual. For the Poisson the adjusted deviance residual is
√
dadji = di + 1/(6 μi ).

(5.15)

Pierce and Schafer (1986) find that the adjusted deviance residual is closest
to normality, after taking account of the discreteness by making a continuity
correction that adds or subtracts 0.5 to or from y, toward the center of the
distribution.
5.2.5

Example: Takeover Bids

Jaggia and Thosar (1993) model the number of bids received by 126 U.S. firms
that were targets of tender offers during the period from 1978 through 1985 and
were actually taken over within 52 weeks of the initial offer. The dependent
count variable is the number of bids after the initial bid (NUMBIDS) received
by the target firm.
Data on the number of bids are given in Table 5.1. Less than 10% of the
firms received zero bids, one-half of the firms received exactly one bid (after the
initial bid), a further one-quarter received exactly 2 bids, and the remainder of
the sample received between 3 and 10 bids. The mean number of bids is 1.738
and the sample variance is 2.050, see Table 5.2. There is only a small amount
of overdispersion (2.050/1.738 = 1.18), which can be expected to disappear
as regressors are added.
The variables are defined and summary statistics given in Table 5.2. Regressors can be grouped into three categories: (1) defensive actions taken by management of the target firm: LEGLREST, REALREST, FINREST, WHITEKNT;
(2) firm-specific characteristics: BIDPREM, INSTHOLD, SIZE, SIZESQ); and
(3) intervention by federal regulators: REGULATN. The defensive action variables are expected to decrease the number of bids, except for WHITEKNT,
which may increase bids because it is itself a bid. With greater institutional
holdings it is expected that outside offers are more likely to be favorably
received, which encourages more bids. As the size of the firm increases there
are expected to be more bids, up to a point where the firm gets so large that few
others are capable of making a credible bid. This is captured by the quadratic
in firm size. Regulator intervention is likely to discourage bids.

5.2 Residual Analysis

185

Table 5.2. Takeover bids: Variable definitions and summary statistics
Variable

Definition

Mean

Standard
deviation

NUMBIDS
LEGLREST
REALREST
FINREST

Number of takeover bids
Equals 1 if legal defense by lawsuit
Equals 1 if proposed changes in asset structure
Equals 1 if proposed changes in ownership
structure
Equals 1 if management invitation for friendly
third-party bid
Bid price divided by price 14 working days
before bid
Percentage of stock held by institutions
Total book value of assets in billion of dollars
SIZE squared
Equals 1 if intervention by federal regulator

1.738
0.429
0.183
0.103

1.432
0.497
0.388
0.305

0.595

0.493

1.347

0.189

0.252
1.219
10.999
0.270

0.186
3.097
59.915
0.446

WHITEKNT
BIDPREM
INSTHOLD
SIZE
SIZESQ
REGULATN

The Poisson QML estimates are given in Table 5.3, along with robust sandwich standard errors and t-statistics. The estimated value of the overdispersion
parameter α is 0.746, which is considerably less than unity. To test for underdispersion, we can use the LM tests of Chapter 3.4. These yield t statistics of
−1.19 for underdispersion of the NB2 form and −3.03 for underdispersion of
the NB1 form, so at level 0.05 with critical value 1.645 we reject equidispersion against underdispersion of the NB1 form, though not the NB2 form. We
continue to use Poisson QML estimates, with robust standard errors to correct
for underdispersion.
The defensive action variables are generally statistically insignificant at
5%, except for LEGLREST, which actually has an unexpected positive effect.
Table 5.3. Takeover bids: Poisson QMLE with
robust sandwich standard errors and t ratios
Poisson QMLE
Variable
ONE
LEGLREST
REALREST
FINREST
WHITEKNT
BIDPREM
INSTHOLD
SIZE
SIZESQ
REGULATN
−ln L

Coefficient

Standard errors

t statistic

0.986
0.260
−0.196
0.074
0.481
−0.678
−0.362
0.179
−0.008
−0.029
185.0

0.414
0.125
0.182
0.264
0.106
0.298
0.323
0.062
0.003
0.142

2.38
2.08
−1.08
0.28
4.52
−2.28
−1.12
2.86
−2.72
−0.21

186

Model Evaluation and Testing

Table 5.4. Takeover bids: Descriptive statistics for various residuals
Residual
r
p
p*
d
d*
dadj
a

Standard
Mean deviation Skewness Kurtosis Minimum. 10% 90% Maximum
0.000
0.002
−0.003
−0.090
−0.099
0.044
−0.097

1.23
0.83
0.89
0.84
0.89
0.84
0.85

1.38
1.12
1.12
0.29
0.30
0.25
0.21

−3.23
−1.61
−1.87
−2.27
−2.37
−2.17
−2.41

7.48
4.99
5.19
3.88
4.03
3.82
3.93

−1.29
−0.96
−0.99
−1.11
−1.27
−1.03
−1.11

1.33
1.01
1.05
0.93
0.94
1.03
0.93

5.57
3.03
3.11
2.40
2.67
2.52
2.42

Note: r, raw; p, Pearson; p*, studentized Pearson; d, deviance; d*, studentized deviance; dadj,
adjusted deviance; a, Anscombe residual.

Although the coefficient of WHITEKNT is statistically different from zero at
5%, its coefficient implies that the number of bids increases by 0.481 × 1.738 
0.84 of a bid. This effect is not statistically significantly different from unity.
(If a white-knight bid has no effect on bids by other potential bidders we expect
it to increase the number of bids by one.) The firm-specific characteristics
with the exception of INSTHOLD are statistically significant with the expected
signs. BIDPREM has a relatively modest effect, with an increase in the bid
premium of 0.2, which is approximately one standard deviation of BIDPREM,
or 20%, leading to a decrease of 0.2 × 0.678 × 1.738  0.24 in the number of
bids. Bids first increase and then decrease as firm size increases. Government
regulator intervention has very little effect on the number of bids.
Summary statistics for different definitions of residuals from the same Poisson QML estimates are given in Table 5.4. These residuals are the raw, Pearson,
deviance, and Anscombe residuals defined in, respectively, (5.1), (5.2), (5.4),
and (5.6); small-sample corrected or studentized
√ Pearson and deviance residuals
(5.13) and (5.14) obtained by division by 1 − hii ; and the adjusted deviance
residual (5.15).
Table 5.5. Takeover bids: Correlations of various residuals
Residual
r
p
p*
d
d*
dadj
a

r

p

p*

d

d*

dadj

a

1.000
0.976
0.983
0.956
0.964
0.955
0.951

1.000
0.998
0.984
0.982
0.983
0.980

1.000
0.981
0.984
0.980
0.977

1.000
0.998
0.999
0.999

1.000
0.997
0.997

1.000
0.999

1.000

Note: r, raw; p, Pearson; p*, studentized Pearson; d, deviance; d*, studentized deviance; dadj,
adjusted deviance; a, Anscombe residual.

187

−2

−2

Anscombe residual
−1
0
1

Anscombe residual
−1
1
0

2

2

5.2 Residual Analysis

2
4
6
8
Number of takeover bids

10

−1
0
1
Inverse Normal

2

0

1

2
3
Predicted bids

4

5

0

−2

Anscombe residual
0
1
−1

Diagonal entry in H
.2
.4
.6

2

.8

0

−2

0

20

40
60
80 100
Observation number

120

Figure 5.1. Takeover bids: Residual plots.

The various residuals are intended to be closer to normality – that is, with
no skewness and kurtosis equal to 3 – than the raw residual if the data are
P[μi ]. For these real data, which are not exactly P[μi ], this is the case for
all except the raw residual, which has quite high kurtosis. The deviance and
Anscombe residuals are clearly preferred to the Pearson residual on these
criteria. Studentizing makes little difference and is expected to make little
difference for most observations, because the average hii = 10/126 = 0.079
leading to a small correction. For this sample even the second largest value of
hii = 0.321 only leads to division of Pearson and deviance residuals by 0.82,
not greatly different from unity.
The similarity between the residuals is also apparent from Table 5.5, which
gives correlations among the various residuals, which are especially high
between deviance and Anscombe residuals. The correlations between the residuals are all in excess of 0.9, and small-sample corrected residuals have a correlation of 0.998 or more with the corresponding uncorrected residual.
We conclude that for this sample the various residuals should all tell a
similar story. We focus on the Anscombe residual ai , because it is the closest
to normality. Results using deviance residuals will be very similar. Various
residual plots are presented in Figure 5.1.

188

Model Evaluation and Testing

Panel 1 of Figure 5.1 plots the Anscombe residual against the dependent
variable. This shows the expected positive relationship, explained earlier. It is
better to plot against the predicted mean, which is done in panel 2. It is difficult
to visually detect a relationship, and a fitted nonparametric regression curve
shows no relationship.
A normal scores or Q-Q plot of ordered Anscombe residuals against predicted quantiles if the residual is normally distributed, see (5.11), is given in
panel 3 of Figure 5.1. The relationship is close to linear, although the high values
of the Anscombe residuals are above the line, suggesting higher-than-expected
residuals for large values of the dependent variable.
The hat matrix defined in (5.12) can be used for detecting influential observations. For the Poisson QMLE, a plot of the i th diagonal entry hii against
observation number is given in panel 4 of Figure 5.1. For this sample there
are six observations with hii > 3k/n = 0.24. These are observations 36, 80,
83, 85, 102, and 126 with hii of, respectively, 0.28, 0.32, 0.70, 0.32, 0.28, and
0.30. If instead we use the OLS leverage measures (i.e., H = X(X X)−1 X ),
the corresponding diagonal entries are 0.18, 0.27, 0.45, 0.58, 0.18, and 0.16 so
that one would come to similar conclusions.
On dropping these six observations the coefficients of the most highly statistically significant variables change by around 30%. The major differences
are a change in the sign of SIZESQ and that both SIZE and SIZESQ become
very statistically insignificant. Further investigation of the data reveals that
these six observations are for the six largest firms and that the size distribution
has a very fat tail with the kurtosis of SIZE equal to 31, explaining the high
leverage of these observations. The leverage measures very strongly alert one
to the problem, but the solution is not so clear. Dropping the observations with
large SIZE is not desirable if one wants to test the hypothesis that, other things
being equal, very large firms attract fewer bids than medium-sized firms. Different functional forms for SIZE might be considered, such as log(SIZE) and
its square, or an indicator variable for large firms might be used.
For this example there is little difference in the usefulness of the various
standardized residuals. The sample size with 126 observations regressors is
relatively small for statistical inference based on asymptotic theory, especially
with 10 regressors, yet is sufficiently large that small-sample corrections made
virtually no difference to the residuals. Using the hat matrix to detect influential
observations was useful in suggesting possible changes to the functional form
of the model.
5.3 GOODNESS OF FIT
In the preceding section the focus was on evaluating the performance of the
model in fitting individual observations. Now we consider the overall performance of the model. Common goodness-of-fit measures for GLMs are the
Pearson and deviance statistics, which are weighted sums of residuals. These
can be used to form pseudo R-squared measures, with those based on deviance

5.3 Goodness of Fit

189

statistics preferred. A final measure is comparison of average predicted
probabilities of counts with empirical relative frequencies, using a chisquare goodness-of-fit test that controls for estimation error in the regression
coefficients.
5.3.1

Pearson Statistic

A standard measure of goodness of fit for any model of yi with mean μi and
variance ωi is the Pearson statistic
P =

n

(yi − μ̂i )2
,
ω̂i
i=1

(5.16)

of μi and ωi . If the mean and variance are corwhere μ̂i and ω̂i are estimates

rectly specified, then E[ ni=1 (yi − μi )2 /ωi ] = n, because E[(yi − μi )2 /ωi ] =
1. In practice P is compared with (n − k), reflecting a degrees-of-freedom
correction due to estimation of μi .
The simplest count application is to the Poisson regression model. This sets
ωi = μi , so that
PP =

n

(yi − μ̂i )2
.
μ̂i
i=1

(5.17)

In the GLM literature it is standard to interpret PP > n − k as evidence of
overdispersion, that is, the true variance exceeds the mean, which implies
E[(yi − μi )2 /μi ] > 1; PP < n − k indicates underdispersion. Note that this
interpretation presumes the correct specification of μi . In fact, PP = n − k
may instead indicate misspecification of the conditional mean.
In practice even the simplest count data models make some correction
for overdispersion. In the GLM literature the variance is often modeled as
a multiple 
of the mean as in Chapter 3.2.4. Then ω̂i = φ̂ μ̂i , where φ̂ = φ̂ NB1 =
(n − k)−1 ni=1 {(yi − μ̂i )2 /μ̂i }. But this implies P always equals (n − k), so
P is no longer a useful diagnostic. If instead one uses the NB2 model, ω̂i =
μ̂i + α̂ μ̂2i , with α̂ the ML estimate of α from Chapter 3.3.1, then P is still a
useful diagnostic for detecting overdispersion. Again, departures of P from
(n − k) may actually reflect misspecification of the conditional mean.
Some references to the Pearson statistic suggest that it is asymptotically chisquare distributed, but this is only true in the special case of grouped data with
multiple observations for each μi . McCullagh (1986) gives the distribution in
the more common case of ungrouped data, in which case one needs to account
for the dependence of μ̂i on β̂. This distribution can be obtained by appealing
a
2
to the results of CM tests given in Chapter 2.6.3. Thus TP = P  V̂−1
P P ∼ χ (1),
where the formula for the variance VP is quite cumbersome. For the NB2
model estimated by maximum likelihood, one can use the simpler OPG form
of the CM test. Then an asymptotically equivalent version of TP is n times
the uncentered R 2 from auxiliary regression of 1 on the k + 2 regressors

190

Model Evaluation and Testing

(y
μ̂i )2 /(μ̂i + α̂ μ̂i 2 ), (yi − μ̂i )/(1 + α̂ μ̂i )xi and {α̂ −2 [ln(1 + α̂ μ̂i ) −
iy−
i −1
−1
j =0 (j + α̂ )] + (yi − μ̂i )/α(1 + α̂ μ̂i )}. Studies very seldom implement
such a formal test statistic.
5.3.2

Deviance Statistic

A second measure of goodness of fit, restricted to GLMs, is the deviance. Let
L(μ) ≡ ln L(μ) denote the log-likelihood function for an LEF density, defined
in Chapter 2.4, where μ is the n × 1 vector with i th entry μi . Then the fitted
log-likelihood is L(μ̂), and the maximum log-likelihood achievable, that in a
full model with n parameters, can be shown to be L(y), where μ̂ and y are the
n × 1 vectors with i th entries μ̂i and yi . The deviance is defined to be
D(y, μ̂) = 2{L(y) − L(μ̂)},

(5.18)

which is twice the difference between the maximum log-likelihood achievable
and the log-likelihood of the fitted model.
GLMs additionally introduce a dispersion parameter φ, with variance scaled
by a(φ). Then the log-likelihood is L(μ, φ), and the scaled deviance is defined
to be
SD(y, μ̂, φ) = 2{L(y, φ) − L(μ̂, φ)}.

(5.19)

For GLM densities SD(y, μ̂, φ) equals a function of y and μ̂ divided by a(φ).
It is convenient to multiply SD(y, μ̂, φ) by the dispersion factor a(φ), and the
deviance is defined as
D(y, μ̂) = 2a(φ){L(y, φ) − L(μ̂, φ)}.

(5.20)

The left-hand side of (5.20) is not a function of φ because the terms in φ
in the right-hand side cancel. McCullagh (1986) gives the distribution of the
deviance.
For the linear regression
 model under normality, the deviance equals the
residual sum of squares ni=1 (yi − μ̂i )2 . This has led to the deviance being
used in the GLM framework as a generalization of the sum of squares. This
provides the motivation for the deviance residual defined in Chapter 5.2.1. To
compare sequences of nested GLMs, the analysis of deviance generalizes the
analysis of variance.
For the Poisson model


n 

yi
(5.21)
yi ln
− (yi − μ̂i ) ,
DP =
μ̂i
i=1
where y ln y = 0 if y = 0. This statistic is also called the G-squared statistic;
see Bishop, Feinberg, and Holland (1975). Because Poisson residuals sum to
zero if an intercept is included and the exponential mean function is used, DP

5.3 Goodness of Fit

191


can more easily be calculated as i yi ln(yi /μ̂i ). For the NB2 model with α
known,



n 

yi
yi + α −1
yi ln
− (yi + α −1 ) ln
.
(5.22)
DNB2 =
μ̂i
μ̂i + α −1
i=1
5.3.3

Pseudo R-Squared Measures

There is no universal definition of R-squared in nonlinear models. A number
of measures can be proposed. This indeterminedness is reflected in the use of
“pseudo” as a qualifier. Pseudo R-squareds usually have the property that, on
specialization to the linear model, they coincide with an interpretation of the
linear model R-squared.
The attractive features of the linear model R-squared measure disappear in
nonlinear regression models. In the linear regression model, the starting point
for obtaining R 2 is decomposition of the total sum of squares. In general,
n
n
n



(yi − y)2 =
(yi − μ̂i )2 +
(μ̂i − y)2
i=1

i=1

+2

i=1
n


(yi − μ̂i )(μ̂i − y).

(5.23)

i=1

The first three summations are, respectively, the total sum of squares (TSS),
residual sum of squares (RSS), and explained sum of squares (ESS). The final
summation is zero for OLS estimates of the linear regression model if an
intercept is included. It is nonzero, however, for virtually all other estimators and models, including the Poisson and NLS with exponential conditional
mean. This leads to different measures according to whether one uses R 2 =
1−RSS/TSS or R 2 = ESS/TSS. Furthermore, because estimators such as the
Poisson MLE do not minimize RSS, these R-squareds need not necessarily
increase as regressors are added, and even if an intercept is included, the first
one may be negative and the second may exceed unity.
The deviance is the GLM generalization of the sum of squares, as noted
in the previous subsection. Cameron and Windmeijer (1996, 1997) propose a
pseudo-R 2 based on decomposition of the deviance. Then
D(y, y) = D(y, μ̂) + D(μ̂, y),

(5.24)

where D(y, y) is the deviance in the intercept-only model, D(y, μ̂) is the
deviance in the fitted model, and D(μ̂, y) is the explained deviance. One uses
2
=1−
RDEV

D(y, μ̂)
,
D(y, y)

(5.25)

which measures the reduction in the deviance due to the inclusion of regressors. This equals D(μ̂, y)/D(y, y), with the R 2 based instead on the explained
deviance. It lies between 0 and 1, increases as regressors are added and can be

192

Model Evaluation and Testing

given an information-theoretic interpretation as the proportionate reduction in
Kullback-Liebler divergence due to the inclusion of regressors. Only the last
one properties actually requires correct specification of the distribution of y.
This method can be applied to models for which the deviance is defined. For
the Poisson linear regression model, the deviance is given in (5.21) leading to

n
μ̂i
y
ln
− (yi − μ̂i )
i
i=1
y
2

,
(5.26)
RDEV,P =
n
yi
y
ln
i
i=1
y
where y ln y = 0 if y = 0. The same measure is obtained for the Poisson
GLM with NB1 variance function. For maximum likelihood estimation of the
negative binomial with NB2 variance function the deviance pseudo-R 2 is


n
μ̂i
yi + â
y
ln
+
â)
ln
−
(y
i
i
i=1
y
μ̂ + â
2

 i
, (5.27)
RDEV,NB2
=1−
n
yi
yi + â
− (yi + â) ln
i=1 yi ln
y
y + â
2
where â = 1/α̂ and α̂ is the estimate of α in the fitted model. Note that RDEV,P
2
and RDEV,NB2
have different denominators and are not directly comparable.
In particular it is possible, and indeed likely for data that are considerably
2
2
> RDEV,NB2
. One can instead modify the deviance
overdispersed, that RDEV,P

2
pseudo-R measures to have the common denominator ni=1 yi ln(yi /y), in
which case the intercept-only Poisson is being used as the benchmark model.
The NB1 model is not a GLM model, although Cameron and Windmeijer
(1996) nonetheless propose a deviance-type R 2 measure in this case.
Cameron and Windmeijer (1996) motivate the deviance R 2 measures as
measures based on residuals; one uses deviance residuals rather than raw residuals. One can alternatively view these measures in terms of the fraction of the
potential log-likelihood gain that is achieved with the inclusion of regressors.
Formally,

R2 =

Lfit − L0
Lmax − Lfit
=1−
,
Lmax − L0
Lmax − L0

(5.28)

where Lfit and L0 denote the log-likelihood in the fitted and intercept-only
models and Lmax denotes the maximum log-likelihood achievable. In (5.28),
(Lmax − L0 ) is the potential log-likelihood gain and (Lmax − Lfit ) is the loglikelihood gain achieved. This approach was taken by Merkle and Zimmermann
(1992) for the Poisson model. The difficult part in the implementation for more
general models is defining Lmax . For some models Lmax is unbounded, in which
case any model has an R 2 of zero. For GLM models Lmax = L(y) is finite and
the approach is useful.
For nonlinear models some studies have proposed instead using the pseudoR 2 measure, R 2 = 1 − (Lfit /L0 ), sometimes called the likelihood ratio index.

5.3 Goodness of Fit

193

This is the same as (5.28) in the special case Lmax = 0, which is the case
for binary and multinomial outcome models. More generally, however, the
likelihood ratio index can be considerably less than unity for discrete densities,
regardless of how good the fit is, because Lmax ≤ 0. Also, for continuous
densities, problems may arise because Lfit > 0 and negative R 2 values are
possible.
2
(5.28), RDEV,P
can be
Poisson packages usually report Lfit and L0 . Using

computed if one additionally computes Lmax = i {yi log yi − yi − log yi !}.
The measure can also be clearly applied to truncated and censored variants of
these models.
Cameron and Windmeijer (1996) also consider a similar R 2 measure based
on the Pearson residual. For models with variance function ω(μ, α),
2
=1−
RPEARSON

n
n

(yi − μ̂i )2  (yi − μ̂0 )2

,
ω(μ̂i , α̂)
ω(μ̂0 , α̂)
i=1
i=1

(5.29)

where α̂ is the estimate of α in the fitted model and μ̂0 = μ̂0 (α̂) denotes the
predicted mean in the intercept-only model estimated under the constraint that
α = α̂. For Poisson and NB2 models μ̂0 = y. This measure has the attraction
of requiring only mean-variance assumptions and being applicable to a wide
range of models. This measure can be negative, however, and can decrease as
regressors are added. These weaknesses are not just theoretical, because they
are found to arise often in simulations and in applications. Despite its relative
2
is not recommended.
simplicity and generality, use of RPEARSON
Finally, a simple familiar measure is
2
2
8 i , μ̂i ] ,
RCOR
= Cor[y
the squared correlation coefficient between actual and fitted values. This has
the disadvantage for count model estimation that it can decrease as regressors
are added. It has the advantage of comparability across quite disparate models,
2
is
with one model definitely better at explaining the data than another if RCOR
substantially higher.
5.3.4

Chi-Square Goodness of Fit Test

For fully parametric models such as Poisson and negative binomial maximum
likelihood, a crude diagnostic is to compare fitted probabilities with actual
frequencies, where the fitted frequency distribution is computed as the average
over observations of the predicted probabilities fitted for each count.
Suppose the count yi takes values 0, 1, . . . , m, where m = max(yi ). Let the
i
observed frequencies (i.e., the fraction of the sample with y = j ), be denoted
p̂j , j = 0, . . . , m.
by pj and the corresponding fitted frequencies
 be denoted by
j
For the Poisson, for example, p̂j = n−1 ni=1 exp(−μ̂i )μ̂i /j ! Comparison of
p̂j with pj can be useful in displaying poor performance of a model, in highlighting ranges of the counts for which the model has a tendency to underpredict

194

Model Evaluation and Testing

or overpredict, and for allowing a simple comparison of the predictive performance of competing models. Figure 3.1 provides an example. Without doing a
formal test, however, it is not clear when p̂j is “close” enough to pj for one to
conclude that the model is a good one.
Formal comparison of p̂j and pj can be done using a CM test. We consider
a slightly more general framework, one where the range of y is broken into J
mutually exclusive cells, where each cell may include more than one value of
y and the J cells span all possible values of y. For example, in data where only
low values are observed, the cells may be {0}, {1}, {2, 3}, and {4, 5, . . .}. Let
dij (yi ) be an indicator variable with dij = 1 if yi falls in the j th set and dij = 0
otherwise. Let pij (xi , θ ) denote the predicted probability that observation i
falls in the j th set, where to begin with we assume the parameter vector θ is
known. Consider testing whether dij (yi ) is centered around pij (xi , θ ),
E[dij (yi ) − pij (xi , θ )] = 0,

j = 1, . . . , J,

(5.30)

or stacking all J moments in obvious vector notation
E[di (yi ) − pi (xi , θ )] = 0.

(5.31)

This hypothesis can be tested by testing the closeness to zero of the corresponding sample moment
m(θ̂ ) =

n

(di (yi ) − pi (xi , θ̂ )).

(5.32)

i=1

This is clearly a CM test, presented in Chapter 2.6.3. The CM test statistic is
Tχ 2 = m(θ̂) V̂−
m m(θ̂ ),

(5.33)

where V̂m is a consistent estimate of Vm , the asymptotic variance matrix of
m(θ̂ ), and V̂−
m is the Moore-Penrose generalized inverse of V̂m . The generalized
inverse is used because the J × J matrix Vm may not be of full rank. Under
the null hypothesis that the density is correctly specified, that is, that pij (xi , θ )
gives the correct probabilities, the test statistic is chi-square distributed with
rank[V̂m ] degrees of freedom.
The results in Chapter 2.6.3 can be used to obtain Vm , which here usually
has rank[Vm ] = J − 1 rather than J as a consequence of the probabilities
over all J cells summing to one. This entails considerable algebra, and it is
easiest to instead use the asymptotically equivalent OPG form of the test,
which is appropriate because fully parametric models are being considered
here so that θ̂ will be the MLE. The test is implemented calculating n times the
uncentered R 2 from the artificial regression of 1 on the scores si (yi , xi , θ̂ ) and
dij (yi ) − pij (xi , θ̂ ), j = 1, . . . , J − 1, where one cell has been dropped due
to rank[Vm ] = J − 1. In some cases rank[Vm ] < J − 1. This occurs if the
estimator θ̂ is the solution to first-order conditions that set a linear transformation of m(θ̂) equal to zero or is asymptotically equivalent to such an estimator.
An example is the multinomial model, with an extreme case being the binary

5.3 Goodness of Fit

195


logit model whose first-order conditions imply ni=1 (dij (yi ) − pij (xi , θ̂ )) = 0,
j = 0, 1.
The test statistic (5.33) is called the chi-square goodness-of-fit test, because
it is a generalization of Pearson’s chi-square test,
J
j =1

(npj − np̂j )2
.
np̂j

(5.34)

In an exercise it is shown that (5.34) can be rewritten
 as (5.33) in the special case
in which Vm is a diagonal matrix with i th entry ni=1 pij (xi , θ ). Although this is
the case in the application originally considered by Pearson – yi is iid and takes
only J discrete values and a multinomial MLE is used – in most regression
applications the more general form (5.33) must be used. The generalization
of Pearson’s original chi-square test by Heckman (1984), Tauchen (1985),
Andrews (1988a, 1988b), and others is reviewed in Andrews (1988b, pp. 140141). For simplicity we have considered partition of the range of y into J cells.
More generally the partition may be over the range of (y, x).
Example: Takeover Bids (Continued)
We consider goodness-of-fit measures for the Poisson model estimates given
in Table 5.3. The Pearson statistic (5.18) is 86.58, much less than its theoretical
value of n − k = 116, indicating underdispersion. The deviance statistic (5.21)
is 88.61. The Poisson deviance in the intercept-only model is 121.86, so R 2
given in (5.26) equals 1 − 88.61/121.86 = 0.27. The Pearson R 2 given in
(5.29) equals 1 − 86.58/147.49 = 0.41. Note that these two R 2 measures are
still valid if the conditional variance equals αμi rather than μi and can be
easily computed using knowledge of the deviance and Pearson statistics plus
the frequency distribution given in Table 5.1. Although experience with these R 2
measures is limited, it seems reasonable to conclude that the fit is quite good
for cross-section data. A third R 2 measure, the squared correlation between
actual and fitted values, equals 0.26. If one instead runs an OLS regression, the
R 2 equals 0.24.
Before performing a formal chi-square goodness-of-fit test, it is insightful
to compare predicted relative frequencies p̂j with actual relative frequencies
pj . These are given in Table 5.6, where counts of five or more are grouped into
the one cell to prevent cell sizes from getting too small. Clearly the Poisson
overpredicts greatly the number of zeros and underpredicts the number of ones.
The last column of Table 5.6 gives n(p j − p̂j )2 /p̂j , which is the contribution
of count j to Pearson’s chi-square test statistic (5.34). Although this test statistic,
whose value is 31.58, is inappropriate due to failure to control for estimation
error in p̂j , it does suggest that the major contributors to the formal test will be
the predictions for zeroes and ones. The formal chi-square test statistic (5.33)
yields a value 48.66 compared to a χ 2 (5) critical value of 9.24 at 5%. The
Poisson model is strongly rejected.

196

Model Evaluation and Testing

Table 5.6. Takeover bids: Poisson MLE predicted and actual
probabilities
Counts

Actual

Predicted

|Diff|

Pearson

0
1
2
3
4
≥5

0.071
0.500
0.246
0.095
0.048
0.040

0.213
0.298
0.233
0.137
0.068
0.052

0.142
0.202
0.013
0.041
0.020
0.012

11.88
17.32
0.10
1.58
0.77
0.00

Note: Actual, actual relative frequency; predicted, predicted relative frequency;
|Diff|, absolute difference between predicted and actual probabilities; Pearson,
contribution to Pearson chi-square test.

We conclude that the Poisson is an inadequate fully parametric model, due to
its inability to model the relatively few zeroes in the sample. Analysis of the data
by Cameron and Johansson (1997) using alternative parametric models – Katz,
hurdle, double Poisson, and a flexible parametric model – is briefly discussed
in Chapter 11.2.3. Interestingly, none of the earlier diagnostics, such as residual
analysis, detected this weakness in the Poisson estimates.
5.4 DISCRIMINATING AMONG NONNESTED
MODELS
Two models are nonnested models if neither model can be represented as a
special case of the other. A further distinction can be made between models that
are overlapping, in which case some specializations of the two models are equal,
and models that are strictly nonnested, in which case there is no overlap at all.
Models based on the same distribution that have some regressors in common and
some regressors not in common are overlapping models. Models with different
nonnested distributions and models with different nonnested functional forms
for the conditional mean are strictly nonnested. Formal definitions are given in
Pesaran (1987) and Vuong (1989).
The usual method of discriminating among models by hypothesis test of
the parameter restrictions that specialize one model to the other – for example
whether the dispersion parameter is zero in moving from the negative binomial
to Poisson – is no longer available.
Instead, for likelihood-based models two approaches are taken. First, beginning with Akaike (1973) likelihood-based models are compared on the basis of
the fitted log-likelihood with penalty given for a lack of parsimony. This is similar to comparing linear models estimated by OLS on the basis of adjusted R 2 .
Second, beginning with Cox (1961, 1962a), hypothesis testing is performed,
but in a nonstandard framework where the usual LR test no longer applies.
We focus on these approaches because most richer count models that we wish

5.4 Discriminating among Nonnested Models

197

to discriminate between, such as hurdle, zero-inflated, and finite mixtures, are
likelihood-based.
The Cox approach has spawned a variety of related procedures, including
extensions beyond the likelihood framework. These extensions, often limited to
linear models, are not presented here. A brief review of these extensions is given
in Davidson and MacKinnon (1993, chapter 11). Artificial nesting, proposed
by Davidson and MacKinnon (1984), leads to J -tests and related tests. The
encompassing principle, proposed by Mizon and Richard (1986), leads to a
quite general framework for testing one model against a competing nonnested
model. White (1994) and Lu and Mizon (1996) link this approach with CM
tests. Wooldridge (1990b) derived encompassing tests for the conditional mean
in nonlinear regression models with heteroskedasticity, including GLMs such
as the Poisson estimated by QML.
5.4.1

Information Criteria

For comparison of nonnested models based on maximum likelihood, several
authors beginning with Akaike (1973) have proposed model selection criteria based on the fitted log-likelihood function. Because we expect the loglikelihood to increase as parameters are added to a model, these criteria penalize models with larger k, the number of parameters in the model. This penalty
function may also be a function of n, the number of observations.
Akaike (1973) proposed the Akaike information criterion,
AIC = −2 ln L + 2k,

(5.35)

with the model with lowest AIC preferred. The term information criterion
is used because the log-likelihood is closely related to the Kullback-Liebler
information criterion. Modifications to AIC include the Bayesian information
criterion,
BIC = −2 ln L + (ln n) k,

(5.36)

proposed by Schwarz (1978), and the consistent Akaike information criterion,
CAIC = −2 ln L + (1 + ln n) k.

(5.37)

These three criteria give increasingly large penalties in k and n. As an example,
suppose we wish to compare two models where one model has one more
parameter than the other, so k = 1, and the sample size is n = 1,000, so
ln n = 6.9. For the larger model to be preferred it needs to increase 2 ln L by
1.0 if one uses AIC, 6.9 if BIC is used, and 7.9 if CAIC is used. By comparison
if the two models were nested and a likelihood ratio test was formed, the larger
model is preferred at significance level 5% if 2 ln L increases by 3.84. The AIC,
BIC, and CAIC in this example correspond to p values of, respectively, 0.317,
0.009, and 0.005.

198

Model Evaluation and Testing

5.4.2

Tests of Nonnested Models

There is a substantial literature on discrimination among nonnested models
on the basis of hypothesis tests, albeit they are nonstandard tests. Consider
choosing between two nonnested models – model Fθ with density f (yi |xi , θ )
and model Gγ with density g(yi |xi , γ ).
The LR statistic for the model Fθ against Gγ is
LR(θ̂ , γ̂ ) ≡ Lf (θ̂) − Lg (γ̂ ) =

n

i=1

ln

f (yi |xi , θ̂ )
.
g(yi |xi , γ̂ )

(5.38)

In the special case where the models are nested, Fθ ⊂ Gγ , we get the usual
result that 2 times LR(θ̂, γ̂ ) is chi-square distributed under the null hypothesis
that Gγ = Fθ . Here we consider the case of nonnested models in which Fθ 
Gγ and Gγ  Fθ . Then the chi-square distribution is no longer appropriate.
Cox (1961, 1962a) proposed solving this problem by applying a central limit theorem under the assumption that Fθ is the true model. This
approach is difficult to implement because it requires analytically obtaining
Ef [ln(f (yi |xi , θ )/g(yi |xi , γ ))], where Ef denotes expectation with respect to
the density fi (yi |xi , θ ). Furthermore, if a similar test statistic is obtained with
the roles of Fθ and Gγ reversed, it is possible to find both that model Fθ is
rejected in favor of Gγ and that model Gγ is rejected in favor of Fθ .
Vuong (1989) instead discriminated between models on the basis of their
distance from the true data-generating process, which has unknown density
h0 (yi |xi ), where distance is measured using the Kullback-Liebler information
criterion. He proposed the use of the statistic
9
n
1  f (yi |xi , θ̂ )
ln
ω̂
(5.39)
TLR,NN = √
n i=1 g(yi |xi , γ̂ )
:
1
= √ LR(θ̂ , γ̂ ) ω̂,
n
where
2  n
2

n
1
1  f (yi |xi , θ̂ )
f (yi |xi , θ̂ )
−
ln
ln
ω̂ =
n i=1
g(yi |xi , γ̂ )
n i=1 g(yi |xi , γ̂ )
2

is an estimate of the variance of

(5.40)

√1 LR(θ̂ , γ̂ ).
n

An alternative asymptotically
 
equivalent statistic instead uses 
ω in (5.39), where 
ω2 = n1 ni=1 ln(f (yi |xi ,
2
θ̂)/g(yi |xi , γ̂ )) .
For strictly nonnested models,
d

TLR,NN → N[0, 1]

(5.41)

5.4 Discriminating among Nonnested Models

under
H0 : Eh ln


f (yi |xi , θ )
= 0,
g(yi |xi , γ )

199

(5.42)

where Eh denotes expectation with respect to the (unknown) dgp h(yi |xi ). One
therefore rejects at significance level .05 the null hypothesis of equivalence of
the models in favor of Fθ being better (or worse) than Gγ if TLR,NN > z.05 (or
if TLR,NN < −z.05 ). The null hypothesis is not rejected if |TLR,NN | ≤ z.025 .
Tests of overlapping models are more difficult to implement than tests of
strictly nonnested models because there is a possibility that f (yi |xi , θ ∗ ) =
g(yi |xi , γ ∗ ), where θ ∗ and γ ∗ are the pseudotrue values of θ and γ . To eliminate
the possibility of equality, Vuong (1989) shows that
2

as

Pr nω̂2 ≤ x − Mp+q (x; λ̂ ) → 0,
for any x > 0, under
H0ω : V0 ln


f (yi |xi , θ )
= 0,
g(yi |xi , γ )

(5.43)

(5.44)

where Eh denotes expectation with respect to the (unknown) dgp h(yi |xi ) and
2
θ and γ have dimensions p and q. Mp+q (x; λ̂ ) denotes the cdf of the weighted
p+q 2 2
2
sum of chi-squared variables j =1 λ̂j Zj , where Zj2 are iid χ 2 (1) and λ̂j are
the squares of the eigenvalues of the sample analog of the matrix W defined
in Vuong (1989, p. 313). One therefore rejects H0ω if nω̂2 exceeds the critical
value obtained using (5.43). If H0ω is not rejected, it is concluded that the data
cannot discriminate between Fθ and Gγ . If H0ω is rejected then proceed to
discriminate between Fθ and Gγ on the basis of the same test of H0 as used in
the case of strictly nested models.
Vuong (1989, p. 322) also considers the case in which one of the overlapping
models is assumed to be correctly specified, an approach qualitatively similar
to Cox (1961, 1962a), in which case
as

Pr nω̂2 ≤ x − Mp+q (x; λ̂) → 0,

(5.45)

can be used as the basis for a two-sided test.
Example: Takeover Bids (Continued)
The Poisson model is clearly not the correct parametric model for the takeover
bids data because from section 5.2.5 the data are underdispersed and from
Table 5.6 the model greatly underpredicts zeroes and overpredicts ones. The
standard parametric generalization of the Poisson, the negative binomial, is not
estimable because the data are underdispersed.
Instead we consider a Poisson hurdle model and zero-inflated Poisson as
alternatives to the Poisson, where the original list of regressors is used for both
parts of the hurdle and zero-inflated Poisson models. For additional alternative
models for these data, see Cameron and Johansson (1997).

200

Model Evaluation and Testing

Table 5.7. Takeover bids: Information criteria for
alternative parametric models

n
k
lnL
AIC
BIC

Poisson

Hurdle Poisson

126
10
−184.9
−389.9
−418.3

126
20
−159.5
−359.0
−415.7

Zero-inflated Poisson
126
20
−180.0
−400.0
−456.7

Notes: n is number of observations; k is number of regressors; AIC is
Akaike information criterion; BIC is Bayesian information criterion.

Results are given in Table 5.7. Larger (less negative) values of ln L, AIC, and
BIC are preferred. Both alternatives to the Poisson increase the log-likelihood
as expected, but involve more parameters. These alternative models are still
preferred using AIC, which has a small penalty for additional parameters.
Using BIC, which has a large penalty, only the hurdle Poisson is preferred to
Poisson, but not by much.
As an example of the test of Vuong we consider comparison of the Poisson
and ZIP models. The test statistic TLR,NN defined in (5.39), with ZIP density
f and Poisson density g, equals 2.05. This favors the ZIP model with p value
Pr[Z > 2.05] = 0.020. So the ZIP model is clearly favored at significance level
5%.
5.5 TESTS FOR OVERDISPERSION
Hypothesis tests on regression coefficients and dispersion parameters in count
data models involve straightforward application of the theory in Chapter 2.6. A
general approach is the Wald test. If the maximum likelihood framework, for
example a negative binomial model, is used, one can additionally use LR and
LM tests. This theory has already been applied in Chapter 3 to basic count data
models and is not presented here.
In the remainder of this chapter we instead tests for adequate model specification. In this section we consider in detail the tests of overdispersion introduced
in Chapter 3.5. In section 5.6 we consider in further detail conditional moment
tests introduced in Chapter 2.6.3.
5.5.1

LM Test for Overdispersion against Katz System

Tests for overdispersion are tests of the variance-mean equality imposed by the
Poisson against the alternative that the variance exceeds the mean. They are
implemented by tests of the Poisson with mean μi and variance μi , against the
negative binomial with mean
E[yi |xi ] = μi = μi (xi , β)

(5.46)

5.5 Tests for Overdispersion

201

and variance
V[yi |xi ] = μi + αg(μi ),

(5.47)

for specified function g(μi ). Usually g(μi ) = μi or g(μi ) = μ2i . The null
hypothesis is
H0 : α = 0.

(5.48)

Such tests are easily implemented as LR, Wald, or LM tests of H0 against
Ha : α > 0. These are presented in Chapter 3. As noted there, the usual critical
values of the LR and Wald cannot be used, and adjustment needs to be made
because the null hypothesis α = 0 lies on the boundary of the parameter space
for the negative binomial, which does not permit underdispersion.
Tests for underdispersion, or variance less than the mean, can be constructed
in a similar manner. One needs a distribution that permits underdispersion and
nests the Poisson. The Katz system, defined in Chapter 4, has this property.
For overdispersed data it equals the commonly used negative binomial. For
underdispersed data, however, the Katz system model is not offered as a standard model in count data packages. The LM test, which requires estimation
only under the null hypothesis of Poisson, is particularly attractive for the
underdispersed case.
Derivation of the LM test of Poisson against the Katz system, due to Lee
(1986), who considered g(μi ) = μi and g(μi ) = μ2i , is not straightforward.
In section 5.7 it is shown that for the Katz system density with mean μi and
variance μi + αg(μi )

n

∂L 
∂μi
=
μ−1
(5.49)
i (y − μi )
∂β α=0
∂β
i=1

n

∂L 
1 −2
=
μi g(μi ){(yi − μi )2 − yi }.
∂α α=0
2
i=1
The LM test is based on these derivatives evaluated at the restricted MLE, which
is θ̂ = (β̂  α̂) = (β̂  0) , where β̂ is the Poisson MLE. But the first summation
in (5.49) equals the derivative with respect to β of the Poisson log-likelihood
with general conditional mean μi (β), so ∂L/∂β|β=β̂,α=0 = 0 and hence
⎡
⎤

0
∂L 
⎦.
(5.50)
= ⎣
∂θ β=β̂,α=0
n
−2
1
2
μ̂
g(
μ̂
)
{(y
−
μ̂
)
−
y
}
i
i
i
i
i=1 i
2
To construct the LM test defined earlier in Chapter 2.6.1, we additionally need
a consistent estimate of the variance matrix, which by the information matrix
equality is the limit of

T −1 E[( ∂L/∂θ|α=0 )( ∂L/∂θ  α=0 )].

202

Model Evaluation and Testing

Now under the null hypothesis that y ∼ P[μ],
E[(y − μ)2 ] = μ

(5.51)

E[{(y − μ) − y}(y − μ)] = 0
2

E[{(y − μ)2 − y}2 ] = 2μ2 .
This implies
⎡
 
n
−1 ∂μi ∂μi
∂ 2 L 
i=1 μi
⎣
∂β ∂β 
E
=
∂θ∂θ  α=0
0

⎤
0
n

⎦ . (5.52)

1 −2 2
i=1 2 μi g (μi )

Given (5.50) and (5.52) the LM test statistic in Chapter 2.6.1 is constructed.
This will be a (k + 1) × (k + 1) matrix with zeroes everywhere except for the
last diagonal entry. Taking the square root of this scalar yields
 n
−1/2 n
1
1
−2 2
2
TLM =
μ̂i g (μ̂i )
μ̂−2
i g(μ̂i ){(yi − μ̂i ) − yi }. (5.53)
2
2
i=1
i=1
Because the negative binomial is the special case α > 0 of the Katz system, this statistic is the LM test for Poisson against both negative binomial
overdispersion and Katz system underdispersion. At significance level .05, for
example, the null hypothesis of equidispersion is rejected against the alternative
hypothesis of overdispersion if TLM > z.05 , of underdispersion if TLM < −z.05 ,
and of over- or underdispersion if |TLM | > z.025 .
Clearly one can obtain different LM test statistics by nesting the Poisson in
other distributions. In particular, Gurmu and Trivedi (1993) nest the Poisson in
the double Poisson, a special case of nesting the LEF in the extended LEF that
they more generally consider, and obtain a test statistic for overdispersion that
is a function of the deviance statistic.
The LM test for Poisson against the negative binomial has been extended
to positive Poisson models by Gurmu (1991) and to left- and right-truncated
Poisson models by Gurmu and Trivedi (1992). These extensions involve a
number of complications, including non-block-diagonality of the information
matrix so that the off-diagonal elements in the generalization of (5.52) are
nonzero.
5.5.2

Auxiliary Regressions for LM Test

As is usual for test statistics, there are many asymptotically equivalent versions
under H0 of the overdispersion test statistic TLM given in (5.53). Several of
these versions can be easily calculated from many different auxiliary OLS
regressions. Like TLM they are distributed as N[0, 1], or χ 2 (1) on squaring,
under H0 .
The auxiliary OPG regression for the LM test given in Chapter 2.6.1
uses the uncentered explained sums of squares from OLS regression of 1

5.5 Tests for Overdispersion

203


−1
2

on 12 μ̂−2
i g(μ̂i ){(yi − μ̂i ) − yi } and μ̂i (yi − μ̂i ) ∂μi /∂β β̂ . The square root
of this is asymptotically equivalent to TLM .
An asymptotically equivalent variant of this auxiliary regression is to
use the uncentered explained sums of squares from OLS regression of 1
2
is possible since
on 12 μ̂−2
i g(μ̂i ){(yi − μ̂i ) − yi } alone. This simplification

−1
1 −2
2

μ̂
g(
μ̂
){(y
−
μ̂
)
−
y
}
and
μ̂
(y
−
μ̂
)
∂μ
/∂β
are
asymptotically
i
i
i
i
i
i
i
i
2 i
β̂
2
uncorrelated
because for the Poisson  E[{(yi − μi ) − yi }(yi − μi )] = 0 by

(5.51) and ni=1 μ̂−1
i (yi − μ̂i ) ∂μi /∂β β̂ = 0 by the first-order conditions for
the H0 Poisson MLE. The square root of the explained sum of squares is

T∗LM

=

n 

1

2

i=1

×

n

1
i=1

2

2

−1/2
2
μ̂−4
i g (μ̂i ){(yi

− μ̂i ) − yi }
2

2

(5.54)

2
μ̂−2
i g(μ̂i ){(yi − μ̂i ) − yi },

using the result that the square root of the uncentered
explained
sum of squares


from regression of yi∗ on the scalar xi is ( i xi2 )−1/2 i xi yi∗ . This test is
asymptotically equivalent to TLM , as for the Poisson
E


1 −2
μi {(yi − μi )2 − yi }2 = 1,
2

(5.55)

by the last equation in (5.51).
In the special case g(μi ) = μli , Cameron and Trivedi (1986) proposed using
an alternative variant of TLM . For general g(μi ), this variant becomes

T∗∗
LM

=

1  1 −2
μ̂ {(y − μ̂i )2 − yi }2
n i=1 2 i

×

n

n

1
i=1

2

−1/2  n
1
i=1

2

−1/2
2
μ̂−2
i g (μ̂i )

2
μ̂−2
i g(μ̂i ){(yi − μ̂i ) − yi }.

(5.56)

This is asymptotically equivalent to TLM because the first term in the parentheses
has plim unity by (5.55). This can be computed as the square root of n times the
uncentered explained sum of squares from the OLS regression of 12 μ̂−1
i {(yi −
μ̂i )2 − yi } against 12 μ̂−1
g(
μ̂
).
i
i
∗
In general the t-test from the
yi =∗ αxi + ui , where xi is a scalar,
 regression
2 −1/2
can be shown to equal (1/s)( i xi )
i xi yi , where s is the standard error
of this regression. For the regression,
√
√
( 2μ̂i )−1 {(yi − μ̂i )2 − yi } = ( 2μ̂i )−1 g(μ̂i ) α + vi ,

(5.57)

204

Model Evaluation and Testing

it follows that the t-statistic for α = 0 is

−1/2 n
n

1
1 −2 2
∗∗∗
2
2
μ̂i g (μ̂i )
μ̂−2
TLM = s
i g(μ̂i ){(yi − μ̂i ) − yi },
2
2
i=1
i=1
(5.58)
where
1 √
( 2μ̂i )−2 {(yi − μ̂i )2 − yi − g(μ̂i ) α̂}2 .
n − 1 i=1
n

s2 =

(5.59)

This test is asymptotically equivalent to TLM , because plim s 2 = 1 under H0
on setting α = 0 and using the moment condition (5.55). This is the regression given in Chapter 3.4, on elimination of 12 from both sides of the regression and letting g(μi ) = μ2i for tests against NB2 and g(μi ) = μi for tests
against NB1.
In principle the LM test statistic can be computed using any of the many
auxiliary regressions, because they are all asymptotically equivalent under H0 .
In practice, however, the computed values can differ significantly. This is made
clear by noting that asymptotic equivalence is established using assumptions,
such as E[{(yi − μi )2 − yi }2 ] = 2μi , which hold only under H0 .
The regression (5.57) has a physical interpretation, in addition to being a
computational device. It can be viewed as a WLS regression based on testing
whether α = 0 in the population moment condition
E[(yi − μi )2 − yi ] = αg(μi ).

(5.60)

This moment condition is implied by the alternative hypothesis given by (5.46)
and (5.47). Tests based on (5.60) of overdispersion or underdispersion, under
much weaker stochastic assumptions than Poisson against the Katz system,
were proposed by Cameron and Trivedi (1985, 1990a). Their testing approach
is presented in section 5.6.
5.5.3

LM test against Local Alternatives

Cox (1983) proposed a quite general method to construct the LM test statistic
without completely specifying the density under the alternative hypothesis. The
general result is presented before considering specialization to overdispersion
tests.
Let y have density f (y|λ), where the scalar parameter λ is itself a random
variable, distributed with density p(λ|μ, τ ) where μ and τ denote the mean and
variance of λ. This mixture distribution approach has already been presented
in Chapter 4. For example, if y is Poisson distributed with parameter λ where
λ is gamma distributed, then y is negative binomial distributed, conditional on
the gamma distribution parameters.

5.5 Tests for Overdispersion

205

Interest lies in the distribution of y given μ and τ :

h(y|μ, τ ) = f (y|λ)p(λ|μ, τ )dλ.

(5.61)

A second-order Taylor series expansion of f (y|λ) about λ = μ yields

h(y|μ, τ ) = {f (y|μ) + f  (y|μ)(λ − μ)
1
+ f  (y|μ)(λ − μ)2 ) + R}p(λ|μ, τ )dλ,
2

(5.62)

where f  (·) and f  (·) denote the first and second derivatives, respectively, and
R is a remainder term. Cox (1983) considered
√ only small departures of λ from
its mean of μ, specifically V[λ] = τ = δ/ n, where δ is finite nonzero. After
considerable algebra, given in section 5.7, this can be reexpressed as


1
τ
h(y|μ, τ ) = f (y|μ) exp
2



∂ 2 ln f (y|μ)
+
∂μ2



∂ ln f (y|μ)
∂μ

2


+ O(n−1 ).
(5.63)

Cox (1983) considered LM (or score) tests against this approximation to the
alternative hypothesis density, which from (5.63) reduces to the null hypothesis
density f (y|μ) if τ = 0.
√
For application to the Poisson
√ we suppose V[λ] = τ = δg(μ)/ n, which
implies V[y] = μ +√δg(μ)/ n. Then in (5.47) we are considering local
alternatives
α = δ/ n. The log-likelihood under local alternatives is L =
n
ln
h(y
i |μi , τ ) and
i=1



n

∂L 
1
∂ 2 ln f (yi |μi )
∂ ln f (yi |μi ) 2
=
)
+
g(μ
. (5.64)
i
∂α α=0
2
∂μi
∂μ2i
i=1
If f (yi |μi ) is the Poisson density, this yields

n



1
∂L 
(yi − μi )2 − yi ,
=
g(μi )μ−2
i

∂α α=0
2
i=1

(5.65)

which is exactly the same as the second term in (5.49). The first term,
∂L/∂β|α=0 is also the same as in (5.49), and the LM test statistic is TLM ,
given in (5.53).
The approach of Cox (1983) demonstrates that TLM in (5.53) is valid for
testing Poisson against all local alternatives satisfying (5.46) and (5.47), not just
the Katz system. The general form (5.63) for the density under local alternatives
is clearly related to the information matrix equality. In section 5.6.5 we make
the connection between the Cox test and the information matrix test.

206

Model Evaluation and Testing

5.5.4

Finite-Sample Corrections

A brief discussion of finite sample performance of hypothesis tests in the Poisson and negative binomial models is given by Lawless (1987). He concluded
that the LR test was preferable for tests on regression coefficients, although
none of the methods worked badly in small samples. There was, however,
considerable small-sample bias in testing dispersion parameters.
The standard general procedure to handle small-sample bias in statistical
inference is the bootstrap with asymptotic refinement, detailed in Chapter 2.6.5.
Here we consider LM tests for overdispersion, using an approach due to Dean
and Lawless (1989a) that differs from the Edgeworth expansion and bootstrap.
This method can be applied to any GLM, not just the Poisson.
Consider the LM test statistic for Poisson against NB2 given in (5.53). The
starting point is the result in McCullagh and Nelder (1983, appendix C) that,
for GLM density with mean μi and variance V[yi ], the residual (yi − μ̂i ) has
approximate variance (1 − hii )V[yi ], where hii is the i th diagonal entry of the
hat matrix H defined in (5.12). Applying this result to the Poisson, it follows
that
E[(yi − μ̂i )2 − yi ]  (1 − ĥii )μ̂i − μ̂i  −hii μ̂i .

(5.66)

This leads to small-sample bias under H0 : E[(yi − μi ) − yi ], which can be
corrected by adding ĥii μ̂i to components of the sum in the numerator of (5.53),
yielding the adjusted LM test statistic,
2

TaLM

=

 n
1
i=1

2

−1/2
2
μ̂−2
i g (μ̂i )

n

1
i=1

2

2
μ̂−2
i g(μ̂i ){(yi − μ̂i ) − yi + ĥii μ̂i }.

(5.67)
th

For the Poisson with exponential mean function, ĥii is the i diagonal entry in
W1/2 X(X WX)−1 X W1/2
where W = Diag[μ̂i ] and X is the matrix of regressors.
Dean and Lawless (1989a) considered tests of Poisson against NB2 overdispersion, g(μi ) = μ2i . The method has also been applied to other GLM models.
Application to overdispersion in the binomial model is relatively straightforward and is presented in Dean (1992). Application to a truncated Poisson
model, also a GLM, is considerably more complex and is given by Gurmu and
Trivedi (1992). For data left truncated at r, meaning only yi ≥ r is observed,
the adjusted LM test for Poisson against negative binomial is
TaLM

= Î

αα −1/2

n

1
i=1

2

2
μ̂−2
i g(μ̂i ){(yi − μ̂i ) − yi

+ (2yi − μ̂i − r + 1)λ(r − 1, μ̂i )μ̂i },
where Î αα is the scalar subcomponent for α of the inverse of the information
matrix −E[∂ 2 L/∂θ ∂θ  ] evaluated at θ̂ = (β̂  0) , see Gurmu and Trivedi (1992,

5.6 Conditional Moment Specification Tests

207

p. 350), and λ(r − 1, μ) = f (y, μ)/1 − F (y, μ), where f (·) and F (·) are the
untruncated Poisson density and cdf.
The procedure has a certain asymmetry in that a finite-sample correction
is made only to the term in the numerator of the score test statistic. Conniffe
(1990) additionally considered correction to the denominator term.
This method for small-sample correction of heteroskedasticity tests is much
simpler than using the Edgeworth expansion, which from Honda (1988) is
surprisingly complex even for the linear regression model under normality.
The method cannot be adapted to tests of the regression coefficients themselves,
however, because the score test in this case involves a weighted sum of (yi − μ̂i )
and the method of Dean and Lawless (1989a) yields a zero asymptotic bias for
(yi − μ̂i ). Finite-sample adjustments are most easily done using the bootstrap,
which is actually an empirical implementation of an Edgeworth expansion as
already noted.
5.6 CONDITIONAL MOMENT SPECIFICATION TESTS
The preceding section presented hypothesis tests for overdispersion that are
likelihood based. In this section we instead take a moment-based approach
to hypothesis testing, using the CM test framework. The general approach is
outlined in section 5.6.1. See also Chapter 2.6.3 for motivation and general
theory. The focus is on CM tests of correct specification of the mean and
variance. Key results and links to the LM tests presented earlier are given in
section 5.6.2. Generalization of these results to general cross-section models is
given in section 5.6.3. In section 5.6.4 we present CM tests based on orthogonal
polynomials in (y − μ), an alternative way to use the low-order moments of y.
Two commonly used CM tests, the Hausman test and the information test, are
presented in, respectively, section 5.6.5 and section 5.6.6.
One conclusion from this section is that many insights gained from the linear
regression model with homoskedastic errors require substantial modification
before being applied to even the simple Poisson model. This is because the
Poisson has complications of both the nonlinear conditional mean function and
of heteroskedasticity that is a function of that mean. A better guide is provided
by a binary choice model, such as logit or probit. But even this model is too
limited since the variance function cannot be misspecified in binary choice
models, because it is always the mean times one minus the mean, whereas with
count data the variance function is not restricted to that being imposed by the
Poisson regression model.
5.6.1

Introduction

Suppose a model implies the population moment condition,
E[mi (yi , xi , θ )] = 0,

i = 1, . . . , n,

(5.68)

where mi (·) is an r × 1 vector function. A CM test of this moment condition is
based on the closeness to zero of the corresponding sample moment condition,

208

Model Evaluation and Testing

that is
m(θ̂ ) =

n


m̂i ,

i=1

where m̂i = mi (yi , xi , θ̂ ). The CM test statistic in general is
  n
 −1 n
n




m̂i V
m̂i
m̂i
i=1

i=1

i=1

and is asymptotically chi-square distributed.
Two issues arise in applying CM tests. The first issue is the choice of the
function mi (·). Here we focus on tests based on the first two moments of count
data regression models. The second issue is choosing how to implement the
test. Several asymptotically equivalent versions are available, some of which
can be computed using an auxiliary regression. Here we focus on applications
in which the moment condition is chosen so that mi (·) satisfies

∂mi (yi , xi , θ )
= 0.
(5.69)
E
∂θ 
Then from Chapter 2.6.3 the CM test statistic simplifies to
 n
−1 n
n





 
E[mi m ]
m̂
m̂i .
i

i=1

i

θ̂

i=1

(5.70)

i=1

If mi (·) is a scalar, taking the square root of (5.70) yields the test statistic
 n
−1/2 n



2 
m̂i ,
E[m ]
(5.71)
TCM =
i

θ̂

i=1

i=1

which is asymptotically N[0, 1] if (5.68) and (5.69) hold. An asymptotically
equivalent version is
 n
−1/2 n


m̂2i
m̂i .
(5.72)
T∗CM =
i=1

i=1

Even if (5.69) does not hold, implementation is still simple, provided θ̂ is the
MLE. Then a chi-square test statistic is the uncentered explained sum of squares
from regression of 1 on m̂i and ŝi , where ŝi = ∂ ln f (yi |xi , θ )/∂θ|θ̂ .
If possible CM tests are compared to the LM test, which is a special case
of a CM test and is, of course, the most powerful test if a fully parametric
approach is taken. Particular interest lies in tests of correct specification of the
conditional mean and variance.
For the Poisson regression, the LM test for exclusion of the subcomponent
x2i of xi = [x1i , x2i ] model is a CM test of
E[mi (yi , xi , β 1 )] = E[(yi − μ1i )x2i ] = 0,
where μ1i = exp(x1i β 1 ).

(5.73)

5.6 Conditional Moment Specification Tests

209

For overdispersion, the test of Poisson with variance μi = μ(xi β) against
the Katz system with variance function μi + αg(μi ) is from (5.50) a CM test
of
E[mi (yi , xi , β)] = E[{(yi − μi )2 − yi }μ−2
i g(μi )] = 0.

(5.74)

Note that the simplifying condition (5.69) holds for mi (yi , xi , β) defined in
(5.74), provided (5.74) holds and E[yi − μi ] = 0. It can be shown that for the
moment condition (5.74) the test statistic (5.71) yields TLM given in (5.53), and
the test statistic (5.72) yields T∗LM given in (5.54).
CM tests can be obtained under relatively weak stochastic assumptions.
Several examples are given here, beginning with one in which a regression
provides the motivation or basis for the test, rather than just providing a way to
calculate a test statistic.
5.6.2

Regression-Based Tests for Overdispersion

Consider cross-section data (yi , xi ) where under the null hypothesis the first
two moments are those of the Poisson regression model,
H0 : E[yi |xi ] = μi = μ(xi , β),

V[yi |xi ] = μi ,

(5.75)

V[yi |xi ] = μi + αg(μi ),

(5.76)

while under the alternative hypothesis
Ha : E[yi |xi ] = μi = μ(xi , β),

where g(μi ) is a specified function such as μi or μ2i . The moments (5.76) are
those of, for example, the negative binomial models presented in Chapter 3.3.
The moment condition (5.76) implies
Ha : E[{(yi − μi )2 − yi }|xi ] = αg(μi ),

(5.77)

while H0 imposes the constraint that α = 0. If μi is known one could perform
a t-test of α = 0 based on regression of (yi − μi )2 − yi on g(μi ). Two complications are that μi is unknown and that the error term in this regression is in
general heteroskedastic because the conditional variance of (yi − μi )2 − yi is
a function of μi , say
ωi = ω(μi ) = V[(yi − μi )2 − yi |xi ].

(5.78)

The null hypothesis
H0 : α = 0
can be tested by the t-test of α = 0 in the LS regression
6
6
ω̂i {(yi − μ̂i )2 − yi } = α ω̂i g(μ̂i ) + ui ,

(5.79)

(5.80)

where μ̂i = μ(xi β̂), ω̂i = ω(μ̂i ), and β̂ is a consistent estimator of β under H0 .
The WLS regression is used because it yields the most efficient least squares
regression estimator of α and hence the most powerful or optimal test. In
principle replacing μi by μ̂i leads to a more complicated distribution for α̂.
This is not a problem in this particular application, however, essentially because

210

Model Evaluation and Testing

∂{(yi − μi )2 − yi }/∂β = −2(yi − μi ) ∂μi /∂β has expected value 0 so (5.69)
holds.
6
Standard results for OLS yield the t-test statistic α̂/ V̂[α̂] or

−1/2 n
n


−1 2
OLS
2
2
ω̂i g (μ̂i )
ω̂−1
TCM = s
i g(μ̂i ){(yi − μ̂i ) − yi }, (5.81)
i=1

i=1

where
1  −1
ω̂ {(yi − μ̂i )2 − yi − g(μ̂i ) α̂}2 .
n − 1 i=1 i
n

s2 =

Under H0 , plim s 2 = 1 as α = 0, and one can equivalently use
 n
−1/2 n


−1 2
2
ω̂i g (μ̂i )
ω̂−1
TCM =
i g(μ̂i ){(y − μ̂i ) − yi }. (5.82)
i=1

i=1

Advantages of this approach to testing, in addition to simplicity of use,
include the following:
1. If the first four moments of yi under the null hypothesis are those
of the Poisson, TCM equals the optimal LM test statistic for testing
Poisson against the Katz system.
2. The test is easily adapted to situations in which assumptions on only
the first two moments are made.
3. The test can be given a simple interpretation as a CM test based on
the first two moments of yi .
4. The test is computed from an OLS regression that has interpretation as
a model, rather than being merely a computational device to compute
the statistic.
5. The approach can be generalized to other testing situations.
These points are made clear in the following discussion.
First, in the fully parametric situation in which yi ∼ P[μi ], using formulas
for the first four moments of the Poisson, one obtains ωi = 2μ2i . But then
∗∗∗
TOLS
CM in (5.81) equals TLM , the LM test for Poisson against negative binomial
presented in (5.58), whereas TCM in (5.82) equals TLM given in (5.53).
Second, consider adaptation of the test statistic (5.81) in the case in which
only the first two moments of yi are assumed. Then ωi in (5.78) is unknown.
The least squares regression (5.80) is again run, but with weighting function
ω̂i replaced by v̂i . One might choose v̂i = 2μ̂2i , although one should note that
it is no longer assumed that ωi = 2μ2i . Now the error ui has heteroskedasticity
of an unknown functional form, so the t-test of α = 0 uses robust sandwich
standard errors. The test statistic is
 n
−1/2 n


Robust
2 −1 2
ûi v̂i g (μ̂i )
v̂i−1 g(μ̂i ){(yi − μ̂i )2 − yi }, (5.83)
TCM =
i=1

i=1

5.6 Conditional Moment Specification Tests

211

where û2i = {(yi − μ̂i )2 − yi − α̂g(μ̂i )}2 and α̂ is the least squares estimator in
is asymptotically N[0, 1].
(5.80) with ω̂i replaced by v̂i . Under H0 , TRobust
CM
In the special case that v̂i = 2μ̂2i the test statistic (5.83) provides a variant
of the LM test statistic for overdispersion given in section 5.5 that is robust to
misspecification of the third and fourth moments of yi . This is directly analogous to the modification of the Breusch-Pagan LM test for heteroskedasticity
in the regression model under normality proposed by Koenker (1982) to allow
for nonconstant fourth moments of the dependent variable.
Third, consider a CM test for variance-mean equality. The null hypothesis
(5.75) implies that
E[{(yi − μi )2 − yi }|xi ] = 0,

(5.84)

which in turn implies
E[h(μi ){(yi − μi )2 − yi }] = 0,

(5.85)

where we 
let h(μi ) be a specified scalar function. The test based on closeness
to zero of ni=1 h(μ̂i ){(yi − μ̂i )2 − yi } is a special case of the CM chi-square
test statistic given in Chapter 2.6.3. Because ∂{(yi − μi )2 − yi }/∂β = −2(yi −
μi ) ∂μi /∂β has expected value 0 so (5.69) holds, one can use TCM given in
(5.71)
 n
−1/2 n


2
h (μ̂i )ω̂i
h(μ̂i ){(yi − μ̂i )2 − yi },
(5.86)
TCM =
i=1

i=1

where ωi = E[{(yi − μi )2 − yi }2 |xi ]. TCM is asymptotically N[0, 1] under
(5.84). This test specifies only a moment condition under H0 . Different choices
of function h(μi ) will test in different directions away from H0 , with the optimal choice of h(μi ) depending on the particular alternative to (5.84). The
regression-based approach makes it clear that if the alternative is (5.77) then
the optimal choice is h(μi ) = ω−1
i g(μi ).
Fourth, consider calculation of overdispersion test statistics by an auxiliary regression. The usual approach is to obtain a CM or LM test statistic
and then give ways to calculate the statistic or an asymptotically equivalent
variant of the statistic by an auxiliary regression. This regression has no physical interpretation, being merely a computational device. Such tests are best
called regression-implemented tests, though they are often called regressionbased because their computation is based on a regression. By comparison the
overdispersion test statistic given in this subsection is regression based in the
stronger sense that there is a regression motivation for the test statistic.
The final point, that this regression-based or regression-motivated test
approach generalizes to other testing situations, is outlined in the next subsection.
Regression-based tests for overdispersion were proposed by Cameron and
Trivedi (1985, 1990a). In addition to the regression (5.80) they also considered

212

Model Evaluation and Testing

the t-test of α = 0 in the least squares regression,
6
6
ω̂i {(yi − μ̂i )2 − μ̂i } = α ω̂i g(μ̂i ) + ui .

(5.87)

This replaces yi by μ̂i in the left-hand side, the rationale being that the moment
condition (5.76) implies not only (5.77) but also
Ha : E[{(yi − μi )2 − μi }|xi ] = αg(μi ).

(5.88)

The test based on the regression (5.87) is more difficult to implement because
replacing μi by μ̂i makes a difference in this regression, since ∂{(yi − μi )2 −
μi }/∂β = −{2(yi − μi ) + 1} ∂μi /∂β has nonzero expected value. Cameron
and Trivedi (1985) show that the analog of (5.82) is

TCM,2

⎡
⎤−1/2
n 
n 
n
n


=⎣
ŵij g(μ̂i )g(μ̂j )⎦
ŵij g(μ̂i ){(yj − μ̂j )2 − μ̂j },
i=1 j =1

i=1 j =1

(5.89)
−1  −1
where wij is the ij th entry in W = [D − ( D−1
μ )  ] , D and Dμ are
n × n diagonal matrices with i th entries (2μ2i + μi ) and μi , respectively, and
 is an n × k matrix with i th row ∂μi /∂β  .
The test TCM,2 is a different test from TCM in (5.82), with different power
properties. In particular, TCM,2 is the LM test, and hence the most powerful test,
for testing N[μi , μi ] against N[μi , μi + αg(μi )]. It has already been shown
that TCM is the LM test for P[μi ] against NB2. In addition to greater power
in the standard set-up for overdispersion tests, TCM has the advantage of being
easier to implement.

5.6.3

Regression-Based CM Tests

Suppose that a specified model imposes the conditional moment restriction
E[r(yi , xi , θ )|xi ] = 0,

(5.90)

where for simplicity r(·) is a scalar function. Suppose we wish to test this restriction against the specific alternative conditional expected value for r(yi , xi , θ ),
E[r(yi , xi , θ )|xi ] = g(xi , θ ) α,

(5.91)

where g(·) and α are p × 1 vectors.
The moment condition (5.90) can be tested against (5.91) by test of α = 0
in the regression
r(yi , xi , θ ) = g(xi , θ ) α + εi .

(5.92)

5.6 Conditional Moment Specification Tests

213

The most powerful test of α = 0 is based on the efficient GLS estimator, which
for data independent over i is the WLS estimator,
α̂ =

 n

i=1

1
g(xi , θ )g(xi , θ )
2
σ (xi , θ )

−1

n


1

σ 2 (xi , θ )
i=1

g(xi , θ )r(yi , xi , θ ),
(5.93)

where
σ 2 (xi , θ ) = E0 [r(yi , xi , θ )2 |xi ]

(5.94)

is the conditional variance of r(yi , xi , θ ) under the null hypothesis model.
Tests based on α̂ are equivalent to
tests based on any full rank transformation
of α̂. Most simply, multiply by ni=1 σ −2 (xi , θ )g(xi , θ )r(yi , xi , θ ). This is
equivalent to a CM test of the unconditional moment condition,

1
(5.95)
g(xi , θ )r(yi , xi , θ ) = 0.
E[m(yi , xi , θ )] = E 2
σ (xi , θ )
Note that the unconditional moment (5.95) for the CM test is obtained as a test
of the conditional moment condition (5.90) against the alternative (5.91).
An example already considered is testing variance-mean equality, in which
case r(yi , xi , β) = (yi − μi )2 − yi and g(xi , β) α = αμ2i in the case of overdispersion of the NB2 form. If the Poisson assumption is maintained under the
null, then σ 2 (xi , β) = 2μ2i and the CM test based on the unconditional moment
(5.95) simplifies to a test of
E[(yi − μi )2 − yi ] = 0.

(5.96)

Now consider a CM test based on an unconditional moment condition that
can be partitioned into a product of the form,
E[m∗ (yi , xi , θ )] = E[g∗ (xi , θ )r ∗ (yi , xi , θ )],

(5.97)

∗

where yi only appears through the scalar function r (·). A simple interpretation
of this test is that it is testing failure of the conditional moment condition,
E[r ∗ (yi , xi , θ )|xi ] = 0,

(5.98)

∗

in the direction g (xi , θ ). A much more specific interpretation of the direction of
the test, using (5.95), is that it is testing (5.98) against the conditional moment
condition,
E[r ∗ (yi , xi , θ )|xi ] = σ ∗2 (xi , θ )g∗ (xi , θ ) α,

(5.99)

where
σ ∗2 (xi , θ) = V[r ∗ (yi , xi , θ )|xi ].
Considering again the test of overdispersion of the NB2 form, it is not
immediately apparent what form of overdispersion is being tested by the CM

214

Model Evaluation and Testing

test of (5.96). Using (5.99), however, the test can be viewed as a test against the
alternative E[(yi − μi )2 − yi ] = αμi 2 , where this interpretation uses the result
that the null hypothesis Poisson model implies V[(yi − μi )2 − yi ] = 2μ2i .
To summarize, in the usual case in which interest lies in the expected value of
a scalar function r(yi , xi , θ ) of the dependent variable, CM tests of an explicit
null against an explicit alternative conditional expected value of r(yi , xi , θ )
are easily developed. Going the other way, a CM test for zero unconditional
expected value of the product of r(yi , xi , θ ) and a specified function of xi and
θ can be interpreted as a test of an explicit null against an explicit alternative
conditional expected value of r(yi , xi , θ ).
This approach, called regression-based CM tests by Cameron and Trivedi
(1990c), therefore provides a link between the standard formulation of CM tests
as model misspecification tests in no particular direction and formal hypothesis
tests that test against an explicit alternative hypothesis. Several applications
and extension to the case in which r(yi , xi , θ ) is a vector are given in Cameron
and Trivedi (1990c).
The preceding discussion looks only at the formation of the moment for the
CM test. For actual implementation one can either run regression (5.92) – that
is, replace θ by θ̂ and use
σ −1 (xi , θ̂ ) – or form a test based on the
nweights
−2
sample analog of (5.95), i=1 σ (xi , θ̂ )g(xi , θ̂ )r(yi , xi , θ̂ ). In either case the
distribution is most easily obtained if condition (5.69) holds, which is the case
if in addition to (5.90)

∂r(yi , xi , θ )
= 0.
E
∂θ 

(5.100)

For example, in testing variance-mean equality, the choice ri (yi , xi , θ ) = {(yi −
μi )2 − μi } satisfies (5.100).
In other testing situations it is also possible to construct tests in which (5.100)
holds. In particular, for testing that the correct model for heteroskedasticity is a
specified function v(μi ) against the alternative that V[yi |xi ] = v(μi ) + αg(μi ),
where E[yi |xi ] = μi = μ(xi , β), the choice
r(yi , xi , β) = (yi − μi )2 −

∂v(μi )
(yi − μi ) − v(μi ),
∂μi

(5.101)

satisfies (5.100). The regression-based CM test using (5.101) not only is easy to
implement but also coincides with the LM test of Poisson against negative binomial, the LM test of binomial against the beta-binomial, and the Breusch and
Pagan (1979) test of normal homoskedastic error against normal heteroskedastic error (in which case v(μi ) = v(μi , σ 2 ) = σ 2 ). For details, see Cameron
(1991).
Further examples of regression-based CM tests are given here.

5.6 Conditional Moment Specification Tests

5.6.4

215

Orthogonal Polynomial Tests

In the CM test framework it is natural to focus on tests of correct specification
of the first few conditional moments of the dependent variable. One possibility
is to construct a sequence of tests based on whether the expected values of yik
equal those imposed by the model, for k = 1, 2, 3, . . . . Another is to use central
moments, in which case the sequence is of the expected values of (yi − μi )k
for k = 1, 2, 3, . . . .
An alternative approach, proposed by Cameron and Trivedi (1990b), is
to consider a sequence of orthogonal polynomial functions in yi , in which
case terms in the sequence are uncorrelated. One can additionally consider
orthonormal polynomials, for which terms are orthogonal and normalized to
have unit variance.
For the Poisson density, the orthonormal polynomials are called the GramCharlier polynomial series, with these first three terms:
√
Q1 (y) = (y − μ)/ μ √
Q2 (y) = {(y − μ)2 − y}/ 2μ
(5.102)
6
Q3 (y) = {(y − μ)3 − 3(y − μ)2 − (3μ − 2)(y − μ) + 2μ}/ 6μ3 .
Further terms are obtained using Qj (y) = ∂{(1 + z)y exp(−μz)}/∂z|z=0 . Note
that E[Qj (y)] = 0. These polynomials have the property of orthogonality – that
is, E[Qj (y)Qk (y)] = 0 for j = k – and are normalized so that E[Q2j (y)] = 1.
These properties hold if y is P[μ], and also hold for the first j terms under
the weaker assumption that y has the same first j + k moments as P[μ] for
orthogonality, and the same first 2j moments as P[μ] for orthonormality.
The orthonormal polynomials can be used directly for CM tests. Thus, to test
correct specification of the j th moment of yi , assuming correct specification of
the first (j − 1) moments, use
E[mj (yi , xi , β)] = E[Qj (yi , xi , β) gj (xi , β)] = 0,

(5.103)

where for regression applications Qj (yi , xi , β) is Qj (y) in (5.102) evaluated at μi = μ(xi , β). Using the regression-based interpretation of the
CM test in (5.98) and (5.99), this is a test of E[Qj (yi , xi , β)|xi ] = 0
against E[Qj (yi , xi , β)|xi ] = g(xi , β) α j , where simplification occurs because
V[Qj (yi )] = 1 due to orthonormality. Define the j th central moment of the
Poisson to be μj = E[(y − μ)j ]. Then equivalently, given correct assumption
of the first (j − 1) moments, the CM test (5.103) is a test of E[(yi − μi )j ] = μj
against E[(yi − μi )j ] = μj + g(xi , β) α j . These CM tests are easy to compute,
because for the Poisson the orthonormal polynomials satisfy E[∂Qj (y)/∂μ] =
0, so (5.69) holds.
The orthonormal polynomials can also be used to construct LM tests for the
Poisson against series expansions around a baseline Poisson density. A property
of orthogonal polynomials is that a general density g(y) can be represented as

216

Model Evaluation and Testing

the following series expansion around the baseline density f (y):
⎡
⎤
∞

g(y) = f (y) ⎣1 +
aj Qj (y)⎦ ,
+

j =1

where aj = +Qj (y)g(y)dy and g(y) is assumed to satisfy the boundedness
{g(y)/f* (y)}2 f (y)dy < ∞. Then, because ln g(y) = ln f (y) +
) condition
∞
ln 1 + j =1 aj Qj (y) ,

∂ ln g(y) 
= Qj (y), j = 1, 2, . . . .
∂aj a1 =0,a2 =0,...
This suggests a sequence of score tests for the null hypothesis that the Poisson
density is correctly specified:
E[Qj (yi , xi , β)] = 0,

j = 1, 2, . . . .

(5.104)

For the Poisson, the tests based on orthonormal polynomials equal the
standard LM tests for correct specification of the first two moments. Thus tests
based on Q1 (yi ) = (yi − μi ) coincide with the LM test (5.73) for excluded
variables, whereas tests based on Q2 (yi ) = (yi − μi )2 − yi correspond to the
LM test (5.74) for Poisson against the Katz system. Non-Poisson skewness
can be tested using Q3 (yi ) given in (5.102). This is essentially the same test
as that of Lee (1986) for the Poisson against truncated Gram-Charlier series
expansion.
The CM tests proposed here differ in general from those obtained by considering only the j th central moment. For example, consider a CM test of the
second moment of the Poisson, conditional on correct specification of the first.
Then, because E[(y − μ)2 ] = μ for y ∼ P[μ], the CM test based on the second
central moment is
E[{(yi − μ(xi , β))2 − μ(xi , β)} g2 (xi , β)] = 0.
The test based on the second orthogonal polynomial from (5.102) is
E[{(yi − μ(xi , β))2 − yi } g2 (xi , β)] = 0.
As pointed out at the end of section 5.6.2, for overdispersion tests with
g2 (xi , β) = μ−2
i g(μi ), these different moment conditions lead to quite different
tests.
Key properties of orthogonal and orthonormal polynomials are summarized
in Cameron and Trivedi (1993) and also discussed in Chapter 8. The discussion
here has focused on the Poisson. The properties that the resulting CM tests
coincide with standard LM tests for mean and variance and that the tests are
easy to implement as (5.69) holds carry over to the LEF with quadratic variance
function (QVF). For the LEF-QVF the variance is a quadratic function of
the mean, V[y] = v0 + v1 μ + v2 μ2 , where various possible choices of the
coefficients v0 , v1 , and v2 lead to six exponential families, five of which – the

5.6 Conditional Moment Specification Tests

217

normal, Poisson, gamma, binomial, and negative binomial – constitute the
Meixner class. This is discussed in detail in Cameron and Trivedi (1990b).
Finally, although results are especially straightforward for LEF-QVF densities, one can construct orthogonal polynomial sequences for any assumed
model. In particular, letting μ = E[y] and μj = E[(y − μ)j ] for j = 2, 3, the
first two orthogonal polynomials are
P1 (y) = y − μ
μ
P2 (y) = (y − μ)2 − 3 (y − μ) − μ2 .
μ2

(5.105)

These can be used for tests of the specified conditional mean and variance in
general settings.
5.6.5

Information Matrix Tests

The IM test, introduced in Chapter 2.6.3, is a CM test for fully parametric
models of whether the information matrix equality holds, that is, whether

 2
∂ ln fi ∂ ln fi
∂ ln fi
+
= 0,
(5.106)
E vech
∂θ∂θ 
∂θ
∂θ 
where fi = fi (yi , xi , θ ) is the density. This can be applied in a straightforward
manner to any specified density for count data, such as negative binomial and
hurdle, and is easily computed using the OPG regression given in Chapter
2.6.3.
An interesting question is what fundamental features of the model are being
tested by an IM test. Chesher (1984) showed that, quite generally, the IM test
is a test for random parameter heterogeneity; Hall (1987) showed that for the
linear model under normality, subcomponents of the IM test were tests of heteroskedasticity, symmetry, and kurtosis. Here we focus on Poisson regression.
For the Poisson regression model with exponential mean function, substitution into (5.106) of the first and second derivatives of the log-density with
respect to θ yields
E[{(yi − μi )2 − μi } vech(xi xi )] = 0.

(5.107)

The IM test is a CM test of (5.107). If only the component of the IM test
on the intercept term is considered, the IM test coincides with the LM test
2
of
of form V[yi ] = μ
i + αμi , because the test is based on
noverdispersion
n
2
2
i=1 (yi − μ̂i ) − μ̂i whichequals
i=1 (yi − μ̂i ) − yi since the Poisson
n
first-order conditions imply i=1 (yi − μ̂i ) = 0.
Considering all components of the IM test, (5.107) is of the form (5.97).
Using E[{(yi − μi )2 − μi }2 ] = 2μ2i , this leads to the interpretation of the IM
test as a test of E[{(yi − μi )2 − μi }|xi ] = 0 against E[{(yi − μi )2 − μi }|xi ] =
μ2i vech(xi xi ) α. So the IM test is a test against overdispersion of form V[yi ] =
μi + μ2i vech(xi xi ) α. This result is analogous to the result of Hall (1987) for
the regression parameters subcomponent for the linear regression model under

218

Model Evaluation and Testing

normality. Note, however, that vech(xi xi ) α is weighted by μ2i , whereas in the
linear model the test is simply against V[yi ] = σ 2 + vech(xi xi ) α.
The result (5.107) holds only for an exponential conditional mean. If the
conditional mean is of general form μi = μ(xi β) then the IM test can be shown
to be a CM test of
E

 2




∂ μi
(yi − μi )2 − yi
y i − μi

vech
x
)
= 0.
+
E
vech(x
i
i
μi
∂β∂β 
μ2i
(5.108)

This CM test is a test of both the specification of the variance, through the
second term, and the more fundamental condition that the conditional mean is
misspecified. Similar results for LEF models in general are given in Cameron
and Trivedi (1990d).
The Poisson regression model is a special case of a model in which the
underlying distribution of yi depends only on the scalar μi , which is then
parameterized to depend on a function of k regression parameters, meaning that
the density is of the special form f (yi |μ(xi , β)). It follows that ∂ ln fi /∂β =
(∂ ln fi /∂μi ) (∂μi /∂β) and the IM test (5.106) can be expressed as a test of


 2



∂ μi
∂ ln fi 2
∂ 2 ln fi
∂μi ∂μi
∂ ln fi
vech
+
+E
vech
E
∂μi
∂β∂β 
∂μi
∂β ∂β 
∂μ2i
= 0.

(5.109)

There are clearly two components to the IM test. The first component is a
test of 
whether E[∂ ln fi /∂μi ] = 0, required for consistency of the MLE that
solves ni=1 ∂ ln fi /∂μi (∂μi /∂β) = 0. The second component is a test of the
IM equality in terms of the underlying parameter μi rather than the regression
parameter β.
√
Setting τ = vech((∂μi /∂β)(∂μi /∂β  )) α/ n in (5.63) yields an LM test
of α = 0, which equals the second component of the IM test. It follows
that the second component of the IM test is an LM test that the density is
f (yi |μi ), where μi = μ(xi , β), against the alternative that it is f (yi |λi ) where
√
λi is a random variable with mean μi and vech((∂μi /∂β)(∂μi /∂β  )) α/ n.
Cameron and Trivedi (1990d) show that the complete IM test, with both components, is a test against the alternative that yi has density√f (yi |λi ) where
μi + vech(∂ 2 μi /∂β∂β  )/ n and variance
λi is a random variable with mean
√
 
vech((∂μi /∂β)(∂μi /∂β )) α/ n. So the IM test additionally tests for misspecification of the mean function.
Interpretations of the IM test have ignored the first component of the IM test
because they have focused on the linear model where μi = xi β, in which case
∂ 2 μi /∂β∂β  = 0. In general the components can be negative or positive, and
so they may be offsetting. So even if the first component is large in magnitude,
indicating a fundamental misspecification, a model may pass the IM test. This

5.6 Conditional Moment Specification Tests

219

indicates the usefulness, in nonlinear settings, of determining the moment
conditions being tested by the IM test.
5.6.6

Hausman Tests

One way to test for simultaneity in a single linear regression equation with
iid errors is to compare the OLS and two-stage least squares estimators. If
there is simultaneity the two estimators differ in probability limit, because
OLS is inconsistent. If there is no simultaneity the two estimators will have
the same probability limit, because both are consistent. Tests based on such
comparisons between two different estimators are called Hausman tests, after
Hausman (1978), or Wu-Hausman tests or even Durbin-Wu-Hausman tests
after Wu (1973) and Durbin (1954), who also proposed such tests.
Consider two estimators 
θ and θ̂ where
H0 :
Ha :

plim(
θ − θ̂ ) = 0
plim(
θ − θ̂ ) = 0.

(5.110)

The Hausman test statistic of H0 is
θ − θ̂) V−1
(
θ − θ̂ ),
TH = n (
θ−θ̂

(5.111)

√
d
θ − θ̂) → N[0, Vθ −θ̂ ],
which is χ 2 (q) under H0 , where it is assumed that n(
under H0 . In some applications Vθ −θ̂ is of less than full rank, in which case
is replaced by the generalized-inverse of Vθ −θ̂ and the degrees of freedom
V−1
θ−θ̂
are rank[Vθ −θ̂ ]. We reject H0 if TH exceeds the chi-square critical value.
The Hausman test is easy in principle but difficult in practice due to the need
to obtain a consistent estimate of the variance matrix Vθ −θ̂ . Initial implementations focused on the special case in which 
θ is the fully efficient estimator
under the null, Vθ−θ̂ = Vθ̂ − Vθ . Therefore it is easily computed as the difference between the variance matrices of the two estimators (see Hausman, 1978,
or Amemiya, 1985a, p. 146). An example is linear regression with possible
correlation between regressors and the error, with 
θ the OLS estimator that
is the efficient estimator under the null of no correlation and spherical errors,
whereas θ̂ is the two-stage least squares estimator that maintains consistency
under the alternative. Hausman (1978) gives examples in which the Hausman
test can be computed by a standard test for the significance of regressors in an
augmented regression, but these results are confined to linear models.
More recently, applied research has focused on robust inference, in which
case 
θ is no longer fully efficient. Then one can perform B bootstraps and use
the variance of the B values (
θ b − θ̂ b ), b = 1, . . . , B, to estimate Vθ −θ̂ .
Holly (1982) considered Hausman tests for nonlinear models in the likelihood framework and compared the Hausman test with standard likelihoodbased hypothesis tests such as the LM test. Partition the parameter vector
as θ = (θ 1 , θ 2 ) , where the null hypothesis H0 : θ 1 = θ 10 applies to the first

220

Model Evaluation and Testing

component of θ , and the second component θ 2 is a nuisance parameter vector. Restricted and unrestricted maximum likelihood estimation of θ provides
two estimates 
θ 2 and θ̂ 2 of the nuisance parameter. Suppose the alternative hypothesis is H0 : θ 1 = θ 10 + δ, in which case classical hypothesis tests
are tests of H0 : δ = 0. Holly (1982) showed that by comparison the Haus−1
I21 δ = 0, where
man test based on the difference 
θ 2 − θ̂ 2 is a test of H0 : I22
2
Iij = E ∂ L(θ 1 , θ 2 )/∂θ i ∂θ j . Holly (1987) extended the analysis to the nonlinear hypothesis h(θ 1 ) = 0, with Hausman tests based on linear combinations
D(
θ − θ̂ ) rather than just the subcomponent (
θ 2 − θ̂ 2 ). Furthermore, the model
under consideration may be potentially misspecified, covering the QMLE based
on an exponential family density.
The Hausman test can be used in many count applications, particularly ones
analogous to those in the linear setting such as testing for endogeneity. It should
be kept in mind, however, that the test is designed for situations in which at
least one of the estimators is inconsistent under the alternative. Consider a
Hausman test of Poisson against the NB2 model, where in the latter model
the conditional mean is correctly specified although there is overdispersion
(α = 0). The Poisson MLE is fully efficient under the null hypothesis. Because
the Poisson regression coefficients β maintain their consistency under the
alternative hypothesis; however, common sense suggests that a Hausman test
of the difference between NB2 and Poisson estimates of β will have no power.
In terms of Holly’s framework, θ 1 = α, θ 2 = β, and the Hausman test is a test
−1
I21 δ = 0. But here I21 = 0 from Chapter 3.2. In fact, if the Poisson
of H0 : I22
and NB2 estimates of β are compared, then large values of the Hausman test
statistic reflect more fundamental misspecification, that of the conditional mean.
5.7 DERIVATIONS
5.7.1

Test of Poisson against Katz System

The Katz system density with mean μ and variance μ + αg(μ) can be written
as
f (y) = f (0)

y

l=1

μ + αμ−1 g(μ)(y − l)
,
[1 + αμ−1 g(μ)] (y − l + 1)

for y = 1, 2, . . . ,
(5.112)

where f (0) is the density for y = 0. This density generalizes slightly the
Chapter 4 density, which sets g(μ) = μ μk2 , and changes the index from j to
l = y − j + 1. The log-density is
ln f (y) =

y


ln(μ + αμ−1 g(μ)(y − l)) − ln(1 + αμ−1 g(μ))

l=1

− ln(y − l + 1) + ln f (0).

(5.113)

5.7 Derivations

Then

221

 y

μ−1 g(μ)(y − l)
∂ ln f (y)
μ−1 g(μ)
=
−
∂α
μ + αμ−1 g(μ)(y − l) 1 + αμ−1 g(μ)
l=1
+

∂ ln f (0)
.
∂α

Specializing to H0 : α = 0,
 y



∂ ln f (0) 
∂ ln f (y) 
−2
−1
=
μ
g(μ)(y
−
l)
−
μ
g(μ)
+
∂α α=0
∂α α=0
l=1

∂ ln f (0) 
−2
= μ g(μ){y(y − 1)/2 − μy} +
,
∂α α=0
y
using
l=1 (y − l) = y(y − 1)/2. Because E[∂ ln f (y)/∂α] = 0 under the
usual maximum likelihood regularity conditions, a derivative of the form
∂ ln f (y)/∂α = h(y) + ∂ ln f (0)/∂α implies E[∂ ln f (0)/∂α] = −E[h(y)].
Therefore

∂ ln f (y) 
= μ−2 g(μ){y(y − 1)/2 − μy − E[y(y − l)/2 − μy]}
∂α α=0
= μ−2 g(μ){y(y − 1)/2 − μy − (μ2 /2 − μ2 )}
1
= μ−2 g(μ) {(y − μ)2 − y}.
2
Similar manipulations lead to

∂μ
∂ ln f (y) 
= μ−1 (y − μ) .

∂β
∂β
α=0
n
Using L = i=1 ln f (y) leads directly to (5.49).
5.7.2

LM test against Local Alternatives

We begin with
h(y|μ, τ ) =



{f (y|μ) + f  (y|μ)(λ − μ)

1
+ f  (y|μ)(λ − μ)2 ) + R}p(λ|μ, τ )dλ.
2
Because λ has mean μ and variance τ and τ is O(n−1 ), E[λ − μ] = 0 and
E[(λ − μ)2 ] = τ + O(n−1 ). This implies
1
h(y|μ, τ ) = f (y|μ) + 0 + f  (y|μ)τ + O(n−1 ).
2

222

Model Evaluation and Testing

Now
∂ ln f (y|μ)
f  (y|μ)
=
,
∂μ
f (y|μ)
and
∂ 2 ln f (y|μ)
f  (y|μ) f  (y|μ)2
−
=
∂μ2
f (y|μ)
f (y|μ)2

∂ ln f (y|μ)
f  (y|μ)
−
=
f (y|μ)
∂μ
which implies


f (y|μ) = f (y|μ)



∂ 2 ln f (y|μ)
+
∂μ2



2

,

∂ ln f (y|μ)
∂μ

2

.

Making this substitution yields



∂ ln f (y|μ)
1
∂ 2 ln f (y|μ)
+
h(y|μ, τ ) = f (y|μ) 1 + τ
2
∂μ2
∂μ

2

and using exp(x)  1 + x for small x,
 

∂ 2 ln f (y|μ)
1
∂ ln f (y|μ)
τ
h(y|μ, τ ) = f (y|μ) exp
+
2
∂μ2
∂μ

2


−1

+ O(n ) ,

+ O(n−1 ).

5.8 BIBLIOGRAPHIC NOTES
Key references on residuals include Cox and Snell (1968), who consider a
very general definition of residuals; Pregibon (1981), who extends many of
the techniques for normal model residuals to logit model residuals; McCullagh
and Nelder (1989, chapter 12), who summarize extensions and refinements
of Pregibon’s work to GLMs; and Davison and Snell (1991), who consider
both GLMs and more general models. Discussion of the Pearson and deviance
statistics is given in any GLM review, such as McCullagh and Nelder (1989) or
Firth (1991). In the econometrics literature, generalized residuals and simulated
residuals were proposed by Gourieroux, Monfort, Renault, and Trognon (1987a,
1987b) and are summarized in Gourieroux and Monfort (1995). The material
on R-squared measures is based on Cameron and Windmeijer (1996, 1997).
A comprehensive treatment of the chi-square goodness-of-fit test is given in
Andrews (1988a, 1988b), with the latter reference providing the more accessible
treatment. The LR test for nonnested likelihood-based models was proposed
by Vuong (1989).
There is a long literature on overdispersion tests. Attention has focused on
the LM test of Poisson against negative binomial, introduced in the iid case
by Collings and Margolin (1985) and in the regression case by Lee (1986)
and Cameron and Trivedi (1986). Small-sample corrections were proposed by

5.9 Exercises

223

Dean and Lawless (1989a). A more modern approach is to use a bootstrap
with asymptotic refinement. Efron and Tibshirani (1993) provide an introduction, and Horowitz (1997) covers the regression case in considerable detail.
Treatments of overdispersion tests under weaker stochastic assumptions are
given by Cox (1983), Cameron and Trivedi (1985, 1990a), Breslow (1990),
and Wooldridge (1991a, 1991b). White (1994) considers various specializations that arise for statistical inference with LEF densities and covers the CM
test framework in considerable detail.
5.9 EXERCISES
5.1 Show that if yi ∼ P[μi ] the log-density of yi is maximized with respect to
μi by μi = yi . Conclude that y maximizes L(μ) for the Poisson. Hence show
that for the Poisson the deviance statistic defined in (5.18) specializes to (5.21),
and the deviance residual is (5.3).
5.2 Show that if yi has the LEF density defined in Chapter 2.4.2, then the
log-density of yi is maximized with respect to μi by μi = yi . Conclude that y
maximizes L(μ) for LEF densities. Hence, obtain (5.22) for the deviance of the
NB2 density with α known, using the result in Chapter 3.3.2 that this density
is a particular LEF density.
5.3 For discrete data yi that take only two values, 0 or 1, the appropriate model
is a binary choice model with Pr [yi = 1] = μi and Pr [yi = 0] = 1 − μi . The
y
density f (yi ) = μi i (1 − μi )yi is an LEF density. Show that the deviance R 2
in this case simplifies to R 2 = 1 − (Lfit /L0 ) rather than the more general form
(5.28).
5.4 Show that Pearson’s chi-square test statistic given in (5.34) can be rewritten
using the notation of section 5.3.4 as
  n

 n


(di (yi ) − pi (xi , θ̂ )) D
(di (yi ) − pi (xi , θ̂ )) .
i=1

i=1

Conclude that the test statistic (5.34) is only chi-squaredistributed in the
n
special case in which V−
m in (5.33) equals D. Hint:
i=1 dij (yi ) = np j
n
and
p
(x
,
θ̂
)
=
n
p̂
,
where
D
is
a
diagonal
matrix
with i th entry
j
i=1 ij i

−1
n
.
i=1 pij (xi , θ̂ )
5.5 Obtain the general formula for the t statistic for α = 0 in the linear regression yi∗ = αxi + ui , where xi is a scalar and an intercept is not included. Hence
obtain the regression-based overdispersion test statistic given in (5.81).
5.6 Consider testing whether β 2 = 0 in the regression model E[yi |xi ] =
exp(x1i β 1 + x2i β 2 ). Show that a first-order Taylor series expansion around

224

Model Evaluation and Testing

β 2 = 0 yields E[yi ] = μ1i + μ1i x2i β 2 , where μ1i = exp(x1i β 1 ) and for small
β 2 the remainder term is ignored. Hence test β 2 = 0 using (5.95) for the
regression-based CM test of H0 : E[yi − μ1i |xi ] = 0 against Ha : E[yi −
μ1i |xi ] = μ1i x2i β 2 . Show that when yi ∼ P[μ1i ] under H0 (5.95) is the same
as (5.73), the moment condition for the LM test of exclusion restrictions.
5.7 For yi ∼ P[μi = μ(xi β)] show that the IM test is a test of moment condition (5.108) and specializes to (5.107) if μi = exp(xi β).

CHAPTER 6

Empirical Illustrations

6.1 INTRODUCTION
In this chapter we provide a detailed discussion of empirical models for three
examples based on four cross-sectional data sets. The first example analyzes
the demand for medical care by the elderly in United States and shares many
features of health utilization studies based on cross-section data. The second
example is an analysis of recreational trips. The third is an analysis of completed
fertility – the total number of children born to a woman with a complete history
of births.
Figure 6.1 presents histograms for the four count variables studied; the first
two histograms exclude the highest percentile for readability. Physician visits
appear roughly negative binomial, with a mild excess of zeros. Recreational
trips have a very large excess of zeroes. Completed fertility in both cases is
bimodal, with modes at 0 and 2. Different count data models will most likely
be needed for these different datasets.
The applications presented in this chapter emphasize fully parametric models for counts, an issue discussed in section 6.2. Sections 6.3 to 6.5 deal, in
turn, with each of the three empirical applications. The health care example in
section 6.3 is the most extensive example and provides a lengthy treatment of
model fitting, selecting, and interpreting, with focus on a finite mixture model.
The recreational trips example in section 6.4 pays particular attention to special treatment of zero counts versus positive counts. The completed fertility
illustration in section 6.5 is a nonregression example that emphasizes fitting a
distribution that is bimodal. Section 6.6 pursues a methodological question concerning the distribution of the LR test under nonstandard conditions, previously
raised in Chapter 4.8.5.
The emphasis of this chapter is on practical aspects of modeling. Each
application involves several competing models that are compared and evaluated
using model diagnostics and goodness-of-fit measures. Although the Poisson
regression model is the most common starting point in count data analysis, it
is usually abandoned in favor of a more general mixed Poisson model. This
usually occurs after diagnostic tests reveal overdispersion. But in many cases
225

Empirical Illustrations

0

0

100

200

Frequency
300
200

Frequency
400
600

400

800

226

5
10
15
20
Office Visits to Physicians

25

30

2
4
6
8
10
Completed Fertility: Swiss Data

12

0

5
10
15
20
Recreational Boating Trips

25

0

0

500

200

Frequency
1000 1500

Frequency
600
400

2000

800

0

0

0

2
4
6
8
10
Completed Fertility: British Data

12

Figure 6.1. Histograms for the four count variables.

this mechanical approach can produce misleading results. Overdispersion may
be a consequence of many diverse factors. An empirical model that simply
controls for overdispersion does not shed any light on its source. Tests of
overdispersion do not unambiguously suggest remedies, since they may have
power against many commonplace misspecifications. Rejection of the null
against a specific alternative does not imply that the alternative itself is valid.
Hence misspecifications and directions for model revision should be explored
with care.
6.2 BACKGROUND
Before presenting the empirical studies, we survey two general modeling issues.
The first is the distinction between modeling only the conditional mean versus modeling the full distribution of counts. The second concerns behavioral
interpretation of count models, an issue of importance to econometricians who
emphasize the distinction between reduced form and structural models.
6.2.1

Fully Parametric Estimation

Event count models may have two different uses. In some cases, the main
interest lies in modeling the conditional expectation of the count and in making
inferences about key parameters (e.g., price elasticity). Different models and

6.2 Background

227

estimation methods may yield similar results with respect to the conditional
mean, even though they differ in the goodness of fit.
In other cases, the entire frequency distribution of events will be relevant.
An interesting example is Dionne and Vanesse (1992), in which the entire
distribution of auto accidents is used to derive insurance premium tables as a
function of accident history and individual characteristics. Another example
is the probability distribution of the number of patient days in the hospital as
a function of patient characteristics. These probabilities might be needed to
generate the expected costs of hospital stays.
If the objective is to make conditional predictions about the expected number
of events, the focus would be on the conditional mean function. But if the focus
is on the conditional probability of a given number of events, the frequency
distribution itself is relevant. In the former case, features such as overdispersion may affect prediction intervals, but not mean prediction. In the latter case
overdispersion will affect estimated cell probabilities. Hence parametric methods are attractive in the latter case, whereas robustness of the estimate is more
important in the former.
This neat separation of modeling just the conditional mean versus modeling the distribution is not possible, however, if consistent estimation of the
conditional expectation also requires fully parametric models. For example,
if a zero-inflated model or hurdle model is needed, the conditional mean is
no longer simply exp(x β), and it will vary with the parametric model for the
probabilities. Chapter 3 focused on conditional mean modeling in which other
aspects of the distribution, notably the variance, are modeled only to improve
estimator efficiency. Chapter 4, by contrast, presents many parametric models
in which consistent estimation of the conditional mean parameters requires
fully parametric methods. To conclude, the attention given to features such as
variance function modeling will vary on a case-by-case basis.
To make the foregoing discussion concrete, consider the issue of how to treat
the joint presence of excess zero observations and of long right tails relative
to the Poisson regression. One interpretation of this condition is that it indicates unobserved heterogeneity. Hence it is a problem of modeling the variance
function. The Two Crossings Theorem of Chapter 4.2 supports this interpretation. An alternative interpretation is that the excess zeros reflect behavior.
Many individuals do not record (experience) positive counts because they do
not “participate” in a relevant activity. That is, optimizing behavior generates
corner solutions. On this interpretation, the presence of excess zeros may well
be a feature of the conditional mean function, not the variance function. When
one adds to this the presence of unobserved heterogeneity, it is concluded that
both the conditional expectation and variance function are involved. So the
use of an overdispersed Poisson model, such as the negative binomial, without
also allowing for the additional nonlinearity generated by an excess of corner
solutions, will yield inconsistent estimates of the parameters.
The empirical illustrations in this chapter emphasize modeling the conditional distribution, not just the conditional mean.

228

Empirical Illustrations

6.2.2

Behavioral Interpretation

The Poisson and negative binomial distributions and extensions that are
employed in this chapter can be viewed as reduced-form models. We do not
attempt to give a structural interpretation to the results, though note that counts
that arise from individual decision-making can be given a behavioral interpretation within the random utility framework used in binary choice models.
Consider a single probabilistic event such as a doctor consultation. Denote
by U1 the utility of seeking care, and by U0 the utility of not seeking care. Both
U0 and U1 are latent variables, modeled as
U1i = xi β 1 + ε1i
U0i = xi β 0 + ε0i ,
where xi is the vector of individual attributes, and ε 1i and ε0i are random errors.
Then for individual i who seeks care, we have
U1i > U0i

⇒

ε 0i − ε1i < xi (β 1 − β 0 ).

Individual i seeks care when U1i > U0i , and we then observe yi = 1; otherwise, we observe yi = 0. The probability that yi = 1, denoted π i , is given by
Pr[ε 0i − ε1i < xi (β 1 − β 0 )]. Thus, the probability of the decision to seek care
is characterized by a binary outcome model.
Next consider repeated events of the same kind. If the events are independent
and there is a fixed number, N, of repetitions, the event distribution is the usual
binomial B[N, p]. Suppose instead that N is random and follows the Poisson
distribution. By application of the Poisson-stopped binomial result, see Chapter
1.1.4, the distribution of the number of successes will be Poisson distributed.
This argument justifies the framework of count data models for the study of
repeated events based on event counts.
This argument can be generalized in a straightforward manner to allow for
serial correlation of events or unobserved heterogeneity, both of which imply
overdispersion. The framework also generalizes to the multinomial case where
the observed event is one of k outcomes. For example, the individual may
choose to visit any one of k possible recreational sites, and such a choice
outcome may be repeated a random number of times.
6.3 ANALYSIS OF DEMAND FOR HEALTH CARE
Count models are used extensively in modeling health care utilization. Discrete
measures of health care use such as the number of doctor visits are often more
easily available than continuous data on health expenditures. The measures are
usually obtained from national health or health expenditure surveys that also
provide information on key covariates, such as measures of health insurance,
health status, income, education, and many sociodemographic variables.
This lengthy application begins with a discussion of the data, proposes
a range of count models, and discusses methods to discriminate between the

6.3 Analysis of Demand for Health Care

229

various models. Then the fitted models are compared on the basis of the various
criteria, and the preferred model, a finite mixtures model, is analyzed in greater
detail.
6.3.1

NMES Data

This example draws on Deb and Trivedi (1997), who modeled count data on
medical care utilization by the elderly aged 66 years and over in the United
States, using six mutually exclusive measures of utilization. The article compared the performance of negative binomial (NB), two-part hurdles negative
binomial (NBH), and finite mixture negative binomial (FMNB) models, where
in all cases both NB1 and NB2 versions of NB are specified, in a study of the
demand for medical care.
A sample of 4,406 cases was obtained from the National Medical Expenditure Survey conducted in 1987 and 1988 (NMES). The data provide a comprehensive picture of how Americans use and pay for health services. Here
only one measure, that dealing with the office visits to physicians (OFP), is
considered. A feature of these data is that they do not include a high proportion
of zero counts, but do reflect a high degree of unconditional overdispersion.
The NMES is based on a representative, national probability sample of
the civilian, non-institutionalized population and individuals admitted to longterm care facilities during 1987. Under the survey design of the NMES, more
than 38,000 individuals in 15,000 households across the United States were
interviewed quarterly about their health insurance coverage, the services they
used, and the cost and source of payments of those services. In addition to
health care data, NMES provides information on health status and various
socioeconomic measures.
Access to health insurance is an important determinant of health care use. In
the sample analyzed here, all people are old enough to be covered by Medicare.
This national social insurance program provides basic insurance coverage for
hospital (Part A) and physician, outpatient home health, and preventive services
(Part B). Dental, vision, hearing, long-term nursing care, and, at the time of
these data, pharmaceutical drugs (except those administered in hospital) are
not covered. Two forms of supplemental insurance are available. Medicaid,
a government-provided program for those with low income, is not generous
but covers some services not covered by Medicare. Private insurance can be
obtained in a variety of ways, notably as a stand-alone Medigap policy, through
retiree health insurance, or through an employer if the respondent or spouse is
still working.
This last form of insurance may be an endogenous regressor, because those
with high expected health needs (y) may be more likely to obtain supplementary
insurance (x). Deb and Trivedi (1997) note that basic Medicare covers the
bulk of health care costs for this group, that some private insurance is also
employment-related, and that stand-alone Medigap policies provide strong
financial incentives to choose it at the time of joining Medicare at age 65,

230

Empirical Illustrations

Table 6.1. OFP visits: Actual frequency distribution (n = 4,406)
Number
of visits
0
1
2
3
4
5
6
7
8
9 10 11 12 13+
Frequency 683 481 428 420 383 338 268 217 188 171 128 115 86 500

rather than later as a consequence of a serious health event. These factors
reduce the extent of any endogeneity. Private insurance is treated as exogenous
here. Chapter 10.5 presents an empirical example where insurance is treated as
endogenous.
Table 6.1 presents the frequency distribution of physician office visits. The
zero counts account for only about 15% of the visits. There is a long right tail –
10% of the sample have 13 or more visits and 1% have more than 30. The first
panel of Figure 6.1 gives a histogram, truncated at 30 visits, that suggests there
are some excess zeroes, in addition to the long right tail.
Table 6.2 presents definitions and summary statistics for the explanatory
variables. The health measures include self-perceived measures of health
(EXCLHLTH and POORHLTH), the number of chronic diseases and conditions
Table 6.2. OFP visits: Variable definitions and summary statistics
Variable

Definition

OFP
OFNP
OPP
OPNP
EMR
HOSP
EXCLHLTH
POORHLTH
NUMCHRON
ADLDIFF

Number of physician office visits
5.77
Number of nonphysician office visits
1.62
Number of physician outpatient visits
0.75
Number of nonphysician outpatient visits
0.54
Number of emergency room visits
0.26
Number of hospitalizations
0.30
Equals 1 if self-perceived health is excellent
0.08
Equals 1 if self-perceived health is poor
0.13
Number of chronic conditions
1.54
Equals 1 if the person has a condition that
0.20
limits activities of daily living
Equals 1 if the person lives in northeastern U.S.
0.19
Equals 1 if the person lives in the midwestern U.S. 0.26
Equals 1 if the person lives in the western U.S.
0.18
Age in years divided by 10
7.40
Equals 1 if the person is African American
0.12
Equals 1 if the person is male
0.40
Equals 1 if the person is married
0.55
Number of years of education
10.29
Family income in $10,000s
2.53
Equals 1 if the person is employed
0.10
Equals 1 if the person is covered by
0.78
private health insurance
Equals 1 if the person is covered by Medicaid
0.09

NOREAST
MIDWEST
WEST
AGE
BLACK
MALE
MARRIED
SCHOOL
FAMINC
EMPLOYED
PRIVINS
MEDICAID

Mean

Standard
deviation
6.76
5.32
3.65
3.88
0.70
0.75
0.27
0.33
1.35
0.40
0.39
0.44
0.39
0.63
0.32
0.49
0.50
3.74
2.92
0.30
0.42
0.29

6.3 Analysis of Demand for Health Care

231

(NUMCHRON), and a measure of disability status (ADLDIFF). To control
for regional differences, we use regional dummies NOREAST, MIDWEST,
and WEST. The demographic variables include AGE, race (BLACK), gender
(MALE), marital status (MARRIED), and education (SCHOOL). The economic
variables are family income (FAMINC) and employment status (EMPLOYED).
Finally, the insurance variables are indicator variables for supplementary private
insurance (PRIVINS) and security-net public insurance (MEDICAID). MEDICAID is available to low-income individuals only and should not be confused
with Medicare, which is available to all those over age 65.
6.3.2

Models for Demand for Medical Care

The data are very highly overdispersed with variance of 6.762 = 45.7, that
is eight times the mean of 5.77. So we begin with NB1 and NB2 regression
models.
Several empirical studies of health utilization suggest that a better starting
point is the two-part hurdle model of Chapter 4.5 (Pohlmeier and Ulrich, 1995;
Gurmu, 1997; Geil et al., 1997). It is typically superior to specifications in
which the two separate origins of zero observations are not recognized. The
hurdle model may be interpreted as a principal-agent type model in which the
first part specifies the individual’s decision to seek care and the second part
models the subsequent number of visits recommend by the doctor.
An alternative model, the finite mixture model, has several additional attractive features. It allows for additional population heterogeneity, but avoids the
sharp dichotomy between the population of “users” and “non-users” embodied in the hurdle model. The latent class interpretation of the model splits the
population into classes that may not be well captured by proxy variables such
as self-perceived health status and chronic health conditions. A two-component
finite mixture model can lead to a dichotomy between latent “healthy” and “ill”
groups, whose demands for health care are characterized by, respectively, low
mean and low variance, and high mean and high variance, for a given level of
the exogenous regressors.
6.3.3

NB, Hurdle, and Finite Mixtures Models

Three fully parametric models are compared in this subsection.
The first model is the NB model of Chapter 3.3 with conditional mean
E[yi |xi ] = μi = exp(xi β). The variance is V[yi |xi ] = μi + αμi for the NB1
model and is V[yi |xi ] = μi + αμ2i for the NB2 model, where α > 0 is an
overdispersion parameter. The density for the NB2 model is
α−1
yi
 y +α −1 )
μi
α −1
f (yi |xi , β, α) = (α(−1i)(y +1)
−1
−1
α +μi
α +μi
i
(6.1)
μi = exp(xi β),
whereas the NB1 model replaces all occurrences of α −1 in (6.1) with α −1 μi .

232

Empirical Illustrations

The second model is a hurdle negative binomial model (NBH); see section
4.5. Then
⎧
if k = 0
⎨ f1 (0|xi )
(6.2)
Pr[yi = k|xi ] = 1 − f1 (0|xi )
⎩
f2 (k|xi ) if k > 0.
1 − f2 (0|xi )
Deb and Trivedi (1997) followed Mullahy (1986) and used an NB model for
both parts. So the first component is a binary model for Pr[y = 0], where y is
NB distributed, so for NB2
f1 (0|xi ) = Pr[yi = 0|xi ] = (1 + α 1 exp(xi β 1 ))−1/α ,

(6.3)

−1

and for NB1 replace both occurrences of α −1
1 in (6.3) with α 1 exp(xi β 1 ). For
the second component, the base density for the positive counts f2 (y|xi ) is an
NB density f (yi |xi , β 2 , α 2 ) as defined in (6.1) for the NB2, while NB1 replaces
−1
all occurrences of α −1
2 with α 2 μ2i . The same regressors xi are used in the two
parts of this model. This model has twice as many parameters as an NB model.
The third model is the C-component finite mixture density, see Chapter 4.8,
specified as

f (yi |θ 1 , . . . , θ j , π 1 , . . . , π C−1 ) =

C


π j fj (yi |θ j ),

(6.4)

j =1


where π 1 ≥ π 2 ≥ . . . . ≥ π C , π C = (1 − C−1
j =1 π j ), are mixing probabilities
estimated along with all other parameters, and θ j are the parameters of the
component densities fj (y|θ j ). The finite mixture negative binomial model
(FMNB-C) with C components specifies the components densities fj (yi |θ j ) =
f (yi |β j , α j ), j = 1, . . . , C, to be NB densities. Again the NB2 density is
−1
defined in (6.1), while the NB1 replaces all occurrences of α −1
j with α j μi .
The same regressors xi are used in each component of this model.
A variant of the third model constrains slope coefficients to be equal. Thus
letting x β = α + x γ , we have
μij = exp(α j + xi γ j ) = exp(α j ) exp(xi γ ),
so only the intercept varies across model. This model is called a constrained
FMNB-C model, denoted CFMNB-C. If dim[β] = k, this model has C intercepts, (k − 1) slopes, C overdispersion parameters, and C − 1 mixing probability parameters for a total of k + 3C parameters, which is not much more
than NB with k + 1 parameters. By contrast the unconstrained FMNB-C has
an additional (C − 1)(k − 1) parameters than CFMNB-C due to an additional
(C − 1)k slope parameters. This can be a big difference for the example here,
with 17 regressors including the intercept. In addition, the constrained version
of this model, as noted in Chapter 4.8.1, can be interpreted as providing a
discrete specification of unobserved heterogeneity.

6.3 Analysis of Demand for Health Care

6.3.4

233

Model Selection and Comparison

Before interpreting model estimates, we first choose between the various possible models on the basis of hypothesis tests, where possible, and information
criteria. We also use goodness-of-fit criteria to evaluate whether the preferred
model(s) provides a good fit to the data. In the case of finite mixture models, it
is presumed that there is a finite mixture; consideration of methods to determine
whether there is a finite mixture is deferred to the next subsection.
The analysis here is fully parametric. The obvious method to use to discriminate between models is a likelihood ratio test. This is possible when models
are nested and the LR test statistic has the usual χ 2 (p) distribution, where p
is the difference in the number of parameters in the model. Here this can be
applied for testing NB against NBH, in which case the test statistic is χ 2 (k + 1)
distributed, and for testing CFMNB-C against FMNB-C, in which case the test
statistic is χ 2 (Ck − k) distributed.
Even though a C-component model is nested in a (C–1)-component model,
the standard LR test cannot be applied, because the null hypothesis is on
the boundary of the parameter space; see Chapter 4.8.5. For example, the
two-component mixture density πf (y|θ 1 ) + (1 − π )f (y|θ 2 ) reduces to a onecomponent model if either π = 1 or θ 1 = θ 2 . Thus the standard LR test cannot
be applied to test NB against FMNB-C or to test FMNB (CFMNB) with C − 1
components against C components.
Comparison of any model with NB1 density against any model with NB2
density necessarily involves comparing nonnested models, as does comparing
NBH models against FMNB and CFMNB models. Then it is standard to use the
information criteria presented in Chapter 5.4.1. We use the Akaike information
criterion (AIC) and the Bayesian information criterion (BIC). Note that if the
only difference between any two models is whether NB is specified as NB1 or
NB2, the two models will have the same number of parameters so that smaller
AIC or BIC simply means higher fitted log-likelihood.
Böhning et al. (1994) have used simulation analysis to examine the distribution of the likelihood ratio test for several distributions involving a boundary
hypothesis. This showed that the use of the usual χ 2 critical values underrejects the false null, leading to finite mixture models with a value of C that is
too small. Leroux (1992) proves that under regularity conditions the maximum
penalized likelihood approach (e.g., the use of AIC or BIC) leads to a consistent estimator of the true finite mixture model. This means that as n → ∞ the
number of components will not be underestimated.
A possible strategy for model selection can be summarized as follows:
r Fix maximum C = C ∗ . Use AIC and BIC to compare the sequence of
models FMNB-C∗ , . . . , FMNB-1.
r Use the LR test to compare FMNB-C with CFMNB-C.
r Use the LR test to compare NBH and NB.
r Use AIC and BIC to compare FMNB-C (or CFMNB-C) with NBH.

234

Empirical Illustrations

Table 6.3. OFP visits: Likelihood ratio tests
Null model

Alternative

NB1

NB2

5% Critical Value

NB
NB
NB
CFMNB-2
CFMNB-2
FMNB-2

NBH
CFMNB-2
FMNB-2
FMNB-2
CFMNB-3
FMNB-3

59.8
116.7
166.9
50.2
0.002
11.3

183.4
106.7
136.0
29.2
0.003
0.002

χ 2 (17) = 28.0
χ 2 (3) = 7.8
χ 2 (19) = 30.1
χ 2 (16) = 26.3
χ 2 (3) = 7.8
χ 2 (19) = 30.1

Note: The LR test statistic for the null against the alternative is shown.

This strategy can be used separately for models based on NB1 and models
based on NB2. To compare any NB1 model with any NB2 model, the models
are nonnested, but models in the same class have the same degrees of freedom
so can be simply chosen on the basis of the fitted log-likelihood.
Finally, to evaluate the goodness of fit of the model selected after this
multilevel comparison of models, one may use the chi-square diagnostic test
introduced in Chapter 5.3.4. It compares actual and fitted cell frequencies of
events where cells are formed for the integer values of y (or a range of values
of y). Let p(y)
 denote the actual frequency of the value y in the sample. And
let p̂(y) = n1 ni=1 f (y|xi , θ̂ ) denote the fitted probability of the value y. Stack
p(y) into the vector p. For example, if the cells are formed for y taking values 0,
1, 2, and 3 or more, then p has entries p(0), p(1), p(2), and 1 − p(0) − p(1)−
p(2). Similarly stack p̂(y) into the vector p̂. Then the chi-square goodness-of-fit
statistic is
TGoF = (p − p̂) V̂− (p − p̂),

(6.5)

where V̂ is a consistent estimate of the asymptotic variance matrix of (p − p̂),
and V̂− is the Moore-Penrose generalized-inverse of V̂m . The generalizedinverse is used because the J × J matrix Vm may not be of full rank. Under
the null hypothesis that the density f (y|xi , θ ) is correctly specified, the test
statistic in this application is χ 2 (q − 1) distributed where q is the number
of cells used in the test. This statistic can be computed using the auxiliary
regression presented in Chapter 5.3.4.
The proposed model comparison and selection approach is subject to the
usual criticism that it fails to control for pretest bias. If data availability permits,
this approach should be used on a training sample. Final results should then be
based on the preferred model, reestimated using a sample that is independent
of the training sample.
Table 6.3 presents likelihood ratio tests of NB versus NBH, the unicomponent model versus the two-component models (CFMNB-2 and FMNB-2), and
the two-component models versus the corresponding three-component models.
The NB model is rejected in favor of NBH for both NB1 and NB2 models.
The NB model is also rejected in favor of two-component or three-component

6.3 Analysis of Demand for Health Care

235

Table 6.4. OFP visits: Information criteria (AIC and BIC)
NB1 or NB2

Model

k

lnL

AIC

BIC

TGoF

NB1

NB
NBH
CFMNB-2
FMNB-2
CFMNB-3
FMNB-3

18
36
21
37
24
56

−12156
−12126
−12096
−12073
−12098
−12066

24348
24323
24238
24220a,b
24244
24246

24463
24546
24372c,d
24456
24397
24604

32.3
37.4
6.0
11.2
–
74.3

NB2

NB
NBH
CFMNB-2
FMNB-2
CFMNB-3
FMNB-3

18
36
21
37
24
56

−12202
−12108
−12149
−12134
−12149
−12133

24440
24291a
24340
24342
24346
24380

24555
24515
24474c
24579
24499
24738

58.0
21.8
98.0
123.8
–
137.0

Note:
a Model preferred by the AIC within NB1 class or NB2 class.
b Model preferred by the AIC overall.
c Model preferred by the BIC within NB1 class or NB2 class.
d Model preferred by the BIC overall.
e T
2
GoF is the χ (5) goodness-of-fit test.

mixture models, even though the misuse of the usual critical values for the LR
test in this nonstandard setting means that we have used conservative critical
values.
Though there are problems with the LR test for choosing between twoand three-component mixtures, it is interesting to note that we do not get a
significant LR statistic for any pairwise comparison between two- and threecomponent finite mixture, regardless, whether the NB1 or NB2 mixtures are
used. Essentially adding a third component leads to an improvement in the
log-likelihood only in the case of FMNB for NB1. Finally, within the twocomponent models, the LR test of CFMNB-2 against FMNB-2 model leads to
rejection of the null model at 5% significance level for both NB1 and NB2.
Table 6.4 presents values of the log-likelihood, AIC, and BIC for all the
models. For any model the NB1 version has higher log-likelihood than the
NB2 version. For both NB1 and NB2, the three-component mixture models
lead to very little gain in the log-likelihood compared to the two-component
mixtures. For NB1 models the two-component mixture models are preferred to
the hurdle or standard model. The AIC criterion favors FMNB-2, whereas the
BIC criterion, which has a much bigger penalty for model size, favors the more
parsimonious constrained specification CFMNB-2. Finally for NB2 models
NBH is preferred using AIC, and CFMNB-2 is preferred using BIC.
Clearly a two-component finite mixture NB1 specification is preferred.
Based on AIC and BIC there is some ambiguity about whether to use the
constrained version, but since the constrained version was rejected using an LR
test the preferred model is the NB1 version of FMNB-2. This evidence in favor

236

Empirical Illustrations

of a two-component mixture also allows us to interpret the two populations as
being healthy and ill.
6.3.5

Is There a Mixture?

Specification and ML estimation of the NB and NBH models are straightforward. By contrast, there are important issues in evaluating fitted finite mixture
models. First, is there evidence for the presence of more than one component?
That is, is mixing present? Second, is a global maximum attained in estimation?
These issues were not fully addressed in Chapter 4.8.
Lindsay and Roeder (1992) developed diagnostic tools for checking these
properties for the case of exponential mixtures. The key idea behind the diagnostic for the presence of a mixture component is the Two Crossings Theorem
in Chapter 4.2.4.
Let f (yi |xi , θ ) denote the density of a one-component (or nonmixture)
model and f (yi |xi , C) = f (yi |xi , θ , π ) denote the density of a C-component
mixture model. Then the fitted cell frequencies for the one-component and
C-component models are, respectively,

p̂(y|θ̂ ) = n1 ni=1 f (y|xi , θ̂ ), y = 0, 1, 2, . . .

p̂(y|Ĉ) = n1 ni=1 f (y|xi , Ĉ), y = 0, 1, 2, . . .
By an extension of Shaked’s Two Crossings Theorem, the differences (p̂(y|θ̂ ) −
p̂(y|Ĉ)) or equivalently, ((p̂(y|θ̂ )/p̂(y|Ĉ) − 1) will show a {+, −, +} sign
pattern.
This is the basis of the first of two diagnostic tools developed by Lindsay
and Roeder. Their directional gradient is
d(y, Ĉ, θ̂ ) =

p̂(y|θ̂ )
p̂(y|Ĉ)

− 1,

y = 0, 1, 2, . . . .

(6.6)

Convexity of the graph of d(y, Ĉ, θ̂ ) against y, ideally with confidence bands, is
interpreted as evidence in favor of a mixture. Note, however, that such convexity
may be observed for more than one value of C, leaving open the issue of which
value to select for C. If instead a plot of d(y, Ĉ, θ̂ ) against y is a horizontal
line though zero, then a one-component model is favored.
Lindsay and Roeder also suggest the use of the gradient function

d(y, Ĉ, θ )p(y),
(6.7)
D(Ĉ, θ ) =
y∈S

where d(y, Ĉ, θ ) is evaluated at a range of values
 of θ , S is the set of distinct
values taken by y in the sample, and p(y) = n1 ni=1 1[yi = y] is the proportion
of the sample observations taking value y. This is simply the sample average
of d(yi , Ĉ, θ ) and can be interpreted as a quantitative measure of the deviation
in fitted cell probabilities induced by the mixture as θ varies. The mixing
distribution is an ML estimator if D(Ĉ, θ ) ≤ 0 for all θ and D(Ĉ, θ ) = 0 for all

6.3 Analysis of Demand for Health Care

237

0.06
OFP

0.04
0.02
0
-0.02
-0.04
-0.06

0

1

2

3

4

5 6 7
Count

8

9 10 11

Figure 6.2. OFP visits: Directional gradients.

θ in the support of Ĉ (Lindsay and Roeder, 1992, p. 787). In the case of scalar
θ one can plot D(Ĉ, θ ) against θ . A limitation of the gradient function is that
it can be overly influenced by tail behavior that is noisily estimated, making
the components d(y, Ĉ, θ ) erratic and D(Ĉ, θ ) hard to interpret. Recognizing
this feature, Lindsay and Roeder suggest that a truncated gradient statistic
is preferred for unbounded densities, but there is little guidance on how the
statistic should be truncated.
The diagnostic tools of Lindsay and Roeder are intended for exponential
mixtures. Strictly speaking, they do not apply to NB mixtures (though the two
crossings result is extended to two-parameter exponential families by Gelfand
and Dalal, 1990). In this chapter the directional gradient is nonetheless applied
to the FMNB-C model in a heuristic and exploratory fashion.
Figure 6.2 presents the directional gradient function defined in (6.6) for
FMNB-2 compared with NB for NB1 models. This appears to satisfy the
convexity requirement.
6.3.6

Component Means and Probabilities in the Finite
Mixtures Model

Given selection of a preferred model, the NB1 version of the two-component
finite mixtures model (FMNB-2), we next evaluate it. In this subsection we
evaluate the predicted probabilities and fitted means, both overall and separately, for the two components. In the next subsection we evaluate the role of
individual regressors.
Goodness of fit: Table 6.5 presents the sample frequency distribution of the
count variable along with the sample averages of the estimated cell frequencies
from the selected model. The discrepancy between the actual and fitted cell frequencies is never greater than 1%. Discrepancies between actual and predicted
frequencies based on NB and NBH models (not presented) are usually much

238

Empirical Illustrations

Table 6.5. OFP visits: FMNB-2 NB1 model, actual and fitted distributions,
and goodness-of-fit test
Count
Actual
Fitted
TGoF

0
15.5
15.1

1
10.9
11.5

2
9.7
10.5

3
9.5
9.4

4
8.7
8.2

5
7.7
7.0
14.80

6
6.1
6.0

7
4.9
5.1

8
4.3
4.2

9
3.9
3.6

10+
18.9
19.1

Note: The fitted frequencies are the sample averages of the cell frequencies estimated from the
FMNB-2 NB1 model. TGoF is the χ 2 (13) goodness-of-fit test.

larger. The χ 2 (13) goodness-of-fit statistic, based on cells of 0, 1, . . . , 12 and
13 or more, does not reject the model.
Component means: The probability π 1 for the first component is 0.91,
which is large relative to its estimated standard error of 0.02 (see Table 6.7).
This reinforces the evidence supporting the two-population hypothesis.
The individual means in the two-component NB1 model are μj i =
exp(xi β j ), and the individual variances are σ 2j i = μj i (1 + α j ), for j = 1, 2,
and i = 1, . . . , n. Then for each individual the fitted mean across the two
components is
E[yi |xi ] = μi =

2


(6.8)

π j μj i ,

j =1

where here π 1 = 0.91 and π 2 = 0.09. The model implies an overall variance
of
2
2

π j [μ2j i + σ 2j i ] −
π j μj i
(6.9)
V[yi |xi ] =
j =1
j

2
p−2
=
π j μ2j i (1 + α j μj i ) + μi − μi 2 ,
(6.10)
j =1

where p = 1 for NB1 and p = 2 for NB2.
Table 6.6 summarizes the variability in the two components. The first component (with π 1 = 0.91) clearly captures healthier low-use individuals who
have on average 5.6 visits to a physician and a variance that is five times the
Table 6.6. OFP visits: FMNB-2 NB1 model fitted
means and variances
π1
Low-use group
High-use group
Mixture

0.912
0.088

Mean
5.54
8.18
5.77

Variance
24.88
142.23
41.36

Note: The mixture mean and variance are calculated using (6.8)
and (6.9), respectively.

239

0

0

.05

.05

.1

Density

Density
.15

.1

.2

.25

.15

6.3 Analysis of Demand for Health Care

0

20
40
60
predicted mean: component1

80

0

20
40
60
predicted mean: component2

80

Figure 6.3. Comparison of the fitted means for the two latent classes.

mean. The remaining individuals seek care on average 8.2 times and have a
fitted variance that is close to 20 times the mean. The overall mixture mean
equals the sample mean of 5.77, and the overall mixture variance of 35.79 is
close to the sample variance of 45.05.
Figure 6.3 presents histograms of the fitted means μ̂1i and μ̂2i . These show
clearly that the first component captures individuals who are relatively low
users. The second component has both a higher mean and a longer right tail.
Component probabilities: It is also interesting to look at the fitted probabilities from the two-component densities. Figure 6.4 shows a greater proportion
of both zeros and high values for the ill population. It appears that, although
most healthy individuals see a doctor a few times a year for health maintenance and minor illnesses, a larger fraction of the ill do not seek any (preventive?) care. Those ill individuals who do see a doctor (these individuals have

50
OFP

Frequency

40
30
20
10
0

0

1

2

3

4

5 6
Count

7

8

9 10+

Figure 6.4. Component densities from the FMNB-2 NB1 model.

240

Empirical Illustrations

sickness-events) do so much more often than healthy individuals. Since preventive care usually takes the form of a visit to a doctor in an office setting,
one would not expect such a pattern of differences between the healthy and ill
to arise for the other measures of utilization.
Sensitivity to outliers: As noted in Chapter 4.8.7, when finite mixture models
are applied to counts with long right tails there is a danger that spurious
components are added simply to fit these outliers, leading to model overfitting.
With this in mind all observations of OFP > 70 were replaced by OFP = 70 in
the results detailed in Tables 6.5–6.7. This change led to just one observation
(with OFP = 89) being recoded to 70 (slightly more than the second highest
observation of 68). With this change the mean for the low-use group was 5.55
visits, rather than 5.21, and for the high-use group the mean was 8.18, rather
than 11.79. Thus, it would appear that a single observation could dramatically
increase the estimated differences between the components. Several of the
regression coefficients in the high-use group also changed substantially. With
this change the log-likelihood was −12,077 rather than −12,092, and predicted
frequencies of counts of 0, 1, and 2 were closer to sample frequencies. By
contrast, for the standard NB1 model the effect was much smaller, with loglikelihood of −12,153 when OFP = 89 was recoded to 70 compared to −12,156
without recoding.
6.3.7

The Role of Regressors in the Finite Mixtures Model

Table 6.7 presents estimated coefficients and their standard errors for the preferred model, the NB1 version of the two-component finite mixtures model.
The following discussion underscores the advantage of a finite mixture formulation, because it highlights the differential response of different groups to
changes in covariates.
Semi-elasticities: Since the conditional mean in each of the two components
is of exponential functional form, the regression coefficients in each component can be interpreted as semi-elasticities. In interpreting the results, bear in
mind that the coefficients for the high-use component are much less precisely
estimated, since the probability of being in this group is only 0.09.
r Consistent with previous studies, both the number of chronic conditions (NUMCHRON) and self-perceived health status (EXCLHLTH
and POORHLTH) are important determinants of OFP. An additional chronic condition increases office visits by 20% in the low-use
(healthy) group and by 14% in the high-use (ill) group. The presence
of EXCLHLTH reduces OFP by around 75% in the high-use group
and only 25% in the low-use group.
r Medicaid insurance coverage (MEDICAID) is a significant determinant of the number of doctor visits. The coefficient is significantly
positive in the component density for the low-use group. For the highuse group the coefficient is large and negative, though is statistically

6.3 Analysis of Demand for Health Care

241

Table 6.7. OFP visits: FMNB-2 NB1 model estimates and t-ratios
OFP
Variable
EXCLHLTH
POORHLTH
NUMCHRON
ADLDIFF
NOREAST
MIDWEST
WEST
AGE
BLACK
MALE

OFP

Low users High users
−0.250
(4.31)
0.234
(3.59)
0.186
(14.62)
−0.016
(0.37)
0.083
(1.72)
0.018
(0.46)
0.089
(1.82)
0.028
(1.07)
−0.079
(1.12)
−0.136
(3.92)

−0.751
(1.02)
0.039
(0.06)
0.139
(1.33)
0.546
(2.04)
0.178
(0.37)
0.042
(0.12)
0.236
(0.49)
−0.611
(2.47)
−1.068
(0.98)
0.120
(0.46)

Variable (cont.)
MARRIED
SCHOOL
FAMINC
EMPLOYED
PRIVINS
MEDICAID
ONE
α
π
− ln L

Low users High users
0.047
(1.34)
0.014
(2.73)
−0.000
(0.06)
−0.059
(1.04)
0.254
(4.79)
0.353
(5.69)
0.778
(3.48)
3.492
(15.44)
0.912
(32.65)

−0.513
(1.55)
0.152
(1.84)
−0.005
(0.27)
0.372
(0.54)
3.020
(1.12)
−3.147
(0.97)
1.862
(0.71)
16.390
(6.86)
0.088
(3.16)

12077

insignificant. For the healthy group, the price (insurance) effect of the
MEDICAID dummy outweighs the income effect because MEDICAID
is a health insurance plan for the poor.
r Persons with supplementary private insurance (PRIVINS) seek care
from physicians in office more often than individuals without supplementary coverage. The effect is extraordinarily large for the high-use
group, with a coefficient of 3.02 that implies a proportional increase of
e3.02 − 1. For the low-use group the coefficient is much lower, but the
coefficient of 0.25 still implies that having private insurance increases
OFP by approximately 25% in the low-use group.
r The effect of income on OFP usage is negligible. Furthermore, being
employed (EMPLOYED), which may also capture income effects, is
statistically insignificant. One explanation for the negligible income
effect is that the overall generosity of Medicare irrespective of family
income, combined with Social Security income, which guarantees
a certain level of income, makes utilization insensitive to marginal
changes in income.
Marginal effects: The preceding discussion focused on interpreting coefficients as semielasticities. The marginal effect for the j th component with

242

Empirical Illustrations

respect to the k th regressor is
MEij k =

∂Ej [yi |xi ]
= β j k μj i ,
∂xik

(6.11)

so the predicted changes in OFP in the high-use group will be larger, for given
size of β j k , since μij is larger for the high-use group.
The total effect of a change in a regressor on OFP is obtained as the weighted
average of the component marginal effects, where the weights are the component probabilities. Thus the marginal effect of a change in the k th regressor
is
1
MEij k = π 1 β 1k μ1i + (1 − π 1 )β 2k μ2i ,
n j =1
2

MEik =

(6.12)


and the average marginal effect AMEk = n1 ni=1 MEik .
Without assigning individuals to their respective subpopulations, there is no
obvious way to compare marginal effects in the subpopulations; a convention
is required for doing so. One that has been used in the literature calculates
the AME parameter using the full sample, evaluated separately for each set of
component-specific
coefficients. Equivalently, given (6.11), one can simply use
1 n
μ̂
,
where
μ̂j i = exp(xi β̂ j ).
β̂
j
k
j
i
i=1
n
Another alternative is to make a similar comparison using the MEM parameter. We apply the first approach to our preferred FMNB model. The results
help gauge differences in responses in the two groups. For example, for the
insurance variable PRIVINS the marginal effect in the low-use group is 1.32
visits, whereas it is 8.09 visits in the high-use group.
Overdispersion: The fitted variance in the low-use group is μ1i (1 + 3.49) =
4.49μ1i and for the high-use group is 17.39μ2i . So OFP is much more dispersed
for the high-use group because of both the higher mean μ2i and the higher
multiplier of 17.39.
6.3.8

Comparison with the Hurdle Model

The finite mixture model results may be compared with those for the more
commonly used hurdle model.
Table 6.8 presents the results from the NB2 version of the NBH model. In a
departure from the analysis of Deb and Trivedi (1997) we follow the now more
common approach of estimating a logit model for the hurdle, rather than the
NB binary model given in (6.3). This leads to a slightly higher log-likelihood
of −12,110 compared to −12,108 in Table 6.4.
The key regressors for the FMNB-2 model are also the most important for
the NBH model. Both the probability of crossing the hurdle and the number
of positive visits are decreasing with excellent health (EXCLHLTH), increasing with the number of chronic conditions (NUMCHRON), increasing with

6.3 Analysis of Demand for Health Care

243

Table 6.8. OFP visits: NB2 hurdle model estimates and t-ratios
Zeros
Variable
EXCLHLTH
POORHLTH
NUMCHRON
ALDIFF
NOREAST
MIDWEST
WEST
AGE
BLACK
MALE
MARRIED
SCHOOL
FAMINC
EMPLOYED
PRIVINS
MEDICAID
ONE
α
−ln L
TGoF

Positives

Coefficient

|t|

Coefficient

−0.329
0.071
0.557
−0.188
0.129
0.101
0.202
0.190
−0.327
−0.464
0.247
0.054
0.007
−0.012
0.762
0.554
−1.475

2.31
0.42
10.55
1.45
1.03
0.88
1.51
2.35
2.45
4.71
2.38
4.11
0.36
0.07
6.50
3.05
2.28

−0.378
0.333
0.143
0.129
0.104
−0.016
0.123
−0.075
0.002
0.004
−0.092
0.022
−0.002
0.030
0.227
0.185
1.631
0.744

|t|
4.32
5.86
10.59
2.50
1.97
0.34
2.45
2.33
0.02
0.10
2.10
3.82
0.38
0.40
4.01
2.78
6.06
18.40

12110
21.86

insurance (MEDICAID and PRIVINS), and invariant with respect to income
(INCOME) and employment (EMPLOYED).
The NBH and FMNB models can be compared on the basis of average
marginal effects. The expression for the conditional mean of the hurdle model
is given in Chapter 4.5.1. Suppressing the individual subscript, the marginal
effect with respect to a change in the k th regressor is
∂E[y|x]
= ∂(Pr[y > 0|x]E[y|x, y > 0])/∂xk
∂xk
∂ Pr[y > 0|x]
∂E[y|x, y > 0]
= E[y|x, y > 0]
+ Pr[y > 0|x]
∂xk
∂xk
(6.13)
where E[y|x, y > 0] = μ2 (x)(1 − f1 (0|x))/(1 − f2 (0|x)), μ2 (x) = exp(x β 2 ),
and Pr[y > 0|x] = 1 − f1 (0|x). The two terms in (6.13) reflect, respectively,
the direct effect due to an individual moving from a non-user to user category
and the indirect effect on the usage of those already in the user category. Note
that the calculation of this expression involves both parts of the hurdle model,
since the truncation probability is given by the binary (‘zero’) part of the model
and the truncated mean by the “positive part” of the model. Calculation is more

244

Empirical Illustrations

complicated than for the FMNB-2 model. A suitableoverall measure of partial
response is the sample average marginal effect n−1 i ∂E[yi |xi ]/∂xik .
6.3.9

Economic Significance

Once a finite mixture model has been estimated, the posterior probability that
observation i belongs to category j can be calculated for all (i, j ) pairs using
(4.81). Each observation may then be assigned to its highest probability class.
The crispness of the resulting classification by “types” or “groups” will vary
in practice depending on the differences between the respective mean rates of
utilization. Large and significant differences will induce a sharp classification
of data.
Further insights into the data can be obtained by examining the distribution
of related variables in different categories. These variables may be explanatory
variables already included in the regression or may be other variables that are
analyzed separately. For example, we could make useful summary statements
about the sociodemographic characteristics of the identified groups. An example is from marketing. One might wish to identify the characteristics of the
group of frequent purchasers of some item.
Such an ex post analysis was applied to the data used in the present illustration. Deb and Trivedi (1997) augmented the data used here with information
derived from similar analyses of five additional count measures of health care
utilization from the same NMES data source. These measures were number of
nonphysician office visits (OFNP), number of physician hospital outpatient visits (OPP), number of nonphysician hospital outpatient visits (OPNP), number
of emergency room visits (EMR), and number of hospital stays (HOSP). Separate models were specified and estimated for each utilization measure. Finally, a
preferred specification of the model was determined using the criteria presented
in this chapter.
One interesting issue is whether individuals assigned to the high-use group
on one measure (e.g., OFP), also get classified similarly on a different measure,
such as OFNP. According to our analysis of OFP, 91% of the sample falls in the
low-utilization category and the remaining 9% in the high-utilization category.
Using posterior probability calculations, every individual in the sample of size
4,406 was assigned to one of these two categories. Similar assignment was also
made using the finite mixture models for the other five count variables. Of the
99 users classified as high users of OFP, 66 (67%) were also classified as high
users of OFNP, and 77 (78%) as high users of OFNP. However, fewer than
10 (10%) of these 99 were classified as high users of EMR or HOSP. These
intuitively sensible results suggest that OFP, OPNP, and OFNP are closely
related. Hence a joint analysis of these measures using a finite mixtures model
may be worthwhile.
A second issue is whether high users are concentrated in particular sociodemographic groups. Here it is found that of the 516 BLACK members of the
sample, 416 (81%) are classified as high users of OFNP and 462 (90%) are

6.4 Analysis of Recreational Trips

245

classified as high users of OPNP. With respect to OFP, however, only 14 (14%)
of the 99 high users are BLACK. Two-way frequency tables were also calculated
for the high users of OPP and OPNP against MEDICAID. Interestingly, these
showed that of the 402 individuals on MEDICAID, 271 (67%) were classified
as high users of OFNP and 364 (91%) as high users of OPNP. Of the 402 on
MEDICAID, 142 (35%) are BLACK, so these results seem internally coherent.
We end this discussion here; additional detailed results and interpretations
are given in Deb and Trivedi (1997). This illustration has shown that for these
data the latent class framework may be more realistic and fruitful than the hurdle
framework, mainly because the hurdle-model dichotomy between one population at risk and the other not at risk may be too sharp. At the same time caution
should be exercised to avoid overfitting the data if a finite mixture (or latent
class) model is used. For example, if measurement errors raise the proportion
of high counts, there will be a tendency to overestimate the number of components. A minimum distance estimator that may downweight these high counts
is given in Chapter 4.8.7.
Our next example deals with modeling of recreational trips. In that case the
hurdle model seems empirically more appropriate than the latent class model.
6.4 ANALYSIS OF RECREATIONAL TRIPS
In the literature on environmental and resource economics, count models have
been widely used to model recreational trips. A readily available measure of an
individual’s demand for some recreational activity is the frequency with which
he or she engages in a particular activity, such as boating, fishing, or hiking. An
important issue in these studies is the sensitivity of resource usage to entrance
charges and travel costs. The latter are inputs into calculations of the changes
in consumer welfare resulting from reduced access or higher costs.
The data used in analyses of trips are often derived from sample surveys of
potential users of such resources who are asked to recall their usage in some
past period. Note that if instead the data are derived from an on-site survey of
those who actually used the resource or facility during some time period, the
data are not a random sample from the population. The resulting complications
due to endogenous stratification are discussed in Chapter 10.
In this section we consider a case study based on data that come from a survey
that covers actual and potential users of the resource. This illustration draws
heavily from the article by Gurmu and Trivedi (1996), which provides further
details about several aspects that are dealt with briefly here. This illustration
considers a broader range of econometric specifications than was the case for
the NMES data.
6.4.1

Recreational Trip Data

The ideas and techniques of earlier chapters are illustrated by estimating a
recreation demand function, due to Ozuna and Gomaz (1995), for the number

246

Empirical Illustrations

Table 6.9. Recreational trips: Actual frequency distribution
Number of trips
Frequency
Number of trips
Frequency

0
417
11
2

1
68
12
5

2
38
15
14

3
34
16
1

4
17
20
3

5
13
25
3

6
11
26
1

7
2
30
3

8
8
40
3

9
1
50
1

10
13
88
1

of recreational boating trips (TRIPS) to Lake Somerville, East Texas, in 1980.
The data are a subset of that collected by Sellar, Stoll, and Chavas (1985)
through a survey administered to 2,000 registered leisure boat owners in 23
counties in eastern Texas. All subsequent analyses are based on a sample of
659 observations.
Table 6.9 presents the frequency distribution of the data on the number
of trips. There is a very high proportion of zeros – more than 65% of the
respondents reported taking no trips in the survey period. At the same time there
is a relatively long tail, with 50 respondents reporting taking 10 or more trips.
There is also some clustering at 10 and 15 trips, creating a rough impression of
multimodality. Furthermore, the presence of responses in “rounded” categories
like 20, 25, 30, 40, and 50 raises a suspicion that the respondents in these
categories may not accurately recall the frequency of their visits. The unusual
large excess of zeros and long right tail are clear from the histogram (truncated
at 30) given in the second panel of Figure 6.1.
Table 6.10 presents variable definitions and summary statistics. As is clear
from Table 6.9, the data on trips are very overdispersed with variance of
6.2922 = 38.6, that is, many times the mean of 2.2. The regressors are the
quality of the recreational site (SO), whether the individual water skied at the
site (SKI), household income (I), an indicator for whether a user fee was paid
(FC3), and costs of visiting Lake Somerville (C3) or two alternative recreational
Table 6.10. Recreational trips: Variable definitions and summary statistics
Variable

Definition

TRIPS

Number of recreational boating trips in 1980
by a sampled group
Facility’s subjective quality ranking on
a scale of 1 to 5
Equals 1 if engaged in water skiing at the lake
Household income of the head of the group
($1,000/year)
Equals 1 if user’s fee paid at Lake Somerville
Dollar expenditure when visiting Lake Conroe
Dollar expenditure when visiting Lake Somerville
Dollar expenditure when visiting Lake Houston

SO
SKI
I
FC3
C1
C3
C4

Mean

Standard
deviation

2.244

6.292

1.419

1.812

0.367
3.853

0.482
1.852

0.020
55.42
59.93
55.99

0.139
46.68
46.38
46.13

6.4 Analysis of Recreational Trips

247

sites (C1, C4). The three cost variables are highly correlated, with pairwise
correlations in excess of 0.96. For a more comprehensive description of the
data and the method used for calculating the costs of the visit, the reader is
referred to Sellar et al. (1985).
6.4.2

Initial Specifications

The models and methods of Chapter 3 provide a starting point. In modeling this
data set, we focus on the choice of the parametric family and estimation method,
the representation of unobserved heterogeneity in the sample, and evaluation
of the fitted model. Our example is intended to provide alternatives to the commonly followed approach in which one settles on the negative binomial model
after pretesting for overdispersion. In this example with a very large excess of
zeros it is likely that a hurdle or zero-inflated model is more appropriate.
Following Ozuna and Gomaz (1995), we begin with Poisson and negative
binomial models (NB2) regression models with conditional mean function
μi ≡ E[T RI P Si ] = exp(xi β),

(6.14)

where the vector x = (SO, SKI, I, F C3, C1, C3, C4).
The first few columns of Table 6.11 present results for Poisson regression,
along with t-statistics. The column labeled |t def | gives t-statistics based on
default standard errors. These t-statistics are misleadingly small, being three
to four times larger than the preferred robust t-statistics given in the column
labeled |t| that correct for overdispersion.
The Pearson and deviance statistics divided by their degrees of freedom are,
respectively, 6.30 and 3.54, indicating considerable overdispersion because
they are well in excess of one. This is confirmed using the overdispersion tests
of Chapter 3.4. OLS regression without intercept of ((yi − μ̂i )2 − yi )/μ̂i on μ̂i
yields a t-statistic of 2.88 for the coefficient of μ̂i , so the null of no overdispersion is rejected against the alternative of overdispersion of NB2 form. The test
against overdispersion of NB2 form also rejects the null of no overdispersion.
From data not given in the table, the deviance statistic falls from 4849.7
in an intercept-only model to 2305.8 when regressors are included, so the
deviance R 2 defined in Chapter 5.3.3 equals 0.48. An alternative R 2 based on
the squared correlation between TRIPS and its predicted mean from Poisson
regression equals 0.17.
A simple test of adequacy of the Poisson model as a parametric model
for these data is based on a comparison of observed zero outcomes and the
proportion of zeroes predicted under the null model. Let 1[·] denote the 0/1
indicator function. Since E[1[yi = 0|xi ]] = Pr[yi = 0|xi ] = exp(−μi ) for the
Poisson, where μi = exp(xi β), it follows that E[1[yi = 0] − exp(−μi )] = 0.
Mullahy’s test is based on the corresponding sample moment
1
1
(1[yi = 0] − exp(−μ̂i )) ≡
δ̂ i ,
n i=1
n i=1
n

m̂ =

n

(6.15)

248

Empirical Illustrations

where the last equality defines δ̂. The distribution of m̂ can be obtained using
the results for conditional moment tests given in Chapter 2.8.5. This yields
√
nm̂
d
→ N[0, 1],
(6.16)
TZ = ! 
1
2
v̂
i i
n
where


1
1[yi = 0]xi ûi
v̂i = δ̂ i −
n i=1
n

 
−

n


−1
μ̂i xi xi

xi ûi ,

(6.17)

i=1

where ûi = yi − μ̂i and we use μi = exp(xi β). The excess zero test statistic
for the trip data is TZ = 6.87, which is highly statistically significant, suggesting
that the null Poisson be rejected. This is not surprising because from Table 6.14
the sample average predicted probability of a zero is 0.42, much lower than
the sample frequency of 0.63. An asymptotically equivalent version of the test
replaces 1[yi = 0]xi ûi in (6.17) with −μ̂i exp(−μ̂i )xi .
A more complete chi-square goodness-of-fit test based on cells for 0, . . . , 4
and 5 or more trips based on (6.5) leads to a value of 252.6, much larger than the
χ 2 (5) critical value, again indicating a poor fit of the Poisson to the data. Table
6.14 also reveals that the Poisson model overpredicts counts in the mid-range
(1 to 14) and underpredicts the high counts.
Table 6.11 also presents negative binomial (NB2) estimates. The results
strongly favor the NB2 model compared to Poisson. The NB2 overdispersion
parameter is highly statistically significant (t = 7.41). The log-likelihood rises
from −1,529 to −825, leading to a χ 2 (1)-distributed LR test statistic of 1408
that strongly rejects the Poisson. And the BIC falls from 3,111 to 1,709. The
default standard errors for NB2 based on the Hessian are smaller than the
robust sandwich standard errors, leading to default t-statistics that are about
30% larger than the preferred robust t-statistics.
The NB2 estimates indicate that the number of trips increases substantially
with the perceived quality of the site and for those who water ski and who
pay a user’s fee at the site, while income has little effect and is statistically
insignificant. The NB2 estimates are plausible in that they indicate substitution
from other sites (C1 and C4) toward Lake Somerville as travel costs rise, while
trips to Lake Somerville decline as travel costs to Lake Somerville (C3) rise.
The cost variables have standard deviations of around 45, so the effect of a
one-standard-deviation change in costs is substantial.
The presence of overdispersion, although consistent with the NB2 specification, does not in itself imply that the NB2 specification is adequate; rejection of
the null against a specified alternative does not necessarily imply that the alternative is the correct one. Predicted probabilities given in Table 6.14 indicate
that the NB2 model does reasonably well. For example, the average predicted
probability of a zero is 0.642 compared to the sample frequency of 0.632.
The statistic TGoF given in Table 6.11 is 23.5. Although this is a substantial

6.4 Analysis of Recreational Trips

249

Table 6.11. Recreational trips: Poisson and NB2 model estimates and
t-ratios

Variable
ONE
SO
SKI
I
FC3
C1
C3
C4
α
Fitted mean
− lnL
BIC
Pearson
Deviance
TZ
TGoF

Poisson
 def 
t 
Coefficient
0.265
0.472
0.419
−0.111
0.898
−0.003
−0.042
0.036
−

2.83
27.60
7.31
5.68
11.37
1.10
25.47
13.34
2.24
1529
3111
6.30
3.54
6.9
252.6

|t|
0.61
9.65
2.16
2.21
3.63
0.23
3.62
3.85

NB2
 def 
t 
Coefficient
−1.122
0.722
0.612
−0.026
0.669
0.048
−0.093
0.039
1.37

5.08
15.93
4.07
0.58
1.85
3.01
11.21
3.32
9.43
8.97
825
1709

|t|
3.79
12.37
3.06
0.48
2.09
1.70
6.38
2.19
7.41

23.5

Note: t-Statistics based on robust standard errors, except tdef is based on default standard errors.
Fitted mean is the average predicted mean. Pearson and Deviance are, respectively, the Pearson
and deviance statistics divided by degrees of freedom. Tz is test for correct proportion of zeros.
TGoF is a chi-squared goodness-of-fit test with five degrees of freedom.

improvement on the Poisson, the model is still rejected since the 5% critical
value for χ 2 (5) is 11.07.
From Table 6.14 the NB2 model overpredicts high counts, with the average
probability of 15 or more trips equal to 0.042 compared to a sample frequency
of 0.023. More remarkably, from Table 6.11 the average fitted mean from NB2
estimation is 8.97, which is, much higher than the sample mean of TRIPS of
2.24. This substantial overprediction is due to several observations having large
predicted means; whereas the median predicted number of trips is 0.24, one
observation had a predicted mean of 3,902.38. Such a great difference between
the sample mean and average fitted mean from an NB2 model is highly unusual.
For example, for the section 6.3 example the average fitted mean from an NB2
model is 5.83 compared with a sample mean of OFP of 5.77.
One possible explanation is that the unobserved heterogeneity distribution
is misspecified. An NB1 model may do better because the variance is linear in
μ rather than quadratic. This is the case here, with the average fitted mean from
NB1 estimation of 2.24, which is essentially the same as the sample frequency.
Note, however, that the NB1 model has a log-likelihood of −834 that is higher
than −825 for NB2.
A second possibility is that a more flexible conditional mean function is
needed. Inclusion of quadratic terms and interactions (C1SQ, C3SQ, C4SQ,

250

Empirical Illustrations

Table 6.12. Recreational trips: Finite mixture model estimates and t-ratios
Finite Mixtures Poisson two-component
Low users
Variable
ONE
SO
SKI
I
FC3
C1
C3
C4
α
π
Fitted mean
−ln L
BIC
TGoF

High users

Coefficient

|t|

Coefficient

−1.865
0.659
0.557
−0.097
0.970
0.001
−0.064
0.057

6.00
15.47
3.05
0.43
3.43
0.03
7.85
4.50

1.220
0.281
0.852
0.092
0.158
0.054
−0.064
0.002

0.887
1.55

|t|
2.19
2.91
5.97
1.28
0.84
4.40
7.91
0.24

0.113
5.04
10.11
916
1,994
43.7

Finite Mixtures NB2 two-component
Low users
Coefficient

High users
|t|

Coefficient

|t|

−1.877
9.13
1.006 1.04
0.890 19.90
−0.095 0.43
0.449
2.50
1.369 3.55
−0.049
1.02
−0.035 0.23
1.070
2.97
−0.130 0.43
−0.000
0.01
0.186 7.50
−0.050
5.24
−0.253 9.52
0.047
3.11
0.049 3.42
0.825
7.58
0.192 1.88
0.876 15.52
0.124 2.20
2.77
29,313
786
1,695
20.6

C1C3, C1C4, and C3C4) for the three cost variables in the conditional mean
function for NB2 leads to improvement for the NB2 model in both the loglikelihood, now −802, and BIC, now 1702. The average probability of 15 or
more trips is now slightly higher at 0.048. But the resulting average fitted mean
is now 2.80, close to the sample frequency of 2.24, and the maximum fitted
mean is 70.3.
A third explanation is that a standard NB model cannot simultaneously
model both the large excess of zeros and the large overdispersion in the right
tail. The most natural model then is a hurdle model or a zero-inflated model.
6.4.3

Modified Count Models

Plausible alternatives to the models considered above are hurdle models, zeroinflated models, and finite mixture models, that lead to changes in the conditional mean and the conditional variance specification.
Table 6.12 presents estimates of two-component Poisson and NB2 finite
mixture models. The Poisson finite mixture model is a great improvement on
the Poisson model, with log-likelihood rising from −1529 to −916, but it still
is not as high as for the NB2 model.
The two-component finite mixture NB2 model has a lower BIC than that
for the NB2 model. Giving a latent class interpretation, most individuals are
low users and for these individuals the results are comparable to those for
the NB2 model. For the 12.4% who are high users the statistically significant
coefficients have the expected sign and are larger in magnitude, implying a
larger multiplicative effect of the regressors. The FMNB2 model is still rejected
by the chi-square goodness-of-fit test. We interpret this result to mean that the
characterization of the dgp as a mechanism that samples two subpopulations,

6.4 Analysis of Recreational Trips

251

one of relatively high users and the other of low users of the recreational site,
leaves some features of the data unexplained.
Furthermore, the average fitted mean for the high users is unbelievably high,
at 29,313, and even with the two largest predicted means dropped, the average
fitted mean is 103. So the problem of the standard NB2 model overpredicting,
discussed in detail in the preceding subsection, is compounded in a mixture
setting. The overprediction is much less in an NB1 two-component mixture
model (not reported in a table), with average fitted means of 8.84 for higher
users and 1.42 for lower users. However, even then the overall average sample
mean is still too high at 6.46 (using the estimated probability of being a high
user of 0.68), and the log-likelihood is higher at −794 compared to −786 in
the NB2 case. If instead quadratic and interaction terms in the cost variables
are included as additional regressors, there is still great overprediction, unlike
the earlier case for standard NB2.
Finally, we consider hurdle and zero-inflated models, which a priori were
the most natural models for these data. Regression results for the NB2 hurdle
model are given in Table 6.13. For these data the binary regressor F C3 only
equals 1 if TRIPS > 0. As a result it is not identified in a binary model for
whether or not TRIPS = 0, so we drop F C3 from the binary part of the NB2
hurdle model. For both the hurdle portion of the model and the positives the
coefficients have the same sign, and this sign is the same as that for the NB2
model. So the regressors have qualitatively the same effect as in the NB2
model. Few of the variables for the zeros part of the model are significant,
which suggests that most of the explanatory power of the covariates derives
from their impact on positive counts.
The model fit is substantially improved. The log-likelihood is −721 compared to −825 for the NB2 model and −786 for the finite mixture model, and the
corresponding values of BIC are 1,553, 1,709, and 1,695. The log-likelihood
for the NB2 hurdle model is also much higher than that for the Poisson hurdle
model (−1200) and the NB1 hurdle model (−782). In terms of fitted frequency
distribution (see Table 6.14), the NBH model does extremely well, for both zero
counts and high counts. Indeed NBH is the only model that is not rejected by
the goodness-of-fit test. This result is especially interesting since the difference
between NBH and FMNB is quantitative rather than qualitative – NBH views
the data as a mixture with respect to zeros only, whereas FMNB views the data
as a mixture with respect to zeros and positives. The opposite conclusion was
reached in regard to the NMES data. Finally, Gurmu and Trivedi (1996) find
that for these data the NBH model is also superior to flexible parametric models
based on series expansions that are presented in Chapter 12.
In Table 6.13 we also include an estimate of the zero-inflated NB2 model,
see section 4, in which the probability of a nonzero count is further modeled as
a logit function with the same regressors as in the main model. The motivation
is that the sample under analysis may represent a mixture of at least two types,
those who never choose boating as recreation and those who do, but some of the
latter might simply happen not to have had a positive number of boating trips

252

Empirical Illustrations

Table 6.13. Recreational trips: With zeros and hurdle model estimates and
t-ratios
NB2 hurdle
Variable

Zeros (Inflate)

NB2

|t|

Coefficient

Coefficient

ONE
SO
SKI
I
FC3
C1
C3
C4
α
Fitted mean
− lnL
BIC

Zero-inflated NB2

−4.614
18.134
3.832
−0.068
−
0.263
−0.491
0.216
1.206

1.58
0.842
1.17
0.172
0.92
0.622
0.16
−0.057
−
0.576
1.29
0.057
1.13
−0.078
1.58
0.012
3.81
1.700
3.77
721
1553

Zeros

Positives

|t|

Coefficient

|t|

Coefficient

|t|

2.30
2.39
3.36
2.34
2.29
5.88
0.78
2.30
3.87

20.975
−38.636
−16.066
−0.203
−11.430
−0.024
0.078
−0.063
−

7.36
19.29
14.82
0.60
4.72
1.55
3.61
2.93

1.092
0.171
0.493
−0.069
0.547
0.040
−0.066
0.021
0.832

3.74
3.01
3.37
1.66
2.48
2.16
6.31
1.82
8.69

2.72
719
1549

in the sample period. The results are once again plausible, with coefficients in
the main NB2 component of the model having the same sign as for the NB2
model. The model for zeros is a logit model for whether TRIPS = 0 rather than
TRIPS > 0, so we expect the coefficients in the model for zeros to have the
reverse sign of those in the main NB2 part of the model; this is indeed the case
for all but income, which is statistically insignificant. The ZINB model actually
has somewhat higher log-likelihood and lower BIC than the NB2 hurdle
model. The average fitted mean of 2.72 is close to the sample mean of 2.24.
In terms of goodness of fit measured by either log-likelihood or the BIC, the
hurdles NB2 or zero-inflated NB2 models are best. This result can be interpreted as follows. Although there is considerable unobserved heterogeneity
among those who use the recreational facility, there is also a significant proportion in the population for whom the “optimal” solution is a corner solution.
Table 6.14. Recreational trips: Actual and fitted cumulative frequencies
0

1

2

3

4

5

6–8

9–11 12–14 15–17 18–62

63+

Frequency
Observed
Poisson
NB
Zero-inflated NB
Hurdle NB

0.632
0.420
0.642
0.656
0.623

0.103
0.221
0.122
0.072
0.107

0.057
0.103
0.050
0.054
0.063

0.052
0.062
0.030
0.040
0.043

0.026
0.045
0.021
0.031
0.030

0.020
0.034
0.016
0.024
0.023

0.032
0.061
0.033
0.047
0.041

0.024
0.026
0.020
0.026
0.022

0.008
0.012
0.013
0.015
0.013

0.023
0.006
0.009
0.010
0.009

0.021
0.010
0.034
0.024
0.023

0.002
0.002
0.008
0.003
0.003

Cumulative
Observed
Poisson
NB
Zero-inflated NB
Hurdle NB

0.632
0.420
0.642
0.656
0.623

0.736
0.640
0.764
0.728
0.730

0.794
0.744
0.815
0.782
0.793

0.845
0.805
0.845
0.822
0.836

0.871
0.850
0.866
0.853
0.866

0.891
0.885
0.883
0.877
0.889

0.923
0.945
0.915
0.924
0.930

0.947
0.971
0.935
0.949
0.952

0.955
0.983
0.948
0.964
0.965

0.977
0.988
0.958
0.974
0.974

0.998
0.998
0.992
0.997
0.997

1.000
1.000
1.000
1.000
1.000

6.5 Analysis of Fertility Data

253

That is, they may consistently have a zero demand for recreational boating.
Since no theoretical model was provided for explaining zero demand for recreational boating, the potential importance of excess zeros was not emphasized.
Consumer choice theory (and common sense) predicts the occurrence of zero
solutions; see Pudney (1989, chapter 4.3). However, a priori reasoning cannot
in itself predict whether their relative frequency will be greater or less than
that implied by the Poisson model. This is an empirical issue, whose resolution
depends also on how the sample data were obtained. Theory may still help in
suggesting variables that explain the proportion of such corner solutions.
As in the case of the NMES data, several other finite mixture models were
also estimated. The diagnostic tests and the BIC criteria show all finite mixture
models to be inferior to the hurdles or zero-inflated NB2 models. Thus, in
contrast to the NMES data, the outcome supports the idea that the sample is
drawn from two subpopulations of non-users and users, rather than from two
subpopulations of low and high users.
6.4.4

Economic Implications

The model discrimination and selection exercise relied heavily on statistical
criteria in both applications. Are we simply fine-tuning the model, or are the
resulting changes economically meaningful? Only a partial answer can be given
here.
In the modeling of recreational trips, it is reasonable to suppose that a random
sample will include nonparticipants because of taste differences among individuals. A hurdle model is worthwhile in this case because parameter estimates
and welfare analysis should be based only on the participants’ responses.
By contrast, in the case of NMES data on the elderly, the notion of nonparticipants is implausible. Given differences in health status of individuals as well
as other types of unobserved heterogeneity, however, the distinction between
high users and low users is reasonable. This feature can explain the superior
performance of the finite mixture NB model in section 6.3.
6.5 ANALYSIS OF FERTILITY DATA
A number of studies that have analyzed the role of socioeconomic factors and
social norms on fertility have pointed out that fertility data exhibit a number of
features that call for a modeling strategy that goes beyond the standard Poisson
and negative binomial regressions.
For example, Melkersson and Rooth (2000) report inflation at frequencies of
zero and two in their analysis of Swedish fertility data. As we see later, recent
fertility data from Switzerland and Germany also exhibit a similar feature of
a double mode, one at zero and another at two. In contrast to such data from
economically advanced West European countries, the data from developing
countries may not exhibit this feature. For example, Miranda (2010) analyzes
Mexican fertility data from a 1997 survey that do not contain an excess of two

254

Empirical Illustrations

Table 6.15. Number of children: Actual and fitted frequency distribution for
Swiss data (n = 1,878)
Children
Frequency
Percent
NB fitted

0
379
20.2
15.6

1
262
14.0
27.8

2
684
36.4
25.9

3
353
18.8
16.8

4
128
6.8
8.5

5
35
1.9
3.6

6
16
0.9
1.3

7
8
0.4
0.4

8
10
0.5
0.1

9
1
0.1
0.0

10
1
0.1
0.0

11
1
0.1
0.0

outcomes and exhibit overdispersion. He suggests that data from developing
countries may show an excess of large counts. Planned fertility studies that ask
how many children a family would like to have generate samples with just a
few realizations (Miranda, 2008). Furthermore, over time societies may transit
from high to low fertility rates as social norms and economic choices favor
smaller family units. It is convenient to think of fertility data as characterized
by limited support, in the sense that just a few event counts dominate the
frequency distribution.
In contrast to the two preceding sections that provided detailed count data
regression analysis for two data sets, this section is limited to univariate (unconditional) descriptive analysis of fertility data from two samples. The goal is
simply to highlight some features of fertility data that create a modeling challenge. Covariates will provide relatively low explanatory power, as is typical for
cross-section data, so that their introduction will most likely not be sufficient to
explain the essential features of the count data observed here. Instead, models
richer than Poisson or negative binomial are needed to explain the bimodality
in the data, even with covariates.
6.5.1

Fertility Data

The first data set on completed fertility comes from the Swiss Household Panel
W1 (1999). The mean number of children in this sample (n = 1,878) of women
over age 45 years is 1.94 and the standard deviation is 1.45. There is moderate
overdispersion with sample variance of 2.11 not much greater than the mean.
Table 6.15 presents the frequency distribution for the data. It shows a halfmode at 0 and a more pronounced mode at 2, similar to the features of data in
Melkersson and Rooth (2000).
The second data set is a larger sample (n = 6,782) from the British Household Panel Survey (BHPS). Here the sample mean number of children is 1.85
and the standard deviation is 1.51. There is a bit more overdispersion than in
the first data set, with sample variance of 2.28 so the variance is 1.23 times the
mean. Overdispersion is still limited compared with that found in fertility data
from developing countries. For example, Miranda’s ENADID 2006 data on
completed fertility in Mexico has a mean of 4.43 children, a standard deviation
of 2.75, and a variance of 7.56 that is 1.71 times the sample mean. Table 6.16

6.5 Analysis of Fertility Data

255

Table 6.16. Number of children: Actual and fitted frequency distribution for
British data (n = 6,782)
Children
Frequency
Percent
NB fitted

0
1
1764 805
26.0 11.9
19.3 28.3

2
3
2160 1262
31.9 18.6
23.7 14.9

4
487
7.2
7.8

5
6
7
8
9
10 11
181 69 33 12
5
3
1
2.7 1.0 0.5 0.2 0.1 0.0 0.0
3.6 1.5 0.6 0.2 0.1 0.0 0.0

presents the frequency distribution for the BHPs data. It shows a half-mode at
0 and a more pronounced mode at 2, similar to the Swiss data.
Although the Poisson or negative binomial regression model may seem a
promising starting point for analyzing these fertility data, these distributions are
unimodal, which conflicts with the fact that the observed frequency distribution
is bimodal. To illustrate this point, we fit the intercept-only NB2 regression to
both sets of data, with similar results obtained if instead Poisson models are
fitted.
The final rows of Tables 6.15 and 6.16 present the predicted probability of
each count. It is clear that NB provides a poor fit at 0, 1, and 2 counts, greatly
overpredicting the probability of one child and underpredicting the probability
of zero children or two children.
6.5.2

Univariate Models

We use the Swiss data to fit an intercept-only version of several models.
Table 6.17 presents measures of fit of the various models.
The negative binomial model will accommodate overdispersion in the data,
but the overdispersion here is not great. The NB model leads to a slight improvement over Poisson, and the χ 2 (1) distributed LR test statistic of 6.53 favors the
NB model at the 1% significance level.
A two-component Poisson finite mixture model could, in principle, be able
to accommodate the bimodality in the data, coming from either Poisson with
mean near 0 or Poisson with mean around 2. We found two optima with
these data. The first yields f (y) = 0.988 × P[1.88] + 0.012 × P[6.57], with
Table 6.17. Swiss fertility data: Fit of various models
Model
Poisson
Negative binomial
Finite mixture Poisson − 2
Hurdle Poisson
Zero-inflated Poisson
Ordered probit

Parameters

Log-likelihood

AIC

BIC

1
2
3
2
2
6

−3,238
−3,235
−3,203
−3,203
−3,203
−3,031

6,478
6,474
6,409
6,409
6,409
6,076

6,484
6,485
6,421
6,421
6,421
6,109

256

Empirical Illustrations

ln L = −3,225.7. This model uses the mixture to better fit the higher counts.
The second yields f (y) = 0.904 × P[2.14] + 0.094 × P[0.0], with ln L =
−3,202.7. This fitted model is a boundary solution where μ2 = 0, and it is
equivalent to a zero-inflated Poisson that adds .094 to the probability of a zero
count. Both optima are an appreciable improvement on Poisson and NB, and
the latter optima is preferred because it leads to much higher log-likelihood. We
note in passing that both a two-component NB model and a three-component
Poisson model led to the same results as the two-component Poisson.
The hurdle Poisson and zero-inflated Poisson are observationally equivalent
models in this example with no regressors. We nonetheless estimate both. The
two models yield the same fitted log-likelihood value, ln L = −3202.7, and
the same predicted probabilities. The predicted frequencies of 0 to 5 children
are, respectively, 20.2, 22.7, 24.4, 17.4, 9.3, and 4.0. This is better than the
predicted frequencies for NB given in Table 6.15, but the dip at one child is still
not fully explained. Melkersson and Rooth (2000) argue that additional modification through inflation at two may be warranted to account for social norms
that favor a two-child family over a one-child family. Fitted negative binomial versions of the hurdle and zero-inflated models collapsed to the Poisson
versions.
The ordered probit model, see Chapter 3.6.2, is motivated by the feature
that the data are indeed ordered. Thinly populated cells should be conveniently
aggregated into categories. In this example we aggregate six or more children
into one category. For this model without regressors the fitted ordered probit
necessarily gives the predicted frequencies equal to the sample frequencies.
The ordered probit model has many more parameters than the other models
but has much higher log-likelihood so is strongly preferred on grounds of BIC.
The next best fitting models are the equivalent Hurdle Poisson, ZIP, and, in
this case, two-component finite mixtures Poisson.
Yet another potential model is a sequential conditional probability (SCP)
for more than j + 1 events conditional on observing j events, with Pr[y =
j |y > j − 1] = (x β j ), j = 1, . . . , m, in the case of sequential logit. Each
stage in the sequence is a binary outcome model based on a decreasing number
of observations as we move up the chain of event counts. Although the model
is likely to be highly parameterized, it could provide useful information for
specific links in the chain that may have a special significance. For example,
interest may lie in the conditional probability of four or more children given
three.
This approach can also be used if we want to test the assumption that data
are generated by a homogeneous Poisson process. The Poisson model implies,
on simplification, that
exp(x β)j /j !
.
Pr[y = j | y > j − 1] = ∞
 k
k=j exp(x β) /k!

6.6 Model Selection Criteria: A Digression

257

A series of binary outcome models with this specification can be estimated,
with parameters β j for j = 1, . . . , m, and the Poisson process assumption can
be tested by testing the restriction β 1 = β 2 = · · · = β m . This approach can be
adapted to other models, such as NB.
The results of Melkersson and Rooth (2003) and Santos Silva and Covas
(2000) cast doubt on the validity of the standard Poisson process assumption
for analyzing fertility data. In addition, social norms and dynamics play a
role in generating distributions that are inadequately characterized by standard
Poisson-type models.
6.6 MODEL SELECTION CRITERIA: A DIGRESSION
The examples in this chapter have illustrated alternative ways of handling “nonPoisson” features of count data. Plausible models include hurdles and finite
mixtures models, and potentially even finite mixtures based on hurdle models.
Selecting a preferred parametric model can be difficult because the usual LR
test cannot be applied, either because it has a nonstandard distribution, such
as when determining the number of components in a finite mixtures model, or
because models are not nested in each other.
In this section we report the results of a small simulation experiment
designed to throw light on the properties of model evaluation criteria used
in this chapter, and we discuss using a bootstrap to obtain critical values for the
LR test.
6.6.1

A Simulation Analysis of Model Selection Criteria

Data were generated from three models: Poisson, Poisson hurdle (PH), and a
two-component finite mixture of Poissons (FMP-2). The conditional mean(s)
for the models were, respectively,
Poisson
Poisson Hurdle
FM Poisson
(π = 0.75)

Zeros
Positives
Component 1
Component 2

μ = exp(−1.445 + 3.0x)
μ = exp(−1.6 + 3.0x)
μ = exp(−1.35 + 3.0x)
μ1 = exp(−1.225 + 3.0x)
μ2 = exp(−1.5 + 0.75x)

and the single regressor x ∼ Uniform [0, 1]. The sample size was n = 500.
The dgp was calibrated in each case to obtain zeros for about 40% of the
observations.
Table 6.18 reports results from 500 simulations. We first consider the size
and power of LR and goodness-of-fit tests, followed by the performance of
associated information criteria.
The first two entries of the first column of Table 6.18 list the frequency of
rejection at nominal significance level of 0.10 using the LR test when the dgp

258

Empirical Illustrations

Table 6.18. Rejection frequencies at nominal 10% significance level
Data-generating process
Test/criterion
LR: P versus PH
LR: P versus FMP
GoF: P rejected
GoF: PH rejected
GoF: FMP rejected
AIC: P lowest
AIC: PH lowest
AIC: FMP lowest
BIC: P lowest
BIC: PH lowest
BIC: FMP lowest

Poisson

Hurdle (PH)

0.100
0.092
0.126
0.244
0.142
0.822
0.146
0.032
0.998
0.002
0.000

0.926
0.880
0.740
0.100
0.346
0.050
0.800
0.148
0.544
0.400
0.050

Finite mixture (FMP)
0.990
1.000
0.988
0.530
0.118
0.000
0.066
0.934
0.060
0.050
0.890

is the Poisson. The Poisson hurdle and finite mixture Poisson each have two
additional parameters, but as noted in Chapter 4.8.6 the LR test statistic has
a nonstandard distribution and is not asymptotically χ 2 (2) distributed. Some
Monte Carlo studies by other authors suggest that for (noncount) mixture
models with two extra parameters the appropriate distribution is somewhere
between χ 2 (1) and χ 2 (2). Here we use χ 2 (1) critical values. Testing both
Poisson against Poisson hurdle, and Poisson against finite mixture Poisson,
leads in this example to a test size close to .10.
The chi-squared goodness-of-fit tests are based on cells for 0, 1, 2, 3, and
4 or more counts. The rejection rates are close to the nominal size, with 0.126
for Poisson when the dgp is Poisson, 0.100 for PH when the dgp is PH , and
0.118 for FMP when the dgp is FMP.
Next consider the power of the LR and GoF tests. First, the LR test of P
against PH is more powerful than the GoF-P test, with rejection rate 0.926 >
0.740, and the LR test of P against FMP is more powerful than the GoF-P
test, with rejection rate 1.000 > 0.988. This is expected because in these cases
the LR test is the most powerful test, and the two tests were found to have
approximately correct size in this example. Second, even when the actual dgp
differs from that assumed for the alternative hypothesis model, the LR test
remains more powerful than the goodness-of-fit test, which has rejection rates
of no more than 0.530. These results are, of course, affected by the choice
of parameter values but do indicate a loss of power in using goodness-of-fit
tests.
The performance of the information criteria is shown in the lower part of
Table 6.18. The interpretation of the “rejection frequency” here is somewhat
different because the reported figure shows the proportion of times the model

6.6 Model Selection Criteria: A Digression

259

had the smallest value of the criterion. For example, when the true model is
Poisson, the AIC selects Poisson as the best model in 82% of the cases, and
BIC does so in almost every case. Similarly the information criteria generally
strongly favor PH when the dgp is PH, and FMP when the dgp is FMP. The
one exception is that when the dgp is PH, BIC favors PH in only 40% of
the cases, due to its high penalty for additional parameters and actually picks
the Poisson as the best model more frequently.
The goodness-of-fit tests and information criteria are useful in evaluating
models. Rejection of the null by the LR, GoF, or the AIC would seem to
indicate a deficiency of the model. Thus, despite its theoretical limitations, the
standard LR test of the one-component model against the mixture alternative
may have useful power.
6.6.2

Bootstrapping the LR Test

As detailed in Chapter 4.8.6, the LR test statistic does not have the usual χ 2
distribution when used to test the number of components in a finite mixture
model.
If computational cost is not an important consideration, a parametric bootstrap provides a way to obtain better critical values for the LR test. Feng and
McCulloch (1996) suggested and analyzed a bootstrap LR test for the null that
the number of components in the mixture is C − 1 against the alternative that
it is C. Their examples are in a univariate iid setting. For the regression case
we proceed as follows:
1. Estimate the (C − 1)-component model and the C-component mixture
model by MLE. Form the LR statistic, denoted LR.
2. Draw a bootstrap pseudo-sample (yi∗ , xi ) by generating yi∗ from
f (yC−1 |xi , θ̂ C−1 ), the fitted density for the null hypothesis (C − 1)component model. Reestimate both null and alternative models and
construct the LR statistic LR∗ .
3. Repeat step 2 B times, giving B values of LR statistic, denoted LR∗b ,
b = 1, . . . , B.
4. Using the empirical distribution of LR∗1 , . . . , LR∗B , determine the (1 −
α) percent quantile as the critical value, denoted LR[1−α] .
5. Reject H0 : C ∗ = C − 1 against Ha : C ∗ = C if LR > LR[1−α] .
Since the bootstrap is being used for testing rather than standard error
estimation B should be quite large, say B = 999. The bootstrap may take
a while because finite mixture models are computationally intensive to estimate. Furthermore the likelihood can be multimodal, so ideally a range
of starting values would be used in estimating in each of the bootstrap
replications.

260

Empirical Illustrations

6.7 CONCLUDING REMARKS
Most empirical studies generate substantive and methodological questions that
motivate subsequent investigations. We conclude by mentioning three issues
and lines of investigation worth pursuing.
First, in the context of the recreational trips example, one might question the
assumption of independence of sample observations. This assumption is standard in cross-section analysis. However, our data also have a spatial dimension.
Even after conditioning, observations may be spatially correlated. This feature
will affect the estimated variances of the parameters. Essentially, the assumption of independent observations implies that our sample is more informative
than might actually be the case; see Chapter 4.9.
A related issue concerns the stochastic process for events. Many events may
belong to a spell of events, and each spell may constitute several correlated
events. The spells themselves may follow some stochastic process and may in
fact be observable. One might then consider whether to analyze pooled data or
to analyze events grouped by spells. An example is the number of doctor visits
within a spell of illness (Newhouse, 1993; Santos Silva and Windmeijer, 2001).
In many data situations one is uncertain whether the observed events are a part
of the same spell or of different spells; see Chapter 4.2.3.
Another issue is joint modeling of several types of events. The empirical
examples considered in this chapter involve conditional models for individual
events, not joint models for several events. This may be restrictive. In some
studies the event of interest generates multiple observations on several counts.
A health event, for instance, may lead to hospitalization, doctor consultations,
and usage of prescribed medicines, all three being interrelated. The analysis
described in the previous paragraph can be extended to this type of situation by
considering a mixture of multinomial and count models, leading to multivariate
count models discussed in Chapter 8.

6.8 BIBLIOGRAPHIC NOTES
Applications of single-equation count data models in economics, especially
in accident analysis, insurance, health, labor, resource, and environmental
economics, are now standard; examples are Johansson and Palme (1996),
Pohlmeier and Ulrich (1995), Gurmu and Trivedi (1996), and Grogger and
Carson (1991). Rose (1990) uses Poisson models to evaluate the effect of regulation on airline safety records. Dionne and Vanasse (1992) use a sample of
about 19,000 Quebec drivers to estimate a NB2 model that is used to derive
predicted claims frequencies, and hence insurance premiums, from data on different individuals with different individual characteristics and driving records.
Schwartz and Torous (1993) combine the Poisson regression approach with the
proportional hazard structure. They separately model monthly grouped data
on mortgage prepayments and defaults. Cameron and Trivedi (1996) survey
this and a number of other count data applications in financial economics.

6.9 Exercises

261

Lambert (1992) provides an interesting analysis of the number of defects in
a manufacturing process, using the Poisson regression with “excess zeros.”
Nagin and Land (1993) use the Heckman-Singer type nonparametric approach
in their mixed Poisson longitudinal data model of criminal careers. Their model
is essentially a hurdles-type Poisson model with nonparametric treatment of
heterogeneity. Post-estimation they classify observations into groups according to criminal propensity, in a manner analogous to that used in the health
utilization example. Panel data applications are featured in Chapter 9. Two
interesting marketing applications of latent class (finite mixture) count models
are Wedel et al. (1993) and Ramaswamy, Anderson, and DeSarbo (1994). Haab
and McConnell (1996) discuss estimation of consumer surplus measures in the
presence of excess zeros.
Deb and Trivedi (2002) reexamine the Rand Health Insurance Experiment
(RHIE) pooled cross-section data and show that finite mixture models fit the
data better than hurdle models. Of course, this conclusion, though not surprising, is specific to their data set. Lourenco and Ferreira (2005) apply the
finite mixture model to model doctor visits to public health centers in Portugal using truncated-at-zero samples. Böhning and Kuhnert (2006) study the
relationship between mixtures of truncated count distributions and truncated
mixture distributions and give conditions for their equivalence. Recent biometric literature offers promise of more robust estimation of finite mixtures via
alternative estimators to maximum likelihood.
6.9 EXERCISES
6.1 Using the estimated mixing proportion π 1 in Table 6.6, and the estimated
component means in Table 6.6, check whether the sample mean of OFP given
in Table 6.2 coincides with the fitted mean. Using the first-order conditions for
maximum likelihood estimation of NB2, consider whether a two-component
finite mixture of the NB2 model will display an analogous property.
6.2 Suppose the dgp is a two-component CFMNB family, with the slope
parameters of the conditional mean functions equal, but intercepts left free.
An investigator misspecifies the model and estimates a unicomponent Poisson
regression model instead. Show that the Poisson MLE consistently estimates
the slope parameters.
6.3 In the context of modeling the zeros/positives binary outcome using the
NBH specification, compare the following two alternatives from the viewpoint
of identifiability of the parameters (β, α 1 ),

Pr[yi = 0|xi ] =
where μi = exp(xi β).

1/(1 + α 1 μi )1/α1 , or
1/(1 + μi ),

262

Empirical Illustrations

6.4 Consider how to specify and estimate a two-component finite mixture of
the NBH model. Show that this involves a mixture of binomials as well as a
mixture of NB families.
6.5 Consider whether the alternative definitions of residuals in Chapter 5 can
be extended to finite mixtures of Poisson components.
6.6 Verify the result given in (6.9). To do so, first derive (4.73) for r = 2; then
derive the central second moment by subtracting off μ2 .

CHAPTER 7

Time Series Data

7.1 INTRODUCTION
The previous chapters have focused on models for cross-section regression on a
single count dependent variable. We now turn to models for more general types
of data – univariate time series data in this chapter, multivariate cross-section
data in Chapter 8, and longitudinal or panel data in Chapter 9.
Count data introduce complications of discreteness and heteroskedasticity. For cross-section data, this leads to moving from the linear model to the
Poisson regression model. However, this model is often too restrictive when
confronted with real data, which are typically overdispersed. With cross-section
data, overdispersion is most frequently handled by leaving the conditional mean
unchanged and rescaling the conditional variance. The same adjustment is made
regardless of whether the underlying cause of overdispersion is unobserved heterogeneity in a Poisson point process or true contagion leading to dependence
in the process.
For time series count data, one can again begin with the Poisson regression
model. In this case, however, it is not clear how to proceed if dependence is
present. For example, developing even a pure time series count model where
the count in period t, yt , depends only on the count in the previous period,
yt−1 , is not straightforward, and there are many possible ways to proceed. Even
restricting attention to a fully parametric approach, one can specify distributions
for yt either conditional on yt−1 or unconditional on yt−1 . For count data this
leads to quite different models, whereas for continuous data the assumption
of joint normality leads to both conditional and marginal distributions that are
also normal.
Remarkably many time series models have been developed. These models,
although conceptually and in some cases mathematically innovative, are generally restrictive. For example, some models restrict serial correlation to being
positive. At this stage it is not clear which, if any, of the current models will
become the dominant model for time series count data.
A review of linear time series models is given in section 7.2, along with a brief
summary of seven different classes of count time series models. In section 7.3
263

264

Time Series Data

we consider estimation of static regression models, as well as residual-based
tests for serial correlation. In sections 7.4 to 7.10 each of the seven models
is presented in detail. Basic static and dynamic regression models, controlling
for both autocorrelation and heteroskedasticity present in time-series data, are
detailed in sections 7.3 to 7.5. The simplest, though not necessarily fully efficient, estimators for these models are relatively straightforward to implement.
For many applied studies this will be sufficient. For a more detailed analysis
of data, the models of sections 7.6 to 7.8 are particularly appealing. Estimation
(efficient estimation in the case of section 7.6) of these models entails complex
methods, and implementation requires reading the original papers. Some of the
models are applied in section 7.11 to monthly time-series data on the number
of contract strikes in U.S. manufacturing, first introduced in section 7.3.4.
7.2 MODELS FOR TIME SERIES DATA
7.2.1

Linear Models

A key characteristic of a time series model is that it generates autocorrelated data
sequences. For a continuous dependent variable, there are two well-established
dynamic regression models that generate a serially dependent {yt } process.
The first is the serially correlated error model, which is the classic linear regression with serially correlated disturbance. This starts with a static
regression function
yt = xt β + ut ,

(7.1)

but then assumes that the error term ut is serially correlated, following, for
example, a linear ARMA process. The simplest case is an autoregressive error
of order one (AR(1)),
ut = ρut−1 + ε t ,

(7.2)

where ε t is iid (0, σ 2 ). Then the model can be rewritten as
yt = ρyt−1 + xt β − xt−1 βρ + ε t ,

(7.3)

which is an autoregressive model with nonlinear restrictions imposed on the
parameters.
Because the dynamics of the {yt |xt } process are driven by the autoregressive
parameter ρ through the latent process (7.2), this model is referred to as a
parameter-driven model in the time-series count data literature (Cox, 1981;
Zeger, 1988).
The second approach is to directly model the dynamic behavior of y. Beginning with pure time series, where the only explanatory variables are lagged
values of the dependent variable, the standard class of linear dynamic models
is the autoregressive moving average model of orders p and q, or ARMA(p, q)
model. In the ARMA(p, q) model, the current value of y is the weighted sum

7.2 Models for Time Series Data

265

of the past p values of y and the current and past q values of an iid error
yt = ρ 1 yt−1 + · · · + ρ p yt−p + ε t + γ 1 ε t−1 + · · · + γ q ε t−q ,

(7.4)

where ε t is iid (0, σ 2 ). Again following Zeger (1988), this dynamic model is
called an observation-driven model. Stationarity of the time series {yt } implies
restrictions on the parameters.
For linear time-series regression an autoregressive model or dynamic model
includes both exogenous regressors and lagged dependent variables in the
regression function. An example is
yt = ρyt−1 + xt β + ε t ,

(7.5)
2

where the error term εt is iid (0, σ ). Note that this model is equivalent to
assuming that
yt |yt−1 ∼ D[ρyt−1 + xt β, σ 2 ],

(7.6)

(i.e., yt conditional on yt−1 and xt has distribution with mean ρyt−1 + xt β
and variance σ 2 ). More generally, additional lags of y and x may appear as
regressors. If only xt and lags of xt appear, the model is instead called a
distributed lag model. If xt alone appears as a regressor, the model is called a
static model.
The two preceding approaches, autoregression and error serial correlation,
can be combined to yield an autoregressive model with serially correlated error.
Applying least squares to (7.1), ignoring (7.2), yields consistent and asymptotically normal estimates of β. Efficient estimation for these models is by NLS,
or is by ML if a distribution is specified for ε t . In the latter case, specification
of a normal distribution for εt leads by change of variable techniques to the
. . , yT . The NLS estimator instead minimizes the sum
joint density for y1 , .
of squared residuals, Tt=1 ε2t . For example, the model (7.1)−(7.2) leads to ε t
defined implicitly in (7.3), which will lead to first-order conditions that are
nonlinear in parameters. Since ε t is homoskedastic and uncorrelated, inference
for the NLS estimator is the sameas in the non-time
 series case. Note that
when ut is serially correlated, it is t ε2t rather than t u2t that is minimized.
Minimizing the latter would lead to estimates that are inefficient, and even
inconsistent if lagged dependent variables appear as regressors. The ML (based
on normally distributed errors) and NLS estimators are asymptotically equivalent, though they differ in small samples due to different treatment of the first
observation y1 . For models with an MA component in the error, estimation is
more complicated but is covered in standard time-series texts.
To deal with the joint complications of nonstationarity and co-movements
in multiple time series that occur commonly in economic time series, the literature on linear models for continuous data has been extended to models with
unit roots, where ρ in (7.2) or (7.5) takes the value ρ = 1, and to the related
analysis of cointegrated time series. Then yt is nonstationary due to a nonstationary stochastic trend, and the usual asymptotic normal theory for estimators
no longer applies. For count regression any nonstationarity is accommodated

266

Time Series Data

by deterministic trends, in which case the usual asymptotic theory is still applicable. Unit root tests for count data are mentioned briefly at the end of section
7.6.1.
7.2.2

Extensions of Linear Models

There are many extensions of the basic linear models sketched earlier: two are
now presented because they are also considered later in the count context.
The state-space or time-varying parameter model is a modification of (7.1)
that introduces dependence through parameters that vary over time, rather than
through the error term. An example is
yt = xt β t + ε t

(7.7)

β t − β̄ = (β t−1 − β̄) + υ t ,
where εt is iid (0, σ 2 ), is a k × k matrix, and υ t is a k × 1 iid (0, ) error
vector. If the roots of lie inside the unit circle, this model is stationary, and
the model is called the return to normality model. Harvey and Phillips (1982)
show how to estimate the model by reexpressing it in state space form and
using the Kalman filter. This model is also widely used in Bayesian analysis of
time series, where it is called the dynamic linear model. A detailed treatment
is given in West and Harrison (1997).
The hidden Markov model or regime shift model allows the parameters to
differ according to which of a finite number of regimes is currently in effect. The
unobserved regimes evolve over time according to a Markov chain – hence the
term “hidden Markov models.” These models were popularized in economics
by Hamilton (1989), who considered a two-regime Markov trend model
yt−1 ,

yt = α 1 dt1 + α 2 dt2 + 

(7.8)

where 
yt is the trend component of yt , and dtj are indicator variables for whether
in regime j , where j = 1 or 2. The transitions between the two regimes are
determined by realization ct of the first-order Markov chain Ct with transition
probabilities
γ ij = Pr [Ct = j |Ct−1 = j ] ,
where γ j 1 + γ j 2 = 1. Then

1 if ct = j
dtj =
0 otherwise

i, j = 1, 2,

j = 1, 2.

(7.9)

(7.10)

Parameters to be estimated are the intercepts α 1 and α 2 , the transition probabilities γ 11 and γ 21 , and the parameters in the model for the trend component
yt = yt and omits 
yt−1

yt of the actual data yt . An even simpler example sets 
from (7.8), in which case dynamics are introduced solely via the Markov chain
determining the regime switches.

7.2 Models for Time Series Data

7.2.3

267

Count Models

There are many possible time series models for count data. Different models
arise through different models of the dependency of yt on past y, current and
past x, and the latent process or error process ε t ; through different models of
the latent process; and through different extensions of basic models.
Before presenting the various count models in detail, it is helpful to provide
a summary. For simplicity the role of regressors other than lagged dependent
variables is suppressed.
1. Serially correlated error models or latent variable models let yt depend
on a static component and a serially correlated latent variable. This is
an extension of the serially correlated error model (7.1)–(7.2).
2. Autoregressive models or Markov models specify the conditional distribution of yt to be a count distribution such as Poisson or NB2, with
a mean parameter that is a function of lagged values of yt . This is
an extension of the autoregressive model (7.5). Here the conditional
distribution of yt is specified.
3. Integer-valued ARMA (or INARMA) models specify yt to be the sum
of an integer whose value is determined by past yt and an independent
innovation. Appropriate distributional assumptions lead to a count
marginal distribution of yt such as Poisson or NB2. This is a generalization of the autoregressive model (7.5). The INARMA model
specifies the marginal distribution of yt .
4. State space models or time-varying parameter models specify the
distribution of yt to be a count distribution such as Poisson or NB2,
with conditional mean or parameters of the conditional mean that
depend on their values in previous periods. This is an extension of the
linear state space model (7.7).
5. Hidden Markov (HM) models or regime shift models specify the
distribution of yt to be a count distribution such as Poisson or NB2,
with parameters that vary according to which of a finite number of
regimes is currently in effect. The unobserved regimes evolve over
time according to a Markov chain. This is an extension of the linear
hidden Markov model (7.8) and (7.9).
6. Dynamic ordered probit models are a time series extension of the
ordered probit model introduced in Chapter 3.
7. Discrete ARMA (or DARMA) models introduce time dependency
through a mixture process.
Attempts have been made to separate these models into classes of models,
but there is no simple classification system that nests all models. Some authors
follow Cox (1981) and refer to models as either parameter-driven, with dependence induced by a latent variable process, or observation-driven, with time
series dependence introduced by specifying conditional moments or densities
as explicit functions of past outcomes.

268

Time Series Data

Others distinguish between conditional models where the moments or density are conditional on both xt and past outcomes of yt , and marginal models
where conditioning is only on xt and not on past outcomes of yt . This is most
useful for distinguishing between models 1 and 2.
Once a model is specified, ML estimation is generally not as straightforward
as in the normal linear case. NLS estimation is usually possible but may be
inefficient because the error term may be heteroskedastic and/or autocorrelated.
Estimation is often by nonlinear feasible GLS or by GMM.
Criteria for choosing between various models include ease of estimation –
models 1–3 are easiest – and similarity to standard time series models such as
having a serial correlation structure similar to ARMA models – models 3 and
7 are most similar. One should also consider the appropriateness of models
to count data typically encountered and the problem at hand. If interest lies
in the role of regressor variables, a static model of E[yt |xt ] may be sufficient.
For forecasting, a conditional model of E[yt |xt , yt−1 , yt−2 , . . .] may be more
useful.
7.3 STATIC COUNT REGRESSION
Before studying in detail various time-series count models, we consider static
regression – for example, Poisson regression of yt on xt – and some simple extensions. We present a method for valid statistical inference in the
presence of serial correlation. Residual-based tests for serial correlation are
also presented; these are easiest to implement when standardized residuals are
used.
Sometimes a static regression may be sufficient. Several regression applications of time series of counts, cited later, find little or no serial correlation.
Then there is no need to use the models presented in this chapter. This may
seem surprising, but it should be recalled that a pure Poisson point process will
generate a time series of independent counts.
7.3.1

Estimation

We consider estimation of a static regression model, with exponential conditional mean
E[yt |xt ] = exp(xt β).

(7.11)

We allow for the possibility that the dependent variable yt , conditional on the
static regressors xt , is serially correlated, in addition to the usual concern of
heteroskedasticity.

The Poisson QMLE, β̂ P , solves Tt=1 (yt − exp(xt β))xt = 0. It remains consistent in the presence of autocorrelation, provided (7.11) still holds. More
difficult is obtaining a consistent estimator of the variance matrix of these

7.3 Static Count Regression

269

estimators, which is necessary for statistical inference. We assume that autocorrelation is present to lag l, and define
ωtj = E[(yt − μt )(yt−j − μt−j )|x1 , . . . , xT ],

j = 0, . . . , l,
(7.12)

where μt = exp(xt β). The time-series results of Chapter 2.7.1 are applicable,
with gt = (yt − μt )xt . Then β̂ P is asymptotically normal with mean β and
variance matrix
 T
−1
 T
−1


μt xt xt
BP
μt xt xt
,
(7.13)
V[β̂ P ] =
t=1

t=1

where
BP =

T


ωt0 xt xt +

l 
T


ωtj (xt xt−j + xt−j xt ).

(7.14)

j =1 t=l

t=1

A robust sandwich estimate of V[β̂ P ], called a heteroskedasticity and autocorrelation consistent (HAC) estimate, replaces μt by μ̂t = exp(xt β̂) and ωtj
by (yt − μ̂t )(yt−j − μ̂t−j ) and uses Newey-West weights defined in Chapter
2.7.1, so
T
l 


j
2

ût xt xt +
1−
B̂P =
l
+
1
t=1
j =1
⎛
⎞
T
T


(7.15)
×⎝
ût ût−j xt xt−j +
ût−j ût xt−j xt ⎠ ,
t=j +1

t=j +1

where ût = yt − μ̂t . Some models presented later place more structure on
variances and autocovariances, that is, on ωtj . In particular, we expect ωtj to
be a function of μt and μt−j . Then consistent estimates ω̂tj of ωtj may be used
in (7.14). In these cases it is better, of course, to use alternative estimators to
the Poisson QMLE that use models for ωtj to obtain more efficient estimators.
The variance matrix estimate also applies to distributed lag models. Then
interpret xt as including lagged exogenous variables as well as contemporaneous exogenous variables. The results also extend to dynamic models with
lagged dependent variables as regressors, provided enough lags are included to
ensure that there is no serial correlation in yt after controlling for regressors,
so ωtj = 0 for j = 0.
The results do not apply if lagged dependent variables are regressors, and
there is serial correlation in yt after controlling for regressors. Then the Poisson
QMLE or the NLS estimator is inconsistent, just as the OLS estimator is
inconsistent in similar circumstances in the linear model.

270

Time Series Data

7.3.2

Detecting Serial Correlation

Tests based on residuals from static regressions can indicate whether any timeseries corrections are necessary or whether results from the previous chapters
can still be used.
We first consider the use of a standardized residual zt that has mean zero
and constant variance, the natural choice being the Pearson residual. For the
Poisson GLM or,
√ equivalently, Poisson QMLE with NB1 variance function,
zt = (yt − μ̂t )/√ μ̂t . For more general variance functions ωt = V[yt |xt ], use
zt = (yt − μ̂t )/ ω̂t .
Li (1991) formally obtained the asymptotic distribution of autocorrelations
√
based on Pearson residuals in GLMs, including zt = (yt − μ̂t )/ μ̂t for the
Poisson. In this subsection we specialize to the distribution under the null
hypothesis that there is no serial correlation.
Then asymptotically we can follow Box-Jenkins modeling as in the continuous case, using the autocorrelation function (ACF), which plots the estimated
correlations ρ̂ k against k, where
T
zt zt−k
(7.16)
ρ̂ k = t=k+1
T 2 .
t=1 zt
If no correlation is present ρ̂ k  0, k = 0. Formal tests are based on the standard
a
result that ρ̂ k ∼ N[0, T1 ] under the null hypothesis that ρ j ≡ Cor[zt , zt−j ] = 0,
j = 1, . . . , k. Then the test statistic
√
Tk = T ρ̂ k .
(7.17)
is asymptotically N[0, 1]. An overall test for serial correlation is the BoxPierce portmanteau statistic, basedon the sum of the first l squared sample
l
2
correlation coefficients, TBP = T
k=1 ρ̂ k . More common is to use a variant,
the Ljung-Box portmanteau statistic,
TLB = T (T + 2)

l

k=1

1
ρ̂ 2 .
T −k k

(7.18)

Both TBP and TLB are asymptotically χ 2 (l) under the null hypothesis that
ρ k = 0, k = 1, . . . , l.
The preceding tests require that zt is standardized with mean zero and
constant variance. If zt is not standardized, or zt is standardized but one wants
to guard against incorrect specification of the variance, the correct test statistic
to use is
T
zt zt−k
∗
,
(7.19)
Tk = !t=k+1
T
2 2
z
z
t
t=k+1
t−k

7.3 Static Count Regression

271

a

rather than (7.17). T∗k ∼ N[0, 1] under the null hypothesis of no autocorrelation;
see the derivations section. The statistic (7.19) is the sample analog of
!
2
],
ρ kt = E[zt zt−k ]/ E[zt2 ]E[zt−k
2
whereas the statistic (7.16) used the simplification that E[zt2 ] = E[zt−k
] given
2
standardization. An overall χ (l) test, analogous to TBP , is

T∗BP =

l


(T∗k )2 .

(7.20)

k=1

An alternative method, for unstandardized zt , is to regress zt on zt−k and use
robust sandwich (or Eicker-White) heteroskedastic-consistent standard errors
to perform individual t-tests that are asymptotically standard normal if there
is no correlation. A joint Wald test of autocorrelation to lag l can be based on
regression of zt on xt and zt−1 , . . . , zt−l , again using heteroskedastic-consistent
standard errors. This residual-augmented test is an extension of similar wellestablished tests of serial correlation in the time-series linear regression literature; see Godfrey (1988). Only heteroskedasticity is controlled for, but
this is sufficient because under the null hypothesis there is no need to control for serial correlation. However, the standard errors should additionally be
adjusted because the Pearson residuals are not the true residuals, but rather
their generated counterparts, and hence are subject to sampling error. The
robust sandwich variance estimate does not allow for this added complication. Under the null hypothesis of no autocorrelation at any lag, one can use a
standard bootstrap for a two-step estimator to obtain the estimator’s variance
matrix.
Brännäs and Johansson (1994) find good small-sample performance of serial
correlation tests based on Tk for samples of size 40. Cameron and Trivedi (1993)
present tests for the stronger condition of independence in count data and argue
that it is better to base tests on orthogonal polynomials rather than simply
powers of zt .
Several time-series count data applications have found little evidence of
serial correlation in residuals in models with exogenous contemporaneous or
lagged regressors. Examples include the annual number of bank failures in
the United States in 1947–81 (Davutyan, 1989), daily data on homicides in
California (Grogger, 1990), and the daily number of deaths in Salt Lake County
(Pope, Schwartz, and Ransom, 1992).
It is important to note that the previous tests are valid only in static models.
Autocorrelation tests based on residuals from dynamic regressions that include
lagged dependent variables require adjustment, just as they do for the linear
regression model.

272

Time Series Data

7.3.3

Trends and Seasonality

Time dependence can be modeled by extending the pure Poisson process of
Chapter 1.1.2 to a nonhomogeneous (or nonstationary) Poisson process. For
this process the rate parameter μ is replaced by μ(t), allowing the rate to vary
with the time elapsed since the start of the process. Let N (t, t + h) denote the
number of events occurring in the interval (t, t + h]. For the nonhomogeneous
Poisson process, N (t, t + h) has Poisson distribution with mean
 t+h
μ(s)ds.
(7.21)
E[N (t, t + h)] =
t

As an example, suppose there is an exponential deterministic time trend in
the rate parameter. When μ(t) = λ exp(αt) and h = 1, (7.21) yields
λ(exp(1) − 1)
exp(αt),
α
which introduces an exponential time trend to the Poisson mean. For regression
analysis, this suggests the model
E[N(t, t + 1)] =

E[yt |xt ] = exp(xt β + αt),
ignoring the additional complication introduced by time-varying regressors xt .
Seasonality can be modeled in ways similar to those used in linear models.
For example, consider monthly data with annual seasonal effects. A set of 11
monthly seasonal indicator variables might be included as regressors. Using
the usual exponential conditional mean, the seasonal effects will be multiplicative. More parsimonious may be to include a mix of sine and cosine terms,
cos(2π j t/12) and sin(2π j t/12), j = 1, . . . , p, for some chosen p.
An early and illuminating discussion of trends and seasonality in count data
models is given by Cox and Lewis (1966).
7.3.4

Example: Strikes

We analyze the effect of the level of economic activity on strike frequency,
using monthly U.S. data from January 1968 to December 1976. The dependent
variable STRIKES is the number of contract strikes in U.S. manufacturing
beginning each month. The one independent variable, OUTPUT, is a measure
of the cyclical departure of aggregate production from its trend level. High
values of OUTPUT indicate a boom and low levels of recession. A static model
is analyzed here, whereas application of some dynamic models is reported in
section 7.11.
The application comes from Kennan (1985) and Jaggia (1991), who analyzed
the data using duration models, notably the Weibull, applied to the completed
length of each strike that began during this period. Here we instead model
the number of strikes beginning each month during the period. Time series
methods for counts are likely to be needed, since Kennan found evidence of

7.3 Static Count Regression

273

Table 7.1. Strikes: Variable definitions and summary statistics
Standard
deviation

Variable

Definition

Mean

STRIKES
OUTPUT

Number of strikes that began each month
Deviation of monthly industrial production
from its trend level

5.241
−.004

3.751
.055

20

duration dependence. The data are from table 1 of Kennan (1985). For the five
months where there were no strikes (STRIKES = 0), the data on OUTPUT
were not given. We interpolated these data by averaging adjacent observations,
giving values of 0.06356, −0.0743, 0.04591, −0.04998, and −0.06035 in,
respectively, the months 1969(12), 1970(12), 1972(11), 1974(12), and 1975(9).
Summary statistics and variable definitions are given in Table 7.1. The
sample mean number of strikes is low enough to warrant treating the data as
count data. Sixty percent of the observations take values between 0 and 5, and
the largest count is 18. There is considerable overdispersion in the raw data,
with the sample variance 2.68 times the raw mean.
The data on STRIKES and OUTPUT are plotted in Figure 7.1, with different
scalings for the two series given on, respectively, the left and right axes. It
appears that strike activity increases with an increase in economic activity,
though with a considerable lag during the middle of the sample period. The
data on STRIKES are considerably more variable than the data on OUTPUT.
Estimates from static Poisson regression with exponential conditional mean
are given in Table 7.2. The standard errors reported are robust sandwich

0

-.15

-.1

5

-.05

Strikes
10

0
.05
Output

15

.1

Strikes
Output

0

20

40
60
80
Month: 1968(1) to 1976(12)

100

Figure 7.1. Strikes (left axis) and output (right axis) per month.

274

Time Series Data

Table 7.2. Strikes: Poisson QMLE with heteroskedastic
and autocorrelation robust standard errors
Standard errors
Variable

Coefficient

HAC0

HAC4

HAC8

HAC12

ONE
OUTPUT

1.654
3.134

0.066
1.184

0.103
1.921

0.116
2.222

0.123
2.402

Note: Standard errors correct for overdispersion and for autocorrelation
of length 0, 4, 8, 12, and 16 months.

20

estimates based on (7.13) and (7.14) that control for overdispersion and for autocorrelation of, respectively, 0, 4, 8, and 12 months. The coefficient of OUTPUT
indicates that as economic activity increases the number of strikes increases,
with a one-standard-deviation change in OUTPUT leading to a 17% increase in
the mean number of strikes (0.055 × 3.134 = 0.172). The effect is statistically
significant at 5% when autocorrelation is ignored (t = 3.134/1.184 = 2.48),
but once correlation is controlled for the effect becomes statistically insignificant. For example, t = 3.134/2.402 = 1.30 if there is autocorrelation up to 12
months.
A plot of the predicted value of STRIKES from this static regression,
exp(1.654 + 3.134×OUTPUT), is given in Figure 7.2. Clearly OUTPUT
explains only a small part of the variation in STRIKES. This is also reflected in
the low R-squareds. The Poisson deviance R2 and Pearson R 2 defined in section
5.3.3 are, respectively, 0.049 and 0.024, and the squared correlation between

0

Strikes: actual and predicted
10
5
15

Actual strikes
Predicted strikes

0

20

40
60
80
Month: 1968(1) to 1976(12)

100

Figure 7.2. Actual and predicted strikes from a static regression model.

7.3 Static Count Regression

275

Table 7.3. Strikes: Residuals autocorrelations and serial
correlation tests
Autocorrelations

z Statistics for p

Lag

y

r

p

Standardized

Unstandardized

1
2
3
4
5
6
7
8
9
10
11
12
BP
LB
BP∗

0.49
0.43
0.37
0.23
0.13
0.04
0.01
0.02
0.05
0.01
0.06
0.00

0.47
0.40
0.34
0.20
0.11
0.03
0.01
0.04
0.09
0.06
0.10
0.03

0.44
0.38
0.32
0.20
0.11
0.03
0.01
0.04
0.08
0.05
0.10
0.03

4.60
3.91
3.36
2.10
1.13
0.31
0.15
0.40
0.85
0.47
1.04
0.31
55.76
58.10

4.07
3.96
3.40
2.21
1.22
0.33
0.17
0.44
1.06
0.55
1.17
0.38
53.47

Note: Autocorrelations up to lag 12 are based on three different residuals: the raw
data (y) on STRIKES, and the raw residual (r) and the Pearson residual (p) from
Poisson regression of STRIKES on OUTPUT. The standardized z statistics (Tk ) for
p require the variance to be a multiple of the mean. The unstandardized z statistics
(T∗k ) for p do not require the variance to be a multiple of the mean. Both are N[0,1]
asymptotically. BP is the Box-Pierce statistic, LB is the Ljung-Box statistic, and BP∗
is the statistic T∗BP . All three are chi-squared distributed with 12 degrees of freedom.

y and μ̂ is 0.051. Considerable improvement is reported in section 7.11, when
lagged dependent variables are included as regressors.
Measures of autocorrelation and tests for serial correlation are presented in
Table 7.3. The first three columns give autocorrelation coefficients based on
various residuals: (1) the raw data y on STRIKES or equivalently the residual
y − ȳ from Poisson regression of STRIKES on a constant; (2) the raw residual
r = y − μ̂ from Poisson regression of STRIKES
on a constant and OUTPUT;
√
and (3) the Pearson residual p = (y − μ̂)/ μ̂ from this regression. Since there
is relatively little variability in μ around ȳ, see Figure 7.2, in this application
we expect the autocorrelations to tell a similar story, even though those based
on the Pearson residual are theoretically preferred.
The first three columns of Table 7.3 all indicate autocorrelation that dies out
after five lags. The last two columns present two different tests for autocorrelation based on the Pearson residuals. The first test assumes that the variance is
indeed a multiple of the mean, so the Pearson
√ residual is standardized to have
constant variance, and we can work with T ρ̂ k in (7.17) and the associated
Box-Pierce and Ljung-Box statistics. Autocorrelation is statistically significant at level 0.05 at the first four lags and is overall statistically significant

276

Time Series Data

Table 7.4. Strikes: Actual and fitted frequency distributions of Poisson and
NB2 regressions
Count
0
1
2
3
4
5
6
7
8
9
10
Actual frequency 0.046 0.111 0.130 0.102 0.083 0.130 0.083 0.037 0.065 0.093 0.056
Fitted: Poisson
0.008 0.035 0.081 0.129 0.160 0.163 0.142 0.109 0.074 0.046 0.026
Fitted: NB2
0.049 0.094 0.119 0.125 0.118 0.105 0.088 0.072 0.057 0.044 0.034
Note: The fitted frequencies are the sample averages of the cell frequencies estimated from the fitted models.

since χ 2 (12) at level 0.05 has the critical value 21.03. The second test no
longer requires that the variance is a multiple of the mean and uses (7.19) and
(7.20). The results are similar. Finally, OLS regression of the Pearson residual on OUTPUT and the first 12 lagged Pearson residuals yields an overall
robust F-test statistic of 3.96, asymptotically equivalent to a χ 2 (12) statistic of
12 × 3.96 = 47.52, similar to the portmanteau test statistics.
Although it is natural to test for serial correlation in a time-series model,
overdispersion also remains a distinct possibility. Indeed serial correlation leads
to overdispersion in the static model and will generally lead to a deficient fit
of the model. The graphical comparison of the original time series and the
fitted values from the Poisson regression conveys a clear impression of poor fit.
Comparison of actual and fitted Poisson frequencies, given in Table 7.4, also
confirms the impression of poor fit.
An NB2 regression fitted to the same data strongly rejects the null hypothesis of equidispersion and improves the fit of the model. However, although
the discrepancies between fitted and actual distributions are smaller, even
the NB2 model cannot generate the multimodal distribution of the raw data.
Tests for autocorrelation following NB2 estimation should apply (7.17) and
the associated6Box-Pierce and Ljung-Box statistics to the Pearson residual
p = (y − μ̂)/ μ̂ + α̂ μ̂2 .
7.4 SERIALLY CORRELATED HETEROGENEITY MODELS
A commonly used extension of the static regression model in the linear case
is to model the additive error as following an ARMA process, leading to
more efficient FGLS estimation. For the Poisson model the analogous method
introduces a latent multiplicative error that is serially correlated. The dynamics
of yt are then driven by the dynamics of the latent process, with resulting
autocorrelations being a function of current and lagged values of E[yt |xt ].
7.4.1

Zeger Model

Zeger (1988) introduced serial correlation in yt by multiplying the conditional
mean in the static regression model of section 7.3 by a serially correlated
multiplicative latent variable. This enables more efficient estimation than the

7.4 Serially Correlated Heterogeneity Models

277

Poisson QMLE of section 7.3, assuming that the properties of the latent variable
are correctly specified.
For counts the Poisson is used as a starting point, with variance equal to the
mean. The conditional distribution of the dependent variable yt is specified to
be Poisson with mean λt ε t , where
λt = exp(xt β),
and ε t > 0 is an unobserved latent variable. The first two moments of yt
conditional on both xt and ε t are
E[yt |λt , ε t ] = λt ε t

(7.22)

V[yt |λt , ε t ] = λt ε t .
This set-up is similar to the mixture models in Chapter 4, except here
εt is no longer assumed to be independently distributed across observations.
Instead, the latent variable ε t is assumed to follow a stationary process with the
mean normalized to unity, variance σ 2ε , covariances γ kε ≡ Cov[ε t , ε t−k ], and
autocorrelations
ρ kε ≡ Cor[ε t , ε t−k ]

6

(7.23)

= E[(εt − 1)(ε t−k − 1)]/ E[(εt − 1)2 ]E[(εt−k − 1)2 ]
γ
k = 1, 2, . . . .
= kε2 ,
σε
It follows that the marginal distribution of yt (i.e., marginal with respect to
εt while still conditional on λt and hence xt ), has first two moments
μt = E[yt |λt ] = λt
σ 2t

= V[yt |λt ] = λt +

(7.24)
σ 2ε λ2t ,

inducing overdispersion of the NB2 form. The latter result uses
V[yt |λt ] = E[V[yt |λt , ε t ]|λt ] + V[E[yt |λt , ε t ]|λt ]
= E[λt ε t |λt ] + V[λt εt |λt ]
= λt E[εt ] + λ2t V[εt ].
The latent process also induces autocorrelation in yt . The covariance between
yt and yt−k can be shown to equal γ kε λt λt−k , implying that the (time-varying)
autocorrelation function for yt is
ρ kε
k = 1, 2, . . . . (7.25)
ρ kyt = !

,
1 + (σ 2ε λ2t )−1 1 + (σ 2ε λ2t−k )−1
We refer to this model as a serially correlated error model because of its
obvious connection to the linear model (7.1)–(7.2). Other authors refer to it as a
marginal model, because from (7.24) we model μt = exp(xt β), which does not
condition on lagged yt . This model is an extension of the cross-section Poisson

278

Time Series Data

model for overdispersion, one that simultaneously introduces overdispersion,
via σ 2ε , and serial dependence, via σ 2ε and ρ kε .
7.4.2

QML Estimation

An obvious starting point is the standard Poisson QMLE β̂ P obtained by Poisson
regression of yt on xt with conditional mean exp(xt β). This estimator ignores
the complication of the latent variable ε t . Just as this estimator was shown to
be consistent under overdispersion, it remains consistent here.
Davis, Dunsmuir, and Wang (2000) prove the consistency and asymptotically
normality of the Poisson QMLE under the assumption that ε t = exp(α t ), where
{α t } is a linear Gaussian process with mean −σ 2α /2 and variance σ 2α , so ε t
has mean 1, and with bounded autocovariances. The regressors may include
trend functions, that form triangular arrays, harmonic functions, and stationary
processes; see also Brännäs and Johansson (1994). The asymptotic variance
matrix is that given in (7.13) and (7.14), where in the current model ωtj =
γ j ε λt λt−j .
Davis et al. (2000) also consider tests of autocorrelation in this model. First,
they note that estimation error in λ̂t leads to biased estimates of σ 2ε and ρ k in
finite samples, and they propose improved bias-adjusted estimators. Second,
√
they note that the usual Poisson model Pearson residual pt = (yt − λt )/ λt
has variance in the current model of (1 + σ 2ε λt ), so the standard Ljung-Box
test statistic defined in (7.18) cannot be used to test autocorrelation in yt .
They derive a valid modified Ljung-Box test statistic. Alternatively the test
in (7.20) can still be used or (7.18) can be applied to
statistic T∗BP defined
6
pt = (yt − λt )/ λt + σ 2ε λt , which has constant variance in the current model.
Third, Davis et al. (2000) note that the autocorrelations in yt are smaller than
those of εt . This is clear from (7.25) because ρ kyt → 0 as σ 2ε → 0 for given ρ kε .
They also propose tests for autocorrelation of ε t . It is quite possible to find little
autocorrelation in the observed process yt , even though there is considerable
autocorrelation in the latent process εt . Application is to the asthma attacks
data introduced in Chapter 1.3.4.
Davis and Wu (2009) provide an extension to the negative binomial (NB2)
model, parameterized as
E[yt |λt , ε t ] = rλt ε t
V[yt |λt , ε t ] = rλt ε t (1 + rλt ε t ),
where λt = exp(xt β), and the serially correlated latent variable ε t has mean
one and autocovariances γ kε ≡ Cov[ε t , ε t−k ]. Then
E[yt |λt ] = μt = rλt
V[yt |λt ] = μt + μ2t (1 + γ 0ε (1 + r))/r,
and Cov[yt , yt−k |λt , λt−k ] = μt μt−k γ kε . They consider the QMLE of β that
maximizes the NB2 log-likelihood with overdispersion parameter r specified,

7.4 Serially Correlated Heterogeneity Models

279

prove that it is consistent if {ε t } is a strongly mixing process, and obtain the
asymptotic distribution.
7.4.3

GEE Estimation

The Poisson QMLE is inefficient when a serially correlated error is present.
More efficient moment-based estimation uses knowledge of the specified model
for the conditional mean, variance, and autocovariances of yt . Zeger (1988)
proposed estimation using the GEE estimator, presented in Chapter 2.4.6,
adapted to serially correlated data.
The GEE estimator for β in the model of section 7.4.1 solves the first-order
conditions
D V−1 (y − λ) = 0,

(7.26)

where D is the T × k matrix with tj th element ∂λt /∂β j , V−1 is a T × T
weighting matrix defined later, y is the T × 1 vector with t th entry yt , and λ is the
T × 1 vector with t th entry λt = E[yt |xt ]. Equation (7.26) is of the same form
as the linear WLS estimator given in Chapter 2.4.1 (i.e., X V−1 (y − X β) = 0),
except that in moving to nonlinear models xtj in X is replaced by ∂λt /∂β j in
D and the mean X β is replaced by λ. Then by similar results to Chapter 2.4.1,
β̂ GEE is asymptotically normal with mean β and variance
V[β̂ GEE ] = (D V−1 D)−1 D V−1 V−1 D (D V−1 D)−1 ,

(7.27)

where  = (β, γ , σ 2 ) = V[y|X] is the covariance matrix of y, and γ are
parameters of the autocorrelation function ρ ε (k).
ˆ −1 , where 
ˆ is a consistent
The efficient GEE estimator sets V−1 = 
2
estimator of  = (β, γ , σ ). This entails inversion of the T × T estimated
covariance matrix of yt , which poses problems for large T . Zeger instead proposed using a less efficient GEE estimator that specifies a working weighting
matrix V−1 that is chosen to be reasonably close to −1 .
Zeger (1988) applied this method to monthly U.S. data on polio cases,
whereas Campbell (1994) applied this model to daily U.K. data on sudden
infant death syndrome cases and the role of temperature. Brännäs and Johansson
(1994) find that the Poisson QMLE yields quite similar estimates and efficiency
to that using Zeger’s method, once appropriate correction for serial correlation
is made to the Poisson QMLE standard errors. Johansson (1995) presents Wald
and LM type tests based on GMM estimation (see Newey and West, 1987b) for
overdispersion and serial correlation in the Zeger model, and investigates their
small-sample performance by a Monte Carlo study.
7.4.4

ML Estimation

Fully efficient ML estimation is possible given specification of a parametric
model for the latent process.

280

Time Series Data

In the cross-section case a Poisson-lognormal mixture model specifies ln(εt )
to be normally distributed. A time series generalization has ln(εt ) follow a
Gaussian first-order autoregression. Defining vt = ln(εt ), we have
vt = δvt−1 + σ ut ,

ut ∼ iid N[0, 1].

(7.28)

Here δ = 0 yields the usual Poisson-lognormal mixture model, and the restrictions δ = 0 and σ = 0 reduce the model to the Poisson case. This model is
stationary if |δ| < 1.
Jung et al. (2006) call the model of section 7.4.1 with ν t as in (7.28)
the stochastic autoregressive mean (SAM) model. Then yt |μt , vt−1 , ut ∼
P[exp(xt β + δvt−1 + σ ut )]. Let
f (yt | exp(xt β + δν t−1 + σ ut ))
denote this Poisson density. The marginal distribution h(yt |μt , vt−1 ) can be
obtained by integrating out ut , so
 ∞
1
2
h(yt |μt , vt−1 ) =
f (yt | exp(xt β + δν t−1 + σ ut )) √ e−u /2 dut .
2π
−∞
There is no closed-form solution for h(yt |μt , vt−1 ), but the expression can be
approximated numerically by adapting simulated ML, presented in Chapter
4.2.4, to a time-series setting.
First, note that given an initial condition, ν 0 = E[ν t ] = 0, and random
(s)
draws from the N[0, 1] distribution, say u(s) = {u(s)
1 , . . . , uT }, the sequence
v(s) = {v1(s) , . . . , vT(s) } can be generated recursively for a given value of δ using
(7.28). Therefore, the unobserved latent variables (ut , ν t ) can be replaced by
simulated values. Then
(s)
h(yt | μt , ν 0 , u(s)
1 , . . . , ut ) ≈

S
1
(s)
f (yt | exp(xt β + δν (s)
t−1 + σ ut ))].
S s=1

(7.29)
The simulated likelihood function can be built up using T terms like that
above. If the heterogeneity term were observable, then the likelihood could
be constructed directly. But absent such information, we use S (preferably a
large integer) draws from a pseudorandom number generator. Simulated ML
estimates are obtained by maximizing the log-likelihood function
L(β, δ, σ ) =

T

t=1

ln

S
1
(s)
f (yt | exp(xt β + δν (s)
t−1 + σ ut )),
S s=1

(7.30)

with respect to (β, δ, σ ). Additional details of the properties of this method are
given in Chapter 4.2.4. This approach can potentially be extended to nonnormal
distributions of the latent variable as well as to higher order ARMA processes.
Other alternative simulation methods may also be applied to estimate the
SAM model. Jung et al. (2006) apply efficient importance sampling in their
analysis of the Sydney asthma counts data described in Chapter 1.3.4. The

7.5 Autoregressive Models

281

parametric formulations similar in spirit to that given earlier are also amenable
to analysis by Bayesian Markov chain Monte Carlo (MCMC) methods as shown
by Chan and Ledolter (1995).
7.5 AUTOREGRESSIVE MODELS
The most direct way to specify a time-series model is to include lagged values
of the dependent count variable as regressors in a standard count regression
model that may also include current and past values of exogenous variables as
regressors. The models are then called autoregressive models or observationdriven models. Relative to the parameter-driven models of section 7.4, they
are easier to estimate and to interpret and are more convenient for forecasting
purposes. Given their nonlinearity, however, their time series properties are
often difficult to establish.
A simple autoregressive count model adds yt−1 as a regressor, so the
conditional mean is exp(xt β + ρyt−1 ). However, this model is explosive for
ρ > 0 since then ρyt−1 ≥ 0 because the count y is nonnegative. For example, in the pure time series case the conditional mean exp(β + ρyt−1 ) =
exp(β) exp(ρyt−1 )  exp(β)(1 + ρyt−1 ), for small ρ, necessarily increases
over time for y > 0. Simulations and discussion are given in Blundell, Griffith, and Windmeijer (2002), who call this model exponential feedback. A less
explosive alternative is to add ln yt−1 as a regressor, but then adjustment is
needed when yt−1 = 0.
The difficulty in incorporating lagged y has led to a wide range of autoregressive models. Unlike the linear case, there is currently no firmly established
preferred model.
7.5.1

Zeger-Qaqish Model

Define X(t) = (xt , xt−1 , . . . , x0 ) and Y(t−1) = (yt−1 , yt−2 , . . . , y0 ). In principle
the conditioning set for the dependent variable yt is (X(t) , Y(t−1) ), and we model
μt|t−1 = E[yt |X(t) , Y(t−1) ].
Zeger and Qaqish (1988) considered GLMs with up to p lags of the dependent
variable determining the conditional mean. They called their models Markov
models of order p, because yt−1 , . . . , yt−p are the only elements of the past
history Y (t−1) that affect the conditional distribution of yt . This terminology
should not be confused with hidden Markov models presented in section 7.8.
Here we specialize to the Poisson with one lag of the dependent variable
that appears multiplicatively, with conditional mean
∗
)
μt|t−1 = exp(xt β + ρ ln yt−1

(7.31)

∗
= exp(xt β)(yt−1
)ρ ,
∗
is a transformation of yt−1 that is strictly positive since otherwise
where yt−1
∗
include rescaling only the zero
μt|t−1 = 0 when yt = 0. Possibilities for yt−1

282

Time Series Data

values of yt−1 to a constant c
∗
yt−1
= max(c, yt−1 ),

0 < c < 1,

(7.32)

and translating all values of yt−1 by the same amount
∗
= yt−1 + c,
yt−1

c > 0.

(7.33)

The model (7.31) can be viewed as a multiplicative AR(1) model by comparison
to the linear AR(1) model in (7.4).
An alternative to (7.31), proposed by Zeger and Qaqish (1988), is the model
∗
− xt−1 β))
μt|t−1 = exp(xt β + ρ(ln yt−1

ρ
∗
yt−1

.
= exp(xt β)

exp(xt−1 β)

(7.34)

This can be viewed as a multiplicative AR(1) error model with multiplicative
“error” yt / exp(xt β), by comparison to the linear AR(1) error model that from
(7.3) implies μt|t−1 = xt β + ρ(yt−1 − xt−1 β).
Given the conditional mean specification in (7.31), the NLS estimator is
consistent provided yt − μt|t−1 has zero mean and is serially uncorrelated, and
heteroskedastic-robust standard errors lead to valid inference. As in the crosssection case, however, estimators based on a count model are likely to be more
efficient.
Given a specified conditional density f (yt |xt , yt−1 ), such as the Poisson, the
ML estimator maximizes
L(β, ρ) =

T


ln f (yt |xt , yt−1 ).

(7.35)

t=1

Estimation theory is given in Wong (1986) and Fahrmeir and Kaufman (1987).
Consistency requires that f (yt |X(t) , Y(t−1) ) = f (yt |xt , yt−1 ) so that L =
T
f (y1 , . . . , yT |x1 , . . . , xT ) =
f (yt |xt , yt−1 ) and that μt|t−1 is correctly
t=1
specified. To allow for overdispersion in the Poisson model, heteroskedasticrobust standard errors are used. Or overdispersion could be handled by instead
specifying f (yt |xt , yt−1 ) to be the NB2 density.
More generally regressors should include sufficient lags of yt , say p, to
ensure that f (yt |X(t) , Y(t−1) ) = f (yt |X(t) , yt−1 , . . . , yt−p ). Then the Poisson
QMLE is consistent, provided the functional form for μt|t−1 is correctly specified, and inference is based on heteroskedastic-robust standard errors.
If the constant c in (7.32) or (7.33) is specified, often c = 0.5 in (7.32) and
c = 0.1 in (7.33), then a standard Poisson program can be used. If instead c is
an additional parameter to be estimated, standard Poisson software can still be
used for yt∗ = max(c, yt−1 ) as in (7.32). Rewrite (7.34) as
∗∗
+ (ρ ln c) dt )
μt|t−1 = exp(xt β + ρ ln yt−1

(7.36)

∗∗
∗∗
= yt−1 and dt = 0 if yt−1 > 0, and yt−1
= 1 and dt = 1 if yt−1 = 0.
where yt−1
∗∗
Poisson regression of yt on xt , yt−1 , and dt yields estimates of β, ρ, and ρ ln c.

7.5 Autoregressive Models

283

Then use c = exp[(ρ ln c)/ρ] to obtain an estimate of c. The autoregressive
count model is attractive because it is relatively simple to implement.
Such autoregressive models have not been widely applied, especially for
data where some counts are zero. Fahrmeier and Tutz (1994, chapter 6.1) gave
an application to monthly U.S. data on the number of polio cases. Cameron
and Leon (1993) applied the model to monthly U.S. data on the number of
strikes and gave some limited simulations to investigate the properties of both
estimators and the time-series process itself, since theoretical results on its serial
correlation properties are not readily obtained. Leon and Tsai (1997) proposed
and investigated by simulation quasi-likelihood analogs of LM, Wald, and LR
tests, following the earlier study by Li (1991), who considered the LM test.
Zeger and Qaqish (1988) more generally considered GLMs. For GLMs
other than Poisson the exponential function in (7.31) is replaced by the relevant
canonical link function, and in most cases lags of y can be used because an
adjustment for zero lagged value of y is not necessary. Zeger and Qaqish (1988)
proposed QML estimation.
7.5.2

Alternative Conditional Mean Specifications

A weakness of the Zeger-Qaqish model in the special case of counts is that
the adjustments for zero lagged values of yt , such as (7.32) or (7.33), are
ad hoc. Furthermore, such adjustments complicate evaluation of the impact
of regressors on the change in the conditional mean. Papers subsequent to
Zeger and Qaqish (1988) have proposed various alternative specifications for
μt|t−1 = E[yt |X(t) , Y(t−1) ].
One alternative is to replace (7.31) by
μt|t−1 = ρyt−1 + exp(xt β).

(7.37)

This ensures a positive conditional mean if ρ > 0 and is not explosive. This
can be interpreted as a partial adjustment model. Suppose μt is a target value of
1
)yt−1 −
yt and we adjust yt according to yt = λ(yt − yt−1 ). Then yt = ( 1−λ
1
1
( 1−λ )μt , leading to a conditional mean of the form (7.37) with ( 1−λ )μt =
exp(xt β).
The specification (7.37) equals the conditional mean (7.50) of the Poisson INAR(1) model presented in section 7.6, although other features of the
distribution such as the conditional variance (see [(7.44)]) will differ.
Another alternative, proposed by Shephard (1995), is to develop autoregressive models for a transformation of the dependent variable. For a GLM with
log link function, corresponding to the Poisson, he proposes the model
z(yt ) = xt β +

p

j =1

γ j z(yt−j ) +

q

k=1

δk

yt−k − μt−k
,
μt−k

where z(yt ) is recursively generated given initial conditions.

(7.38)

284

Time Series Data

Davis et al. (2003) propose the following specification for the conditional
mean in an autoregressive model of order p:
⎛
⎞
p

(λ) ⎠
,
(7.39)
γ j zt−j
μt|t−1 = exp ⎝xt β +
j =1
(λ)
where zt−j
= (yt−j − μt−j )/μλt−j , 0 < λ ≤ 1. The parameter λ can be fixed or
free; zt is the Pearson residual if λ = 1/2. This specification augments the static
conditional mean specification by adding lagged residual-like terms that control
for potential serial correlation of an order up to q. The model is a variation on
(7.34) with an alternative specification for the error term that does not have the
explosiveness of exponential feedback. Interpretation of the slope coefficients β
as semi-elasticities does not change because on average the residual terms equal
zero and they only modify the intercept in the model. We can therefore interpret
this specification as a model with a potentially serially correlated intercept. The
models (7.38) and (7.39) are sometimes called examples of generalized linear
autoregressive moving average (GLARMA) models.
Jung et al. (2006) suggest another dynamic specification that is in the spirit
of Engle and Russell’s (1998) autoregressive conditional duration model, and
hence is called an autoregressive conditional Poisson (ACP) model. This model
has the following mean specification:

μt|t−1 = exp(xt β)ε t ,
where

⎛
εt = exp ⎝ω +

p


α j yt−j +

j =1

q


⎞
γ k ε t−k ⎠ .

k=1

This is an extension of the serial correlation model of section 7.4.1, which is
the special case α j = 0, j = 1, . . . , p. However, the inclusion of lagged yt
variables can also capture state dependence or persistence of the outcomes.
Estimation of this model is discussed in Jung et al. (2006). They also compare
the performance of several dynamic count models, using the Sydney asthma
count data.
Fokianos, Rahbek, and Tjøstheim (2009) investigate the properties of a pure
time-series model in which yt is Poisson with a conditional mean that depends
on both the conditional mean lagged and the dependent variable lagged, so
μt|t−1 = β + γ μt−1|t−2 + αyt−1 ,
where β > 0, γ > 0, and α > 0.
7.6 INTEGER-VALUED ARMA MODELS
INARMA models specify the realized value of yt to be the sum of a count
random variable, whose value depends on past outcomes, and the realization of

7.6 Integer-Valued ARMA Models

285

an iid count random variable εt whose value does not depend on past outcomes.
This model is similar to the linear AR model yt = ρyt−1 + εt , for example,
though it explicitly models yt as a count. Different choices of the distribution
for ε t lead to different marginal distributions for yt , such as the Poisson. The
model has the attraction of having the same serial correlation structure as linear
ARMA models for continuous data.
INARMA models were independently proposed by McKenzie (1986) and
Al-Osh and Alzaid (1987) for the pure time-series case and were extended to the
regression case by Brännäs (1995a). They build on earlier work for continuous
non-Gaussian time series, specifically exponential and gamma distributions
(Lewis, 1985; Jacobs and Lewis, 1977).
7.6.1

Pure Time-Series Models

We begin with the pure time-series case before introducing other regressors xt
in the next subsection. Let Y(t−1) = (yt−1 , yt−2 , . . . , y0 ). The simplest example
is the INAR(1) process
yt = ρ ◦ yt−1 + ε t ,

0 ≤ ρ < 1,

(7.40)

where εt is an iid latent count variable independent of Y(t−1) . The symbol
◦ denotes the binomial thinning operator of Stuetel and Van Harn (1979),
whereby ρ ◦ yt−1 is the realized value of a binomial random variable with
yt−1 trials and probability ρ of success on each trial. More formally ρ ◦ y =

y
j =1 uj , where uj is a sequence of iid binary random variables that take value
1 with probability ρ and value 0 with probability 1 − ρ. Thus each of the y
components survives with probability ρ and dies with probability 1 − ρ.
The model can be viewed as a birth (via ε t ) and death (via ρ ◦ yt−1 ) process
or as a queueing model, stock model, or a branching process. The special
feature is that both components are counts.
First consider the unconditional distribution of y. It can be shown that
μ = E[y] =

E[ε]
,
1−ρ

(7.41)

and
σ 2 = V[y] =

ρE[ε] + V[ε]
;
1 − ρ2

(7.42)

see, for example, Brännäs (1995a) and exercise 7.3. Given a particular distribution for ε, the unconditional stationary distribution for y can be found by
probability generating function techniques; see Steutel and Van Harn (1979)
and McKenzie (1986). For example, y is Poisson if ε is Poisson.
For the conditional distribution, taking the conditional expectation of (7.40)
yields the conditional mean,
μt|t−1 = E[yt |yt−1 ] = ρyt−1 + E[εt ],

(7.43)

286

Time Series Data

a result similar to that for the Gaussian model. The conditional variance is
σ 2t|t−1 = V[yt |yt−1 ] = ρ(1 − ρ)yt−1 + V[ε t ].

(7.44)

The key step in obtaining (7.43) and (7.44) is to note that ρ ◦ yt−1 , conditional
on yt−1 , has mean ρyt−1 and variance ρ(1 − ρ)yt−1 using standard results on
the binomial with yt−1 trials. It can be shown that the autocorrelation at lag k
is ρ k . Thus the INAR(1) model has the same autocorrelation function as the
AR(1) model for continuous data. The conditional distribution of yt given yt−1
is that of a Markov chain.
The Poisson INAR(1) model results from specifying the latent variable εt
in (7.40) to be iid Poisson with parameter λ. Then yt is unconditionally Poisson with parameter λ/(1 − ρ). Furthermore, in this case (yt , yt−1 ) is bivariate
Poisson, defined in Chapter 8.4.1. The conditional moments using (7.43) and
(7.44) are
μt|t−1 = ρyt−1 + λ
σ 2t|t−1

(7.45)

= ρ(1 − ρ)yt−1 + λ,

so the Poisson INAR(1) model is conditionally underdispersed. The transition
probabilities for the Markov chain conditional distribution are

min(yt ,yt−1 )

λyt−j
yt−1
Pr [yt |yt−1 ] = exp(−λ)
ρ j (1 − ρ)yt−1 −j .
j
(y
−
j
)!
t
j =0
(7.46)
Generalizations of Poisson INAR(1) to INAR(p) and INARMA(p, q) models, and to marginal distributions other than Poisson, are given in various papers
by McKenzie and by Al-Osh and Alzaid. Papers by Al-Osh and Alzaid additionally considered estimation. In the INAR(p) process
yt =

p

k=1

ρ k ◦ yt−k + ε t ,

0≤

p
k=1

ρ k < 1.

McKenzie (1986) obtained an INARMA model with an unconditional negative
binomial distribution for yt by specifying ε t to be iid negative binomial. McKenzie (1988) studied the Poisson INARMA model in detail. Al-Osh and Alzaid
(1987) considered estimation of the Poisson INAR(1) model and detailed properties of INAR(1) and INAR(p) models in, respectively, Alzaid and Al-Osh
(1988, 1990). Alzaid and Al-Osh (1993) obtained an INARMA model with
an unconditional generalized Poisson distribution, see Chapter 4.11.4, which
potentially permits underdispersion. This model specifies εt to be generalized
Poisson and replaces the binomial thinning operator by quasi-binomial thinning. Whereas the INARMA models have the same autocorrelation function
as linear ARMA models, the partial autocorrelation functions differ. Further
models are given by Gauthier and Latour (1994), who define a generalized
Steutel Van Harn operator. Still further generalization may be possible. In the
AR(1) case, for example, essentially all that is needed is an operator that yields
a discrete value for the first term in the right-hand side of (7.40). For example,

7.6 Integer-Valued ARMA Models

287

there is no reason why the yt−1 trials need be independent, and one could, for
example, use a correlated binomial model.
Initial research on INARMA models focused on stochastic properties,
with less attention paid to estimation. The conditional least squares estimator is straightforward but inefficient. For the Poisson INAR(1) model,
E[yt |yt−1 ] = ρyt−1 + λ. This allows simple estimation of ρ and λ by OLS
regression of yt on an intercept and yt−1 , a method proposed by Al-Osh
and Alzaid (1987). The error in this regression is heteroskedastic, since
V[yt |yt−1 ] = ρ(1 − ρ)yt−1 + λ, so care needs to be taken to obtain the correct
variance covariance matrix and the estimator could potentially be quite inefficient. Du and Li (1989) more generally proposed estimation of the INAR(p)
model based on the Yule-Walker equations. Brännäs (1994) proposed and investigated the use of GMM estimators for the Poisson INAR(1) model. GMM has
the theoretical advantage of incorporating more of the moment restrictions,
notably autocovariances, implied by the Poisson INAR(1) model. Savani and
Zhigljavsky (2007) proposed estimation of the negative binomial INAR(1) by
power estimation methods.
Exact ML estimators, as well as conditional ML estimators that condition on
an initial value y0 , were proposed and investigated by Al-Osh and Alzaid (1987)
and Ronning and Jung (1992) for the Poisson INAR(1) model. These estimators
can be difficult to implement, especially for models other than the Poisson.
Drost, Van Den Akker, and Werker (2008) propose a fully efficient two-step
estimator for the INAR(p) model. Bu, McCabe, and Hadri (2008) derive the
likelihood for the Poisson INAR(p) model, using a recursive formulation for
conditional probabilities, and expressions for the score and information matrix.
Enciso-Mora, Neal, and Rao (2008a) present MCMC methods to estimate
INARMA(p, q) models and to select the orders p and q.
Drost, Van Den Akker, and Werker (2009a) consider nonparametric ML
estimation for the INAR(p) model, where the distribution G(ε) for ε t is not
specified. They prove consistency and root-n asymptotic normality for the
estimators of both ρ 1 , . . . , ρ p and G(·). McCabe, Martin, and Harris (2011)
consider efficient probability forecasts based on nonparametric ML estimation
of the INAR(p) model.
Drost, Van Den Akker, and Werker (2009b) consider testing for unit roots
in the INAR(1) model and estimation when the root is near to unity (with
ρ = 1 − c/T 2 ).
7.6.2

Regression Models

The statistics literature has focused on the pure time-series case, a notable early
exception was McKenzie (1985, p. 649), who briefly considered introduction
of trends.
Brännäs (1995a) proposed a Poisson INAR(1) regression model, with regressors introduced into (7.40) through both the binomial thinning parameter ρ t
and the latent count variable εt . Then
yt = ρ t ◦ yt−1 + εt ,

(7.47)

288

Time Series Data

where the latent variable εt in (7.47) is assumed to be Poisson distributed with
mean
λt = exp(xt β).

(7.48)

To ensure 0 < ρ t < 1, the logistic function is used:
ρt =

1
.
1 + exp(−zt γ )

(7.49)

From (7.43) with ρ replaced by ρ t , the conditional mean for this model is

1
yt−1 + exp(xt β).
μt|t−1 = E[yt |xt , zt , yt−1 ] =
1 + exp(−zt γ )
(7.50)
A simpler specification sets zt = 1, so the parameter ρ is a constant. The
conditional variance is

exp(−zt γ )
2
yt−1 + exp(xt β),
σ t|t−1 = V[yt |xt , zt , yt−1 ] =
[1 + exp(−zt γ )]2
(7.51)
from (7.44).
In Brännäs’ application to annual Swedish data on the number of paper mills
of a particular type, the parameters γ in the model for ρ t are interpreted as
representing the role of regressors in explaining the death of firms, whereas the
parameters β of the Poisson density for εt represent the role of regressors in
explaining the birth of firms.
Brännäs proposed NLS and GMM estimators for the INAR(1) model and
additionally considered prediction. Using (7.50), the conditional NLS estimator
minimizes with respect to β and γ
S(β, γ ) =



T 


yt −

t=1

2

1
yt−1 − exp(xt β)
1 + exp(−zt γ )

. (7.52)

This estimator is relatively straightforward to implement given access to a
statistical package that includes NLS estimation and computing robust standard
errors that adjust for heteroskedasticity. An alternative more efficient estimator
is conditional weighted LS, where the weighting function can be obtained from
(7.51). Details of the GMM estimator, based on additional knowledge of the
functional form for the autocovariances implied by the Poisson INAR(1) model,
are given in Brännäs (1995a). In principle GMM should be more efficient than
NLS, but Brännäs found little gain.
Brännäs and Hellström (2001) present a range of generalizations of the
INAR(1) model, including allowing for correlation in the binomial thinning
ρ t ◦ yt−1 and a richer process for εt . They present conditional and unconditional
first and second moments and GMM estimators based on these moments. Weiss
(2008) provides further details on Poisson INAR(1) and INAR(q) regression

7.7 State Space Models

289

models and finds that the models are closely related to each other. Enciso-Mora,
Neal, and Rao (2008b) present MCMC methods to estimate an INAR(p) model
with regressors using Bayesian MCMC methods with data augmentation.
7.7 STATE SPACE MODELS
The autoregressive and INAR models specify the conditional distribution of
yt to depend on a specified function of (X(t) , Y(t−1) ). The state space model
or time-varying parameters model instead specifies the conditional distribution
of yt to depend on stochastic parameters that evolve according to a specified
distribution whose parameters are determined by (X(t) , Y(t−1) ).
Analytical results can be obtained if only the mean parameter evolves over
time, with density that is conjugate to the density of yt . More generally the
model has regression coefficients that evolve over time, in which case a normal
distribution is typically chosen. Analytical results are then no longer attainable,
so the models are estimated using computationally intensive methods.
These methods often cast the model in a Bayesian framework. Then interest
lies in obtaining the posterior mean, which in the time-series case is used to
generate forecasts that incorporate prior information. A standard reference is
West and Harrison (1997, first edition 1990). Bayesian computational methods
are also widely used in frequentist analyses where the focus is on parameter estimation, and it is not uncommon to see frequentist analyses take on a Bayesian
flavor because of this use; see Chapter 12. Durbin and Koopman (2000) present
both frequentist and Bayesian methods for state space models for non-Gaussian
data such as count data. We focus on the frequentist interpretation here.
7.7.1

Conjugate Distributed Mean

West, Harrison, and Migon (1985) proposed Bayesian time-series models for
regression models with prior density for the conditional mean chosen to be
conjugate to an LEF density. These models are an extension of dynamic linear
models, see West and Harrison (1997), to the GLM framework though this
extension is not seamless. Interest lies in obtaining the posterior mean and
forecasting, given specified values for the prior density parameters.
Harvey and Fernandes (1989) studied these models in a non-Bayesian framework and considered parameter estimation. The most tractable model for count
data is a Poisson-gamma model. Assume yt conditional on μt is P[μt ] distributed, so
f (yt |μt ) = e−μt μt /yt !.

(7.53)

The mean parameter μt is modeled to evolve stochastically over time with
distribution determined by past values of yt . A convenient choice of distribution
is the gamma
f (μt |at|t−1 , bt|t−1 ) =

e−bμt μa−1
t
,
(a)b−a

at|t−1 > 0, bt|t−1 > 0, (7.54)

290

Time Series Data

where a and b in (7.54) are evaluated at a = at|t−1 = ωat−1 and b = bt|t−1 =
ωbt−1 and 0 < ω ≤ 1. The conditional density of yt given the observables
Y(t−1) is
 ∞
f (yt |μt )f (μt |Y(t−1) )dμt .
(7.55)
f (yt |Y(t−1) ) =
0

From Chapter 4.2.2, f (yt |Y(t−1) ) is the negative binomial with parameters at|t−1
and bt|t−1 . Estimation of ω and the parameters of μt is by ML, where the joint
density of Y(t) is the product of the conditional densities (7.55). The Kalman
filter is used to recursively build at|t−1 and bt|t−1 .
Harvey and Fernandes (1989) apply this approach to count data on goals
scored in soccer matches, purse snatchings in Chicago, and van driver fatalities. They also obtain tractable results for negative binomial with parameters
evolving according to the beta distribution and for the binomial model. Singh
and Roberts (1992) consider count data models. Harvey and Shephard (1993)
consider the general GLM class. Brännäs and Johansson (1994) investigate
small-sample performance of estimators. Johansson (1996) gives a substantive
regression application to monthly Swedish data on traffic accident fatalities,
which additionally uses the model of Zeger (1988) discussed in section 7.4.
7.7.2

Normally Distributed Parameters

A richer model with regressors is the Poisson regression model (7.53), with
μt = exp(xt β t ) where β t evolves according to
β t = At β t−1 + υ t ,

(7.56)

where
υ t ∼ N[0,

t ].

For this model there are no closed-form solutions analogous to (7.55). The
development of numerical techniques for these models is an active area of
research.
An example is Durbin and Koopman (1997), who model British data on
van driver fatalities. They first follow Shephard and Pitt (1997) in developing an MCMC method to numerically evaluate the likelihood of the model.
Durbin and Koopman (1997) then propose a faster procedure that calculates
the likelihood for an approximating linear Gaussian model by Kalman filter techniques for linear models; then they compute the true likelihood as an
adjustment to this approximating model. Durbin and Koopman (2000) survey computational methods for a class of models that includes this model.
Frühwirth-Schnatter and Wagner (2006) propose use of auxiliary mixture sampling and data augmentation that enable the use of Gibbs sampling rather than
the slower Metropolis-Hastings algorithm.

7.8 Hidden Markov Models

291

7.8 HIDDEN MARKOV MODELS
Finite mixture models presented in Chapter 4.8 model cross-section count data
as coming from one of a finite number of classes or regimes. Hidden Markov
time-series models similarly specify different parametric models in different
regimes, but extend the cross-section case to modeling the unobserved regimes
as evolving over time according to a Markov chain. Here we summarize results
given in considerably more detail in MacDonald and Zucchini (1997).
For the model with m possible regimes, let Ct , t = 1, . . . , T , denote a
Markov chain on state space {1, 2, . . . , m}. Thus Ct = j if at time t we are in
regime j . In the simplest case, considered here, Ct is an irreducible homogeneous Markov chain, with transition probabilities
γ ij = Pr [Ct = j |Ct−1 = i] ,

i, j = 1, . . . , m,

(7.57)

that are time invariant. It is assumed that there exists a unique strictly positive
stationary distribution
δ j = Pr [Ct = j ] ,

j = 1, . . . , m,

(7.58)

where the δ j are a function of γ ij .
The model is completed by specifying conditional densities f (yt |Ct = j ),
j = 1, . . . , m.
7.8.1

Poisson Hidden Markov Model

For the Poisson hidden Markov model, it is assumed that the count data yt
in each regime are Poisson distributed and independent over t, with a mean
parameter that varies with exogenous variables and the regime
μtj = exp(xt β j ),

j = 1, . . . , m.

(7.59)

The moments of yt , unconditional on Ct , though still conditional on xt , can
be shown to be
m

δ j μtj
(7.60)
E[yt |xt ] =
j =1

E[yt2 |xt ]

=

m


δ j (μtj + μ2tj )

(7.61)

j =1

E[yt yt+k |xt ] =

m 
m


δ i γ ij (k)μti μt+k,j ,

(7.62)

i=1 j =1

where γ ij (k) = Pr[Ct+k = j |Ct−1 = i] and t = 1, . . . , T .
Equations (7.60) and (7.62) are just the weighted sums of the first two
moments in each regime, with weights δ j , and it can be shown that V[yt |xt ] >
E[yt |xt ], so the model induces overdispersion.

292

Time Series Data

Equation (7.62) follows from the Markov chain. The autocorrelation function of yt , which follows directly from (7.60) to (7.62), is a function of the
Poisson parameters and the transition probabilities. In the case m = 2 and
μtj = μj , j = 1, 2, Cor[yt yt+k ] = a(γ 11 + γ 22 − 1)k , where a is defined in
MacDonald and Zucchini (1997, p.71).
Applications to count data include the daily number of epileptic seizures by
a particular patient, fitted by a two-state hidden Markov Poisson model with
μtj = μj , and the weekly number of firearm homicides in Cape Town, fitted by
a two-state hidden Markov Poisson model with μtj = exp(α 1j + α 2j t + α 3j t 2 ).
Count data can be directly modeled as a Markov chain, rather than via a
hidden Markov chain. For counts there are potentially an infinite number of
transition parameters, and additional structure is needed. An example of such
structure is the Poisson INAR(1) model whose transition probabilities are
given in (7.46).
7.8.2

ML Estimation

The parameters to be estimated are the regime-specific parameters β j , j =
. ML estimation, imposing the
1, . . . , m, and the transition probabilities γ ij
constraints that γ ij ≥ 0 and the constraints j =i γ ij ≤ 1, i = 1, . . . , m, is
presented in MacDonald and Zucchini (1997).
The joint density f (yt , Ct |Y(t−1) ) at time t is given by
m


dtj
Pr[Ct = j |Y(t−1) ] × f (yt |Ct = j ) ,
f (yt , Ct |μ1 , . . , μm ) =
j =1
(7.63)
where the indicator variables dtj = 1[Ct = j ], j = 1, . . . , m. The marginal
density is
f (yt |Y(t−1) ) =

m


Pr[Ct = j |Y(t−1) ] × f (yt |Ct = j ).

(7.64)

j =1

Suppose the path of the Markov chain is known and is denoted as
{C1 = j1 , C2 = j2 , . . . , CT = jT } .

(7.65)

Then the joint density of the sample can be written as
f (Y(T ) , C(T ) )
= f (y1 , . . . , yT , C1 = j1 , . . . , CT = jT )
= Pr[C1 = j1 , . . . , CT = jT ] × f (y1 , . . . , yT |C1 = j1 , . . . , CT = jT )
T

= Pr[C1 = j1 ]f (y1 |C1 = j1 ) Pr[Ct = jt |Ct−1 = jt−1 )
(7.66)
t=2
T

f (yt |Ct = jt )
×
t=2

= δ j1 f (y1 |C1 = j )

T

t=2

γ jt jt−1 f (yt |Ct = jt ).

7.9 Dynamic Ordered Probit Model

293

An alternative way of writing the complete-data likelihood is the following.
f (Y

(T )

(T )

,C

)=



m


f (y1 |C1 = j )δ j

d1j

j =1

T 
m 
m



γ kl f (yt |Ct = j )

dtkl

,

t=2 k=1 l=1

(7.67)
where dtkl = 1[Ct−1 = k, Ct = l], k, l = 1, . . . , m.
The corresponding marginal joint density is obtained by integrating out the
unobserved Markov chain variables C1 , . . . , CT , so


m
m
T



(T )
...
γ j(t−1) jt f (yt |Ct = jt ) .
f (Y ) =
δ j1 f (y1 |C1 = j1 )
j1 =1

jT =1

t=2

(7.68)
Written as in the preceding equation, the marginal likelihood is difficult to
compute. However, following MacDonald and Zucchini (1997), it can be written using matrix-vector operations. Define the m × 1 vector δ = (δ 1 , . . . , δ m ) ,
the m × m diagonal matrix λ(yt ) with j th diagonal entry f (yt |Ct = j ), the
m × m transition probabilities matrix with ij th entry γ ij , and the m × 1
vector l = (1, . . . , 1) . Then the joint marginal density, and hence the marginal
likelihood, can be written as
L(θ) = δ  λ(y1 )

T


γ λ(yt )l.

(7.69)

t=2

Alternatively one can work with the complete-data likelihood and estimate
the parameters of the model using the EM algorithm. From equation (7.67)
ln f (Y

(T )

(T )

,C

)=

m




d1j ln δ j f (y1 |C1 = j )

j =1

+

T 
m 
m


dtkl ln(γ kl f (yt |Ct = j )).

(7.70)

t=2 k=1 l=1

This is linear in d1j and dtkl and we can proceed as in Chapter 4.8. The expected
likelihood is obtained by replacing d1j and dtkl by their expected values given
the current parameter estimated, the expected likelihood is then maximized
with respect to model parameters, and so on. The appendix to Hyppolite and
Trivedi (2012) provides considerable detail.
Yet another approach is to use Bayesian methods. Scott (2002) presents
Bayesian methods for hidden Markov models, including the Poisson.
7.9 DYNAMIC ORDERED PROBIT MODEL
In Chapter 3.6.2 we considered the possibility of using a discrete ordered
outcome model, specifically the ordered probit model, for count data. When
modeling a time series of counts in which the support of the distribution is

294

Time Series Data

restricted to a small number of values, the dynamic ordered probit model is
an attractive alternative to the preceding models. The reader is reminded that
this framework interprets discrete counts as the outcomes of an underlying
continuous latent process.
Let yt denote the observed count that takes m distinct values and let yt∗ denote
a latent variable. The two variables are related by the following observational
rule:
⎧
0 if − ∞ < yt∗ ≤ c1
⎪
⎪
⎪
⎪
⎨ 1 if c1 < yt∗ ≤ c2
(7.71)
yt =
..
..
⎪
⎪
.
.
⎪
⎪
⎩
m if cm < yt∗ < ∞.
Here there are m intervals into which the latent variable yt∗ can fall, and
the coefficients c1 , . . . , cm are the unobserved boundary points (“cutoffs”) of
these intervals. The standard specification given in Chapter 3.6.2 specifies
yt∗ = xt β + εt , ε t ∼ N[0, 1].
To capture dynamic dependence the specification of the latent variable can
be extended as follows:
yt∗ = xt β + ut + ε t ,

(7.72)

ut = ρut−1 + αyt−1 .

(7.73)

This specification can capture pure serial correlation (ρ = 0, α = 0) or state
dependence (α = 0, ρ = 0). Then given εt ∼ N[0, 1], we obtain
Pr[yt = j ] = (cj +1 − xt β − ut ) − (cj − xt β − ut ), j = 0, . . . , m.
(7.74)
The likelihood can be formed and maximized (see Chapter 3.6.2). ML estimation of this model is relatively straightforward, subject to the caveat that
ut in (7.74) is an unobserved variable and has to be recursively generated
using (7.73). Simulation-based methods have an obvious role here also. For an
empirical illustration, see Jung et al. (2006).
7.10 DISCRETE ARMA MODELS
The first serious attempt to define a time-series count model with similar
autocorrelation structure to ARMA models was by Jacobs and Lewis (1978a,
1978b, 1983). They defined the class of discrete autoregressive moving average
models (DARMA) models, for which the realized value of yt is a mixture of
past values Y(t−1) and the current realization of a latent variable εt .
The simplest example is the DARMA(1, 0) model with
yt = ut yt−1 + (1 − ut )εt ,

(7.75)

where ut is a binary mixing random variable that takes value 1 with probability
ρ and value 0 with probability 1 − ρ, and different distributional assumptions

7.11 Applications

295

can be made for the iid discrete latent random variable ε t . This model implies
Pr [yt = yt−1 ] = ρ
Pr [yt = ε t ] = 1 − ρ.

(7.76)

Clearly for this model the autocorrelation at lag k is ρ k , as in the AR(1)
model, and only positive correlation is possible. Extensions can be made to
DARMA(p, q) models with correlation structures equal to that of standard
linear ARMA(p, q) models, though with greater restrictions on the permissible
range of correlation structures.
A major restriction of the model is that for high serial correlation the data will
be characterized by a series of runs of a single value. This might be appropriate
for some data, for example on the number of firms in an industry where there
is very little entry and exit over time. But most time-series count data exhibit
more variability over time than that data. For this reason this class of models
is rarely used, and we do not consider estimation or possible extension to the
regression case. Instead INARMA models are preferred.
7.11 APPLICATIONS
We illustrate some of the preceding models, using two examples. The first
example of strike frequency is a continuation of the example introduced in section 7.3.4. The second example uses high-frequency financial transactions data
on the number of trades in a single stock in consecutive five-minute intervals.
7.11.1

Strikes Data Revisited

We begin with a variant of the autoregressive model of Zeger and Qaqish given
by (7.31)–(7.33), with up to three lags of the dependent variable appearing as
explanatory variables. A Poisson regression model is estimated with conditional
mean
E[yt |xt , yt−1 , yt−2 , . . .]
∗
∗
∗
+ ρ 2 ln yt−2
+ ρ 3 ln yt−3
), (7.77)
= exp(β 1 + β 2 xt + ρ 1 ln yt−1

where yt denotes STRIKES, xt denotes OUTPUT, and yt∗ = max(c, yt ), where
c is a value between 0 and 1 that prevents potential problems in taking the
natural logarithm when yt = 0. This model can be estimated using a standard
Poisson regression program, as explained in Section 7.5.
In the first three columns of Table 7.5, estimates for the model (7.77) are
presented with 0, 1, or 3 lags (models ZQ0, ZQ1, and ZQ3), with c set to the
value 0.5. The first column reproduces the static regression estimates given in
Table 7.2. Introducing lagged dependent variables, the biggest gain comes from
introducing just one lag. The autocorrelations of the Pearson residuals reduce
substantially. The fit of the model improves substantially, with the deviance

296

Time Series Data

Table 7.5. Strikes: Zeger-Qaqish autoregressive model estimates and
diagnostics
Model
Variable

ZQ0

ZQ1

ZQ3

ZQ1(c)

B0

ONE
OUTPUT
ln y*(-1)
ln y*(-2)
ln y*(-3)
c
y(-1)
y(-2)
y(-3)

1.654
3.134

1.060
2.330
0.396

0.846
2.187
0.267
0.163
0.114
0.5

0.896
2.345
0.482

1.655
2.993

ACF lag 1
ACF lag 2
ACF lag 3
ACF lag 4
ACF lag 5
ACF lag 6
LB
Corr2 [ŷ,y]
Observations

0.5

0.44
0.38
0.32
0.20
0.11
0.03
55.5
0.052
108

−0.10
0.13
0.16
0.08
0.03
0.00
6.7
0.278
107

0.02
0.05
0.03
0.01
−0.01
−0.06
0.8
0.330
105

B1

B3

1.017
3.480

0.597
5.107

0.469

0.319
0.198
0.127

−0.11
0.16
0.15
0.07
0.03
0.00
7.1
0.264
107

−0.01
0.05
0.02
0.00
−0.03
−0.06
1.0
0.320
105

0.553

−0.13
0.15
0.13
0.03
0.01
0.00
6.4
0.293
107

0.44
0.38
0.32
0.20
0.11
0.03
55.8
0.052
108

Note: ZQ0 is the static Poisson regression; ZQ1 and ZQ3 are the Zeger-Qaqish autoregressive
model defined in (7.77) with c=0.5; ZQ1(c) is the ZQ1 model with c estimated; B0 is the static
Poisson regression estimated by NLS; B1 and B3 are the Brannas INAR model defined in (7.78),
estimated by NLS; ACF lags 1–6, autocorrelations to lag 6 from the Pearson residuals from each
model; LB is the Ljung-Box statistic with 10 degrees of freedom; and Corr2 [ŷ ,y] is the squared
correlation between ŷ and y.

R-squared increasing from 0.053 to 0.245. Further gains occur in introducing
additional lags, but these gains are relatively small and have little impact on
the coefficient of OUTPUT. In model ZQ3 ρ̂ 3 = 1.115 has a robust t-statistic
of 1.57 and is statistically insignificant at level 0.05.
There is still overdispersion. For example, for model ZQ3 the Pearson
statistic leads to φ̂ = 1.97 for the NB1 variance function. Using heteroskedastic robust standard errors that control for this overdispersion, the coefficient
of OUTPUT is statistically significant at 5% in models ZQ0 to ZQ3, with
the t-statistic ranging from 2.15 to 2.65. Even controlling for past strike
activity, there is an independent positive effect when output rises above
trend.
The model ZQ1(c) in column 5 of Table 7.5 is the same as model ZQ1,
except that the coefficient of c is estimated rather than being set at 0.5. An
indicator variable is constructed, as detailed in section 7.5. Then ĉ = 0.55,
close to the arbitrarily chosen value of 0.5, with a 95% confidence interval
(−0.19, 1.30) that is reasonably tight given that only five observations actually

20

7.11 Applications

297

0

Strikes: actual and predicted
10
5
15

Actual strikes
Predicted strikes

0

20

40
60
80
Month: 1968(1) to 1976(12)

100

Figure 7.3. Strikes: Actual and predicted strikes from a dynamic regression
model.

equal zero. Varying c in the range 0 to 1 makes little difference to estimates of
other parameters and the residual ACF, and we use the midpoint 0.5.
The remaining columns present estimates for the Brännäs INAR model. For
the INAR(3) model the conditional mean is
E[yt |xt , yt−1 , yt−2 , . . .] = ρ 1 yt−1 + ρ 2 yt−2 + ρ 3 yt−3 + exp(β 1 + β 2 xt ).
(7.78)
Estimation is by NLS, which is not fully efficient, and the standard errors for
β̂ 2 are around 15% higher than for the ZQ models. The estimated models B0
to B3 lead to quite similar results to those for the models ZQ0 to ZQ3, in terms
of serial correlation in the residuals and fit of the model.
Neither model is straightforward to analyze for long-run impacts. In the
long run, yt = yt−1 = y. The B1 model estimates yield y = [exp(1.017 +
3.480x)]/0.531. The ZQ1 model estimates yield y = [exp(1.060 +
2.330x)].604 .
The predictions of strikes from model B1, plotted in Figure 7.3, fit the data
much better than the static regression model presented in Figure 7.2. ZQ1
model predictions are quite similar, with correlation of 0.978 between B1 and
ZQ1 predictions.
A richer version of the INAR(1) model given in (7.50) models ρ 1 as varying
over time with OUTPUT. Then
1
+ exp(β 1 + β 2 xt ).
E[yt |xt , yt−1 , yt−2 , . . .] =
1 + exp(−γ 1 − γ 2 xt )
From results not included in Table 7.5, the NLS estimate β̂ 2 becomes negative and statistically insignificant. The coefficient γ̂ 2 is borderline statistically

Time Series Data

0

.05

Density

.1

.15

Number of Trades: Glatfelter Company
20
0
5
10
15

298

0
10
20
30
40
Number of Trades: Glatfelter Company

0

20
40
60
80
Time in Five-Minute Segments

Figure 7.4. Histogram and time series of the number of trades.

significant (t = 1.65) and positive, implying that an increase in OUTPUT is
associated with an increase in ρ 1 and hence the conditional number of strikes.
The resulting estimate ρ̂ 1 ranges from 0.12 to 0.66 with an average of 0.41.
The first six autocorrelations of the Pearson residuals from this model are,
respectively, 0.00, 0.04, 0.02, 0.02 , −0.06, and −0.09; the Ljung-Box statistic
is 1.6; and Cor2 [ŷ, y] = 0.283. The model fits the autocorrelations as well as
the BQ3 and Z3 models.
The application here illustrates a simple way to estimate dynamic count
regression models. Richer models such as those in sections 7.7 and 7.8 might
then be used. They involve a considerably higher level of complexity, which
may require referring to the original sources.
7.11.2

Number of Stock Trades

This section provides a brief analysis of the number of trades in five-minute
intervals between 9:45 a.m. and 4 p.m. on the New York Stock Exchange
(NYSE) for the Glatfelter Company (NYSE ticker symbol: GLT) over 39
trading days in the first quarter of 2005 (January 3, 2005–February 18, 2005).
The data are part of a larger dataset used by Jung, Liesenfeld, and Richard
(2011).
Because there are 75 five-minute intervals in each trading day, the sample
size is T = 75 × 39 = 2,925. The number of trades ranges from 0 (3% of the
time) to 34, with a mean of 5.66. The standard deviation is 3.90, so the data
are overdispersed with a variance 2.7 times the mean. The left-hand panel of
Figure 7.4 shows the histogram of the number of trades.
The right-hand panel of Figure 7.4 shows the time series of the number of
trades on the first day of the sample. The first six autocorrelation coefficients
of the data are, respectively, 0.33, 0.27, 0.23, 0.21 , 0.19, and 0.21. The autocorrelations after 15 lags are less than 0.10, except for a value of 0.13 at lag 75,

7.11 Applications

299

which is the same segment on the preceding trading day. The first six partial
autocorrelation coefficients are, respectively, 0.33, 0.19, 0.12, 0.08 , 0.06, and
0.09 and are not as persistent. (The asthma data of Chapter 1.3.4 also show
considerable persistence in the autocorrelations.)
There are several well-established features of time-series analysis of highfrequency stock market data. The outcome variable is characterized by pronounced intraday seasonality, and usually there are no other available data on
time-varying covariates measured at the same frequency. Hence the analysis
usually concentrates on pure time-series features such as serial correlation and
volatility properties.
There are several ways to proceed. The data may be analyzed for a single
day at a time. All available data may be pooled into a long time series treated
as a single sample. Or, a multiple time series approach may be taken with
observations for different days treated as repeated samples from the same
population. We take the second of these approaches, analyzing a single time
series of 2,925 observations.
Table 7.6 presents results. The first column gives Poisson results for an
intercept-only model. The second model follows Jung et al. (2011) by including
four terms to capture the U-shaped pattern of intraday trading activity: xt =
(cos(2π t/75), sin(2π t/75), cos(4π t/75), sin(4π t/75)). These four regressors
are jointly highly statistically significant, with a χ 2 (4) statistic of 188. The
dominant term is the first, leading to a daily cycle that peaks at 7.1 shortly
after the start of day and bottoms out at 4.3 shortly after the middle of the
day. There is still considerable serial correlation in the residuals, however,
with a Ljung-Box statistic based on the first 10 lags of the Pearson residual
of 861.
The next three columns present various dynamic models that introduce a
single lag – the Zeger-Qaqish model, the Brännäs INAR(1) model, and a model
that includes as regressor the first lag of the Pearson residual from the static
model. The three models yield similar results. The lagged variables are highly
statistically significant, improve the model fit, and considerably reduce the
autocorrelation, though the Ljung-Box statistics based on the first 10 lags of
Pearson residuals are still around 200. The final column adds the first three lags
of the static model Pearson residuals, leading to still further improvement.
Another way to analyze these data is to treat them as clustered samples,
with 39 clusters that each have 75 observations. In that case panel data methods
can be applied to analyze the time series. A small advantage is that the framework could then potentially control for intra-cluster correlation. However, in
the present example where there are no covariates other than intercept and
trigonometric terms, this approach does not produce any additional worthwhile
information.
The more extensive study of Jung et al. (2011) analyzes time series for the
number of trades in four distinct stocks. A multivariate framework is used,
with dynamics introduced at the level of latent factors. It is assumed that yj t ,
the number of trades of the j th stock at time t, is conditionally independently

300

Time Series Data

Table 7.6. Stock trades: Static and dynamic model estimates
Models for number of trades in GLT stock
Variable

None

Static

ZQ1

B1

P1

1.734
(0.013)

1.719
(0.013)
0.242
(0.018)
0.021
(0.017)
−0.020
(0.018)
0.032
(0.017)

1.351
(0.030)
0.175
(0.018)
0.018
(0.017)
−0.012
(0.017)
0.027
(0.017)
0.240
(0.018)

1.387
(0.031)
0.242
(0.024)
0.014
(0.024)
−0.014
(0.024)
0.028
(0.023)
0.283
(0.022)

1.704
(0.012)
0.243
(0.017)
0.016
(0.017)
−0.019
(0.017)
0.030
(0.017)
0.105
(0.007)

1.699
(0.012)
0.246
(0.017)
0.013
(0.017)
−0.018
(0.017)
0.031
(0.017)
0.081
(0.008)
0.051
0.036

ACF lag 1
ACF lag 2
ACF lag 3
ACF lag 4
ACF lag 5
ACF lag 6
LB

0.327
0.274
0.233
0.207
0.189
0.207
1305

0.285
0.230
0.182
0.157
0.142
0.166
861

−0.013
0.131
0.102
0.088
0.070
0.108
204

−0.045
0.125
0.096
0.083
0.067
0.111
197

−0.031
0.129
0.101
0.089
0.072
0.118
218

0.009
−0.001
−0.025
0.036
0.038
0.086
53

Corr2 [ŷ,y]
Observations

0.000
2,925

0.062
2,925

ONE
X1
X2
X3
X4
lag 1
lag 2
lag 3

0.127
2,924

0.137
2,924

0.132
2,924

P3

0.152
2,922

Note: Static is static Poisson regression; ZQ1 is the Zeger-Qaqish autoregressive model with
c = 0.5; B1 is the Brannas INAR(1) model estimated by NLS; P1 and P3 are Poisson models with
one lag and first three lags of the Pearson residual from the static model as regressors; ACF lags
1–6, autocorrelations to lag 6 from the Pearson residuals from each model; LB is the Ljung-Box
statistic with 10 degrees of freedom; and Corr 2 [ŷ, y] is the squared correlation between ŷ and y.

distributed as P[μtj ], j = 1, . . . , m. The means μtj are latent variables that are
determined by
η(μt ) = μ + f t ,
where μ = (μ1t , . . . , μmt ), η(·) is an m-dimensional link function, μ denotes
an m × 1 vector of fixed intercepts,  is an (m × L) matrix of factor loadings,
and ft denotes L latent factors assumed to be orthogonal to each other. In
the context of the previous example the factors can include a common market
factor, industry factors, and stock-specific factors. Dynamics in the number
of trades may arise from the presence of serial correlation in the factors. To
complete the specification of the model a distributional assumption on ft is
added. Estimation of the model involves significant computational complications because numerical integration methods are used to handle latent factors.

7.12 Derivations

301

Jung et al. (2011), for example, assume that the latent factors follow a first-order
Gaussian autoregression and use efficient importance sampling for inference.
Monte Carlo integration, using Halton sequences, is another computationally
efficient procedure.
7.12 DERIVATIONS
7.12.1

Tests of Serial Correlation

We derive the section 7.3.2 results on serial correlation tests. Suppose zt is
distributed with mean 0and is independently distributed, though is potentially
heteroskedastic. Then Tt=1 zt zt−k has mean
 T


E
zt zt−k = 0,
t=1

since E[zt zt−k ] = 0, and variance

 T T
T


2
,
zs zs−k zt zt−k =
E zt2 zt−k
E
s=1 t=1

t=1

using E[zt zu zv zw ] = E[zt ]E[zu zv zw ] by independence for t = u, v, w, and
E[zt ] = 0. By a law of large numbers
−1/2 T
 T


d
2 2
E zt zt−k
zt zt−k → N[0, 1],
(7.79)
t=1

t=1

which yields (7.19) for tests on unstandardized residuals.
Now specialize to the special case that zt is scaled to have constant variance,
in which case E[zt2 ] is constant. Then
T
T
2
2 2
2
t=1 E zt zt−k =
t=1 E[zt ]E[zt−k
 ]

T
1 T
2
2
=T
E[z
]
t
t=1
t=1 E[zt−k ]
 

T
T
2
2
= T1
E[z
]
E[z
]
,
t
t
t=1
t=1
where the first equality uses independence, and the
 second and third equalities use constancy of E[zt2 ]. It follows that ( T1 Tt=1 zt2 )2 is consistent for
1 T
2 2
t=1 E[zt zt−k ], so
T


T
1  2
z
T t=1 t

−1

d

T


d

zt zt−k → N[0, 1].

t=1

This implies T ρ̂ k → N[0, 1], as in (7.17), or equivalently the usual result that
ρ̂ k ∼N[0, T1 ].

302

Time Series Data

If E[zt2 ] is nonconstant this simplification is not possible. One instead uses

T
1
1 T
2 2
2 2
t=1 zt zt−k as a consistent estimator of T
t=1 E[zt zt−k ], and the more
T
general (7.19).
7.13 BIBLIOGRAPHIC NOTES
An early treatment is by Cox and Lewis (1966). McKenzie (1985) is a stimulating paper that raises, in the count context, many standard time-series issues,
such as trends and seasonality, in the context of hydrological examples. Chapter 1 of MacDonald and Zucchini (1997) surveys many of the count time-series
models presented in this chapter. Autoregressive models, serially correlated
error models, and state space models for GLMs are covered in some detail in
Fahrmeier and Tutz (1994, chapter 8). Jung et al. (2006) provide a survey and
apply several different models to the asthma data introduced in Chapter 1.3.4.
Davis et al. (2000) extend the serially correlated error model of Zeger
(1988). Davis et al. (2003) and Jung et al. (2006) propose richer versions of the
autoregressive models advanced by Zeger and Qaqish (1988). The recent time
series literature has focused on INARMA models. Papers covering forecasting,
ML estimation, and nonparametric ML estimation include ones by Freeland and
McCabe (2004), Bu, McCabe, and Hadri (2008), Enciso-Mora et al. (2008a),
Drost et al. (2009a), and McCabe et al. (2011). This model has been less used
in the regression context, a notable exception being Brännäs (1995a). Recent
papers by Zhu and Joe (2006), Weiss (2008) and Enciso-Mora, Neal, and Rao
(2008b) have also considered the properties of INARMA with regressors. State
space models, both linear and nonlinear, are discussed in Harvey (1989) and
West and Harrison (1997). Estimation of models with time-varying parameters
is surveyed in Durbin and Koopman (2000); they also survey computational
methods for a class of models that includes this model; see also FrühwirthSchnatter and Wagner (2006). The hidden Markov model for count and binomial
data is presented in detail by MacDonald and Zucchini (1997). Jung et al. (2011)
propose a multivariate model in which components are Poisson distributed
conditional on latent factors that have a joint multivariate distribution.
7.14 EXERCISES


7.1 The first-order conditions for the Poisson QMLE are t g(yt , xt , β) =
0, where g(yt , xt , β) = (yt − exp(xt β))xt . Apply the general result given in
Chapter 2.8.1 to obtain (7.13) for yt heteroskedastic and autocorrelated to lag l.
7.2 Consider OLS regression of yt on scalar xt without intercept in the crosssection case. The robust
estimate of the

sandwichheteroskedastic-consistent
variance matrix of β̂ is [ t xt2 ]−1 [ t (yt − xt β̂)2 xt2 ] [ t xt2 ]−1 . Specialize this
formula if there is no relationship
6 between yt and xt (so β = 0), and obtain the
resulting formula for t = β̂/ V[β̂]. Apply this result to the case of regression
of zt on zt−k and compare the formula to (7.19).

7.14 Exercises

303

7.3 Suppose ε t in (7.40) is iid. Then yt is stationary with, say E[yt ] = μ for all t
and V[yt ] = σ 2 for all t. Using the general result E[y] = Ex [E[y|x]] use (7.43)
to obtain (7.41). Using the general result V[y] = Ex [V[y|x]] + Vx [E[y|x]] use
(7.44) to obtain (7.42).
7.4 For the Poisson INAR(1) model give the objective function for the conditional weighted LS estimator discussed after (7.52).
7.5 Show that the binomial thinning operator in section 7.6 implies (i) 0 ◦
y = 0, (ii) 1 ◦ y = y, (iii) E[α ◦ y] = αE[y], (iv) V[α ◦ y] = α 2 V[y] + α(1 −
α)E[y], and (v) for any γ ∈ [0, 1], γ ◦ α ◦ y = (γ α) ◦ y, by definition.
7.6 Given (7.22) and the assumptions on εt obtain (7.24) and (7.25).

CHAPTER 8

Multivariate Data

8.1 INTRODUCTION
In this chapter we consider regression models for an m-dimensional vector of jointly distributed and, in general, correlated random variables y =
(y1 , y2 , . . . , ym ), a subset of which are event counts. One special case of interest is that of m seemingly unrelated count regressions denoted as y|x = (y1 |x1 ,
y2 |x2 , . . . , ym |xm ), where x = (x1 , . . . , xm ) are observed exogenous covariates
and the counts are conditionally correlated. In econometric terminology this
model is a multivariate reduced-form model in which multivariate dependence
is not causal. Most of this chapter deals with such reduced-form dependence.
Causal dependence, such as y1 depending explicitly on y2 , is covered elsewhere,
most notably in Chapter 10.
Depending on the multivariate model, ignoring multivariate dependence may
or may not affect the consistency of the univariate model estimator. In either
case, joint modeling of y1 , . . . , ym leads to improved efficiency of estimation
and the ability to make inferences about the dependence structure. A joint model
can also support probability statements about the conditional distribution of a
subset of variables, say y1 , given realization of another subset, say y2 .
Multivariate nonlinear, non-Gaussian models are used much less often than
multivariate linear Gaussian models, and there is no model with the universality
of the linear Gaussian model. Fully parametric approaches based on the joint
distribution of non-Gaussian vector y, given a set of covariates x, are difficult to
apply because analytically and computationally tractable expressions for such
joint distributions are available for special cases only. Consequently, it is more
convenient to analyze models that are of interest in specific situations.
Multivariate data appear in three contexts in this book. The first is basic
cross-section data with more than one outcome variable, the main subject of this
chapter. The second is longitudinal data with repeated measures over time on the
same outcome variable, leading to time-series correlation structures detailed
in Chapter 9. The third is multivariate cross-section data with endogeneity
or feedback from one outcome to another; see Chapter 10. There are other

304

8.2 Characterizing and Generating Dependence

305

forms of multivariate data, such as multivariate time series analogs of Gaussian
vector autoregressions for several outcomes observed over time, that we do not
cover.
Illustrative empirical examples are readily found. For example, a model of
the frequency of entry and exit of firms to an industry is an example of a
bivariate count process (Mayer and Chappell, 1992). A model of health care
utilization using several measures of health care services (hospital admissions,
days spent in hospitals, use of prescribed and nonprescribed medicines) is an
example of jointly dependent counts. An example of a joint model of counts and
binary or multinomial variables is a model of the frequency of recreational trips
and discrete choice of recreational sites (Terza and Wilson, 1990; Hausman,
Leonard and McFadden, 1995). Recent examples of joint modeling of counts
are provided by Danaher (2007), who models the joint distribution of the
number of page views across web sites and Miravete (2011), who models the
number of tariff options offered by cellular firms in 305 cellular markets in
the United States.
Application of multivariate count models is increasing, although to date practical experience has been restricted to some special computationally tractable
cases. Section 8.2 discusses some general issues relevant to characterizing
dependence. Section 8.3 deals with potential sources of dependence between
counts. Section 8.4 considers parametric bivariate and multivariate models. Section 8.5 continues with the parametric approach and provides an introduction
to copula-based multivariate models, including examples of count data applications. Section 8.6 deals with moment-based estimation of multivariate count
models. Section 8.7 analyzes tests of dependence using an approach based on
orthogonal polynomial series expansions. Section 8.8 considers mixed models
with dependence between counts and other continuous or discrete variables.
An empirical example of bivariate count regression is given in section 8.9.
8.2 CHARACTERIZING AND GENERATING
DEPENDENCE
When multivariate data are available, it is natural to consider joint distributions
that are informative about the nature of dependence. For continuous outcomes
on (−∞, ∞), the multivariate normal distribution is the standard model and
enables one to analyze linear dependence between variables through the correlation matrix.
For other types of data such as counts, the dependence may not depend so
directly on the standard Pearson correlation measure, and in this section we
consider alternative measures of dependence. We focus on the bivariate case of
two random variables Y1 and Y2 with cdf’s F1 (·) and F2 (·), respectively, and joint
distribution function F (·). Definitions are given for the population version of
the dependence measure and for continuous random variables. Some adaptation
for the discrete case is discussed at the end of the section.

306

Multivariate Data

8.2.1

Desirable Properties of Dependence Measures

The random variables (Y1 , Y2 ) are said to be dependent or associated if they are
not statistically independent so that F (Y1 , Y2 ) = F1 (Y1 )F2 (Y2 ). Let δ(Y1 , Y2 )
denote a scalar measure of dependence in the bivariate case. Embrechts,
McNeil, and Straumann (2002) list four desirable properties of this measure:
1. δ(Y1 , Y2 ) = δ(Y2 , Y1 ) (symmetry)
2. −1 ≤ δ(Y1 , Y2 ) ≤ +1 (normalization)
3. δ(Y1 , Y2 ) = 1 ⇔ (Y1 , Y2 ) comonotonic; δ(Y1 , Y2 ) = −1 ⇔ (Y1 , Y2 )
countermonotonic
4. For a strictly monotonic transformation T : R → R of Y1 :

δ(Y2 , Y1 ), T increasing
δ(T (Y1 ), Y2 ) =
−δ(Y2 , Y1 ), T decreasing.
Cherubini, Luciano, and Vecchiato (2004) note that association can be measured using several alternative concepts. They examine four in particular –
linear correlation, concordance, tail dependence, and positive quadrant dependence – and we consider these in turn.
Correlation and Dependence
By far the most familiar association (dependence) concept is Pearson’s productmoment correlation coefficient between a pair of variables (Y1 , Y2 ), defined as
ρ Y1 Y2 =

Cov[Y1 , Y2 ]
,
σ Y1 σ Y2

where Cov[Y1 , Y2 ] = E[Y1 Y2 ]− E[Y1 ]E[Y2 ] and σ Y1 > 0 and σ Y2 > 0 denote,
respectively, the standard deviations of Y1 and Y2 . This measure of association
can be extended to the multivariate case m ≥ 3, for which the covariance and
correlation measures are symmetric positive definite matrices.
It is well known that (a) ρ Y1 Y2 is a measure of linear dependence, (b) ρ Y1 Y2 is
symmetric, (c) the lower and upper bounds on the inequality −1 ≤ ρ Y1 Y2 ≤ 1
measure perfect negative and positive linear dependence (a property referred
to as normalization), and (d) the measure is invariant with respect to linear
transformations of the variables. Furthermore, if the pair (Y1 , Y2 ) follows a
bivariate normal distribution, then the correlation is fully informative about
their joint dependence, and ρ Y1 Y2 = 0 implies and is implied by independence.
In this case, the dependence structure is fully determined by the correlation,
and zero correlation and independence are equivalent.
In the case of other multivariate distributions, such as the multivariate elliptical families that share some properties of the multivariate normal, the dependence structure is also fully determined by the correlation matrix; see Fang and
Zhang (1990).
In general, however, zero correlation does not imply independence. For
example, if Y1 ∼ N[0, 1] and Y2 = Y12 , then Cov[Y1 , Y2 ] = E[Y13 ] = 0 by

8.2 Characterizing and Generating Dependence

307

symmetry of the normal, but (Y1 , Y2 ) are clearly dependent. Zero correlation only requires Cov[Y1 , Y2 ] = 0, whereas zero dependence requires
Cov[φ 1 (Y1 ), φ 2 (Y2 )] = 0 for any functions φ 1 (·) and φ 2 (·). This represents
a weakness of correlation as a measure of dependence.
A second limitation of correlation is that it is not defined for some heavytailed distributions whose second moment does not exist (e.g., some members
of the stable class and Student’s t distribution with degrees of freedom equal to
2 or 1). Many financial time series display the distributional property of heavy
tails and nonexistence of higher moments; see, for example, Cont (2001). Boyer,
Gibson, and Loretan (1999) find that correlation measures are not sufficiently
informative in the presence of asymmetric dependence.
A third limitation of the correlation measure is that it is not invariant under
strictly increasing nonlinear transformations. That is, ρ[T (Y1 ), T (Y2 )] = ρ Y1 Y2
for T : R → R. Finally, attainable values of the correlation coefficient within
the interval [−1, +1] between a pair of variables depend on their respective
marginal distributions F1 (·) and F2 (·).
These limitations motivate an alternative measure of dependence, rank correlation.
Rank Correlation and Concordance
Two well-established association measures based on rank correlation are
described next.
Spearman’s rank correlation (“Spearman’s rho”) is defined as
ρ S (Y1 , Y2 ) = ρ(F1 (Y1 ), F2 (Y2 )).

(8.1)

This measure is the Pearson correlation between F1 (Y1 ) and F2 (Y2 ), which are
integral transforms of Y1 and Y2 . It is a measure of rank correlation, since a cdf
ranks the value of a random variable on the (0, 1) interval.
Kendall’s rank correlation (“Kendall’s tau”) is defined as
ρ τ (Y1 , Y2 ) = Pr[(Y1(1) − Y1(2) )(Y2(1) − Y2(2) ) > 0]
− Pr[(Y1(1) − Y1(2) )(Y2(1) − Y2(2) ) < 0],

(8.2)

where the pairs (Y1(1) , Y2(1) ) and (Y1(2) , Y2(2) ) are two independent draws of (Y1 , Y2 )
from the joint cdf F (·). The two pairs are concordant if the ranks of each
component are in accord, so that both Y1(1) > Y1(2) and Y2(1) > Y2(2) or both
Y1(1) < Y1(2) and Y2(1) < Y2(2) . The first term on the right, Pr[(Y1(1) − Y1(2) )(Y2(1) −
Y2(2) ) > 0], is therefore Pr[concordance], whereas the second is Pr[discordance].
Hence
ρ τ (Y1 , Y2 ) = Pr[concordance] − Pr[discordance]

(8.3)

is a measure of the relative difference between the two.
Both ρ S (Y1 , Y2 ) and ρ τ (Y1 , Y2 ) are measures of monotonic dependence
between (Y1 , Y2 ). Both measures are based on the concept of concordance,

308

Multivariate Data

more loosely defined as large values of one random variable in the pair being
associated with large values of the other.
Embrechts et al. (2002; theorem 3) show that both ρ S (Y1 , Y2 ) and ρ τ (Y1 , Y2 )
have the properties of symmetry, normalization, and co- and countermonotonicity, and both assume the value zero under independence. Although the
rank correlation measures have the property of invariance under monotonic
transformations and can capture perfect dependence, they are not simple functions of moments and hence computation is more involved.
Tail Dependence
In some cases the concordance between extreme (tail) values of random variables is of interest. For example, one may be interested in the probability that
stock indexes in two countries exceed (or fall below) given levels. This requires
a dependence measure for upper and lower tails of the distribution. Such a
dependence measure is essentially related to the conditional probability that
one index exceeds some value given that another exceeds some value.
Specifically, lower tail dependence of Y1 and Y2 is defined as the limit of the
probability that Y1 is less than its v th quantile given that Y2 is less than its v th
quantile, as v goes to 0. Now
Pr[Y1 < F1−1 (v)|Y2 < F2−1 (v)] = Pr[Y1 < F1−1 (v), Y2 < F2−1 (v)]/v
= Pr[F1 (Y1 ) < v, F2 (Y2 ) < v]/v
(8.4)
= Pr[U1 < v, U2 < v]/v
= C(v, v)/v,
where U1 = F1 (Y1 ) and U2 = F2 (Y2 ) are standard uniform random variables,
and C(u1 , u2 ) = Pr[U1 < u1 , U2 < u2 ] is the copula function, detailed in section 8.5, associated with F (y1 , y2 ). This leads to the following measure of lower
tail dependence:
C(v, v)
.
(8.5)
v→0
v
Because this measure is a function of the copula it is invariant under strictly
increasing transformations.
Upper tail dependence of Y1 and Y2 is defined as the limit of the probability
that Y1 exceeds its v th quantile given that Y2 exceeds its v th quantile – that is,
Pr[Y1 > F1−1 (v)|Y2 > F2−1 (v)] – as v goes to 1. A similar argument to that in
(8.4) yields for upper tail dependence
λL = lim+

S(v, v)
,
(8.6)
v→1 1 − v
where S(u1 , u2 ) denotes the joint survival function for standard uniform random
variables U1 and U2 . The measure λU is widely used in actuarial applications
of extreme value theory to handle the probability that one event is extreme
conditional on another extreme event.
λU = lim−

8.2 Characterizing and Generating Dependence

309

For joint distributions with simple analytical expressions, the computation of
λU can be straightforward, being a simple function of the dependence parameter; see section 8.5.2 for examples. The bivariate Gaussian copula has the
property of asymptotic independence. According to Embrechts et al. (2002),
this means that “regardless of how high a correlation we choose, if we go far
enough into the tail, extreme events appear to occur independently in each
margin.” This is a great limitation, most notably in financial applications.
Positive Quadrant Dependence
Another measure of dependence is positive quadrant dependence (PQD). Two
random variables Y1 , Y2 are said to exhibit PQD if their copula is greater than
their product (i.e., C(u1 , u2 ) > u1 u2 ).
In terms of the associated cdf’s of Y1 and Y2 , PQD implies F (y1 , y2 ) ≥
F1 (y1 )F2 (y2 ) for all (y1 , y2 ) in R2 . Positive quadrant dependence implies nonnegative Pearson correlation and nonnegative rank correlation. But all these
properties are implied by comonotonicity, which is the strongest type of positive dependence. Decreasing left-tail dependence and decreasing right-tail
dependence imply PQD (Nelsen, 2006).
8.2.2

Dependence Measures for Discrete Data

Dependence measures for continuous data do not, in general, apply directly to
discrete data. Concordance measures for bivariate discrete data are subject to
constraints (Marshall, 1996; Denuit and Lambert, 2005).
Reconsider Kendall’s tau defined in (8.2) in the context of discrete variables.
Unlike the case of continuous random variables, the discrete case has to allow
for ties (i.e., Pr[tie] = Pr[Y1(1) = Y1(2) or Y2(1) = Y2(2) ]). Some attractive properties
of ρ τ for continuous variables are consequently lost in the discrete case. Several
modified versions of ρ τ and other dependence measures exist that handle the ties
in different ways; see Denuit and Lambert (2005) for discussion and additional
references. When (Y1 , Y2 ) are nonnegative integers
Pr[concordance] + Pr[discordance] + Pr[tie] = 1.
Hence (8.3) becomes (Denuit and Lambert, 2005, p. 43)
ρ τ (Y1 , Y2 ) = 2 Pr[concordance] − 1 + Pr[tie],
= 4 Pr[Y1(1) < Y1(2) , Y2(1) < Y2(2) ] − 1
+ Pr[Y1(1) = Y1(2) or Y2(1) = Y2(2) ].

(8.7)

This analysis shows that in the discrete case ρ τ (Y1 , Y2 ) is related to marginal
distributions through the last term in (8.7), whereas in the continuous case it is
determined only by the joint distribution – a result of the absence of ties in the
continuous case. Furthermore it is reduced in magnitude by the presence of ties.
When the number of distinct realized values of (X, Y ) is small, there is likely

310

Multivariate Data

to be a higher proportion of ties, and the attainable value of ρ τ (Y1 , Y2 ) will
be smaller. Denuit and Lambert (2005) obtain an upper bound and show, for
example, that in the bivariate case with identical P[μ] marginal distributions,
the upper bound for ρ τ (Y1 , Y2 ) increases monotonically with μ.
In econometric modeling it is common to include regressors. To accommodate this case, we should substitute F (y|x) in place of F (y). Loosely speaking
we replace the original data on outcomes by residual-like quantities. Even if
the original outcomes are discrete these residual-like variables generally are
not. Potentially this change mitigates to some extent the loss of point identification of the dependence parameter and makes it easier to transfer the insights
obtained from the analysis of continuous data.
8.3 SOURCES OF DEPENDENCE
Multivariate count models for cross-section data are essentially nonlinear multiequation models whose statistical specification has motivation similar to that
for the seemingly unrelated regression (SUR) linear model. Before going into
specific and detailed model specification, we review some general considerations and mechanisms for generating dependence across equations.
One method models the j th component yj , j = 1, . . . , m, as generated
by the sum of random variables uj + w, where uj has a standard distribution such as the Poisson and integrates out the common component w to
obtain the joint distribution of y1 , . . . , ym . This method is used infrequently
because it rarely leads to tractable models, and even when it does these models
are very restrictive. A leading example is the bivariate Poisson presented in
section 8.4.1.
Instead dependence is often modeled as arising due to exposure to one
or more common shocks that act as unobserved regressors. The single common shock model postulates marginal distributions such as Fj (yj |xj , ν),
j = 1, . . . , m, where ν denotes the common stochastic shock (assumed independent of xj ) and one integrates out v to obtain F (y|x). The common shock ν
is the unique source of dependence between outcomes and additionally imparts
overdispersion in each marginal model. An example is the bivariate negative
binomial presented in section 8.4.2. This single-factor model is restrictive,
however, because the shock is simultaneously inducing overdispersion in the
marginals and inducing dependence across marginals.
A more flexible model introduces multiple correlated shocks, so that overdispersion and dependence are modeled through different parameters. Suppose
the marginal distributions are written as Fj (yj |xj , ν 1 , . . . , ν m ), where ν j ,
j = 1, . . . , m, denotes the set of m jointly distributed stochastic factors independent of xj . We refer to this as an m-factor model. These common shocks
can be introduced as random intercepts; see section 8.4.3. Usually no tractable
solution exists, but estimation is feasible using simulated ML or by reverting to
a finite mixtures model.

8.4 Multivariate Count Models

311

Yet another approach specifies the marginal distributions Fj (yj |xj ) to be a
flexible model such as the negative binomial and then introduces dependence
across the marginals using a copula function. This approach, detailed in section
8.5, leads to a tractable form for the joint distribution F (y|x), so is estimable
using standard ML techniques.
A final approach, detailed in section 8.6, specifies a model for the conditional
means E[yj |xj ] and the conditional variances and covariances Cov[yj , yk |x].
Estimation is by feasible generalized least squares. This method is less parametric than the others because it is does not lead to specification of the joint
distribution F (y|x).
8.4 MULTIVARIATE COUNT MODELS
In the class of multivariate count models, the bivariate special case has attracted
particular attention. Excellent summaries of results for bivariate count models
are given in Kocherlakota and Kocherlakota (1993, pp. 87–158) and Johnson,
Kotz, and Balakrishnan (1997, pp. 124–152). Bivariate models discussed there
have closed-form joint distributions only in particular cases that are subject to
some restrictions.
Poisson mixed models can be derived as a special case of the generalized
linear mixed models. Diggle et al. (2002) consider a variety of generalized
linear models for discrete response variables and discuss alternative methods
to maximum likelihood estimation.
8.4.1

Bivariate Poisson

Unlike the case of the normal distribution, there is no unique multivariate
Poisson. There are several ways in which a model with Poisson marginals can
be derived. Often any distribution that leads to Poisson marginals is referred to
as a multivariate Poisson.
A well-established technique for deriving multivariate (especially bivariate)
count distributions is the method of mixtures and convolutions. The oldest
and the most studied special case leads to a model widely called the bivariate
Poisson model, notwithstanding the preceding comment that there is more than
one bivariate Poisson model. This model is generated by sums of independent
random counts with common components in the sums. It is also called the
trivariate reduction technique (Kocherlakota and Kocherlakota, 1993).
Suppose count variables y1 and y2 are defined as
y1 = u + w
y2 = v + w,

(8.8)

where u, v, and w are independently distributed as Poisson variables with
parameters μ1 , μ2 , and μ3 , respectively, for μj > 0, j = 1, 2, 3. Then the joint
frequency distribution for the bivariate Poisson, derived in section 8.10, is

312

Multivariate Data

given by
f (y1 = r, y2 = s) = exp(μ1 + μ2 + μ3 )

min(r,s)

l=0

s−l l
μr−l
1 μ2 μ3
.
(r − l)!(s − l)!l!

(8.9)
The corresponding marginals are Poisson, with mean (μ1 + μ3 ) for y1 and
mean (μ1 + μ3 ) for y2 . Note that this model has the limitation of not allowing
for overdispersion.
The squared Pearson correlation between y1 and y2 is given by
ρ2 =

μ23
(μ1 + μ3 )(μ2 + μ3 )

(8.10)

(see Johnson and Kotz, 1969). Allowing for heterogeneity by allowing the
parameters to vary across individuals implies that the correlation between events
also varies across individuals. However, the maximum correlation between y1
and y2 is given by μ3 / μ3 + min(μ1 , μ2 ) . Gourieroux et al. (1984b) present
a different derivation of the bivariate Poisson.
The use of the trivariate reduction technique leads to the following properties:
1. In general, in multivariate nonnormal distributions the correlation does
not fully describe the dependence structure of variables. However, in
this special case the correlation coefficient fully characterizes dependence, and no additional measures of dependence are needed.
2. The marginal distributions for y1 and y2 are both Poisson. Hence,
with a correctly specified conditional mean function the marginal
models can be estimated consistently, but not efficiently, by maximum
likelihood. Joint estimation is more efficient even if the two mean
functions depend on the same covariates.
3. This model only permits positive correlation between counts.
The log-likelihood for the model (8.9) with observations independent over
i is
n
n


 
μ1i + μ2i +
ln Si , (8.11)
L(β, μ3 , γ |y1 , y2 , x) = nμ3 −
i=1

i=1

where


min(y1i ,y2i )

Si =

l=0

y −l

y −l

μ11i μ22i μl3
.
(y1i − l)!(y2i − l)!l!

(8.12)

At this stage there are two ways to proceed. One approach parameterizes the sum
μ1i + μ2i as an (exponential) function of xi . A second approach parameterizes
μ1i and μ2i individually in terms of the same or different covariates. The two
approaches imply different specifications of the conditional means.

8.4 Multivariate Count Models

313

Taking the second approach, assume that μ3i = μ3 , μ1i = exp(xi β), and
μ2i = exp(xi γ ). This leads to the log-likelihood
L(β, μ3 , γ ) = nμ3 −

n



n
 
exp(xi β) + exp(xi γ ) +
ln Si , (8.13)

i=1

i=1

where Si is defined in (8.12).
King (1989a) calls this a model of seemingly unrelated Poisson regression
by analogy with the well-known seemingly unrelated least squares model.
Jung and Winkelmann (1993), in their application of the bivariate Poisson
to the number of voluntary and involuntary job changes, assume a constant
covariance and exponential mean parameterization for the marginal means so
that μj + μ3 = exp(xj β j ), j = 1, 2. This allows the two means to depend on
separate or common sets of covariates.
The bivariate Poisson is a special case of the generalized exponential family
(Jupp and Mardia, 1980; Kocherlakota and Kocherlakota, 1993):

g(y1 , y2; μ1 , μ2 , ρ) = exp μ1 v(y1 ) + v(y1 ) ρw(y2 ) + μ2 w(y2 )
− c(μ1 , μ2 , ρ) + d1 (y1 ) + d2 (y2 )}

(8.14)

where v(·), w(·), d1 (·), and d2 (·) are functions, and c(μ1 , μ2 , 0) = c1 (μ1 )c2 (μ2 ).
Under independence ρ = 0, in which case the right-hand side is a product of
two exponential families. In this family ρ = 0 is a necessary and sufficient
condition for independence. The correlation coefficient is increasing in μ3 and
decreasing steeply in both μ1 and μ2 .
8.4.2

Bivariate Negative Binomial

The bivariate Poisson can be generalized and extended to allow for unobserved
heterogeneity and overdispersion in the respective marginal distributions, using
mixtures and convolutions as in the univariate case presented in chapter 4.2.
Marshall and Olkin (1988, 1990) provide a quite general treatment of the
multivariate case. Consider the bivariate distribution,
 ∞
f1 (y1 |x1 , ν)f2 (y2 |x2 , ν)g(ν)dν,
(8.15)
f (y1 , y2 |x1 , x2 ) =
0

where f1 , f2 , and g are univariate densities and ν may be interpreted as common unobserved heterogeneity affecting both counts. Multivariate distributions
generated in this way have univariate marginals in the same family (Kocherlakota and Kocherlakota, 1993). Thus, a bivariate negative binomial mixture
generated in this way will have univariate negative binomial mixtures. This
approach suggests a way of specifying or justifying overdispersed and correlated count models, based on a suitable choice of g(.), which is more general
than in the example given earlier.
Marshall and Olkin (1990) generate a bivariate negative binomial distribution beginning with f (y1 ) and f (y2 ), which are Poisson with parameters μ1 ν

314

Multivariate Data

and μ2 ν, respectively, while ν has a gamma distribution with shape parameter
α −1 and scale parameter 1. Then
 
  −1

y
y
∞  
μ2 ν 2 e−μ2 ν
μ1 ν 1 e−μ1 ν
ν α −1 e−ν
−1
dν
h(y1 , y2 |α ) =
y1 !
y2 !
(α −1 )
0

=

μ1
(y1 + y2 + α −1 )
y1 !y2 !(α −1 )
μ1 + μ2 + 1
α−1
1
×
.
μ1 + μ2 + 1

y1

μ2
μ1 + μ2 + 1

y2

(8.16)

This mixture has a closed-form solution, a special result that arises because
the model restricts the unobserved heterogeneity to be identical for both count
variables. The marginal distributions are univariate negative binomial, with
means α −1 μj and variances μj + α −1 μ2j , j = 1, 2. The rescaling of the mean,
absorbed in the intercept in regression with exponential conditional mean,
occurs because the parameterization of the exponential in (8.16) differs from
that in Chapter 4.2.2 and implies E[v] = V[v] = α −1 . The unconditional correlation between the two count variables,
μ1 μ 2
,
(8.17)
Cor[y1, y2 ] = !
(μ21 + αμ1 )(μ22 + αμ2 )
is restricted to be positive.
An alternative derivation of the model (8.16), based on specifying a probability generating function that is a natural extension of that for the negative
binomial, is given in Johnson et al. (1997). The model (8.16) extends easily to
the multivariate case and is referred to either as a multivariate negative binomial
or a negative multinomial model. Nguyen, Gupta, Nguyen, and Wang (2007)
provide further details on the negative multinomial.
Miles (2001) provides an application to individual consumer data on the
number of purchases of bread and cookies in a one-week period, parameterizing μ1 = exp(x1 β) and μ2 = exp(x2 β 2 ) and estimating by ML. Miles also
estimates a trivariate negative binomial model for wheat bread, other breads,
and cookies. A result of Lindeboom and van den Berg (1994) for bivariate survival models indicates that it is hazardous to estimate bivariate models in which
mutual dependence between survival times arises purely from unobserved heterogeneity characterized as a univariate random variable. Miles (2001) finds
that this is also the case for his count application, so it is desirable to have more
flexible models of the correlation structure between counts.
8.4.3

More Flexible Bivariate Count Models

One convenient way to generate flexible dependence structures between counts
is to begin by specifying latent factor models. Munkin and Trivedi (1999)

8.4 Multivariate Count Models

315

propose a more flexible dependence structure using a correlated unobserved heterogeneity model. Suppose y1 and y2 are, respectively, P[μ1 |ν 1 ] and P[μ2 |ν 2 ]
with means
E[yj |xj , ν j ] = μj = exp(xj β j + λj ν j ), j = 1, 2,

(8.18)

where ν 1 and ν 2 represent correlated latent factors or unobserved heterogeneity,
λ1 and λ2 are factor loadings, and xj includes an intercept so ν j has mean
zero. Dependence is induced if ν 1 and ν 2 are correlated with joint distribution
g(ν 1 , ν 2 ). Integrating out (ν 1 , ν 2 ), we obtain the joint distribution for y1 and y2 :
 
f1 (y1 |x1 , ν 1 )f2 (y2 |x2 , ν 2 )g(ν 1 , ν 2 )dν 1 dν 2 .
f (y1 , y2 |x1 , x2 ) =
(8.19)
Unlike the preceding examples, there is no choice of g(·) that leads to a
closed-form solution. Instead (8.19) can be replaced by the simulation-based
numerical approximation
S
1
(s)
fˆ (y1 , y2 |x1 , x2 ) =
f1 (y1 |x1 , ν (s)
1 )f2 (y2 |x2 , ν 2 ),
S s=1

(8.20)

(s)
where ν (s)
1 and ν 2 are draws from the specified distributions of unobserved
heterogeneity. The simulated ML method estimates the unknown parameters
using the log-likelihood based on such an approximation.
Munkin and Trivedi (1999) specify (ν 1 , ν 2 ) to be bivariate normal distributed
with zero means, variances σ 21 and σ 22 , and correlation ρ, −1 ≤ ρ ≤ 1. They
normalize λ1 = 1 and λ2 = 1 to ensure identification. It is more convenient to
sample ν 1 and ν 2 from the standard normal, using



σ1 0 6
ν1
ε1
=
,
ν2
ε2
σ 2ρ σ 2 1 − ρ2

where ε1 and ε 2 are iid standard normal. Then the SMLE maximizes with
respect to (β 1 , β 2 , σ 1 , σ 2 , ρ)
n



log

i=1

S


6
1
s
2 (s)
f1 y1i |x1i , σ 1 ε(s)
,
1i f2 y2i |x2i , σ 2 ρε 1i + σ 2 1 − ρ ε 2i
S s=1

(8.21)
where ε(s)
1i

and ε (s)
2i

are draws from the standard normal and, for example, f1 (·) is
the Poisson density with mean exp(x1i β 1 + σ 1 ε 1i ). The SML objective function
converges to the log-likelihood likelihood function as S → ∞, and the SMLE
is consistent and asymptotically
equivalent to the MLE estimator when S, n →
√
∞ and n/S → 0 or n/S → 0. The covariance matrix can be consistently
estimated by the robust sandwich estimator. The model accommodates both
overdispersion, through σ 1 and σ 2 , and correlation, through ρ.

316

Multivariate Data

Munkin and Trivedi (1999) show that although SML estimation is feasible, it
may not be computationally straightforward for all specified joint distributions
of latent factors. They note that in their parameterization,

6
E[y2i |x2i , ε 1i , ε 2i ] = exp x2i β 2 + σ 2 ρε 1i + σ 2 1 − ρ 2 ε2i ,
so the derivative
 −σ ρε
6
∂E[y2i |x2i , ε 1i , ε 2i ]
2
2i
,
= exp x2i β 2 + σ 2 ρε 1i + σ 2 1 − ρ 2 ε2i 6
∂ρ
1 − ρ2
which is not bounded at ρ = 1. It follows that the derivative of the sum in
equation (8.21) with respect to ρ is unbounded at ρ = 1, since the derivative
is the product of two functions, one of which is bounded at ρ = 1 and the
other is ∂E[y2i |x2i , ε 1i , ε 2i ]/∂ρ, which is unbounded at ρ = 1. Similarly, the
second derivative of the sum with respect to ρ is also unbounded. Therefore,
for values of ρ in a neighborhood of 1, maximization of the SML objective is
not feasible using standard gradient methods. See Munkin and Trivedi (1999)
for a discussion of methods for handling this problem.
Several alternatives to SMLE have emerged that may offer computational
convenience while still allowing for some flexibility in modeling the dependence structure. Alfo and Trovato (2004) propose finite mixture distributions
for ν 1 and ν 2 in (8.18) and additionally allow for random slope parameters
and the random intercepts captured by ν 1 and ν 2 . However, these authors place
additional structure on the correlation matrix of the random components of the
slope coefficients, which generates patterns in the dependence structure. Chib
and Winkelmann (2001) use Bayesian Monte Carlo Markov Chain methods;
see Chapter 12.5.4. And copulas can be used to generate a joint distribution
whose parameters can be estimated without simulation; see section 8.5.
8.4.4

Bivariate Hurdle

For univariate counts the hurdle model, presented in Chapter 4.5, is the most
common departure from the Poisson or related models such as negative binomial
or Poisson-lognormal. When we observe multivariate count outcomes in which
there is substantial probability mass at zero frequency, there is motivation for
a multivariate version of the hurdle model. The closely related zero-inflated
Poisson (ZIP) model of Chapter 4.6 is also a candidate for a similar extension.
Hellstrom (2006) provides an empirical application of a bivariate hurdle
model in which the outcome variables are the number of trips taken and the
number of overnight stays. Li, Lu, Park, Kim, Brinkley, and Peterson (1999)
present a multivariate ZIP model for several types of defects in items produced
by an industrial process. In section 8.5.7 we present a bivariate hurdle model
based on copulas.

8.5 Copula-Based Models

8.4.5

317

Sarmanov Models

A general way to produce a bivariate distribution from given marginals was
proposed by Sarmanov (1966). Given marginal densities f1 (y1 ) and f2 (y2 ), the
joint density is specified as
f12 (y1 , y2 ) = f1 (y1 )f2 (y2 ) × [1 + ωφ 1 (y1 )φ 2 (y2 )],
(8.22)
+
where
 φ j (yj ), j = 1, 2, are mixing functions that satisfy φ j (t)fj (t)dt = 0,
or xk φ j (xk )fj (xk ) = 0 in the discrete case, so that the joint probabilities
integrate or sum to one. To ensure that f12 (y1 , y2 ) ≥ 0 the mixing functions are
determined in part by the marginals. M-L.T. Lee (1996) shows that for marginal
distributions for nonnegative counts
φ j (yj ) = e−yj − E[e−yj ] = e−yj −

∞


e−yj φ j (yj ).

(8.23)

yj =0

When ω = 0 the random variables y1 and y2 are independent,
Danaher (2007) specifies negative binomial marginals and applies a (truncated) multivariate extension of this model to individual-level data on the
number of page views across a number of websites. He estimates models without regressors by a two-step method – separate estimation of the parameters
of each density fj (yj ) is followed by estimation of the remaining parameters
(just ω in the bivariate case). He considers a model without regressors. Famoye
(2010) estimates this model by ML with application to joint modeling of doctor consultations and nondoctor consultations using data from Cameron et al.
(1988).
Miravete (2011) specifies double Poisson marginals, better suited to his
data on the number of tariff options (a measure of firm responsiveness to
customer tastes) offered by cellular firms in 305 cellular markets in the United
States. He estimates by ML a bivariate regression model for the incumbent
(y1 ) and entrant (y2 ) firms. The coefficient ω is constrained to lie in bounds
determined by the parameters and regressors of f1 (y1 ) and f2 (y2 ). If the bounds
are reached statistical inference becomes nonstandard, and Miravete (2011)
uses a subsampling bootstrap.
8.5 COPULA-BASED MODELS
For notational simplicity, in what follows we suppress the presence of covariates
in the model. Thus, when we write the cdf F1 (y1 ), the reader may interpret this
to mean the conditional cdf F1 (y1 |x1 ). For simplicity we focus on the bivariate
case.
For nonnormal multivariate data, joint distributions are often not readily
available and harder to derive. This applies both to discrete and mixed discrete/continuous multivariate data. In contrast, marginal distributions for the
component variables may be easier to specify. The copula approach allows one
to combine given marginal distributions, using a specified functional form, to

318

Multivariate Data

yield a joint distribution with dependence parameter(s) and a tractable functional form.
The generation of a parametric joint distribution by combining fixed
marginals is based on Sklar’s theorem (Sklar, 1973). A variety of joint distributions can be generated by specifying different functional forms for the
copula. These functional forms may, however, impose restrictions on the form
of dependence. Therefore care must be taken to specify a sufficiently flexible
copula. Furthermore, the choice of marginal distributions also requires care
because they too are in no sense known and, if poorly chosen, may not provide
a good fit to the data.
8.5.1

Specification

Copula-based joint estimation is based on Sklar’s theorem, which provides a
method of generating joint distributions by combining marginal distributions
using a copula.
An m-dimensional copula or linking function C(·) is any m-dimensional
cumulative distribution function with all m univariate margins being standard
uniform, so
C(u1 , . . . , um |θ) = Pr[U1 ≤ u1 , . . . , Um ≤ um ],

(8.24)

where Uj are iid U[0, 1] and θ is a dependence parameter. Now if Yj has
continuous cdf Fj (·), the integral transform Fj (Yj ) is uniformly distributed.
It follows that for a continuous m-variate distribution function F (y1 , . . . , ym )
with univariate marginal distributions F1 (y1 ), . . . , Fm (ym ), the joint cdf
F (y1 , . . . , ym ) = Pr[Y1 ≤ y1 , . . . , Ym ≤ ym ]
= Pr[F1 (Y1 ) ≤ F1 (y1 ), . . . , Fm (Ym ) ≤ Fm (ym )]
(8.25)
= Pr[U1 < F1 (y1 ), . . . , Um ≤ Fm (ym )]
= C(F1 (y1 ), . . . , Fm (ym )|θ)
where, by Sklar’s theorem, C(·) is the unique copula function associated with
the cdf F (·). An alternative way to express (8.25) is
F (y1 , . . . , ym ) = F (F1−1 (u1 ), . . . , Fm−1 (u1 ))

(8.26)

= C(u1 , . . . , um |θ),
as Fj (Yj ) = Uj so Yj = Fj−1 (Uj ). Zero dependence implies that the joint distribution is the product of marginals. Sklar’s theorem is extended by Patton
(2006) to the case of conditional copulas that are relevant in the regression
context.
The term “discrete copula” refers to a discrete multivariate distribution,
usually with discrete marginals. The cdf in the discrete case is a step function
with jumps at integer values, so the inverse Fj−1 (·) is not uniquely determined
without imposing a convention. Usually the minimum of the interval is chosen.

8.5 Copula-Based Models

319

Table 8.1. Copulas: Five leading examples
Copula
type
Clayton

Function C(u1 , u2 ))
−θ
−1/θ
(u−θ
1 + u2 −1)

Survival ((1 − u1 )−θ + (1 − u2 )−θ −1)−1/θ
Clayton


1
ln 1 + eθ u1 −1 eθ u2 −1 /eθ −1
Frank
θ

θ −domain

Kendall’s τ

θ ∈ (0, ∞)

θ
θ+2

θ ∈ (0, ∞)

θ
θ+2

θ ∈ (−∞ , ∞) 1 + θ4

−1 < θ < +1
Gaussian G (−1 (u1 )−1 (u2 )|θ)


1/θ
θ ∈ [1 , ∞)
Gumbel exp −[(− ln u1 )θ + (− ln u2 )θ ]

)+
θ

t
dt
0 θ (et −1)

*
−1

2
arcsin(θ)
π

(θ − 1)/θ

Note: G [y 1 , y2 |θ] denotes the standardized bivariate normal cdf with correlation θ, and (·)
denotes the standard normal cdf.

Sklar’s theorem implies that copulas provide a “recipe” to derive joint distributions when only marginal distributions are specified. The approach is attractive because copulas (1) provide a fairly general approach to joint modeling of
count data; (2) neatly separate the inference about marginal distribution from
the inference on dependence; (3) represent a method for deriving joint distributions given fixed marginals such as Poisson and negative binomial; (4) in the
bivariate case can be used to define nonparametric measures of dependence,
which can capture asymmetric (tail) dependence, as well as correlation or linear
association; and (5) are easier to estimate than multivariate latent factor models
with unobserved heterogeneity. However, copulas and latent factor models are
closely related; see Trivedi and Zimmer (2007) and Zimmer and Trivedi (2006).
8.5.2

Functional Forms of Copulas

Sklar’s theorem states that there is a unique copula, but this is unknown a priori,
just as in practice the cdfs for the marginal distributions are unknown. The
literature offers a vast array of copula functional forms from which to choose
(Nelsen, 2006; Joe, 1997). In practice one can experiment with a variety of
copulas or choose one that is relatively unrestricted.
For concreteness Table 8.1 presents five functional forms for the copula:
Clayton, Survival Clayton, Gaussian, Frank, and Gumbel copulas. Closed-form
expressions exist for all the copulas, except for the Gaussian copula,


G −1 (u1 ), −1 (u2 )|θ


 −1 (u1 )  −1 (u2 )
−(s 2 − 2θ st + t 2
1
dsdt.
=
2π (1 − θ 2 )1/2
2(1 − θ 2 )
−∞
−∞
The Gaussian and Frank copulas permit both positive and negative dependence. Any observed dependence is symmetric, with no tail dependence allowed

320

Multivariate Data
Sample from Gumbel Copula

5
0

0

5

10

10

y1

y1

15

15

20

20

Sample from Clayton Copula

0

5

10

15

20

25

0

5

y2

10

15

20

25

y2

Figure 8.1. Samples from Clayton and Gumbel copulas with Poisson
marginals.

in the Gaussian case and limited tail dependence in the Frank copula. By contrast, the Clayton, Survival Clayton, and Frank copulas allow for asymmetric
tail dependence, but none of them allows for negative dependence. Clayton
exhibits lower tail dependence, whereas Survival Clayton and Gumbel show
upper tail dependence. By changing the functional form of the copula, many
different dependence patterns between marginal distributions can be explored.
Properties of these well-established functional forms are discussed in the literature (Cherubini, Luciano, and Vecchiato, 2004; Trivedi and Zimmer, 2007).
Figure 8.1 illustrates lower and upper tail dependence using samples generated using Monte Carlo draws from the Clayton and Gumbel copulas, where Y1
and Y2 are P[10] distributed and for both copulas θ = 2 and hence Kendall’s τ
equals 0.5. The samples have different tail dependence properties. The Clayton
copula diagram shows clustering of observations at low values, whereas observations are more dispersed at high values; the opposite description applies for
the draws from the Gumbel copula. Upper tail dependence has been reported
especially in returns on financial assets.
8.5.3

Interpretation of the Dependence Parameter

The dependence parameter θ can be difficult to interpret directly because it is
generally not a Pearson correlation parameter that lies in the interval (−1, 1).
A common approach converts θ to a measure of concordance such as Kendall’s
tau, defined in (8.2). Converting θ to τ is straightforward for many copulas.
The last column in Table 8.1 gives the conversion formula for the five copulas
considered here, and Trivedi and Zimmer (2007) provide additional examples.
When θ is the parameter of intrinsic interest, an alternative estimation approach
first estimates τ and then converts back to θ (Genest and Neslehova, 2008).

8.5 Copula-Based Models

8.5.4

321

Estimation

Copula modeling begins with specification of the marginal distributions and a
copula. There are many possible choices of copula functional forms; see Nelsen
(2006) for an especially extensive list. The resultant model can be estimated
by a variety of methods, most notably joint ML of all parameters and two-step
estimation. We provide a brief summary, with further details given in Trivedi
and Zimmer (2007).
Equation (8.25) provides a fairly general approach to modeling complex
joint distributions. By plugging the specified marginal distributions (F1 , F2 )
into a copula function C, the right-hand side of equation (8.25) provides a
parametric representation of the unknown joint cdf.
Estimation is then based on the pdf version of the copula. In the continuous
outcomes case the pdf is f (y1 , y2 ) = ∂F (y1 , y2 )/∂y1 ∂y2 . Using (8.25) and
(8.26) yields
f (y1 , y2 ) ≡ c12 (F1 (y1 ), F2 (y2 )|θ)
∂C(F1 (y1 ), F2 (y2 )|θ)
∂y1 ∂y2
(8.27)
∂C(u1 , u2 |θ) ∂u1 ∂u2
=
×
∂u1 ∂u2
∂y1 ∂y2

∂C(u1 , u2 |θ) 
=
× f1 (y1 )f2 (y2 ) ,
∂u1 ∂u2 u1 =F1 (y1 ),u2 =F2 (y2 )

=

where f1 (y1 ) and f2 (y2 ) are the marginal densities corresponding to the cdfs
F1 (y1 ) and F2 (y2 ), and we use u1 = F1 (y1 ) so ∂u1 /∂y1 = ∂F1 (y1 )/∂y1 = f1 (y)
and similarly for f2 (y2 ).
In discrete settings, the analogous quantity is obtained by taking a finite
difference. In the count data case where y1 and y2 take integer values,
f (y1 , y2 ) ≡ c12 (F1 (y1 ), F2 (y2 )|θ)
= C(F1 (y1 ), F2 (y2 )|θ) − C(F1 (y1 − 1), F2 (y2 )|θ)
(8.28)
−C(F1 (y1 ), F2 (y2 − 1)|θ) + C(F1 (y1 − 1), F2 (y2 − 1)|θ ).
Taking the natural logarithm of (8.27) or (8.28) and summing over all observations give the log-likelihood function. Joint estimation means that the parameters of the marginals, suppressed above for notational simplicity, and the copula
function are jointly estimated. Two-step or stepwise or sequential estimation
means that first the parameters of F1 (y1 ) and F2 (y2 ) are estimated, and then θ
is estimated by maximizing the log-likelihood based on C(F̂1 (y1 ), F̂2 (y2 )|θ).
Both steps may be parametrically executed, but the second step may also be
nonparametric.
When joint estimation is used, one can choose the copula function that leads
to the largest log-likelihood value in the fitted model. For comparison across

322

Multivariate Data

models that specify different marginals one can use information criteria such
as BIC.
8.5.5

Discrete Copulas

The presence of ties in count data can potentially reduce the identifiability
of discrete copulas (Genest and Neslehova, 2008). In a bivariate context a tie
occurs when pairs of observations have the same value. For count data this
seems likely when the sample is dominated by zeros. However, the problem
is mitigated when regressors are present and we are dealing with conditional
marginals and conditional copulas.
If the marginal cdfs Fj (·), j = 1, . . . , m, are continuous, then the corresponding copula in equation (8.25) is unique. If (F1 , F2 ) are not all continuous,
the joint distribution function can always be expressed as (8.25), although in
such a case the copula lacks uniqueness (see Schweizer and Sklar, 1983, chapter 6). For applied work in the regression context that involves conditioning on
covariates, this does not invalidate the application of copulas. As Genest and
Neslehova (2008, p. 14) observe, “The fact that there exist (infinitely many)
copulas for the same discrete joint distribution does not invalidate models of
this sort.”
Copulas have been used most often for continuous data, notably returns
on multiple financial assets. Several discrete data examples are given later.
Additionally, copulas can be used for a mixture of discrete and continuous
data. Zimmer and Trivedi (2006) use a trivariate copula framework to develop
a joint distribution of two counted outcomes and one binary treatment variable.
In the m-variate discrete case, the formula (8.28) generalizes to have 2m
terms, making estimation difficult. Smith and Khaled (2011) propose augmenting the likelihood with uniform latent variables and estimating using Bayesian
MCMC methods. They apply their method to a 16-variate model for data on
bike path use by hour (m = 16) within each of 565 days (n = 565).
8.5.6

Example: A Bivariate Negative Binomial Model

For standard count data that are overdispersed a natural copula-based bivariate
model is one with negative binomial marginals. Trivedi and Zimmer (2007)
model the individual use of prescription drugs (y1 ) and nonprescription drugs
(y2 ), using data from Cameron et al. (1988). The data are characterized by low
counts, with y1 > 3 for 6% of observations and y2 > 3 for 1% of the sample.
There are many ties, especially at counts of 0 and 1. The data actually exhibit
some negative dependence, suggesting that prescribed and nonprescribed drugs
may be substitutes.
The authors estimate by ML models based on density (8.28), where the
marginals are NB2, regressors are the same as those for the doctor visits example in Chapter 3.2.6, and a range of copula functions are employed. Copulas
with weak tail dependence, such as the Frank copula, fit the data best. The

8.5 Copula-Based Models

323

Clayton, Gumbel, and Gaussian copulas encountered convergence problems,
perhaps due to the large number of ties.
8.5.7

Example: A Bivariate Hurdle Model

Bivariate hurdle models were introduced in section 8.4.4. Here we present a
copula-based bivariate hurdle model for counts, based on the model of Deb,
Trivedi, and Zimmer (2011), who considered continuous outcomes (health
expenditures) rather than count outcomes. The model uses copulas twice – to
model correlation when the hurdles are not crossed by either variable and to
model correlation when the hurdles are crossed by both variables.
Consider two nonnegative integer-valued outcomes y1 and y2 , each with a
significant fraction of zeros. Let y10 denote y1 = 0, y1+ denote y1 > 0, y20 denote
y2 = 0, and y2+ denote y2 > 0. Then there are four configurations of outcomes
with the following probabilities:
y10 , y20 −→ F 0 (y1 = 0, y2 = 0)
y1+ , y20 −→ F 0 (y1 > 0, y2 = 0) × f1+ (y1 |y1 > 0)
y10 , y2+ −→ F 0 (y1 = 0, y2 > 0) × f2+ (y2 |y2 > 0)

(8.29)

+
y1+ , y2+ −→ F 0 (y1 > 0, y2 > 0) × f12
(y1 , y2 |y1 > 0, y2 > 0),

where F 0 is a bivariate distribution function defined over binary outcomes,
f1+ and f2+ are univariate mass functions defined over positive, integer-valued
+
is a bivariate joint mass function also defined over a pair of
outcomes, and f12
positive, integer-valued outcomes.
We first consider specification of F 0 (·) for the bivariate hurdle part of the
model. A natural choice for the marginal distributions is a probit model, so
Fj0 (·) = j (·), j = 1, 2. A copula-based model for the joint probability distribution of y1 and y2 is


(8.30)
F 0 (y1 > 0, y2 > 0) = C 0 1 (·) , 2 (·) |θ 0
where C 0 is a selected copula function with a given functional form, and θ 0 is
a dependence parameter. Since, for example, F 0 (y1 > 0, y2 = 0) = F10 (y1 >
0) − F 0 (y1 > 0, y2 > 0) it follows from (8.29) that the other three discrete
probabilities are


F 0 (y1 = 0, y2 = 0) = 1 − 1 (·) − 2 (·) + C 0 1 (·) , 2 (·) |θ 0


(8.31)
F 0 (y1 > 0, y2 = 0) = 1 (·) − C 0 1 (·) , 2 (·) |θ 0


0
0
0
F (y1 = 0, y2 > 0) = 2 (·) − C 1 (·) , 2 (·) |θ .
The direct use of a copula is an alternative to a bivariate probit model or deriving the joint distribution from a pair of marginal distributions with common
unobserved heterogeneity that is integrated out as in section 8.4.3, an approach

324

Multivariate Data

also used in Hellstrom (2006). The copula approach avoids numerical integration, yet the dependence between y10 and y20 can be characterized in a flexible
way.
Next consider specification of the densities f + (·) for the bivariate positive
outcomes part of the model. The univariate mass functions f1+ (·) and f2+ (·)
may be, for example, zero-truncated Poisson or negative binomial. Using a
copula, the zero-truncated joint distribution is


+
(y1 , y2 |y1 > 0, y2 > 0) = c+ F1+ (·) , F2+ (·) |θ + × f1+ (·) × f2+ (·) ,
f12
(8.32)
where lower case c+ (·) represents the copula density, and Fj+ (·) is the cumulative distribution function (cdf) version of fj+ (·), j = 1, 2.
The joint log-likelihood is based on the logarithm of the four component
densities given in (8.29). Estimation is simplified by exploiting the convenient
property of the hurdle model that the log-likelihood decomposes into two parts
that can be maximized separately. Then introducing regressors xi but suppressing the regression parameters for simplicity, ln L = ln L1 + ln L2 , where for
the bivariate hurdle part

ln L1 (θ 0 ) = ln F 0 (y1i = 0, y2i = 0|xi , θ 0 )
0,0

+
+



+,0



ln F 0 (y1i > 0, y2i = 0|xi , θ 0 )
ln F 0 (y1i = 0, y2i > 0|xi , θ 0 )

(8.33)

0,+

+



+,+

ln F 0 (y1i > 0, y2i > 0|xi , θ 0 ),

and for the bivariate positive part


ln L2 (θ + ) =
ln f1+ (y1i |y1i > 0|xi ) +
ln f2+ (y2i |y2i > 0|xi )
+,0

+

8.5.8


+,+

0,+

+
ln f12
(y1 , y2 |y1 > 0, y2 > 0|xi ).

(8.34)

Example: Distribution of Differences of Counts

The difference between two counts is an integer-valued variable with support
at both negative and positive values. Karlis and Ntzoufras (2003) provide
references to the early history of this topic as well as an application to sports
data. The case of the difference between two independent Poisson variates with
different means is considered by Skellam (1946). Karlis and Ntzoufras consider
the correlated case, initially using the bivariate Poisson. This approach restricts
the counts to be positively correlated, an assumption too strong for their data,

8.6 Moment-Based Estimation

325

so they use a variant of a zero-inflated Poisson that provides inflation when
there are ties so that y1 = y2 .
Cameron, Li, Trivedi, and Zimmer (2004) instead use a copula framework.
In their application y1 denotes self-reported doctor visits and y2 denotes actual
doctor visits as recorded administratively. They use a copula model for the joint
distribution F (y1 , y2 ), with NB2 marginals. The distribution of the measurement error y1 − y2 is obtained by using the transformation z = y1 − y2 , which
allows the joint distribution to be equivalently expressed in terms of z and
y2 as
f (z, y2 ) = c12 (F1 (z + y2 ), F2 (y2 )|θ) ,

(8.35)

where c12 (·) is defined in (8.28). The corresponding probability mass function
of z is obtained by summing over all possible values of y2 , so
g(z) =

∞


c12 (F1 (z + y2 ), F2 (y2 )|θ) .

(8.36)

y2 =0

For any value of z, (8.36) gives the corresponding probability mass.
 The cdf of
g(z) is calculated by accumulating masses at each point z, G(z) = zk=−∞ g(k).
Both g(z) and G(z) characterize the full distribution of z so that inference can
be made regarding the difference between two count variables. Misreporting is
found to be increasing in the number of actual visits, with results similar across
the several copulas used.
This method can also be applied to any discrete or continuous variables when
the marginal distribution of the components of the differences is parametrically
specified.
8.6 MOMENT-BASED ESTIMATION
Moment-based estimators provide consistent estimators of the parameters in
the models for the conditional means of y1 , . . . , ym rather than fully parameterizing the distribution of y1 , . . . , ym as in previous sections of this chapter. The
approach is essentially the same as that for seemingly unrelated regressions
(SUR) for the linear model. There are two complications. First, the conditional
means are nonlinear, usually exponential models. Second, the SUR model presumes homoskedastic errors, whereas efficient estimation requires modeling the
intrinsic heteroskedasticity of count data. Estimation is by feasible generalized
nonlinear GLS, essentially a variant of GEE introduced in Chapter 2.4.6. Systems estimation can improve estimation efficiency, and tests of cross-equation
restrictions are easy to implement.
8.6.1

Seemingly Unrelated Nonlinear Regressions

Consider a multivariate nonlinear heteroskedastic regression model of the form
yj = μ(Xj β j ) + uj , j = 1, 2, . . . , m,

326

Multivariate Data

where yj is an n × 1 vector on the j th component of the regression, μ(Xj β j )
is an n × 1 vector with i th entry exp(xij β j ), and E[uj uk ] = (Xj , Xk ). We
assume independence across individuals i = 1, . . . , n, but permit correlation
over the j components for given individual i. Define the following stacked
nm × 1 vectors y and u, nm × 1 vector μ(β), km × 1 vector β, and nm × nm
matrix (X) = E[uu ]:
⎡
⎡ ⎤
⎡ ⎤
⎤
⎡ ⎤
μ(X1 β 1 )
u1
β1
y1
⎢
⎢
⎢
⎥
⎥
⎢ .. ⎥
.
. ⎥
.
..
y = ⎣ . ⎦ , μ(β) = ⎣
⎦ , β = ⎣ .. ⎦ , u = ⎣ .. ⎦ .
μ(Xm β m )

ym
⎡

···
⎢
..
(X) = ⎣
.
(X1 , Xm ) · · ·
(X1 )
..
.

βm

um

⎤
(X1 , Xm )
⎥
..
⎦.
.
(Xm )

In this case association between elements of y arises only through the covariance
matrix (X). If (X) is block-diagonal, then simpler conditional modeling of
each component of y separately is equivalent to joint modeling.
The feasible nonlinear GLS estimator, given a first-step consistent estimate
ˆ (X) of (X) based on single equation Poisson or NLS estimation, minimizes
the quadratic form
Q(β) = (y − μ(β)) ˆ (X)−1 (y − μ(β)).

(8.37)

This is a variant of GEE estimation presented in Chapter 2.4.6.
A key component for implementation is specification of a model for
(X). An obvious model for counts is that Var[yij |xij ] = α j exp(xij β) and
Cov[yij , yik |xij , xik ] = α j k exp(xij β) exp(xik β). A simpler, less efficient estimator lets Var[yij |xij ] and Cov[yij , yik |xij , xik ] be constants, in which case
one can simply use a standard nonlinear SUR command. In either case standard errors can be obtained that are robust to misspecification of (X), as in
Chapter 2.4.6.
8.6.2

Semiparametric Estimation

An alternative is to nonparametrically estimate (X) given a first-stage estimate of β. In the context of a linear multiple regression with a linear conditional
expectation E[yi |xi ] = xi β, Robinson (1987b) gives conditions under which
asymptotically efficient estimation is possible in a model in which the variance
function σ i (xi ) has an unknown form. His technique is to estimate the error
variance function σ 2i (x) = V[yi |x] = E[yi2 |x] − (E[yi |x])2 by k-nearest neighbor (k-NN) nonparametric estimation of E[yi |xi ] and E[yi2 |xi ]. Then estimate
β by weighted least squares estimation with weights based on σ̂ 2i or, equivalently, OLS regression of (yi /σ̂ i ) on (xi /σ̂ i ). The estimator is fully efficient

8.7 Testing for Dependence

327

n
 −2 −1
with V[
β] =
. We refer to this technique as semiparametric
i=1 xi xi σ̂ i
generalized least squares (SPGLS). Chapter 11.6 provides additional details
of the implementation of this approach to a single-equation count model.
Delgado (1992) extends SPGLS to multivariate nonlinear models, including
the model considered here. The technique amounts to feasible nonlinear GLS
estimation that minimizes the objective function in (8.37), based on a consistent
estimate ˆ (X) obtained using the k-NN method given first-step nonlinear SUR
estimates of β. Practical experience with the multivariate SPGLS estimator
is limited, but Delgado provides some simulation results. The efficiency of
such estimators is a complex issue and beyond the scope of the present chapter
(Newey, 1990b; Chamberlain, 1992a).
8.6.3

Bivariate Poisson with Heterogeneity

Gourieroux et al. (1984b, pp. 716–717) propose moment-based estimation
based on an extension of the bivariate Poisson model of section 8.4.1 that introduces unobserved heterogeneity into the conditional means of the components
of the bivariate Poisson; see also Gurmu and Elder (2000).
The two counts are determined by y1 = u + w and y2 = v + w, as in (8.8),
where u, v, and w are independent Poisson with means of, respectively, μ1 , μ2 ,
and μ3 . The departure is to let μj = exp(x β j + ν j ), j = 1, 2, 3. This introduces unobserved heterogeneity components ν j that allow for overdispersion
and also may be correlated. Specifically it is assumed that E[exp(ν j )] = 1,
V[exp(ν j )] = σjj , and Cov[exp(ν j ), exp(ν k )] = σj k , j, k = 1, 2, 3. It follows
that
E[y1i |xi ] = exp(xi β 1 ) + exp(xi β 3 )
E[y2i |xi ] = exp(xi β 2 ) + exp(xi β 3 ).
The more complicated expression for Var[yi |xi ], where yi = (y1i , y2i ), is
given in Gourieroux et al. (1984b, p. 716). Then
 the QGPML estimator of
(β 1 , β 2 , β 3 ) may be obtained by minimizing ni=1 (yi − E[yi |xi ]) V̂−1
i (yi −
E[yi |xi ]), where V̂i is a consistent estimator of Var[yi |xi ]. For details of implementing this estimator, see Gourieroux et al. (1984b).
8.7 TESTING FOR DEPENDENCE
Before estimating joint models, it may be desirable to test the hypothesis of
dependence. In principle one can apply standard Wald, LR, or LM tests to the
parametric models presented in sections 8.5 and 8.6, but these models can be
challenging to estimate and rely heavily on parametric assumptions. Instead
we consider simpler score and conditional moment tests based on orthogonal
polynomial series expansions of a baseline density. These expansions can also
be a basis for estimation; see Chapter 11.

328

Multivariate Data

8.7.1

Definitions and Conditions

A useful (but not widely used) technique for generating and approximating
multivariate discrete distributions is via a sequence of orthogonal or orthonormal polynomial expansions for the unknown joint density. For example, the
bivariate density f (y1 , y2 ) may be approximated by a series expansion in which
the terms are orthonormal polynomials of the univariate marginal densities
f (y1 ) and f (y2 ). A required condition for the validity of the expansion is the
existence of finite moments of all orders, denoted μ(k) , k = 1, 2, . . . . Begin by
considering an important definition in the univariate case.
Definition (Orthogonality). An orthogonal polynomial of integer order j ,
denoted by Qj (y) , j = 1, . . . , K, has the property that

Qj (y)Qk (y)f (y)dy = δ j k σjj ,
(8.38)
where δ j k is the Kronecker delta, which equals zero if j = k and one otherwise,
and σjj denotes the variance of Qj (y). That is,
Ef Qj (yi )Qk (yi ) = δ j k σjj .

(8.39)

An orthogonal polynomial obtained by a scale transformation of Qj (y) such
that it has unit variance is referred to as an orthonormal polynomial of degree
√
j . Thus Qj (y)/ σjj is an orthonormal polynomial; it has zero mean and unit
variance. For convenience we use the notation Pj (y) to denote a j th order
orthonormal polynomial.
Let  be a matrix whose ij th element is μ(i+j −2) , for i ≥ 1, j ≥ 1. Then the
necessary and sufficient condition for an arbitrary sequence {μ(k) } to give rise to
a sequence of orthogonal polynomials, unique up to an arbitrary constant, is that
 should be positive definite (Cramer, 1946). An orthonormal sequence
Pj (y) 2is
complete if, for every function R(y) with finite variance, V[R(y)] = ∞
j =0 aj ,
where aj = E[R(y)Pj (y)].
8.7.2

Univariate Expansion

A well-behaved or regular pdf has a series representation in terms of orthogonal polynomials with respect to that density (Cramer, 1946, chapter 12;
Lancaster, 1969). Let {Qj (y), j = 0, 1, 2, . . . ; Q0 (y) = 1} be a sequence of
orthogonal polynomials for f (y). Let H (y) denote the true but unknown distribution function and h(y) denote a data density that satisfies regularity conditions (Lancaster, 1969). Then the following series expansion of h(y) around
a baseline density f (y) is available:
⎤
⎡
∞

aj Qj (y)⎦ .
(8.40)
h(y) = f (y) ⎣1 +
j =1

8.7 Testing for Dependence

329

Multiplying both sides of (8.40) by Qj (y) and integrating shows that the
coefficients in the expansion are defined by

(8.41)
aj = Qj (y)h(y)dy = Eh Qj (y) ,
which are identically zero if h(y) = f (y). The terms in the series expansion
reflect the divergence between the true but unknown pdf h(y) and the assumed
(baseline) pdf f (y). A significant deviation implies that these coefficients are
significantly different from zero. The orthogonal polynomials Qj (y) have zero
mean
E Qj (y) = 0.

(8.42)

Furthermore, the variance of Qj (y), evaluated under f (y), is given by
E[Q2j (y)]. A general procedure for deriving orthogonal polynomials is discussed in Cameron and Trivedi (1990b). For selected densities the orthogonal
polynomials can also be derived using generating functions. These generating
functions are known for the classical cases and for the Meixner class of distributions, which includes the normal, binomial, negative binomial, gamma, and
Poisson densities (Cameron and Trivedi, 1993). For ease of later reference, we
also note the following expressions for Qj (y), j = 0, 1, 2:
Q0 (y) = 1
Q1 (y) = y − μ
Q2 (y) = (y − μ)2 − (μ3 /μ2 )(y − μ) − μ2 ,
where μk , k = 1, 2, and 3, denote, respectively, the first, second, and third
central moments of y. Hence it is seen that the orthogonal polynomials are
functions of the “raw” residuals (y − μ).
8.7.3

Multivariate Expansions

We first consider the bivariate case. Let f (y1 , y2 ) be a bivariate pdf of random variables y1 and y2 with marginal distributions f1 (y) and f2 (y) whose
corresponding orthogonal polynomial sequences (OPS) are Qj (y) and Rj (y),
j = 0, 1, 2, . . . . If f (y1 , y2 ) satisfies regularity conditions then the following
expansion is formally valid:
⎡
⎤
∞ 
∞

(8.43)
f (y1 , y2 ) = f1 (y1 )f2 (y2 ) ⎣1 +
ρj k Qj (y1 )Rk (y2 )⎦
j =1 k=1

where
ρj k = E Qj (y1 )Rk (y2 )
 
=
Qj (y1 )Rk (y2 )f (y1 , y2 )dy1 dy2 .

330

Multivariate Data

The derivation of this result is similar to that given earlier for the aj coefficients
in (8.40) (Lancaster, 1969, p. 97).
The general multivariate treatment has close parallels with the bivariate case.
Consider r random variables (y1 , . . . , yr ) with joint density f (y1 , . . . , yr ) and
r marginals f1 (y1 ), f2 (y2 ), . . . , fr (yr ) whose respective OPSs are denoted by
Qij (y), s = 0, 1, . . . , ∞; i = 1, 2, . . . , r. Under regularity conditions the joint
pdf admits a series expansion of the same type as that given in equation (8.43);
that is,
f (y1 , . . . , yr )
⎡
= f1 (y1 ) · · · fr (yr ) ⎣1 +

r 
∞ 
r 
∞

i<j

+

r 
r 
∞ 
r 
∞ 
∞

i<j j <k

k

s

ij

t

j

s

ij

j

ρ st Qis (yi )Qt (yj )

t

⎤

(8.44)

ρ sto Qis (yi )Qt (yj )Qko (yk )⎦ ,
ij k

j

o
j

where ρ st denotes the correlation coefficient between Qis (yi ) and Qt (yj ).
8.7.4

Tests of Independence

Series expansions can be used to generate and estimate approximations to
unknown joint densities in a manner similar to the “semi-nonparametric”
approach of Gallant and Tauchen (1989), adapted and applied to univariate
count data by Cameron and Johansson (1997). A complication in estimation,
not present in testing, is the need to ensure that the more general series expansion
density is properly defined. This leads to replacing the term in square brackets
in (8.40) by its square, requiring the introduction of a normalizing constant, and
truncating the order of the polynomial at much less than infinity. Chapter 11.2
provides details of implementing this approach using nonorthogonal polynomial expansions. The objective is the estimation of flexible parametric forms.
The approach has not yet been widely applied to multivariate count models.
In this section we present applications of series expansions only to tests
of independence in a multivariate framework assuming given marginals. Our
treatment of testing follows the developments in Cameron and Trivedi (1990b,
1993). The attraction of the approach is that it leads to score and conditional
moment tests that are simpler to implement than Wald or LR tests. The tests
are more general than tests of zero correlation, a necessary but not sufficient
condition for independence.
Using the key idea that under independence the joint pdf factorizes into a
product of marginals, Cameron and Trivedi (1993) developed score-type tests
of independence based on a series expansion of the type given in (8.43). The
leading term in the series is the product of the marginals; the remaining terms in
the expansion are orthonormal polynomials of the univariate marginal densities.

8.7 Testing for Dependence

331

The idea behind the test is to measure the significance of the higher order terms
in the expansion using estimates of the marginal models only. The conditional
moment test of independence consists of testing for zero correlation between
all pairs of orthonormal polynomials. So the steps are as follows. First, specify
the marginals and estimate their parameters. Then evaluate the orthogonal or
orthonormal polynomials at the estimated parameter values. Finally, calculate
the tests.
Given the marginals and corresponding orthogonal polynomials, the tests
can be developed as follows. Using equation (8.43), the test of independence
in the bivariate case requires us to test H0 : ρj k = 0 (all j, k). This onerous
task may be simplified in one of two ways. The null may be tested against
an alternative in which dependence is restricted to be a function of a small
number of parameters, usually just one. Or we may approximate the bivariate
distribution by a series expansion with a smaller number of terms and then
derive a score (LM) test of the null hypothesis H0 : ρj k = 0 (some j, k). For
independence we require ρj k = 0 for all j and k. By testing only a subset
of the restrictions, the hypothesis of approximate independence is tested. If
p = 2, this is equivalent to the null hypothesis H0 : ρ 11 = ρ 22 = ρ 12 = ρ 21 = 0.
For general p, the appropriate moment restriction is E0 [Qj (y1 )Rk (y2 )] = 0,
j, k = 1, 2, . . . , p, where E0 denotes expectation under the null hypothesis of
independence of y1 and y2 .
The key moment restriction is
E0 [Sj k (y, x, θ )] = 0,
where Sj k (y, x, θ ) = Qj (y1 |x1 , θ 1 )Rk (y2 |x2 , θ 2 ). The conditioning operator is
used to make explicit the presence of subsets of regressors x in the model.
By independence of Qj and Rk , and using the property that E0 [Rs (·)] =
E0 [Qt (·)] = 0, and conditional on x,

2
V0 [Sj k (·)] = E0 [Rj (·)] V0 [Qk (·)] + (E0 [Qk (·)])2 V0 [Rj (·)]
+ V0 [Qk (·)]V0 [Rj (·)]V0 [Qk (·)]V0 [Rj (·)].
Assume initially that the parameters of the marginal distributions are known.
By application of a central limit theorem for orthogonal polynomials Qj,i and
Rk,i , which have zero means by construction, we can obtain the following test
statistic for the null hypothesis of H0 : ρj k = 0:
 n
 n
−1  n




2
a
2
rj k =
Qj,i Rk,i
Qj,i Rk,i
Qj,i Rk,i ∼ χ 2 (1).
i=1

i=1

i=1

(8.45)
Note that r2j k can be computed as n times the uncentered R2U (equals the
proportion of the explained sum of squares) from the auxiliary regression of 1
on Qj,i Rk,i .

332

Multivariate Data

For orthonormal polynomials, distinguished by an asterisk, we have the
result that
 n
 n

 n





∗2
∗2
−1
∗
∗ 2
Qj,i Rk,i
Qj,i
Rk,i = n E0
E0
i=1

i=1

i=1

∗
.A
by the properties of homoskedasticity and independence of Q∗j,i and Rk,i
:
ρ
=
0
is
test of the null hypothesis
of
H
0
 n
 j k n
 n
−1  n





2
∗
∗
∗2
∗2
∗
∗
Qj,i Rk,i
Qj,i
Rk,i
Qj,i Rk,i
rj k = n
i=1

i=1

i=1

a

∼ χ 2 (1).

i=1

(8.46)

These polynomials are functions of parameters θ. To implement the tests,
they are evaluated at the maximum likelihood estimates. Consider the effect of
substituting the estimated parameters θ̂ 1 for θ 1 and θ̂ 2 for θ 2 in the test statistics.
Using the general theory of conditional moment tests given in Chapter 2.6.3
and specifically noting that the derivative condition (5.69),
E0 [θ Sj k,i (y, x, θ̂ |x)] = 0,
is satisfied, it follows that the asymptotic distribution of the test statistics (8.45)
and (8.46) is not affected by the replacement of θ by θ̂ .
The application of these ideas to the multivariate case is potentially burdensome because it involves all unique combinations of the polynomials of all
marginal distributions. If the dimension of y is large, it would seem sensible
to exploit prior information on the structure of dependence in constructing a
test. It is simpler to test for zero correlation between two subsets of y, denoted
y1 and y2 , of dimensions r1 and r2 , respectively, with the covariance matrix
= [ j k ], j, k = 1, 2. Define the squared canonical correlation coefficient,
ρ 2c = (vec
= tr(

(

−1
11

12

−1
22

21 )
−1
11



⊗

−1
22 )(vec

21 ),

21 )

(8.47)

which equals zero under the null hypothesis of independence of y1 and y2 . Let
r2c denote the sample estimate of ρ 2c . Then, analogous to the test in (8.46) we
have the result that
d

nr2c → χ 2 (r1 r2 ).

(8.48)

See Jupp and Mardia (1980) and Shiba and Tsurumi (1988) for related results.
In practice tests of independence may simply turn out to be misspecification tests of misspecified marginals. The tests may be significant because
the baseline marginals are misspecified, not necessarily because the variables are dependent. However, rather remarkably, in the bivariate case if only
one marginal is misspecified, the tests retain validity as tests of independence.
See Cameron and Trivedi (1993, pp. 34–35), who also investigate properties
of the tests in Monte Carlo experiments. The investigations of these tests for

8.8 Mixed Multivariate Models

333

Table 8.2. Orthogonal polynomials: First and second order
Density
Poisson
NB1
NB2

Q1 (y)
y−μ
y−μ
y−μ

Q2 (y)
(y − μ)2 − y
(y − μ)2 − (2φ − 1)(y − μ) − φμ
(y − μ)2 − (1 + 2αμ)(y − μ) − (1 + αμ)μ

bivariate count regression models show that the tests have the correct size and
high power if the marginals are correctly specified, but they overreject if the
marginals are misspecified.
Table 8.2 shows first- and second-order polynomials for the specific cases
of Poisson, NB1 (with V[y] = φμ), and NB2 (with V[y] = μ + αμ2 )).
8.8 MIXED MULTIVARIATE MODELS
We present several examples of multivariate models where only one of the
variables is a count, whereas the others are multinomial or continuous variables.
8.8.1

Discrete Choice and Counts

In some studies the objective is to analyze several types of events that are
mutually exclusive and collectively exhaustive. Such models involve two types
of discrete outcomes. An example is the frequency of visits to alternative recreational sites. Typically one observes (yij , xij ; i = 1, . . . , n; j = 1, . . . , M),
where i is the individual subscript and j is the destination subscript. The variable y measures trip frequency and x refers to covariates. In this section we
consider a framework for modeling such data.
The starting point in such an analysis is to condition on the total number of
events across all types, using the multinomial distribution,
M
yj
j =1 pj
,
(8.49)
f (y|N ) = N ! M
j =1 yj !
where y = (y1 , . . . , yM ), yj ∈ {0, 1, 2, . . . ; j = 1, 
. . . , M}, where pj denotes
the probability of the j th type of event, so that j pj = 1 and yj denotes

the frequency of the j th event, and N = j yj denotes the total number of
outcomes across the alternatives. The multinomial distribution is conditional
on the total number of all types of events, N. This is a useful specification for
analysis if N, the total number of outcomes, is given.
Next, suppose that the yj are independent Poissons with means μj . Then
the
Ntotal number of outcomes N is Poisson distributed with parameter μ =
j =1 μj , and
⎡
⎤
M

e−μ μN
Pr ⎣
.
(8.50)
yj = N ⎦ =
N!
j =1

334

Multivariate Data

Note that then the probability of the j th type of event is pj = μj /μ, so μj =
μpj .
The unconditional distribution of y combines the conditional multinomial
probability with the probability of the total number of events,
Pr[y] = Pr

)

*
yj = N Pr[y|N].

Using (8.49) and (8.50), Terza and Wilson (1990) therefore propose a mixed
multinomial (logit) Poisson model with
)
*⎞
⎛
⎞⎛
M
M
j =1 yj
−μ

e
μ
y
j
⎠,
(8.51)
f MP (y) = ⎝ pj ⎠ ⎝ M
y
!
j
j
=1
j =1
with multinomial logit probabilities
exp[xj β j ]
pj = M
.

j =1 exp[xj β j ]
The estimation of the mixed model by maximum likelihood is simplified on noting that the resultant log-likelihood is additive in the parameters (β 1 , . . . , β M )
and μ. Hence, to maximize the likelihood one can sequentially estimate the sub
log-likelihoods for the Poisson model for the total number of events, N , and
for the choice probabilities of the multinomial model, although not necessarily
in that order.

Terza and Wilson (1990) note that since μj = μpj and μ = N
j =1 μj ,
M −μ rj
MP
j
after some algebra f (y) = j =1 (e μj /rj !), which is just the density
of M independent Poissons with means μj , j = 1, . . . , M. So the mixed
multinomial-Poisson and an M individual Poisson model are equivalent. But the
analysis remains valid if more generally the Poisson specification is replaced
by one of the modified or generalized variants discussed in Chapter 4, and
the multinomial logit is replaced by a nested multinomial logit. For example,
Terza and Wilson (1990) use a mixed multinomial logit and Poisson hurdles
specification.
Hausman, Leonard, and McFadden (1995) develop a joint model of choice
of recreational sites and the number of recreational trips. They use panel data
from a large-scale telephone survey of Alaskan residents. Although there are
similarities with the approach of Terza and Wilson (1990), their model explicitly
incorporates restrictions from utility theory. The model conforms to a two-stage
budgeting process. First, a multinomial model is specified and estimated for
explaining the choice of recreational sites in Alaska. Explanatory variables
include the prices associated with the choice of sites. The estimates from this
model are used to construct a price index for recreational trips. This price
index subsequently becomes an explanatory variable in the count model for the
total number of trips, which the authors specify as a fixed-effects Poisson (see
Chapter 9). The two-step modeling approach is described as utility consistent

8.8 Mixed Multivariate Models

335

in the sense that it is consistent with two-stage consumer budgeting. At step
one the consuming unit allocates a utility-maximizing expenditure on the total
number of trips. At the second stage this amount is optimally allocated across
trips to alternative sites.
8.8.2

Counts and Continuous Variables

We consider two bivariate examples where one variable is a count and the
other is a continuous variable, in one example a duration and in the other
expenditures.
Cowling, Hutton, and Shaw (2006) present a joint model for (1) the number
of epileptic seizures experienced by an individual in the six months before a
randomized treatment intervention and (2) the post-treatment survival time to
the first subsequent epileptic seizure. They specify a bivariate Marshall-Olkin
type model as in (8.15) where the two marginal models are an exponential
hazard model with gamma heterogeneity for the survival time and a Poisson
with gamma heterogeneity for the number of prior seizures. This is essentially
a one-factor model for heterogeneity. Because both exponential-gamma and
Poisson-gamma mixtures have closed forms, no numerical integration is necessary. Treatment indicators are included in the set of covariates, with effective
treatments expected to increase the duration between seizures and decrease the
frequency.
Van Praag and Vermeulen (1993) analyze data on the number of events
(shopping trips), denoted by y1 , and the vector of corresponding outcomes
(recorded expenditures), denoted by y2 = (y21 , . . . , y2k ) where k refers to the
number of events, so y1 = k. The objective is to formulate a joint probability
model for y1 and y2 , and the authors specify the joint probability to be the
product of the marginals, so
Pr[y1 = k] Pr[y2 = (y21 , . . . , y2k )] = f (y1 |θ 1 , x)g(y2 |θ 2 , x), (8.52)
where (θ 1 , θ 2 ) are unknown parameters and x is a set of explanatory variables.
This model assumes that any dependency is captured through the regressors
x, so that conditional on x, the variables y1 and y2 are stochastically independent. Under this assumption the joint log-likelihood L(θ 1 , θ 2 ) factors into one
component for count and another component for the amount, which may be
estimated separately. The assumptions permit one to specify a flexible model for
the counts – accounting, for example, for the presence of excess of zero counts
due to taste differences in the population – and possible truncation of expenditures due to, for example, expenditures smaller than a specified amount, say
y2,min , not being recorded. Van Praag and Vermeulen (1993) estimate a countamount model for tobacco, bakery, and aggregate food expenditure in which
the frequencies are modeled by a zero-inflated NB model and the amounts are
modeled by a truncated normal.
The assumption of stochastic independence in (8.52) is convenient because it
simplifies ML estimation, but in certain cases the assumption may be tenuous.

336

Multivariate Data

For example, the availability of bulk discounts in shopping may provide an
incentive for larger but fewer transactions. This dependency might be captured
by using bulk discount as an explanatory variable. More generally correlation
could be introduced using some of the methods presented in this chapter, such
as correlated unobserved heterogeneity or copulas.
8.9 EMPIRICAL EXAMPLE
To illustrate the use of bivariate count models in empirical work, we use
the data set introduced in Chapter 6.3. Here we jointly model the number
of emergency room visits (EMR) and number of hospitalizations (HOSP). A
sample of 4,406 observations obtained from the National Medical Expenditure
Survey conducted in 1987 and 1988 is used.
As expected, this pair of variables shows high raw positive correlation (0.47)
because a stay in a hospital often follows an emergency room visit. The counted
outcomes for EMR and HOSP are both dominated by zeros with the proportion
of zeros exceeding 80%. The correlation is somewhat lower (0.39) if based
only on the 454 positive-valued pairs of observations.
The count regressions use the same regressors as in Chapter 6.3. We begin
with tests of independence based on univariate NB2 regressions and the first two
orthogonal polynomials for the NB2 given in Table 8.2. Let Qj and Rk denote,
respectively, the j th and k th orthogonal polynomials for EMR and HOSP. Then
the test statistic (8.45) equals 88.45, 18.05, 0.01, and 3.93, respectively, for
(j, k) = (1, 1), (1, 2), (2, 1), and (2, 2). The critical value is 3.84 for this χ 2 (1)
distributed test statistic, so independence is rejected at significance level 0.05
for all but the third test.
Table 8.3 provides estimates of two bivariate specifications discussed earlier: the bivariate negative binomial (BVNB) model of section 8.4.2 and the
nonlinear seemingly unrelated regression (NLSUR) model assuming exponential conditional mean as in section 8.6.1. As previously indicated the BVNB
model has a single parameter α to capture both overdispersion and correlation
between unobserved heterogeneity, and it is estimated by ML. The NLSUR
model does not explicitly accommodate either the integer-valued aspect of the
outcomes or the presence of unobserved heterogeneity. The NLSUR model
is estimated by two-step nonlinear GLS estimator in which NLS is applied to
each equation separately and a covariance matrix of the residuals is constructed
for the second-step estimation. The reported standard errors are based on the
robust sandwich form in both cases.
Many of the health status variables are statistically significant, whereas many
of the socioeconomic variables are statistically insignificance at level 0.05. The
insurance variables PRIVINS and MEDICAID are statistically insignificant,
except for NLSUR estimates for HOSP. A number of point estimates of the
coefficients differ by more than 20%. However, in both cases the conditional
correlation between the outcomes is significantly positive as expected. For
NLSUR the correlation of 0.43 is close to the raw data correlation of 0.47.

Table 8.3. ML estimates of bivariate negative binomial model and NLSUR estimates
ML (BVNB)
EMR
Variable

337

CONS
EXCLHTH
POORHLTH
NUMCHRON
ADLDIFF
NOREAST
MIDWEST
WEST
AGE
BLACK
MALE
MARRIED
SCHOOL
FAMINC
EMPLOYED
PRIVINS
MEDICAID
α
ρ
− ln L

Coefficient
−1.88
−0.62
0.49
0.24
0.40
0.04
0.03
0.18
0.10
0.17
0.11
−0.11
−0.02
0.00
0.19
0.03
0.15
2.17

NLSUR
HOSP

Standard error

Coefficient
−2.82
−0.70
0.50
0.27
0.34
0.02
0.16
0.16
0.18
0.10
0.21
−0.02
0.00
0.00
0.05
0.19
0.18

0.51
0.21
0.10
0.03
0.09
0.10
0.10
0.11
0.06
0.12
0.09
0.09
0.01
0.01
0.13
0.10
0.13
0.13

EMR

Standard error
0.49
0.19
0.10
0.02
0.09
0.10
0.10
0.11
0.06
0.11
0.08
0.09
0.01
0.01
0.13
0.11
0.14

Coefficient
−1.03
−0.43
0.64
0.27
0.43
−0.12
−0.03
−0.08
−0.15
0.28
0.08
−0.16
−0.00
0.01
0.32
0.00
0.05
0.43

5,223

HOSP

Standard error
0.63
0.25
0.11
0.04
0.17
0.17
0.17
0.18
0.09
0.21
0.16
0.15
0.02
0.02
0.20
0.15
0.20

Coefficient

Standard error

−1.95
−0.65
0.64
0.24
0.40
−0.07
0.08
−0.05
−0.06
0.13
0.05
0.02
0.01
0.01
0.10
0.32
0.26

0.60
0.21
0.10
0.03
0.11
0.13
0.14
0.13
0.08
0.14
0.12
0.11
0.02
0.01
0.15
0.13
0.14

338

Multivariate Data

The BVNB standard errors are roughly 20% lower than those for NLSUR.
From separate estimation of each outcome by NLS, Poisson, and NB2, not
reported here, the efficiency gain comes mainly due to BVNB controlling for
heteroskedasticity whereas NLSUR does not; in this example there is little efficiency gain due to joint modeling of the two outcomes. Overall, this comparison
indicates that the computational convenience of NLSUR is an attractive starting
point for multivariate count modeling, especially because it avoids numerical
integration and strong distributional assumptions.
An improvement relative to the BVNB specification results from using a
more flexible parametric specification such as the bivariate Poisson-Normal
mixture. This additional flexibility comes at a computational cost as discussed
in section 8.4.3. Munkin and Trivedi (1999) illustrate this and related estimators
using the same data as analyzed here.
8.10 DERIVATIONS
Kocherlakota and Kocherlakota (1993) derive the bivariate Poisson distribution
in several different ways. The method of trivariate reduction is one method that
is commonly used. The joint pgf of y1 and y2 defined in (8.8) is
y

y

P (z1 , z2 ) = E[z11 z22 ]
= E[z1u z2v (z1 z2 )w ]
= exp μ1 (z1 − 1) + μ2 (z2 − 1) + μ3 (z1 z2 − 1)




= exp[ μ1 + μ3 (z1 − 1) + μ2 + μ3 (z2 − 1)
+ μ3 (z1 − 1)(z2 − 1)].

(8.53)

The marginal pgf is


P (z) = exp[ μj + μ3 (z − 1)],

j = 1, 2,

(8.54)

whence the marginal distributions are y1 ∼ P[μ1 + μ3 ] and y2 ∼ P[μ2 + μ3 ].
The condition for the independence of y1 and y2 is that the joint pgf is the
product of the two marginals, which is true if μ3 = 0.
To derive the joint probability function expand (8.53) in powers of z1 and
z2 as
P [z1 , z2 ] = exp μ1 + μ2 + μ3

∞
∞
j j ∞

μl1 z1l  μ2 z2  μk3 z1k z2k
,
l! j =0 j ! k=0 k!
l=0

(8.55)

8.11 Bibliographic Notes

339

which yields the joint frequency distribution as the coefficient of z1r z2s :
f (y1 = r, y2 = s) = exp μ1 + μ2 + μ3

min(r,s)

l=0

s−l l
μr−l
1 μ2 μ3
.
(r − l)!(s − l)!l!

(8.56)
The covariance between y1 and y2 , using the independence of u, v, w, is given
by
Cov [y1 , y2 ] = Cov [u + w, v + w]
= V [w]
= μ3 ,
and the correlation is given by
6
6
Cov [y1 , y2 ] / V [y1 ] V [y2 ] = μ3 / (μ1 + μ3 )(μ2 + μ3 ).
Jung and Winkelmann (1993, pp. 555–556) provide first and second derivatives
of the log-likelihood.
If the method of trivariate reduction is used, zero correlation between any
pair implies independence.
8.11 BIBLIOGRAPHIC NOTES
An introductory survey of multivariate extensions of GLMs is given in
Fahrmeier and Tutz (1994); see especially their treatment of multivariate models with correlated responses. Formal statistical properties of bivariate discrete
models are found in Kocherlakota and Kocherlakota (1993) and Johnson et al.
(1997). Bivariate extensions of the zero-truncated Poisson distribution (without covariates) are studied in Hamdan (1972) and Patil, Patel, and Kovner
(1977). Aitchison and Ho (1989) study a multivariate Poisson with log-normal
heterogeneity. Lindeboom and van den Berg (1994) analyze the impact of heterogeneity on correlation between survival times in bivariate survival models;
their results are suggestive of consequences to be expected in bivariate count
models. Arnold and Strauss (1988, 1992) and Moschopoulos and Staniswalis
(1994) have considered the problem of estimating the parameters of bivariate exponential family distributions with given conditionals. The econometric
literature on the estimation of multivariate models under conditional moment
restrictions is relevant if the less parametric nonlinear GLS or semiparametric
GLS approach is followed. But only some of this discussion relates easily to
count models; see Newey (1990a) and Chamberlain (1992a).
Bivariate count models have been widely used in applications. Jung and
Winkelmann (1993) consider the number of voluntary and involuntary job
changes as a bivariate Poisson process; Mayer and Chappell (1992) apply it
to study determinants of entry and exit of firms. Good and Pirog-Good (1989)

340

Multivariate Data

consider several bivariate count models for teenage delinquency and paternity,
but without the regression component. King (1989a) presents a bivariate model
of U.S. presidential vetoes of social welfare and defense policy legislation with
a regression component. Duarte and Escario (2006) use a bivariate negative
binomial to analyze alcohol abuse and truancy among the adolescent Spanish
population. Meghir and Robin (1992) develop and estimate a joint model of
the frequency of purchase and a consumer demand system for eight types of
foodstuffs using French data on households that were observed to purchase all
eight foodstuffs over the survey period. They show that consistent estimation of
the demand system may require data on the frequency of purchase. They adopt
a sequential approach in which a frequency of purchase equation is estimated
by NLS and the ratio of the fitted mean to the actual frequency of purchase
is used to weight all observed expenditures. A system of demand equations
is fitted using these reweighted expenditures. Many more recent examples are
given throughout this chapter.
As in the case of single-equation count regression, the zero inflation or
excess zeros problem may also occur in multivariate contexts, but the issue
gets relatively less attention. Both hurdle and zero-inflated bivariate variants
have been developed. Hellstro m (2006) develops and applies a bivariate hurdle
model to household tourism demand; estimation uses simulated ML. Li et al.
(1999) develop a multivariate ZIP model but without a regression component.
Wang (2003) proposes a bivariate variant of the zero-inflated negative binomial
model and an estimation procedure based on the EM algorithm.
The copula framework has the attraction of enabling flexible models for the
marginals. Trivedi and Zimmer (2007) consider several bivariate count models
with dependence modeled via copulas.

CHAPTER 9

Longitudinal Data

9.1 INTRODUCTION
Longitudinal data or panel data are observations on a cross-section of individual units such as persons, households, firms, and regions that are observed over
several time periods. The data structure is similar to that of multivariate data
considered in Chapter 8. Analysis is simpler than for multivariate data because
for each individual unit the same outcome variable is observed, rather than
several different outcome variables. Yet analysis is also more complex because
this same outcome variable is observed at different points in time, introducing
times series data considerations presented in Chapter 7.
In this chapter we consider longitudinal data analysis if the dependent variable is a count variable. Remarkably, many count regression applications are to
longitudinal data rather than simpler cross-section data. Econometrics examples include the number of patents awarded to each of many individual firms
over several years, the number of accidents in each of several regions, and the
number of days of absence for each of many persons over several years. A
political science example is the number of protests in each of several different
countries over many years. A biological and health science example is the
number of occurrences of a specific health event, such as a seizure, for each of
many patients in each of several time periods.
A key advantage of longitudinal data over cross-section data is that they
permit more general types of individual heterogeneity. Excellent motivation
was provided by Neyman (1965), who pointed out that panel data enable one
to control for heterogeneity and thereby distinguish between true and apparent
contagion. For example, consider estimating the impact of research and development expenditures on the number of patent applications by a firm, controlling
for the individual firm-specific propensity to patent. For a single cross-section
these controls can only depend on observed firm-specific attributes such as
industry, and estimates may be inconsistent if there is additionally an unobserved component to the individual firm-specific propensity to patent. With
longitudinal data one can additionally include a firm-specific term for the
unobserved firm-specific propensity to patent.
341

342

Longitudinal Data

The simplest longitudinal count data regression models are standard count
models, with the addition of an individual specific term reflecting individual
heterogeneity. In a fixed effects model this is a separate parameter for each individual. Creative estimation methods are needed if there are many individuals
in the sample, because then there are many parameters. In a random effects
model this individual specific term is instead drawn from a specified distribution. Then creativity is required either in choosing a distribution that leads to
tractable analytical results or in obtaining estimates if the model is not tractable.
Asymptotic theory requires that the number of observations, here the number
of individual units times the number of time periods, goes to infinity. We focus
on the most common case of a short panel in which only a few time periods
are observed and the number of cross-sectional units goes to infinity. We also
consider briefly the case where the number of cross-sectional units is small but
is observed for a large number of periods, as can be the case for cross-country
studies. Then the earlier discussion for handling individual specific terms is
mirrored in a similar discussion for time specific effects. It is important to
realize that the distribution of estimators and the choice of estimator varies
according to the type of sampling scheme.
In longitudinal data analysis the data are assumed to be independent over
individual units for a given year but are permitted to be correlated over time
for a given individual unit. In the simplest models this correlation over time is
assumed to be adequately controlled for by individual-specific effects. In more
general models correlation over time is additionally introduced in ways similar
to those used in time series analysis. Finally, as in time series models, one can
consider dynamic models or transition models that add a dynamic component
to the regression function, allowing the dependent variable this year to depend
on its own value in previous years.
A review of the standard linear models for longitudinal data, with fixed
effects and random effects, is given in section 9.2, along with a statement of the
analogous models for count data and a summary of statistical inference with
data from short panels. Pooled or population-averaged estimators are presented
in section 9.3. In section 9.4 fixed effects models for count data are presented,
along with application to data on the number of patents awarded to each of
346 firms in each of the years 1975 through 1979. Random effects models
are studied in section 9.5. In sections 9.4 and 9.5 both moment-based and ML
estimators are detailed. A discussion of applications and of the relative merits
of fixed effects and random effects approaches is given in section 9.6. Model
specification tests are presented in section 9.7. Dynamic models, in which
the regressors include lagged dependent variables, are studied in section 9.8.
Estimation with endogenous regressors is presented in section 9.9, and more
flexible count models for panel data are presented in section 9.10.
9.2 MODELS FOR LONGITUDINAL DATA
We review linear panel models, with emphasis on models that include fixed
or random individual-specific effects. For count data models with a positive

9.2 Models for Longitudinal Data

343

conditional mean, individual-specific effects enter multiplicatively rather than
additively.
Throughout we consider statistical inference for short panels. Then the
number of individuals n → ∞ while the number of time periods T is finite,
and data are assumed to be independent over i but possibly correlated over t for
given i. In the standard case in econometrics the time interval is fixed and the
data are equi-spaced through time. However, in most cases panel estimators can
be adapted to unbalanced panels and to repeated events that are not necessarily
equi-spaced through time. An example of such data is the number of epileptic
seizures during a two-week period preceding each of four consecutive clinical
visits; see Diggle, Heagerty, Liang, and Zeger (2002).
9.2.1

Linear Models and Linear Estimators

A quite general linear model for longitudinal data is
yit = α it + xit β it + uit ,

i = 1, . . . , n,

t = 1, . . . , T ,

(9.1)

where yit is a scalar dependent variable, xit is a k × 1 vector of independent
variables that here excludes an intercept, and uit is a scalar disturbance term.
The subscript i indexes an individual person, firm, or country in a cross-section,
and the subscript t indexes time. The distinguishing feature of longitudinal
data models is that the intercept α it and regressor coefficients β it may differ
across individuals and/or time. Such variation in coefficients reflects individualspecific and time-specific effects.
The model (9.1) is too general and is not estimable. Further restrictions need
to be placed on the extent to which α it and β it vary with i and t, and on the
behavior of the error uit .
The population-averaged or pooled linear model restricts regression coefficients to be constant over individuals and time, so
yit = α + xit β + uit .

(9.2)

This is just the usual linear model, without adjustment for the data being
longitudinal data. The pooled OLS estimator is obtained by OLS regression
of yit on an intercept and xit . It is consistent if the true model is (9.2) and
uit is uncorrelated with xit . For short panels any correlation of the error over
time for a given individual should be controlled for by computing panel-robust
standard errors that are cluster-robust standard errors with clustering on the
individual. More efficient feasible GLS estimation is possible given a model
for the correlation in uit . A common assumption is equicorrelated errors, with
Cor[uit , uis ] = ρ for s = t. Such estimators are called pooled estimators or
population-averaged estimators.
The between model averages model (9.2) over time for each individual, so
ȳi = α + xi β + ūi ,

(9.3)

344

Longitudinal Data



where ȳi = T1 Tt=1 yit and xi = T1 Tt=1 xit . The between estimator is obtained
by OLS regression of ȳi on an intercept and xi , and it uses only variation
between individuals.
The most commonly used models for short panels are variants of the one-way
individual-specific effect linear model,
yit = α i + xit β + uit .

(9.4)

This is the standard linear regression model, except that rather than one intercept
α there are n individual-specific intercepts α 1 , . . . , α n . Note that for short panels
time-specific effects λt , t = 1, . . . , T , are easily accommodated by including
time dummies in the regressors xit . There are several variants of this model,
leading to different estimators.
The fixed effects linear model treats α i in (9.4) as a random variable that is
potentially correlated with the regressors xit . The parameters β in this model
are potentially inestimable, because the number of α i terms goes to infinity
as n → ∞. Fortunately it is possible to eliminate the intercepts, enabling
consistent estimation of β, with two distinct methods most often used.
The within model or mean-differenced model,
yit − ȳi = (xit − xi ) β + (uit − ūi ),

(9.5)
xi β

is obtained by subtraction from model (9.4) of ȳi = α i +
+ ūi , obtained by
averaging (9.4) over time for individual i. The within estimator is obtained by
OLS regression of (yit − ȳi ) on (xit − xi ), and it uses only variation over time
within each individual. This estimator is also called the fixed effects estimator
since if the α i in (9.4) are viewed as parameters to be estimated, then joint
estimation of α 1 , . . . , α n and β in (9.4) by OLS can be shown to yield this
estimator for β. The estimator is also a conditional ML estimator, since if uit
in (9.4) are assumed to be normally distributed,
then maximizing with respect
to β the conditional likelihood function given Tt=1 yit , i = 1, . . . , n, yields
the within estimator. A major limitation of the fixed effects model is that the
coefficients of time-invariant regressors, say zi , are not identified since then
zi − zi = 0. The individual-specific fixed effects can be estimated by α̂ i =
ȳi − x̄i β̂ LFE . For a short panel, α̂ i is not consistent for α i because only T
observations are used in estimating each α i .
The first-difference model
yit − yit−1 = (xit − xit−1 ) β + (uit − uit−1 ),

(9.6)

is obtained by subtraction from model (9.4) of the first lag of model (9.4).
The first-difference estimator is obtained by OLS regression of (yit − yit−1 ) on
(xit − xit−1 ), and it uses only variation over time within each individual.
The random effects linear model treats α i in (9.4) as an iid random variable
with mean α and variance σ 2α , and it additionally assumes that uit is iid with
mean 0 and variance σ 2u . The random effects estimator is the feasible GLS
estimator in this model. It can be obtained by OLS estimation of (yit − θ̂ i ȳi )
on an intercept and (xit − θ̂ i x̄i ), where θ̂ i is a consistent estimate of θ i = 1 −

9.2 Models for Longitudinal Data

345

6
σ 2u /[Ti σ 2α + σ 2u ]. The model assumptions imply Cor[uit , uis ] = σ 2α /(σ 2α +
σ 2u ) for s = t, so the random effects estimator is asymptotically equivalent to
the population-averaged estimator with equicorrelated errors. The estimator is
also asymptotically equivalent to the MLE under the additional assumption that
α i and uit are normally distributed.
The random effects and fixed effects linear models are compared by, for
example, Hsiao (2003, pp. 41–49). The models are conceptually different, with
the fixed effects analysis being conditional on the effects for individuals in the
sample; random effects is an unconditional or marginal analysis with respect
to the population. A major practical difference is that the fixed effects analysis
provides only estimates of time-varying regressors. Thus, for example, it does
not allow estimation of an indicator variable for whether or not a patient in a
clinical trial was taking the drug under investigation (rather than a placebo).
Another major difference is that the random effects model assumption that
individual effects are iid implies that individual effects are uncorrelated with
the regressors. If, instead, unobserved individual effects are correlated with
observed effects, the random effects estimator is inconsistent. The pooled and
between estimators are also inconsistent in this case. Many econometrics studies
in particular prefer fixed effects estimators (within or first-difference) because
of this potential problem.
The conditional correlated random effects linear model is a variation of the
random effects model that allows α i in (9.4) to be correlated with the regressors
xit according to the model α i = π + xi λ + vi , where vi is iid [0, σ 2v ]. It can be
shown that random effects estimation with regressors xit and xi is equivalent
to within estimation.
The random coefficients model allows both intercept and slope coefficients
to vary across individuals, so
yit = α i + xit β i + uit ,

(9.7)

where α i is iid [α, σ 2α ] and β i is iid [β, β ]. This model is a special case of
a mixed linear model. The random coefficients estimator is the feasible GLS
estimator in this model. In the linear case the other estimators remain consistent
since this model implies E[yit |xit ] = α + xit β.
Dynamic models include lags of yit as regressors. For example,
yit = α i + ρyit−1 + xit β + uit .
If α i is a fixed effect the within estimator is no longer consistent. Instead IV
estimation based on the first-difference model, with appropriate lags of yit used
as instruments, yields consistent estimates.
9.2.2

Individual Effects in Count Models

The subsequent sections present a range of models and estimators for longitudinal count data, many with individual-specific effects. In the linear case the

346

Longitudinal Data

individual-specific effect enters additively, so μit = α i + xit β. For count data
the individual-specific effect instead enters multiplicatively.
For models with an exponential conditional mean, exp(xit β), a model with
multiplicative individual-specific effect α i , specifies the conditional mean to be
E[yit |xit , α i ] = μit
= α i λit
= α i exp(xit β).

(9.8)

Note that α used here refers to the individual effect and is not used in the same
way as in previous chapters, where it was an overdispersion parameter.
In the fixed effects model the α i are potentially correlated with the regressors
xit . Like the linear model, however, consistent estimation of β is possible by
eliminating α i ; see section 9.4. In the random effects model the α i are instead
iid random variables; see section 9.5.
A key departure from the linear model is that the individual-specific effects
in (9.8) are multiplicative, rather than additive as in the linear model (9.4). Given
the exponential form for λit , the multiplicative effects can still be interpreted
as a shift in the intercept because
μit = α i exp(xit β) = exp(δ i + xit β),

(9.9)

where δ i = ln α i .
Note that this equality between multiplicative effects and intercept shift
relies on an exponential conditional mean. The equality does not hold in some
count data models, nor does it hold in noncount models such as binary models
to which similar longitudinal methods might be applied. Suppose the starting
point is a more general conditional mean function g(xit β). Then some models
and estimation methods continue with multiplicative effects, so
E[yit |xit , α i ] = μit = α i g(xit β),

(9.10)

whereas other methods use a shift in the intercept,
E[yit |xit , α i ] = μit = g(δ i + xit β).

(9.11)

Models (9.10) and (9.11) differ if g(x) = exp(x).
The marginal effect given (9.8) is
MEj =

∂E[yit |xit , α i ]
= α i exp(xit β)β j = β j E[yit |xit , α i ]. (9.12)
∂xitj

Unlike the linear FE model, MEj depends on the unknown α i , so that consistent
estimation of β is not sufficient for computing the marginal effect. From the
last equality, however, the slope coefficient β j can still be interpreted as a semielasticity, giving the proportionate increase in E[yit |xit , α i ] associated with a
one-unit change in xitj .
We first present estimation for models without dynamics. In particular, for
multiplicative effects models the regressors xit are initially assumed to be

9.2 Models for Longitudinal Data

347

strictly exogenous, so that
E[yit |xi1 , . . . , xiT , α i ] = α i λit .

(9.13)

This is a stronger condition than E[yit |xit , α i ] = α i λit . Condition (9.13) is
relaxed when time-series models are presented in section 9.8.
Some results require only moment conditions (9.8) or (9.13), so are not
restricted to panel data that are count data. For example, they can be applied to
right-skewed nonnegative continuous data such as expenditure data.
Parametric model results are most easily obtained for the Poisson. Extensions to the negative binomial do not always work, and when they do work
they do so only for some methods for the NB1 model and in other cases for the
NB2 model. It should be kept in mind, however, that a common reason for such
extensions is to control for unobserved heterogeneity. Access to longitudinal
data can control for heterogeneity through the individual-specific effect α i , so
the efficiency gains in going beyond Poisson models may not be as great as in
the cross-section case.
9.2.3

Panel-Robust Inference

We present panel-robust inference for the generalized method of moments
estimator, introduced in Chapter 2.5.2, for the case of short panels. The results
nest both ML and moment-based estimation methods. Many panel count data
estimators are moment-based, especially those for models that are dynamic or
have endogenous regressors.
Collecting data over all time periods for a given individual, define
⎡
⎡  ⎤
⎤
yi1
xi1
⎢ .. ⎥
⎢ .. ⎥
yi = ⎣ . ⎦ , Xi = ⎣ . ⎦ .
yiT

xiT

Estimation is based on the population moment conditions
E[hi (yi , Xi , θ 0 )] = 0,

i = 1, . . . , n,

(9.14)

where θ 0 is the value of the q × 1 parameter vector θ in the dgp, hi (·) is an
r × 1 vector, and r ≥ q so that the number of moment conditions potentially
exceeds the number of parameters.
The GMM estimator θ̂ GMM minimizes


 n
 n


hi (yi , Xi , θ ) Wn
hi (yi , Xi , θ ) ,
(9.15)
i=1
p

i=1

where Wn → W is a possibly stochastic symmetric positive definite r × r
weighting matrix.
p
Given essentially that (9.14) holds, θ̂ GMM → θ 0 and
√
d
n(θ̂ GMM − θ 0 ) → N[0, (H WH)−1 H WSWH(H WH)−1 ], (9.16)

348

Longitudinal Data

where W is consistently estimated by Wn , H is consistently estimated by

n
1  ∂hi 
Ĥ =
(9.17)
n i=1 ∂θ  θ̂
and, assuming independence over i, S is consistently estimated by
1
hi (θ̂)hi (θ̂) .
Ŝ =
n i=1
n

(9.18)

The variance matrix estimate based on (9.16) to (9.18) is a panel-robust or
cluster-robust estimate. It can also be obtained by a panel bootstrap or panel
jackknife, see Chapter 2.6.4; these resample over individuals rather than over
individual-time pairs. More generally independence over i can be relaxed to
independence over clusters such as villages, see section 2.7.1, provided the
number of clusters is large.
In the just identified case (r = q) the GMM estimator simplifies to the
estimating equations estimator, presented in Chapter 2.5.1. Using the current
notation, θ̂ EE that solves
n


hi (yi , Xi , θ ) = 0,

(9.19)

is consistent and
√
d
n(θ̂ EE − θ 0 ) → N[0, H−1 SH−1 ].

(9.20)

i=1

In the special case of the MLE, hi (yi , Xi , θ ) = ∂ ln f (yi |Xi , θ )/∂θ, where
f (yi |Xi , θ) is the joint density for the i th observation yi .
As an example consider the linear fixed effects model and specify
hi (yi , Xi , β) =

T


(xit − xi ){(yit − ȳi ) − (xit − x̄i ) β},

t=1

which has an expected value 0 given (9.4) and E[uit |xi1 , . . . , xiT , α i ] = 0.
Then the estimating equations (9.20) can be solved to yield
−1 n T
 n T


(xit − xi )(xit − xi )
(xit − xi )(yit − ȳi ), (9.21)
β̂ =
i=1 t=1

i=1 t=1


which is just the within estimator. Since ∂hi /∂θ  = Tt=1 (xit − xi )(xit − xi ) ,
the variance matrix given in (9.20) can be consistently estimated by n times
−1 n T T
 n T
−1
 n T








xit
xit
xit
xis
xit
xit

uit 
uis
,
i=1 t=1

i=1 t=1 s=1

i=1 t=1

uit = ûit − ui = (yit − ȳi ) − (xit − x̄i ) β̂.
where 
xit = xit − xi and 

9.3 Population Averaged Models

349

9.3 POPULATION AVERAGED MODELS
Pooled estimators combine the between cross-section and within (time-series)
variation in the data by simply regressing yit on an intercept and xit . More efficient pooled estimators adjust for correlation over time for a given individual.
9.3.1

Pooled Poisson QMLE

The obvious pooled estimator for count data is the Poisson regression with
exponential conditional mean. Defining zit = [1 xit ] and γ  = [δ β  ], so
exp(zit γ ) = exp(δ + xit β), the first-order conditions for the pooled Poisson
QMLE are
n 
T


(yit − exp(zit γ ))zit = 0.

(9.22)

i=1 t=1

The estimator is consistent if
E[yit |xit ] = exp(δ + xit β) = α exp(xit β),

(9.23)

where α = exp(δ).
For cross-section data with independent observations, robust inference is
based on heteroskedastic-robust standard errors; see Chapter 3.2.2. For short
panels where observations are independent over i but correlated over t for
given i, inference is based on cluster-robust standard errors, see Chapter 2.7.1
or section 9.2.3, with clustering on the individual. Then the Poisson QMLE has
the variance matrix estimate,
−1 n T T
 n T
−1
 n T






ûit ûis zit zis
μ̂it zit zit
μ̂it zit zit
, (9.24)
i=1 t=1

i=1 t=1 s=1

exp(zit γ̂ ),

i=1 t=1

exp(zit γ̂ ).

where μ̂it =
and ûit = yit −
It is very important that this
variance matrix estimate be used because the default matrix estimate is usually
erroneously much smaller – it fails to control for correlation over time for a
given individual and for any overdispersion.
The individual-specific multiplicative effects model (9.8) implies that
E[yit |xit ] = Eαi [E[yit |xit , α i ]]
= Eαi [α i exp(xit β)].
In the random effects model with α i independent of xit , it follows that
E[yit |xit ] = α exp(xit β),
where α = Eαi [α i ], so that condition (9.23) is satisfied. More generally, the
pooled estimator is called the population-averaged estimator in the statistics
literature, since (9.23) is assumed to hold after averaging out any individualspecific effects. In the fixed effects model, however, no such simplification
occurs due to the correlation of α i with xit , condition (9.23) no longer holds,

350

Longitudinal Data

and the pooled Poisson QMLE is inconsistent. Alternative estimators, given in
section 9.4, need to be used.
9.3.2

Generalized Estimating Equations Estimator

The pooled Poisson QMLE essentially bases estimation on the assumption that
observations are independent over both i and t and then performs inference
that relaxes the assumption of independence over t. More efficient estimation
is possible by specifying a model for the correlation over time for a given
individual and then estimating subject to this model.
This is an example of generalized estimating equations estimation. The
results presented in Chapter 2.4.6 can be immediately applied, with subscript
i replaced with subscript t. Let μi (γ ) = [μi1 · · · μiT ] where μit = exp(zit γ ),
and let i be a working model for V[yi |Xi ] with ts th entry Cov[yit , yis |Xi ]. For
example, if we assume data are equicorrelated with overdispersion of the NB1
form, then we use Cor[yit , yis |Xi ] = ρ for all s = t and Cov[yit , yis |Xi ] =
ρσ it σ is , where σ 2it = φμit . A second possibility is to assume correlation for
the first m lags, so Cor[yit , yi,t−k |Xi ] = ρ k where ρ k = 0 for |k| > m.
From Chapter 2.4.6, the Poisson GEE estimator solves
n

∂μi (γ ) ˆ −1
(9.25)
i (yi − μi (γ )) = 0,
∂γ
i=1
where ˆ i is obtained from initial first-stage estimation of β (by pooled Poisson
QMLE) and any other parameters that determine i . The formula for a clusterrobust estimate of the asymptotic variance matrix, one robust to misspecification
of i , is given in Chapter 2.4.6.
Zeger and Liang (1986) and Liang and Zeger (1986) call the GEE approach
marginal analysis, because estimation is based on moments of the distribution marginal to the random effects. Zeger, Liang, and Albert (1988) consider
mixed GLMs with random effects that may interact with regressors. They
call the approach population-averaged, because the random effects are averaged out, and contrast this with subject-specific models that explicitly model
the individual effects. These papers present estimating equations of the form
(9.25) with little explicit discussion of the random effects or the precise form
of the correlation and modified heteroskedasticity that they induce. More formal treatment of random effects using this approach is given in Thall and Vail
(1990). Liang, Zeger, and Qaqish (1992) consider generalized GEE estimators
that jointly estimate the regression and correlation parameters.
Brännäs and Johansson (1996) consider a more tightly specified model than
Zeger and Liang (1986): the Poisson model with multiplicative random effects
in which the random effects are also time varying; that is, α it replaces α i in
(9.9). They consider estimation by GMM, which exploits more of the moment
conditions implied by the model. They apply these estimation methods to data
on the number of days absent from work for 895 Swedish workers in each of
11 years.

9.4 Fixed Effects Models

9.3.3

351

Pooled Parametric Models

For fully parametric models, pooled models assume that the marginal density
for a single observation yit ,
f (yit |xit ) = f (α + xit β, γ ),

(9.26)

is correctly specified, regardless of the (unspecified) form of the joint density
f (yit , . . . , yiT |xi1 , . . . , xiT , α, β, γ ).
This is a strong assumption.
The pooled MLE maximizes the log-likelihood formed assuming independence over i and t,
L(α, β, γ ) =

n 
T


ln f (α + xit β, γ ),

(9.27)

i=1 t=1

where, for example, f (yit |xit ) may be the NB2 density or a hurdle model
density. The pooled MLE is consistent if (9.26) holds. Inference should be
based on a panel-robust or cluster-robust (with clustering on i) estimator of the
covariance matrix,
−1 n T T
 n T
−1
 n T
  ∂s 

  ∂sit 

it 

sit sis θ̂
, (9.28)


∂θ
∂θ
θ̂
θ̂
i=1 t=1
i=1 t=1 s=1
i=1 t=1
where sit = ∂ ln f (α + xit β, γ )/∂θ, and θ  = [α β  γ  ].
9.4 FIXED EFFECTS MODELS
The econometrics literature places great emphasis on the estimation of panel
models with individual-specific fixed effects. In short panels it is a challenge to
consistently estimate β because, given asymptotic theory that relies on n → ∞
with T fixed, we need to first control for the infinite number of fixed effects
α 1 , . . . , α n . For the linear case this is possible, but for most nonlinear models
it is not. For counts it is possible for the Poisson model and, more generally,
for models with a conditional mean function that is multiplicative in the fixed
effects. But it is not possible in many other commonly used count models, such
as hurdle models and models with censoring or truncation.
There are three distinct leading approaches that, in a few special nonlinear
fixed effects models, lead to consistent estimation of β. First, moment-based
estimators use a differencing transformation to eliminate the fixed effects.
Second, both β and the fixed effects α i may be jointly estimated by maximum
likelihood. Third, conditional maximum likelihood estimation performs ML
estimation of β conditional on sufficient statistics for the individual effects.
Remarkably, for the Poisson model with multiplicative fixed effects, all three
approaches lead to the consistent estimation of β. We present moment-based
methods first, because they rely on fewer assumptions and in later sections are

352

Longitudinal Data

adapted to handle regressors that are endogenous or predetermined. For NB
models the first approach is also applicable, and the third approach works for
a restricted version of the NB1 model.
9.4.1

Moment-Based Methods

In the linear model (9.4) with additive fixed effects, there are several ways to
transform the model to eliminate the fixed effects and hence obtain a momentbased consistent estimator of β. Examples given in section 9.2.1 are mean
differencing, see (9.5), and first differencing, see (9.6).
Related transformations are possible for models with multiplicative fixed
effects and strictly exogenous regressors. From (9.13) we assume
E[yit |xi1 , . . . , xiT , α i ] = α i λit .
Averaging over time for individual i, it follows that
E[ȳi |xi1 , . . . , xiT , α i ] = α i λ̄i ,


where ȳi = T1 t λit and λ̄i = T1 t λit . Subtracting


E yit − (λit /λ̄i )ȳi |xi1 , . . . , xiT = 0,
and hence by the law of iterated expectations,


λit
ȳi
E xit yit −
= 0.
λ̄i

(9.29)

(9.30)

The Poisson fixed effects estimator β̂ PFE is the method of moments estimator
that solves the corresponding sample moment conditions

n 
T

y
xit yit − i λit = 0.
(9.31)
λi
i=1 t=1
The estimator is called the Poisson fixed effects estimator because (9.31) are
the first-order conditions of both the Poisson fixed effects MLE and the Poisson
fixed effects conditional MLE, derived in subsequent subsections. The coefficients β z say of time-invariant regressors zi are not identified since zi β z drops
out of the ratio λit /λi in (9.31) given an exponential conditional mean. This
mirrors the result for the linear model. From inspection of (9.31), observations
with yit = 0 for all T make no contribution to the estimation of β.
The asymptotic variance of β̂ PFE can be obtained using the results of section
9.2.3. The first-order conditions (9.31) have first-derivative matrix with respect
to β 
 T

n
T
T


1 
 ȳi
 ȳi
An =
xit xit λit −
xit xis λit λis ,
(9.32)
T t=1 s=1
λ̄i
λ̄i
i=1 t=1
for λit = exp(xit β), while the outer product of these conditions on taking
expectations and eliminating cross-products in i and j = i due to independence

9.4 Fixed Effects Models

353

is
Bn =

n 
T 
T


xit xis



i=1 t=1 s=1

yit −

yi
λi

λit


y
yis − i λis
λi



.

(9.33)

The panel-robust or cluster-robust variance matrix estimate is
V̂RS [β̂ PFE ] = Â−1 B̂Â−1 ,

(9.34)

where Â and B̂ are An and Bn evaluated at β̂ PFE .
It should be clear that the essential condition for consistency of β̂ PFE is
that (9.13) holds and λit is correctly specified. The variance matrix estimate
in (9.34) requires only the additional assumption that λit = exp(xit β) and
is easily adapted to other models for λit . Furthermore, the results are not
restricted to count data. For example, the Poisson fixed effects estimator may
be a good estimator for nonnegative right-skewed continuous data such as that
on expenditures, provided there are not too many zero observations in which
case a two-part or Tobit model may be needed.
A quite general treatment is given by Wooldridge (1990c), who considers a multiplicative fixed effect for general specifications of λit = g(xit β). In
addition to giving robust variance matrix estimates, he gives more efficient
GMM estimators if the conditional mean is specified to be of form α i λit with
other moments not specified, and when additionally the variance is specified to
be of the form ψ i α i λit . Chamberlain (1992a) gives semiparametric efficiency
bounds for models using only the specified first moment of form (9.9). Attainment of these bounds is theoretically possible but practically difficult, because
it requires high-dimensional nonparametric regressions.
It is conceivable that a fixed effects type formulation may account for much
of the overdispersion of counts. But there are other complications that generate
overdispersion, such as excess zeros and fat tails. At present little is known
about the performance of moment-based estimators when the dgp deviates
significantly from Poisson-type behavior. Also, moment-based models do not
exploit the integer-valued aspect of the dependent variable. Whether this leads
to significant efficiency loss, and if so when, is a topic that deserves future
investigation.
Models based on alternative moment conditions that enable estimation when
regressors are predetermined or endogenous are presented in section 9.8.
9.4.2

Poisson Maximum Likelihood

The simplest parametric fixed effects model for count data is the Poisson fixed
effects model where, conditional on λit and individual-specific effects α i ,
yit ∼ P[μit = α i λit ],

(9.35)

where λit is a specified function of xit and β, and at times we specialize to the
exponential form (9.8).

354

Longitudinal Data

ML estimation treats α i , i = 1, . . . , n, as parameters to be estimated jointly
with β. Then in general β may be inconsistently estimated if T is small and
n → ∞, because as n → ∞ the number of parameters, n + dim[β], to be
estimated goes to infinity, possibly negating the benefit of a larger sample
size, nT . The individual fixed effects can be viewed as incidental parameters,
because real interest lies in the slope coefficients. The α i are estimated based on
T observations for individual i, so are clearly inconsistently estimated unless
T → ∞. For some nonlinear fixed effects panel data models, this inconsistent
estimation of the α i leads to inconsistent parameter estimates of β. A leading
example is the logit model with fixed effects, with
Pr[yit = 1] = [exp(α i + xit β)]/[1 + exp(α i + xit β)].
Hsiao (2003, section 7.3.1) demonstrates the inconsistency of the MLE for β
in this case, for fixed T and n → ∞. This inconsistency can be large (e.g.,
plim β̂ = 2β for T = 2 in this logit example), though disappears as T → ∞,
and Monte Carlo experiments for several different models by Greene (2004)
suggest that for T ≥ 5 the bias may not be too severe.
For the linear model there is no incidental parameters problem. This is also
the case for the Poisson fixed effects model, as first shown independently by
Lancaster (1997) and Blundell, Griffith, and Van Reenan (1999). For yit iid
P[α i λit ], the joint density for the i th observation is

Pr [yi1 , . . . , yiT |α i , β] =
exp(−α i λit ) (α i λit )yit /yit !
(9.36)
t



= exp −α i


t

The corresponding log-density is
ln Pr [yi1 , . . . , yiT |α i , β] = −α i
+




t


λit





y
α i it

t

t

λit + ln α i

t

yit ln λit −

9
y
λitit





yit ! .

t

yit

t



ln yit !.

t

Differentiating with respect to α i and setting to zero yields

yit
α̂ i = t .
t λit

(9.37)

Substituting this back into (9.36), simplifying, and considering all n observations yields the concentrated likelihood function,

 


yit 




yit
t yit

Lconc (β) =
yit ×
λit /
yit ! (9.38)
exp −
t λit
t
t
t
t
i
yit
   λit

,
∝
s λis
t
i

9.4 Fixed Effects Models

355

where the last expression drops terms not involving β. This is the likelihood
for n independent observations on a T -dimensional multinomial variable with
cell probabilities
exp(xit β)
λit
=
,
pit = 

s λis
s exp(xis β)
where the second equality specializes to an exponential conditional mean. It
follows that for the Poisson fixed effects model there is no incidental parameters
problem.
The MLE for β, consistent for fixed T and n → ∞, can be obtained by
maximization of ln Lconc (β) in (9.38). The first-order conditions for this estimator of β, when λit = exp(xit β), are exactly those given in (9.31) for the
moment-based estimator. Estimates of α i can be obtained from (9.37), given
β̂, and are inconsistent unless T → ∞.
Inference for the MLE of β should be based on the cluster-robust variance
matrix given in (9.34). The default ML variance matrix estimate is Â−1
n , where
An is defined in (9.32), and it can greatly understate the true variance due to
the failure to control for overdispersion and any within-cluster correlation.
The consistency of the MLE for β despite the presence of incidental parameters is a special result that holds for the Poisson multiplicative fixed effects
model and, for continuous data, the normal linear additive fixed effects model.
It holds in few other models, if any.
The Poisson fixed effects estimator can be obtained by estimating a Poisson dummy variables
 model. The exponential mean specification (9.8) can be
rewritten as exp( nj=1 δ j dj it + xit β), where dj it is an indicator variable equal
to one if the it th observation is for individual j and zero otherwise. Thus we
can use standard Poisson software to regress yit on d1it , d2it , . . . , dnit and xit .
This is impractical, however, if n is so large that (n + dim(β)) exceeds software restrictions on the maximum number of regressors. It is computationally
quicker to work with specialized software that solves (9.31) that is of smaller
dimension dim(β).
9.4.3

Poisson Conditional Maximum Likelihood

The conditional maximum likelihood approach of Andersen (1970) performs
for LEF
inference conditional on the sufficient statistics for α 1 , . . . , α n , which
densities such as the Poisson are the individual-specific totals T ȳi = Tt=1 yit .
Consistent estimation of β is possible if the conditional log-likelihood does not
depend on the α i .
Palmgren (1981) and Hausman, Hall, and Griliches (1984) show that this
is the case for the Poisson fixed effects model. Furthermore the estimator then
coincides with the estimators of sections 9.4.1 and 9.4.2. This conditional ML
method provided the original derivation of the Poisson fixed effects estimator.

356

Longitudinal Data

In section 9.11.1 it is shown that for yit iid P[μit ], the conditional joint
density for the i th observation is
 T
 


yit

  μit

t yit !

yit = 
. (9.39)
×
Pr yi1 , . . . , yiT 

t yit !
s μis
t
t=1

This is a multinomial distribution, with probabilities pit = μit / s μis , t =
1, . . . , T , which has already been used in Chapter 8.8.
the advantage
Models with multiplicative effects set μit = α i λit . This has 
that simplification occurs because α i cancels in the ratio μit / s μis . Then
(9.39) becomes
 T
 


yit

  λit

t yit !

yit = 
. (9.40)
×
Pr yi1 , . . . , yiT 

t yit !
s λis
t
t=1

Because yi1 , . . . , yiT | t yit is
 multinomial distributed with probabilities

pi1 , . . . , piT , where pit = λit / s λis , it follows that yit has mean pit s yis .
Given (9.9)
 this implies that we are essentially estimating the fixed effects α i by

y
/
is
s
s λis .
In the special case λit = exp(xit β) this becomes
 T

 

yit

  exp(x β)

t yit !
it

Pr yi1 , . . . , yiT 
yit = 
. (9.41)
×


t yit !
s exp(xis β)
t
t=1
The conditional MLE of the Poisson fixed effects model β̂ PFE therefore maximizes the conditional log-likelihood function,
Lc (β) =

n

i=1

 
ln

T

t=1


yit ! −

T

t=1

ln(yit !) +

T

t=1





exp(xit β)

yit ln T

s=1

exp(xis β)

.

(9.42)
This log-likelihood function is similar to that of the multinomial logit model,
except that yit is not restricted to taking only values zero or one and to sum
over t to unity. More importantly, it is proportional to the natural logarithm of
Lconc (β) defined in (9.38), and therefore here the conditional MLE equals the
MLE.
Differentiation of (9.42) with respect to β yields first-order conditions for
β̂ PFE that can be reexpressed as (9.31); see, for example, Blundell, Griffith, and
Windmeijer (2000). The distribution of the resulting estimator can be obtained
using standard ML results, but as previously explained the panel-robust estimate
given in (9.34) should instead be used.
McCullagh and Nelder (1989, section 7.2) consider the conditional ML
method in a quite general setting. Diggle et al. (2002) specialize to GLMs
with canonical link function, see Chapter 2.4.4, in which case we again obtain
the multinomial form (9.40). They also consider more general fixed effects

9.4 Fixed Effects Models

357

in which the conditional mean function is of the form g(xit β + dit α i ) where
dit takes a finite number of values and α i is now a vector. Hsiao (2003)
specializes to binary models and finds that the conditional maximum likelihood
approach is tractable for the logit model but not the probit model; that is, the
method is tractable for individual intercepts if the canonical link function is
used.
9.4.4

Negative Binomial Models

Negative binomial fixed effects models specify the conditional mean function
to satisfy (9.13), so the Poisson fixed effects estimator still yields a consistent
estimator in short panels. A negative binomial fixed effects estimator has the
attraction of potentially more efficient estimation, although the inclusion of
individual effects will control for much of the overdispersion.
Hausman, Hall, and Griliches (1984) present a negative binomial fixed effects

model. Then yit is iid NB1 with parameters
 φ i , where λit = exp(xit β),
 α i λit and
so yit has mean α i λit /φ i and variance α i λit /φ i ×(1 + α i /φ i ). This negative
binomial model is of the less common NB1 form, with the variance a multiple of
the mean. The parameter α i is the individual-specific fixed effect; the parameter
φ i is the negative binomial overdispersion parameter that is permitted to vary
across individuals. An important restriction of this model is that α i and φ i can
only be identified up to the ratio α i /φ i .
Estimation is by conditional MLE. Some considerable algebra yields the
conditional joint density for the i th observation
 T


 

 (λit + yit )

Pr yi1 , . . . , yiT 
yit =
(9.43)

(λit )(yit + 1)
t
t=1

 


t λit 
t yit + 1


,
×



t λit +
t yit
which involves β through λit but does not involve the individual effects α i
and φ i . The distribution in (9.43) for integer λit is the negative hypergeometric
distribution. The conditional log-likelihood function follows from this density,
and the negative binomial fixed effects conditional ML estimator β̂ NB1FE is
obtained in the usual way.
Allison and Waterman (2002) argue that this model is not strictly speaking a
fixed effects model. This is apparent both from setting α i /φ i = δ, because then
the conditional mean is simply δλit and δ is absorbed in the intercept, and from
the fact that the coefficients of time-invariant regressors are actually identified
in this model. Allison and Waterman (2002), Greene (2007), and Guimarães
(2008) suggest various alternatives, but they have an incidental parameters
problem. The simplest approach is to jointly estimate β, α 1 , . . . , α n and the
overdispersion model in a standard NB2 model with a full set of individualspecific dummy variables. Greene (2004), for example, presents a practical

358

Longitudinal Data

Table 9.1. Patents awarded: Actual frequency distribution
Count
0
1–5 6–10 11–20 21–50 51–100 101–200 201–515
Frequency
337 565 139
140
223
146
107
73
Relative frequency 0.195 0.327 0.080 0.081 0.129 0.084
0.062
0.042

computation method when n is very large so that there are many α i to estimate.
Simulations by Allison and Waterman (2002) and Greene (2004) suggest that
the resultant incidental parameters bias in β may not be too large for moderately
small T .
9.4.5

Example: Patents

Many longitudinal count data studies, beginning with Hausman, Hall, and
Griliches (1984), consider the relationship between past research and development (R&D) expenditures and the number of patents yit awarded to the i th firm
in the t th year, using data in a short panel. Here we consider data used by Hall,
Griliches, and Hausman (1986) on 346 firms for the five years 1975 through
1979.
The range of the dependent variable PAT is summarized in Table 9.1. The
counts take a wide range of values with 20% of the counts being zero, whereas
20% exceed 50. The mean number of patents is 34.7 with variance 70.92 =
5,023, so the data are highly overdispersed. The between standard deviation
of 69.8 is much larger than the within standard deviation of 12.6. The fiveyear average number of patents per firm varies greatly, with lower quartile 1.4,
median 5, and upper quartile of 33. Most of the overdispersion is across firms,
with some patenting little and some a lot, rather than over time. It is possible
that inclusion of individual effects can greatly reduce overdispersion.
The regressors of interest are ln R0 , . . . , ln R−5 , the logarithm of current
and up to five past years’ research and development expenditures. Given the
logarithmic transformation of R and the exponential conditional mean, the
coefficient of ln R is an elasticity, so that the coefficients of ln R0 , . . . , ln R−5
should sum to unity if a doubling of R&D expenditures leads to a doubling of
patents. To control for firm-specific effects, the estimated model includes two
time-invariant regressors: lnSIZE, the logarithm of firm book value in 1972,
which is a measure of firm size, and DSCI, an indicator variable equal to 1 if
the firm is in the science sector. Time dummies are included to control for the
decline in patents over time, from an average of 36.9 in 1975 to 32.1 in 1979.
Regression results are given in Table 9.2. The reported panel-robust standard errors correct for both clustering and the considerable overdispersion in
the data. The first two estimates are from pooled regression. The pooled Poisson
QML estimates treat the data as one long cross-section, with yit having the conditional mean exp(α + xit β). The pooled Poisson GEE estimates, see section
9.3.2, are based on a working variance matrix that assumes equicorrelation and
overdispersion that is a multiple of the mean. The panel-robust standard errors

9.4 Fixed Effects Models

359

Table 9.2. Patents: Pooled and fixed effects estimates
Pooled Poisson
QMLE
Variable Coefficient
ln R0
0.135
−0.053
ln R−1
ln R−2
0.008
ln R−3
0.066
ln R−4
0.090
ln R−5
0.240
ln SIZE
0.253
DSCI
0.454
Sum ln R
0.486

Pooled GEE
Poisson

Poisson fixed
effects

NB1 fixed
effects CMLE

Standard
Standard
Standard
Standard
error Coefficient error Coefficient error Coefficient error
0.183
0.106
0.093
0.114
0.093
0.123
0.059
0.167
0.075

0.316
−0.052
0.105
0.020
0.023
0.049
0.270
0.440
0.460

0.062
0.060
0.054
0.067
0.054
0.054
0.057
0.175
0.070

0.322
−0.087
0.079
0.001
−0.005
0.003

0.081
0.071
0.062
0.078
0.064
0.076

0.313

0.143

0.273
−0.098
0.032
−0.020
0.016
−0.010
0.207
0.018
0.193

0.080
0.080
0.060
0.072
0.063
0.066
0.103
0.326
0.114

Note: All standard errors are panel-robust standard errors that cluster on the individual. All models
include an intercept and four time dummies for the years 1976–1979.

for the time-varying regressors are smaller than those for the Poisson QMLE,
so the expected efficiency gains occur here. The only statistically significant
regressors at level 0.05 are ln R0 , lnSIZE, DSCI, and the year dummies, not
reported in the table, that for the first estimator take values of, respectively,
−0.04, −0.05, −0.17, and −0.20. For the two pooled estimators the coefficients of current and lagged R&D expenditures, ln R−j , sum to 0.486 and
0.460, respectively. There is a statistically significant positive effect of R&D,
but the elasticity is considerably less than 1 and statistically so, at conventional
levels of significance.
One possible explanation is that this result is an artifact of the failure to control adequately for firm-specific effects. However, the sum of R&D coefficients
for the Poisson fixed effects estimator is 0.313, which is even further away from
one. The standard errors for this estimator that uses only within variation are
substantially larger than those for the pooled estimators, and are 50%–100%
larger than the default standard errors, not reported, that fail to control for any
overdispersion and correlation over time remaining after the inclusion of fixed
effects. Poisson coefficients of time-invariant regressors are not identified in
the Poisson fixed effects model, so are missing in the table. The negative binomial fixed effects estimates are similar to those for the Poisson fixed effects,
with a very slight improvement in precision. As discussed in section 9.4.4,
the coefficients of time-invariant regressors are, surprisingly, estimable in this
model.
The various longitudinal estimators imply that in the long run a doubling
of R&D expenditures leads to much less than a doubling in the number of
patents. Qualitatively similar results have been found with other data sets and
estimators, leading to a large literature on alternative estimators that may lead
to results closer to a priori beliefs.

360

Longitudinal Data

9.5 RANDOM EFFECTS MODELS
The simplest random effects model for count data is the Poisson random effects
model. This model is given by (9.8); that is, yit conditional on α i and λit is iid
Poisson (μit = α i λit ), and λit is a function of xit and parameters β. But in a
departure from the fixed effects model, the α i are iid random variables.
One approach is to specify the density f (α i ) of α i , and then integrate out
α i to obtain the joint density of yi1 , . . . , yiT conditional on just λi1 , . . . , λiT .
Then


∞

Pr [yi1 , . . . , yiT ] =


0
∞

=
0

Pr [yi1 , . . . , yiT |α i ] f (α i )dα i




(9.44)


Pr [yit |α i ] f (α i )dα i ,

t

where, for notational simplicity, dependence on λi1 , . . . , λiT is suppressed
as in the fixed effects case. This one-dimensional integral appears similar to
those in Chapter 4, except that here there is only one draw of α i for the T
random
 + ∞ variables yi1 , . . . , yiT , so that this integral does not equal the product
t
0 Pr [yit |α i ] f (α i )dα i of mixtures considered in Chapter 4.
Different distributions for α i lead to different distributions for yi1 , . . . , yiT .
Analytical results can be obtained as they would be
 obtained in a similar
Bayesian setting, by choosing f (α i ) to be conjugate to t Pr [yit |α i ]. Conjugate
densities exist for Poisson and NB2.
These conjugate densities are not the normal. Nonetheless there is considerable interest in results if f (α i ) is the normal density, because if results can
be obtained for scalar α i then they can be extended to random effects in slope
coefficients. A number of methods have been proposed.
Another solution if analytical results for the distribution are not available
is to use the population-averaged model and estimator, presented in section
9.3.2. Fixed and random effects panel count models that model omitted factors
via individual-specific effects have relatively greater credibility than the PA
model. Recent developments have affected random effects panel models more
than fixed effect models, in part because computational advances have made
them more accessible.
9.5.1

Conjugate-Distributed Random Effects

The gamma density is conjugate to the Poisson. In the pure cross-section case
a Poisson-gamma mixture leads to the negative binomial; see Chapter 4.2.2.
A similar result is obtained in the longitudinal setting. In section 9.11.2 it is
shown that for yit iid P[α i λit ], where α i is iid gamma(δ, δ) so that E[α i ] = 1
and V[α i ] = 1/δ, integration with respect to α i leads to the joint density for

9.5 Random Effects Models

the i th individual
Pr [yi1 , . . . , yiT ] =



361

 λit yit
yit !

t


×


t




×



− t yit
λit + δ

δ

δ
λ
t it + δ


(9.45)




yit + δ
.
(δ)
t

This is the density of the Poisson random effects model (with gamma-distributed
random effects). For this distribution E[yit ] = λit and V[yit ] = λit + λ2it /δ so
that overdispersion is of the NB2 form.
Maximum likelihood estimation of β and δ is straightforward. For λit =
exp(xit β), where regressors xit include an intercept, the first-order conditions
for β̂ PRE can be expressed as

n 
T

y + δ/T
= 0;
(9.46)
xit yit − λit i
λi + δ/T
i=1 t=1
see exercise 9.3. Thus this estimator, like the Poisson fixed effects estimator,
can be interpreted as being based on a transformation of yit to eliminate the
individual effects, and consistency essentially requires correct specification of
the conditional mean of yit . As for NB2 in the cross-section case the information matrix is block-diagonal, and the first-order conditions for δ are quite
complicated.
Hausman et al. (1984) propose this model and additionally consider the
negative binomial case. Then yit is iid NB2 with parameters α i λit and
 φ i , where

λit = exp(xit β), and hence yit has mean α i λit /φ i and variance α i λit /φ i ×
(1 + α i /φ i ). It is assumed that (1+ α i /φ i )−1 is a beta-distributed random
variable with parameters (a, b).
Hausman et al. (1984) show after considerable algebra that the negative
binomial random effects model (with beta distributed random effects) has joint
density for the i th individual


 (λit + yit )!
Pr [yi1 , . . . , yiT ] =
(9.47)
(λit )!(yit + 1)!
t
 




 (a + b)  a + t λit  b + t yit
.

×


 (a)  (b)  a + b + t λit + t yit
This is the basis for maximum likelihood estimation of β, a, and b.
In the linear model the total sample variability is split into between-group
variability and within-group variability, where variability is measured by sums
of squares. Hausman et al. attempt a similar decomposition for count data models, where sample variability is measured by the log-likelihood function. For
the Poisson model with gamma-distributed random effects, the log-likelihood

362

Longitudinal Data


of the iid P[λit ] can be decomposedas the sum of the conditional (on t yit )
log-likelihood and the marginal (for t yit ) log-likelihood. The conditional loglikelihood is naturally interpreted as measuring within variation; the marginal
log-likelihood
can be interpreted as measuring between variation, although it
depends on t λit , which depends on β, rather than on xi alone. A similar
decomposition for negative binomial is not as neat.
9.5.2

Gaussian Random Effects

An alternative random effects model is to allow the random effects to be
normally distributed. In these models it is standard to assume an exponential
conditional mean function. Thus for the Poisson model the data yit are assumed
to be iid P[exp(δ i + xit β)], where the random effect δ i is iid N[0, σ 2δ ] and
regressors xit here include an intercept. From (9.9) this model can be rewritten
as yit ∼ P[α i exp(xit β)], where α i = exp δ i ; it is therefore model (9.44) where
2
2
2
α i is lognormally distributed with mean eσ δ /2 and variance eσ δ /2 (eσ δ /2 − 1).
There is no analytical expression for the unconditional density (9.44) in this
case. One solution (Schall, 1991; McGilchrist, 1994) is to linearize the model
and use linear model techniques. A better alternative is to directly compute
the unconditional density by numerical integration, using Gaussian quadrature,
or by using simulation methods (Fahrmeir and Tutz, 2001, chapter 7). An
example, discussed further in Chapter 12.5.3, is given by Chib, Greenberg, and
Winkelmann (1998), who use a Markov-chain Monte Carlo scheme to simulate.
They apply their methods to epilepsy data from Diggle et al. (2002), patent data
from Hall et al. (1986), and German work absence data.
9.5.3

Random Coefficients Models

The random coefficients model with an exponential conditional mean sets λit =
exp(δ i + xit β i ), where both intercepts δ i and slopes β i are normally distributed,
independent of the regressors xit that here exclude an intercept. In practice
only a subset of the slopes are treated as random, to speed up computation if
numerical integration methods are used.
Given δ i ∼ N[δ, σ 2δ ] and β i ∼ N[0, β ], we have δ i + xit β i ∼ N[δ +

xit β, σ 2δ + xit β xit ]. It follows that
E[yit |xit ] = exp(δ + xit β) × exp((σ 2δ + xit

β xit )/2).

(9.48)

So, unlike for the linear model, the conditional mean for the random slopes
model differs from that for the pooled and random effects models, making
model comparison and interpretation more difficult.
This model falls in the class of generalized linear latent and mixed models;
see Skrondal and Rabe-Hesketh (2004). The likelihood now involves multidimensional integrals, rather than the univariate integral in the case of only
a random intercept. Numerical methods to approximate the MLE include

9.5 Random Effects Models

363

Gauss–Hermite quadrature, Laplace approximations, penalized quasilikelihood, and Markov chain Monte Carlo.
9.5.4

Conditionally Correlated Random Effects

The standard random effects panel model assumes that α i and xit are uncorrelated. Instead we can relax this and assume that they are conditionally correlated. This idea, originally developed in the context of a linear panel model by
Mundlak (1978) and Chamberlain (1982), can be interpreted as intermediate
between fixed and random effects. That is, if the correlation between α i and
the regressors can be controlled by adding some suitable sufficient statistic for
the regressors, then the remaining unobserved heterogeneity can be treated as
random and uncorrelated with the regressors. Although in principle we may
introduce a subset of regressors, in practice it is more parsimonious to introduce
time-averaged values of time-varying regressors.
The conditionally correlated random (CCR) effects model specifies that α i
in (9.8) can be modeled as
α i = exp(x̄i λ + ε i ),

(9.49)

where x̄i denotes the time average of the time-varying exogenous variables and
εi may be interpreted as unobserved heterogeneity that is uncorrelated with the
regressors. Substituting (9.49) into (9.8) yields
E[yit |xi1 , . . . , xiT , α i ] = exp(xit β + x̄i λ + ε i ).

(9.50)

This can be estimated using standard random effects model software, with x̄i
as an additional regressor. For example, if exp(εi ) is gamma distributed then
we can use the Poisson-gamma random effects model. Alternatively, pooled
Poisson or GEE estimation can be performed, again with x̄i as an additional
regressor. This formulation may also be used when dynamics are present in the
model.
Because the CCR formulation is intermediate between the FE and RE
models, it may serve as a useful substitute for not being able to deal with
fixed effects in some specifications. For example, a panel version of the hurdle
model with fixed effects is rarely used because the fixed effects cannot be easily
eliminated. In such a case the CCR specification is feasible.
9.5.5

Example: Patents (Continued)

Table 9.3 provides estimates of several different random effects estimators.
Panel-robust standard errors are obtained using a cluster bootstrap with clustering on the individual and 400 replications or using a cluster jackknife.
The Poisson-gamma and Poisson-normal random effects estimates and standard errors are very close to each other. The NB2 random effects estimates are
estimated somewhat more precisely, and the log-likelihood is considerably
higher. These random effects model estimates are closest to the Poisson GEE

364

Longitudinal Data

Table 9.3. Patents: Random effects estimates
Poisson RE
(gamma effects)
Variable Coefficient

Poisson RE
(normal effects)

NB2 RE
(beta effects)

Poisson CCRE
(gamma effects)

Standard
Standard
Standard
Standard
error Coefficient error Coefficient error Coefficient error

ln R0
0.404
0.081
ln R−1
−0.046
0.077
ln R−2
0.108
0.064
ln R−3
0.030
0.084
ln R−4
0.011
0.067
0.041
0.076
ln R−5
ln SIZE
0.292
0.077
DSCI
0.257
0.136
Sum ln R
0.546
0.094
lnL
−5,234

0.415
0.078
−0.040
0.074
0.112
0.065
0.035
0.089
0.013
0.067
0.047
0.080
0.292
0.083
0.444
0.153
0.582
0.098
−5,245

0.350
0.072
−0.003
0.072
0.105
0.058
0.016
0.077
0.036
0.059
0.072
0.061
0.162
0.054
0.118
0.139
0.577
0.070
−4,949

0.322
0.090
−0.087
0.076
0.079
0.065
0.000
0.082
−0.005
0.070
0.002
0.080
0.062
0.060
−0.049
0.121
0.312
0.145
−5,212

Note: Poisson CCRE is conditionally correlated random effects. All standard errors are panelrobust standard errors that cluster on the individual. All models include four time dummies for the
years 1976–1979, and random effects variance parameters that are not reported.

estimates in Table 9.2, though GEE has smaller standard errors in this application. The sum of current and lagged R&D is now higher, ranging from 0.55
to 0.58.
The final estimates given in Table 9.3 are for the Poisson conditionally
correlated effects model. It additionally includes as regressors the individual
averages over the five years of lnR0 , . . . , lnR−5 , whose coefficients are omitted
from the table. The estimates and standard errors are remarkably close to those
for the Poisson fixed effects estimator given in Table 9.2.
9.6 DISCUSSION
Moment-based methods can more generally be used for all models with multiplicative individual effects as in (9.10). The fixed effects model can be generalized from linear models to count data models. The conditional maximum
likelihood approach leads to tractable results for some count models – for
example, for the Poisson (9.39) that simplifies to (9.40) – but not for all count
data models. The random effects model can also be used in a wide range of
settings. The maximum likelihood approach is generally computationally difficult, unless a model with conjugate density for the random effects, such as
Poisson-gamma, is used.
9.6.1

Fixed versus Random Effects

The strengths and weaknesses of fixed effects versus random effects models in
the linear case carry over to nonlinear models. For the linear model a considerable literature exists on the difference between fixed and random effects; see,

9.6 Discussion

365

in particular, Mundlak (1978) and a summary by Hsiao (2003). The random
effects model is appropriate if the sample is drawn from a population and one
wants to do inference on the population; the fixed effects model is appropriate
if one wishes to confine oneself to explaining the sample. The random effects
model more easily accommodates random slope parameters as well as random
intercepts. For the fixed effects model, coefficients of time-invariant regressors
are absorbed into the individual-specific effect α i and are not identified. For
the random effects model, coefficient estimates are inconsistent if the random
effects are correlated with regressors. A test of correlation with regressors is
presented in section 9.7.1.
We have focused on individual fixed effects in a short panel. Time-specific
effects can additionally be included to form a two-way fixed effects errorcomponent model. This can be estimated using conditional maximum likelihood as outlined previously, where the regressors xit include time dummies.
The results can clearly be modified to apply to a long panel with
few individuals. Conditional maximum likelihood would then condition on i yit , where,
for example, yit is iid P[α t λit ].
9.6.2

Applications

References to count applications outside economics are given in Diggle et al.
(2002) and Fahrmeir and Tutz (2001). Many of these applications use random
effects models with Gaussian effects or use the generalized estimating equations
approach of Liang and Zeger (1986). Here we focus on economics applications,
which generally use the fixed effects models or random effects models with
conjugate density for the random effects.
The paper by Hausman, Hall, and Griliches (1984) includes a substantial
application to the number of patents for 121 U.S. firms observed from 1968
through 1975. This paper estimates Poisson and NB models with both fixed
and random effects. Other studies using patent data are discussed in section
9.8.4.
Ruser (1991) studies the number of workdays lost at 2,788 manufacturing
establishments from 1979 through 1984. He uses the NB fixed effects estimator
and finds that the number of workdays lost increases as workers’ compensation
benefits increase, with most of the effect occurring in smaller establishments
whose workers’ compensation insurance premiums are less experience-rated.
Blonigen (1997) applies the NB2 random effects model to data on the
number of Japanese acquisitions in the United States across 365 three-digit
Standard Industry Classification industries from 1975 through 1992. The paper
finds that if the U.S. dollar is weak relative to the Japanese yen, Japanese
acquisitions increase in industries that are more likely to involve firm-specific
assets, notably high R&D manufacturing sectors, which can generate a return
in yen without involving a currency transaction.
In a novel application, Page (1995) applies the Poisson fixed effects model
to data on the number of housing units shown by housing agents to each of two

366

Longitudinal Data

paired auditors, where the two auditors are as much as possible identical except
that one auditor is from a minority group and the other is not. Specifically
black/white pairs and Hispanic/Anglo pairs are considered. Here the subscript
i refers to a specific auditor pair, i = 1, . . . , n; subscript t = 1, 2 refers to
whether the auditor is minority (say t = 1) or nonminority (say t = 2). A
simple model without covariates is that E[yit ] = α i exp(βdit ), where dit = 1 if
minority and equals 0 otherwise. Then exp(β) equals the ratio of populationmean housing units shown to minority auditors to those shown to nonminority
auditors, and exp(β) < 1 indicates discrimination is present. Page shows that
in this case the Poisson fixed effects conditional MLE has explicit solution
exp(β̂) = ȳ1 /ȳ2 . For the data studied by Page (1995) exp(β̂) lies between 0.82
and 0.91, with robust standard errors using (9.34) of between 0.022 and 0.028.
Thus discrimination is present. Further analysis includes regressors that might
explain the aggregate difference in the number of housing units shown.
Van Duijn and Böckenholt (1995) analyze the number of spelling errors by
721 first-grade pupils on each of four dictation tests. They consider a Poissongamma mixture model that leads to a conditional multinomial distribution. It
does not adequately model overdispersion, so they consider a finite mixtures
version of this model, using the methods of Chapter 4.8. On the basis of chisquare goodness-of-fit tests, they prefer a model with two classes, essentially
good spellers and poor spellers.
Pinquet (1997) uses estimates of individual effects from longitudinal models
of the number and severity of insurance claims to determine “bonus-malus”
coefficients used in experience-rated insurance. In addition to an application
to an unbalanced panel of more than 100,000 policyholders, the paper gives
considerable discussion of discrimination between true and apparent contagion.
A range of models, including the random effects model of section 9.5, is
considered.
9.7 SPECIFICATION TESTS
If fixed effects are present then random effects estimators are inconsistent. For
those count models, notably Poisson and NB1, for which consistent estimation
of β is possible in the presence of fixed effects, the need for fixed effects
estimation can be tested using a Hausman test, presented in section 9.7.1.
If there is correlation over time for a given individual, then the estimators
presented in sections 9.3 to 9.5 remain consistent if regressors are strictly
exogenous, but there may be efficiency gains in modeling the correlation. Tests
for correlation are given in section 9.7.2.
9.7.1

Fixed versus Random Effects

The random effects estimator assumes that α i in (9.8) is iid distributed, which in
particular implies that the random effects are uncorrelated with the regressors.
Thus it is assumed that individual-specific unobservables are uncorrelated with

9.7 Specification Tests

367

individual-specific observables, which is a strong assumption. The fixed effects
model makes no such assumption, and α i could be determined by individualspecific time-invariant regressors.
If the random effects model is correctly specified, then both fixed and random
effects estimators are consistent, whereas if the random effects are correlated
with regressors the random effects estimator loses its consistency. The difference between the two estimators can therefore be used as the basis for a
Hausman test, introduced in Chapter 5.6.6, based on
)
*−1
β FE − β̂ RE ]
β FE ) V̂[
(β̂ RE − 
β FE ).
(9.51)
TH = (β̂ RE − 
If TH < χ 2α (dim(β)) then at significance level α, we do not reject the null
hypothesis that the individual-specific effects are uncorrelated with regressors.
In that case there is no need for fixed effects estimation.
The challenge is to construct V̂[
β FE − β̂ RE ], a consistent estimate of the variance of (
β FE − β̂ RE ). Under the assumption that β̂ RE is fully efficient, Hausman
(1978) shows that we can use V̂[
β FE ] − V̂[β̂ RE ], since then the variance of the
difference is the difference of the variances. But modern econometric analysis emphasizes inference under weaker distributional assumptions than those
needed for the MLE to be fully efficient. For example, full efficiency of the
Poisson-gamma random effects estimator requires that the gamma-distributed
α i soaks up all the overdispersion and correlation in the data. In fact, for the
Poisson-gamma example in Table 9.3, the reported panel-robust standard errors
are 60% larger than default ML standard errors that impose the information
matrix equality.
For short panels a panel bootstrap that resamples over individuals can be
used. Then
B
 (b)

1  (b)


(9.52)
V̂[β FE − β̂ RE ] =
β FE − β̂ (b)
β FE − β̂ (b)
RE
RE ,
B − 1 b=1
th
where 
β FE and β̂ (b)
of B bootstrap
RE are the estimates obtained from the b
replications. Note that resampling here is over i and not (i, t). Furthermore,
care is needed in doing this bootstrap in the presence of fixed effects – if the same
(b)
observation i appears twice in a bootstrap resample, then 
β FE needs to treat
the fixed effect α i as being the same for both observations i. An alternative is a
cluster leave-one-out-jackknife that does not have this complication. In practice
for short panel count data a Hausman test is applied to a Poisson model, since
there is then an estimator 
β FE consistent for β, using the bootstrap variance
matrix estimate in (9.52).
(b)

9.7.2

Tests for Serial Correlation

Tests for serial correlation are considered by Hausman et al. (1984). If individual
effects are present, then models that ignore such effects will have residuals that
are serially correlated. If this serial correlation disappears after controlling for

368

Longitudinal Data

individual effects, then time-series methods introduced in section 9.8 are not
needed. We consider in turn tests for these two situations.
The natural model for the initial analysis of count longitudinal data is Poisson regression of yit on xit , where independence is assumed over both i and t.
Residuals from this regression are serially correlated if in fact individual effects
α i are present. Furthermore, the serial correlation between residuals from periods t and s is approximately constant in (t − s), because it is induced by α i
which is constant over time. It is natural to base
√ tests on standardized residuals
such as the Pearson residual εit = (yit − λit )/ λit . Then we expect
!correla! the
 2

2
tion coefficient between εit and εis , estimated as i εit ε is /
i ε it
i ε is ,
to equal zero, t = s, if individual effects are not present. In practice these
correlations are often sufficiently large that a formal test is unnecessary.
If models with individual effects are estimated, the methods yield consistent estimates of β but not α i . Thus residuals yit − α i λit cannot be readily computed and tested forthe lack of serial correlation. For the fixed
with probability
effects Poisson,

 yi1 , . . . , yiT | t yit is multinomial-distributed
λ
/
λ
.
It
follows
that
y
has
mean
p
y
and
variance
pit (1 −
pit =
it
it
s is
s is

 it
pit ) s yis , and the covariance6between yit and yis is −pit pis s yis . The resid



2
ual uit = yit − pit s yis /
s yis therefore satisfies E[uit ] = (1 − pit )pit
and E[uit uis ] = −pit pis , t = s. Hausman, Hall, and Griliches (1984) propose
a conditional moment test based on these moment conditions, where one of the
residuals is dropped because predicted probabilities sum to one.
For dynamic longitudinal model applications discussed in section 9.8, it is
necessary to implement tests of serial correlation to ensure estimator consistency. Blundell, Griffith, and Windmeijer (2002) adapt serial correlation tests
proposed by Arellano and Bond (1991) for the linear model. Crepon and Duguet
(1997a) and Brännäs and Johansson (1996) apply serial correlation tests in the
GMM framework.
9.8 DYNAMIC LONGITUDINAL MODELS
The preceding models introduce time variation only through exogenous regressors that may vary over time. These regressors can include functions of time,
such as a quadratic in time, and, for short panels, a time dummy for each
period. Estimation of a semiparametric model for the conditional mean of form
γ (t) exp(x β), with γ (·) unspecified, is presented in Wellner and Zhang (2007).
In this section we consider dynamic or transition longitudinal models that
allow current realizations of the count yit to depend on past realizations yi,t−k ,
k > 0, where yi,t−k is the realization for individual i in period t − k.
An example with one lag is
(t−1)
, α i ] = α i λit = α i exp(ρyi,t−1 + xit β),
E[yit |X(t)
i , Yi

(9.53)

(t−1)
= (yi,t−1 , yi,t−2 , . . . , yi1 ). This is
where X(t)
i = (xit , xi,t−1 , . . . , xi1 ) and Yi
an autoregressive model like that studied in Chapter 7.5, except here the data

9.8 Dynamic Longitudinal Models

369

are short panel data with asymptotics in n → ∞ rather than T → ∞, and an
individual effect α i may be present.
We consider in turn alternative functional specifications for how yit−1 enters
λit , pooled models where α i = α, fixed effects models for α i , and random
effects models for α i . But first we review qualitatively similar results for the
linear model.
9.8.1

Some Approaches

Consider the linear dynamic model with individual specific effect
yit = α i + ρyit,t−1 + xit β + uit .

(9.54)

Then yit may be autocorrelated over time through ρ = 0 (true state dependence), through α i (unobserved heterogeneity), through autocorrelation in xit
(observed heterogeneity), or through autocorrelation in uit .
In the simplest model α i = α. Then OLS regression of yit on an intercept,
yit,t−1 and xit yields consistent parameter estimates, provided the error uit is
serially uncorrelated. If instead uit is serially correlated then sufficient further
lags of yit need to be included in the regression to ensure uit is serially uncorrelated. Alternatively if uit is MA(q) then yi,t−q−1 , and later lags, can be used
as instrument(s) for yi,t−1 .
When α i is a fixed effect then the standard within estimator is inconsistent,
as discussed, for example, in Nickell (1981), Hsiao (2003), and Baltagi (2008).
In the simplest case with yi,t−1 the only regressor, so β = 0 in (9.54), the
mean-differenced model (9.5) is
(yit − ȳi ) = ρ(yi,t−1 − ȳi,−1 ) + (uit − ūi ),
1 T
where ȳi,−1 = T −1
t=2 yi,t−1 . OLS estimation for finite T leads to an inconsistent estimate of ρ because the regressor (yi,t−1 − y i,−1 ) is correlated with ūi
(to see this, lag the preceding equation by one period) and hence is correlated
with the error term (uit − ūi ). This inconsistency disappears as T → ∞, since
then ūi is a small component of (uit − ūi ). For small T , however, there is a
problem. Instead estimation can be based on the first-differenced model (9.6)
that here is
(yit − yi,t−1 ) = ρ(yi,t−1 − yi,t−2 ) + (uit − ui,t−1 ).
OLS estimation is again inconsistent. A consistent estimate of ρ can be obtained
by instrumental variables methods, using for example (yi,t−2 − yi,t−3 ) or yi,t−2
as an instrument for (yi,t−1 − yi,t−2 ), provided uit is serially uncorrelated. If
instead uit is serially correlated then the method needs to be adjusted for the
addition of sufficient further lags of yit to ensure that uit is serially uncorrelated,
or for uit being an MA(q) error. A considerable literature has developed on
increasing the efficiency of such moment-based estimators and testing for error
correlation; see especially Arellano and Bond (1991).

370

Longitudinal Data

When α i is a random effect, a distribution is specified for α i , estimation is
by ML, and consistency depends crucially on assumptions regarding starting
values.
9.8.2

Alternative Specifications for Dynamic Models

As noted in Chapters 7.5 and 7.6 there are various ways that lagged dependent
variables may be included in the conditional mean. Similar issues arise here in
modeling
(t−1)
, α i ],
μit = E[yit |X(t)
i , Yi

(9.55)

which for individual i conditions on current xit , past values of xit and yit , and
the individual effect α i . For simplicity we consider models where μit depends
on just the first lag of yit .
The obvious specification is an exponential feedback model (EFM) with
μit = α i exp(ρyi,t−1 + xit β).

(9.56)

As noted at the beginning of Chapter 7.5, this model is explosive for ρ > 0 since
then ρyit−1 ≥ 0 because the count y is nonnegative. Also, this specification
introduces potentially sharp discontinuities that may result in a poor fit to the
data, especially when the range of counts is very wide as in the patents data
application of section 9.4.5. A less explosive model instead uses ρ ln yi,t−1
in (9.56), but then an ad hoc adjustment needs to be used when yi,t−1 = 0;
see Chapter 7.5.1. The dynamic panel literature has emphasized alternative
functional forms that we now present.
Blundell, Griffith, and Windmeijer (2002) propose a linear feedback model
(LFM)
μit = ρyi,t−1 + α i exp(xit β),

(9.57)

where the lagged value enters linearly. This formulation avoids awkward discontinuities, and the additive form is that of a Poisson INAR(1) model; see
Chapter 7.6.
Crepon and Duguet (1997a) propose the alternative model
μit = h(yi,t−1 , γ )α i exp(xit β),

(9.58)

where the function h(yit−1 , γ ) parameterizes the dependence on lagged values
of yit . A simple example is h(yi,t−1 , γ ) = exp(γ 1[yi,t−1 > 0]), where 1[·] is
the indicator function. More generally a set of dummies determined by ranges
taken by yit−1 might be specified.
9.8.3

Pooled Dynamic Models

One approach is to ignore the panel nature of the data. Simply assume that
all regression coefficients are the same across individuals, so that there are no
individual-specific fixed or random effects. Then one can directly apply the time

9.8 Dynamic Longitudinal Models

371

series methods presented in Chapter 7, even for small T provided n → ∞. This
approach is given in Diggle et al. (2002, chapter 10), who use autoregressive
models that directly include yi,t−k as regressors. The discussion in section 9.8.2
on functional form is relevant here. Also Brännäs (1995a) briefly discusses a
generalization of the INAR(1) time-series model to longitudinal data.
For the specifications given in section 9.8.2 a pooled or population-averaged
approach considers estimation ignoring individual effects, so α i = α. Under
weak exogeneity of regressors, which requires that there is no serial correlation
in (yit − μit ), the models can be estimated by nonlinear least squares (or GEE)
or by method
of moments or GMM estimation based on the sample moment
 
condition i t zit (yit − μit ), where zit can include yi,t−1 and xit and, if
desired, additional lags in these variables.
Pooling may be adequate. In particular, lagged values of the dependent
variable might be an excellent control for correlation between yit and lagged
yit , so that there is no need to include individual-specific effects. For example,
the firm-specific propensity to patent might be adequately controlled for simply
by including patents last year as a regressor. As in the linear case, however,
estimator consistency requires that sufficient lags in yit are included to ensure
there is no remaining serial correlation.
Currently the published literature does not provide detailed comparative
information on the performance of the available estimators for dynamic panels.
Their development is in early stages, and not surprisingly we are unaware of
commercial software to handle such models. However, the relative ease of
interpretation favors the EFM over the LFM assumption, and the explosiveness
of EFM is not a problem in short panel applications with T small.
9.8.4

Fixed Effects Dynamic Models

The methods to eliminate fixed effects given in section 9.4 require that regressors are strictly exogenous, that is,
)
E[yit |X(T
i ] = E[yit |xiT , . . . , xi1 ] = α i λit ,

(9.59)

where usually λit = exp(xit β). Defining uit = yit − α i λit , (9.59) implies
E[uit |xiT , . . . , xi1 ] = 0 and hence E[uit |xis ] = 0 for all s.
This rules out predetermined regressors that may be correlated with past
shocks, though are still uncorrelated with current and future shocks. To allow
for predetermined regressors, we make the weaker assumption that regressors
are weakly exogenous, or
E[yit |X(t)
i ] = E[yit |xit , . . . , xi1 ] = α i λit ,

(9.60)

where now conditioning is only on current and past regressors. Then
E[uit |xis ] = 0 for s ≤ t, so future shocks are indeed uncorrelated with current x, but there is no restriction that E[uit |xis ] = 0 for s > t.

372

Longitudinal Data

For dynamic models in which lagged dependent variables also appear as
regressors this condition becomes
(t−1)
] = E[yit |xit , . . . , xi1 , yi,t−1 , . . . , yi1 ] = α i λit , (9.61)
E[yit |X(t)
i , Yi

where conditioning is now also on past values of yit . For the linear feedback
model α i λit in (9.61) is replaced by ρyi,t−1 + α i λit .
If regressors are predetermined then the Poisson fixed effects estimator
is inconsistent. This result is analogous to the inconsistency of the withinor mean-differenced fixed effects estimator in the linear model discussed in
section 9.8.1. The problem is that quasidifferencing subtracts (λit /λ̄i )ȳi from
future values yis , s > t. Condition (9.60) is not
yit , see (9.29), but ȳi includes

enough to ensure E[ T1 Tt=1 yit |xiT , . . . , xi1 ] = α i λ̄i .
The solution is to instead use nonlinear instrumental variables or GMM
estimation based on one of several possible variations of the first-differencing
used for the dynamic linear model. Given (9.60), Chamberlain (1992b) proposes
eliminating the fixed effects α i by the transformation
qit (θ) =

λi,t−1
yit − yi,t−1 ,
λit

(9.62)

where λit = λit (θ). Wooldridge (1997a) instead proposes eliminating the fixed
effects using
yi,t−1
yit
−
.
(9.63)
qit (θ) =
λi,t−1
λit
See section 9.11.3 for justification of these moment conditions.
For predetermined regressors it is shown in section 9.11 that there exist
instruments zit that satisfy
E[qit (θ)|zit ] = 0,

(9.64)

for qit (θ) defined in (9.62) or (9.63), where zit can be drawn from
xi,t−1 , xi,t−2 , . . . In dynamic models with lags up to yi,t−p appearing as regressors, zit can be drawn from yi,t−p−1 , yi,t−p−2 , . . . . Often p = 1 and the available
instruments are yi,t−2 , yi,t−3 , . . . .
In the just-identified case in which there are as many instruments as parameters, the method of moments estimator solves
n 
T


zit qit (θ ) = 0.

(9.65)

i=1 t=1

If there are more instruments zit than regressors, such as through adding additional lags of regressors into the instrument set (potentially all the way back to
xi1 ), one can consistently estimate θ by the GMM estimator that minimizes
 n T


 n T


zit qit (θ) Wn
zit qit (θ) .
(9.66)
i=1 t=1

i=1 t=1

9.8 Dynamic Longitudinal Models

373

The
with hi (θ) =
T GMM results of section 9.2.3 can be applied directly,

−1
z
q
(θ).
One-step
GMM
typically
uses
W
=
(Z
Z)
,
whereas
more
it
it
n
t=1
efficient two-step GMM uses Wn = Ŝ−1 where Ŝ is defined in (9.18). Another
possibility is continuously updated GMM.
Given two-step GMM, model adequacy can be tested using the overidentifying restrictions test given in Chapter 2.5.3. It is also important to test for serial
correlation in qit (θ) using qit (θ̂), because correct model specification requires
that Cor[qit (θ), qis (θ)] = 0 for |t − s| > 1. These tests are analogous to those
following Arellano-Bond estimation of the linear dynamic fixed effects model.
Windmeijer (2008) provides a good survey of GMM methods for the Poisson panel model, including models with regressors that are predetermined,
lagged dependent variables, or endogenous. One issue is that two-step GMM
estimated coefficients and standard errors can be biased in finite samples.
Windmeijer (2008) proposes an extension of the variance matrix estimate of
Windmeijer (2005) to nonlinear models and shows in a Monte Carlo exercise
with a predetermined regressor that this approach leads to improved finite sample inference, as does the Newey and Windmeijer (2009) method applied to the
continuous updating estimator variant of GMM.
Table 9.4 presents a summary of moment conditions and estimating equations for some of the leading panel count data estimators.
Blundell, Griffith, and Windmeijer (2002) propose an alternative transformation, the mean scaling transformation,
qit = yit −

y i0
λit ,
λi0

(9.67)

where y i0 is the presample mean value of yi and the instruments are (xit − xi0 ).
This transformation leads to inconsistent estimation, but in a simulation this
inconsistency is shown to be small, efficiency is considerably improved, and
the estimator is especially useful if data on the dependent variable go back
farther in time than data on the explanatory variables.
Blundell, Griffith, and Windmeijer (2002) model the U.S. patents data of
Hall, Griliches, and Hausman (1986). Application to patents is of particular
interest, because for several reasons there are few ways to measure innovation
aside from patents and patents are intrinsically a count. R&D expenditures
affect patents with a considerable lag, so there is potentially parsimony and
elimination of multicollinearity in having patents depend on lagged patents,
rather than having a long distributed lag in R&D expenditures. And, as noted
in the example earlier, most studies using distributed lags on R&D expenditure
find the R&D expenditure elasticity of patents to be much less than unity.
Blundell and colleagues pay particular attention to the functional form for
dynamics and the time-series implications of various functional forms. In their
application up to two lags of patents and three lags of R&D expenditures
appear as regressors. The estimates indicate long lags in the response of patents
to R&D expenditures.

374

Longitudinal Data

Table 9.4. Moment conditions for selected panel count models
Model

Moment and/or
model specification

Pooled
Poisson

E[yit |xit ] = μit ;
μit = exp(xit β).

Population
averaged

Same as pooled Poisson.

Estimating
Equations


 
i
t xit yit − μit = 0.


γ̂ st μit xit yit − μit = 0;
γ̂ is (s, t) element of (V̂[yi |xi ])−1 .

 
ȳi +δ/T
= 0;
i
t xit yit − λit λ̄i +δ/T


ȳi = T1 t yit ; μi = T1 t exp(xit β).
  
i
st

s

t

th

Poisson RE

E[yit |α i , xit ] = α i λit ;

(gamma
effects)

λit = exp(xit β);
α i ∼ Gamma[1, 1/δ].

Poisson FE

Same mean as Poisson RE

Chamberlain

Cor[α i , xit ] = 0 possible.
*
)
= 0;
− yit−1 |X(t−1)
E yit λλit−1
i
it

λi =
 

yit = α i λit + uit ;
E[uit |X(t−1)
] = 0.
i
*
)
= 0;
E λyitit − λyit−1
|X(t−1)
i
it−1

zit is subset of X(t−1)
i

GMM

yit = α i λit uit ;
E[uit |X(t−1)
] = 0.
i

zit is subset of

Dynamic FE
(linear
feedback)

E[yit |α i , yi,t−1 , xit ]
= ρyit−1 + α i λit ;
λit = exp(xit β)

GMM

Wooldridge

 
i

i

t
1
T
t

 
i

t

xit yit − λit λȳi
i


t exp(xit β).



= 0;


zit yit λλit−1
− yit−1 = 0;
it

zit

yit
λit

yit−1
λit−1
X(t−1)
.
i

−



= 0;

 

it
zit (yit − ρyit−1 ) λλit−1
−(yit−1 − ρyit−2 )) = 0;
zit is subset of X(t−1)
, Y(t−2)
.
i
i

i

t

Note: The Chamberlain and Wooldridge GMM estimators are for predetermined regressors and
(t−1)
(t−2)
Xi
= (xit−1 , xit−2 , . . .) and Yi
= (yit−2 , yit−3 , . . .). Estimating equations for GMM estimators and linear feedback are written for the just-identified case. For overidentified models the
estimator minimizes a quadratic form in the expression given in the final column of the table.

Related studies by Blundell, Griffith, and Van Reenan (1995, 1999) model
the number of ‘technologically significant and commercially important’ innovations commercialized by British firms. Dynamics are introduced more simply by including the lagged value of the knowledge stock, an exponentially
weighted sum of past innovations.
Montalvo (1997) uses the Chamberlain (1992b) transformation to model the
number of licensing agreements by individual Japanese firms and to analyze the
Hall et al. (1986) data. Lagged dependent variables do not appear as regressors.
Instead Montalvo argues that current R&D expenditures cannot be assumed
to be strictly exogenous because patents depend on additional R&D expenditures for their full development. So there is still a need for quasidifferenced
estimators.

9.8 Dynamic Longitudinal Models

375

Crepon and Duguet (1997a) apply GMM methods to French patents data.
They also use a relatively simple functional form for dynamics. First, as regressor they use a measure of R&D capital. This capital measure is calculated as
the weighted sum of current and past depreciated R&D expenditure and can
be viewed as imposing constraints on R&D coefficients in a distributed lag
model. Dynamics in patents are introduced by including indicator variables for
whether yit−1 is in the ranges 1 to 5, 6 to 10, or 11 or more. Particular attention
is paid to model specification testing and the impact of increasing the size of
the instrument set zit in (9.66).
In a more applied study, Cincera (1997) includes not only a distributed lag
in firm R&D expenditures but also a distributed lag in R&D expenditures by
other firms in the same sector to capture spillover effects. Application is to a
panel of 181 manufacturing firms from six countries.
Hill, Rothchild, and Cameron (1998) model the monthly incidence of
protests using data from 17 Western countries for 35 years. To control for
overdispersion and dynamics, they use a negative binomial model with lagged
yit appearing as ln(yi,t−1 + c), where c is a constant whose role was explained
in Chapter 7.5. Country-specific effects are additionally controlled for by inclusion of country-specific indicator variables. This poses no consistency problems
in this example where T → ∞, so the GMM methods of this section are not
needed.
9.8.5

Random Effects Dynamic Models

The obvious dynamic version of a random effects model for counts is to use the
same models as presented in section 9.5, with lagged yit added as a regressor as
in section 9.8.2. In a short panel, however, initial conditions play an important
role in the evolution of the outcome, and we may expect the initial condition
yi0 to be correlated with the individual-specific effect α i . For a given individual
the initial condition is a time-invariant factor that in the preceding fixed effects
dynamic models is swept out along with other time-invariant variables. But
in a random effects model it is important to control for the initial condition.
Heckman (1981) and Wooldridge (2005) propose approaches for correlating
α i and yi0 .
Heckman (1981) writes the joint distribution of yi0 , yi1 , . . . , yiT |xit as
)
*
)
Pr yi0, yi1 , . . . , yiT |X(T
i
)
(T )
(T )
= Pr[yi1 , . . . , yiT |X(T
i , yi0 , α i ] Pr[yi0 |Xi , α i ] Pr[α i |Xi ].

(9.68)

To implement this requires specification of the functional forms Pr[yi0 |xit , α i ]
and Pr[α i |xit ]. Furthermore, numerical integration may be necessary if the
convolution does not have a closed-form solution.

376

Longitudinal Data

Wooldridge (2005) instead proposes a conditional approach based on the
decomposition
*
)
)
)
(T )
,
y
= Pr[yi1 , . . . , yiT |X(T
Pr yi0, yi1 , . . . , yiT |X(T
i0
i
i , yi0 , α i ] Pr[α i |yi0, Xi ],
(9.69)
which does away with having to specify the distribution of the initial condition
yi0 . Under the assumption that the initial conditions are nonrandom, the standard
random effects ML approach, with yi0 a regressor, identifies the parameters
of interest. Wooldridge (2005) analyzes this model for a class of nonlinear
dynamic panel models that includes the Poisson model.
Estimation of a dynamic panel model requires additional assumptions about
the relationship between the initial observations y0 and the α i . This can be
easily done using the CCR model (9.49), with yi0 added as an extra control.
Then
α i = exp(δ 0 yi0 + x̄i λ + ε i ),

(9.70)

where x̄i denotes the time average of the time-varying exogenous variables, and
ε i is an iid random variable. This specification jointly controls for the initial
condition and makes the Mundlak correction. Conditional ML estimation treats
the initial condition yi0 as given and can be implemented using the same software as for the regular random effects model. The alternative Heckman (1981)
approach in (9.68) of taking the initial condition as random, specifying a distribution for yi0 , and then integrating out is computationally more demanding;
see Stewart (2007).
9.8.6

Example: Patents (Continued)

Table 9.5 reports results for some dynamic count models. The lagged dependent
variable PAT t−1 is included using the exponential feedback mechanism (9.56).
Because this captures in part the longer term dynamic impact of past R&D
expenditure, the specification is simplified by including only ln R, ln R−1 , and
ln R−2 . Throughout it is assumed that the models specify sufficient dynamics
that the errors yit − μit are serially uncorrelated.
The first two estimators are pooled estimators, and there is considerable
efficiency gain in using GEE with equicorrelated errors. The third estimator is
the usual random effects estimator, which here is a bit less efficient than GEE.
Table 9.6 presents methods that control for richer models of the individualspecific effects. A simple method is to use the correlated random effects
approach of section 9.8.5, including as additional regressors PAT at initial
period 0 and the individual averages over the five years of lnR0 , . . . , lnR−2 ,
whose coefficients are omitted from the table. The regressor PAT INITIAL is
highly statistically significant.

9.8 Dynamic Longitudinal Models

377

Table 9.5. Patents: Dynamic model pooled and random effects estimates
Pooled GEE
Poisson

Pooled Poisson
Variable

Coefficient

PAT−1
ln R0
ln R−1
ln R−2
ln SIZE
DSCI
Sum ln R
lnL

Standard
error

0.0034
0.0006
0.359
0.144
−0.159
0.100
0.133
0.139
0.183
0.046
0.289
0.135
0.333
0.062
−14717

Poisson RE
(gamma effects)

Coefficient

Standard
error

0.0019
0.379
−0.080
0.078
0.222
0.371
0.376

0.0003
0.066
0.074
0.059
0.045
0.156
0.053

Coefficient

–

Standard
error

0.0013
0.0006
0.446
0.080
−0.060
0.090
0.103
0.066
0.300
0.055
0.281
0.116
0.490
0.066
−5188

Note: All standard errors are panel-robust standard errors that cluster on the individual. All models
include four time dummies for years 1976 to 1979, and random effects variance parameters that
are not reported.

Alternatively estimation can be by GMM as in section 9.8.4. We use as
instruments lnR−1 , lnR−2 , lnR−3 , PAT −2 , PAT −3 , and PAT −4 , so there are
two overidentifying restrictions. Because presample data are available in this
example, only one year of data is lost, estimation uses four years of data, and just
three year dummies are included. The reported estimates are two-step GMM
estimates based on the Chamberlain transformation (9.62). The coefficient
of PAT −1 is similar to that in the other models, whereas the coefficient on
Table 9.6. Patents: Dynamic model correlated effects estimates
Poisson CCRE
(gamma effects)
Variable
PAT−1
ln R0
ln R−1
ln R−2
ln SIZE
DSCI
PAT INITIAL
Sum ln R
lnL

Coefficient

Standard
error

0.0012
0.0006
0.341
0.087
−0.104
0.090
0.047
0.067
0.045
0.054
−0.040
0.113
0.05
0.001
0.284
0.096
−5157

Poisson fixed
effects GMM
Coefficient

Standard
error

−0.0001
0.300
−0.068
0.132
–
–
–
0.365

0.0015
0.800
0.110
0.078
–
–
–
0.796

Note: Poisson CCRE is conditionally correlated random effects. All standard errors are
panel-robust standard errors that cluster on the individual. All models include four time
dummies for years 1976 to 1979, and random effects variance parameters that are not
reported.

378

Longitudinal Data

lnR0 is large and negative, though imprecisely estimated. The overidentifying
restrictions test statistic is 4.13 (N = 1,384 times the GMM objective function
minimized value of 0.00298) compared to a χ 2 (2) critical value of 5.99 at level
0.05. The model is rejected at the 5% significance level, though not at the 10%
level. A more complete analysis should also check that the residuals from the
first-differenced model are not serially correlated beyond the first lag.
PAT −1 is statistically significant at level 0.05 in all cases except Poisson
fixed effects GMM. The coefficient is slightly greater than zero, so the model
is explosive though mildly so over a five-year period.
9.9 ENDOGENOUS REGRESSORS
In the linear case, estimation of models with endogenous regressors by IV and
GMM methods is well established, provided valid instruments are available.
For nonlinear models, such as count models, several distinct methods have been
proposed in the case of cross-section data. They are presented in sections 10.2
to 10.4. Despite a growing theoretical literature on nonparametric estimation
of simultaneous equations, the methods currently in use for counts rely greatly
on functional form specification, in addition to exclusion restrictions, and are
fragile to misspecification.
For panel data the same reliance on functional form specification arises,
one that may be further complicated by the need to model correlation across
time periods. At the same time, instruments are usually more readily available
since lags of exogenous regressors, if excluded from the original model, can
become available as instruments.
Here we simply consider moment-based nonlinear instrumental variables
or GMM methods, because they are the most commonly used methods for
panel count data with endogenous regressors. When there is no individual
effect, a pooled approach directly applies the GMM estimators of Chapter
10.4, with inference then based on panel-robust standard errors that cluster
on the individual. When there is an individual-specific fixed effect, the methods of section 9.8.4 can be adapted. The conditional mean of yit is specified
to be
μit = α i exp(xit β).

(9.71)

The problem is that one or more of the regressors in xit is endogenous, correlated
with the error, so that the standard Poisson fixed effects estimator is inconsistent.
From Chapter 10.4 the moment conditions to base estimation on vary according
to whether the error is defined to be additive or multiplicative. Windmeijer
(2000) shows that, in the panel case, the individual-specific fixed effects α i can
be eliminated only if a multiplicative errors specification is assumed and if the
Wooldridge transformation is used. Then nonlinear IV or GMM estimation is
based on qit (θ) defined in (9.63), where the instruments zit can be drawn from
xi,t−2 , xi,t−3 , . . . .

9.10 More Flexible Functional Forms for Longitudinal Data

379

9.10 MORE FLEXIBLE FUNCTIONAL FORMS FOR
LONGITUDINAL DATA
The fully parametric models presented in the preceding sections on panel
models have been panel versions of the Poisson or negative binomial. Elsewhere
in this book, and especially in Chapters 4 and 11, a case has been made that
more flexible functional forms, such as hurdle, zero-inflated, and finite mixtures
models, may be more appropriate in a fully parametric framework.
In this section we present some panel versions of these models. The models
are population-averaged or random effects models, with the exception of the
fixed effects model of Deb and Trivedi (2013) that is also presented.
9.10.1

Finite Mixture Longitudinal Models

Finite mixtures models for cross-section data are presented in section 4.8.
Bago d’Uva (2005) applies a finite mixture version of the negative binomial
model to panel data. Class membership is modeled as a multinomial logit
model with probabilities π ij (for individual i in class j ) that are functions
of time-invariant individual characteristics. Within each class the outcome of
doctor visits is modeled using a pooled NB2 grouped-data model for panel
data on doctor visits that are recorded in the ranges 0, 1–2, 3–5, 6–10, and
more than 10 visits, with all coefficients varying with the latent class. As in
the nonmixture case, the estimates are consistent if this pooled (or populationaveraged) panel data parametric model is correctly specified, though estimates
will be inconsistent if fixed effects are present.
Deb and Trivedi (2013) therefore propose a fixed effects Poisson version of
the finite mixture model. They assume
yit |xit , λj it , α j i ∼ P[α j i λj it ], j = 1, 2, . . . , C,

(9.72)

where j denotes the latent class, λj it = exp(xit β j ), π j is the probability of

being in the j th class, Cj=1 π j = 1, and here π j does not vary across individuals or over time. For each latent class j the fixed effects can be eliminated as
in section 9.4.2 to yield the concentrated likelihood function given in (9.38).
Combining across latent classes, the full-data concentrated log-likelihood is
Lconc (β, π 1 , . . . , π 1 ) ∝

n 
T 
C

i=1 t=1 j =1




πj

λj it

T

s=1

λj is

yj it dj i
, (9.73)

where dj i = 1 if individual i is in the j th class and equals zero otherwise.
The log-likelihood can be maximized after adapting the EM algorithm given
in Chapter 4.8. Given current estimates, the E-step estimates the unobserved dj i
by the current estimate ẑj i of its expected value E dj i , where ẑj i is the posterior
probability of the classification of individual i into class j . The M-step of the
EM procedure maximizes EL by maximizing with respect to β j and π 1 , . . . , π C

380

Longitudinal Data

the log-likelihood function based on (9.73) with dj i replaced by ẑj i . For crosssection data, likelihood maximization can use gradient
 methods based on the
marginal likelihood formed using the mixture density Cj=1 π j fj (yi |xi , θ j ), as
an alternative to using the EM algorithm. In the panel case, however, use of the
EM algorithm becomes essential. For additional details, see Deb and Trivedi
(2011), who apply their model to panel data on doctor office visits from six
waves of the Health and Retirement Study.
Böckenholt (1999) specifies a finite mixture dynamic panel model, a pooled
version of the Poisson INAR(1) presented in Chapter 7.6. Estimation is by the
EM algorithm. Application is to panel data on the frequency of weekly detergent
purchases by households, with class membership determined by household
demographic characteristics.
Applications of finite mixture models to cross-section data necessarily
assume that the latent class probabilities are time invariant. With panel data this
restriction can be relaxed, and in general the class membership probability π j it
may vary across individuals and over time. Using the random effect framework
within each latent class, Hyppolite and Trivedi (2012) develop a suite of mixture
models of increasing degrees of complexity and flexibility for use in a panel
count data setting. The baseline model is a two-component mixture of Poisson distributions with latent classes that are time invariant. The first extension
allows the mixing proportions to be smoothly varying continuous functions,
such as logit or probit models, of time-varying covariates. The second extension
accommodates at least two types of heterogeneity: heterogeneity with respect
to class membership and heterogeneity with respect to within-class differences
in individual characteristics by introducing additional random effects. A third
extension adds time dependence by modeling the class indicator variable as a
first-order Markov chain, as is done for the hidden Markov models described
in Chapter 7.8. The fourth model introduces dynamics and makes the transition
matrix covariate dependent. Hyppolite and Trivedi (2012) use dynamic versions of the mixture model to reanalyze the effect of 1996 health care reform
in Germany, using the German Socio-Economic Panel data originally analyzed
by Winkelmann (2004).
9.10.2

Hurdles and With-Zeroes Models

Several studies have proposed random effects or pooled finite mixtures versions
of hurdle and zero-inflated models.
Olsen and Schafer (2001) estimate a random effects version of the twopart or hurdle model for panel data, where the outcome is continuous rather
than a count once the hurdle is crossed. The hurdle probability is modeled
as a logit model with random intercept and possibly slopes, the continuous
response (or an appropriate transformation such as the natural logarithm) is
modeled as a linear model with random intercepts and possibly slopes and
a normally distributed error, and the random coefficients from the two parts
are assumed to be joint normal and possibly correlated. The authors discuss

9.11 Derivations

381

the computational challenges and favor use of a Laplace approximation to
evaluate the integral in the log-likelihood. Application is to longitudinal data
on adolescent consumption of alcohol.
Min and Agresti (2005) also consider a panel hurdle model, but one for
counts. The hurdle probability is a logit with random intercept, the count
response is modeled as Poisson or NB2 with random intercept, and the two
intercepts are assumed to be iid bivariate normal distributed. They also estimate
a finite mixture version of this hurdle model, as well as zero-inflated Poisson
models with random intercepts. Application is to the number of side-effect
episodes following drug treatment.
Bago d’Uva (2006) applies a finite mixture version of the hurdle model for
counts. Class membership is modeled with probabilities π j that do not vary
with individual characteristics. Within each class the outcome of doctor visits is
modeled using the negative binomial hurdle model of Chapter 4.5. The estimates
are consistent if the pooled (or population-averaged) panel model is correctly
specified, but will be inconsistent if fixed effects are present. Application is
to the annual number of outpatient visits using data from the Rand Health
Insurance Experiment.
9.11 DERIVATIONS
9.11.1

Conditional Density for Poisson Fixed Effects

Consider the conditional joint density for observations in all time periods for a
given individual, where for simplicity the
individual subscript i is dropped. In
general the density of y1 , . . . , yT given t yt is



Pr y1 , . . . , yT  t yt = Pr y1 , . . . , yT , t yt / Pr
t yt

= Pr [y1 , . . . , yT ] / Pr
t yt ,

where the last equality arises because knowledge of t yt adds nothing given
knowledge of y1 , . . . , yT .
Now specialize to y
t iid P[μt ].
Then Pr [y1 , . . . , yT ] is the product of T
Poisson densities, and t yt is P[ t μt ]. It follows that

 

exp(−μt )μt yt /yt !
t
Pr y1 , . . . , yT  t yt =
 t yt  

exp(− t μt )
/
t μt
t yt !
 yt 

exp(− t μt ) t μt / t yt !
=
yt  

 
exp(− t μt ) t
/
s μs
t yt !
 

yt
yt ! 
μ
 t
= t
.
×
t yt !
s μs
t
Introducing the subscript i yields (9.39) for Pr yi1 , . . . , yiT |


t

yit .

382

Longitudinal Data

9.11.2

Density for Poisson with Gamma Random Effects

Consider the joint density for observations in all time periods for a given
individual, where for simplicity the individual subscript i is dropped. From
(9.44) the joint density of y1 , . . . , yT if yt |α is P[αλt ] is

 ∞ 
 −αλt

yt
e
(αλt ) /yt ! f (α)dα
Pr [y1 , . . . , yT ] =
0





∞

=

t



0



e−α

λt /yt !

t


=


yt





∞

λt /yt ! ×
yt


t

e−α

·α

λt


t

λt


t

·α

yt


f (α)dα


t

yt


f (α)dα.

0

t

Now let f (α) be the gamma density with E[α] = 1, V[α] = 1/δ. Similar algebra to that in Chapter 4.2.2 yields the Poisson random effects density given in
(9.45).
9.11.3

Moment Conditions for Dynamic Fixed Effects

We consider a model for yit with conditional mean α i λit where λit = λit (xit ) or,
more generally, λit = λit (xit , xit−1 , . . .), and α i is potentially correlated with
xit . Define the additive error
uit = yit − α i λit ,

(9.74)

so yit = α i λit + uit . The predetermined regressor is uncorrelated with current
and future shocks, so
E[uit |xit , xit−1 , . . .] = 0.

(9.75)

The Chamberlain transformation is
− yit−1 = (α i λit + uit ) λλit−1
− (α i λit−1 + uit−1 )
yit λλit−1
it
it
− α i λit−1 + uit−1
= α i λit−1 + uit λλit−1
it

(9.76)

= uit λλit−1
− uit−1 .
it
It follows that conditioning on past x’s only,
*
)
*
)
λit−1
−
u
|x
,
.
.
.
=
E
u
|x
,
.
.
.
− E [uit−1 |xit−1 , . . .]
E uit λλit−1
it−1
it−1
it
it−1
λ
it
it
**
) )
= Exit E uit λλit−1
|xit , xit−1 , . . . − 0
it
*
)
= Exit E [uit |xit ] λλit−1
|x
,
.
.
.
it−1
it
= 0,

(9.77)

9.12 Bibliographic Notes

383

where the first term in the second equality additionally conditions on xit and
then unconditions, the second term in the second equality is zero by (9.75), and
the final equality uses E[uit |xit ] = 0 given (9.75). Therefore
)
*
E yit λλit−1
−
y
|x
,
.
.
.
= 0.
it−1
it−1
it

(9.78)

It follows that the Chamberlain transformation (9.62) satisfies the conditional moment condition (9.64) where the instruments zit can be drawn from
xi,t−1 , xi,t−2 , . . . . In a dynamic model with, for example, yi,t−1 included as a
regressor, the conditioning set in (9.75) becomes xit , xit−1 , . . . , yit−1 , yit−2 , . . .
and the instruments zit can be drawn from xi,t−1 , xi,t−2 , . . . , yit−2 , yit−3 , . . . .
The Wooldridge transformation (9.62) divides all terms in (9.76), (9.77),
and (9.78) by μit , and the method of proof used to obtain (9.78) still applies.
Windmeijer (2008) shows that the Chamberlain and Wooldridge transformations are still applicable with predetermined regressors if the error is instead
defined to be a multiplicative error
uit =

yit
,
α i λit

(9.79)

so yit = α i λit uit . Then condition (9.75) becomes E[uit |xit , xit−1 , . . .] = 1.
9.12 BIBLIOGRAPHIC NOTES
Longitudinal data models fall in the class of multilevel models, surveyed by
Goldstein (1995), who includes a brief treatment of Poisson. Standard references for linear models for longitudinal data include Hsiao (2003), Diggle
et al. (2002), Baltagi (2008), and Wooldridge (2010). Diggle et al. (2002) and
Fahrmeir and Tutz (2001) consider generalized linear models in detail. A useful
reference for general nonlinear longitudinal data models is Mátyás and Sevestre
(2008), including the Windmeijer chapter.
Remarkably, there are many different approaches to nonlinear models and
many complications including serial correlation, dynamics, and unbalanced
panels. The treatment in this book is comprehensive for models used in econometrics and covers many of the approaches used in other areas of statistics.
Additional statistical references can be found in Diggle et al. (2002) and
Fahrmeir and Tutz (2001). Lawless (1995) considers both duration and count
models for longitudinal data for recurrent events. For dynamic models the
GMM fixed effects approach is particularly promising. In addition to the count
references given in section 9.8, it is useful to refer to earlier work on the linear
model by Arellano and Bond (1991) and Keane and Runkle (1992). Recent
research has extended panel count models to more flexible hurdle models and
increasingly used finite mixture models; see section 9.10.

384

Longitudinal Data

9.13 EXERCISES
9.1 Show that the Poisson fixed effects conditional MLE of β that maximizes
the log-likelihood function given in (9.42) is the solution to the first-order
conditions (9.31).
9.2 Find the first-order conditions for the negative binomial fixed effects conditional MLE of β that maximizes the log-likelihood function based on the
density (9.43). (Hint: Use the gamma recursion as in Chapter 3.3.) Do these
first-order conditions have a simple interpretation, like those for the Poisson
fixed effect conditional MLE?
9.3 Verify that the first-order conditions for the Poisson random effects MLE
for β can be expressed as (9.46).
9.4 Show that the Poisson fixed effects conditional MLE that solves (9.31)
reduces to exp(β̂) = ȳ1 /ȳ2 in the application by Page (1995) discussed in
section 9.6.2.

CHAPTER 10

Endogenous Regressors and Selection

10.1 INTRODUCTION
Count regressions with endogenous regressors occur frequently. Ignoring the
feedback from the response variable to the endogenous regressor, and simply
conditioning the outcome on variables with which it is jointly determined,
leads in general to inconsistent parameter estimates. The estimation procedure
should instead allow for stochastic dependence between the response variable
and endogenous regressors. In considering this issue the existing literature on
simultaneous equation estimation in nonlinear models is of direct relevance
(T. Amemiya, 1985).
The empirical example of Chapter 3 models doctor visits as depending
in part on the individual’s type of health insurance. In Chapter 3 the health
insurance indicator variables were treated as exogenous, but health insurance is
frequently a choice variable rather than exogenously assigned. A richer model
is a simultaneous model with a count outcome depending on endogenous
variable(s) that may be binary (two insurance plans), multinomial (more than
two insurance plans), or simply continuous.
This chapter deals with several classes of models with endogenous regressors, tailored to the outcome of interest being a count. It discusses estimation
and inference for both fully parametric full-information methods and less parametric limited-information methods. These approaches are based on a multiple
equation model in which that for the count outcome is of central interest, but
there is also an auxiliary model for the endogenous regressor, sometimes called
the first-stage or reduced-form equation. Estimation methods differ according
to the detail in which the reduced form is specified and exploited in estimation.
Models with endogenous regressors are closely related to models of selfselection in which both the selection into the process (a binary variable denoted
y2 ) and the count outcome y1 conditional on selection (y2 ) are partly determined
by common or correlated unobserved factors. Such models may be distinguished from selection bias models in which the outcome variable is observed
for a subset of the population that satisfies an observability condition and hence
is not representative of the full population. This chapter considers both types
385

386

Endogenous Regressors and Selection

of models; the simplest example of the latter is a standard truncation model
presented in Chapter 4.3.
Standard methods may also need to be adjusted when samples do not represent the full population because the sampling scheme departs from simple
random sampling. A leading example is endogenous sampling in which sampling is based on the value of the outcome. For example, those with low values
of y are less likely to be sampled. Although the set-up of this problem is different
from the models with endogenous regressors, it is also discussed in this chapter.
To keep the discussion manageable, our analysis is restricted to recursive
models as defined in section 10.2. In section 10.3 parametric models based
on selection on unobservables are given special attention. Section 10.4 covers
less parametric approaches using instrumental variables (or GMM) estimators
and control function estimators. An empirical example is given in section 10.5.
Section 10.6 analyzes endogeneity in two-part models. The final section of
this chapter covers the identification implications of different sampling frames
including choice-based sampling and endogenous stratification.
10.2 ENDOGENEITY IN RECURSIVE MODELS
In this section we consider count models for outcome y1 with discrete or
continuous endogenous regressors y2 .
For linear models with additive errors, estimation of models with endogenous regressors by IV and GMM methods is well established, provided valid
instruments are available. For nonlinear models, several distinct methods have
been proposed. They vary with the strength of functional form assumptions and
on whether or not error terms are additive (or separable). To minimize dependence on strong assumptions, a literature on semiparametric and nonparametric
regression has developed. Blundell and Powell (2003) provide an early review
that emphasizes the role of separable errors and contrasts IV and control function estimators. Recent references, not restricted to recursive systems, include
Blundell and Matzkin (2010) and Matzkin (2010).
Count data have the added problem of discreteness. Chesher (2010) and
Chesher (2005) consider conditions for point identification of single equation
models for a discrete outcome using instrumental variable estimation. He shows
that in general only set identification is possible. But some restrictions, such as
a recursive model structure defined in section 10.2.1, make point identification
possible. For the count regression models considered in this chapter we make
restrictions on functional form and model structure that are sufficient to yield
point identification.
10.2.1

Recursive Model

In our initial set-up y1 depends on exogenous variables x1 , y2 , and a random
shock u1 ; y2 depends on exogenous variables z and a random shock u2 . Then
y1 = f1 (x1 , y2 , u1 )
y2 = f2 (z, u2 ).

(10.1)

10.2 Endogeneity in Recursive Models

387

It is assumed that z contains at least one variable not in x1 and that u1 and u2
are potentially correlated. We refer to (10.1) as a recursive model or triangular
model because the model for y2 specifies no feedback from y1 to y2 . The y1 equation is structural in the sense that the coefficient of y2 in the y1 -equation
is intended to have a causal interpretation. The y2 -equation is instead simply
called a first-stage or reduced-form equation. Exogenous variables are referred
to as either instruments or instrumental variables.
The complication in model (10.1) is that u1 and u2 are potentially correlated,
which in turn means u1 and y2 are correlated. As a result the structural y1 equation includes a regressor y2 that is correlated with the error u1 , leading to
inconsistent estimation of model parameters, suppressed in (10.1) for simplicity,
if this correlation is ignored. If instead u1 and u2 are independent, there is no
problem.
All model specifications we consider later have important restrictions.
1. E[y1 |x1 , y2 , u1 ] and E[y2 |z, u2 ] are smooth, continuous, and differentiable functions.
2. The unobserved shocks (u1 , u2 ) are separable and independent of x1
and z, and are jointly dependent.
3. The variable z includes an instrumental variable, excluded from
x1 , that accounts for nontrivial variation in y2 and affects y1 only
through y2 .
4. The model is recursive or triangular in the sense that there is no
feedback from y1 to y2 .
Assumption 1 would be violated by a piecewise conditional mean function
as in a two-part model. Assumption 2 would be violated if there were interaction
effects between unobserved heterogeneity and exogenous variables. Assumption 3 would be violated if the instrumental variable accounts for negligible
variation in the outcome variables.
These assumptions ensure point identification of the model parameters by
the method of instrumental variables. We use the term “separable functional
form” to refer to the case in which unobserved heterogeneity (u1 ) enters the
y1 equation such that the marginal effects ∂y1 /∂xj are independent of u1 . A
specification in which unobserved heterogeneity affects regression coefficients
directly violates the separability restriction. The assumption of a recursive
structure avoids potentially incoherent models that are known to arise in models with binary outcomes; see, for example, Windmeijer and Santos Silva
(1997).
10.2.2

Alternative Approaches

Consider the two-element vector y = (y1 y2 ) with joint density f (y|w, θ),
where analysis is conditional on w. In the notation of model (10.1), w =
(x1 z ) . For count applications, y1 is a count, whereas y2 may be either discrete

388

Endogenous Regressors and Selection

or continuous. The case of binary-valued y2 , which often represents a policy
variable (y2 equals 1 if policy is on, and zero otherwise), has received special
attention in the literature.
Under the assumption that the joint density factorizes as
f (y|w, θ ) = g(y1 |w, y2 , θ 1 )h(y2 |w, θ 2 ),

θ ∈ ,

(10.2)

where θ 1 and θ 2 are distinct, the standard result is that y2 may be treated as
exogenous. In that case a two-part model can be estimated; see section 10.6.
If instead the density h(y2 |w) depends additionally on θ 1 , then y2 is said to be
endogenous. This is the focus of this chapter.
We consider estimation of both complete and incomplete models.
r Complete models are two-equation models, one each for y and y .
1
2
Then one approach to handle endogeneity is to jointly model (y1 , y2 )
within a fully parametric or full-information setting that requires specifying the distributions g(·) and h(·) and estimating by maximum
likelihood.
r Incomplete models are single equation models that specify only a
model for y1 as a function of y2 , while the variation in y2 is left
unrestricted. Then a limited-information approach is to specify one
or two conditional moments of g(y1 |w, y2 , θ 1 ), assume the existence
of instruments, and estimate by GMM or control function methods.
Relative to the full-information approach, moment-based methods are
computationally simpler and founded on fewer assumptions.
In either approach the major focus in applied work is on the identification
and consistent estimation of the causal parameters attached to the endogenous
variables.
10.3 SELECTION MODELS FOR COUNTS
We consider models in which endogeneity results from selection. These models
consist of a count outcome (y1 ) equation and a binary outcome (y2 ) equation,
with endogeneity arising because the errors in the two equations are correlated with each other. In some applications the errors may be uncorrelated, in
which case the much simpler two-part model presented in section 10.6 may be
used.
We present several selection models. In the selection bias model we only
observe y1 when y2 = 1. In the dummy endogenous variable model we always
observe y1 , but the value of y1 depends directly on y2 . This is a recursive
simultaneous equations model where the endogenous variable in the count
equation is binary. In a richer switching equations model or Roy model, slope
parameters in addition to intercepts in the y1 equation vary according to whether
y2 = 0 or y2 = 1. In even richer models y2 may be multinomial rather than
binary.

10.3 Selection Models for Counts

10.3.1

389

Selection Bias Model

Selection bias arises if some phenomenon of interest is not fully observed,
unobservables determining the phenomenon of interest are correlated with
unobservables in the selection mechanism, and this complication is ignored. A
simple example is left truncation at zero, in which case the methods presented
in Chapter 4.3 should be applied. Here we consider a richer model for the
selection mechanism.
In a count model event counts may be observed only for a selected subpopulation. An example given by Greene (1994) considers the number of major
derogatory reports for a sample of credit-card holders. Suppose this sample
were used to make inferences about the probability of loan default assuming
a credit card was issued to an individual with specified characteristics. Such
inference would exhibit selectivity bias because it would be based only on
major derogatory reports of individuals who have already been issued credit
cards. The sample would not be random if the conditional default probability
differs between the two subpopulations, and hence one subpopulation is underrepresented in the sample of existing card holders. To estimate a count model
in the presence of selectivity bias, it is necessary to model both the process
of issuing credit cards (selection) and the counts of major derogatory reports
(outcome).
The classic sample selection model in the econometric literature is the
Gronau-Heckman female labor supply model, where a substantial fraction of
women choose not to have positive hours of work. The parametric version
of this model, assuming bivariate normal errors, is well covered in standard
texts such as Cameron and Trivedi (2005), Wooldridge (2010), and Greene
(2011). Because it is based on the linear model, it does not cover three distinguishing features of count regression models: nonnegativity, discreteness of the
dependent variable, and the frequently observed high incidence of zero observations.
Terza (1998) and Greene (1997) develop analogous full ML and two-step
procedures for a sample selection model for count data. The model has one
outcome equation for the count variably y1 , and one selection equation for the
binary participation indicator y2 that takes values 1 or 0. Data for both y2 = 1
and y2 = 0 are observed (e.g., whether or not a credit card is issued), but y1 is
only observed if y2 = 1 (e.g., number of major derogatory reports given that a
credit card is issued). Estimates of the impact of regressors on y1 based on data
on the cardholders alone (y2 = 1) are biased and inconsistent due to selection
bias that arises from using a truncated sample that excludes nonholders.
Fully Parametric Model
Selection is controlled for by specifying a count distribution for y1 that depends
on both covariates x and unobserved heterogeneity ε 1 , where ε1 and the
error term in the model for the binary outcome y2 are correlated bivariate

390

Endogenous Regressors and Selection

normal. The count is assumed to have Poisson or negative binomial density
Pr[y1i |xi , y2i , ε 1i ] = Pr[y1i |xi , ε 1i ] with conditional mean
E[y1i |xi , ε 1i ] = exp(xi β 1 + ε 1i ),

(10.3)

while y2i is a binary outcome from a standard latent variable model, so

1 if zi β 2 + ε 2i > 0
y2i =
(10.4)
0 otherwise.
The random variables ε1 and ε 2 are assumed to have a bivariate normal distribution



0
σ 2 ρσ
ε1i
∼N
,
.
(10.5)
ε2i
0
ρσ 1
Note that y1i does not depend on y2i once we condition on ε1i . The problem is
that we do not observe ε1i .
This selection model is related to hurdle and zero-inflated models that set
ε 1 = 0, so there is no error correlation. For the hurdle model the count outcome
is 0 if y2 = 0 and is restricted to be y1 |y1 > 0 if y2 = 1. For the zero-inflated
model the count outcome is 0 if y2 = 0 and is y1 if y2 = 1. By contrast, in the
selection model we only observe count y1 if y2 = 0.
The joint distribution in (10.5) implies that the conditional distribution of ε2
given ε1 is
ε 2i |ε1i ∼ N[(ρ/σ ) ε 1i , (1 − ρ 2 )].

(10.6)

This implies that
Pr[y2i = 1|zi , ε 1i ] = Pr zi β 2 + ε2i > 0|zi , ε 1i
= Pr ε2i > −zi β 2 |zi , ε 1i
)
+∞

*
ρ
1
dε 2i
= −z β √ 1 2 exp − 2(1−ρ
2 ) ε 2i − σ ε 1i
i 2
2π (1−ρ )



=  √ 1 2 zi β 2 + σρ ε 1i ,
1−ρ

(10.7)
where (·) is the standard normal cdf.
The two contributions to the density, y1 and y2 both observed if y2 = 1 and
only y2 observed if y2 = 0, can be combined as
(Pr[y1i , y2i = 1|xi , zi ])y2i (Pr[y2i = 0|zi ])1−y2i .

(10.8)

These probabilities are obtained by conditioning on the unobserved heterogeneity ε1 , in addition to the exogenous regressors x and z, and then eliminating ε 1
by quadrature or by using simulation methods.

10.3 Selection Models for Counts

391

For the first term in (10.8), conditioning on unobserved heterogeneity ε 1
leads to simplification because y1 and y2 are independent conditional on ε1 . So
Pr[y1i , y2i = 1|xi , zi , ε 1i ] = Pr[y1i |xi , ε 1i ] Pr[y2i = 1|xi , zi , ε 1i ]



= Pr[y1i |xi , ε 1i ] √ 1 2 zi β 2 + σρ ε1i .
1−ρ

(10.9)
For the second term in (10.8), Pr[y2 = 0] = 1 − Pr[y2 = 1], so using (10.7)



ρ
1

(10.10)
Pr [y2i = 0|zi , ε 1i ] =  √ 2 −(zi β 2 + σ ε 1i ) .
1−ρ

The log-likelihood, given (10.8), is
L(β 1 , β 2 , ρ, σ ) =

n

{y2i ln Pr [y1i , y2i = 1|xi , zi ] + (1−y2i ) ln Pr [y2i = 0|zi ]}.
i=1

(10.11)
Implementation requires eliminating ε1i in (10.9) and (10.10). We present two
ways to do so.
The first method is simulated maximum likelihood; see Chapter 4. It is
convenient to transform from ε1i ∼ N[0, σ 2 ], which depends on the unknown
σ 2 , to vi = ε1i /σ ∼ N[0, 1]. Given pseudorandom draws vi(s) from the N[0, 1]
distribution, the simulated log-likelihood is
σ)
L̂(β 1 , β 2 , ρ, 

n
S

1 
ln
Pr[y1i |xi , σ vi(s) ] √ 1
y
=
2i
S
i=1

s=1

+ (1 − y2i ) ln  √

1
(1−ρ 2


(s)

β
+
ρv
z
i
i 2
1−ρ 2

,
−(zi β 2 + ρvi(s) )
(10.12)

where Pr[y1i |xi , σ vi ] = Pr[y1i |xi , ε 1i ] may be the Poisson or negative binomial
with conditional mean given in (10.3).
Second, one can numerically integrate using Gaussian
which
+ ∞ quadrature,
2
from Chapter 4.2.4 approximates integrals of the form −∞ e−u g(u)du. Consider the contribution to the likelihood when y2 = 0. Using (10.10) and ε1 ∼
N[0, σ 2 ], we have
Pr [y2i+ = 0|zi ]
∞
= −∞ Pr [y2i = 0|zi , ε 1i ] g(ε1i )dε1i 

+∞


−ε 2
= −∞  √ 1 2 −(zi β 2 + σρ ε 1i ) √ 1 2 exp 2σ 1i2 dε 1i
2π σ
(1−ρ )


(10.13)
√
+∞ 1
β
2
2
√ 2
√
√
= −∞ π exp(−ui ) − zi
+
u
du
i
i
2
1−ρ 2

1−ρ
√
m

β

wj √1π  − zi √ 2 2 + √ 2 2 tj
.
j =1

1−ρ

1−ρ

392

Endogenous Regressors and Selection

√
where the third equality uses the change of variable ui = ε 1i / 2σ 2 , and the
last equality uses the Gaussian quadrature weights wj and evaluation points tj
for m evaluations. Similarly
Pr [y1i , y2i = 1|xi , zi ]
(10.14)


√
m
)
*

√
1
β2
2

2

wj √ Pr y1i |xi , 2σ tj  zi 6
+6
tj
.
π
1 − ρ2
1 − ρ2
j =1
The MLE maximizes (10.11) on substitution of the approximations (10.13) and
(10.14).
An alternative fully parametric model for counts with selection has been
proposed by Lee (1997). Counts are generated by a renewal process, see Chapter
4.10.3, with normal interarrival times that are correlated with the normal error
in the latent variable model for y2 . ML estimation is by simulation methods.
Partially Parametric Model
A less parametric approach models the conditional mean of the observed y1
given the selection rule. Then, suppressing conditioning on regressors,
E[y1i |y2i = 1] = Eε1i [y1i |y2i = 1, ε 1i ]
= Eε1i [exp(xi β 1 + ε1i )|ε 2i > −zi β 2 ]
= E[exp(xi β 1 + ρσ ε2i + ξ i )|ε2i > −zi β 2 ]
= exp(xi β 1 )E[exp(ξ i )]E[exp(ρσ ε2i )|ε2i > zi β 2 ]
= exp(xi β 1 ) exp( 21 σ 2 (1 − ρ 2 )) exp( 21 ρ 2 σ 2 )
= exp(xi β 1 + 12 σ 2 )

(ρσ +zi β 2 )
,
(zi β 2 )

(ρσ +zi β 2 )
(zi β 2 )

(10.15)
where the second equality uses (10.3) and the assumption that y1i is assumed
to be independent of y2i conditional on ε 1i and (10.4); the third equality uses
ε 1i = ρσ ε2i + ξ i , where ξ i ∼ N[0, σ 2 (1 − ρ 2 )] is independent of ε 2i , given
the bivariate normality assumption (10.5); the fourth equality follows given the
independence of ξ i ; the fifth equality uses the untruncated mean and the truncated mean of the lognormal (see, e.g., Terza, 1998, p. 134); and the last equality
follows on simplification. From (10.15) it is clear that there is no simultaneity
problem if ρ = 0, since then E[y1i |y2i = 1] = exp(xi β 1 ) exp( 21 σ 2 ), the usual
result for the Poisson-normal model. The selection adjustment in (10.15) differs
from the inverse-Mills ratio term obtained for the linear model under normality.
The model can be estimated by nonlinear least squares regression based on
(10.15), or a Heckman (1976) two-step type estimator where β 2 in (10.15) is
replaced by a first-step probit estimate β̂ 2 before second-step NLS estimation.
This moment-based approach requires normal errors and that (10.3) holds, but
unlike the ML approach does not require specification of a parametric count
distribution for y1 such as the Poisson.

10.3 Selection Models for Counts

393

Greene (1997) applies this model to major derogatory reports given that
the individual is a credit-card holder. Identification is secured though socioeconomic characteristics such as the number of dependents that are assumed to
determine whether the person holds a credit card, but not to directly determine
the number of derogatory reports. He compares FIML estimates based on
(10.11) with NLS estimates based on (10.15).
10.3.2

Single Endogenous Binary Regressor

Terza (1998) focuses on a closely related model that he notes can easily be
adapted to the preceding sample selection model. In Terza (1998), the data on
count y1 and binary outcome y2 are completely observed, but y2 is a regressor
in the equation for y1 . This model is a nonlinear simultaneous equations model
that is a count version of the dummy endogenous variables model of Heckman
(1978).
The count has density Pr[y1i |xi , y2i , ε 1i ] where the conditional mean
E[y1i |xi , y2i , ε 1i ] = exp(xi β 1 + γ 1 y2i + ε 1i ),

(10.16)

where y2i = 1[zi β 2 + ε 2i > 0] as in (10.4), and ε1 and ε2 are correlated bivariate normals as in (10.5).
The model is a recursive simultaneous equations system, see (10.1), with
the complication that y1 is a count and y2 is binary. Terza shows that the joint
density can be expressed as
Pr[y1i , y2i |xi , zi ] =

+∞

−∞

Pr[y1i |xi , y2i , ε 1i ] {y2i ∗ (ε1i )

+ (1 − y2i )(1 − ∗ (ε1i ))} √


6

1
2π σ 2

exp

−ε 21i
2σ 2


dε 1i ,
(10.17)

where ∗ (ε1i ) =  [zi β 2 + (ρ/σ )ε 1i ]/ 1 − ρ 2 . This is the basis for ML
estimation, with simulation methods or Gaussian quadrature used to eliminate
the one-dimensional integral in (10.17).
Terza (1998) also obtains an analytical expression for
E[y1i |y2i , xi , zi ] = y2i E[y1i |y2i = 1, xi , zi ] + (1 − y2i )E[y1i |y2i = 0, xi , zi ]

(ρσ +z β )
1−(ρσ +z β )
= exp(xi β 1 + 12 σ 2 ) y2i (z β i ) 2 + (1 − y2i ) 1−(z β i ) 2
i

2

i

2

(10.18)
zi β 2

zi β̂ 2 ,

replaced by
where
and considers NLS estimation of (10.18) with
β̂ 2 is obtained by first-stage probit regression of y2i on zi . Application is to the
number of trips taken by members of a household in the preceding 24 hours,
with the endogenous dummy variable being whether or not the household owns
a motorized vehicle.

394

Endogenous Regressors and Selection

Weiss (1999) considers estimation of a recursive model with the reverse
ordering to that of Terza, so that the binary variable y2 depends on the count
y1 . He considers richer models for the bivariate error distribution, based on
Lee (1983). In his application complete data on both major derogatory reports
and credit-card application success are available, and successful credit-card
application depends on the endogenous past number of the major derogatory
reports.
10.3.3

Several Mutually Exclusive Endogenous Binary Regressors

The model (10.16) can be viewed as one where the intercept for the count
outcome y1 can take one of two values, depending on a correlated binary
outcome y2 . In the treatment effects terminology the binary treatment y2 is
endogenous, rather than randomly assigned, and the parametric model of Terza
(1998) controls for this endogeneity.
More generally the treatment may take one of several values. Then the
intercept for the count outcome y1 may take one of several values, depending
on a correlated multinomial outcome d, a set of J indicator variables, denoted
dj , j = 1, . . . , J . Deb and Trivedi (2006a) propose a model for this case,
in an application where the utilization of health care services, a count y1 ,
depends on the individual’s health insurance plan, represented by a set of J
mutually exclusive indicator variables d1 , . . . , dJ . In this model the endogenous
treatment variables d1 , . . . , dj are categorical, but the approach can be extended
to the case of continuous variables.
The expected outcome equation for the counted outcomes y1i is
E[y1i |di , xi , li ] = exp(xi β 1 + di γ + li λ)
= exp(xi β 1 +

J

j =1 γ j dij +

J

(10.19)

j =1 λj lij ),

where xi is a set of exogenous covariates, γ = [γ 1 · · · γ J ] , li = [li1 · · · liJ ] ,
λ = [λ1 · · · λJ ] , and lij are latent or unobserved factors that are iid N[0, 1]
with loading parameters λj . If the j th insurance plan is chosen, then dij =
1 and E[y1i |dij = 1, xi , li ] = exp(xi β 1 + γ j dij + ε ij ), where εij = λj lij ∼
N[0, λ2j ], so the count model reduces to (10.16) for the case of a single binary
treatment. The outcome y1i is assumed to have a negative binomial distribution with mean (10.19) and dispersion parameter ψ, with density denoted
f (xi β 1 + di γ + li λ, ψ).
The distribution of the J dichotomous treatment variables is specified as a
mixed multinomial logit (MMNL) model,
exp(zi α j + δ j lij )
,
Pr[dij = 1|zi , li ] = J

k=1 exp(zi α k + δ k lik )

j = 1, . . . , J,
(10.20)

10.3 Selection Models for Counts

395

where zi is a set of exogenous covariates, the latent factors lij are the same as
those in (10.19) with loading parameters δ j , and for identification we normal
ize α 1 = 0. Then Pr[di |zi , li ] = Jj=1 (Pr[dij = 1|zi , li ])dij , which we denote
g(di |zi α 1 + δ 1 li1 , . . . , zi α J + δ J liJ ).
The self-selection problem arises from unobserved heterogeneity due to
the common latent factors li1 , li2 , . . . , liJ that simultaneously affect treatment
choice (insurance plan) and outcome (health care utilization). Policy interest lies
in ∂E[y1 |d, x, z]/∂dj , the pure treatment effect of dj on y1 . If endogeneity of d
is ignored, then the identified effect combines the desired pure treatment effect
and the selection effect. To obtain the pure treatment effect, we need to base
inference on f (y1 , d|x, z), with the joint density of the outcome and treatment
variables conditional only on exogenous variables x and z, because knowledge
of f (y1 , d|x, z) yields knowledge of the marginal density f (y1 |d, x, z)
The joint distribution of the outcome and treatment variables, conditional
on exogenous regressors and the unobserved latent factors li , is
Pr[y1i , di |xi , zi , li ] = f (y1i |di , xi , li ) × Pr(di |zi , li )
= f (y1i |xi β 1 + di γ + li λ, ψ)

(10.21)

× g(di |zi α 1 + δ 1 li1 , . . . , zi α J + δ J liJ ).
The log-likelihood is based on Pr[yi , di |xi , zi ], which requires eliminating li
by quadrature or simulation-based methods, because there is no closed-form
solution in integrating out li . The maximum simulated likelihood estimator
maximizes
n 1 
S

Pr[y1i , di |xi , zi , l(s)
i ]
i=1 S s=1
)
n 1 
S

ln f (y1i |xi β 1 + di γ + l̃(s)
=
i λ, ψ)
i=1 S s=1
*
(s)
(s)
, . . . , zi α J + δ J l˜iJ
) ,
× g(di |zi α 1 + δ 1 l˜i1

L̂(β 1 , γ , λ, ψ, α, δ|y1 , X, Z) =

(10.22)
l̃(s)
i

th

is the s draw (from a total of S draws) of pseudorandom numbers
where
from the distribution of l̃(s)
i . For calculating standard errors the usual approach
is to use a numerical approximation to the robust sandwich estimator. For
operational details, see Deb and Trivedi (2006a, 2006b).
For identification the scale of each choice equation should be normalized,
and the covariances between choice equation errors should be fixed. Deb and
Trivedi (2006a) set δ j = 1 ∀j . Although the model is identified through nonlinearity even when z = x, for robust identification there should be some exclusion
restrictions so that some variables in z (for insurance choice) are not included
in x (for health service use), and these excluded variables should contribute
nontrivially to explaining the variation in d.

396

Endogenous Regressors and Selection

Deb and Trivedi (2006a) apply their model to data from the 1996 Medical Expenditure Panel Survey, with insurance choice collapsed to one of three
mutually exclusive plans (J = 3). The parameter estimates from the maximization of (10.22) are used to compute the average treatment effects of a
health maintenance organization (i.e., E[y1 |x, z, dj = 1]− E[y1 |x, z, dj = 0]),
and associated standard errors are evaluated for a variety of hypothetical individuals, where dj = 1 if the individual’s health insurance plan is a health
maintenance organization.
Fabbri and Monfardini (2011) extend this model to the case where there
is more than one count outcome of interest. Then the multivariate counts are
modeled by adding common latent factors in Poisson models for each outcome,
see Chapter 8.4.3, a multivariate extension of (10.19). The dummy endogenous
regressors are modeled as in (10.20). Their application is to Italian data, with
two count outcomes – the number of visits to public specialist doctors and the
number of visits to private specialist doctors. There are three types of health
insurance: statutory insurance only, not-for-profit voluntary health insurance,
and for-profit voluntary health insurance. Voluntary health insurance is both
complementary with and supplementary to statutory insurance, with the forprofit variant providing greater coverage. Once the endogeneity of insurance
choice is controlled for, the authors find that those with for-profit voluntary
health insurance substitute away from public specialists to private specialist
rather than increasing specialists visits.
10.3.4

Endogenously Switching Regressions

The model (10.16) of section 10.3.2 specifies the conditional mean of a count
outcome to have an intercept that varies with the value taken by an endogenous
binary regressor. A richer model allows the slope coefficients to also vary with
the value of the endogenous binary regressor. In the linear case, y1 = x1 β 1 + ε 1 ,
y2 = x2 β 2 + ε 2 , y = y1 if z α + ε3 > 0 and y = y2 if z α + ε3 < 0, and the
errors ε 1 , ε 2 , and ε 3 are correlated normal variates. This model is called the
Roy model or an endogenous switching regressions model.
Deb, Munkin, and Trivedi (2006) propose a count version of this model.
The count y comes from one of two models

if zi α + ε3i > 0
y1i
(10.23)
yi =
y2i if z α + ε3i < 0,
i
where
y1i ∼ P[exp(xi β 1 + π 1 ε 3i + ε 1i )]
y2i ∼ P[exp(xi β 2 + π 2 ε 3i + ε2i )].

(10.24)

There are two regimes generating y1 and y2 , but only one value is observed for
each individual. The alternative state serves to generate a counterfactual. The
assignment to the state is not random but is endogenous, with endogeneity

10.4 Moment-Based Methods for Endogenous Regressors

397

modeled by assuming that the random disturbances have joint normal
distribution
⎤⎤
⎡ ⎤
⎡⎡ ⎤ ⎡ 2
ε1i
0
σ1 0 0
⎥⎥
⎢ ⎥
⎢⎢ ⎥ ⎢
(10.25)
⎣ ε2i ⎦ ∼ N ⎣⎣ 0 ⎦ , ⎣ 0 σ 21 0 ⎦⎦ ,
0
0 1
0
ε3i
where the variance of ε 3 is restricted to unity for identification.
Deb et al. (2006) use MCMC Bayesian methods to implement this model.
Application is to the 1996–2002 Medical Expenditure Panel Surveys, with
doctor visits as the count outcome and the model varying according to whether
the individual has private health insurance.
10.4 MOMENT-BASED METHODS FOR
ENDOGENOUS REGRESSORS
The methods of section 10.3 for controlling for endogenous regressors are
quite specialized, being highly parametric and focused on examples where the
endogenous regressors are binary. In the terminology of section 10.2.2, the
methods are full-information approaches based on a complete model. In this
section we consider less parametric methods that are extensions of instrumental
variables and control function methods for the linear regression model.
It is important to note that the two-stage interpretation of linear 2SLS
does not carry over to nonlinear models. Specifically, first-stage regression
of an endogenous regressor on instruments followed by second-stage Poisson
regression with the endogenous regressor replaced by its first-stage predicted
value leads to inconsistent parameter estimates; see, for example, Windmeijer
and Santos Silva (1997, p. 286). Instead, the methods presented in this section
need to be used.
We consider cross-section data. If panel data are available then a simple
solution to endogeneity is the Poisson fixed effects estimator, see Chapter 9.4,
in the special case that the endogenous regressor is time varying but is correlated
only with a time-invariant component of the error.
10.4.1

Nonlinear Instrumental Variables Estimation

In the linear regression model y = x β + u, the OLS estimator is inconsistent
if E[u|x] = 0. The instrumental variables approach assumes that there are
instruments z such that E[u|z] = 0. Then E[zu] = E[z(y − x β)] = 0. If there
are as many instruments as regressors, the instrumental
variables estimator

solves the associated sample moment conditions ni=1 zi (yi − xi β) = 0. If
there are more instruments than regressors,
then estimation is by linear GMM

that minimizes a quadratic form in ni=1 zi (yi − xi β), a leading example being
the 2SLS estimator.
Linear and nonlinear IV estimation are presented in further detail in Chapter
2.5.4. In this section we consider the special case of nonlinear IV estimation for

398

Endogenous Regressors and Selection

models with exponential conditional means, the usual specification for Poisson and negative binomial count models. Then two distinct IV estimators are
obtained, depending on whether the model is assumed to have an additive error
(Grogger, 1990) or a multiplicative error (Mullahy, 1997b). Windmeijer and
Santos Silva (1997) contrast these two different approaches and also consider
optimal GMM estimation. We summarize the relevant results.
Additive Heterogeneity
We first consider estimation of an exponential regression with an additive error
(additive heterogeneity) that is correlated with the regressors x. Then
yi = exp(xi β) + ui .

(10.26)

The Poisson QMLE is inconsistent if E[ui |xi ] = 0, since then E[yi |xi ] =
exp(xi β) and the essential condition for consistency, see Chapter 3.2.2, does
not hold.
Instead assume the existence of r linearly independent instruments zi that
satisfy
E[ui |zi ] = E[yi − exp(xi β)|zi ] = 0.
Then E[zi (yi −

exp(xi β))]

(10.27)

= 0 or

E[Z (y − μ(β))] = 0,

(10.28)

where Z denotes the n × r matrix of instruments, and μ(β) is the n × 1 vector
with i th entry μi = exp(xi β).
If there are as many instruments as regressors (r = k), the nonlinear IV
estimator solves the corresponding sample moment condition
Z (y − μ(β)) = 0.

(10.29)

More generally, if there are more instruments than regressors (r > k), the
nonlinear IV estimator β̂ NLIV minimizes the quadratic form
(y − μ(β)) Z[Z Z]−1 Z (y − μ(β)) .

(10.30)

Using results in Chapter 2.5, β̂ NLIV is asymptotically normal distributed with
the variance matrix estimated by

−1 
V̂[β̂ NLIV ] = Ĝ Z[Z Z]−1 Z Ĝ
Ĝ Z[Z Z]−1 Ŝ[Z Z]−1 Z Ĝ
(10.31)

 
−1
,
× Ĝ Z[Z Z]−1 Z Ĝ

where Ĝ = ∂μ(β)/∂β  β̂ NLIV , and for heteroskedastic errors and the exponential
conditional mean
n

û2i zi zi ,
Ŝ =
i=1

where ûi = yi − exp(xi β̂ NLIV ).

10.4 Moment-Based Methods for Endogenous Regressors

399

As noted in Chapter 2.5.4, the NLIV estimator presumes homoskedastic
errors. When r > k, the more efficient two-step GMM estimator minimizes
(y − μ(β)) ZŜ−1 Z (y − μ(β)) .

(10.32)

Then more simply
)
* 
−1
2step
V̂ β̂ GMM = Ĝ ZŜ−1 Z Ĝ
.

(10.33)

Alternatively one can assume a model for the heteroskedasticity. For example,
if the conditional variance is a
multiple of the conditional mean then Ŝ in
(10.32) can be replaced by Ŝ = ni=1 exp(xi β̂ NLIV )zi zi .
Condition (10.27) implies not only that zi is an instrument but also that
any transformation of zi may be an instrument. Optimal instrumental variables,
denoted z∗i , are those that yield the smallest asymptotic variances. In the present
case the optimal instrumental variable matrix, using the results in Chapter 2.5.3,
is

∂μ(β)
|Z
.
(10.34)
Z∗ = E (V[y|X])−1
∂β 
This specializes to just X if Z = X and V[y|X] = cDiag[μi ], for some constant
c > 0, so that in the case of no endogenous regressors the optimal IV estimator solves X (y − μ(β)) = 0, yielding the Poisson QMLE. Given endogenous
regressors, so Z = X, the quantity V[y|X]−1 ∂μ/∂β  is a complicated function of X and Z, even if a model for V[y|X] is specified, so it is not possible
to obtain Z∗ . If one accepts as a working hypothesis that V[y|X] is a scalar
multiple of Diag[μi ], and μi = exp(xi β), then ∂μ(β)/∂β = Diag[μi ] × X so
the optimal instruments are Z∗ = E[X|Z]. Windmeijer and Santos Silva (1997)
suggest that in practice one should use as instruments an estimate Ê[X|Z] of
E[X|Z], augmented by variables in Z that are not collinear with Ê[X|Z].
Multiplicative Heterogeneity
NLIV estimation for the Poisson model based on additive heterogeneity has
been proposed by Grogger (1990). Mullahy (1997a) instead views the more
natural model to work with to be one with multiplicative heterogeneity, since it
treats the error (or unobserved heterogeneity) symmetrically to the regressors.
Given an exponential conditional mean, a natural way to introduce an error
term is
yi = exp(xi β + ui )
= exp(xi β) exp(ui )
= exp(xi β)vi ,

(10.35)

400

Endogenous Regressors and Selection

so an additive error within exp(·) implies a multiplicative error for exp(xi β). In
order for E[yi |xi ] = exp(xi β), it must be that E[vi |xi ] = 1 or, equivalently,

vi
E
−
1|x
(10.36)
i = 0.
exp(xi β)
Endogeneity of some of the regressors implies that (10.36) does not hold.
Instead we assume that the existence of instruments zi satisfies

vi
−
1|z
(10.37)
E
i = 0.
exp(xi β)
Given (10.35), this condition can be reexpressed as

yi − exp(xi β)
|zi = 0.
E
exp(xi β)

(10.38)

This leads to IV estimation based on the moment condition
E[Z M−1 (y − μ(β))] = 0,

(10.39)

Diag[exp(xi β)].

where M =
If there are as many instruments as regressors (r = k), the nonlinear IV
estimator solves the corresponding sample moment condition
Z M−1 (y − μ(β)) = 0.

(10.40)

More generally, if there are more instruments than regressors (r > k), the
nonlinear IV estimator β̂ NLIV minimizes the quadratic form
(y − μ(β)) M−1 ZWn Z M−1 (y − μ(β)) ,

(10.41)

where Wn = [Z Z]−1 in the simplest case of NLIV. Given heteroskedasticity it
is more efficient to use the two-step GMM estimator. For even more efficient
estimation, the optimal instruments in the multiplicative case are given by

∂v(β)
|Z
,
(10.42)
Z∗ = E M(V[y|X])−1 M
∂β 
where v(β) = M−1 (y − μ(β)).
The essential conditional moment conditions are (10.27) for multiplicative heterogeneity and (10.38) for additive heterogeneity. Given endogeneity,
instruments zi cannot simultaneously satisfy both (10.27) and (10.38); see
Windmeijer and Santos Silva (1997, p. 284). An important point is that instrumental variables that are orthogonal to a multiplicative error v are not in general
orthogonal to an additive error u. The specification of the error term affects the
objective function, the choice of instruments, and the estimates of β.
An alternative interpretation of the two IV estimators, suggested by Joao
Santos Silva, is that they correspond to two different weighting schemes. The
first, based on E[zi (yi − exp(xi β))] = 0, gives equal weight to each observation as does the Poisson, so it is appropriate when the variance is a multiple of

10.4 Moment-Based Methods for Endogenous Regressors

401

exp(xi β). The second, based on E[(zi (yi − exp(xi β)))/ exp(xi β)] = 0, downweights observations with large exp(xi β) and is appropriate when the variance
is proportional to the square of exp(xi β). Again the instruments zi cannot
simultaneously satisfy both, except in the trivial case of exogenous xi .
Most of the discussion in this section is not tailored specifically to count
data models but applies more generally to models with exponential conditional means. However, heteroskedasticity is a major feature of count data,
so customization to count models with given variance functions may improve
efficiency. For simplicity, the foregoing discussion uses a variance function
without a nuisance parameter, but this extension is feasible. Consistent estimation of such a nuisance parameter can be based on a two-step procedure. At
the first stage NLIV is applied without heteroskedasticity adjustment. At the
second stage the nuisance parameter is estimated using methods analogous to
those discussed in Chapter 3.2.
Finally, although we have emphasized single equation estimation, as pointed
out in Chapter 9, the NLIV approach can be generalized to panel data models
with endogenous or predetermined regressors (Blundell, Griffith, and Windmeijer, 2002).
10.4.2

Recursive Estimation Using Control Functions

Control function estimation is a two-step method, introduced by Heckman and
Robb (1985). Our general presentation follows Navarro (2008). A recursive
model
y1 = g(x, y2 , u1 )
y2 = h(z, u2 ),
is specified where z includes x plus at least one extra regressor, and u1 and u2 are
correlated so y2 is endogenous in the first equation. Interest lies in estimating
a function a(x, y2 ). In this model if u1 is known then the model for y1 can be
worked with directly, without an endogeneity problem.
A control function defines a function of u1 that depends on observables, and
conditioning on this eliminates the endogeneity. Formally, a function K(z, y2 )
is a control function if it allows recovery of a(x, y2 ), u1 is independent of y2
conditional on a known function ρ(x, K(z, y2 )), and K(·) is identified. It is
not always possible to find a control function, and when it does exist it may
rely on strong distributional assumptions. A major topic in the semiparametric
literature is establishing conditions under which the control function can be
recovered nonparametrically. This approach leads to a generated regressor, so
inference on estimates of parameters in the outcome equation should use a
bootstrap or a comparable methodology.
For linear regression with one right-hand side endogenous variable, an example of a control function is the residual û2 from the reduced-form equation for
that endogenous variable. The least squares estimate from regression of y1 on

402

Endogenous Regressors and Selection

x, y2 , and û2 is easily shown to be equivalent to the two-stage least squares
estimator.
Consider the following recursive model for counts:
E[y1i |xi , y2i , u1i ] = exp(xi β 1 + γ 1 y2i + u1i )
y2i = zi β 2 + u2i ,

(10.43)

where zi includes at least one variable not in xi . If the errors u1 and u2 are
correlated, then y2 and u1 are correlated so Poisson regression of y1 on x and
y2 yields inconsistent parameter estimates.
In this recursive model, however, the problem would disappear if the error
u1 was observed, since then one can do Poisson regression of y1 on x, y2 , and
u2 . Wooldridge (1997b) assumes that
u1i = ρu2i + ε i ,

(10.44)

where ε i is independent of u2i , which implies
E[y1i |xi , y2i , u2i ] = exp(xi β 1 + γ 1 y2i + ρu2i ).

(10.45)

Wooldridge therefore proposes Poisson regression of y1 on x, y2 and û2 , where
û2i = y2i − zi β̂ 2 and β̂ 2 is the estimate from OLS estimation of y2 on z. This
yields consistent estimates of β 1 and γ 1 under assumptions (10.43) and (10.44),
though statistical inference should be based on standard errors that control for
the estimation error in û. This can be done using a bootstrap for a two-step
estimator. Wooldridge notes that under the null hypothesis of no endogeneity,
H0 : ρ = 0, there is no need to correct for two-step estimation – one can
simply do a t-test based on ρ̂ with the usual robust standard errors for Poisson
regression.
Terza, Basu, and Rathouz (2008) call this method two-stage residual inclusion and provide many relevant references. More generally the method is called
a control function approach, discussed at the start of this subsection, since the
additional regressor û2 is included as a control for the endogeneity of y2 . In
the linear model case the method coincides with the usual 2SLS estimator.
For nonlinear models this method requires the stronger assumption that ε is
statistically independent of u2 and not just mean independent. The resulting
estimator differs from the nonlinear IV estimator, and which approach, if any,
works well in practice has not been established.
10.5 EXAMPLE: DOCTOR VISITS AND HEALTH
INSURANCE
A key issue in health policy is the role of health insurance in the utilization of
health services. In many countries purchasing basic health insurance, or supplemental insurance if there is universal basic health insurance, is an individual
choice and is likely to be an endogenous regressor even after conditioning on
other regressors. The goal is to estimate the pure causal or incentive effects

10.5 Example: Doctor Visits and Health Insurance

403

of insurance, due to the reduction in the out-of-pocket costs of care, from
the effects of self-selection due to individuals sorting themselves out across
different types of insurance plans based on their health status and preferences.
10.5.1

Data Summary

The data are a cross-section sample from the U.S. Medical Expenditure Panel
Survey for 2003. We model the annual number of doctor visits (DOCVIS)
using a sample of the elderly Medicare population aged 65 and higher. These
individuals all receive basic health insurance through Medicare, so we consider
the role of supplemental health insurance obtained privately or publicly.
The covariates in regressions are age (AGE), squared age (AGE2), years
of education (EDUCYYR), presence of activity limitation (ACTLIM), number
of chronic conditions (TOTCHR), having private insurance that supplements
Medicare (PRIVATE), and having public Medicaid insurance for low-income
individuals that supplements Medicare (MEDICAID). The last two are indicator
variables that take the value zero for the uninsured, which is a base category.
To simplify analysis, observations are dropped if the survey participant
reports dual supplemental insurance coverage through simultaneously having private supplemental insurance and Medicaid coverage. There are 45
such observations. Additionally three observations with DOCVIS > 70 are
dropped (for reasons explained in Chapter 6), yielding a final sample with 3,629
observations. The distribution over insurance categories is PRIVATE, 49.1%;
MEDICAID, 15.6%; and NOINSR (no private supplemental insurance), 35.3%.
The sampled individuals are aged 65–90 years, and a considerable portion
have an activity limitation or chronic condition. The sample mean of DOCVIS
is 6.74, and the sample variance is 45. 56 so there is great overdispersion. The
distribution has a long right tail, with 22% of observations exceeding 10 though
less than 1% exceed 40. The proportion of zeros is 10.9%, relatively low for
this type of data, partly because the data pertain to the elderly population.
To control for endogeneity of supplemental insurance we use as instruments
INCOME and SSIRATIO. The first is a measure of total household income,
and the second is the ratio of Social Security income to total income. Jointly
the two variables reflect the affordability of private insurance. High INCOME
makes private insurance more accessible, whereas a high value of SSIRATIO
indicates an income constraint and is expected to be negatively associated with
the variable PRIVATE. For these to be valid instruments, we need to assume
that for people aged 65–90 years doctor visits are not directly determined by
INCOME or SSIRATIO.
10.5.2

Single Endogenous Regressor

The initial analysis treats only PRIVATE as potentially endogenous, with MEDICAID treated as exogenous. Table 10.1 presents the estimated coefficients of

404

Endogenous Regressors and Selection

Table 10.1. Doctor visits: One endogenous regressor
Regressor

Poisson

PRIVATE

0.170
(0.036)
0.082
(0.048)

MEDICAID

NB2
0.185
(0.037)
0.085
(0.048)

residual
OIR statistic
OIR p-value
log-likelihood

−14,288

−10,405

Poisson-CF NB2-CF
0.410
(0.238)
0.199
(0.120)
−0.246
(0.239)
−14,285

0.596
(0.258)
0.284
(0.128)
−0.419
(0.258)
−10,403

GMM-add GMM-mult
0.446
(0.278)
0.248
(0.177)

0.678
(0.251)
0.289
(0.103)

1.392
(0.238)

0.940
(0.332)

Note: Heteroskedasticity-robust standard errors are reported in parentheses; those for PoissonCF
and NegbinCF are based on 400 bootstrap replications. Coefficients of exogenous regressors
other than MEDICAID are not reported. Residual is the residual from the first-stage regression
of PRIVATE on exogenous regressors and the instruments INCOME and SSIRATIO. OIR test is
the overidentifying restrictions test.

PRIVATE and MEDICAID; coefficients of the other regressors AGE, AGE2,
EDUCYYR, ACTLIM, and TOTCHR are not reported for brevity and because
their coefficients do not vary greatly across models.
The first two columns estimate standard count models that treat PRIVATE as
exogenous. The Poisson and negative binomial (NB2) estimates are quite similar, and the heteroskedastic-robust standard errors are similar, though the NB2
specification provides a much better fit as measured by the log-likelihood. Private supplementary insurance is highly statistically significant and is associated
with close to a 20% increase in doctor visits.
The next two estimators use the control function approach of section 10.4.2
to allow for endogeneity of PRIVATE. At the first stage, PRIVATE is OLS
regressed on MEDICAID, AGE, AGE2, EDUCYYR, ACTLIM, and TOTCHR
and the two instruments INCOME or SSIRATIO. The second stage is a Poisson
or NB2 regression of DOCVIS on the same regressors as in columns 1 and
2, including PRIVATE, plus the fitted residual from the first-stage regression.
The coefficient of PRIVATE is now two to three times as large as under the
exogeneity assumption, which suggests that private supplementary insurance
generates 40–60% more doctor visits. The standard errors associated with
this coefficient are more than five times as large as under exogeneity, so that
for the Poisson the coefficient is barely statistically significant at 5% using a
one-sided test. Such a loss of precision is typical when instruments are used in
cross-section applications. Endogeneity of PRIVATE can be tested based on the
coefficient of the first-stage residual. From Table 10.1, t = −0.419/0.258 =
1.62, so we fail to reject the null hypothesis of exogeneity using a two-sided
test at level 0.05.
The final two estimators are two-step GMM estimators that use INCOME
and SSIRATIO as instruments for PRIVATE. The first estimator is based on

10.5 Example: Doctor Visits and Health Insurance

405

Table 10.2. Doctor visits: Two endogenous regressors
Poisson-CF GMM-add GMM-mult MMNL-NB1 MMNL-NB2

Regressor
PRIVATE
MEDICAID
residual1
residual2

0.530
(0.269)
0.673
(0.424)
−0.365
(0.269)
−0.598
(0.433)

0.621
(0.359)
0.689
(0.438)

0.741
(0.260)
0.670
(0.447)

λPRIVATE
λMEDICAID
log-likelihood

−

−

−

0.290
(0.089)
0.127
(0.078)

0.557
(0.065)
0.115
(0.251)

−0.134
(0.100)
−0.026
(0.082)
−13,430

−0.449
(0.059)
0.023
(0.318)
−13,483

Note: Heteroskedasticity-robust standard errors are reported in parentheses; those for Poisson-CF
are based on 400 replications. Coefficients of exogenous regressors are not reported. Residuals 1
and 2 are, respectively, the residuals from the first-stage regression of PRIVATE and of MEDICAID
on regressors and instruments INCOME and SSIRATIO.

additive heterogeneity, see (10.32), and yields results similar to the Poisson
control function estimates, while the standard errors are somewhat larger. The
second estimator is based on multiplicative heterogeneity, see (10.41), and
yields a larger coefficient for PRIVATE. Since there are two instruments and
one endogenous regressor, there is one overidentifying restriction yielding a
χ 2 (1) test statistic that for both GMM estimators has a p-value greater than
0.05, so we do not reject the null hypothesis that the overidentifying restrictions
are valid.
10.5.3

Two Endogenous Regressors

We now consider models with two endogenous regressors – PRIVATE and
MEDICAID – with the same regressors and the same instruments INCOME and
SSIRATIO as in section 10.5.2. The preceding methods can again be applied.
The first column of Table 10.2 presents control function results, where two
fitted residuals are added as additional regressors in the Poisson regression for
DOCVIS – one from OLS regression of PRIVATE on exogenous variables and
instruments, and one from a similar regression with MEDICAID the dependent
variable.
The second and third columns present GMM estimates with additive and
multiplicative heterogeneity. In this case the model is just-identified, with two
endogenous variables and two instruments, so an overidentifying restrictions
test is not possible.
Finally the more structural model (10.19) and (10.20) of section 10.3.3 is
estimated by maximum simulated likelihood (Deb and Trivedi, 2006a, 2006b).

406

Endogenous Regressors and Selection

Unlike the preceding methods, the two endogenous regressors are explicitly
treated as binary. This model has three endogenous insurance categories –
PRIVATE, MEDICAID, and NOINSR – that are modeled using an MMNL
specification, with NOINSR as the base category. The regressors for the MMNL
part of the model for treatment selection are the exogenous variables and
instruments used there. The outcome variable DOCVIS is modeled using both
NB1 and NB2 specifications. The MSL estimates are obtained using 300 Halton
sequence-based quasirandom draws. For evidence in support of the hypothesis
of endogeneity (self-selection) of the insurance variables, the factor-loading
coefficients λ1 and λ2 should be jointly statistically significant, which is the case
here. According to the MMNL-NB1 results, supplementary private insurance
leads to 30% more doctor visits, and Medicaid to 13% more visits, whereas
for MMNL-NB1 supplementary private insurance has an even bigger effect.
MMNL-NB1 is preferred here because the log-likelihood is much larger, with
the same number of parameters.
Because this example is only intended to be illustrative, only a few covariates were included in the model even though many available socioeconomic
variables are known to be significant drivers of doctor visits. Including such
information should improve the precision of estimates.
10.6 SELECTION AND ENDOGENEITY IN
TWO-PART MODELS
In the notation used in this chapter, the two-part or hurdle model of Chapter 4
specifies

y1i > 0 if y2i = 1
(10.46)
y1i =
0
if y2i = 0.
This is closely related to the selection models of section 10.3, but there are
important differences. In particular, when the binary variable equals one, we
observe only positive counts from the zero-truncated density f (y1 |y1 > 0,
whereas in section 10.3.1, for example, we observed y1 from the untruncated
density f (y1 ). And in this benchmark model the two parts are assumed to be
independent, conditional on regressors, and all regressors are assumed to be
strictly exogenous.
In this section we briefly consider selection and endogeneity in the two-part
model. Qualitatively similar analysis holds for the with-zeros model.
A selection version of the two-part model can be obtained by allowing the
conditional means in the models for y1 and y2 to depend in part on errors ε 1
and ε2 . These errors represent correlated unobserved factors that affect both
the probability of the binary outcome and the zero-truncated count outcome,
so the two parts are connected via unobserved heterogeneity. This is a variant
of the selection bias model of section 10.3.1. Greene (2007) gives relevant
algebraic details for ML estimation.

10.7 Alternative Sampling Frames

407

A second variant of the two-part model further extends the selection version
of the two-part model to allow for the presence of endogenous regressors in both
parts. This can be done by appropriately adapting the model of section 10.3.3,
by specializing (10.19)–(10.20) to the case of one dichotomous variable and
one truncated count distribution, and using the latent factors to control for both
selection and endogeneity. Identification of such a model will require restrictions on the joint covariance matrix of errors, but simulation-based estimation
appears to be a promising alternative.
A third version of the two-part model allows for endogeneity only. This
special case of the second variant makes the assumption that conditional on
exogenous regressors and common endogenous regressor(s), the two parts are
independent. This assumption is not easy to justify, especially if endogeneity
is introduced via dependent latent factors. Estimation of a class of binary
outcome models with endogenous regressors is well established in the literature
and has been incorporated in several software packages. Both two-step and
ML estimators have been developed for the case of a continuous endogenous
regressor (see Newey, 1987) but are not applicable for the case of an endogenous
discrete regressor.
10.7 ALTERNATIVE SAMPLING FRAMES
Departures from simple random sampling, except for exogenous sampling,
which is defined later, can mean that standard estimation procedures need to be
adjusted to obtain consistent parameter estimates. An example from Chapter 4
is adjustment of the standard Poisson or negative binomial estimators for zerotruncated counts. An example in section 10.3.1 is selection, where observation
of the count outcome is determined by a correlated binary outcome.
In this section we provide a more general treatment of the consequences
of endogenous sampling, where the probability of inclusion in the sample
depends on the value taken by the count outcome. Then the resulting likelihood
function is a weighted version of that obtained under random sampling. We also
specialize this result to the case of count data from on-site samples, a particular
form of choice-based sampling.
10.7.1

Simple Random Samples

As a benchmark for subsequent discussion, consider simple random samples
for count data. These generally involve a nonnegative integer-valued count
variable y and a set of covariates x whose joint distribution, denoted f (y, x),
can be factored as the product of the conditional and marginal distributions,
thus
f (y, x) = g(y|x, θ )h(x).

(10.47)

In the preceding chapters attention has been largely focused on g(y|x, θ ),
modeling y given x. Simple random sampling involves drawing (y, x)

408

Endogenous Regressors and Selection

combinations at random from the entire population. A variation of simple
random sampling is stratified random sampling. It involves partitioning the
population into strata defined in terms of (y, x) and making random draws
from each stratum. The number of draws from a stratum is some preselected
fraction of the total survey sample size. We now consider how departures from
simple random sampling arise and the consequent complications if the strata
are not based on x alone.
10.7.2

Exogenous Sampling

Exogenous sampling from survey data occurs if the analyst segments the available sample into subsamples based only on a set of exogenous variables x, but
not on the response variable y, here the number of events. Perhaps it is more
accurate to depict this type of sampling as exogenous subsampling because
it is done by reference to an existing sample that has already been collected.
Segmenting an existing sample by gender, health, or socioeconomic status is
very commonplace. For example, in their study of hospitalizations in Germany,
Geil et al. (1997) segment the data into two categories, those with and without
chronic conditions. Classification by income categories is also common. Under
exogenous sampling the probability distribution of the exogenous variables is
independent of y and contains no information about the population parameters of interest, θ . Therefore, one may ignore the marginal distribution of the
exogenous variables and simply base estimation on the conditional distribution
g(y|x, θ ).
10.7.3

Endogenous or Choice-Based Sampling

Endogenous or choice-based sampling occurs if the probability of an individual
being included in the sample depends on the value taken by the count outcome.
The practical significance of this feature is that consistent estimation of θ can
no longer be carried out using the conditional population density g(y|x) alone.
The effect of the sampling scheme must also be taken into account.
In what follows f denotes the joint, g the conditional, and h the marginal
densities. For further analysis we distinguish the sampling probability from
the population probability by superscript s on f (·). In particular we assume
endogenous sampling based on y according to the density hs (y). Then the joint
sampling density is
f s (y, x) = g(x|y)hs (y),
which can be reexpressed using the relations
f (y, x) = g(y|x)h(x),
= g(x|y)h(y),

10.7 Alternative Sampling Frames

409


where the marginal distributions are h(x) = y f (y, x) and h(y) =
+
g(y|x)h(x)dx. Combining the above, and introducing dependence on the
parameters θ in g(y|x, θ ), we obtain
f s (y, x) =

f (y, x)hs (y|θ )
h(y)

g(y|x, θ )h(x)hs (y|θ )
= +
g(y|x, θ )h(x)dx
= g(y|x, θ )ω(y, x, θ ),
where the second term is the weight
ω(y, x|θ ) = +

h(x)hs (y|θ )
.
g(y|x)h(x)dx

The log-likelihood function based on f s (y, x) is
L(θ|y, x) =

n

i=1

ln g(yi |xi , θ ) +

n


ln ω(yi , xi |θ).

(10.48)

i=1

This can be interpreted as a weighted log-likelihood or a log-likelihood based
on weighted probabilities, where the weights are ratios of sample and population probabilities and differ from unity (the case for simple random samples).
If there exists prior information on the weights, then likelihood estimation
based on weighted probabilities is straightforward. In the more usual situation in which such information is not available, estimation is difficult because
the distribution of x is involved. The literature on the estimation problem in
the context of discrete choice models is extensive (Manski and McFadden,
1981).
Standard conditional estimation considers the case when f s (y, x) = f (y, x).
Then ω(y, x|θ ) = h(x), which does not depend on θ, and maximizing L(θ |y, x)
with respect to θ is the same as just considering the first term in (10.48). If
f s (y, x) = f (y, x), however, analysis using standard conditional estimation
that ignores the last term leads to inconsistent estimates of θ .
10.7.4

Counts with Endogenous Stratification

Count data are sometimes collected by on-site sampling of users. For example,
on-site recreational or shopping mall surveys (Shaw, 1988; Englin and Shonkwiler, 1995; Okoruwa, Terza, and Nourse, 1988) may be carried out to study
the determinants of frequency of use, often using travel-cost models. Then only
those who use the facility at least once are included in the survey, and even
among users the likelihood of being included in the sample depends on the
frequency of use. This is an example of endogenous stratification or sampling
because the selection of persons surveyed is based on a stratified sample, with

410

Endogenous Regressors and Selection

random sampling within each stratum, the latter being defined by the number
of events of interest.
Endogenous stratification has some similarities with choice-based sampling.
As in that case, lower survey costs provide an important motivation for using
stratified samples in preference to simple random samples. It requires a very
large random sample to generate enough observations (information) about a
relatively rare event, such as visiting a particular recreational site. Hence, it is
deemed cheaper to collect an on-site sample. However, the problem is that of
making inferences about the population from the sample. To do so, we need
the relation between the sample frequency function and the population density
function (T. Amemiya, 1985, pp. 319–338; Pudney, 1989, pp. 102–105).
To derive a density function suitable for analyzing on-site samples, the
effect of stratification has to be controlled for. Shaw (1988) considers the
estimation problem for on-site sampling. First, assume that in the absence
of endogenous stratification the probability density of visits by individual i,
given characteristics x0 , is g(yi |x0 ). Suppose there are m sampled individuals
with x = x0 . Then the probability that individual i is observed to make y 0
visits is
Pr[yi = y 0 |x0 ] = Pr[sampled value is y 0 and sampled individual is i]
= Pr[sampled value is y 0 ] Pr[sampled individual is i]
= g(y 0 |x0 )

yi
.
y1 + y2 + . . . + yi−1 + yi + . . . + ym

Next consider the probability of observing y 0 visits across all individuals, not
just the i th individual, Pr[y = y 0 |x0 ], denoted Pm . This is the weighted sum of
probability of y 0 visits, where the weight of the i th individual, i = 1, . . . , m,
is y 0 /(y1 + y2 + . . . + yi−1 + y 0 + yi+1 + . . . . + ym ). Then
Pm = g(y 0 |x0 )

y0
y 0 +y2 +...+yi−1 +yi +...+ym

+ .... +

y0
y1 +y2 +...+yi−1 +yi +...+y 0



0

= g(y 0 |x0 ) m1 (y 0 +y +...+y y +y +...+y )/m + . . . .
2
i−1
i
m

y0
+ (y +y +...+y +y +...+y 0 )/m .
1

2

i−1

i

If we let m → ∞, the denominators inside the brackets above approaches the
population mean value of y, given x = x0 ,

E[y 0 |x0 ] =

∞

y 0 =1

y 0 g(y 0 |x0 ).

10.7 Alternative Sampling Frames

Then


lim Pm = g(y 0 |x0 ) m1

∞

m→∞

y 0 =1

y0
y 0 g(y 0 |x0 )

411

+ ... +

∞

y 0 =1

y0
y 0 g(y 0 |x0 )

y 0 g(y 0 |x0 )
.
= ∞
0
0 0
y 0 =1 y g(y |x )
This argument and derivation show that the relation between the density,
g s (yi |xi ), for the endogenously stratified sample, and the population density,
g(yi |xi ), is given by
f s (yi |xi ) = g(yi |xi ) ∞

y 0 =1

yi
y 0 g(y 0 |xi )

= g(yi |xi )ω(yi , μi ),

(10.49)

where ω(yi |μi ) = yi /μi . The key result is (10.49). This expression specializes
to the following if the population density is P[μi ]:
y −1

f s (yi |xi ) =

e−μi μi i
,
(yi − 1)!

(10.50)

where
E [yi |xi ] = μi + 1

(10.51)

V [yi |xi ] = μi .

Notice that the sample displays underdispersion even though the population
shows equidispersion. Maximization of the likelihood based on (10.50) can be
interpreted as maximizing a weighted likelihood. The case considered here is
a special case of the more general discussion of endogenous sampling in the
preceding section.
An interesting implication of the analysis is that there is a computationally
simple way of maximizing this particular weighted likelihood. This is achieved
by making the transformation wi = yi − 1 because the resulting sample space
for wi is the same as that for the regular Poisson likelihood for wi . That is,
applying the Poisson model to the original data with 1 subtracted from all
y observations yields consistent estimates of the population mean parameter
because
y −1

i
e−μi μi i
e−μi μw
i
=
,
wi !
(yi − 1)!

yi = 1, 2, . . . .

(10.52)

Hence, estimation can be implemented with the usually available software for
Poisson maximum likelihood, whereas maximum likelihood estimation based
on (10.50) requires additional (although not difficult) programming.
Although the support for the zero-truncated Poisson (section 4.5) and the
choice-based Poisson is the same, the two distributions are different. Specifically, in the truncated Poisson case,
E[yi |yi ≥ 0] = μi /(1 − e−μi ) > V[yi |yi ≥ 0],

412

Endogenous Regressors and Selection

which implies underdispersion. Choice-based sampling also displays underdispersion, but it arises from a shift in the probability distribution.
The approach developed here can be extended for any parent population
density by specializing (10.49). Englin and Shonkwiler (1995) substitute the
weighted negative binomial in place of the weighted Poisson and show that
the subtraction device shown earlier for the Poisson also works for the negative binomial. Santos Silva (1997) considers the implications of unobserved
heterogeneity in the same model.
10.8 BIBLIOGRAPHIC NOTES
Terza (1998) presents the selection model in detail; see also Greene (2007).
For parametric models of binary endogenous regressors see Greene (2009)
and, for the multinomial case, Deb and Trivedi (2006a). A good reference for
the different GMM estimators for endogenous regressors, and associated optimal instruments, is Windmeijer and Santos Silva (1997). The control function
approach, which has a long history in the discrete choice models literature (see
Heckman and Robb, 1985), was introduced to count models by Wooldridge
(1997a); see also Terza et al. (2008). Manski and McFadden (1981) survey
and discuss choice-based sampling in the context of discrete choice models.
Imbens and Lancaster (1994) deal with endogenous sampling and give many
useful references.

CHAPTER 11

Flexible Methods for Counts

11.1 INTRODUCTION
Much of this book has focused on Poisson and negative binomial regression.
Chapter 4 introduced more flexible parametric models, most notably finite
mixture models. Here we present additional flexible models. The focus is on
the cross-section case, though some of the methods given here have potential
extension to time series, multivariate, or longitudinal count data and to treatment
of sample selection.
There are several types of flexible models. Flexible parametric models are
fully parametrized models, but are less restrictive than simpler models such as
the negative binomial. Semiparametric methods are partly parameterized models that entail, in part, an infinite-dimensional component. For example, this
is the case if the conditional mean is specified to be of form exp(xi β + λ(z))
where the function λ(·) is not specified and instead needs to be nonparametrically estimated. In some cases the infinite-dimensional component may not
affect estimation of desired parameters. For example, this is the case if we specify the conditional mean as exp(xi β), estimate by the usual Poisson estimator,
and then do inference based on no additional assumptions about the model.
Nonparametric methods do not entail a parametric component. For example,
the conditional mean may be g(xi ) where the function g(·) is not specified. We
focus on conditional density estimation and conditional mean estimation, but
also consider conditional variance and conditional quantile estimation. We also
consider potential efficiency gains to moment-based estimation when higherorder conditional moments are specified.
In section 11.2 we present a class of flexible functional forms for parametric distributions for count data based on polynomial series expansions.
In section 11.3 we consider more flexible models for the conditional mean,
focusing on the case in which a functional form is given for part but not
all of the conditional mean function. In section 11.4 we focus on efficient
estimation when a functional form is specified for the conditional mean but
not for the conditional variance. In section 11.5 we present quantile regression methods that account for the discreteness and nonnegativity of count data.
413

414

Flexible Methods for Counts

Section 11.6 presents kernel-based nonparametric methods for conditional density estimation and conditional mean estimation. Section 11.7 deals with efficient moment-based estimation, an extension of quasilikelihood estimation that
is cast here in the GMM framework. Section 11.8 presents an application that
illustrates several of the flexible parametric, semiparametric and nonparametric
methods presented in this chapter.
11.2 FLEXIBLE DISTRIBUTIONS USING SERIES
EXPANSIONS
A range of parametric models for count data that can be viewed as adaptations
of the basic Poisson or NB models to accommodate unobserved heterogeneity
and/or adjustments for excess zeros that were presented in Chapter 4. In this
section we present an alternative way to generate more flexible parametric
models, by a series expansion of a baseline density such as Poisson or NB. This
approach was used in the multivariate case in Chapter 8.7 to generate tests of
independence. Here we focus on the univariate case.
11.2.1

Semi-Nonparametric Maximum Likelihood

Gallant and Nychka (1987) propose approximating the distribution of an iid mdimensional random variable y using a squared power-series expansion around
an initial choice of density or baseline density, say f (y|λ). Thus
(Pp (y|a))2 f (y|λ)
,
hp (y|λ, a) = +
(Pp (z|a))2 f (z)dz

(11.1)

where Pp (y|a) is an m-variate p th order polynomial, a is the vector of coefficients of the polynomial, and the term in the denominator is a normalizing
constant. Squaring Pp (y|a) has the advantage of ensuring that the density is
positive. This is closely related to the series expansions in Chapter 8.7, where
Pp (y|a) was not squared and emphasis was placed on choosing Pp (y|a) to be
the orthogonal or orthonormal polynomials for the baselinedensity f (y|λ).
The estimators of λ and a maximize the log-likelihood ni=1 ln hp (yi |λ, a).
Gallant and Nychka (1987) show that, under fairly general conditions, if the
order p of the polynomial increases with sample size n then the estimator yields
consistent estimates of the density. This result holds for a wide range of choices
of baseline density. The estimator is called the semi-nonparametric maximum
likelihood estimator, where the nonparametric component is that the order p is
not fixed but grows with the sample size. This is analogous to not specifying
the number of components in a finite mixture model; see Chapter 4.8.
This result provides a strong basis for using (11.1) to obtain a class of flexible
distributions for any particular data. There are, however, several potential problems. First, the method may not be very parsimonious. Thus a poor initial choice
of baseline density may require a fairly high-order polynomial, a potential
problem even with large data sets of, say, 1,000 observations. Second, it may

11.2 Flexible Distributions Using Series Expansions

415

be difficult to obtain analytical expressions for the normalizing constant, especially in the multivariate case. Third, the normalizing constant usually leads to
a highly nonlinear log-likelihood function with multiple local maxima.
Finally, Gallant and Nychka establish only consistency. As with similar
nonparametric approaches, it is difficult to establish the asymptotic distribution.
One solution is to bootstrap, although the asymptotic properties of this particular
bootstrap do not appear to have been established.
A simpler approach is to select the order of the polynomial on the basis of the
BIC of Schwarz (1978), defined in Chapter 5.4.1, because this gives a relatively
large penalty for the lack of parsimony. Then inference could be based on the
assumption of correct specification of the ultimately chosen model. In principle
this can be formally tested on the basis of the information matrix test of White
(1980).
Gallant and Tauchen (1989) and various coauthors in many studies applied
models based on (11.1) to continuous finance data. There the baseline density
is the multivariate normal with mean μ and variance , with a particular
transformation used so that the normalizing constant is simply obtained as
a weighted sum of the first 2p moments of the univariate standard normal.
They advocated selecting the order of the polynomial on the basis of the BIC of
Schwarz (1978), defined in Chapter 5.4.1, which gives a relatively large penalty
for lack of parsimony. Here we adapt these methods to count data.
A more practical approach, that taken here, selects a baseline density and
a polynomial of order high enough to feel that the data is being well fit by
the model, makes the stronger assumption that this model is the dgp and
apply standard maximum likelihood results. This is similar to starting with the
Poisson, rejecting this in favor of NB2 and then using usual ML standard errors
of the NB2 model for inference.
11.2.2

General Results

We consider just a single dependent variable, presenting general results for
the univariate case, before specializing to count data with a Poisson density
as a baseline in the next subsection. Derivations are given in Cameron and
Johansson (1997).
Consider a scalar random variable y with baseline density f (y|λ), where λ is
possibly a vector. The density based on a squared polynomial series expansion
is
hp (y|λ, a) = f (y|λ)

Pp2 (y|a)
ηp (λ, a)

,

(11.2)

where Pp (y|a) is a p th -order polynomial
Pp (y|a) =

p

k=0

ak y k ,

(11.3)

416

Flexible Methods for Counts

a = (a0 a1 , . . . , ap ) with the normalization a0 = 1, and ηp (λ, a) is a normalizing constant term that ensures that the density hp (y|λ, a) sums to unity.
Squaring the polynomial ensures that the density is nonnegative. This is just
the univariate version of (11.1). It can be shown that
ηp (λ, a) =

p
p



ak al mk+l ,

(11.4)

k=0 l=0

where mr ≡ mr (λ) denotes the r th moment (not centered around the mean) of
the baseline density f (y|λ).
The moments of the random variable y with density gp (y|λ, a) can be readily
obtained from those of the baseline density f (y|λ) as
p p
ak al mk+l+r
.
(11.5)
E[y r ] = k=0 l=0
ηp (λ, a)
The r th moment of y generally differ from the r th moment of the baseline
density. In particular, the mean for the series expansion density hp (y|λ, a)
usually differs from that for the baseline density f (y|λ).
We consider estimation based on a sample {(yi , xi ), i = 1, . . . , n} of independent observations. Then yi |xi has density hp (yi |λi , ai ) where regressors can
be introduced by letting λi or ai be a specified function of xi and the parameters
that are to be estimated. As a simple example, suppose λi is a scalar determined
by a known function of regressors xi and an unknown parameter vector β,
λi = λ(xi , β),

(11.6)

and the polynomial coefficients a are unknown parameters that do not vary
with regressors. The log-likelihood function is then
L(β, a) =

n


{ ln f (yi |λ(xi , β)) + 2 ln Pp (yi |a) − ln ηp (λ(xi , β), a)},

i=1

(11.7)
with first-order conditions that, given ηp (λ, a) in (11.4), can be reexpressed as
p p

n 
∂L  ∂ ln f (yi |λi )
∂λi
k=0
l=0 ak al ∂mk+l,i /∂λi
p p
−
=
= 0,
∂β
∂λi
∂β
k=0
l=0 ak al mk+l,i
i=1
(11.8)
p


n

∂L
yj
k=0 ak mk+j,i


=
2 p
−
= 0,
p
p
k
∂aj
k=0 ak y
k=0
l=0 ak al mk+l,i
i=1
j = 1, . . . , p.

(11.9)

Cameron and Johansson do not establish semiparametric consistency of this
method. Instead, the density with chosen p is assumed to be correctly specified. Inference is based on the standard result that the MLE for β and a is

11.2 Flexible Distributions Using Series Expansions

417

asymptotically normal distributed with the variance matrix equal to the inverse
of the information matrix, under the assumption that the data are generated by
(11.2) and (11.6).
In principle this method is very easy to apply, provided analytical moments
of the baseline density are easily obtained. The maximum likelihood firstorder conditions simply involve derivatives of these moments with respect to λ,
and even then some optimization routines do not require specification of first
derivatives.
In practice there are two potential problems. First, the objective function is
very nonlinear in parameters and there are multiple optima. This is discussed in
the next subsection. Second, these series expansion densities may not be very
parsimonious or may not fit the data very well. This method’s usefulness can
really only be established by applications.
11.2.3

Poisson Polynomial Model

The preceding framework can be applied to a wide range of baseline densities.
Cameron and Johansson illustrated the use of this method if the baseline density
is the Poisson, so f (y|μ) = e−μ μy /y!. The motivation was a goal of modeling
underdispersed data, in which case the Poisson is a better starting point than
negative binomial.
They called this model the PPp model, for Poisson polynomial of order p.
Then λ = μ, and the normalizing constant ηp (μ, a) defined in (11.4) and the
moments E[y r ] defined in (11.5) are evaluated using the moments mr (μ) of the
Poisson, which can be obtained from the moment generating function using
mr (μ) = ∂ r exp(−μ + μet )/∂t r |t=0 .
As an example the PP2 model is
h2 (y|μ, a) =

e−μ μy (1 + a1 y + a2 y 2 )2
,
y!
η2 (a, μ)

(11.10)

where
η2 (a, μ) = 1 + 2a1 m1 + (a12 + 2a2 )m2 + 2a1 a2 m3 + a22 m4 . (11.11)
Note that μ here refers to the mean of the baseline density. In fact the first two
moments of y for the PP2 density are
E[y] = (m1 + 2a1 m2 + (a12 + 2a2 )m3 + 2a1 a2 m4 + a22 m5 )/η2 (a, μ)
E[y 2 ] = (m2 + 2a1 m3 + (a12 + 2a2 )m4 + 2a1 a2 m5 + a22 m6 )/η2 (a, μ).
(11.12)
Estimation requires evaluation of (11.11) and hence the first four moments of
the Poisson density; evaluation of the mean and variance from (11.12) requires

418

Flexible Methods for Counts

the first six noncentral moments of the Poisson density. These moments are as
follows:
m1 = μ
m2 = μ + μ2
m3 = μ + 3μ2 + μ3
m4 = μ + 7μ2 + 6μ3 + μ4
m5 = μ + 15μ2 + 25μ3 + 10μ4 + μ5
m6 = μ + 31μ2 + 90μ3 + 65μ4 + 15μ5 + μ6 .
The PPp model permits a wide range of models for count data, including multimodal densities and densities with either underdispersion or overdispersion.
For the PPp model if the baseline density has an exponential mean, so
λi = exp(xi β), the first-order condition (11.8) simplifies to
p p

n 

∂LPPp
k=0
l=0 ak al mk+l+1,i
=
yi − p p
xi .
∂β
k=0
l=0 ak al mk+l,i
i=1

(11.13)

Using (11.5) with r = 1 and (11.4), (11.13) can be reexpressed as

∂LPPp
(yi − E[yi |xi ]) xi = 0.
=
∂β
i=1
n

(11.14)

Thus the residual is orthogonal to the regressors, and the residuals sum to zero
if an intercept term is included in the model. The result (11.14) holds more
generally if the baseline density is an LEF density with the conditional mean
function corresponding to the canonical link function.
As is common for many nonlinear models, the likelihood function can have
multiple optima. To increase the likelihood that a global maximum is obtained,
Cameron and Johansson use fast simulated annealing (Szu and Hartley, 1987),
a variation on simulated annealing (see Goffe, Ferrier, and Rogers, 1994), to
obtain parameter estimates close to the global optima that are used as starting
values for standard gradient methods. The advantage of simulated annealing
techniques is that they permit movements that decrease the value of the objective
function, so that one is not necessarily locked into moving to the local maxima
closest to the starting values, though performance relies on user specification of
a tuning parameter. Cameron and Johansson find that using a range of starting
values improves considerably the success of the Newton-Raphson method in
finding the global maximum, but it is better still to use the fast simulated
annealing method.
For the underdispersed takeover bids data introduced in Chapter 5.2.5,
Cameron and Johansson find that a PP1 model provides the best fit in terms of
BIC and performs better than other models proposed for underdispersed data:
the Katz, hurdle, and double Poisson.

11.2 Flexible Distributions Using Series Expansions

11.2.4

419

Negative Binomial Polynomial Model

The PPp model permits a wide range of flexible models for count data, including multimodal densities and densities with either underdispersion or overdispersion. However, as previously mentioned there are potential limitations,
including a lack of parsimony, inappropriate choice of the baseline density,
and computationally challenging log-likelihood functions. For overdispersed
data it is better to choose the negative binomial (NB2) as the baseline density.
The resulting family of distributions are referred to by the acronym NBPp.
For the NBPp case the moments of the baseline density are as follows:
m1 = μ
m2 = μ + (1 + α)μ2
m3 = μ + 3(1 + α)μ2 + (1 + α)(1 + 2α)μ3
m4 = μ + 7(1 + α)μ2 + 6(1 + α)(1 + 2α)μ3 + (1 + α)(1 + 2α)(1 + 3α)μ4
m5 = μ + 15(1 + α)μ2 + 25(1 + α)(1 + 2α)μ3
+ 10(1 + α)(1 + 2α)(1 + 3α)μ4 + (1 + α)(1 + 2α)(1 + 3α)(1 + 4α)μ5 .
These moments were calculated in Guo and Trivedi (2002) by extending the
calculations for the PPp model reported in Cameron and Johansson (1997).
A special case is the NBP1 model, which has log-likelihood
L(β, α, a) =

n


{ ln f (yi |xi , β, α) + ln((1 + a1 yi )2 )

i=1

− ln(1 + 2a1 μi + a12 (μi + (1 + α)μ2i )},

(11.15)

where μi = exp(xi β) and f (yi |xi , β, α) is the NB2 density given in Chapter
3.3.1. The conditional mean is this model is
E[y] =

μ + 2a[μ + (1 + α)μ2 ] + a 2 [μ + 3(1 + α)μ2 + (1 + α)(1 + 2α)μ3 ]
,
1 + 2aμ + a 2 [μ + (1 + α)μ2 ]

so that marginal effects are complicated to compute.
11.2.5

Modified Power Series Distributions

The family of modified power series distributions (MPSDs) for nonnegative
integer-valued random variables y is defined by the pdf
f (y|λ) =

a(λ)y b(y)
,
c(λ)

where c(λ) is a normalizing constant

a(λ)y b(y),
c(λ) =
y∈I

(11.16)

(11.17)

420

Flexible Methods for Counts

b(y) > 0 depends only on y, and a(λ) and c(λ) are positive, finite, and differentiable functions of the parameter λ. If a distribution belongs to the MPSD
class, then the truncated version of the same distribution is also an MPSD. The
MPSD permits the range of y to be a subset, say T , of the set I of nonnegative
integers, in which case the summation in (11.17) is for 
y ∈ T.
For the MPSD density, differentiating the identity y∈I f (y|λ) = 1 with
respect to λ yields

∂ ln a(λ) −1 ∂ ln c(λ)
a(λ) c (λ)
=
,
(11.18)
E[y] ≡ μ = 
a (λ) c(λ)
∂λ
∂λ
where a  (λ) = ∂a(λ)/∂λ and c (λ) = ∂c(λ)/∂λ. The variance is

a(λ) ∂μ
∂ ln a(λ) −1 ∂μ
=
.
V[y] ≡ μ2 = 
a (λ) ∂λ
∂λ
∂λ
Higher order central moments, μr = E[(y − μ)r ], can be derived from the
recurrence relation
a(λ) dλr−1
r ≥ 3,
(11.19)
+ rμ2 μr−2 ,
μr = 
a (λ) dλ
where μr−2 = 0 for r = 3.
The MPSD family, proposed by Gupta (1974), is a generalization of the
family of power series distributions (PSDs). The
 PSD is obtained by replacing
a(λ) in (11.16) by λ, in which case c(λ) = y∈I b(y)λy . This provides the
motivation for the term power series density, because it is based on a power
series expansion of the function c(λ) with different choices of c(λ) leading
to different densities. An early reference for the PSD is Noack (1950). The
generalized PSD family is obtained from the PSD if the support of y is
restricted to a subset of the nonnegative integers. A generalization of the MPSD
is the class of Lagrange probability distributions proposed by Consul and
Shenton (1972). There is an extensive statistical literature on these families.
Some discussion is given in Johnson, Kemp, and Kotz (2005), with more
extensive discussion in various entries in Kotz and Johnston (1982–1989).
These densities have rarely been applied in a regression setting.
For nonnegative integer-valued random variables, the MPSD is a generalization of the LEF. To see this, note that (11.16) can be reexpressed as
f (y|λ) = exp{− ln c(λ) + ln b(y) + ln a(λ)y}. This is exactly the same functional form as the LEF defined in Chapter 2.4.2, except it is parametrized
in terms of λ rather than the mean μ. However, it is not a mean parameterization of the density. The difference is that the LEF places strong restrictions on a(λ) and c(λ). Here the restrictions are not as strong. The MPSD
therefore includes the Poisson and the NB2 (with overdispersion parameter
specified). For the Poisson, a(λ) = λ, b(y) = 1/y! and c(λ) = eλ . For the
NB2, a(λ) = [1 − λ/(λ + α −1 )]−1/α , b(y) = (α −1 + y)/[(y + 1)(α −1 ),
and c(λ) = λ/(λ + α −1 ). The MPSD also includes the logarithmic series distributions.

11.3 Flexible Models of the Conditional Mean

421

The MPSD family is potentially very flexible. One modeling strategy is to
begin with a particular choice of a(λ) and b(y) and then progressively generalize
b(y), which also changes the normalizing constant c(λ). To be specific, the
function b(y) in (11.16) can be modified so that it also depends on additional
parameters to be estimated, say a, and consequently the term c(λ) will also
depend on a.
The PPp model presented in section 11.2.3 is an MPSD model. For example, the PP2 density (11.10) is (11.16) with a(λ) = λ, b(y, a) = (1 + a1 y +
a2 y 2 )2 /y!, and c(λ, a) = η2 (a, λ)/e−λ . This results from choosing the baseline
density, here the Poisson, to be an LEF density. With other choices of baseline
density f (y|λ) in (11.2), models found by series expansion as in section 11.2.2
need not be related to MPSD models.
11.3 FLEXIBLE MODELS OF THE CONDITIONAL
MEAN
The standard semiparametric methods that have been developed for conditional
mean estimation, such as those for single-index models, can still be applied
when the dependent variable is a count. But these methods generally assume
iid errors, so they will be inefficient in count models that are intrinsically
heteroskedastic. These methods have been adapted for more efficient estimation
when the variance depends on a specified function of the mean.
11.3.1

Flexible Parametric Models

Before presenting semiparametric methods, we consider parametric models for
the conditional mean that are more flexible than the exponential model for the
conditional mean.
The standard extension of an exponential conditional mean, corresponding
to a log link function, is to model the linear predictor as a Box-Cox modified
power transformation of the mean. Thus
⎧
⎨ μλi − 1
if λ = 0
(11.20)
ηi = xi β =
⎩ ln μλ
if
λ
=
0.
i
It follows that the conditional mean

(λxi β + 1)1/λ
μi = μ(xi , β, λ) =
exp(xi β)

if λ = 0
if λ = 0.

(11.21)

This model has the attraction of including the exponential conditional mean
as a special case and still being of single-index form. To ensure that μi > 0
we need λxi β + 1 > 0, which in turn requires xi β > (−1/λ) if λ > 0 and
xi β < (−1/λ) if λ < 0.
From Chapter 2.4 the GLM estimator forthe Poisson model with vari∂μi
n
1
ance φμi solves the first-order conditions
i=1 μ (y − μi ) ∂θ = 0. Here
i

422

Flexible Methods for Counts

θ = (β  λ) , and some algebra yields for λ = 0, ∂μ/∂η = μ1−λ , ∂η/∂λ =
(μ/λ2 )(1 − μ−λ − λ ln μ), and ∂η/∂β = x. It follows that β and λ solve the
estimating equations
n

(y − μi )μ−λ
i xi = 0,

(11.22)

i=1
n


2
(y − μi )(1 − μ−λ
i − λ ln μi )/λ = 0.

i=1

As is clear from the second equation, we need to ensure μi > 0, which requires
λxi β + 1 > 0.
Once the model is estimated, interpretation is based on the marginal effect
∂E[y|x]
= μ1−λ
βj .
i
∂xj

(11.23)

The marginal effects are a positive multiple of the coefficients and equal μi β j
when λ = 0.
Pregibon (1980) proposed use of such transformations as a diagnostic for testing correct specification of the link function in generalized linear models. More generally he considered the two-parameter transformation
η = ((μ + α)λ − 1)/λ; McCullagh and Nelder (1989, pp. 375–378) provide a
useful summary. Scallan, Gilchrist, and Green (1984) discuss in more detail
estimation based on the estimating equations (11.22). Basu and Rathouz (2005)
provide simulations and an application that also introduces a flexible parametric
model for the variance; see section 11.4.1.
11.3.2

Single-Index Models

We consider single-index models with the conditional mean a scalar function of
a linear combination of the regressors, with E[y|x] = g(x β), where the scalar
function g(·) is unspecified.
For an unknown function g(·) the single-index model β is only identified up
to location and scale. To see this, note that for scalar v the function g ∗ (a + bv)
can always be expressed as g(v), so the function g ∗ (a + bx β) is equivalent to
g(x β). Common normalizations are to drop the intercept and restrict β =

k
2
j =1 β j = 1. Additionally g(·) must be differentiable. In the simplest case all
regressors are continuous. If instead some regressors are discrete, then at least
one regressor must be continuous; see Ichimura (1993).
Several different estimators have been proposed that lead to a root-n consistent and asymptotically normal estimator of β and an estimator of the function
g(·) that is consistent, though with a convergence rate less than root-n. These
estimators include semiparametric least squares (Ichimura, 1993) and average
derivative estimation (Härdle and Stoker, 1989). See, for example, Pagan and

11.3 Flexible Models of the Conditional Mean

423

Ullah (1999) and Li and Racine (2007). These estimators ignore the intrinsic
heteroskedasticity of count data, so will be inefficient.
For generalized linear models with a specified variance function, Weisberg
and Welsh (1994) propose a more efficient version of Ichimura’s semiparametric least squares. We suppose
E[yi |xi ] = g(xi β)

(11.24)

V[yi |xi ] = φv(g(xi β)),
where the functional form for the mean function g(·) is not specified, but that
for the variance function υ(·) is specified. For counts usually φυ(μ) = φμ or
φυ(μ) = μ + αμ2 . If g(·) were known, then β solves
n

(y − g(x β))
i

i=1

υ(g(xi β))

g  (xi β)xi = 0.

(11.25)

With g(·) unknown estimation follows an alternating procedure. Given an initial
estimate β̂, for example from standard Poisson regression, estimate ĝ(·) by
kernel regression of yi on xi β̂ and then, given ĝ(·) and β̂, estimate the firstderivative ĝ  (·) by kernel methods. Then reestimate β based on the equations
(11.25) with the unknown functions g(·) and g  (·) replaced by estimates ĝ(·)
and ĝ  (·), and so on.
Weisberg and Welsh (1994) show that the resulting estimator of β has the
same asymptotic distribution as in the usual GLM case where g(·) is known,
and that if a second-order kernel is used the estimate ĝ(·) converges to g(·) at
the optimal convergence rate of n2/5 .
11.3.3

Generalized Partially Linear Models

For linear regression a common semiparametric model is the partially linear
model with conditional mean E[y|x, z] = x β + γ (z), where the function γ (z)
is not specified. Several estimators for this model have been proposed. For
example, Robinson (1988) proposes estimation of β by OLS regression of
y − Ê[y|z] on (x − Ê[x|z]), where Ê[y|z] and Ê[x|z] are nonparametric kernel
regression estimates of E[y|z]and E[x|z].
We now consider generalization to GLMs, where the baseline conditional
mean function is a specified nonlinear function and a model for the intrinsic
heteroskedasticity is also specified. Then
E[yi |xi , zi ]
V[yi |xi , zi ]

= μ(xi β + γ (zi ))
= φ υ(μ(xi β + γ (zi ))),

(11.26)

where the functions μ(·) and υ(·) are specified, and γ (·) is an unknown smooth
function. For counts μ(·) is typically an exponential function and υ(μ) = μ. In
the case of scalar z the traditional parametric approach to obtaining a flexible
specification with respect to z is to let γ (z) be a polynomial function of z. Greater
generality can be achieved by treating this component nonparametrically.

424

Flexible Methods for Counts

nSeverini and Staniswalis (1994) proposed the following approach. Let

i=1 q(μ(xi β + γ (zi ))) denote the quasilikelihood function. If γ (zi ) = zi α,
then the estimates α and β solve
n

∂q(μ(x β + z α))
i

i=1

i

∂α

=0

(11.27)

= 0.

(11.28)

and
n

∂q(μ(x β + z α))
i

i=1

∂β

i

One way to solve these two equations is to iterate, first solving (11.27) for α
given an estimate of β and then solving (11.28) for β given an estimate of α,
and so on.
Here the functional form γ (zi ) is unspecified. Then instead of solving (11.27)
when β is fixed, the quasilikelihood estimate of η = γ (z, β) – that is, η evaluated at a particular value z – solves the equation



n

z − zj ∂q μ(xj β + η)
K
= 0,
(11.29)
b
∂η
j =1
where K(·) is a given kernel function K(·) with bandwidth parameter b > 0, and
observables z. The motivation for this estimator is that, given β, the problem
reduces to semiparametric estimation in a model with density f (y|γ (z)) where
f (·) is specified and γ (·) is not specified. In that case one can use the kernelweighted log-likelihood estimator of Staniswalis (1989). Given η̂(zi , β), i =
1, . . . , n that solves (11.29), the maximum quasilikelihood estimates of β solve


n

∂q μ(xi β + η̂(zi , β))
= 0,
(11.30)
∂β
i=1
which is a parametric estimation problem. In general these equations are solved
iteratively. The resulting estimator of β is root-n consistent and an asymptoti1/4
cally normal estimator of β, while γ̂ (·) converges at rate
nn . 
For the Poisson model the quasilikelihood is
i=1 yi (xi β + λ(zi )) −
exp(xi β + λ(zi )). Then (11.29) can be solved explicitly to yield

⎛ n
⎞
z−zj
yj
j =1 K
b
⎠.

η̂(z, β) = ln ⎝ 
z−zj
n

exp(xj β)
j =1 K
b
Then β is estimated by Poisson regression of yi on xi and η̂(zi , β), where the
coefficient of η̂(zi , β) is constrained to be one.
In practice the user of this method needs to determine which variables
constitute the z subset and which ones the x subset. Although such choices are
context specific, given the constraint that γ (·) should be smooth, z should be
continuous variable.

11.4 Flexible Models of the Conditional Variance

11.3.4

425

Generalized Additive Models

An alternative class of flexible models of the conditional mean, one embedded
in the GLM framework, is the generalized additive model due to Hastie and
Tibshirani (1990).

β in the GLM class model is replaced by
Then the linear component x
an additive model of the form kj =2 fj (xj ), where fj (·) are nonparametric
univariate functions, one for each covariate. Then
⎛
⎞
k

E[yi |xi ] = g ⎝β 1 +
fj (xj i )⎠ ,
(11.31)
j =2

where xj i is the j th component of xi , the function g(·) is specified while the fj (·)
are not, and V[yi |xi ] = φ υ(E[yi |xi ]) for specified function υ(·). For Poisson
regression g(·) = exp(·) and υ(μ) = μ.
Despite its additive nature, this model can accommodate interactions by
defining, for example, x3i = x1i x2i .
11.4 FLEXIBLE MODELS OF THE CONDITIONAL
VARIANCE
The preceding section considered flexible models for the conditional mean, but
restricted the conditional variance to be a specified function of the conditional
mean, such as a multiple of the mean. The estimators remain consistent if the
variance function is misspecified, and robust standard errors can be obtained,
but there is a potential efficiency loss.
In this section we consider more flexible models for the variance. In some
cases the model for the conditional mean is specified, whereas in other cases it
is not.
11.4.1

Flexible Parametric Models

Basu and Rathouz (2005) consider models with flexible parameterization of
the mean and the variance. For the conditional mean they specify

(λxi β + 1)1/λ if λ = 0
(11.32)
μi = μ(xi , β, λ) =
exp(xi β)
if λ = 0.
Then μ(xi , β, λ) = (λxi β + 1)1/λ if λ = 0 and μ(xi , β, λ) = exp(xi β) if λ =
0. This is the Box-Cox modified power transformation, defined in section
11.3.1. The conditional variance is modeled using either a power family
φ

vi = V[yi |xi ] = φ 1 μi 2

(11.33)

or a quadratic variance function
vi = V[yi |xi ] = v(μi ) = φ 1 μi + φ 2 μ2i .

(11.34)

426

Flexible Methods for Counts

Estimation is by extended quasilikelihood. Defining θ = (β  λ) and φ =
(φ 1 φ 2 ) , the estimators θ̂ and φ̂ solve
n (yi −μi ) ∂vi
=0
i=1
vi
∂θ
(11.35)
n (yi −μi )2 −vi ∂vi
= 0.
i=1
∂φ
v2
i

Basu and Rathouz (2005) report in detail results from a range of simulations
from parametric models, including for a gamma-distributed dgp, which they
note yields very similar results to the Poisson and negative binomial. They
provide a substantial application to hospital expenditure data that are not well
modeled by a gamma model and, if modeled as log-expenditures, need strong
distributional assumptions to transform back to enable predictions of the level
of expenditures.
11.4.2

Mixture Models for Heterogeneity

Given a baseline Poisson model, richer models for the conditional variance
can be obtained by introducing unobserved heterogeneity. Letting f (yi |xi , ν i )
denote the Poisson density with conditional mean μi ν i = exp(xi β)ν i , where
ν i has density g(ν i ), leads to the density

h(yi |xi ) = f (yi |xi , ν i )g(ν i )dν i ,
(11.36)
introduced in Chapter 4. Unlike Chapter 4, the distribution of the unobserved
heterogeneity component is treated as unknown. In this section we consider
flexible models for the mixture density g(ν i ), leading to more flexible models
for h(yi |xi ).
One method, already detailed in Chapter 4.8, is to specify a finite mixtures
model
h(yi |xi , β, π ) =

C


π j f (yi |xi , β, ν j ),

(11.37)

j =1

where only the intercept varies across models. For the Poisson with an exponential mean, this representation of heterogeneity may be interpreted as a
random-intercept model in which the intercept is (β 0 + ν j ) with probability
π j . It is detailed in Chapter 4.8. The subpopulation with each intercept is
treated as a “type,” and the number of types, C, is estimated from the data
along with π and β. The method has both a “nonparametric” component,
because it avoids distributional assumptions on ν, and a parametric component,
the density f (y|x, β, ν). It is standard terminology in the statistics literature to
call the estimator an SPMLE if C is taken as given and maximum likelihood
estimation is done for the unknown parameters (β, π j ).
A second method, which we present in considerable detail, uses a continuous mixture model with a flexible parametric distribution for the random
heterogeneity component ν. If y conditional on μ and ν is P[μν]-distributed,

11.4 Flexible Models of the Conditional Variance

the mixture density (11.36), suppressing the subscript i, is
 −μν
e (νμ)y
g(ν)dν
h(y|μ) =
y!

μy
ν y e−μν g(ν)dν.
=
y!

427

(11.38)

Gurmu, Rilstone, and Stern (1999) proposed approximating the unknown mixture density g(ν) by gp∗ (ν), a squared p th -order orthonormal polynomial expansion defined later, and analytically calculating the integral in (11.38) with
respect to gp∗ (ν) rather than g(ν). This model, which they call semiparametric
MLE, will approximate any density g(ν) as p → ∞, and it includes the Poisson
and NB as special cases.
Specifically, the approximating density gp∗ (ν) is
gp∗ (ν|λ, γ ) = f (ν|λ, γ )

Pp2 (ν|λ, γ , a)
ηp (λ, γ , a)

,

(11.39)

where the baseline density f (ν|λ, γ ) is the two-parameter gamma density
f (ν|λ, γ ) =

ν γ −1 λγ −λν
e ,
(γ )

(11.40)

and the polynomial Pp (ν|α, γ , a) is the p th -order orthonormal (see Chapter
8.7.1) generalized Laguerre polynomial
Pp (ν|λ, γ , a) =

p


−1/2

ak ηk

Qk (ν).

(11.41)

k=0

In (11.41) the k th -order orthogonal generalized Laguerre polynomial is
Qk (ν) =

k 

k
l=0

(k + γ )
λl (−ν)l ,
l (l + γ )(k + 1)

(11.42)

and orthonormalization is achieved by premultiplying Qk (ν) in (11.41) by
−1/2
ηk , with
ηk =

(k + γ )
.
(γ )(k + 1)

(11.43)

Orthonormalization leads to the normalizing constant in (11.39) being simply
ηp (λ, γ , a) =

p

k=0

ak2 .

(11.44)

+
Clearly, evaluating h(y) = ν y e−μν gp∗ (ν|λ, γ )dν is not straightforward.
Gurmu et al. observe, however, that the random
+ variable ν with density
g(ν) has the moment generating function Mν (t) = etν g(ν)dν, with y th -order

428

Flexible Methods for Counts
(y)

derivative Mν (t) = ∂ y Mν (t)/∂t y =
expressed as

+

h(y|μ) = [μy /y!]M(y)
ν (−μ).

ν y etν g(ν)dν. Thus (11.38) can be re(11.45)

Gurmu et al. obtain the analytical expression for M∗ν,p (t), the moment generating
function for gp∗ (ν|λ, γ ) defined by (11.39) through (11.44), and its y th -order
∗(y)
derivative Mν,p (t) = ∂ y M∗ν,p (t)/∂t y . Evaluation at t = −μ yields
∗(y)

 p p

1/2
μ −γ (γ ) p
2 −1
ak al ηk ηl
k=0 ak
y
k=0
l=0
(λ + μ)
λ
k l k  l (γ + r + s + y)
μ −(r+s)
×
.
−1 −
r=0
s=0 r
λ
s (γ + r)(γ + s)

Mν,p (−μ) = 1 +

(11.46)
Premultiplication by [μy /y!] yields at last the approximating density (11.38)
for the count variable.
The log-likelihood function for a sample of size n is
ln L(β, γ , λ, a) =

n





i)
yi ln μi − ln(yi !) + ln M∗(y
ν,p (−μi ) , (11.47)

i=1

where in practice μi = exp(xi β). The MLE is obtained in the usual way. Identification requires that E[ν i ] = M∗(1)
ν,p (0) = 1 and a0 = 1. Gurmu et al. (1999)
provide a formal statement and proof of the semiparametric consistency of this
procedure, meaning that gp∗ (ν) can approximate any density g(ν) as p → ∞
and n → ∞, but to date its asymptotic distribution as p → ∞ has not been
established.
This type of mixture representation generalizes the treatment of heterogeneity, but does not alter the specification of the conditional mean in any way.
One advantage of using Laguerre polynomial expansion is that the leading
term is the gamma density, which has been used widely as a mixing distribution in count and duration literature. Thus, if higher terms in the expansion
vanish and γ = λ , we obtain the popular NB2 model of the earlier chapters,
with γ = λ = α −1 . Furthermore, if γ −1 = λ−1 → 0 and aj = 0 for j ≥ 1, the
Poisson model is obtained. Unlike semiparametric methods based on discrete
mixtures, such as that in the preceding subsection, the series expansion method
provides smooth estimation of the distribution of unobserved heterogeneity.
This form of heterogeneity representation is computationally demanding.
The complexity of the last term in the log-likelihood hinders an analytical
study of the likelihood. As with other series-based likelihoods there remains
a possibility of multiple maxima. Gurmu et al. (1999) treat p as unknown
and compute the standard errors by computer-intensive bootstrap methods.
Alternatively, if the estimated value of p is treated as correct, one can use the
outer product of numerically evaluated gradients of (11.47). As in other studies,

11.4 Flexible Models of the Conditional Variance

429

information criteria are used to select the number of terms p in the expansion.
In principal one can test for a global maximum using the test of Gan and Jiang
(1999).
Gurmu et al. (1999) show that this method can be extended to Poisson
models with censoring, truncation, and excess zeros and ones. They apply the
model to censored data on the number of shopping trips to a shopping mall
in a month taken by 828 shoppers, where 7.9% of the observations are rightcensored due to the highest category being recorded as 3 or more and the data
are somewhat overdispersed with a sample variance that is 2.1 times the sample
mean. They prefer a model with p = 2, meaning two terms more than the NB2.
Application by Gurmu and Trivedi (1996) to uncensored data is presented in
section 11.7. In Gurmu (1997) the method is extended and applied to the hurdle
model, leading to a model that nests the hurdle specifications considered in
Chapter 4.7. Although appealing in principle, a potential problem with the
hurdle specification is overfitting due to estimation of two parts of the model.
11.4.3

Semiparametric Nonlinear Weighted Least Squares

The methods of the previous subsection model the conditional distribution
of the count. Now consider modeling only the conditional mean, when the
conditional variance is completely unspecified.
Then the conditional variance is estimated nonparametrically. In ideal circumstances one can obtain estimates of the conditional mean parameters that
are as efficient when the variance function is unspecified as they are when
it is specified. Then the estimation method is called adaptive. Note that it is
more ambitious than methods presented in Chapter 3 for an unknown variance
function. With those methods, if the variance function was not specified or at
least not assumed to be correctly specified, the goal was to obtain consistent
parameter estimates and valid standard errors. Efficient estimation was not a
goal.
For the linear model, with E[yi |xi ] Robinson introduced a semiparametric
WLS estimator for the linear regression model in which the weights, the inverse
of the square root of the error variance σ 2i , are consistently estimated from
residuals ûi = yi − xi β̂ generated by the first-stage regression of y on x. If
there were many observations on yi for a given value of xi we could let σ̂ 2i
simply be the average of û2i for those observations. More generally a local
average is used, and the estimated variances σ̂ 2i are obtained by nonparametric
regression of û2i on xi , where the method of k nearest neighbors (see, for
example, Altman, 1992), is used rather than kernel methods. Here k can be
viewed as a smoothing parameter, similar to the bandwidth in kernel methods,
which determines the number of observations that are used in estimating each
σ 2i . A technical requirement is that the degree of smoothness should increase
with the sample size, albeit at a slower rate. The properties of the estimator
depend on the choice of the number of nearest neighbors. Values of k = n1/2 and

430

Flexible Methods for Counts

k = n3/5 have been used in empirical work; better is to use data-driven crossvalidation methods. The resulting WLS estimator is shown to be adaptive.
Formally this means it attains the semiparametric efficiency bound among
estimators, given the specification of the conditional mean.
Delgado and Kniesner (1997) adapt the Robinson approach to heteroskedasticity of unknown functional form when the conditional mean function is exponential rather than linear. Following Robinson, given an initial root-n consistent
estimator 
β, such as the NLS estimator or the Poisson MLE, they estimate the
conditional variances σ 2i by the local averages
σ̂ 2i =

n

(yj − exp(xj 
β))2 wij ,

(11.48)

j =1

where the wij are k nearest neighbor weights that equal 1/k for the k observations xj closest to xi according to a squared distance metric defined in the
appendix to their paper, and equal 0 otherwise.
mean μi (xi , β) and known variance
In general for yi independent with 
σ 2i , the nonlinear GLS estimator solves ni=1 (yi − μi )(∂μi /∂β)/σ 2i = 0, and
here ∂μi /∂β = μi xi . Thus the semiparametric WLS estimator β̂ SP solves the
first-order conditions
n


(yi − exp(xi β̂ SP )) exp(xi β̂ SP )xi σ̂ −2
i = 0.

(11.49)

i=1

Under regularity conditions, β̂ SP is root-n consistent and asymptotically normal
with the variance matrix
 n
−1

 2 −2
xi xi μ̂i σ̂ i
.
(11.50)
V[β̂ SP ] =
i=1

In theory a robust sandwich variant of (11.50) is not needed. But in finite
samples one may want to guard against a poor choice of the number of neighbors
and use
−1 
−1


xi xi û2i μ̂2i σ̂ −4
xi xi μ̂2i σ̂ −2
,
xi xi μ̂2i σ̂ −2
VRS [β̂ SP ] =
i
i
i
where ûi = yi − exp(xi β̂ SP ) is the raw residual.
Delgado and Kniesner (1997) apply their method to a study of the factors
determining the number of spells of absence of a week or less for London bus
drivers. Their results appear to be more sensitive to the specification of the
conditional mean than the estimator for the conditional variance. Indeed, their
results suggest that the changes resulting from the use of the nonparametric
variance estimation compared with the NB assumption are not large, even
though the latter makes a very strong assumption that variances depend on the
mean. A possible reason for this is that in practice the NB variance specification
is a good approximation to heteroskedasticity of unknown form.

11.4 Flexible Models of the Conditional Variance

431

Delgado (1992) extended Robinson’s approach to the estimation of a multivariate (multi-equation) nonlinear regression. This estimator is a systems GLS
estimator based on k nearest neighbor estimates of the conditional variance
matrices. The approach is an attractive alternative to likelihood-based methods
in those cases in which the likelihood involves awkward integrals that cannot be simplified analytically. Multivariate count regressions with unrestricted
patterns of dependence, and mixed multivariate models with continuous and
discrete variables, fall into this category.
11.4.4

Semiparametric Estimation for GLMs

Chiou and Müller (1999) propose a semiparametric WLS estimator for GLMs
with specified conditional moment function and variance σ 2i = v(μi ), where the
function v(·) is unspecified. It makes the stronger assumption that the variance
is a function of the mean, as is typical for GLMs. It also has the advantage of
reducing the nonparametric component of the problem to one dimension, rather
than dim[xi ] for Delgado and Kniesner (1997), so the estimator may perform
better in finite samples.
In the special case of an exponential conditional mean, the estimator of
Chiou and Müller also solves (11.49). The difference is that the conditional
μ)2
variances σ̂ 2i are obtained by kernel or local polynomial regression of (y − 


on 
μ where 
μ = exp(x β) and β is a consistent first-step estimator of β.
11.4.5

Semiparametric Estimation of Mean and Variance

Chiou and Müller (1998) consider efficient estimation within the class of GLM
estimators when, as in (11.24),
E[yi |xi ] = g(xi β)
V[yi |xi ] =

(11.51)

v(g(xi β)),

but now the functional forms for neither the mean function g(·) nor the variance
function v(·) are specified.
The estimator is similar to that of Weisberg and Welsh (1994) detailed in
section 11.3.2, with an additional step for nonparametric estimation of v(·).
First, for given estimate β̂ estimate g(·) by local linear regression of y on xi β̂,
and estimate g  (·) by local quadratic regression. Second, given μ̂i = ĝ(xi β̂),
i = 1, . . . , n, estimate v(·) by local linear regression of (y − μ̂)2 on ĝ(·). Third,
given μ̂i = ĝ(xi β̂) and σ̂ 2i = v̂(ĝ(xi β̂)), i = 1, . . . , n, estimate β̂ based on the
equations (11.25) with the unknown functions g(·), g  (·), and v(·) replaced by
estimates ĝ(·), ĝ  (·), and v̂(·). This cycle is repeated until it converges. Chiou and
Müller (1998) provide data-driven bandwidth selection based on the deviance
and on Pearson’s chi-squared statistic.
Chiou and Müller (2005) provide a generalization to clustered data or longitudinal data. Then yij is independent over i, yij has conditional mean and

432

Flexible Methods for Counts

variance as in (11.51), while the conditional covariance within cluster j ,
Cov[yij , yi  j |xij , xi  j ] = h(g(xij β), g(xi  j β)),
for univariate function h(·) that is unspecified. Then an extra step is added to
nonparametrically estimate h(·), and the estimate β̂ is based on generalized
estimating equations, see Chapter 2.4.6, rather than (11.25).
11.5 QUANTILE REGRESSION FOR COUNTS
We have focused on models for the conditional mean of y and for the conditional
density of y and how they change as key regressors change. Interest may also
lie in the impact of regressors on the conditional quantiles of y, such as the
median, quartiles, and deciles. In principle these can be obtained from the
conditional density, but doing so requires correct specification of the conditional
density. Quantile regression instead directly estimates the conditional quantile,
analogous to least squares regression to estimate the conditional mean.
Quantile regression (QR) methods for continuous unbounded variables are
well established; see Koenker (2005) for a thorough treatment of properties
of QR. Here we consider an extension to count regression that accounts for
both the discreteness and nonnegativity of count data. The extension presented
here requires additional assumptions that can be avoided by taking the fully
nonparametric approach of Li and Racine (2008).
11.5.1

QR for Linear Regression

Let F (y) = Pr[Y ≤ y] define the cumulative distribution function. The q th
quantile of y, q ∈ (0, 1), is that value of y that splits the data into proportions q
(ymed ) =
below and 1 − q above. For example, the median ymed is such that F 
minimize
0.5, so ymed = F −1 (0.5). The median can be shown to
i |yi −

ymed |, and more generally the q th quantile α q minimizes ni:yi ≥αq q|yi − α q | +
n
i:yi <α q (1 − q)|yi − α q |.
Conditional quantile regression extends this to the regression case by supposing that the q th quantile equals x β q . Although this is a linear combination of the regressors, it need not necessarily be the case that the conditional
mean itself is linear in regressors. The conditional quantile estimator of β q
minimizes
Q(β q ) =

n

i:yi ≥xi β q

q|yi − xi β q | +

n


(1 − q)|yi − xi β q |,

0 < q < 1.

i:yi <xi β q

(11.52)
A major attraction of QR is that it potentially allows for response heterogeneity at different conditional quantiles of the variables of interest. There
are some similarities between the QR and finite mixture (FM) approaches.

11.5 Quantile Regression for Counts

433

As in the case of FM, QR facilitates a richer interpretation of the data. But
FM is fully parametric, whereas QR is consistent under weaker stochastic
assumptions. And conditional quantiles are equivariant to monotone transformations, provided the functional form for the conditional quantile is correctly
specified.
11.5.2

QR for Count Regression

We begin by noting that, whereas parametric models for counts can be used
to recover the conditional quantiles, the standard models are too restrictive.
Suppose y is distributed with Poisson density f (y|μ), where μ is modeled by a
single-index model, so μ = g(x β). Then some algebra yields ∂f (y|μ)/∂xj =
β j f (y|μ)(y − μ)/μ. Winkelmann (2006) points out that this result implies that
the marginal effect of a change in the regressor on Pr[Y = y|μ] obeys a singlecrossing property; in the case of β j > 0 the marginal effect is negative for
y < μ, and positive for y > μ. Then the marginal effect is necessarily negative
at low conditional quantiles and positive at high quantiles. Winkelmann shows
that this is also the case for the NB2 model.
This gives added motivation for directly modeling the conditional quantiles.
Since the conditional quantiles for counts are positive, an exponential functional form is chosen, rather than the usual linear form. More substantively
the discreteness of counts needs to accommodated. Machado and Santos Silva
(2005) propose a method to do so, and Miranda (2006, 2008) and Winkelmann (2006) provide interesting applications to fertility and doctor visits data,
respectively.
For counts the quantiles are not unique since the cdf is discontinuous with
discrete jumps between flat sections. By convention the lower boundary of the
interval defines the quantile in such a case. The lack of continuity is not in itself
a serious violation for count data that have a large dispersion and relatively few
tied values. But for many economics data sets, there can be a high proportion of
zeros and numerous cases of tied values. Then some modification is necessary
to allow the application of QR. This modification becomes less reasonable the
less dispersed are the data. For example, if 95% of count observations are zeros
then application of QR cannot be recommended.
The key step in the quantile count regression (QCR) model of Machado and
Santos Silva (2005) involves replacing the discrete count outcome y with a continuous variable z = h(y), where h(·) is a smooth continuous transformation.
The particular continuous transformation used is
zi = yi + ui ,

(11.53)

where u ∼ U[0, 1] is a pseudorandom draw from the uniform distribution on
(0, 1). This step, called “jittering,” eliminates the discontinuities in the cdf. We
can study the conditional quantiles of z, but it is the quantiles of y that are of
interest. We next show how they are related.

434

Flexible Methods for Counts

The conditional quantile for Qq (z|x) is specified to be
Qq (z|x) = q + exp(x β q ).

(11.54)

As already noted, the exponential functional form is chosen, while the additional
term q appears in the equation because Qq (z|x) is bounded from below by q,
due to the uniform jittering operation. To be able to estimate a quantile model
in the usual linear form x β, a log transformation is applied so that ln(z − q)
is modeled, with the adjustment that if z − q < 0 then we use ln(ε) where ε
is a small positive number. The transformation is justified by the equivariance
property of the quantiles, as well as the property that quantiles above the
censoring point are not affected by censoring from below.
Postestimation the z-quantiles Qq (z|x) are transformed back to y-quantiles
Qq (y|x). Because y is discrete the ceiling function is used, with
Qq (y|x) = Qq (z|x) − 1,

(11.55)

where the symbol r in the right-hand side of (11.55) denotes the smallest
integer greater than or equal to r. This means that Qq (y|x) = [Qq (z|x)] − 1 if
Qq (z|x) is integer-valued and equals [Qq (z|x)] otherwise.
Jittering adds additional variation to the data. To reduce the effect of noise
due to jittering, the model is estimated multiple times using independent draws
from the U(0, 1) distribution, and the multiple estimated coefficients and confidence interval endpoints are averaged. Hence the estimates of the quantiles
of y counts are based on
Q̂q (y|x) = Qq (z|x) − 1 = q + exp(x β̂ q ) − 1,

(11.56)

where β̂ q denotes the average over the jittered replications. A number of variance estimators for QR have been proposed in the literature. Machado and
Santos Silva (2005) discuss the related estimators for the count version of the
same.
Once Q̂q (y|x) is available, the impact of small changes in a selected covariate
(under the assumption of all else being equal) can be calculated as the difference
between Q̂q (y|xp ) − Q̂q (y|xc ) where the superscripts p and c denote perturbed
and control values.
The specific issue of how to choose the quantiles is discussed by Winkelmann
(2006); the usual practice is to select a few values such as q equal to 0.25, 0.50,
and 0.75. This practice has to be modified if there are many zeros in the
sample. For example, if there are 35% zeros in a sample, then q must be greater
than 0.35.
11.5.3

QR for Panel Counts

The preceding analysis applies to cross-section data. It extends to balanced
and unbalanced panel data if the panel is treated as a pooled cross-section; see
Winkelmann (2006) for an empirical example.

11.6 Nonparametric Methods

435

For panel data, however, the fixed and random effects framework is also
widely used. For the linear model there has been some attempt to extend QR to
panel data with fixed effects, but this literature is at a formative stage. Unlike
the linear regression case, eliminating the individual-specific fixed effects parameter in the QR context is not straightforward. And the typical formulation
of random effects based on parametric distributional assumption is not in the
spirit of the semiparametric methodology of QR.
Therefore, an alternative strategy such as that of Abrevaya and Dahl (2006)
is potentially attractive. They use the conditionally correlated random effects
model presented in Chapter 9.5.4 as a way to obtain an estimator of the
individual-specific effect. Then quantile regression is implemented to the model
with estimated individual-specific effects as additional regressors.
11.6 NONPARAMETRIC METHODS
The analysis to date has presented models that are semiparametric or flexible
parametric. Here we briefly review fully nonparametric methods. For concreteness we present only kernel methods, presented in detail in Li and Racine
(2007), though for any given nonparametric setting there can be a range of
alternative estimators such as nearest neighbors, smoothing splines, series, and
sieve estimators.
11.6.1

Nonparametric Conditional Density Estimation

For univariate continuous random variable Y , the kernel estimate of the density
at the evaluation point y is
1 
K
fˆ(y) =
nh i=1
n



yi − y
h

(11.57)

,

where the function
with properties that include at least
+ K(·) is a kernel function
+
K(z) = K(−z), K(z)dz = 1, and z2 K(z)dz√= κ > 0. A commonly used
kernel is the Gaussian kernel with K(z) = (1/ 2π ) exp(−z2 /2). The choice
of kernel function K(·) is less important than the choice of the bandwidth h
that theoretically should approach zero at an appropriate rate as n → ∞.
For multivariate continuous random variable Y of dimension m, the product
kernel estimate of the density at the evaluation point y = (y1 , . . . , ym ) is
m

1
K
n(h1 × · · · hm ) i=1 j =1
n

fˆ(y) =

yj i − yj
h


1
K (yi − y, h) ,
n(h1 × · · · hm ) i=1
n

=



(11.58)

436

Flexible Methods for Counts

where the second equality defines the m-dimensional kernel K (·). In the multivariate case the bandwidth h = (h1 , . . . , h) is usually chosen by leave-one-out
cross-validation, presented later for the regression case.
In regression applications, interest lies in the conditional density f (y|x) =
f (y, x)/f (x). The kernel estimate of the conditional density of y given regressors x is
fˆ(y, x)
,
fˆ(y|x) =
fˆ(x)

(11.59)

where fˆ(y, x) and fˆ(x) are obtained using (11.58) to estimate the joint data
density f (y, x) and the marginal density of the regressors f (x).
Given conditional density estimation, the conditional cdf and conditional
quantiles can also be estimated. The nonparametric conditional quantiles, due to
Li and Racine (2008), provide an alternative to the count conditional quantiles
in section 11.5 that needed to introduce jittering to handle the discreteness of
count data.
11.6.2

Nonparametric Conditional Mean Estimation

For univariate continuous random variable Y and continuous multivariate random variable X, the kernel estimate of the conditional mean of Y given X = x
is
n
yi K (xi − x, h)
,
(11.60)
ĝ(x) = i=1
n
i=1 K (xi − x, h)
where K(·) is a product kernel as in (11.58). The kernel regression estimate ĝ(x)
in (11.60) is also called
 the local constant estimator because it is equivalent to
â(x) that minimizes ni=1 (yi − a)2 K (xi − x, h).
In addition to the conditional mean, interest often lies in the marginal effects
g  (x) = ∂g  (x)/∂x. One way to estimate these marginal effects is to form the
local linear estimator that minimizes over a and b
n


(yi − a − (xi − x) b)2 K (xi − x, h) ,

(11.61)

i=1

in which case ĝ  (x) = b̂(x). and ĝ(x) = â(x)
The bandwidth h can be chosen by leave-one-out cross-validation. In the
case of local linear estimation the leave-one-out estimator when observation i
is dropped is (âi , b̂i ) that minimizes
n

j =1,j =i



(yi − a − (xj − xi ) b)2 K xj − xi , h .

(11.62)

11.6 Nonparametric Methods

437

For m regressors, the bandwidth h = (h1 , . . . , hm ) is chosen to minimize the
cross-validation measure
1
(yi − âi )2 M(xi ),
n i=1
n

CV(h) =

(11.63)

where M(·) is a suitable weight function that trims outlying values. Variations include generalized cross-validation and expected Kullback-Liebler crossvalidation (based on AIC for the nonparametric regression model).
11.6.3

Extensions

The preceding assumes continuous random variables. When random variables
are discrete we can always use frequency methods, replacing the kernel weighting function K((yi − y)/ h) by the indicator function 1[yi = y]. But in practice
this requires a large sample size and discrete random variables that take only a
few distinct values.
Li and Racine, in a series of papers including Hall, Racine, and Li (2004) that
are summarized in Li and Racine (2007), propose use of alternative weighting
functions that lead to smoother estimation, thereby reducing estimator variance
at the expense of introducing some bias as in the continuous case, and that
enable use of cross-validation for bandwidth selection.
For scalar probability mass function estimation with discrete random variable Y that takes c distinct values, the kernel function K((yi − y)/ h) in (11.57),
for example, is replaced by the weight function

1−λ
if yi = y
(11.64)
Kd (yi , y, λ) =
λ/(1 − c)
if yi = y,
where λ = 0 yields the frequency estimate and λ = 1 corresponds to a uniform
weight. For nonparametric regression with discrete regressor X, one can more
simply replace the kernel K((xi − x)/ h) with Kd (xi , x, λ) = 1 if xi = x and
Kd (xi , x, λ) = λ if xi = x. Although these weights no longer sum to one, in
the regression case this poses no problem because cancellation occurs since the
weight function appears in both the numerator and denominator of (11.60).
When discrete data are ordered, nearby observations can be exploited in
estimation, as in the continuous case. Then the kernel K((yi − y)/ h) is replaced
with
Kord (yi , y, λ) =

c!
λj (1 − λ)c−j
j !(c − j )!

if |yi − y| = j,

(11.65)

where y takes the ordered values {0, 1, . . . , c − 1}. If the discrete data take a
large number of values, as can be the case for count data, then this will yield
similar results to the continuous case and it can be simpler to use the usual
kernel methods.

438

Flexible Methods for Counts

11.7 EFFICIENT MOMENT-BASED ESTIMATION
In Chapter 2 and in sections 11.3 and 11.4 we considered efficient momentbased methods for efficient estimation of parameters of the model for the
conditional mean based on models for the conditional mean and variance. Here
we consider more efficient moment-based estimation that may arise if higher
order moments than the second are additionally specified. We summarize results
in the GLM literature before demonstrating that they follow naturally from a
GMM formulation.
11.7.1

Estimating Equations and Quasilikelihood

The extended QL approach is a refinement of the moment-based approach
discussed in earlier chapters. The version given here owes much to Crowder
(1987) and Godambe and Thompson (1989). In this approach the central focus
of estimation is on an estimating equation, whose solution defines an estimator,
rather than an objective function that is maximized or minimized. See Chapter
2.5.1 for the general estimating equation approach. The equations are analogous
to the score equations in maximum likelihood theory, leading to the terminology
extended QL.
We consider models in which functional forms μi = μ(xi , θ ) and σ 2i =
ω(xi , θ ) are specified for the conditional mean and variance of the scalar
dependent variable yi . Crowder (1987) proposed the following general estimating equation
n


{a(xi , θ )(yi − μi ) + b(xi , θ ){(yi − μi )2 − σ 2i }} = 0,

(11.66)

i=1

where a(xi , θ ) and b(xi , θ ) are q × 1 nonstochastic functions of θ, the q × 1
unknown parameter vector to be estimated. Typically, θ = (β  α) , where β are
the parameters in the mean function, and the parameter α appears, in addition
to β, in the variance function. This class includes unweighted least squares
where a(xi , θ ) = ∂μi /∂θ , and b(xi , θ ) = 0, and QL estimation in which case
a(xi , θ ) = (1/σ 2i ) ∂μi /∂θ and b(xi , θ ) = 0.
Setting b(xi , θ )= 0 in (11.66) yields estimating equations that are quadratic
in (yi − μi ). These quadratic estimating equations (QEEs) are a potential
refinement to the QL approach. QL estimation is an appropriate approach
when the variance specification is doubtful, whereas the quadratic approach
is better if the variance specification is more certain. Cubic and higher order
terms may be added if there is more information about higher moments, but
the practical usefulness of such extensions is uncertain.
If μi = μ(xi , β) and σ 2i = ω(xi , β, α) are correctly specified, and θ̂ QEE is
the solution to the QEE, then from the results of Crowder (1987) it is known that

11.7 Efficient Moment-Based Estimation

439

the estimator is consistent and asymptotically normal with variance V[θ̂ QEE ] =
−1
A−1
n Bn An , where

n 

∂μ
∂σ i
An = −
ai i + 2σ i bi  ,
(11.67)
∂θ
∂θ
i=1
Bn =

n






σ 2i ai ai + σ i γ 1i (ai bi + bi ai ) + σ 2i γ 2i + 2 bi bi ,

i=1

(11.68)
where ai = a(xi , θ ) and bi = b(xi , θ ) are (k + 1) × 1 vectors and γ 1i and
γ 2i denote the skewness and kurtosis coefficients. The sandwich form of the
variance matrix is used. Consistent estimation of θ requires correct specification
of the first two moments of y, whereas V[θ̂ QEE ] depends on the first four
moments. If bi = 0, the asymptotic covariance matrix does not depend on
skewness or kurtosis parameters. This is consistent with earlier results for QL
estimation.
As already noted, minimization of the first term only in the objective function
corresponds to QL estimation. The second term is identically zero in some cases,
such as the LEF density for which the variance function fully characterizes the
distribution. In such a case, specification of higher order moments is redundant.
In other cases, however, efficiency gains result from the inclusion of a correctly
specified second term. An example of this follows.
Dean and Lawless (1989b) and Dean (1991), following Firth (1987), Crowder (1987), and Godambe and Thompson (1989), have discussed the estimation
of a mixed Poisson model using the extended QL approach. It employs the following specification of the first four moments of the NB2 model:
E[yi |xi ] = μi = μi (xi , β)
E[(yi − μi ) |xi ] =
2

σ 2i

(11.69)

= μi (1 + αμi )

E[(yi − μi )3 |xi ] = σ 3i γ 1i = σ 2i (1 + 2αμi )
E[(yi − μi )4 |xi ] = σ 4i γ 2i = σ 2i + 6ασ 4i + 3σ 4i ,
where α ≥ 0, and γ 1i and γ 2i denote skewness and kurtosis coefficients.
Suppose one assumes that the first four moments are known, but one does not
wish to use the negative binomial distribution. The optimal quadratic estimating
equations for estimation can be shown to be
n

(yi − μi ) ∂μi
= 0,
∂β
σ 2i
i=1

(11.70)


n 

(yi − μi )2 − σ 2i
(yi − μi )(1 + 2αμi )
= 0.
−
(1 + αμi )2
(1 + αμi )2
i=1

(11.71)

440

Flexible Methods for Counts

Given correct specification of the first four moments, these equations yield the
most efficient estimator for (β, α). Given α, the solution of the first equation
yields the QL estimate of β. This is the special case of (11.66) with

(1/σ 2i )(∂μi /∂β)
,
a(xi , θ ) =
−(1 + 2αμi )/(1 + αμi )2
b(xi , θ) =


0
.
1/(1 + αμi )2

The limit distribution can be obtained using (11.67) and (11.68).
Other estimators for α, given β, have been suggested in the literature; for
example, moment estimators that assume γ 1i = γ 2i = 0 and hence are less
efficient than the previous one if the higher moment assumptions given earlier
are correct. Dean and Lawless (1989b) have evaluated the resulting loss of
efficiency in a simulation context. Dean (1991) shows that the asymptotic
variance of β is unaffected by the choice of the estimating equation for α. An
application to the mixed P-IG regression is in Dean, Lawless, and Willmot
(1989).
11.7.2

Generalized Method of Moments

The literature generally does not motivate well the QEE estimator (11.66) and
optimal cases such as (11.70) and (11.71). Results on optimal GMM provide a
simple way to obtain the optimal formulation of the QEE.
From Chapter 2.5.3, the optimal GMM estimator for general conditional
xi , θ )|xi ] = 0, where (yi , xi ) is iid, is the solution
moment restriction E[ρ(yi ,
to the system of equations ni=1 h∗i (yi , xi , θ ) = 0, where
 
∂ρ(yi , xi , θ ) 
∗
hi (yi , xi , θ ) = E
(11.72)
 xi
∂θ
−1

ρ(yi , xi , θ ).
E ρ(yi , xi , θ )ρ(yi , xi , θ ) |xi
We evaluate (11.72) for estimation based on the first two moments of the
NB2 model:
μi = μi (xi , β)
σ 2i

(11.73)

= μi (1 + αμi ),

in which case β and α satisfy E[ρ(yi , xi , θ )] = 0, where



ρ 1 (yi , xi , θ )
yi − μi
=
ρ(yi , xi , θ ) =
,
(yi − μi )2 − σ 2i
ρ 2 (yi , xi , θ )

(11.74)

and θ = (β  α) . Note that the conditional mean function is not restricted to be
exponential.

11.7 Efficient Moment-Based Estimation

441

For notational simplicity drop the subscript i and the conditioning on xi in
the expectation. The first term in the right-hand side of (11.72) is
⎡
⎤
⎡
⎤
∂ρ 1
∂ρ 2
∂μ
∂μ
⎢ ∂β
⎥
−
{−2(y
−
μ)
−
1
−
2αμ}
∂β ⎥
∂β ⎦
= E ⎣ ∂β
E⎢
⎣ ∂ρ
∂ρ 2 ⎦
1
2
0
−μ
∂α
∂α
⎡
⎤
∂μ
∂μ
−
−(1
+
2αμ)
= ⎣ ∂β
(11.75)
∂β ⎦ ,
2
0
−μ
and the second term in the right-hand side of (11.72) is
 
 −1
ρ 21
ρ1ρ2
E
ρ1ρ2
ρ 22
 
= E

=

(y − μ)2
(y − μ){(y − μ)2 − σ 2 }

σ2
σ 3γ 1

σ 3γ 1
4
σ γ2 − σ4

1
= 6
σ (γ 2 − 1 − γ 21 )





(y − μ){(y − μ)2 − σ 2 }
{(y − μ)2 − σ 2 }2



−1

−1

σ 4γ 2 − σ 4
−σ 3 γ 1


−σ 3 γ 1
,
σ2

(11.76)

using E[(y − μ)3 |x] = σ 3 γ 1 and E[(y − μ)4 |x] = σ 4 γ 2 , where γ 1 and γ 2
denote skewness and kurtosis coefficients. Substituting (11.74) through (11.76)
into (11.72) yields


h∗1 (yi , xi , θ)
h∗2 (yi , xi , θ )
⎡

(σ 4i γ 2i − σ 4i ) − (1 + 2αμi )σ 3i γ 1i ∂μi σ 3i γ 1i − (1 + 2αμi )σ 2i ∂μi
⎢
∂β
σ 6 (γ 2 − 1 − γ 21i ) ∂β
σ 6i (γ 2i − 1 − γ 21i )
⎢
=⎢
3
2
⎣
σ i γ 1i μi
−μ2i σ 2i

×

σ 6i (γ 2i − 1 − γ 21i )

y − μi
(y − μi )2 − σ 2i

⎤
⎥
⎥
⎥
⎦

σ 6i (γ 2i − 1 − γ 21i )
(11.77)


The optimal GMM estimator of β and α solves ni=1 h∗ (yi , xi , θ ) = 0 defined
in (11.72). Its distribution can be obtained by applying the general results given
in section 2.5.1.

442

Flexible Methods for Counts

Comparing (11.77) with (11.66), the optimal GMM estimator in this case
is of the QEE form (11.66), with a(xi , θ ) and b(xi , θ ), respectively, equal to
the first and second columns of the first matrix in the right-hand side (11.77),
which is a (k + 1) × 2 matrix.
Now specialize to the case in which the skewness and kurtosis parameters
γ 1i and γ 2i are the functions given in (11.69). Then, in section 11.9 it is shown
that
(σ 4i γ 2i − σ 4i ) − (1 + 2αμi )σ 3i γ 1i = σ 4i (γ 2i − 1 − γ 21i )
σ 3i γ 1i

− (1 +

σ 6i (γ 2i

2αμi )σ 2i

−1−

γ 21i )

Using these results, (11.77) reduces to
⎡
1 ∂μi


∗
2 ∂β
⎢
h1 (yi , xi , θ )
σ
i
⎢
=
⎣ (1 + 2αμi )μ2i
h∗2 (yi , xi , θ )
2(1 + α)σ 4i

(11.78)

=0
= 2(1 + α)σ 2i .
⎤
0
μ2i
2(1 + α)σ 4i



⎥
y − μi
⎥
⎦ (y − μ )2 − σ 2 .
i
i
(11.79)

For σ 2i defined in (11.73), μ2i /σ 4i = 1/(1 + αμi )2 . Thus (11.79) yields the
optimal QEE estimator defined in (11.70) and (11.71), on premultiplication of
(11.71) by the constant 2(1 + α).
The optimal GMM estimator requires specification of E[ρ i ρ i |xi ], which in
this example requires specification of the first four conditional moments of
yi . Newey (1993) has proposed a semiparametric method of estimation, which
replaces these elements by nonparametric estimates. For example, an estimate
of the (1, 1) element, E[(yi − μi )2 |xi ], may be formed from a kernel or series
regression of (yi − μi )2 on an intercept, μ̂i and μ̂2i , where the latter are consistent estimators. A similar treatment may be applied to the other two elements.
Unfortunately, even after determining that θ is identified under GMM, this
semiparametric method may run into practical difficulties. First, if the individually estimated elements are combined, there is no guarantee that the resulting
estimate of E[ρ i ρ i |xi ] will be positive definite as required. Second, even if the
procedure produces a positive definite estimate, the estimate may be highly variable. Finally, in small samples the resulting estimator may be biased, perhaps
badly so as indicated by several studies of the GMM method (Smith, 1997).
The econometric literature includes several studies in which use of a constant
weighting matrix rather than the optimal matrix (E[ρ i ρ i |xi ])−1 produced better
estimates.
11.8 ANALYSIS OF PATENT COUNTS
We consider the same cross-section data example as in Chapter 4.8.8, based
on data from Hausman et al. (1984) and Hall et al. (1986). We use 1979 data

11.8 Analysis of Patent Counts

443

Table 11.1. Patents: Poisson, NB2, FMNB2(2), and NB2P1 models with
1979 data
FMNB2(2)
Variable

Poisson

Intercept

−0.340 −0.811
(0.190) (0.180)
0.475
0.816
(0.064) (0.083)
0.271
0.115
(0.055) (0.069)
0.467 −0.090
(0.155) (0.138)
0.885
(0.100)

ln R&D
ln SIZE
DSCI
α (NB2)

NB2

Component 1 Component 2 NB2P1
−1.274
(0.161)
0.918
(0.063)
0.065
(0.057)
0.103
(0.142)
0.651
(0.080)

1.516
(0.191)
0.352
(0.090)
0.277
(0.062)
−0.573
(0.346)
0.062
(0.047)

−0.935
(0.199)
0.611
(0.066)
0.110
(0.050)
0.006
(0.107)
1.507
(0.236)

0.929
(0.022)

π
a
Number of parameters
Log-likelihood
AIC
BIC

4
−3,366
6,740
6,755

5
−1,128
2,265
2,284

11
−1,106
2,234
2,277

0.082
(0.026)
6
−1,116
2,245
2,269

Note: Standard errors are given in parentheses.

on the number of patents (P AT ) awarded to 346 firms. From Table 4.2 the
data are very widely dispersed and very overdispersed. The three regressors
are the logarithm of total research over the current and preceding five years
(ln R&D), the logarithm of firm book value in 1972, which is a measure of
firm size (ln SI ZE), and a binary indicator variable equal to one if the firm
is in the science sector (DSCI ). Given the logarithmic transformation and the
exponential conditional mean, the coefficient of ln R&D is an elasticity, so that
the coefficient equals unity if there are constant returns to scale.
11.8.1

Parametric Models

Table 11.1 presents ML estimates for four parametric models. The first three
also appear in Table 4.3 and have already been discussed in Chapter 4.8.8.
The negative binomial model (NB2) fits the distribution of the data much
better than the Poisson, with log-likelihood increasing from −3,366 to −1,128.
The coefficient of ln R&D varies across the two models – 0.82 for the NB2
model compared to 0.49 for the Poisson – and lies between zero and one.
The FMNB2(2) model, a two-component finite mixture of NB2, has improved
fit, with log-likelihood increasing by 22 compared to the NB2 model. Using
information criteria presented in Chapter 5.4.1 that penalize for model size, the

444

Flexible Methods for Counts

Table 11.2. Patents: Actual versus nonparametric prediction
Predicted
Actual

0

1

2–5

6–20

21–50

51–100

101–200

201–300

301–515

0
1
2–5
6–20
21–50
51–100
101–200
201–300
301–515

73
34
51
11
0
0
0
0
0

3
7
21
30
12
5
0
0
0

0
0
1
3
11
2
0
0
0

0
0
0
6
9
7
2
1
0

0
0
1
0
10
8
5
1
1

0
0
0
1
1
8
7
1
1

0
0
0
0
0
0
5
3
0

0
0
0
0
0
0
0
2
0

0
0
0
0
0
0
0
0
2

FMNB2(2) model is preferred to the more parsimonious NB2 model on the
grounds of a lower AIC and BIC.
The final column of Table 11.1 presents a first-order squared polynomial
model based on the NB2 density, denoted NB2P1. The slope coefficients can
no longer be interpreted as semi-elasticities because the conditional mean is
no longer exp(x β); see section 11.2.4. The model is an improvement on NB2
using either AIC or BIC, and it is preferred to the FMNB2(2) model using BIC
though not AIC.
11.8.2

Nonparametric Conditional Density Estimate

We also performed nonparametric kernel estimation of the conditional density
of P AT given ln R&D, ln SI ZE, and DSCI . Then fˆ(y|x) = fˆ(y, x)/fˆ(x) is
obtained as the ratio of a four-dimensional kernel density estimate to a threedimensional kernel density estimate, where P AT is treated as ordered discrete
data with the weighting function given in (11.65), ln SI ZE and ln R&D are
treated as continuous with a second-order Gaussian kernel of fixed bandwidth,
and DSCI is an unordered binary discrete variable with the weighting function given in (11.64). The bandwidth is chosen using expected Kullback-Liebler
cross-validation. The resulting log-likelihood equals −1080, which is substantially larger than −1106 for FMNB2(2).
Table 11.2 is a classification table that compares the actual count yi to the
predicted count ŷi , where ŷi = k if the conditional density estimate fˆ(y|xi ) is
maximized when y = k. Since y and ŷ take many values, Table 11.2 groups
them into ranges. The nonparametric estimates predict zeros well and underpredict intermediate and larger counts. By contrast the NB2 model, in results
not presented here, does similarly well in predicting zeros and ones, but underpredicts intermediate and larger counts much more. For example, for the 15
observations with P AT between 101 and 200 the NB2 model predicts that only
1 count exceeds 50, whereas the semiparametric model predicts that 12 counts
exceed 50. And the NB2 predicts only three counts in excess of 43 (predicted

11.8 Analysis of Patent Counts

445

Table 11.3. Patents: Summary of various fitted means
Predicted
mean

Mean

Standard
Deviation

Minimum

25%

75%

Maximum

Fit
Cor[y,ŷ]2

PAT (y)
Poisson
NB2
NP
INDEX
PL

32.1
32.1
41.6
32.5
31.5
30.6

66.4
64.4
130.0
58.5
55.8
49.6

0.0
0.4
0.1
−0.2
0.0
−18.4

1.0
3.8
2.3
1.6
2.2
2.4

31.0
35.5
30.7
35.9
35.9
38.5

515.0
669.0
1532.7
514.5
483.7
323.5

–
0.71
0.47
0.82
0.77
0.70

Note: PAT, actual value; NB2, NB2 model; NP, nonparametric model; INDEX, single-index
model; PL, partial linear model.

values of 124, 136, and 176 for P AT taking values of, respectively, 515, 183,
and 319).
11.8.3

Nonparametric and Semiparametric Conditional
Mean Estimation

We additionally estimate several semiparametric and nonparametric models of
the conditional mean of P AT given the three regressors ln R&D, ln SI ZE,
and DSCI .
The first model, denoted NP, estimates a fully nonparametric regression
using local linear regression; see section 11.6.2. A second-order Gaussian kernel is used for ln R&D and ln SI ZE, and the weight function in (11.64) is used
for DSCI . The second model, denoted INDEX, is a single-index model estimated using the semiparametric least squares method of Ichimura (1993) that
jointly estimates the bandwidth and coefficients using leave-one-out nonlinear
least squares; see section 11.3.2. The third model, denoted PL, is a partially
linear model with conditional mean x1 β + g(x2 ) where ln SI ZE and DSCI
are the components of x1 and x2 is ln R&D. Estimation uses the method of
Robinson; see section 11.3.3. This model is not expected to do as well as the
first two models since for count data it is better to use the generalized partial
linear model with conditional mean exp(x1 β + g(x2 )).
Table 11.3 presents descriptive statistics for the predicted values ŷ of the
conditional mean from the three nonparametric and semiparametric models, as
well as for the Poisson and NB2 models. The NB2 model does particularly
poorly, with the lowest squared correlation (of 0.47) between the actual and
fitted values. Fitting the entire distribution using an NB2 model in this data
example leads to poorer fit of the mean, as is also evident from the average
fitted mean of 41.6 being substantially higher than the sample mean of 32.1.
The partial linear model fits the data as well as the Poisson in terms of
Cor[y, ŷ]2 , though it does predict negative values. As already noted for counts,
a generalized partial linear model should be used.

446

Flexible Methods for Counts

Table 11.4. Patents: Correlations of various fitted means
Predicted mean
PAT (y)
Poisson
NB2
NP
INDEX
PL

y

Poisson

NB2

NP

INDEX

PL

1.00
0.84
0.69
0.90
0.88
0.83

0.84
1.00
0.92
0.94
0.96
0.93

0.69
0.92
1.00
0.77
0.79
0.83

0.90
0.94
0.77
1.00
0.98
0.94

0.88
0.96
0.79
0.98
1.00
0.95

0.83
0.93
0.83
0.94
0.95
1.00

Note: y, actual value; NB2, NB2 model; NP, nonparametric model; INDEX, single-index model;
PL, partial linear model.

The single-index model g(x β) has estimated function ĝ(·), not plotted
here, that has an exponential shape. Furthermore the estimated coefficients
are, respectively, 0.678, 0.556, and 1.0, where the coefficient of ln SI ZE is
normalized to one. By contrast, the Poisson parameter estimates of 0.475,
0.271, and 0.467 from Table 11.1 become, on similar normalization, 1.072,
0.580, and 1.0, which are similar.
The nonparametric model leads to fitted values that are fairly similar to those
for the index models. The nonparametric model is preferred because Cor[y, ŷ]2
is 0.82 compared to 0.77 for the single-index model.
Table 11.4 presents correlations for the fitted values. The single-index fitted
values are highly correlated with those for the nonparametric model, suggesting
that the single-index model may be a good model for these data.
Figure 11.1 presents plots of the fitted values from all these models except
for the Poisson against the actual number of patents. These plots also suggest
that the best fitting models are nonparametric and single-index semiparametric
regression.
11.9 DERIVATIONS
11.9.1

Optimal GMM for NB2 First Four Moments

For notational simplicity we drop the subscript i in (11.77). From (11.69),
γ 1 σ 3 = σ 2 (1 + 2αμ) and γ 2 σ 4 = σ 2 + 6ασ 4 + 3σ 4 . Then
(σ 4 γ 2 − σ 4 ) − (1 + 2αμ)γ 1 σ 3

= σ 4 γ 2 − σ 4 − (σ γ 1 )γ 1 σ 3
= σ 4 γ 2 − σ 4 − σ 4 γ 21
= σ 4 {γ 2 − 1 − γ 21 },

σ 3 γ 1 − (1 + 2αμ)σ 2

= σ 2 (1 + 2αμ) − (1 + 2αμ)σ 2
= 0,

100 200 300 400 500
0

500

1000

Fitted: Nonparametric

1500

447

0

Fitted: Negative binomial

11.10 Bibliographic Notes

0

100

200

300

400

500

0

100

200

400

500

400

500

1500
1000
0

500

Fitted: Partial linear

400
300
200
100
0

Fitted: Single−index

300

PAT

500

PAT

0

100

200

300

400

500

0

100

200

PAT

300

PAT

Figure 11.1. Fitted values from four models plotted against actual value.

and
σ 6 (γ 2 − 1 − γ 21 ) = σ 2 (σ 2 + 6ασ 4 + 3σ 4 ) − σ 6 − σ 4 (1 + 2αμ)2
= σ 4 {1 + 6ασ 2 + 2σ 2 − (1 + 2αμ)2 }
= σ 4 {1+6αμ(1+αμ)+2μ(1+αμ) − (1+4αμ+4α 2 μ2 )}
= σ 4 {2(1 + α)μ(1 + αμ)}
= 2(1 + α)σ 6 .
This yields (11.78).
11.10 BIBLIOGRAPHIC NOTES
The original articles by Cameron and Johansson (1999) and Gurmu et al. (1999)
provide additional details on the computational aspects of their respective
estimators based on squared polynomial series expansions. Johnson, Kemp,

448

Flexible Methods for Counts

and Kotz (2005) provide an informative account of the power series family of
distributions.
A relatively nontechnical introduction to kernel and nearest-neighbor nonparametric regression is given by Altman (1992), applied aspects of nonparametric regression are dealt with in Härdle (1990), and Härdle and Linton (1994)
provide a survey of regression methods. Econometrics books on semiparametric
and nonparametric methods include Pagan and Ullah (1999) and Li and Racine
(2007). Detailed surveys that between them cover much of the recent econometrics literature are provided by Ichimura and Todd (2007), Chen (2007),
and Matzkin (2007). For generalized additive models Hastie and Tibshirani
(1990) is an authoritative reference. McLeod (2011) contrasts nonparametric
conditional density models with parametric latent class models for count data
on health utilization.
Miranda (2008) applies quantile count regression to the analysis of Mexican
fertility data, and Miranda (2006) describes an add-on command for implementation in Stata. Cameron and Trivedi (2011, chapter 7.5) discuss an empirical
illustration in detail, with special focus on marginal effects. Winkelmann (2006)
presents an application to panel data on health care utilization and discusses
how to choose the quantiles. Optimal GMM in a variety of settings is covered
in Newey (1993).

CHAPTER 12

Bayesian Methods for Counts

12.1 INTRODUCTION
Bayesian methods provide a quite different way to view statistical inference
and model selection and to incorporate prior information on model parameters.
These methods have become increasingly popular over the past 20 years due
to methodological advances, notably Markov chain Monte Carlo methods, and
increased computational power.
Some applied studies in econometrics are fully Bayesian. Others merely
use Bayesian methods as a tool to enable statistical inference in the classical
frequentist maximum likelihood framework for likelihood-based models that
are difficult to estimate using other methods such as simulated maximum
likelihood.
Section 12.2 presents the basics of Bayesian analysis. Section 12.3 presents
some results for Poisson models. Section 12.4 covers Markov chain Monte
Carlo methods that are now the common way to implement Bayesian analysis
when analytically tractable results cannot be obtained, and it provides an illustrative example. Section 12.5 summarizes Bayesian models for various types of
count data. Section 12.6 concludes with a more complicated illustrative example, a count version of the Roy model that allows for endogenous selection.
12.2 BAYESIAN APPROACH
The Bayesian approach treats the parameters θ as unknown random variables,
with inference on θ to be based both on the data y and on prior beliefs about
θ. The data and prior beliefs are combined to form the posterior density of θ
given y, and Bayesian inference is based on this posterior. This section presents
a brief summary, with further details provided in subsequent sections.
12.2.1

Posterior Density

The posterior density of y given θ , denoted p(θ |y), combines information
from the current data y with data density f (y|θ), and prior beliefs about θ ,
449

450

Bayesian Methods for Counts

captured by a prior density π(θ). From Bayes theorem, p(θ|y) = f (θ, y)/f (y).
Also by reexpressing Bayes theorem, f (θ, y) = f (y|θ) × π (θ). It follows that
p(θ|y) = f (y|θ ) × π (θ )/f (y).
In regression analysis we additionally condition on exogenous variables X.
Then we begin with the conditional density f (y|θ , X), yielding the following
result for the posterior density:
f (y|θ, X) × π(θ )
,
f (y|X)

(12.1)

p(θ |y, X) ∝ f (y|θ , X) × π(θ),

(12.2)

p(θ |y, X) =

+
where f (y|X) = f (y|θ, X)π (θ)dθ is a normalizing constant that ensures that
the posterior density integrates to one. The density f (y|θ, X) is called the likelihood because it gives the probability or likelihood of observing the data y given
regressors X and parameters θ . Frequentist analysis views f (y|θ, X) as a function of θ and the MLE is that value of θ that maximizes f (y|θ, X). The denominator density f (y|X) is called the marginal likelihood (with respect to θ ).
For basic count regression a Poisson or negative binomial model for f (y|θ, X)
would be specified. We discuss later various specifications of the prior π (θ).
Rescaling the numerator in the right-hand side of (12.1) has no effect on
the posterior p(θ|y, X) because the denominator in (12.1) changes by the same
amount, providing that the rescaling is not a function of θ . The result (12.1) is
often more simply written as

where the symbol ∝ means “is proportional to.” Even more simply we have
posterior ∝ likelihood × prior.

(12.3)

Although f (y|X) can be ignored in obtaining the key ingredient of Bayesian
analysis, the posterior, some subsequent inference such as prediction and model
selection requires computation of f (y|X).
12.2.2

Prior Density Specification

In some cases there is useful a priori knowledge about the likely values for θ .
Then an informative prior is specified, one that has an impact on the posterior
distribution. The functional form for the prior density of θ is often chosen on
grounds of analytical tractability or computational convenience. For iid data
completely tractable results arise when the sample density is in the exponential
family and the prior is a so-called natural conjugate prior; an example is
given in section 12.3.1. For regression with count data such tractable results
are unavailable, but some choices of functional form for the prior are more
amenable to numerical computation of the posterior than others.
In most econometric applications with many regressors and parameters,
there is little a priori knowledge about θ. Then an uninformative prior for θ is

12.2 Bayesian Approach

451

specified, one that has little impact on the posterior. There are several ways to
proceed.
The obvious approach is to use a proper prior for θ that sets the variance
of θ to be very large. Such a prior is called a diffuse prior or vague prior or
flat prior or weak prior. A second simpler approach is to use a uniform prior
with π (θ) = c, for specified c > 0,+making all values of θ equally likely. This
is usually an improper prior, since cdθ = ∞ for unbounded θ so the density
is improper. Nonetheless the resulting posterior is usually a proper density
because constants cancel in the numerator and denominator of (12.1). A third
approach is to use Jeffrey’s prior, which is proportional to the square root of the
determinant of ∂ 2 ln f (y|θ, X)/∂θ ∂θ  . This improper prior has the advantage of
being invariant to reparameterization of θ, unlike a proper prior or the uniform
prior. For example, a uniform prior π(θ ) = c for θ > 0 corresponds to the
nonuniform prior π ∗ (γ ) = ceγ for γ = ln θ .
An improper prior usually poses no problem for the posterior because constants cancel in the numerator and denominator of (12.1), and the methods
detailed later permit estimation of the posterior density without knowing the
marginal likelihood, the denominator in (12.1). But some subsequent analyses, notably Bayesian prediction, model selection, and hypothesis testing, do
require computation of the marginal likelihood.
The prior is set without regard to the sample size, so as the sample size
grows large the likelihood component of the posterior becomes dominant and
the influence of the prior eventually becomes negligible.
12.2.3

Posterior Density Computation

In count applications there is usually no analytical solution for the posterior,
especially once regressors are introduced. +In that case a desired moment of
the posterior distribution, say E[m(θ)|y] = m(θ)p(θ|y)dθ , can be computed
using Monte Carlo methods for estimating an integral. Early work emphasized
importance sampling methods; see, for example, Cameron and Trivedi (2005,
p.444).
Usually, however, Monte Carlo methods presented in section 12.4 are
used to instead obtain S draws θ (1) , . . . , θ (S) from the posterior p(θ|y). Then
moments such as 
the posterior mean and variance can be simply computed
as Ê[m(θ)|y] = S1 Ss=1 m(θ (s) ). Furthermore all interesting moments of functions of parameters and data can be estimated, given many draws from the
posterior. This is convenient not only for coefficients but also treatment effects,
especially when the quantiles of treatment effects are of interest. The hard
work in Bayesian analysis is obtaining the draws. Once the draws are obtained,
Bayesian analysis is simpler than frequentist analysis. The frequentist instead
computes desired quantities evaluated at the MLE θ̂ and then needs to use
asymptotic theory and the delta method or a bootstrap to control for the sampling variability in θ̂ .

452

Bayesian Methods for Counts

As the sample size gets large the likelihood component of the likelihood
becomes dominant. Furthermore, the posterior density can be shown to be
asymptotically normal, with the mean being the usual MLE θ̂ based on the
specified likelihood f (y|θ, X), and the variance matrix equal to minus the
inverse of the information matrix ∂ 2 ln f (y|θ, X)/∂θ ∂θ  evaluated at θ̂ . Thus
asymptotically it is possible to provide a frequentist interpretation to Bayesian
results, viewing the posterior mean as the MLE and the posterior standard
deviation as the standard error of the MLE.
12.2.4

Bayesian Inference

Bayesian analysis bases inference on the posterior distribution of θ, obtained
through either analytical or MCMC methods. In particular, a 95% Bayesian
credible interval for θ is simply the 2.5 percentile to 97.5 percentile of the
posterior distribution. Note that we are working directly with the posterior
distribution. Furthermore, the Bayesian credible interval, also called a Bayesian
confidence interval, is simpler to interpret than a classical confidence interval.
If a 95% Bayesian credible interval is (1, 4) then θ lies between 1 and 4 with
posterior probability 0.95. By contrast, a 95% frequentist confidence interval
of (1, 4) is interpreted as meaning that if we were to have many different
samples then 95% of similarly constructed intervals will include the single
true unknown value of θ .
There are many different ways to construct a 95% interval for θ . Bayesians
more often use the 95% highest posterior density (HPD) credible interval,
which is the interval (a, b) such that the posterior probability of θ lying in
a and b is 0.95 and p(a|y) = p(b|y). For an asymmetric posterior, the usual
case, the HPD credible interval is not the same as the interval from the 2.5
to the 97.5 percentiles. For vector parameter θ this interval generalizes to the
HPD credible region.
Posterior moments of θ are also informative, notably the posterior mean or
median and the posterior standard deviation. If a loss function is specified then
we can integrate out over this loss function using the posterior distribution to
obtain a single optimal Bayesian estimate of θ. In particular, under quadratic
loss the posterior mean is the best single estimate of θ .
Bayesian comparison of two models is based on the posterior odds ratio,
which is the ratio of the marginal likelihoods of the two models, called the
Bayes factor, weighted by the ratio of the prior probabilities of the two models.
It includes as a special case a test of θ = θ 1 against θ = θ 2 . The challenge
is that it requires computation of the marginal likelihood, the denominator in
(12.1), whereas evaluating the posterior does not.
In many applied studies the posterior is instead used as a means to enable
classical frequentist interpretation of data generated by a process with a true
value θ 0 . An uninformative prior is specified, so the posterior is essentially
the likelihood function. The posterior mean is treated as the MLE of θ 0 , and
the posterior variance is treated as the estimated variance of the MLE.

12.3 Poisson Regression

453

12.3 POISSON REGRESSION
For iid data the Poisson-gamma model is an example where an analytical
expression for the posterior exists. Once regressors are introduced, however,
there is no analytical expression.
12.3.1

Poisson-Gamma Model

We begin with no regressors, so the counts yi , i = 1, . . . , n, are Poisson distributed with mean μ, so
f (y|μ) =

n

i=1

e−μ μyi /yi !


= exp −nμ + nȳ ln μ −

(12.4)
n


ln yi ! ,

i=1

∝ exp{−nμ + nȳ ln μ},
where the final term can be ignored because it does not involve μ and will be
captured by the normalizing constant in the posterior.
We specify an informative gamma prior for μ with mean a/b and variance
a/b2 , where a and b are constants that are also specified, so
π(μ) = e−bμ μa−1 ba / (a)

(12.5)

= exp{−bμ + (a − 1) ln μ + a ln b − ln (a)},
∝ exp{−bμ + (a − 1) ln μ}
where again multiplicative terms not involving μ will be captured by the
normalizing constant in the posterior.
The resulting posterior p(μ|y) ∝ f (y|μ)π (μ), yields
p(μ|y) ∝ exp{−nμ + nȳ ln μ} × exp{−bμ + (a − 1) ln μ}

(12.6)

∝ exp{−(n + b)μ + (nȳ + a − 1) ln μ}.
This is the kernel of a gamma distribution, so it follows that the posterior
distribution for μ is a gamma with parameters (n + b) and (nȳ + a). The posn
na
terior mean of μ is (nȳ + a)/(n + b) = n+b
ȳ + b(n+b)
b, which is a weighted
average of the sample mean ȳ and the prior mean b. The posterior variance is
(nȳ + a)/(n + b)2 . Note that as n → ∞ the posterior mean and variance go to
ȳ and ȳ/n, confirming the earlier statement that the prior has no influence as
sample size n → ∞.
It is interesting to compare the posterior to the original sample density
f (y|μ) viewed as a likelihood. The posterior essentially adds b observations
on y that take value a. A similar augmented sample interpretation can be given
in other exponential family examples where a natural conjugate prior exists.

454

Bayesian Methods for Counts

Finally
+ it can shown that for a single observation the marginal density
f (yi ) = p(μ|yi )dμ is a negative binomial, so the prior can be viewed as
introducing overdispersion to the Poisson.
As an example suppose we have a sample of size n = 10 with ȳ = 3,
and our prior for μ is gamma with mean 4 and variance 4, so a = 4 and
b = 1. Then the prior essentially adds one more observation with value 4.
The posterior is gamma with posterior mean (30 + 4)/(10 + 1) = 3.09 and
posterior variance (30 + 4)/(10 + 1)2 = 0.281. A 95% credible region for μ
with variance y/n, so a 95%
is (2.14, 4.12). By comparison the MLE is y √
asymptotic confidence interval for μ is 3 ± 1.96 0.3 = (1.93,
3.07). An exact
95% confidence interval for the MLE is (2.0, 4.1), using ny = ni=1 yi ∼ P[30]
since the sum of iid Poissons is Poisson distributed.
12.3.2

Poisson Model

In the regression case yi |xi is Poisson distributed with mean μi = exp(xi β).
Given prior density π (β), the posterior is
 n




p(β|y, X) ∝ exp
[− exp(xi β) + yi xi β] × π (β).
(12.7)
i=1

Ideally we would have a prior for β that leads to a tractable posterior density
p(β|y, X), but there is no vector generalization of the preceding gamma prior
that yields this result. Furthermore we should explicitly model the overdispersion that is usually present in count data.
The usual approach is to adopt a hierarchical modeling approach. Then
yi |xi ∼ P[μi ] where μi themselves have an assumed distribution with parameters that priors are placed on.
One possibility is a Poisson-gamma mixture with μi = υ i exp(xi β), where
υ i is gamma with mean 1 and variance α. This leads to a negative binomial
model; see Chapter 4.2. Then a prior is specified for β and α, with no closedform solution for the posterior p(β, α|y, X).
More often a Poisson-lognormal mixture is considered with μi = exp(xi β +
ε i ) where ε i ∼ N[0, σ 2 ]. Then a normal prior for β is specified, so β ∼ N[β,
V] where, for example, β= 0 and V= cI for specified c, and an inverse-gamma
prior is specified for the dispersion parameter σ 2 . There is again no closedform solution for p(β, σ 2 |y, X). However, this model is more amenable than
the Poisson-gamma model to the computational methods summarized in the
next section. We return to this particular model in section 12.5.1.
12.4 MARKOV CHAIN MONTE CARLO METHODS
Markov chain Monte Carlo (MCMC) methods provide a way to make (correlated) draws from the posterior, even if an analytical expression for the posterior
is unavailable.

12.4 Markov Chain Monte Carlo Methods

12.4.1

455

Overview

MCMC methods make sequential random draws θ (s) , s = 1, 2, . . ., that converge to draws from the posterior p(θ|·) as s become large. The process is
a Markov chain because draws θ (s) depend in part on θ (s−1) , but not earlier
draws θ (s−2) , θ (s−3) , . . . once we condition on θ (s−1) . Furthermore, the Markov
chain is set up to be a stationary chain that converges to a stationary marginal
distribution that is the desired posterior p(θ|y). It is important that only draws
from the stationary distribution are used, so initial “burn-in” draws from the
chain are discarded and only the subsequent draws are treated as draws from
the posterior.
The posterior draws are necessarily correlated. This causes no problem in
estimating features of the posterior, such as the posterior mean and Bayesian
credible intervals, except that these features will be more noisily estimated the
more highly correlated the draws. In such cases more draws need to be made
from the chain.
12.4.2

Gibbs Sampler

The Gibbs sampler is applicable to problems where it is difficult to make draws
from the posterior p(θ ), but the parameter vector can be partitioned in such a
way that the full conditional posteriors are known.
For example, if we partition p(θ ) = p(θ 1 , θ 2 ) then we need to know p(θ 1 |θ 2 )
and p(θ 2 |θ 1 ). The Gibbs sampler then makes alternating draws from p(θ 1 |θ 2 )
(s−1)
we draw θ (s)
), then θ (s)
and p(θ 2 |θ 1 ). Thus given θ (s−1)
2
1 from p(θ 1 |θ 2
2 from
(s)
(s+1)
(s)
p(θ 2 |θ 1 ), then θ 1
from p(θ 1 |θ 2 ), and so on. Even though
p(θ 1 , θ 2 ) = p(θ 1 |θ 2 ) × p(θ 2 )
= p(θ 1 |θ 2 ) × p(θ 2 |θ 1 ),
this method can be shown to converge to draws from the posterior p(θ 1 , θ 2 ).
The method generalizes to additional partitioning. In the general case
θ is partitioned into d blocks, so p(θ ) = p(θ 1 , θ 2 , . . . , θ d ) and sequential
draws are made from the d full conditional posteriors p(θ 1 |θ 2 , . . . , θ d ),
p(θ 2 |θ 1 , θ 3 , . . . , θ d ), . . . , p(θ d |θ 1 , . . . , θ d−1 ). The Gibbs sampler is a Markov
chain that converges to a stationary distribution that is the desired full posterior
p(θ 1 , θ 2 , . . . , θ d ); see Gelfand and Smith (1990).
The attraction of the Gibbs sampler is that it is generally faster than other
MCMC methods, provided parameters in the different blocks are not too highly
correlated. Bayesian models and priors are specified to exploit analytical results
as much as possible, so that it is easy to make draws from all of the full
conditional posteriors.
In some cases, however, it may be difficult to make draws from one (or
more) of the conditional posteriors (e.g., from p(θ d |θ 1 , . . . , θ d−1 )). For such
conditional posteriors the Metropolis-Hastings (MH) algorithm may be used to

456

Bayesian Methods for Counts

make draws: the method is called MH within Gibbs. The posterior should be
partitioned so that correlated parameters are in the same MH block; see Chib
(2001).
We begin with the Metropolis algorithm before turning to the more general
MH algorithm.
12.4.3

Metropolis Algorithm

Consider the simplest case of desired draws from p(θ) = p(θ|y), where there
is no partitioning of the parameter vector.
The Metropolis algorithm makes a candidate draw θ ∗ from the candidate
distribution g(θ|θ (s−1) ), where g(·) must be symmetric, meaning g(θ a |θ b ) =
g(θ b |θ a ). The draw θ ∗ is sometimes accepted as the new value θ (s) , while
sometimes we continue with the preceding value θ (s−1) . The acceptance
rule is

if u < p(θ ∗ )/p(θ (s−1) )
θ∗
(s)
(12.8)
θ =
θ (s−1) otherwise,
where u is a draw from the uniform on [0, 1]. The algorithm is similar to the simple accept/reject method for making draws from p(θ), except the accept/reject
method requires the stronger condition that there is a constant k such that
g(θ) > kp(θ) for all θ .
The Metropolis algorithm has the attraction of requiring only computation of the ratio p(θ ∗ )/p(θ (s−1) ). Since the denominator in (12.1) does
not depend on θ it cancels out in the ratio, so θ ∗ is accepted if u <
[f (y|θ ∗ )π (θ ∗ )]/[f (y|θ (s−1) )π(θ (s−1) )]. Draws from the posterior can be made
without requiring evaluation of the normalizing constant f (y).
Ideally the candidate density is specified so that we are not at either extreme
of accepting no draws or accepting all draws. The random walk Metropolis
algorithm uses candidate density θ (s) |θ (s−1) ∼ N[θ (s−1) , V] for specified V.
Then
1
g(θ (s) |θ (s−1) ) = (2π)−k/2 |V|−1/2 exp(− (θ (s) − θ (s−1) ) V−1/2 (θ (s) − θ (s−1) ).
2
This clearly equals g(θ (s−1) |θ (s) ), so the candidate density is symmetric and we
can use the Metropolis algorithm.
12.4.4

Metropolis Algorithm for Poisson Regression
with Uniform Prior

As an illustration of MCMC methods we apply the Metropolis algorithm to
yi |xi ∼ P[μi = exp(xi β)] with uniform prior π (β) = c. More realistic examples that explicitly incorporate overdispersion and use a normal prior for β are
given in section 12.5.

-.2

0

457

-.8

-.8

β2
-.6 -.4

β2
-.6 -.4

-.2

0

12.4 Markov Chain Monte Carlo Methods

0

20 40 60 80 100
Draws

0

500 1000 1500 2000
Draws

Figure 12.1. The first 100 retained draws (first panel) and the first 2,000
retained draws (second panel) of β 2 from the Metropolis algorithm.

From (12.7) with π(β) = c the posterior density is
 n




p(β|y, X) ∝ exp
[− exp(xi β) + yi xi β] .
i=1

The acceptance rule (12.8), u < p(β ∗ )/p(β (s−1) ), is equivalently ln u <
ln(p(β ∗ ) − p(β (s−1) ), or here
ln u <

n

[− exp(xi β ∗ ) + yi xi β ∗ ] − [− exp(xi β (s−1) ) + yi xi β (s−1) ].
i=1

We apply this to a simulated data set of size n = 100 of a count yi and single
regressor xi . The regression model is yi |xi ∼ P(β 1 + β 2 xi ), and the Metropolis
algorithm uses draw β ∗ = β (s−1) + v where v is drawn from N[0, 0.25I2 ] and
c = 0.25 was chosen after some trial and error. The first 10,000 Metropolis
draws were discarded (burn-in) and the next 10,000 draws were kept.
Figure 12.1 presents the first 100 retained draws and the first 2,000 retained
draws of the slope parameter β 2 . The flat sections on the first panel are cases in
which the new draw is not accepted. The second panel suggests that the chain
has converged because it displays no upward or downward trend and it draws
quite a range of values of β 2 . In this particular example 26% of the draws are
accepted. The draws are correlated, but this correlation disappears reasonably
quickly. For the draws of β 2 the first five autocorrelations are, respectively,
0.80, 0.64, 0.51, 0.40, and 0.32.
Figure 12.2 plots the posterior density of β 2 estimated using the 10,000
retained draws from the Metropolis algorithm. The posterior will be normal
asymptotically. Here the posterior is quite close to that of the normal, even
though the sample size is only 100.
Table 12.1 provides some summary statistics for the posterior density of β 2 .
The posterior mean of β 2 is −0.464 and the posterior standard deviation is
0.121. A 95% percent Bayesian credible for interval β 2 is (−0.706, −0.228).
The results are similar to those for the MLE of the Poisson model, also presented
in Table 12.1. This is expected because an uninformative prior was used.

Bayesian Methods for Counts

0

Posterior density
1
2
3
4

458

-.8

-.6

-.4
β2

-.2

0

Figure 12.2. Estimate of posterior density of β 2 from 10,000 retained draws
of β 2 from the Metropolis algorithm.

Using
results in Table 12.1, the posterior
√mean estimate Ê[β 2 |y, X] =
n the (s)
β
has
a
standard
error
of
0.121/
10,000 = 0.00121 assuming
s=1 2
that the MCMC draws are uncorrelated. In fact they are correlated, and controlling for this correlation using Newey-West standard errors gives a substantially
larger standard error of 0.00336. The ratio (0.00336/0.00121)2 = 7.71 is called
the inefficiency factor, because it gives the efficiency loss in computation of
the posterior mean of β 2 from these correlated draws compared to independent
draws, and its inverse 0.13 is called the relative numerical efficiency. Despite
this loss of efficiency, the posterior mean of −0.464 is still quite precisely
estimated.
As a simple check of convergence a second chain was run with different
seed and different starting values for β 1 and β 2 . The results were similar, with
a posterior mean for β 2 of −0.457, posterior standard deviation of 0.119, and
an acceptance rate of 26%. In practice more detailed checks for convergence
should be implemented.
1
10000

12.4.5

Metropolis-Hastings Algorithm

The Metropolis-Hastings algorithm is a generalization of the Metropolis algorithm that does not require the candidate distribution g(θ (s) |θ (s−1) ) to be
Table 12.1. Metropolis Poisson example: Posterior summary and ML
estimates
Bayesian posterior results
Posterior
Posterior standard
Variable Mean deviation

95%
credible
interval

−0.135
−0.464

(−0.356, 0.172)
(−0.706, −0.228)

ONE
x

0.110
0.121

Maximum likelihood estimation results
Standard
Coefficient error
−0.126
−0.457

0.109
0.122

95%
confidence
interval
(−0.340, 0.089)
(−0.696, −0.219)

12.4 Markov Chain Monte Carlo Methods

symmetric. Then the acceptance rule (12.8) becomes
⎧
p(θ ∗ )×g(θ (s−1) |θ ∗ )
⎨ θ∗
if u < p(θ
(s−1)
(s)
)×g(θ ∗ |θ (s−1) )
θ =
⎩ θ (s−1) otherwise.

459

(12.9)

The Gibbs sampler can be shown to be a special case of the MH algorithm.
A leading example is the independence chain Metropolis-Hastings algorithm, which uses g(θ (s) ) not depending on θ (s−1) , but ensures that g(·) is a good
approximation to p(·). Specifically, given the posterior p(θ |y, X) the usual ML
computational methods are applied to obtain the MLE 
θ and variance estimate
 −1

V[
θ] = − ∂ 2 ln p(θ|y, X)/∂θ ∂θ  θ . The candidate distribution g(θ (s) ) is
then the multivariate normal or, better still, the multivariate T that has fatter
tails, with mean 
θ and variance V̂[
θ]. Computational time can be saved by
computing 
θ using just the first few rounds of a Newton-Raphson algorithm
rather than iterating to convergence.
For the independence chain the MH criteria simplifies to
⎧
∗
)×g(θ (s−1) )
⎨ θ∗
if u < p(θ
(s)
p(θ (s−1) )×g(θ ∗ )
(12.10)
θ =
⎩ θ (s−1) otherwise,
V[
θ]−1 (θ − 
θ ) 
θ )) for the normal independence
where g(θ) ∝ exp(− 12 (θ − 
chain.
For the preceding Poisson example with uniform prior and a normal independence chain the acceptance rule is

 ∗
 ∗
 (s−1)
) + yi xi β (s−1) ]
ln u < N
i=1 [− exp(xi β ) + yi xi β ] − [− exp(xi β
V[
θ]−1 (β (s−1) − 
V[
θ ]−1 (β ∗ − 
− 12 (β (s−1) − 
β) 
β) + 12 (β ∗ − 
β) 
β)).
In practice a more complex count model is specified, see section 12.5, and
the MH algorithm is applied within Gibbs sampling. Consider the k th block
and define θ −k to include all components of θ other than θ k , so θ = (θ k , θ −k ).
Then in (12.9) the target posterior distribution p(θ ∗ ) becomes p(θ ∗k , θ −k ), and
the candidate distribution g(θ ∗ |θ (s−1) ) becomes gk (θ ∗ |θ (s−1) , θ −k ) where gk (·)
may depend on the current value of θ −k from the remaining blocks.
12.4.6

Data Augmentation for Latent Variable Models

Several leading nonlinear regression models are based on underlying latent (or
hidden) variables. Leading examples are censored and selection models, such
as the Tobit model; discrete choice models, such as the multinomial probit that
are based on the additive random utility model; and random effects or random
coefficients models.
In such cases Bayesian analysis would be simpler if the latent variables
were known. This is especially so in the common case of normally distributed
latent variables, because then standard Bayesian results for linear regression

460

Bayesian Methods for Counts

under normality can be applied. Let y denote the vector of observed variables
and y∗ the vector of latent variables, where the components are related by
yi = g(yi∗ ). Then rather than obtain the posterior p(θ|y) ∝ f (y|θ )π(θ), the
latent variables y∗ are introduced as additional parameters and analysis is
based on the augmented posterior
p(θ , y∗ |y) ∝ f (y|θ , y∗ )π(θ).

(12.11)

MCMC draws of θ from this augmented posterior p(θ, y∗ |y) can also be used
as the draws from its marginal p(θ|y), the original desired posterior.
The advantage of this procedure is computational because it enables use of
Gibbs sampling, alternating between draws from the two conditional posteriors
p(θ|y∗ , y) and p(y∗ |y, θ ) of the full posterior given in (12.11). The conditional
posterior p(θ|y∗ , y) simplifies to p(θ|y∗ ), since yi = g(yi∗ ), and it may be much
simpler to draw from p(θ|y∗ ) than from the original p(θ|y). The conditional
posterior p(y∗ |θ , y) is used to generate y∗ given y and θ. The procedure is
called data augmentation, because the observed data y are augmented by generated data y∗ , though mechanically it is the parameter vector θ that has been
augmented.
As an example, consider a latent variable formulation of the probit model.
Then we observe yi = 1 (or yi = 0) if the latent variable yi∗ = xi β + ε i > 0 (or
is < 0), where ε i ∼ N[0, 1]. It follows that Pr[yi = 1|xi ] = Pr[yi∗ > 0|xi ] =
(xi β), the probit model, where (·) is the standard normal cdf. Rather than
draw from the posterior p(β|y, X) we draw from the augmented posterior
p(β, y∗ |y, X). Here y∗ |β, X ∼ N[Xβ, I] and we can just use standard Bayesian
results for the linear regression model under normality (with the simplification of a unit variance). With a uniform prior on β the conditional posterior
p(β|y∗ , X) is N[(X X)−1 X y∗ , (X X)−1 ], whereas with a normal prior the posterior is that in section 12.5.1 with y replaced by y∗ . To draw y∗ from p(y∗ |β, y, X)
we note that p(yi∗ |β, yi , xi ) are independent truncated normals. So if yi = 1
draw from N[xi β, 1] left truncated at 0, and if yi = 0 draw from N[xi β, 1] right
truncated at 0.
12.5 COUNT MODELS
We present several models for count data for several common types of data.
These models are most often based on the Poisson with lognormal heterogeneity to control for overdispersion, normal priors for regression parameters,
and inverse-gamma or Wishart priors for variance parameters. The Poissonlognormal has computational advantage over the Poisson-gamma (the negative
binomial) because it lends itself well to data augmentation.
12.5.1

Key Results for Linear Regression under Normality

The subsequent analysis uses the following analytical results for linear regression under normality with a normal-gamma prior.

12.5 Count Models

461

Consider independent data yi , i = 1, . . . , N, from the homoskedastic linear
model under normality,
y ∼ N[Xβ, σ 2 I].

(12.12)

Given independent priors for β and σ , the posterior is
2

p(β, σ 2 |y, X) ∝ f (y|β, σ 2 , X)π (β)π (σ 2 ).

(12.13)

The following choices for the priors lead to tractable posteriors for β and σ 2 .
First, if the prior density for β is specified to be N[β, V], then the posterior
density p(β|σ 2 , y, X) is N[β, V], where
V = [V−1 + (σ 2 (X X)−1 )−1 ]−1
−1



(12.14)

−1 −1

β = V[V β + (σ (X X) ) β̂ OLS )]
2

= V[V−1 β + σ −2 X y].
−1

The posterior is normal with precision V , which is the sum of the prior
precision and the sample precision, and posterior mean, which is a weighted
sum of the prior mean and the sample mean (the OLS estimator). Common
notation in the Bayesian literature is to use an underscore for the parameters of
a prior density and an overscore for parameters of the posterior.
Second, if the prior density for σ −2 is specified to be the Gamma [ a2 , ( 2c )−1 ],
then the posterior p(σ −2 |β, y, X) is



−1
a+n
c n (yi − xi β)2
Gamma
,
+
.
(12.15)
i=1
2
2
2
When more generally Var[y|X] = , a Wishart prior for
leading to a Wishart posterior for −1 |β, y, X.
12.5.2

−1

is specified,

Cross-Section Data

The Poisson lognormal model specifies
yi |xi ∼ P[μi = exp(γ i )]
γi =

xi β

(12.16)

+ εi .

ε i ∼ N[0, σ 2 ].
This is a lognormal model for heterogeneity since equivalently the Poisson
mean is μi = υ i exp(xi β), where the heterogeneity term υ i = exp(εi ) is lognormal with mean 1.
Bayesian analysis is based on the posterior p(β, σ 2 |y, X). This would be
straightforward if we knew γ i , since then we would have a standard linear
normal regression model γ i = xi β + ε i and could assume a normal-gamma
prior and use the results of section 12.5.1. So data augmentation is employed

462

Bayesian Methods for Counts

to include the γ i as parameters and make draws from the augmented posterior
p(β, σ 2 , γ |y, X) where γ = (γ 1 , . . . , γ n ).
The full conditional posterior p(γ |β, σ 2 , y, Xi ) is the product of the likelihood, here P[exp(γ i )] for the i th observation, and the “prior” for γ i which is
N[xi β, σ 2 ] since γ i = xi β + ε i with ε i ∼ N[0, σ 2 ]. Thus for the i th observation the conditional posterior is
p(γ i |β, σ 2 , yi , xi ) ∝ exp{yi γ i − exp(γ i )} × exp{−0.5σ −2 (γ i − xi β)2 }.
This is not tractable so we use the MH algorithm to make draws. For example
we could use the normal with mean 
γ i , the maximum with respect to γ i of
γ i.
p(γ i |σ 2 , yi , xi ), and variance −∂ 2 p(γ i |σ 2 , yi , xi )/∂ 2 γ i evaluated at 
We then make draws from the other full conditionals, p(β|σ 2 , γ , y, X) and
p(σ 2 |β, γ , y, X). If the prior for β is N[β, V] then the conditional posterior
p(β|σ 2 , γ , y, X) = p(β|σ 2 , γ , X) is normal, with the posterior mean and variance that given in (12.14) with y replaced by γ . If the prior for σ −2 is Gamma
[ a2 , ( 2c )−1 ] then the conditional posterior p(σ 2 |β, γ , y, X) = p(σ 2 |β, γ , X) is
gamma as in (12.15) with yi replaced by γ i .
Note that this data augmentation approach relies crucially on εi in (12.16)
being normally distributed so that γ i is normal and Bayesian results for the
linear normal model can be used. With other distributions for heterogeneity,
analysis would be much more complicated. With gamma heterogeneity it is
actually easier to work directly with the negative binomial model with density
f (y, X|β, α), where α is the overdispersion parameter. Then calculate the posterior p(β, α|y, X) ∝ f (y, X|β, α) × π(β) × π (α) using the MH algorithm.
12.5.3

Panel Data

For a random effects model a similar approach to the preceding can be taken.
Chib, Greenberg, and Winkelmann (1998) specify for individual i at time t the
model
yit |xit ∼ P[exp(γ it )]

(12.17)

γ it = xit β + wit α i
α i ∼ N[η, ].
The standard random effects model is the specialization wit α i = α i . In the
more general case here Chib et al. (1998) argue that xit and wit should share
no common variables to avoid identification and computational problems.
The structure of the model is similar to that in the previous subsection.
Data augmentation is used to add γ it as parameters, leading to the augmented
posterior p(β, η, , γ |y, X). A Gibbs sampler is used where draws from
p(γ |β, η, , y, X) use the MH algorithm, whereas draws from the other full
conditionals p(β|η, , γ , y, X), p(η|β, , γ , y, X), and p( |β, η, γ , y, X) are
straightforward, assuming independent normal priors for β and η and a Wishart
prior for −1 .

12.5 Count Models

463

The conjugate-distributed random effects model of Chapter 9.5 instead specifies yit |xit ∼ P[υ i exp(xit β)] where vi is gamma distributed with parameter
δ. This is equivalent to model (12.17) with wit α i = α i and vi = eαi . Then a
negative binomial model is obtained, and the MH algorithm applied with, say,
a normal prior for β and a gamma prior for δ.
If again yit |xit ∼ P[υ i exp(xit β)] but a uniform prior is assumed for α i =
ln υ i , so π(υ i ) ∝ 1/α i , and β also has a uniform prior, then Lancaster (2004,
p.298) shows that on integrating out α i the posterior is
p(β|y, X) ∝

n T  exp(x β)
it


i=1
t=1
exp(x
it β
t

yit

,

which is the conditional likelihood for the Poisson fixed effects model given in
Chapter 9.4.
12.5.4

Additional Count Models

From section 12.5.2, for the Poisson-lognormal model with data augmentation
the key ingredient is applying known Bayesian results for linear regression
under normality to γ i = xi β + ε i . Complications such as time-series or spatial
error correlation can be added by specifying richer models for the normal error
εi , and again applying known Bayesian results for the linear regression model
with these complications.
Multivariate correlated count data can be analyzed using a variant of the
Chib et al. (1998) panel data model. Chib and Winkelmann (2001) detailed an
MCMC algorithm for the j th count variable for individual in the model
yij |xij ∼ P[exp(γ ij )]
γ ij =

xij β

(12.18)

+ α ij

α i ∼ N[0, ].
where α i = (α i1 , . . . , α iJ ).
The cross-section model in section 12.5.2 can be adapted to a spatially
correlated error model by instead specifying γ i = xi β + ui in (12.16) and
letting u = λWu + ε, where W is specified and u = (u1 , . . . , un ) and ε =
(ε1 , . . . , ε n ). As an alternative, Lee and Bell (2009) present a spatial negative
binomial model.
For time series we could instead specify an ARMA model for ui in γ i =
xi β + ui , though from Chapter 7 this is only one of many possible models
for time series of counts. Jung, Liesenfeld, and J.-F. Richard (2011) propose a
dynamic factor model for time-series data on multivariate counts and propose
estimation using the efficient importance sampling Monte Carlo procedure.
They apply the method to the number of stocks traded with daily data observed
at five-minute intervals.

464

Bayesian Methods for Counts

12.6 ROY MODEL FOR COUNTS
Suppose an outcome of interest takes one of two possible values, depending on
an initial decision. For example, an individual’s use of health care services will
vary according to whether he or she chooses health insurance plan A or plan
B. We observe decision

1 if zi∗ = wi α + ui > 0
(12.19)
di =
0 if zi∗ = wi α + ui ≤ 0,
where zi∗ is an unobserved latent variable and wi are observed regressors. The
outcome is then

y1i if di = 1
(12.20)
yi =
y2i if di = 0,
where regression models are specified for y1i and y2i .
Interest lies in the causative effect of insurance plan choice (di ) on health care
use (yi ), but insurance plans are self-selected rather than randomly assigned.
The Roy model allows for selection not only on observables, by including
regressors as controls, but also on unobservables through correlation of error
terms in the models for zi∗ , y1i , and y2i .
The standard Roy model, presented in microeconometrics texts, assumes
linear normal models for zi∗ , y1i , and y2i . This is suitable for continuously
measured outcomes such as health expenditure or log health expenditure. In
many cases, however, health care use is instead measured as a count, such as
the number of doctor visits. Then y1i and y2i should be explicitly modeled as
counts, and the likelihood becomes much less tractable.
Deb, Munkin, and Trivedi (2006) proposed a count version of the Roy model
that can be implemented using Bayesian methods. They specify
y1i |xi ∼ P[exp(γ 1i )]

(12.21)

γ 1i = xi β 1 + π 1 ui + ε1i
= xi β 1 + π 1 (zi∗ − wi α) + ε1i ,
and similarly
y2i |xi ∼ P[exp(γ 2i )]
γ 2i =

xi β 2

(12.22)

+ π 2 ui + ε2i

= xi β 2 + π 2 (zi∗ − wi α) + ε2i .
Model identification requires that the regressor wi in the decision equation
(12.19) includes at least one regressor that does not appear in xi . The errors
ε 1i and ε2i are assumed to be independent normals with means 0 and variances, respectively, σ 21 and σ 22 . The error ui is specified to be standard normal,
leading to a probit model for the decision. If π 1 = 0 and π 2 = 0 then the

12.6 Roy Model for Counts

465

errors in the models for y1i and y2i are uncorrelated with the decision equation error ui , and there is no selection on unobservables. There is then no
endogeneity, and insurance choice depends only on exogenous regressors. Otherwise there is endogeneity, and the more complicated model analyzed here is
needed.
The posterior for the model is p(α, β 1 , β 2 , π 1 , π 2 , σ 21 , σ 22 |d, y1 , y2 , W, X)
where, for example, d = (d1 , . . . , dn ). Analysis would be much simpler if
the latent variables zi∗ , γ 1i , and γ 2i were observed. So data augmentation
is used to make draws from the augmented posterior p(α, β 1 , β 2 , π 1 , π 2 ,
σ 21 , σ 22 , z∗ , γ 1 , γ 2 |d, y1 , y2 , W, X) where, for example, γ 1 = (γ ∗11 , . . . , γ ∗1n ).
This can be done using a Gibbs sampler that sequentially draws from five
conditional posteriors for (1) α; (2) (β 1 , β 2 , π 1 , π 2 ); (3) (σ 21 , σ 22 ); (4) z∗ ; and
(5) (γ 1 , γ 2 ).
Details are presented in the appendix to Deb et al. (2006). Here we
present a brief summary. First, for p-dimensional α the prior is assumed
to be N[0, 10Ip ]. The full conditional posterior is p(α|β 1 , β 2 , π 1 , π 2 , σ 21 ,
σ 22 , z∗ , γ 1 , γ 2 , d, y1 , y2 , W, X). This posterior is normal because α appears
in linear normal models for zi∗ , γ 1i and γ 2i . Second, for (β 1 , π 1 ) we have
simply regression of γ 1i on xi and (zi∗ − wi α) with normal errors. Independent normal priors are specified that are N[0, 10Ik ] for k-dimensional β 1 and
either N[0, 12 ] or N[0, 14 ] for scalar π 1 . The full conditional posterior reduces to
p(β 1 , π 1 |γ 1 , z∗ , W, X) and is normal. Similarly the full conditional posterior
for (β 2 , π 2 ) is normal. Third, σ 21 appears as the error variance in regression
of γ 1i on xi and (zi∗ − wi α) with normal errors. An independent gamma prior
for the precision, with σ −2
1 ∼ Gamma[0.5, 0.2], yielding a gamma posterior.
Similarly for σ 22 . Fourth, for the latent variable zi∗ = wi α + ui it is necessary to
condition on ε 1i and ε 2i , since the full conditional posterior conditions on y1i
and y2i . This more complicated conditional distribution is nonetheless normal,
leading to draws from the truncated normal such that zi∗ > 0 if di = 1 and
zi∗ ≤ 0 if di = 0. Finally the full conditionals for γ 1i and γ 2i are complicated,
and so the MH algorithm needs to be used to make draws. Note that the model
was set up so that there was an analytical form for all but one of the conditional
posteriors in the Gibbs sampler, speeding up computation.
Deb et al. (2006) applied this method to annual doctor visits (y) made by
people aged 25–64 years employed in the private sector in the United States in
1996–2002. The decision variable d takes value 1 if individuals have private
health insurance and value 0 if they have no health insurance. Interest lies in
how the number of doctor visits varies with insurance. In the raw data there is a
big effect, with the 82% of the sample with private insurance having on average
4.28 doctor visits, whereas the 18% without insurance have on average 1.74
doctor visits. The model seeks to determine whether there is still an effect after
controlling for observables such as age, education, income, gender, and health
status and additionally for unobservables (endogeneity) through the error u that
influences both the insurance decision and doctor visits. The key identification
condition made to control for endogeneity is that the size of the firm a person

466

Bayesian Methods for Counts

works at determines insurance choice, because private insurance is typically
obtained through the employer and larger employers are more likely to offer
this benefit, but it does not directly determine doctor visits.
A Markov chain was run with the first 1,000 draws discarded and the next
19,000 draws retained for analysis. Table 2 in Deb et al. (2006) reports the
posterior means and standard deviations of β 1 , β 2 , and α. It shows that socioeconomic and health status variables are both strong determinants of doctor visits, whereas health insurance choice is more strongly associated with
socioeconomic characteristics than with health status.
From Table 3 of Deb et al. (2006) the error covariance parameter π 1 has
posterior mean −0.096 and standard deviation 0.034, suggesting that there is
selection on unobservables. For π 2 the corresponding numbers are −0.096
and 0.115. A more formal test is based on the Bayes factor that compares
models with and without the constraint π 1 = π 2 = 0 imposed. This finds strong
evidence against the constraint, so it is necessary to control for endogeneity of
the insurance decision.
For those with health insurance the expected number of doctor visits is
E[y1 |x] = E[exp(x β 1 + π 1 u + ε )|x]
= E[exp(π 1 u + ε ) × exp(x β 1 )|x]
= exp(0.5(π 21 + σ 21 )) × exp(x β 1 )
= exp(x β 1 + 0.5(π 21 u + σ 21 )),
where the third equality uses π 1 u + ε ∼ N[0, π 21 + σ 21 ] and E[exp(x)] =
exp(0.5σ 2 ) for x ∼ N[0, σ 2 ]. A similar result holds for E[y2 |x]. It follows
that the average treatment effect (ATE) of private insurance is
E[y1 − y2 |x] = exp(x β 1 + 0.5(π 21 u + σ 21 )) − exp(x β 2 + 0.5(π 22 u + σ 22 )),
where u = z∗ − x β. The ATE is evaluated at a representative value of x for each
of the 19,000 posterior draws of β 1 , β 2 , α, π 1 , π 2 , σ 21 , σ 22 , and z∗ . This yields
a posterior mean ATE of 0.734 doctor visits (with posterior standard deviation
0.226) for a person in very good or excellent health, whereas the effect is larger
for a person in fair or poor health. The study also reports estimates of the
average treatment effect on the treated, as well as a local average treatment
effect as the instrument (firm size) is varied. These estimates are similar to the
average treatment effect.
12.6.1

Finite Mixtures and Extensions

Chapters 4 and 6 analyzed and applied finite mixture models to model heterogeneity in count models from a classical perspective. Analogous Bayesian
treatment of this topic can also be found in the literature. A limitation of the
classical approach is the need to specify a fixed number of components. Recent
advances in Bayesian analysis of finite mixtures offer methods for overcoming

12.7 Bibliographic Notes

467

these limitations. Of particular interest is the Dirichlet Process Mixture (DPM)
model in which the data and specification of the prior jointly determine the
number of components. If the prior of the mixing weights of FMM is assumed
to be a Dirichlet Process prior, then Neal (2000) shows that the DPM is the
infinite counterpart of FMM when the number of components goes to infinity.
(The Dirichlet Process prior, sometimes described as a prior defined over the
space of distributions, plays a central role in Bayesian nonparametric econometrics; see Ferguson (1973)). Hence the DPM is an alternative to the FMM,
especially in the absence of good prior information on the number of components in the data. It is an “automatic” mechanism for selecting the appropriate
number of components, thereby avoiding the computation of Bayes factors for
determining the number of components, as in the case of FMM.
12.7 BIBLIOGRAPHIC NOTES
Much of the research on Bayesian methods appears in the statistics literature.
Robert and Casella (1999) present MCMC methods, and a standard Bayesian
reference for applied statisticians is Gelman et al. (2003). Econometrics books
devoted to Bayesian methods include Geweke (2003), Koop (2003), Lancaster
(2004), and Koop, Poirier, and Tobias (2007). Cameron and Trivedi (2005) provide a chapter-length treatment. Chib (2001) and Geweke and Keane (2001)
provide detailed accounts of MCMC theory and methods for many econometrics models. Chernozhukov and Hong (2003) extend MCMC computational methods for likelihood-based models to models based on more general
objective functions such as GMM. Computer software for Bayesian analysis is
discussed in the appendix.

CHAPTER 13

Measurement Errors

13.1 INTRODUCTION
The benchmark measurement error model is the bivariate linear errors-invariables (EIV) regression model with additive measurement errors in both
the dependent variable and the regressor variable. The measurement errors are
assumed to be classical, meaning that they are uncorrelated with the true value
and have mean zero. Then the OLS estimator is inconsistent, with a bias toward
zero. The measurement error is often large enough for this bias to be substantial;
see, for example, Bound, Brown, and Mathiowetz (2001).
For nonlinear models the attenuation result does not necessarily hold, but
measurement error still leads to inconsistency because the identified parameter
is not the parameter of interest in the model free of measurement error. The
essential problem lies in the correlation between the observed regressor variable
and the measurement error. This leads to loss of identification and distorted
inferences about the role of the covariate. A key objective of analysis is to
establish an identification strategy for the parameter of interest.
There are important differences between nonlinear and linear measurement
errors models. It is more difficult in nonlinear models to correct for classical
measurement error in the regressors. Furthermore, in nonlinear models it may
be more natural to allow measurement errors to be nonclassical and nonadditive.
And although in linear models classical measurement error in the dependent
variable is innocuous because it just contributes to the equation error as additive
noise, in nonlinear models the presence of even classical measurement error
in the dependent variable leads to loss of identification of model parameters.
For count data, mechanisms that lead to measurement error in the dependent
variable are plausible on a priori grounds and in some cases they also indicate the
direction of measurement errors. For example, certain types of crime, accidents,
and absences at the workplace may be typically underreported because of
random failures in the mechanism for recording those events. A recurring theme
in nonlinear measurement error models is that general results are relatively
few and the results are often dependent on functional form and distributional
assumptions.
468

13.2 Measurement Errors in Regressors

469

This chapter considers estimation and inference in nonlinear count data
models in the presence of measurement errors in regressors, as in the canonical
linear EIV model. But we also analyze at some length measurement errors
due to random variation in exposure time and errors due to the underreporting
and misclassification of events. Our main focus remains on cross-section models. We also consider cross-section regression when there are replicated data
available for the regressor measured with error. Panel data provide repeated
observations on the same individual that may create additional opportunities
for applying different identification strategies. This case differs from replicated
data because both regressors and measurement errors may vary over time and
is not pursued here.
Section 13.2 concentrates on measurement errors in the regressors under
classical assumptions, ignoring any measurement error in counts. In some
applications the regressors include a measure of exposure, such as miles driven
in a model of auto accidents. Measurement error in exposure is given separate treatment in section 13.3. Section 13.4 studies measurement errors in the
observed count, the dependent variable, including the practically important
case of misclassified counts. Section 13.5 analyzes the specific case of underreported counts that arises in many commonly occurring situations. Extension
to models with overreporting and underreporting is given in section 13.6. A
simulation demonstrating the performance of some approximate corrections
for measurement errors in regressors in a Poisson model is presented in section 13.7.
13.2 MEASUREMENT ERRORS IN REGRESSORS
Most methods to control for measurement error in the linear model do not
carry over to the nonlinear model. The various methods developed for nonlinear models vary with the strength of distributional assumptions. The statistics
literature focuses on methods for GLMs, whereas the recent econometrics
literature has focused on nonparametric regression models. We focus on classical measurement error and its effect on estimation of regression parameters,
although measurement error also affects marginal effects, prediction, and statistical inference.
13.2.1

Measurement Error Processes

Consider regression with dependent variable yi , true regressors x∗i and observed
regressors xi . Interest lies in the relationship between yi and x∗i , but xi rather
than x∗i is observed.
The classical (or additive) measurement error model specifies
xi = x∗i + vi ,

(13.1)

where E[vi |x∗i ] = 0, so vi is mean independent of x∗i . Then E[xi |x∗i ] = x∗i , so
x∗i is measured correctly on average. An example is response y depends on true

470

Measurement Errors

height x ∗ , which is mismeasured as x, but on average is correctly measured.
Usually vi is assumed to be iid [0, vv ], but some studies relax this assumption
to permit heteroskedasticity in vi .
An additional assumption usually made is that the measurement error is
nondifferential with respect to y. In that case the distribution of x|y, x∗ is
assumed to equal that of x|x∗ . Equivalently the distribution of y|x, x∗ equals
that of y|x∗ , and x is called a surrogate for x∗ . And equivalently y and x are
independent conditional on x∗ .
A quite different model of measurement error is Berkson error. This specifies
x∗i = xi + ui ,

(13.2)

where E[ui |xi ] = 0. An example is an experiment where the experimenter
sets dosage nominally at level x, but there is error and the actual dosage, the
determinant of the response y, is x ∗ . The consequences of Berkson error are
similar to those for a proxy regressor variable and are more benign than those for
classical measurement error. The literature focuses on classical measurement
error, which is the relevant model for survey data, for example.
In some cases both x∗ and v in the classical measurement error model are
assumed to be normal. Suppose x∗ ∼ N[μx , xx ] and x|x∗ ∼ N[x∗ , vv ]. Then
x∗ |x is normally distributed with a mean that is linear in x. This simplifies
analysis because it is a linear generalization of the Berkson error model that
specifies x∗ = a + Bx + u.
Measurement error need not be classical. An obvious extension of (13.1)
is linear measurement error with x = c + Dx∗ + v. For categorical variables
classical measurement error is necessarily nonclassical, and measurement error
is called classification error.
13.2.2

Linear Errors in Variables Model

The canonical bivariate linear errors in variables (EIV) regression model
specifies
y = βx ∗ + u
x = x ∗ + v,

(13.3)

where V[x ∗ ] = σ 2x ∗ , E[v|x ∗ ] = 0, E[v 2 |x ∗ ] = σ 2v , E[u|x ∗ ] = 0, E[u2 |x ∗ ] =
σ 2u , and E[vu] = 0. Here x ∗ is the true unobserved value and x is its measured
counterpart. The measurement error v is mean independent of x ∗ with constant
variance measurement error.
The OLS regression of y on x identifies the parameter βσ 2x ∗ /(σ 2v + σ 2x ∗ ),
since V[x] = σ 2x ∗ + σ 2v and Cov[x, y] = βσ 2x ∗ , rather than the desired β. The
bias of the inconsistent OLS estimator is toward zero, so the true impact of
changing x ∗ on y is underestimated. This attenuation bias is increasing in the
noise-to-signal ratio σ 2v /σ 2x ∗ . For example, the OLS estimator converges to
only 0.5β if the noise is the same size as the signal.

13.2 Measurement Errors in Regressors

471

Additional information is needed to obtain a consistent estimator for β. A
range of additional sources of information and estimation methods are used.
A natural approach is to use an instrumental variables estimator, since measurement error leads to endogeneity of the regressor x as it is correlated with
the error term. To see this, note that (13.3) implies y = βx + (u + βv), so
the regressor x = x ∗ + v is correlated with the composite error (u + βv).
Assume we have a valid instrument z correlated with x, but uncorrelated
with both v and u. Then the instrumental variables estimator is consistent
since Cov[z, y] = Cov[z, βx], so Cov[z, y]/Cov[z, x] = β. The IV approach
yields point identification without appealing to distributional knowledge about
the measurement error v. An ideal instrument is a replicate, a second independent measurement of x ∗ .
Knowledge of key features of the measurement error process also enables
consistent estimation. In this simple example knowledge of the measurement
error variance σ 2v is sufficient. For measurements from a physical device σ 2v may
be known. For standard tests such as those of intelligence the reliability ratio
(1 + σ 2v /σ 2x ∗ )−1 may be known. More often replicated data may be used. For
example, if we have independent measures x1 and x2 of x ∗ with xj = x ∗ + vj
and vj ∼ [0, σ 2v ], j = 1, 2, then σ 2v = V[x1 − x2 ]/2.
In the case that x ∗ is skewed, ruling out normality, higher order moment
conditions can be used to generate instruments (Lewbel, 1997) or to generate
additional moment conditions that can be used in minimum distance or GMM
estimation (Cragg, 1997).
13.2.3

Consequences for Nonlinear Models

When nonlinearity is introduced, it is difficult to obtain results on the effect
of even classical measurement error on the functional form for the conditional
mean and parameter estimates.
Consider a general nonlinear model
E[y|x∗ ] = m(x∗ , β),

(13.4)

where x∗ is a vector of covariates. The conditional mean given observed data is
E[y|x] = E[E[y|x∗ , x]|x]
= E[E[y|x∗ ]|x]
+
= m(x∗ , β)f (x∗ |x)dx∗ ,

(13.5)

where the second equality is satisfied under the mean independence assumption
that E[y|x∗ , x] = E[y|x∗ ]. In general E[y|x] = m(x, β) and varies with the
density f (x∗ |x). Note that the classical measurement error model specifies
f (x|x∗ ) rather than f (x∗ |x).
Chesher (1991) uses small variance approximations to determine the impact
of small amounts of classical measurement error in the regressors in nonlinear
models. For simplicity consider the bivariate case, with (y, x ∗ ) having density f (y, x ∗ ) = g(y|x ∗ )h(x ∗ ). We observe x = x ∗ + v where the measurement

472

Measurement Errors

error v ∼ [0, σ 2v ] independent of y and x ∗ . Chesher presents approximations
that ignore terms of o(σ 2v ). Then the mismeasurement x is more dispersed than
x ∗ , and to order O(σ 2v ) the effect of v on x is the same as if v was normally
distributed. In some cases the usual attenuation result holds. But if E[y|x ∗ ]
is nonlinear then results depend on the curvature of E[y|x ∗ ]. At values of x ∗
for which E[y|x ∗ ] is convex (concave), measurement error leads E[y|x] to
be higher (lower) than E[y|x ∗ ]. Chesher obtains the same results in the more
general case of multivariate dependent and regressor variables (y, x∗ ).
Guo and Li (2002) consider models with underlying equidispersion so that
V[y|x∗ ] = E[y|x∗ ], the Poisson being a special case. They show that V[y|x] <
E[y|x] if there is classical measurement error, so measurement error induces
underdispersion.
Analysis focuses on estimation of β, though for nonlinear models the consequent predictions and marginal effects are of ultimate interest.
Suppose the true model is E[y|x∗ ] = exp(x∗ β), and interest lies in MEj =
∂E[y|x∗ ]/∂xj∗ = exp(x∗ β)β j . It follows immediately that β j retains its interpretation as a semi-elasticity, so any inconsistency in estimating β due to
measurement error leads to the same inconsistency in the semi-elasticities.
8 j = exp(x β̂)β̂ j , which
Poisson regression of y on x yields the estimate ME
varies with x. The average ME does not, however, since from Chapter 3.5.1 it is
necessarily the case that AMEj = β̂ j y for the Poisson QMLE in a model that
includes an intercept. It follows that if Poisson regression of y on mismeasured
 j = 0.8AMEj . For the Poisson QMLE,
x yields β̂ j = 0.8β j , say, then AME
inconsistent estimation of β due to measurement error is transmitted directly
to inconsistent estimation of in-sample average marginal effects.
13.2.4

Instrumental Variable Estimation

Y. Amemiya (1985) has shown that for nonlinear (in regressors) regression
models with classical measurement errors, the usual IV methods do not lead
to consistent estimation. This result contrasts with the consistency of the IV
estimator for the linear EIV model.
To see this, consider a model with exponential conditional mean in the scalar
regressor case, so
y = exp(α + βx ∗ ) + ε.

(13.6)

The observed regressor is x = x ∗ + v, where v is a measurement error. A Taylor
series expansion of exp(α + βx ∗ ) = exp(α + β(x − v)) around x yields
⎫
⎧
∞
⎬
⎨
(−v)j β j exp(α + βx) + ε .
(13.7)
y = exp(α + βx) +
⎭
⎩
j =1

IV estimation is based on an instrument z that is correlated with exp(α + βx)
while satisfying the moment condition E[z(y − exp(α + βx))] = 0. The latter

13.2 Measurement Errors in Regressors

473

condition implies that z must be uncorrelated with the term in braces in (13.7),
which in turn requires that z be uncorrelated with ε and powers of v since z does
need to be correlated with exp(α + βx). Clearly, mean independence between
the instrument z and the errors ε and v is not enough to ensure consistent
estimation; a much more stringent condition is required. Amemiya notes that
consistent estimation is possible if the measurement error variance goes to zero
faster than sample size n → ∞, but this is unlikely in practice.
More generally, Amemiya shows that the instrumental variable does not
yield consistent estimates for nonlinear errors-in-variables models because the
error term involves both measurement error and observed error-contaminated
variables. It is not possible to find an instrumental variable that is highly
correlated with the observed variable but is uncorrelated with the residual term.
Furthermore, from a practical viewpoint, it is not easy to verify the validity of
an instrumental variable in estimation because of limited information about the
latent variable x ∗ and measurement error.
When a replicate is available, consistent estimation by methods other than IV
is possible in some models; see section 13.2.6. In the case where the instrument
is not a replicate, Newey (2001) adds assumptions on the instrument, most
notably that x ∗ = z δ + η, where the model error, measurement error, and η are
conditionally independent. Hausman, Newey, and Powell (1995) also propose a
consistent estimator in the model y = m(x, β) + ε, where the instrument need
not necessarily be a replicate. And Carroll and Stefanski (1994) propose an
approximate IV method that is presented in the next subsection.
13.2.5

Approximate Estimators

Approximate methods are convenient methods that are acknowledged to yield
parameter estimates that are inconsistent in nonlinear models, but are expected
to do considerably better than a naive model that ignores measurement error.
They may be applied to a parametric or semiparametric estimator. These methods do provide consistent estimators in the linear case, so they may continue
to do well in single-index models with conditional mean E[y|x∗ ] = m(x∗ β)
where the function m(·) is not too curved.
Carroll et al. (2006) present these methods in considerable detail, with
emphasis on application to GLMs and especially the logistic model. For simplicity we present results for the case where all regressors are measured with
classical measurement error as in (13.1), but the methods are easily adapted to
the more usual case where only a subset (often one regressor) is measured with
error. For brevity we do not present the associated formulas for the estimated
variance matrix of parameter estimates that correct for first-stage estimation.
These are often estimated using an appropriate bootstrap. The methods require
replicate data, or an estimate of V[v], or an instrument in the case of approximate IV.
Replication means repeated measurement of the same underlying true value.
In natural sciences where measurement takes place in controlled settings

474

Measurement Errors

replicated measures arise naturally. In social sciences where measures are
derived from survey responses, repeated measures are less often available.
Regression Calibration
The regression calibration approach for desired nonlinear regression of y on x∗
instead regresses y on x̂, where x̂ is a prediction of x∗ . The approach presented
here is due to Carroll and Stefanski (1990) and Gleser (1990).
∗
. Then
Suppose for each observation we have K replicates x1 , . . . , xK of x
K
∗
−1
under squared error loss, the best linear prediction of x given x̄ = K
j =1 xj
is
E[x∗ |x̄] = E[x∗ ] + Cov[x∗ , x̄]V[x̄]−1 (x̄ − E[x̄]).
Now x̄ = x∗ + v̄, since xj = x∗ + vj . Given classical measurement error
E[x∗ ] = E[x̄], Cov[x∗ , x̄] = V[x∗ ], and V[x̄] = V[x∗ ] + K −1 V[v]. For the i th
observation we use
−1
(13.8)
(x̄i − x̄),
x̂i = x̄ + V̂[x∗ ] V̂[x∗ ] + K −1 V̂[v]


∗
−1
where x̄ = n−1 ni=1 x̄i , x̄i = K −1 K
j =1 xj i , V̂[x ] = V̂[x̄] − K V̂[u],

n
K

V̂[x̄] = N(K−1) i=1 (x̄i − x̄)(x̄i − x̄) , and a key component is the use of the
replicate data to estimate the measurement error variance matrix
1 
(xj i − x̄i )(xj i − x̄i ) .
K − 1 i=1 j =1
n

V̂[v] =

K

(13.9)

These formulas can be adjusted to allow for the number of replicates K to vary
with i. Alternatively V[v] can be estimated or specified using external data or
knowledge.
The method is only approximate in nonlinear models. Carroll et al. (2006)
present some refinements for highly nonlinear problems.
Simulation Extrapolation
The simulation extrapolation (SIMEX) method, proposed by Cook and Stefanski (1994), assumes the measurement error is normally distributed, makes
draws (simulates) from this distribution, and extrapolates to the case of no
measurement error.
The naive regression results are obtained from regression of y on the regressor x = x∗ + v. If we could add to the observed x an amount λv and reestimate, then we would have estimated a model with regressor x∗ + v + λv =
x∗ + (1 + λ)v. Doing so for a range of values of λ > 0 gives a range of estimates β̂(λ). The case of no measurement error is the case λ = −1, so the
desired estimate is obtained by estimating β̂(λ) for, say, λ = 0.5, 1.0, . . . , 2.5
and interpolating to the case λ = −1.

13.2 Measurement Errors in Regressors

475

The measurement error v is not observed. To implement the method the
measurement error is assumed to be normally distributed, and draws are made
from N[0, V̂[v]] where, given replicate data, V̂[v] can be computed using (13.9).
Approximate IV Estimation
As noted in section 13.2.4, it is not possible to consistently estimate a nonlinear
EIV model using an IV estimator. Nonetheless it is possible that IV methods
provide a reasonable approximation.
For single-index models with E[y|x∗ ] = m(x∗ β), the obvious estimator is
nonlinear IV or nonlinear 2SLS of y on x with instrument z. In the just-identified
case this solves the sample analog of the moment condition
E[z(y − m(x β)] = 0.

(13.10)

This estimator is not consistent, as explained in section 13.2.4, but may be
better than simple nonlinear regression of y on x.
Carroll and Stefanski (1994) proposed an alternative two-step estimator that
they call an approximate IV estimator. It performs linear regression of x on z
to yield predictor x̂ and, at the second stage, estimates the original model with
x∗ replaced by x̂. This method is similar in spirit to the regression calibration
approach, but has the advantage that the instrument need not be a replicated
observation of x∗ . Again this method does not yield a consistent estimator, but
it may be a reasonable approximation method. For details see, in particular,
Stefanski and Buzas (1995), who consider the logit case.
13.2.6

Consistent Estimators

Naive estimators that ignore measurement error are inconsistent because the
resulting estimating equations have 
a nonzero probability limit. For example,
in the Poisson case whileplim n−1 i x∗i (yi − exp(x∗
i β)) = 0, inconsistency
arises because plim n−1 i xi (yi − exp(xi β)) = 0 if, for example, classical
measurement error is present in x.
We present two methods, developed for GLMs with classical measurement
error, that use an adjusted estimating equation or an adjusted objective function
that leads to consistent parameter estimates given knowledge of the measurement error distribution.
Conditional Scores
Consider regression of y on x∗ with parameter β given a GLM density with
canonical parameterization as defined in Chapter 2.4.4 that permits overdispersion, and with observed regressor x = x∗ + v where v ∼ N[0, vv ] and
∗
vv is known. Let the joint density of the data, conditional on x , be denoted
∗
f (y, x|x ). Then Stefanski and Carroll (1987) show that a sufficient statistic
for x∗ is  = x + y vv β, yielding a conditional density f (y|, x) that does

476

Measurement Errors

not depend on x∗ . Furthermore this density is also a GLM density, though with
a reparameterized mean.
This leads to an estimator proposed by Stefanski and Carroll (1987) called
a conditional score estimator due to the conditioning on . For Poisson the
conditional score estimator β̂ solves
n


(yi − m(i , β))xi = 0,

(13.11)

i=1

where i = xi + yi vv β and m(i , β) is the mean E[yi |i , β], where yi has
probability mass function,
exp(ki β − .5β  vv β)/k!
.
Pr[yi = k|i , β] = ∞


vv β)/j !
j =0 exp(j i β − .5β
Analysis is complicated because of summation of an infinite series. By contrast
a closed-form solution exists for the logit model. If vv is estimated using
replicate data, see (13.9), the variance matrix of β̂ can be obtained using
bootstrap methods.
Corrected Scores
Stack yi into vector y, and xi and x∗i into matrices X and X∗ . The desired loglikelihood is L(β|y, X∗ ), but X∗ is not observed. The naive log-likelihood
L(β|y, X) leads to inconsistent estimation. Instead Stefanski (1989) and
Nakamura (1990) proposed a corrected log-likelihood that depends on the
observed y, X but whose expected value conditional on the unobserved X∗
equals L(β|y, X∗ ). Specifically, we use L+ (β|y, X) that has the property that
EX [L+ (β|y, X)|y, X∗ ] = L(β|y, X∗ ).
For Poisson with X∗ known the log-likelihood is
L(β|y, X∗ ) =

n

∗
{− exp(x∗
i β) + yi xi β − ln yi !}.
i=1

The corrected log-likelihood assuming x = x∗ + v and v ∼ N[0,
L+ (β|y, X) =

vv ]

n

{− exp(xi β − .5β  vv β) + yi xi β − ln yi !}.

is
(13.12)

i=1

Consider the first term in the sum. Since x = x∗ + v, Ex [exp(x β)|x∗ ] =
Ev [exp(x∗ β) exp(v β)|x∗ ] = exp(x∗ β) exp(.5β  vv β). The last step uses
v β ∼ N[0, β  vv β] so Ev [exp(v β)] = exp(.5β  vv β). It follows that
Ex [exp(x β − .5β  vv β)|x∗ ] = exp(x∗
i β) as desired. For the second term
Ex [yx β|y, x∗ ] = Ev [y(x∗ β + v β)|y, x∗ ] = yx β.

13.2 Measurement Errors in Regressors

477

The corresponding first-order conditions are called the corrected score. For
Poisson the corrected score estimator solves
n

{yi xi − exp(xi β − .5β 

vv β)(xi

−

vv β)}

= 0.

(13.13)

i=1

Buonaccorsi (1996) relaxes the normality assumption for v and proposes an
approximation called a modified estimating equation with first-order conditions
n


{yi xi − (1 − .5β 


vv β) exp(xi β)xi

+ exp(xi β)

vv β}

= 0. (13.14)

i=1

Guo and Li (2001) also relax the assumption of normally distributed measurement error. Then the exact corrected log-likelihood is
L++ (β|y, X) =

n


{−Ex∗i [exp(x∗
i β)] + yi xi β − ln yi !},

(13.15)

i=1

and the corrected score estimator solves
n

∗
{yi xi − Ex∗i [exp(x∗
i β)xi ]} = 0.

(13.16)

i=1

For multivariate x∗ , the computation of E[exp(x∗ β)] is not straightforward,
even if the distribution of x∗ is known, because multiple integrals are involved.
Simulation-based methods (Li, 2000) provide one possible approach to this
problem.
13.2.7

Structural Methods

The preceding approaches did not specify a distribution of the regressors;
only a distribution for the measurement error is assumed. They are called
functional methods. By contrast structural methods specify a distribution for
the regressors.
Hsiao (1989) considers the nonlinear model with E[y|x∗ ] = m(x∗ ; β) and
assumes the classical measurement error model where both x∗ and v are normally distributed. It follows that x∗ |x is normally distributed with parameters
δ, say, and one can obtain

E[y|x] = m(x∗ ; β)f (x∗ |x, δ)dx∗ = g(x; β, δ).
(13.17)
Hsiao considers identification issues for the NLS estimator that minimizes
n

(yi − g(xi ; β, δ))2

(13.18)

i=1

with respect to βand δ, and for a two-step estimator that first estimates δ and
then minimizes i (yi − g(x; β, δ̂))2 .

478

Measurement Errors

Shklyar and Schneeweiss (2005) specialize to the Poisson. Then rather than
NLS estimation it may be more efficient to use the Poisson quasi-MLE with
mean function
 g(x; β, δ). The authors consider the case where δ is known and
minimize i {yi ln g(xi ; β, δ) − g(xi ; β, δ)} with respect to β. As expected,
this estimator is more efficient than the corrected score estimator, which does
not use knowledge of the distribution of x∗ .
Li (2000) considers a more general structural model where the distributions
of x and v are not necessarily normal. Then simulation methods are needed
because g(x; β, δ) is nontractable. He proposes a simulated minimum distance
estimator.
More efficient estimation bases estimation on the density f (y|x) rather
than on the conditional mean E[y|x]. But the density is nontractable. Instead
estimation could be by simulated maximum likelihood or by Bayesian methods
with a diffuse prior. For normally distributed x∗ and v, Guo and Li (2001) use
SML to estimate a negative binomial model for physician outpatient visits with
the regressor income mismeasured. Jordan, Brubacher, Tsugane, Tsubono, Gey,
and Moser (1997) use Bayesian methods for a Poisson model for the number
of deaths, with the regressor plasma lycophene levels mismeasured.
With replicate data or data on an instrument, a fully structural model can be
cast as a special case of a generalized linear latent and mixed model (GLAMM).
Suppose y is Poisson distributed with a single mismeasured regressor x ∗ and
other correctly measured regressor w, so μ = exp(βx ∗ + w γ ). Let x1 and x2
be replicates of x, with xj = x ∗ + uj , uj ∼ N[0, σ 2 ], j = 1, 2, so we have
classical measurement error that is normally distributed. More generally x2 can
be an instrument satisfying x2 = λx ∗ + u2 , u2 ∼ N[0, σ 22 ]. And assume that the
true regressor is normally distributed, with x ∗ = w δ + ε, where ε ∼ N[0, τ 2 ].
Then ML estimation is possible using a statistical package for GLAMMs.
13.2.8

Nonparametric Methods

More flexible methods, including nonparametric and semiparametric methods,
use the following result for data observed with classical measurement error.
Let
z = z∗ + v,

(13.19)

where here z may be regressor variables or dependent and regressor vari
ables. Let φ v (v) = E[eit v ] denote the characteristic function of v, with the
characteristic functions φ z (z) and φ z∗ (z∗ ) similarly defined. Given independent
measurement error, the characteristic function of z is φ z (z) = φ z∗ (z∗ )φ v (v), so
the characteristic function of z∗ can be estimated using
φ̂ z∗ (z∗ ) = φ̂ z (z)/φ̂ v (v).

(13.20)

This in turn can be used to estimate the desired density fˆz∗ (z∗ ) of the true variable z∗ using a truncated inverse Fourier transform. This approach is referred

13.3 Measurement Errors in Exposure

479

to as identification via deconvolution. Clearly φ̂ z (z) can be estimated from the
observed data. Estimation of φ̂ v (v) requires additional information, which may
be specification of a distributional model for v or replicated data.
Chen, Hong, and Nekipelov (2011) provide a detailed survey for nonlinear
models of this active area of theoretical research. We summarize a few key
papers that are applicable to a count model with an exponential conditional
mean or, in some cases, a nonparametric conditional mean.
Li (2002) applies this approach to the nonlinear model E[y|x∗ ] = m(x∗ , β)
with m(·) specified, classical measurement error in x∗ , and two independent
measurements of x∗ . The deconvolution method can be used to obtain the
estimated conditional distribution fˆx∗ |x (x∗ |x), and given this one can estimate
using the structural method of Hsiao (1989) as in section 13.2.7.
Hong and Tamer (2003) show that Li’s model can be estimated even without
replicate data, if the measurement error v is Laplace distributed.
Schennach (2007) generalizes the model of Newey (2001), see section
13.2.4, to a model with nonparametric regression function and nonparametric relationship between x∗ and z.
Ben-Moshe (2011) shows that estimators based on empirical first-order
derivatives of characteristic functions can be used to derive the distribution of
x∗ under weaker conditions than previously realized. In particular the measurement error model may have more unobservables than equations, allowing for
dependent unobservables.
13.2.9

Nonclassical Measurement Error

Nonclassical measurement error can arise in several ways. A common case is
when a regressor is binary. We have x = x ∗ + v, where x is 0 or 1 and x ∗ is
0 or 1. Then v = x − x ∗ is ≥ 0 if x ∗ = 0 and v ≤ 0 if x ∗ = 1. It follows that
the measurement error v is negatively correlated with the true value x ∗ . Most
studies focus on estimation in the linear regression model. For nonlinear models
Mahajan (2005) gives a quite general treatment that permits nonparametric
identification given an instrument-like variable that satisfies stronger conditions
than for standard IV estimation.
This binary regressor example is an example of a misclassified regressor.
More generally categorical and count data may be misclassified. In the next
sections we consider in detail count regression when the dependent variable is
misclassified.
13.3 MEASUREMENT ERRORS IN EXPOSURE
From Chapter 1.1 the general Poisson density is

y
e−μi ti μi ti i
f (yi |μi ti ) =
, yi = 0, 1, . . . .
yi !

(13.21)

480

Measurement Errors

Compactly, we refer to this density as P[μi ti ]. Here ti denotes exposure, defined
as the interval during which the subject is at risk of experiencing the event,
and μi denotes intensity, the mean number of event occurrences in an exposure
interval of unit length. Note that in most of the book exposure does not appear
because we have (implicitly) assumed that exposure intervals are of the same
length for all individuals (e.g., the past two weeks), normalized ti = 1 for all i,
and assumed no measurement error.
The preceding section considered measurement errors in regressors that
determine the intensity rate μ. For example, in modeling the number of insurance claims for auto accidents, the desired regressor lifetime driving experience
may be mismeasured when using number of years that a driving license has
been held. Now we consider measurement error in the variable t that measures
exposure. Continuing the auto insurance claims example, an error arises if it is
assumed that all cases in the sample were covered by insurance for the entire
period under study, but in fact some members were only covered for some part
of the period.
A separate treatment of measurement error in exposure is warranted for several reasons. First, exposure t determines the mean μt multiplicatively. Second,
there is no associated coefficient because the coefficient of t is constrained to be
unity. Third, it is usually assumed that the measurement error is a multiplicative
form of Berkson error; see section 13.2.1 for the additive form. Specifically,
y ∼ P[μt ∗ ] with t ∗ = tv where v is distributed independently of t with mean
1. For example, the interview may ask about events in the past year, so t is set
at one year, but due to recall error the true time period t ∗ is not exactly one
year. By contrast a multiplicative form of classical measurement error specifies
t = t ∗ v.
Exposure need not necessarily measure only time, because other variables
such as population, distance, and so forth may also be relevant. Measurement
errors from exposures in the general case have been considered by Brännäs
(1995b) and Alcañiz (1996).
In analyzing the consequences of measurement errors, one may either focus
on the properties of a particular estimator, such as inconsistency, or study the
effect on the entire distribution of the observed random variable. The first
approach is widely used in the analysis of linear errors-in-variables models.
The main technique in the latter case involves considering a small-variance
local Taylor expansion around the true density (Cox, 1983) and studying the
properties of the resulting approximate density.
In relation to exposures, three separate cases are considered. The first is the
case of known but unequal exposures, which can be handled in a relatively
straightforward manner. The second situation is that in which the exposure
variable is not directly observed, but there is information on observable factors that affect it. The third case is one in which the exposure period is not
observed and is incorrectly assumed to be the same for all subjects, giving rise to
measurement errors. A potential advantage of specifying exposures explicitly

13.3 Measurement Errors in Exposure

481

is to permit separate identification of factors that affect exposure rather than
the intensity parameter.
13.3.1

Correctly Observed Exposure

Using the exponential mean specification we have
μt = exp(x β)t
= exp(x β + ln t)

(13.22)

= exp(x β + β k+1 ln t),
where β k+1 = 1. Estimation for standard models such as Poisson and negative
binomial can proceed via constrained maximum likelihood, with the coefficient
of ln ti being restricted to unity. The constraint can be imposed directly by
substitution into the likelihood, and the constrained coefficient is called an
offset coefficient.
Another alternative is to estimate β k+1 freely. A Wald test of the null hypothesis that β k+1 = 1 can be used as a model specification test.
13.3.2

Multiplicative Berkson Error in Exposure

In this section we show that measurement error in exposure in the Poisson model
is qualitatively analogous to measurement error in the dependent variable in the
linear regression. A consequence is to inflate the variance through overdispersion. Under appropriate assumptions we find strong parallels between measurement errors and unobserved heterogeneity: both lead to overdispersion while
the Poisson MLE remains consistent. There are also strong parallels in the
algebraic analysis of the two problems.
Assume that the regression model for intensity μi is correctly specified and
with no measurement error (e.g., μi = exp(xi β)). But exposure ti∗ is measured
with error that is uncorrelated with the explanatory variables xi . The Poisson
model (13.21) yields for typical observation
∗

f (y|μ, t ∗ ) =

e−μt (μt ∗ )y
.
y!

(13.23)

In considering the impact of measurement error on the properties of the estimator, notice that the model set-up is exactly analogous to the case of multiplicative
heterogeneity considered in earlier chapters. The variable t ∗ replaces the term ν.
Consequently, in the presence of random measurement errors in t ∗ , the
mixed Poisson model emerges. In particular, if t ∗ = tv, t is normalized to unity
so t ∗ = v, v is gamma distributed with mean 1, and the resulting marginal
distribution of y is the NB2; see Chapter 4.2.2.
To handle the mixture problem quite generally we follow the approach of
Gurmu, Rilstone, and Stern (1995) given in Chapter 11.4.2. Let t ∗ have density

482

Measurement Errors

g(t ∗ ); then the density of y conditional on μ only is


∗

e−μt (μt ∗ )y ∗ ∗
g(t )dt
y!

μy
∗
(t ∗ )y e−μt g(t ∗ )dt ∗
=
y!

h(y|μ) =

=

μy (y)
M ∗ (−μ),
y! t

where Mt ∗ (−μ) = Et ∗ e−μt

∗

(13.24)

denotes the moment generating function for t,

Mt (−μ) = Et ∗ (t ∗ )y e−μt
(y)

∗

(13.25)

is the y th order derivative of Mt ∗ (−μ), and Et denotes expectation with respect
to the distribution of t ∗ . Essentially (13.24) gives the mixed Poisson density
which can be analyzed after choosing a suitable g(t ∗ ) density and then doing the
(y)
necessary algebra to derive the term Mt ∗ (μ). A flexible specification of g(t ∗ )
can be obtained using a series expansion, though this generates formidable
algebraic and computational detail as shown in Chapter 11.4.2.
Continuing with the assumption that the intensity function μ is correctly
specified, the assumption of a multiplicative measurement error t ∗ = tv with a
specified parametric distribution for v leads to a mixed (overdispersed) Poisson
model. Interestingly, this result implies that overdispersion in a count model
may reflect measurement error in exposures. Under standard assumptions, such
as a gamma distribution for v that leads to an NB2 distribution for y, the random
measurement errors in exposures do not affect consistency of the Poisson MLE.
13.3.3

Small Measurement Error in Exposure

Furthermore, if the variance of the exposure measurement error is O(n−1/2 ) –
(a case of “modest overdispersion” in Cox’s (1983) terminology) – then the
estimator is also asymptotically efficient. A heuristic demonstration of this
point follows from a second-order Taylor expansion of (13.21) around (ti − 1).
In general, however, the limit distribution of the estimator is not affected by the
measurement error.
Suppose observed exposure is of unit length with t = 1, so the measurement
error is v = t ∗ − t = t ∗ − 1. Furthermore, assume the measurement error has
finite variance and is uncorrelated with (y − μ):
E [t ∗ − 1] = 0
E [(t ∗ − 1)(y − μ)] = 0
E (t ∗ − 1)2 = σ 2v .

(13.26)

13.3 Measurement Errors in Exposure

483

The true model is P[μt ∗ ] but we instead set exposure to unit length and estimate
P[μ]. A second-order Taylor expansion of P[μt ∗ ] around P[μ] yields
∗

e−μt (μt ∗ )y
= P[μi ][1 + (y − μ) (t ∗ − 1)
y!


+ 12 (y − μ)2 − y (t ∗ − 1)2 + O (t ∗ − 1)3 ].
Then taking expectation with respect to t ∗ , and using (13.26), yields as density
for y given μ


1
(13.27)
(y − μ)2 − y σ 2v /a(μ, σ 2v ),
h(y|μ) ≈ P[μ] 1 +
2
where a(μ, σ 2v ) is a normalizing constant.
From (13.27) it can be seen that, under the assumption that the measurement
error variance σ 2v is O(n−1/2 ), h(y|μ) ≈ P[μ] so neglect of overdispersion is
not asymptotically a serious misspecification. We can also interpret (13.27) to
mean that the use of mixed Poisson models may be justified by the presence of
particular types of measurement errors.
Suppose instead that (y − μ) and (t − 1) are correlated, which is the case if
measurement error in exposure is correlated with the regressor determining μ,
with


E (y − μ) t ∗ − 1 ≡ σ xv .
Then (13.27) implies


 2
1
2
h(y|μ) ≈ P[μ] 1 + σ xv +
(y − μ) − y σ t ∗ /a(μ, σ 2v , σ xv ).
2

Unlike the previous case, the moments of this distribution additionally depend
on the distribution of the measurement error through the covariance σ xv . Consequently, because the first moment of the distribution is no longer μ, estimators
based on the Poisson mean specification will be inconsistent. In general, the
entire distribution of y, not just the variance, is affected by this type of measurement error.
Heuristically, the inclusion in the conditional mean function of variables
correlated with exposure measurement error should reduce the extent of misspecification. This provides a motivation for using proxy variables for exposure.
13.3.4

Proxy Variables for Exposure

In some cases the exposure is more realistically specified as a function of a set of
observables. For example, Dionne, Desjardins, Labergue-Nadeau, and Maag
(1995) estimate the effect of different medical conditions on truck drivers’
distribution of accidents, including exposure factors measured by hours behind
the wheel, kilometers driven, and other qualitative factors. The exponential
conditional mean function is specified as a function of variables that affect the

484

Measurement Errors

intensity of the process (x1 ) and those that affect the exposure (x2 ). Then
μt ∗ |x1 , x2 = exp(x1 β 1 + ln t ∗ )
= exp(x1 β 1 + x2 β 2 ),

(13.28)

which does not require constrained estimation. Usually the variables determining exposure will determine t ∗ multiplicatively and hence determine ln t ∗
additively in logarithms. For example, x2 may include the natural logarithm of
kilometers driven.
A random error may also be included in the conditional mean. For example,
if
t ∗ = exp(x2 β 2 )u,
where u denotes an iid error with unit mean, then one will get results similar to
those in subsection 13.3.2.
13.3.5

Berkson Error in Regressors

Poisson models use an exponential specification for the conditional mean. Then
an additive Berkson measurement error model and unobserved heterogeneity
models can be shown to be algebraically similar. Different implications can be
generated, however, by changes in those assumptions.
The additive Berkson error model specifies x∗ = x + v; see section 13.2.1.
Then for the model y|μ ∼ P[μ], where μ = exp(x∗ β). The conditional mean
μ becomes
E[y|x, v] = exp (x + v) β
= exp(x β) exp(v β)
= exp(xβ)w,

(13.29)

where w = exp(v β).
This formulation has an obvious parallel with unobserved heterogeneity.
Consider the exponential mean model with multiplicative heterogeneity. Then
y|μ, ν ∼ P[μν], where
μν = exp(x β)ν.

(13.30)

Clearly one can interpret the unobserved heterogeneity term in (13.30) as due
to Berkson measurement error.
Unobserved heterogeneity may also be interpreted as reflecting omitted
regressors z, as in
μ|x, z = exp(x β + z γ )
= exp(x β) exp(z γ )
= exp(x β)u,

(13.31)

where u = exp(z γ ), which is again algebraically similar to the preceding
measurement error and heterogeneity models.

13.4 Measurement Errors in Counts

485

These similarities can be exploited by reinterpreting the analysis of section 13.3.3. For example, parallel to (13.26), we may specify E[w − 1] = 0,
E (w − 1)2 = σ 2w , and E[(w − 1)(y − μ)] = σ xw . Furthermore, parallel to
(13.27), we can derive

1
(y − μ)2 − y σ 2w /a(μ, σ 2w ).
h(y|μ) ≈ P[μ] 1 + σ xw +
2
So the effects of additive Berkson measurement error are qualitatively similar
to those due to omitted heterogeneity, errors in exposure, or omitted regressors
from the conditional mean. If the measurement errors are uncorrelated with the
regressors x, then E[v|x] = E[v] and w has unit mean and finite variance. Then
the consequences of measurement error are essentially the same as those due
to unobserved heterogeneity, namely overdispersion and loss of efficiency of
the QML estimator.
An alternative assumption allows for possible correlation between x and
v. Mullahy (1997a) has argued by reference to the omitted variable case that
nonzero correlation is more realistic. That is, one or more of the omitted
regressors are likely to be correlated with the included variables. Then the
standard QMLE is also inconsistent.
13.4 MEASUREMENT ERRORS IN COUNTS
Measurement error in the dependent count variable leads to inconsistency of
standard count data estimators. The classical measurement error model for the
dependent variable is inappropriate since it does not ensure that the observed
y is nonnegative or that it is a count. A variety of parametric models have been
proposed corresponding to different mechanisms for the measurement error.
These models are presented in this section and the two subsequent sections.
13.4.1

Additive Measurement Errors in Counts

Suppose that error-contaminated counts, denoted by y, are nonnegative and
integer valued. Let y ∗ denote the true unobserved count and ε the additive
measurement error. That is,
y = y ∗ + ε,

(13.32)

where y ∗ and ε are nonnegative integers.
One simple model specifies y ∗ |μ ∼ P[μ] and ε|γ ∼ P[γ ], with y ∗ and ε
independently distributed. This implies that
y|μ, γ ∼ P [μ + γ ] .
So the measurement error leads to a larger mean and variance relative to the
distribution of y ∗ . Because the model has a nonnegative measurement error it
is useful only for characterizing count inflation.

486

Measurement Errors

More generally we might consider the case where ε in (13.32) is integer
valued, but ε can be negative. This assumption permits undercounts as well as
overcounts. But the nonnegativity restriction on y implies parallel restrictions
on the distribution of ε. It is implausible to expect such restrictions to hold if it
is assumed that y ∗ and ε are independently distributed. A joint distribution for
y ∗ and ε in (13.32) that admits correlation may be more appropriate.
Binomial thinning is another example of a mechanism for generating measurement errors in counts. Then we observe
y = π ◦ y∗,

(13.33)

where ◦ denotes the binomial thinning operator given in Chapter 7.6.1 and
the observed count π ◦ y ∗ is the realization of y ∗ binomial trials, each with
probability of success π , π > 0. This is necessarily a model of undercounts.
A variation is to suppose
y = π ◦ y ∗ + ε,

(13.34)

where ε is nonnegative integer distributed. Under the strong assumption that y
and y ∗ have the same distribution we can interpret the observed y as being the
sum of two counts. The first is due to an undercount π ◦ y ∗ of the true count.
The second is an independent overcount of ε. If ε is Poisson distributed, then
y is Poisson distributed with mean E[ε]/(1 − π ).
13.4.2

Misclassified Counts and Validation Data

Counted events may be categorized by types. Classification into types may
itself be subject to error, leading to an incorrect total number of events in
each category. If validation data are available, then one can correct for the
misclassification.
Whittemore and Gong (1991) consider an application to estimating the
mortality rate from cervical cancer using cross-country grouped data on deaths
and population at risk in different age groups. They assume that no deaths
from other forms of cancer are misdiagnosed as cervical cancer, but some
deaths due to cervical cancer are misdiagnosed as due to other cancers. “The
process of classifying has perfect specificity, but imperfect sensitivity denoted
by π, and the sensitivity π may vary with covariates” (Whittemore and Gong,
1991, p. 83). The concern is that π i varies across countries, and differences
in age-adjusted mortality rates for cancer across countries may merely reflect
differences in misdiagnosing cervical cancer.
In this example the counts are underreported, with a specific underreporting
mechanism. Validation data are available to correct for this underreporting.
Specifically suppose from a separate source that wi known deaths due to cervical
cancer are independently examined by a panel of doctors, and let w1i and w2i
denote the number of correct and incorrect classifications of cervical cancer,
respectively, with w1i + w2i = wi , i = 1, . . . , n.

13.4 Measurement Errors in Counts

487

Assume (i) w1i ∼ Bin[π i , w1i + w2i ]; (ii) disease occurs in each population
i as a Poisson process with yi∗ ∼ P[μ∗i ]; and (iii) distinct populations are
independent. In this application μ∗i = λ∗i Li , where λ∗i is the true disease rate
per person-year and the exposure variable Li denotes person-years at risk. Then
the Poisson assumption about the actual occurrence of the disease implies that
observed disease counts yi , subject to misclassification error, are mutually
independent Poisson variates.
Specifically for the observed (with classification error) counts of cervical
cancer,
yi ∼ P[μi ]
μi = π i μ∗i = π i λ∗i Li .
The density for the i th observation is then the product of Poisson and binomial
likelihoods,
w2i
1i
f (yi , w1i , w2i |μi , π i ) = e−μi μi yi π w
/yi !,
i (1 − π i )

and the log-likelihood is
L(λ∗ , π ) =

n


{yi ln π i + yi ln λ∗i − π i λ∗i Li + w1i ln π i

i=1

+ w2i ln (1 − π i )}.

(13.35)

A natural parametrization of the model is an exponential model λ∗i =
exp(xi β) for the Poisson rate parameter and a logit model π i = (zi δ) =
exp(zi δ)/ 1 + exp(zi δ) for the probability of correct classification.
Whittemore and Gong (1991, pp. 90–91) extend this model to one of classification of K different mutually exclusive diseases where
 each disease may
be under- or overreported, subject to the restriction that K
j =1 π j k = 1, where
π j k is the probability that true disease k is classified as disease j . Then a
multinomial logit model offers a suitable parameterization of the recording
process. The approach is closely related to that for log-linear models for categorical data with misclassification errors. There are some similarities between
this approach and that presented in section 13.5 for underrecorded counts,
especially in relation to modeling the misclassification probability in terms
of observed covariates. However, here it is assumed that validation data are
available and that overreporting is possible.
13.4.3

Outlying Counts

In the data set on recreational trips used in Chapter 6 there was a suspicion
of measurement errors arising from the curious “clustering” in the number of
self-reported boating trips if that number was 10 or higher; see Table 6.9. Some
clustering at 10 and 15 trips and the presence of responses in “anchoring”
categories like 20, 25, 30, 40, and 50 raised a suspicion that the responses may
be affected by recall errors.

488

Measurement Errors

To avoid distorted inferences from such data, robust estimation based on
discarding some proportion of the data is sometimes recommended. Christmann
(1994, 1996) shows that the least median of weighted squares estimator for the
Poisson regression model has a high breakdown point and other desirable
properties.
13.5 UNDERREPORTED COUNTS
In this section we consider how one might model event counts if there is reason
to believe that some events that have occurred might not be recorded. It is
easy to see that if events y ∗ are distributed with mean μ, and each event has
a constant probability π of being observed, then the observed event count y
has mean μ = π μ. So a count model fitted to observed data yields information
about the product πμ that is clearly a downward-biased estimate of μ, the true
mean of the event process.
This section considers refinements of this basic model. The analysis relies on
distributional assumptions because validation data are presumed to be unavailable. It relies on prior information or theory that sharply distinguishes between
the variables that affect the event occurrence μ and those that affect the recording probability π . And it depends on the functional forms chosen for μ(·) and
π (·). Discussion of identification is given in Papadapoulos and Santos Silva
(2008).
13.5.1

Mechanism and Examples

The term “underrecording” refers to that feature of the method of data collection
that causes the observed (recorded) count to understate on average the actual
number of events. Parametric estimation and inference are to be based on the
recorded counts of the event.
Suppose events are generated by a pure count process, but for each event,
a Bernoulli process determines whether the event is recorded. The recording
process and actual event occurrence may be independent or dependent. In
either case, the recorded events are shown to follow a mixed binary process.
A regression model can be developed by parameterizing the moments of the
mixed process. The main idea is to combine a model of underrecording with a
model of the count process.
Examples of underrecorded counts may be found in many fields. They
include the frequency of absenteeism in workplaces (Barmby, Orme, and Treble, 1991; Johansson and Palme, 1996), the reporting of industrial injuries
(Ruser, 1991), the number of violations of safety regulations in nuclear power
plants (Feinstein, 1989), the frequency of criminal victimization (Fienberg,
1981; Schneider, 1981; Yannaros, 1993), needlestick injuries in hospital (Watermann, Jankowski, and Madan, 1994), and earthquakes and cyclones (Solow,
1993), to mention only a few.

13.5 Underreported Counts

489

Let y ∗ denote the true number of events. Suppose the probability that an
event is recorded, conditional on occurrence, is π , 0 ≤ π ≤ 1. Assume that the
recording and occurrence mechanisms are independent, an assumption relaxed
later. Then the mean number of recorded events, denoted y, is
E[y|μ, π ] = μπ,
where E[y ∗ ] = μ is the true mean and π is the average recording probability.
This leads to a simple nonlinear regression model based on parameterizing
the μ and π components. Letting μ = μ(x, β) and π = π (z, γ ), where μ(·)
and π (·) are known functions, the approach leads to a nonlinear regression
based on
E[y|x, z] = μ(x, β)π (z, γ ).

(13.36)

Natural choices are the exponential conditional mean for μ(·) and a logit or
probit model for π (·).
In the subsequent discussion, we take (13.36) as the basic equation of interest. Extensions considered include allowing dependence between event occurrence and the recording process, and modeling the distribution of y rather than
just the conditional mean.
13.5.2

Dependence between Events and Recording

Consider a bivariate binomial random variable (Y, R), where Y = 1 denotes
the single occurrence of an event of interest in some specified time interval,
and R = 1 denotes the recording of that event, but the recording process is
not directly observable. The following table establishes the notation for the
joint probabilities associated with the four possible outcomes, as well as the
associated marginal probabilities:
Y =1
Y =0

R=1
π 11
π 01
π

R=0
π 10
π 00
1 − π

π
1−π

Recording and occurrence may be dependent. For example, if an event
is an action of an informed individual, the probability that the event occurs
may depend on whether the event will be recorded. Thus the commission of
the crime is likely to be a function of the probability of detection. Similarly,
unauthorized absences from work will depend on the probability of the absence
being observed (recorded) by the employer.
We now consider the joint distribution of (Y, R) expressed in terms of the
marginals. Interest lies especially in Pr[R = 1|Y = 1] = π 11 /π . We wish to
re-parameterize this in terms of the marginal probabilities π and π  and the
correlation ρ = Cor[Y, R]. From the table it follows that π 11 , π 01 , π 10 , and

490

Measurement Errors

π 00 equal, respectively, π 11 , π  − π 11 , π − π 11 , and 1 − π  − π + π 11 . Some
considerable algebra yields Cov[Y, R] = π 11 − π π  . It follows that
π 11 − π π 
.
ρ = Cor[Y, R] = √
π(1 − π )π  (1 − π  )

(13.37)

Under independence of Y and R, π 11 = π π  so (13.37) yields ρ = 0 as
expected.
The conditional probability that the event is recorded, given that it has
occurred, is
π + = Pr[R = 1|Y = 1]
= π 11 /π
=π



1 − π
1−π
1+ρ√
√ 
π (1 − π) π (1 − π  )



(13.38)

= π  (1 + ρC),
where the third equality follows from (13.37) and the final equality defines

1/2
C ≡ (ππ  )−1/2 (1 − π)1/2 1 − π 
.
In the special case of independence ρ = 0, so π + = π  and the recording
probability does not depend on the event probability π .
One can choose to either model marginal probabilities (π, π  ) using a standard binary outcome model such as the logit or probit or to model the joint
distribution of (Y, R) using a standard bivariate probit-type model or a copulabased joint distribution derived from specified marginals as in Chapter 8.5. The
copula-based approach is also relevant when the objective is to model the joint
distribution of the indicator of event occurrence and the number of recorded
events.
From a count data perspective, however, the preceding discussion provides
a background for the joint modeling of the number of recorded events and of
the indicator variable for recording of the events. If the true number of events
is generated by a Poisson-type process with the rate parameter μ, then the
parameters of interest are μ and π  as well as the dependence ρ.
Distribution of Recorded Events
In the case of more than one recorded event for the i th individual we assume
a Poisson process for the events, so there is no serial correlation in the event
process. Similarly we assume there is no serial correlation in the recording
process. Then, given the conditional probability of recording an event, the
distribution of recorded events, yi , follows the Poisson distribution by the
following lemma derived in section 13.8.
Lemma. If π + is the probability that an event is recorded and the number of
events are distributed as P[μ], then the number of recorded events is distributed
as P[μπ + ].

13.5 Underreported Counts

491

The mean and variance (μπ + ) of the recorded events are smaller than the
mean and variance (μ) of the actual events. For given probability π  of recording
the event, (13.38) implies that the understatement of the Poisson mean is
greater if the correlation is negative. Underrecording can be interpreted as a
source of excess zeros because it causes the distribution to shift left, reducing
both the mean and the mode and leading to an excess of zeros relative to the
parent distribution. This effect, which is similar to the statistical phenomenon
of binomial thinning, appears to be a common feature of all underrecorded
count models considered here. If the probability of underrecording for a given
individual varies from event to event, the analysis given previously should be
interpreted in terms of an average recording probability for an event (Feller,
1968, p. 282).
The basic result extends in a straightforward manner to the negative binomial
model. The model can be motivated as follows. Let the number of recorded
events be distributed according to P[μπ + η] where η is a random unobserved
heterogeneity term distributed across individuals independently of μπ + . If η
is gamma distributed with unit mean and variance α, then unconditionally the
number of events follows the NB2[μπ + , α] distribution with mean μπ + and
variance μπ + (1 + αμπ + ).
Lemma. If π + is the probability that an event is recorded and the number
of events are distributed as NB2[μ, α], then the number of recorded events is
distributed as NB2[μπ + , α].
An extension to the hurdle model along similar lines is also possible.
Note that in general if the event process has mean μ and each event
occurrence is independently recorded with probability π + , then the number
of recorded events has mean μπ + .
13.5.3

Underrecorded Count Regressions under Independence

Independence, so π + = π  , may be a reasonable assumption in cases in which
the observed events (actions) do not adapt to the recording mechanism; for
example, see Solow (1993). To proceed to parametric regression models, additional functional form assumptions are required.
Suppose yi∗ has mean μi that is parameterized as g(xi , β), where usually
g(xi , β) = exp(xi β). And suppose the recording process R has probability
π i = F (zi , δ) where for the logit model, for example, F (zi , δ) = (zi δ) for
z
(z) = ez/(1+e ) . Ideally zi includes observable traits of the recording mechanism and differs from xi , though even then problems can arise as detailed
later.

The mean μ+
i = μi π i for the underrecorded count process is then parameterized as
E [yi |xi , zi ] = g(xi , β)F (zi , δ).

(13.39)

492

Measurement Errors

The conditional mean has a double-index structure, and the parameters β and
δ in the model (13.39) can be estimated by NLS given specification of g(·)
and F (·). When g(xi , β) = exp(xi β) and F (·) is the logistic cdf, then (13.39)
becomes


μ+
i ≡ E [yi |xi , zi ] = exp(xi β)(zi δ).

(13.40)

Note that if π i is constant for all observations, then it cannot be identified. Then F (zi , δ) = π  so (13.40) becomes E[yi |xi , zi ] = exp(β 0 + . . . +
β0 =
xik β k )π  ; therefore π  enters the model through the intercept term as 
(β 0 + ln π  ). Hence both β 0 and π  cannot be individually identified from an

intercept estimate <
β 0 . Under an alternative functional form for g(xi , β) this
problem may not arise.
Even when π i varies across observations, problems can arise. For model
(13.40) we have

μ+
i = exp(xi β)

exp(zi δ)
1 + exp(zi δ)

= exp(xi β + zi δ)

(13.41)

exp(−zi δ)
,
1 + exp(−zi δ)

so there are two Poisson-logit models that lead to the same conditional mean
function. In the case of scalar regressor with no intercept and xi = zi this
leads to two possible estimates: (i) (β, γ ) and (ii) (β + γ , −γ ). Restrictions on
(β, δ) are required to choose between two observationally equivalent models.
Papadapoulos and Santos Silva (2008) suggest identification via an a priori sign
restriction on one of the parameters or the use of nonsample information, such
as an exclusion restriction.
More efficient estimation is possible using ML or QML estimation. Using
the first lemma we obtain the Poisson QMLE from regression of yi on xi and
zi where the Poisson mean has the nonstandard form μ+
i given in (13.40).
Mukhopadhyay and Trivedi (1995) analyzed ML, QML, and moment-based
estimators. In the case of the NB2 model, the log-likelihood function given
independent observations is
L(β, δ, α) =

n

[ln (yi + α −1 ) + ln y! − ln (α −1 ) + α −1 ln(α −1 )
i=1
+
−1
− α −1 ln(α −1 + μ+
+ μ+
i ) + yi ln μi − yi ln(α
i )].

(13.42)
An alternative to the double-index model presented here is a single-index
model in which μ+
i is written in the form g(xi , zi ), where g(·) is treated as
a known or unknown function. That is, no attempt might be made to distinguish between the two separate components of μ+
i . Distinguishing between the

13.5 Underreported Counts

493

double- and single-index models in small samples may be especially difficult,
since this distinction relies heavily on functional forms.
Example: Safety Violations
An empirical example of the Poisson-binomial model analyzed earlier is Feinstein (1989). He used panel data from more than 1,000 inspections of 17 U.S.
commercial nuclear reactors by the Nuclear Regulatory Commission over three
years to study factors determining the rate of safety violations. The dependent
variable is the number of safety violations cited. He reported a finding that economic incentives had a small impact on noncompliance, whereas technological
and operating characteristics of the plant had a larger impact. The model he
considers has an additional complication. A sampled plant may or may not
comply with regulations, with probabilities 1 − f1 (xi β 1 ) and f1 (xi β 1 ), respectively. Then a violation by a noncompliant plant may or may not be detected,
with probabilities f2 (zi β 2 ) and 1 − f2 (zi β 2 ), respectively. Reported nonviolations come from the set of undetected violators and from genuine nonviolators.
These formulations lead to a likelihood function for violation and detection,

ln f1 (xi β 1 )f2 (zi β 2 )
L(β 1 , β 2 |x, z) =
i∈V

+

 


1 − ln f1 (x1i β 1 ) f2 (zi β 2 ) ,

i∈V c

where V is the set of detected violators and V c is its complement. In Feinstein’s
model the mean number of detected violations is the product of detection
probability and the mean number of violations, f2 (zi β 2 )μi . Feinstein calls his
estimator the detection control estimator.
13.5.4

Underreported Count Regressions under Dependence

Now suppose the observed counts refer to behavioral responses that incorporate
knowledge of, or adaptation to, the recording process. Then π + = π  but instead
from (13.38) π + = π  (1 + ρC), where
7
(1 − π )(1 − π  )
C=
> 0.
ππ
It follows that E[y] is now
μ+ = μπ  (1 + ρC).

(13.43)

The second term ρC measures the effect of the departure from independence of
the recording mechanism. This suggests that the functions μ, π  , and C should
be parameterized in such a way as to identify all parameters of interest. Doing
so is difficult because from section 13.5.2 ρ and C depend on probabilities in
the recording mechanism (R, Y ) other than just π  = Pr[R = 1]. In particular

494

Measurement Errors

they depend on π = Pr[Y = 1] or, in the more general case, on μ = E[y ∗ ].
Hence the ρC term depends on both x variables, through π or μ, and on the z
variables, through π  . If we substitute known functional forms for all unknown
parameters, the resulting expression for μ+ may not be tractable. This provides
some motivation for a functional form such as
μ+ = μπ  + g ∗ (x, z),

(13.44)

where g ∗ (·) is an unknown function that can be handled by nonparametric
methods; see Chapter 11.
To improve tractability, the use of an ad hoc “approximation” may simplify
the expression for μ+ . For example, let
μ+
i = g(xi β)F (zi , δ) + h(xi , zi , θ ),
where the function h(·) may be specified to mimic the properties of the term ρC.
Incorrectly ignoring the second term in (13.43) produces inconsistent estimates.
13.6 UNDERREPORTED AND OVERREREPORTED
COUNTS
The approach of section 13.5 can be adapted to accommodate overreporting as
well as underreporting.
13.6.1

Models

Zero inflation may reflect systematic underrecording in which either all event
counts are understated or the occurrence of a single event is not recorded. Hence
the with-zeros model introduced in Chapter 4.6 may be suitable for modeling
underrecording. Recall that it can also be used for modeling inflation of other
counts, such as a single event. Accordingly, the zero-inflation model has been
used when zeros only are overreported, and a zero-deflated distribution has
been used when the zeros are underrecorded (Cohen, 1960; Johnson, Kemp,
and Kotz, 2005).
The model
Pr[y = 0] = ϕ + (1 − ϕ)e−μ
Pr[y = r] = (1 − ϕ)e−μ μr /r!,

r = 1, 2, . . . ,

accommodates excess zeros relative to the Poisson (the case ϕ = 0) if 0 <
ϕ < 1. Furthermore, E[y] = μ(1 − ϕ) is consistent with underreporting since
E[y] = μ in the Poisson case.
Overreporting of specific values, such as a count of two, leads to inflation
at those values relative to the true frequency distribution. Some authors have
proposed models that allow for an excess of certain positive values relative to
a benchmark model such as the Poisson. From Chapter 6.5 fertility data have
an excess of counts of both zero and two. To allow for this in their study of

13.6 Underreported and Overrereported Counts

495

Swedish fertility, Melkersson and Rooth (2000) formulate the following model:
Pr[y = 0|x] = ϕ 1 + qh(y|x)
Pr[y = 2|x] = ϕ 2 + qh(y|x)
Pr[y = r|x] = (1 − ϕ 1 − ϕ 2 )h(y|x),

r = 1, 3, 4, . . . ,

where h(y|x) is the parent distribution, such as Poisson or NB2. Additional
flexibility may result from parameterizing ϕ 1 and ϕ 2 . This example shows how
this model can potentially capture both underreporting of values other than zero
and two. However, this example does require the assumption that the excess
probability at particular values is due to measurement errors and nothing else,
and such an assumption may be unwarranted.
A richer model is proposed by Li, Trivedi, and Guo (2003). A simple way
to allow for over-recording or underrecording while maintaining a count distribution is to specify a count distribution for y|y ∗ where y denotes the observed
counts and a count distribution is also specified for the true (unobserved) counts
y ∗ . To allow for underreporting of true zeroes, the distribution of y|y ∗ must be
such that the distribution of y|y ∗ = 0 is not degenerate. Li et al. propose the
following model
y ∗ ∼ NB2[exp(x β)]
y|y ∗ = 0 ∼ P[exp(z δ)]
y|y ∗ > 0 ∼ P[exp(z γ )y ∗ ],
where regressors x determine the true counts and regressors z determine the
recording process. The resulting density for f (y|x, z, β, δ, γ ) involves an infinite sum over y ∗ . Rather than truncate this sum, Li et al. estimate the model by
simulated ML.
They apply this model to National Crime Victims Survey data on the number
of thefts experienced by students at school. For their data 88% of observed
counts are 0 and about 1% exceed 4. The regressors z for the recording process
are a subset of the regressors x for the true number of counts. A comparison
of observed counts y with 500 replications from the fitted model of the true
counts y ∗ finds that 83% of counts were reported accurately (88% of counts
were 0), 12% were overreported, and 4% were underreported.
13.6.2

Empirical Evidence

Some evidence from the U.S. National Center for Health Statistics (1967) for
chronic medical conditions suggests that self-reported medical records may
understate the degree of health care usage. Hospitalizations have also been
found to be underreported in the United States.
McCallum, Raymond, and McGilchrist (1995) carry out an interesting study
using Australian data in which a comparison is made between the self-reported
number of doctor visits over a three-month period and the same usage as
measured by the (presumably more accurate) records of the Health Insurance

496

Measurement Errors

Commission. In a sample of around 500 individuals, they found that selfreported estimates were overreported relative to the Health Insurance Commission estimates for small numbers of visits (one to four), but generally
underreported for higher usage. McCallum et al. analyze the relation between
the reporting error and the characteristics of the respondents and conclude with
a cautionary note about the use of self-reported data. Cameron et al. (2004)
analyze the McCallum et al. data set, using a bivariate conditional copula for
self-reported and directly observed number of doctor visits. Such a bivariate
model can be used to study the conditional distribution of measurement errors
in cases where two measures of the same outcome are available and to provide
insights into the factors that affect these measurement errors.
13.7 SIMULATION EXAMPLE: POISSON WITH
MISMEASURED REGRESSOR
We investigate the consequences of classical measurement error in a single
regressor for Poisson regression, and the performance of several estimation
methods given in section 13.2. These methods are intended to reduce estimator
bias though are still inconsistent. We also present consistent ML estimates.
The model is a Poisson regression of y on x1 and x2 . The regressor x1 is
measured with error with two measures of the true value available: x1 , and
a replicate denoted z1 which can be used as a replicate or instrument. The
regressor x2 is measured without error:
∗
yi ∼ P[β 0 + β 1 × x1i
+ β 2 × x2i ]
∗
x1i = x1i
+ v1i
∗
z1i = x1i
+ v2i

(β 0 , β 1 , β 2 ) = (0, 1, 1).
The random variables x1∗ , x2 , v1 , and v2 are all independent draws with means
0 and standard deviation 0.4. It follows that there is considerable measurement
error with a signal-to-noise ratio of one. The sample size is 10,000.
In the first simulation all draws are from the normal distribution (see
Table 13.1). The count y has mean 1.157 and standard deviation 1.281. Most
counts are low, with 70% equaling 0 or 1, and the highest count is 10. Poisson
regression of y on x1∗ and x2 , given in the first column, yields estimates close
to the dgp values of 0, 1, and 1, as expected. Poisson regression of y on x1
and x2 , given in the second column, yields β̂ 1 = 0.523. This is essentially the
linear regression result that a noise-to-signal ratio of 1 leads to β̂ 1 = 0.5β 1 .
By contrast, β̂ 2 = 1.020 so that there is no impact on the coefficient of x2 , a
consequence of independence of x2 and x1 in this simulation design. Note also
that the standard error of β̂ 1 has decreased from 0.024 to 0.016.
The next four estimators seek to correct the large inconsistency of β̂ 1 ,
though all the methods are approximate methods that theoretically do not

13.7 Simulation Example: Poisson with Mismeasured Regressor

497

Table 13.1. Simulation exercise: Poisson regression with one mismeasured
regressor
Estimates given normally distributed variates
Variable
ONE
X1 or X1∗
X2

True

Naive

RCal

SIMEX

NL2SLS

IVapprox

MLE

−0.005
(0.011)
0.990
(0.024)
1.007
(0.023)

0.029
(0.010)
0.523
(0.016)
1.020
(0.023)

0.022
(0.011)
0.999
(0.031)
1.013
(0.024)

0.006
(0.010)
0.858
(0.024)
1.013
(0.024)

−0.072
(0.015)
0.961
(0.036)
1.025
(0.027)

0.039
(0.011)
0.958
(0.035)
1.026
(0.026)

−0.003
(0.011)
0.990
(0.029)
1.012
(0.025)

True

Naive

RCal

SIMEX

NL2SLS

IVapprox

0.010
(0.010)
0.975
(0.010)
0.987
(0.010)

0.033
(0.010)
0.692
(0.010)
1.000
(0.010)

0.015
(0.011)
1.254
(0.025)
0.980
(0.017)

0.008
(0.011)
0.956
(0.015)
0.984
(0.018)

−0.108
(0.018)
0.979
(0.023)
0.993
(0.025)

0.032
(0.013)
1.356
(0.047)
0.976
(0.023)

Estimates given rescaled chi-squared variates

ONE
X1 or X1∗
X2

−0.018
(0.012)
1.214
(0.021)
0.970
(0.016)

Note: Top panel is baed on simulated data with normally distributed variates. Bottom panel is
based on rescaled chi-squared variates. Robust standard errors are given in parentheses.

yield consistent estimates; see section 13.2.5. The regression calibration and
simulation extrapolation using the replicate z1 are implemented using Stata
programs due to Hardin, Schmiediche, and Carroll (2003a, 2003b) with 400
bootstrap replications. The fifth column uses the standard NL2SLS estimator
based on the condition E z(y − exp(x β)) = 0, where z1 is an instrument for
x1 and z2 is an instrument for itself. The sixth column uses the approximate IV
method that obtains a predictor x̂1 and estimates a Poisson regression of y on
x̂1 and x2 . All four methods do well. The only estimates that are more than two
standard errors from the dgp values are β̂ 1 = .858 for SIMEX and the intercept
for NL2SLS and approximate IV. For all but SIMEX there is a loss in precision
of estimation of β 1 while β 2 is as precisely estimated as before. The final column
is the exact MLE based on the structural model detailed at the end of section
13.2.7. The estimates are obtained using a Stata program for GLAMMs due
to Rabe-Hesketh, Skrondal, and Pickles (2003). The estimates are consistent
since the simulation is based on normally distributed measurement error and
true regressor.
In the second simulation all draws are from √
the highly skewed adjusted chisquared distribution. For example, x1∗ = (0.4/ 2)(w − 1) where w is a draw
from χ 2 (1). All variables are more skewed and leptokurtic, though the variance
is unchanged. The count y has a higher mean of 1.324 and a standard deviation
of 2.807. Most counts are low, with 70% equaling 0 or 1, but there is a long tail

498

Measurement Errors

with 1% of counts exceeding 8. This dispersion leads to improved estimator
precision with the standard errors in the first column falling by 60%. The naive
estimator is again inconsistent, with β̂ 1 = 0.692, but with less attenuation bias
than in the normally distributed case. Unlike for the first design, the standard
error of β̂ 1 is the same for the naive estimator. The SIMEX and NL2SLS
methods correct for the measurement error, with β̂ 1 equal to, respectively,
0.956 and 0.979. By contrast, the regression calibration and approximate IV
methods yield β̂ 1 equal to, respectively, 1.254 and 1.356. For these methods
the bias is roughly as large as for the naive estimator, though now the true
parameter value is overestimated. The ML estimator of 1.214 given in the last
column is also inconsistent, a consequence of measurement error and the true
regressor no longer being normally distributed.
13.8 DERIVATIONS
We derive the lemmas in section 13.5. Let Y ∗ be the number of events and let
R1 , R2 , . . . , RY ∗ be a sequence of Y ∗ independent Bernoulli trials, in which
each Rj takes 1 if the event is recorded (with probability π + ) and 0 otherwise
(with probability 1 − π + ). The number of recorded events Y can be written as
Y = R1 + R2 + . . . + RY ∗ .
If Y ∗ is P[μ] distributed then the resulting distribution of Y is a compound
Poisson distribution, or a binomial distribution stopped by Poisson distribution.
This distribution can be derived using the pgf. Let ϕ(t) be the pgf of the Poisson;
then
ϕ(t) = exp(−μ + μt)

for any real t.

Let ξ (t) be the pgf of the Bernoulli trial; then
ξ (t) = (1 − π + ) + π + t

for any real t.

Then the pgf of Y is
ϕ(ξ (t)) = exp(−μ + μξ (t))
= exp(−(μπ + ) + (μπ + )t)

for any real t.

So Y is Poisson distributed with parameter μπ + .
The proof of the second lemma is similar to the first lemma. The pgf of the
negative binomial distribution is
ϕ(t) = (1 + γ − γ t)−α

−1

for any real t,

where γ = αμ. Then the pgf of Y is
ϕ(ξ (t)) = (1 + γ − γ ξ (t))−α

−1

= (1 + (γ π + ) − (γ π + )t)−α

−1

for any real t.

So Y follows a negative binomial distribution with parameters μπ + and α.

13.10 Exercises

499

13.9 BIBLIOGRAPHIC NOTES
Carroll et al. (2006) and Buonaccorsi (2010) provide up-to-date accounts of
recent research in measurement error in nonlinear models with an emphasis
on the GLM literature, including some results for the Poisson model. Some
of the estimators in these references are implemented using Stata code; see
Newton and Cox (2003) and associated references. The econometrics literature has focused on identification in nonlinear models under weak parametric
assumptions; see the survey by Chen et al. (2011).
A general discussion of the effects of measurement error on the distribution
of the response variable, in leading to a possible attenuation bias in the LEF
and LEFN classes of models, is given in Chesher (1991). Jordan et al. (1997)
estimate a Poisson regression with overdispersion and normally distributed
errors in variables for mortality data in a Bayesian framework using Monte
Carlo techniques. Guo and Li (2001) estimate a negative binomial model for
physician outpatient visits with normally distributed errors in variables using
simulated ML.
The proxy variable approach to modeling exposures is illustrated in Dionne
et al. (1995). Alcañiz (1996) examines computational algorithms for restricted
estimation of Poisson and NB2 models with errors in exposure.
Because counted outcomes are affected by misclassification of the occurrence of the event of interest, the literature on the effects of misclassification
of binary outcomes is also relevant to this chapter. Chen (1979) analyzes a loglinear model with misclassified data. Hausman, Abrevaya, and Scott-Morton
(1998) and Whittemore and Gong (1991) provide further references.
The section on underrecorded counts borrows from Mukhopadhyay and
Trivedi (1995). They also develop a score test for underrecording in a negative
binomial model. The representation of the bivariate binomial that they use has
been studied by Eagleson (1964, 1969). Eagleson’s work follows the earlier
contributions by Lancaster (1958, 1963). Cameron and Trivedi (1993) review
some earlier contributions.
13.10 EXERCISES
13.1 Consider the following sequential estimator: (1) Estimate the Poissonlogistic model given in section 13.5.3 by maximum likelihood. Let μ̂+ denote
the MLE. (2) Regress the quantity (y − μ̂+ )2 − μ̂+ on (μ̂+ )2 . (3) Substitute the
estimate of α, 
α , into the “score” equations obtained from (13.42) and solve
the equations,
s(θ(
α )) =

n 

yi − μ+
i
+
1
+
αμ
i
1

xi
(1 − (zi δ))zi


= 0.

Interpret this sequential estimator as a QGPML estimator. Compare the properties of the estimator with one in which α is estimated using the moment

500

Measurement Errors

equation
n

i=1


2
(yi − μ̂+
n−k−m
i )
= 0.
+ −
n
μ̂+
i (1 + α μ̂i )

13.2 Consider the recreational trips data from Chapter 6. It was suggested there
that the data may be subject to recall or measurement errors. Assuming that
these recall errors are potentially concentrated among high counts, reestimate
the Poisson and NB2 models after sequentially deleting counts greater than (a)
15, (b) 20, and (c) 25. Which parameters from the estimated model would you
expect to be most sensitive to such deletion? Does your expectation match the
observed outcome?
13.3 Using the set-up in section 13.5.2, and assuming independence between
event occurrence and event recording, show that the result of the first lemma
also extends to the hurdle count model.

APPENDIX A

Notation and Acronyms

ACF
AIC
AME
ARMA
BHHH
BIC
BPoiss
Boot
BVNB
BVP
CAIC
CB
CCRE
cdf
CFMNB
CFMP
CM
CML
COVML
CSFE
CSRE
CV
DARMA
dgp
Diag
DPM
E
EL
E[y|x]
EIV
Elast
ELEF

autocorrelation function
Akaike information criterion
average marginal effect
autoregressive moving average
Berndt-Hall-Hall-Hausman algorithm
Bayes information criterion
binary Poisson
bootstrap
bivariate negative binomial
bivariate Poisson
consistent Akaike information criterion
correlated binomial
conditionally correlated random effects
cumulative distribution function
slope-constrained finite mixture of negative binomials
slope-constrained finite mixture of Poissons
conditional moment (function or test)
conditional maximum likelihood
off-diagonal block of the (Fisher) information matrix
cluster-specific fixed effects
cluster-specific random effects
coefficient of variation
discrete ARMA
data-generating process
diagonal
Dirichlet Process Mixture
mathematical expectation
expected value of log-likelihood function
conditional mean of y given x
errors-in-variables model
elasticity
extended linear exponential family
501

502

Appendix A: Notation and Acronyms

EM
EW
f(y|x)
FE
FM
FMM
FMNB-C
FMP-C
GAM
GEC(k)
GEE
GLLAMM
GLM
GLS
GMM
HMM
HPD
IC
IG
iid
IM
INAR
INARMA
L[τ , z]
L
L
LEF
LEFN
LM
LR
mgf
m(s;π 1 , . . . , π n )
M(t)
MCMC
MEM
MER
MH
ML
MLE
MLH
MLOP
MPSD
N[μ, σ 2 ]
N[0, 1]
NB

expectation-maximization (algorithm)
Eicker-White
conditional density of y given x
fixed effects
finite mixture
finite mixture model
C-component finite mixture of negative binomial
C-component finite mixture of Poisson
generalized additive model
generalized event count model
generalized estimating equations
generalized linear latent and mixed model
generalized linear model
generalized least squares
generalized method of moments
hidden Markov model
highest posterior density
information criteria
inverse gamma
independently identically distributed
information matrix
integer-valued autoregressive
integer ARMA
Laplace transform
likelihood function
log-likelihood function
linear exponential family
linear exponential family with nuisance parameter
Lagrange multiplier
likelihood ratio
moment generating function
multinomial distribution
moment generating function
Markov chain Monte Carlo
marginal effect at the mean
marginal effect at a representative value
Metropolis-Hastings
maximum likelihood (method)
maximum likelihood estimator
maximum likelihood Hessian
maximum likelihood outer product
modified power series distributions
normal distribution with mean μ and variance σ 2
standard normal distribution
negative binomial

Appendix A: Notation and Acronyms

NB1
NB2
NBFE
NB1FE
NBH
NBRE
NBPp
NLIV
NLIV2
NLS
NLSUR
NPML
N (s,s+t)
OLS
OP
OPG
OrdProb
P[μ]
pdf
PFE
pgf
PGLM
PGP
PH
P-IG
plim
pmf
PML
PPp
PQGPML
PRE
PSD
QEE
QGPML
QGPMLE
QL
QVF
RE
RS
SC
SML
SMM
SNPML
SPML
TCM

NB distribution with linear variance function
NB distribution with quadratic variance function
negative binomial fixed effects model
negative binomial 1 fixed effects model
negative binomial hurdle
negative binomial random effects model
polynomial negative binomial of order p
nonlinear instrumental variable
sequential two-step NLIV
nonlinear least squares
nonlinear seemingly unrelated regressions
nonparametric maximum likelihood
number of events observed in interval (s,s+t)
ordinary (linear) least squares
outer product
outer product of gradient (score)
ordered probit
Poisson distribution with mean μ
probability density function
Poisson fixed effects
probability generating function
pseudo generalized linear model
Poisson-gamma polynomial
Poisson hurdle
Poisson inverse gamma mixture
probability limit
probability mass function
pseudo-maximum likelihood
polynomial Poisson (model) of order p
Poisson-based quasi-generalized PML
Poisson random effects
power series distribution
quadratic estimating equations
quasigeneralized PML
quasigeneralized PMLE
quasilikelihood
quadratic variance function
random effects
robust sandwich
Schwarz Bayesian information criterion
simulated maximum likelihood
simulated method of moments
semi-nonparametric maximum likelihood
semiparametric maximum likelihood
conditional moment test

503

504

TGoF
TH
TLM
TLR
TW
TZ
V
V[y|x]
VML
WLS
WZ
ZINB
ZIP

Appendix A: Notation and Acronyms

chi-square goodness-of-fit test
Hausman test
Lagrange multiplier (score) test statistic
likelihood ratio test statistic
Wald test statistic
standard normal test statistic
variance
conditional variance of y given x
diagonal block of the Fisher information matrix
weighted least squares
with (excess) zeros
zero-inflated Negative binomial
zero-inflated Poisson

APPENDIX B

Functions, Distributions, and Moments

For convenience we list in this appendix expressions and moment properties of
several univariate distributions that have been used in this book, most notably
the Poisson and negative binomial. But first we define the gamma function, a
component of these distributions.
B.1 GAMMA FUNCTION
Definition: The gamma function, denoted by (a) is defined by
 ∞
(a) =
e−t t a−1 dt,
a > 0.
0

Properties of the gamma function include the following:
1.
2.
3.
4.

(a) = (a − 1)(a − 1)
(a) = (a − 1)!
if√a is a positive integer
(0) = ∞, ( 21 ) = π

k
(na) = (2π )(1−n)/2 (n)na−1/2 n−1
k=0 (a + n ), where n is a positive
integer.

Definition: The incomplete gamma function, denoted by γ (a, x), is defined by
 x
γ (a, x) =
e−t t a−1 dt;
a > 0, x > 0.
0

The ratio γ (a, x)/ (a) is known as the incomplete gamma function ratio or
the gamma cdf.
The derivative of the logarithm of the gamma function is the digamma
function
d ln (a)
= ψ(a).
da
The digamma function obeys the recurrence relation
ψ(a + 1) = ψ(a) + 1/a,
505

506

Appendix B: Functions, Distributions, and Moments

and the j th derivative ψ (j ) (a + 1) with respect to a obeys the recurrence relation
ψ (j ) (a + 1) = (−1)j j !a −j −1 + ψ (j ) (a).
B.2 SOME DISTRIBUTIONS
B.2.1

Poisson

The Poisson density for the count random variable y is
f (y) =

e−μ μy
;
y!

y = 0, 1, . . . ;

μ > 0.

Then y ∼ P[μ] with mean μ, variance μ, mode μ − 1, moment generating function (mgf) exp μ(et − 1) , and probability generating function (pgf)
exp [μ(t − 1)].
B.2.2

Logarithmic Series

The logarithmic series density for the positive valued count random variable
y is
f (y) = α

θy
;
y

y = 1, 2, . . . ,

0 < θ < 1, α = − log (1 − θ )

−1

.


Then
y has mean αθ /(1 − θ), variance αθ (1 − αθ)/ (1 − θ )2 , mgf log 1−

θ et / log (1 − θ ), and pgf log (1 − θ t) / log (1 − θ) .
B.2.3

Negative Binomial

The negative binomial density for the count random variable y with parameters
α and P is


y
α
α+y−1
P
1
f (y) =
; y = 0, 1, . . . ; P , α > 0.
α−1
1+P
1+P
Then y has mean αP , variance αP (1 + P ), and pgf (1 + P − P t)−α .
Different authors use different parameterizations of the negative binomial
(Johnson, Kemp, and Kotz, 2005). In this book we reparameterize in terms of
the mean μ = αP , which leads to


y
α
α
α+y−1
μ
,
f (y) =
α+μ
α+μ
α−1
which has mean μ, variance μ(1 + μ/α), and pgf (1 + μ/α − μt/α)−α .
The special case of the geometric distribution is obtained by setting α = 1.
Pascal distribution is obtained by setting α equal to an integer.

Appendix B: Functions, Distributions, and Moments

507

Yet another commonly used parameterization of the negative binomial is

α+y−1 y
f (y) =
p (1 − p)α ; y = 0, 1, . . . ; 0 < p < 1, α > 0,
α−1
in which case y has mean αp/(1 − p) and variance αp/(1 − p)2 ; see Chapter 4.2.3.
B.2.4

Gamma

The gamma density for the positive continuous random variable y is
f (y) =

e−yφ y α−1 φ α
;
(α)

y > 0;

φ > 0, α > 0.

Then y has mean α/φ, variance α/φ 2 , and mgf exp [φ/(φ − 1)α ]. Then α is
called the shape parameter and β is called the inverse scale parameter.
An alternative parameterization of the gamma replaces β with 1/θ . Then y
has mean αθ and variance αθ 2 , and β is called the scale parameter.
B.2.5

Lognormal

The lognormal density for the positive continuous random variable y is

1
1
f (y) =
√ exp − 2 (ln y − ξ )2 ; y > 0;
2σ
σ y 2π
− ∞ < ξ < ∞, σ > 0, α > 0.
Then y has mean
exp σ 2 − 1 .
B.2.6

exp ξ + (1/2σ 2 )

and

variance



exp 2ξ + σ 2

Inverse Gaussian

The inverse Gaussian density for the positive continuous random variable y is
=

θ
θ (y − μ)2
f (y) =
; y > 0; θ > 0, μ > 0.
exp
−
2π y 3
2μ2 y
Then y has mean μ and variance μ3 /θ .
B.3 MOMENTS OF TRUNCATED POISSON
The k th order factorial moments of truncated Poisson can be derived conveniently in terms of the mean of the regular Poisson μ, the mean of the truncated
Poisson γ , the adjustment factor δ, and the truncation point r − 1. Both γ and
δ are defined in Chapter 4.3. Let E y (k) represent the k th descending factorial

moment of y, and y (k) = k−1
z=0 (y − z), k ≥ 1. For the left-truncated Poisson

508

Appendix B: Functions, Distributions, and Moments

model the factorial moments can be derived using
E y (k) = μk−1 + δ

k−2


μj π j ,

j =0

where


k−2−j

πj =

(r − 1 − i).

i=0

Hence the first four factorial moments of the left truncated Poisson are
E y (1) = γ
E y (2) = μγ + δ(r − 1)
E y (3) = μ2 γ + δ [(r − 1)(r − 2) + (r − 1)μ]
E y

(4)


(r − 1)(r − 2)(r − 3)
.
= μ γ +δ
+ (r − 1)(r − 2)μ + (r − 1)μ2
3

Given the factorial moments, the uncentered and central moments can be
obtained easily using the standard relationships between the three types of
moments. For details, see Gurmu and Trivedi (1992).

APPENDIX C

Software

Most regression packages support estimation of cross-section Poisson and negative binomial regression models. Packages that claim to have a significant
component for count models most likely cover cross-section truncated, zeroinflated, and hurdle models, and they may cover the standard panel count
models. Packages that instead only include counts within a GLM module do
not cover truncated, zero-inflated, and hurdle models and only cover panel
counts to the extent that they have GEE and generalized linear mixed model
modules. They do not cover the Poisson fixed effects model.
LIMDEP 9.0 covers a wide range of cross-section count models, including
censored, truncated, hurdle, zero-inflated, latent heterogeneity, and latent class,
as well as panel fixed and random effects Poisson and negative binomial.
Stata 12.0 covers a similar range of models. Additionally it covers GLM and
GEE estimators, some mixed models, and a wide range of mixed models with
user-written add-on GLLAMM.
SAS 9.3 covers a similar range of models to Stata through procedures
COUNT, TRCOUNT (a recent addition that covers zero-truncated and panel),
GENMOD, GEE, and NLMIXED. Procedure COPULA covers copula-based
models.
EViews 7.2 covers cross-section Poisson, NB, and GLM.
TSP 5.1 covers cross-section Poisson and NB. It also provides a relatively
simple syntax for ML and GMM estimation of user-provided objective functions, including panel count models.
SPSS 20 covers cross-section Poisson and NB and has procedures GENLIN,
GEE, and GLMM for GLMs and their multi-equation extensions.
R 2.14 covers cross-section GLMs with function glm. The R package pscl
includes hurdle and with-zeroes models, the package geepack covers GEE,
and a number of R packages cover nonlinear mixed models. The R package
np (Hayfield and Racine, 2008) provides kernel-based estimation of many
nonparametric and semiparametric models and was used in Chapter 11.
Gauss package Gaussx covers Poisson regression and package Discrete
Choice covers cross-section truncated, censored, and zero-inflated Poisson and
NB. The Gauss program ExpEnd (Windmeijer, 2002) enables GMM estimation
509

510

Appendix C: Software

of fixed effects panel count models with regressors that are endogenous and/or
lagged dependent variables.
For models where off-the-shelf software is not available, one needs to provide at least the likelihood function, for ML estimation, or the moment conditions and weighting matrix, for GMM estimation. In principle this can be done
using many regression packages, using matrix programming languages such
as R, MATLAB, GAUSS, SAS/IML, or Stata’s Mata. In practice numerical
problems can be encountered when models are quite nonlinear.
Software for simulation-based estimation is less readily available. The
BUGS package, an acronym for Bayesian inference. Using the Gibbs Sampler, implements MCMC methods including Gibbs and Metropolis-Hastings.
Lancaster (2004) includes a summary of BUGS and illustrative examples. WinBUGS is a Windows version of BUGS. BUGS can be run directly, run from R,
and run from a number of packages including Matlab, SAS and Stata. For Stata
see Thompson, Palmer, and Moreno (2006). For more advanced models most
researchers write more customizable code in a matrix programming language
such as R or Matlab. Bayesian MCMC methods are often coded in R.
All data sets and programs, written in Stata, that cover virtually all the
analysis in this second edition, are available from the authors’ respective web
sites.

References

Abrevaya, J., and C.M. Dahl (2008), “The Effects of Birth Inputs on Birthweight: Evidence from Quantile Estimation on Panel Data,” Journal of Business and Economic
Statistics, 26, 379–397.
Aitchison, J., and C.H. Ho (1989), “The Multivariate Poisson-Log Normal Distribution,”
Biometrika, 76, 643.
Aitken, M., and D.B. Rubin (1985), “Estimation and Hypothesis Testing in Finite
Mixture Models,” Journal of the Royal Statistical Society B, 47, 67–75.
Akaike, H. (1973), “Information Theory and an Extension of the Maximum Likelihood
Principle,” in B.N. Petrov and F. Csaki, eds., Second International Symposium on
Information Theory, 267–281, Budapest, Akademiai Kaido.
Alcaniz, M. (1996), Modelos de Poisson generalizados con una variable de exposicion
al riesgo, Ph.D. dissertation (in Spanish), University of Barcelona, Spain.
Alfo, M., and G. Trovato (2004), “Semiparametric Approaches Based on Random
Coefficient Framework,” Econometrics Journal, 7, 426–454.
Allison, P.D., and R.P. Waterman (2002), “Fixed–Effects Negative Binomial Regression
Models,” Sociological Methodology, 32, 247–265.
Al-Osh, M.A., and A.A. Alzaid (1987), “First Order Integer Valued Autoregressive
(INAR(1)) Process,” Journal of Time Series Analysis, 8, 261–275.
Altman, N.S. (1992), “An Introduction to Kernel and Nearest-Neighbor Nonparametric
Regression,” American Statistician, 46, 175–185.
Alzaid, A.A., and M.A. Al-Osh (1988), “First-Order Integer-Valued Autoregressive
(INAR(1)) Process: Distributional and Regression Properties,” Statistica Neerlandica,
42, 53–61.
Alzaid, A.A., and M.A. Al-Osh (1990), “An Integer-Valued pth-Order Autoregressive
Structure (INAR(p)) Process,” Journal of Applied Probability, 27, 314–324.
Alzaid, A.A., and M.A. Al-Osh (1993), “Some Autoregressive Moving Average Processes with Generalized Poisson Distributions,” Annals of the Institute of Mathematical Statistics, 45, 223–232.
Amemiya, T. (1974), “The Nonlinear Two-Stage Least Squares Estimator,” Journal of
Econometrics, 2, 105–110.
Amemiya, T. (1984), “Tobit Models: A Survey,” Journal of Econometrics, 24, 3–61.
Amemiya, T. (1985), Advanced Econometrics, Cambridge, MA, Harvard University
Press.

511

512

References

Amemiya, Y. (1985), “Instrumental Variable Estimator for the Nonlinear Error in Variables Model,” Journal of Econometrics, 28, 273-289.
Andersen, E.B. (1970), “Asymptotic Properties of Conditional Maximum Likelihood
Estimators,” Journal of the Royal Statistical Society B, 32, 283–301.
Andersen, P.K., O. Borgan, R.D. Gill, and N. Keiding (1993), Statistical Models Based
on Counting Processes, New York, Springer-Verlag.
Andrews, D.W.K. (1988a), “Chi-Square Diagnostic Tests for Econometric Models:
Introduction and Applications,” Journal of Econometrics, 37, 135–156.
Andrews, D.W.K. (1988b), “Chi-Square Diagnostic Tests for Econometric Models:
Theory,” Econometrica, 56, 1419–1453.
Arellano, M. (1987), “Computing Robust Standard Errors for Within-groups Estimators,” Oxford Bulletin of Economics and Statistics, 49(4), 431–434.
Arellano, M., and S. Bond (1991), “Some Tests of Specification for Panel Data: Monte
Carlo Evidence and an Application to Employment Equations,” Review of Economic
Studies, 58, 277–298.
Arnold, B.C., and D.J. Strauss (1988), “Bivariate Distributions with Exponential Conditionals,” Journal of the American Statistical Association, 83, 522–527.
Arnold, B.C., and D.J. Strauss (1992), “Bivariate Distributions with Conditionals in
Prescribed Exponential Families,” Journal of the Royal Statistical Society B, 53,
365–375.
Bago d’Uva, T. (2005), “Latent Class Models for Use of Primary Care: Evidence from
a British Panel,” Health Economics, 14, 873–892.
Bago d’Uva, T. (2006), “Latent Class Models for Utilisation of Health Care,” Health
Economics, 15, 329–343.
Baltagi, B.H. (2008), Econometric Analysis of Panel Data, edition 4, Chichester, John
Wiley and Sons.
Barlow, R.E., and F. Proschan (1965), Mathematical Theory of Reliability, New York,
John Wiley.
Barmby, T.A., C. Orme, and J.G. Treble (1991), “Worker Absenteeism: An Analysis
Using Micro Data,” Economic Journal, 101, 214–229.
Basu, A., and P.J. Rathouz (2005), “Estimating Marginal and Incremental Effects on
Health Outcomes Using Flexible Link and Variance Function Models,” Biostatistics,
6, 93–109.
Ben-Moshe, D. (2011), “Identification and Estimation in Models with Dependent Multidimensional Unobservables,” Working Paper, UCLA Department of Economics.
Berndt, E., B. Hall, R. Hall, and J. Hausman (1974), “Estimation and Inference in
Nonlinear Structual Models,” Annals of Economic and Social Measurement, 3/4,
653–665.
Besag, J. (1974), “Spatial Interaction and the Statistical Analysis of Lattice Systems,”
Journal of the Royal Statistical Society B, 36, 192–225.
Bishop, Y.M.M., S.E. Feinberg, and P.W. Holland (1975), Discrete Multivariate Analysis: Theory and Practice, Cambridge, MIT Press.
Blonigen, B. (1997), “Firm-Specific Assets and the Link between Exchange Rates and
Foreign Direct Investment,” American Economic Review, 87, 447–465.
Blundell, R., R. Griffith, and J. Van Reenan (1995), “Dynamic Count Models of Technological Innovation,” Economic Journal, 105, 333–344.
Blundell, R., R. Griffith, and J. Van Reenan (1999), “Market Share, Market Value and
Innovation in a Panel of British Manufacturing Firms,” Review of Economic Studies,
66(3), 529–554.

References

513

Blundell, R., R. Griffith, and F. Windmeijer (2002), “Individual Effects and Dynamics
in Count Data Models,” Journal of Econometrics, 108(1), 113–131.
Blundell, R., and R.L. Matzkin (2010), “Conditions for the Existence of Control Functions in Nonseparable Simultaneous Equations Models,” Working Paper, UCLA
Department of Economics.
Blundell, R., and J. Powell (2003), “Endogeneity in Nonparametric and Semiparametric Regression Models,” in M. Dewatripont, L.P. Hansen, and S.J. Turnovsky, eds.,
Advances in Economics and Econonometrics: Theory and Applications, Eighth World
Congress, Volume II, 312–357, Cambridge, Cambridge University Press.
Böckenholt, U. (1999), “Mixed INAR(1) Poisson Regression Models: Analyzing Heterogeneity and Serial Dependencies in Longitudinal Count Data,” Journal of Econometrics, 89, 317–338.
Böhning, D. (1995), “A Review of Reliable Maximum Likelihood Algorithms for Semiparametric Mixture Models,” Journal of Statistical Planning and Inference, 47, 5–28.
Böhning, D., E. Dietz, R. Schaub, P. Schlattmann, and B.G. Lindsay (1994), “The
Distribution of the Likelihood Ratio for Mixtures of Densities from the One-Parameter
Exponential Family,” Annals of the Institute of Statistical Mathematics, 46, 373–
388.
Böhning, D., and R. Kuhnert (2006), “Equivalence of Truncated Count Mixture Distributions and Mixtures of Truncated Count Distributions,” Biometrics, 62, 1207–1215.
Bortkiewicz, L. von (1898), Das Gesetz de Kleinen Zahlen, Leipzig, Teubner.
Boswell, M.T., and G.P. Patil (1970), “Chance Mechanisms Generating the Negative
Binomial Distributions,” in G.P. Patil, ed., Random Counts in Models and Structures,
volume 1, 3–22, University Park, Pennsylvania State University Press.
Bound, J., C. Brown, and N. Mathiowetz (2001), “Measurement Error in Survey Data,”
in J.J. Heckman and E.E. Leamer, eds., Handbook of Econometrics, volume 5, 3705–
3843, Amsterdam, North-Holland.
Boyer, B.H., M.S. Gibson, and M. Loretan (1999), “Pitfalls in Tests of Changes in
Correlations,” International Finance Discussion Papers Nr. 597. Board of Governors
of The Federal Reserve System.
Brännäs, K. (1992), “Limited Dependent Poisson Regression,” The Statistician, 41,
413–423.
Brännäs, K. (1994), “Estimation and Testing in Integer Valued AR(1) Models,” Umea
Economic Studies No. 355, University of Umea.
Brännäs, K. (1995a), “Explanatory Variables in the AR(1) Model,” Umea Economic
Studies No. 381, University of Umea.
Brännäs, K. (1995b), “Prediction and Control for a Time-Series Count Data Model,”
International Journal of Forecasting, 11, 263–270.
Brännäs, K., and J. Hellström (2001), “Generalized Integer-Valued Autoregression,”
Econometric Reviews, 20, 425–443.
Brännäs, K., and P. Johansson (1994), “Time Series Count Regression,” Communications
in Statistics: Theory and Methods, 23, 2907–2925.
Brännäs, K., and P. Johansson (1996), “Panel Data Regression for Counts,” Statistical
Papers, 37, 191–213.
Brännäs, K., and G. Rosenqvist (1994), “Semiparametric Estimation of Heterogeneous
Count Data Models,” European Journal of Operations Research, 76, 247–258.
Breslow, N. (1990), “Tests of Hypotheses in Overdispersed Poisson Regression and
Other Quasi-Likelihood Models,” Journal of the American Statistical Association,
85, 565–571.

514

References

Breusch, T.S., and A.R. Pagan (1979), “A Simple Test for Heteroscedasticity,” Econometrica, 47, 1287–1294.
Bryk, A.S., and S.W. Raudenbush (2002), Hierarchical Linear Models, edition 2, Newberry Park, CA, Sage Publications.
Bu, R., B. McCabe, and K. Hadri (2008) “Maximum Likelihood Estimation of HigherOrder Integer-Valued Autoregressive Processes,” Journal of Time Series Analysis, 29,
973–994.
Buonaccorsi, J.P. (1996), “A Modified Estimating Equation Approach to Correcting for
Measurement Error in Regression,” Biometrika, 83, 433–440.
Buonaccorsi, J.P. (2010), Measurement Error: Models, Methods, and Applications, Boca
Raton, FL, Chapman and Hall / CRC.
Burguette, J., A.R. Gallant, and G. Souza (1982), “On the Unification of the Asymptotic
Theory of Nonlinear Econometric Methods,” Econometric Reviews, 1, 151–190.
Buzas, J.S., and L.A. Stefanski (1996), “Instrumental Variables Estimation in Generalized Linear Measurement Error Models,” Journal of the American Statistical
Association, 91, 999–1006.
Cameron, A.C. (1991), “Regression Based Tests of Heteroskedasticity in Models Where
the Variance Depends on the Mean,” Economics Working Paper Series No. 379,
University of California, Davis.
Cameron, A.C., J. Gelbach, and D.L. Miller (2011), “Robust Inference with Multi-Way
Clustering,” Journal of Business and Economic Statistics, 29, 238–249.
Cameron, A.C., and P. Johansson (1997), “Count Data Regressions Using Series Expansions with Applications,” Journal of Applied Econometrics, 12, 203–224.
Cameron, A.C., and L. Leon (1993), “Markov Regression Models for Time Series Data,”
presented at Western Economic Association Meetings, Lake Tahoe.
Cameron, A.C., T. Li, P.K. Trivedi, and D. Zimmer (2004), “Modeling the Differences
in Counted Outcomes Using Bivariate Copula Models: With Application to Mismeasured Counts,” Econometrics Journal, 7, 566–584.
Cameron, A.C., and D.L. Miller (2011), “Robust Inference with Clustered Data,” in
A. Ullah and D.E. Giles, eds., Handbook of Empirical Economics and Finance,
1–28, Boca Raton, FL, CRC Press.
Cameron, A.C., and P.K. Trivedi (1985), “Regression-Based Tests for Overdispersion,”
Econometric Workshop Technical Report No. 9, Stanford University.
Cameron, A.C., and P.K. Trivedi (1986), “Econometric Models Based on Count Data:
Comparisons and Applications of Some Estimators,” Journal of Applied Econometrics, 1, 29–53.
Cameron, A.C., and P.K. Trivedi (1990a), “Regression-Based Tests for Overdispersion
in the Poisson Model,” Journal of Econometrics, 46, 347–364.
Cameron, A.C., and P.K. Trivedi (1990b), “Conditional Moment Tests and Orthogonal
Polynomials,” Indiana University, Pre-print.
Cameron, A.C., and P.K. Trivedi (1990c), “Conditional Moment Tests with Explicit
Alternatives,” Economics Working Paper Series No. 366, University of California,
Davis.
Cameron, A.C., and P.K. Trivedi (1990d), “The Information Matrix Test and Its Implied
Alternative Hypotheses,” Economics Working Paper Series No. 372, University of
California, Davis.
Cameron, A.C., and P.K. Trivedi (1993), “Tests of Independence in Parametric Models:
With Applications and Illustrations,” Journal of Business and Economic Statistics,
11, 29–43.

References

515

Cameron, A.C., and P.K. Trivedi (1996), “Count Data Models for Financial Data,” in
G.S. Maddala and C.R. Rao, eds., Handbook of Statistics, Volume 14: Statistical
Methods in Finance, Amsterdam, North-Holland.
Cameron, A.C., and P.K. Trivedi (2005), Microeconometrics: Methods and Applications,
Cambridge, Cambridge University Press.
Cameron, A.C., and P.K. Trivedi (2011), Microeconometrics Using Stata, Revised Edition, College Station, TX, Stata Press.
Cameron, A.C., P.K. Trivedi, F. Milne, and J. Piggott (1988), “A Microeconometric
Model of the Demand for Health Care and Health Insurance in Australia,” Review of
Economic Studies, 55, 85–106.
Cameron, A.C., and F.A.G. Windmeijer (1996), “R-Squared Measures for Count Data
Regression Models with Applications to Health Care Utilization,” Journal of Business
and Economic Statistics, 14, 209–220.
Cameron, A.C., and F.A.G. Windmeijer (1997), “An R-Squared Measure of Goodness
of Fit for Some Common Nonlinear Regression Models,” Journal of Econometrics,
77, 329–342.
Campbell, M.J. (1994), “Time Series Regression for Counts: An Investigation into the
Relationship between Sudden Infant Death Syndrome and Environmental Temperature,” Journal of the Royal Statistical Society A, 157, 191–208.
Carroll, R.J., D. Ruppert, L.A. Stefanski, and C.M. Crainiceanu (2006), Measurement
Error in Nonlinear Models: A Modern Perspective, edition 2, London, Chapman and
Hall/CRC.
Carroll, R.J., and L.A. Stefanski (1990), “Approximate Quasilikelihood Estimation in
Models with Surrogate Predictors,” Journal of the American Statistical Association,
85, 652–663.
Carroll, R.J., and L.A. Stefanski (1994), “Measurement Error, Instrumental Variables
and Corrections for Attenuation with Applications to Meta-Analyses,” Statistics in
Medicine, 13, 1265–1282.
Chamberlain, G. (1982), “Multivariate Regression Models for Panel Data,” Journal of
Econometrics, 18, 5–46.
Chamberlain, G. (1987), “Asymptotic Efficiency in Estimation with Conditional
Moment Restrictions,” Journal of Econometrics, 34, 305–334.
Chamberlain, G. (1992a), “Efficiency Bounds for Semiparametric Regression,” Econometrica, 60, 567–596.
Chamberlain, G. (1992b), “Comment: Sequential Moment Restrictions in Panel Data,”
Journal of Business and Economic Statistics, 10, 20–26.
Chan, K.S., and J. Ledolter (1995), “Monte Carlo EM Estimation for Time Series Models
Involving Counts,” Journal of the American Statistical Association, 90, 242–252.
Chang, F.-R., and P.K. Trivedi (2003), “Economics of Self-Medication: Theory and
Evidence,” Health Economics 12, 721–739.
Chen, T.T. (1979), “Log-Linear Models for Categorical Data with Misclassification and
Double Sampling,” Journal of the American Statistical Association, 74, 481–488.
Chen, X. (2007), “Large Sample Sieve Estimation of Semiparametric Models,” in
E.E. Leamer, eds., Handbook of Econometrics, volume 6B, 5549–5632, Amsterdam,
North-Holland.
Chen, X., H. Hong, and D. Nekipelov (2011), “Nonlinear Models of Measurement
Error,” Journal of Economic Literature, 49(4), 901–937.
Chernozhukov, V., and H. Hong (2003), “An MCMC Approach to Classical Estimation,”
Journal of Econometrics, 115, 293–346.

516

References

Cherubini, U., E. Luciano, and W. Vecchiato (2004), Copula Methods in Finance, New
York, John Wiley Sons.
Chesher, A.D. (1984), “Testing for Neglected Heterogeneity,” Econometrica, 52, 865–
872.
Chesher, A.D. (1991), “The Effect of Measurement Error,” Biometrika, 78, 451–462.
Chesher, A.D. (2005), “Nonparametric Identification under Discrete Variation,” Econometrica, 73, 1525–1550.
Chesher, A.D. (2010), “Instrumental Variable Models for Discrete Outcomes,” Econometrica, 78, 575–602.
Chesher, A.D., and M. Irish (1987), “Residual Analysis in the Grouped and Censored
Normal Linear Model,” Journal of Econometrics, 34, 33–62.
Chib, S. (2001), “Markov Chain Monte Carlo Methods: Computation and Inference,” in
J.J. Heckman and E. Leamer, eds., Handbook of Econometrics, volume 5, 3569–3649,
Amsterdam, North-Holland.
Chib, S., E. Greenberg, and R. Winkelmann (1998), “Posterior Simulation and Bayes
Factors in Panel Count Data Models,” Journal of Econometrics, 86, 33–54.
Chib, S., and R. Winkelmann (2001), “Markov Chain Monte Carlo Analysis of Correlated Count Data,” Journal of Business and Economic Statistics, 19, 428–435.
Chiou, J.-M., and H.-G. Muller (1998), “Quasi-Likelihood Regression with Unknown
Link and Variance Functions,” Journal of the American Statistical Association, 93,
1376–1387.
Chiou, J.-M., and H.-G. Muller (2005), “Estimated Estimating Equations: Semiparametric Inference for Clustered and Longitudinal Data,” Journal of the Royal Statistical
Society B, 67, 531–553.
Christmann, A. (1994), “Least Median of Weighted Squares in Logistic Regression with
Large Strata,” Biometrika, 81, 413–417.
Christmann, A. (1996), “On Outliers and Robust Estimation in Regression Models with
Discrete Response Variables,” paper presented at Workshop on Statistical Modelling
of Discrete Data and Structures, Sonderforschungbereich 386, October 1996.
Cincera, M. (1997), “Patents, R&D and Technological Spillovers at the Firm Level:
Some Evidence from Econometric Count Models for Panel Data,” Journal of Applied
Econometrics, 12, 265–280.
Cochran, W.G. (1940), “The Analysis of Variance When Experimental Errors Follow
the Poisson or Binomial Law,” Annals of Mathematical Statistics, 11, 335–347.
Cohen, A.C. (1960), “Estimation in a Truncated Poisson Distribution When Zeros
and Ones Are Missing,” Journal of the American Statistical Association, 55, 342–
348.
Collings, B.J., and B.H. Margolin (1985), “Testing Goodness of Fit for the Poisson
Assumption When Observations Are Not Identically Distributed,” Journal of the
American Statistical Association, 80, 411–418.
Conley, T.G. (1999), “GMM Estimation with Cross Sectional Dependence,” Journal of
Econometrics, 92, 1–45.
Conniffe, D.C. (1990), “Testing Hypotheses with Estimated Scores,” Biometrika, 77,
97–106.
Consul, P.C. (1989), Generalized Poisson Distributions: Properties and Applications,
New York, Marcel Dekker.
Consul, P.C., and G.C. Jain (1973), “A Generalization of the Poisson Distribution,”
Technometrics, 15, 791–799.

References

517

Consul, P.C., and L.R. Shenton (1972), “Use of Lagrange Expansion for Generating Discrete Generalized Probability Distributions,” SIAM Journal of Applied Mathematics,
23, 239–248.
Cont, R. (2001), “Empirical Properties of Asset Returns: Stylized Facts and Statistical
Issues,” Quantitative Finance, 1, 223–236.
Cook, J.R., and L.A. Stefanski (1994), “Simulation-Extrapolation Estimation in Parametric Measurement Error Models,” Journal of the American Statistical Association,
89, 1314–1328.
Cowling, B.J., J.L. Hutton, and J.E.H. Shaw (2006), “Joint Modelling of Event Counts
and Survival Times,” Journal of the Royal Statistical Society C, 55, 31–39
Cox, D.R. (1955), “Some Statistical Models Related with Series of Events,” Journal of
the Royal Statistical Society B, 17, 129–64.
Cox, D.R. (1961), “Tests of Separate Families of Hypotheses,” Proceedings of the Fourth
Berkeley Symposium on Mathematical Statistics and Probability, 1, 105–123.
Cox, D.R. (1962a), “Further Results on Tests of Separate Families of Hypotheses,”
Journal of the Royal Statistical Society B, 24, 406–424.
Cox, D.R. (1962b), Renewal Theory, London, Methuen & Co.
Cox, D.R. (1981), “Statistical Analysis of Time Series: Some Recent Developments,”
Scandinavian Journal of Statistics, 8, 93–115.
Cox, D.R. (1983), “Some Remarks on Overdispersion,” Biometrika, 70, 269–274.
Cox, D.R., and P.A.W. Lewis (1966), The Statistical Analysis of Series of Events,
London, Methuen & Co.
Cox, D.R., and E.J. Snell (1968), “A General Definition of Residuals (with discussion),”
Journal of the Royal Statistical Society B, 30, 248–275.
Cragg, J.C. (1971), “Some Statistical Models for Limited Dependent Variables with
Application to the Demand for Durable Goods,” Econometrica, 39, 829–844.
Cragg, J.C. (1997), “Using Higher Moments to Estimate the Simple Errors-in-Variables
Model,” Rand Journal of Economics, 28, S71–S91.
Cramer, H. (1946), Mathematical Methods of Statistics, Princeton, NJ, Princeton University Press.
Creel, M.D., and J.B. Loomis (1990), “Theoretical and Empirical Advantages of Truncated Count Data Estimators for Analysis of Deer Hunting in California,” Journal of
Agricultural Economics, 72, 434–441.
Crepon, B., and E. Duguet (1997a), “Estimating the Innovation function from Patent
Numbers: GMM on Count Data,” Journal of Applied Econometrics, 12, 243–264.
Crepon, B., and E. Duguet (1997b), “Research and Development, Competition and Innovation: Pseudo-Maximum Likelihood and Simulated Maximum Likelihood Method
Applied to Count Data Models with Heterogeneity,” Journal of Econometrics, 79,
355–378.
Crowder, M.J. (1976),“Maximum Likelihood Estimation for Dependent Observations,”
Journal of the Royal Statistical Society B, 38, 45–53.
Crowder, M.J. (1987), “On Linear and Quadratic Estimating Functions,” Biometrika,
74, 591–597.
Daley, D.J., and D. Vere-Jones (1988), An Introduction to the Theory of Point Processes,
New York, Springer-Verlag.
Danaher, P.J. (2007), “Modeling Page Views across Multiple Websites with an Application to Internet Reach and Frequency Prediction,” Marketing Science, 26, 422–
437.

518

References

Davidson, R., and J.G. MacKinnon (1984), “Several Tests for Model Specification in
the Presence of Alternative Hypotheses,” Econometrica, 49, 781–793.
Davidson, R., and J.G. MacKinnon (1993, 2004), Estimation and Inference in Econometrics, Oxford, Oxford University Press.
Davis, R.A., W.T.M. Dunsmuir, and S.B. Streett (2003), “Observation-Driven Models
for Poisson Counts,” Biometrika, 90, 777–790.
Davis, R.A., W.T.M. Dunsmuir, and Y. Wang (1999), “Modelling Time Series of Count
Data,” in S. Ghosh, ed., Asymptotics, Nonparametrics, and Time Series, 63–114. New
York, Marcel Dekker.
Davis, R.A., and R. Wu (2009), “A Negative Binomial Model for Time Series of Counts,”
Biometrika, 96, 735–749.
Davison, A.C., and A. Gigli (1989), “Deviance Residuals and Normal Scores Plots,”
Biometrika, 76, 211–221.
Davison, A.C., and E.J. Snell (1991), “Residuals and Diagnostics,” in D.V. Hinkley, N.
Reid, and E.J. Snell, eds., Statistical Theory and Modelling: In Honor of Sir David
Cox, FRS, 83–106, London, Chapman and Hall.
Davutyan, N. (1989), “Bank Failures as Poisson Variates,” Economic Letters, 29, 333–
338.
Dean, C. (1991), “Estimating Equations for Mixed Poisson Models,” in V. P. Godambe,
ed., Estimating Functions, Oxford, Oxford University Press.
Dean, C. (1992), “Testing for Overdispersion in Poisson and Binomial Regression
Models,” Journal of the American Statistical Association, 87, 451–457.
Dean, C.B. (1993), “A Robust Property of Pseudo Likelihood Estimation for Count
Data,” Journal of Statistical Planning and Inference, 35, 309.
Dean, C.B. (1994), “Modified Pseudo-Likelihood Estimator of the Overdispersion
Parameter in Poisson Mixture Models,” Journal of Applied Statistics, 1994, 21,
523.
Dean, C.B., and R. Balshaw (1997), “Efficiency Lost by Analyzing Counts Rather than
Event Times in Poisson and Overdispersed Poisson Regression Models,” Journal of
the American Statistical Society, 92, 1387–1398
Dean, C.B., D.M. Eaves, and C.J. Martinez (1995), “A Comment on the Use of Empirical
Covariance Matrices in the Analysis of Count Data,” Journal of Statistical Planning
and Inference, 48, 197–206.
Dean, C., and F. Lawless (1989a), “Tests for Detecting Overdispersion in Poisson
Regression Models,” Journal of the American Statistical Association, 84, 467–472.
Dean, C., and J.F. Lawless (1989b), “Comment on Godambe and Thompson (1989),”
Journal of Statistical Planning and Inference, 22, 155–158.
Dean, C., J.F. Lawless, and G.E. Willmot (1989), “A Mixed Poisson-Inverse Gaussian
Regression Model,” Canadian Journal of Statistics, 17, 171–182.
Deb, P., M.K. Munkin, and P.K. Trivedi (2006), “Private Insurance, Selection, and
Health Care Use: A Bayesian Analysis of a Roy-Type Model,” Journal of Business
and Economic Statistics, 24, 403–415.
Deb, P., and P.K. Trivedi (1997), “Demand for Medical Care by the Elderly: A Finite
Mixture Approach,” Journal of Applied Econometrics, 12, 313–326.
Deb, P., and P.K. Trivedi (2002), “The Structure of Demand for Health Care: Latent
Class versus Two-part Models,” Journal of Health Economics, 21, 601–625.
Deb, P., and P.K. Trivedi. (2006a), “Specification and Simulated Likelihood Estimation
of a Non-Normal Treatment-Outcome Model with Selection: Application to Health
Care Utilization,” Econometrics Journal, 9, 307–331.

References

519

Deb, P., and P.K. Trivedi (2006b), “Maximum Simulated Likelihood Estimation of
a Negative-Binomial Regression Model with Multinomial Endogenous Treatment,”
Stata Journal, 6, 246–255.
Deb, P., and P.K. Trivedi (2013), “Finite Mixture for Panels with Fixed Effects,” Forthcoming Journal of Econometric Methods, UK.
Deb, P., P.K. Trivedi, and D.M. Zimmer (2011), “Cost-Offsets of Prescription Drug
Expenditures: Data Analysis via a Copula-based Bivariate Dynamic Hurdle Model,”
manuscript, Indiana University.
Delgado, M.A. (1992), “Semiparametric Generalized Least Squares in the Multivariate
Nonlinear Regression Model,” Econometric Theory, 8, 203–222.
Delgado, M.A., and T.J. Kniesner (1997), “Count Data Models with Variance of
Unknown Form: An Application to a Hedonic Model of Worker Absenteeism,” Review
of Economics and Statistics, 79, 41–49.
Demidenko, E. (2007), “Poisson Regression for Clustered Data,” International Statistical Review, 75, 96–113.
Denuit, M., and P. Lambert (2005), “Constraints on Concordance Measures in Bivariate
Discrete Data,” Journal of Multivariate Analysis, 93, 40–57.
Diggle, P.J., P. Heagerty, K.-Y. Liang, and S.L. Zeger (2002), Analysis of Longitudinal
Data, edition 2, Oxford, Oxford University Press.
Dionne, G., D. Desjardins, C. Labergue-Nadeau, and U. Maag (1995), “Medical Conditions, Risk Exposure, and Truck Drivers’ Accidents: An Analysis with Count Data
Regression Models,” Accident Analysis and Prevention, 27, 295–305.
Dionne, G., and C. Vanasse (1992), “Automobile Insurance Rate Making in the Presence
of Asymmetrical Information,” Journal of Applied Econometrics, 7, 149–165.
Dobbie, M.J., and A.H. Welsh (2001), “Models for Zero-inflated Count Data Using the
Neyman Type A Distribution,” Statistical Modelling, 1, 65–80.
Driscoll, J.C., and A.C. Kraay (1998), “Covariance Matrix Estimation with Spatially
Dependent Data,” Review of Economics and Statistics, 80, 549–560.
Drost, F.C., R. Van Den Akker, and B.J.M. Werker (2008), “Local Asymptotic Normality
and Efficient Estimation for INAR(p) models,” Journal of Time Series Analysis, 29,
783–801.
Drost, F.C., R. Van Den Akker, and B.J.M. Werker (2009a), “Efficient Estimation
of Autoregression Parameters and Innovation Distributions for Semiparametric
Integer-Valued AR(p) Models,” Journal of the Royal Statistical Society B, 71, 467–
485.
Drost, F.C., R. Van Den Akker, and B.J.M. Werker (2009b), “The Asymptotic Structure
of Nearly Unstable Non-Negative Integer-Valued AR(1) Models,” Bernoulli, 15, 297–
324.
Du, J.-G., and Y. Li (1991), “The Integer Valued Autoregressive (INAR(p)) Model,”
Journal of Time Series Analysis, 12, 129–142.
Duan, N. (1983), “Smearing Estimate: A Nonparametric Retransformation Method,”
Journal of the American Statistical Association, 78, 605–610.
Duarte, R. and J.J. Escario (2006), “Alcohol Abuse and Truancy among Spanish
Adolescents: A Count-Data Approach,” Economics of Education Review, 25, 179–
187.
Durbin, J. (1954), “Errors in Variables,” Review of the International Statistical Institute,
22, 23–32.
Durbin, J., and S.J. Koopman (1997), “Monte Carlo Maximum Likelihood Estimation
for Non-Gaussian State Space Models,” Biometrika, 84, 669–684.

520

References

Durbin, J., and S.J. Koopman (2000), “Time Series Analysis of Non-Gaussian Observations Based on State Space Models from Both Classical and Bayesian Perspectives,”
Journal of the Royal Statistical Society B, 62, 3–56.
Eagleson, G.K. (1964), “Polynomial Expansions of Bivariate Distributions,” Annals of
Mathematical Statistics, 35, 1208–1215.
Eagleson, G.K. (1969), “A Characterization Theorem for Positive Definite Sequences
on the Krawtchouk Polynomials,” Australian Journal of Statistics, 11, 29–38.
Econometric Software Inc. (1991), LIMDEP User’s Manual and Reference Guide:
Version 6.0, New York.
Efron, B. (1979), “Bootstrapping Methods: Another Look at the Jackknife,” Annals of
Statistics, 7, 1–26.
Efron, B. (1986), “Double Exponential Families and Their Use in Generalized Linear
Regressions,” Journal of the American Statistical Association, 81, 709–721.
Efron, B., and R.J. Tibshirani (1993), An Introduction to the Bootstrap, London, Chapman and Hall.
Eggenberger, F., and G. Polya (1923), “Über die Statistik verketteter Vorgänge,”
Zeitschrift für Angerwandte Mathematik and Mechanik, 1, 279–289.
Eicker, F. (1967), “Limit Theorems for Regressions with Unequal and Dependent
Errors,” in L. LeCam and J. Neyman eds., Proceedings of the Fifth Berkeley Symposium on Mathematical Statistics and Probability, 59–82, Berkeley, University of
California Press.
Embrechts, P., McNeil, A., and D. Straumann (2002), “Correlation and Dependence
in Risk Management: Properties and Pitfalls,” in M.A.H. Dempster, ed., Risk Management: Value at Risk and Beyond, 176–223, Cambridge, Cambridge University
Press.
Enciso-Mora, V., P. Neal, and T.S. Rao (2008a), “Efficient Order Selection Algorithms
for Integer-Valued ARMA Processes,” Journal of Time Series Analysis, 30, 1–18.
Enciso-Mora, V., P. Neal, and T.S. Rao (2008b), “Integer Valued AR Processes with
Explanatory Variables,” Research Report No. 20, School of Mathematics, University
of Manchester.
Engle, R.F., and J.R. Russell (1998), “Autoregressive Conditional Duration: A New
Model for Irregularly Spaced Transaction Data,” Econometrica, 66(5), 1127–1162.
Englin, J., and J.S. Shonkwiler (1995), “Estimating Social Welfare Using Count Data
Models: An Application to Long-Run Recreation Demand under Conditions of
Endogenous Stratification and Truncation,” Review of Economics and Statistics, 77,
104–112.
Everitt, B.S., and D.J. Hand (1981), Finite Mixture Distributions, London, Chapman
and Hall.
Fabbri, D., and C. Monfardini (2011), “Opt Out or Top Up? Voluntary Healthcare
Insurance and the Public versus Private Substitution,” IZA Working Paper DP-5952.
Fahrmeier, L., and H. Kaufman (1987), “Regression Models for Non-Stationary Categorical Time Series,” Journal of Time Series Analysis, 8, 147–160.
Fahrmeier, L., and G.T. Tutz (1994) Multivariate Statistical Modeling Based on Generalized Linear Models, New York, Springer-Verlag.
Famoye, F. (2010), “On the Bivariate Negative Binomial Regression Model,” Journal
of Applied Statistics, 37, 969–981.
Fan, J. (1992), “Design-Adaptive Nonparametric Regression,” Journal of the American
Statistical Association, 87, 998–1004.

References

521

Fang, K.-T., and Y.-T. Zhang (1990), Generalized Multivariate Analysis, Berlin,
Springer-Verlag.
Feinstein, J.S. (1989), “The Safety Regulation of U.S. Nuclear Power Plants: Violations,
Inspections, and Abnormal Occurrences,” Journal of Political Economy, 97, 115–
154.
Feinstein, J.S. (1990), “Detection Controlled Estimation,” Journal of Law and Economics, 33, 233–276.
Feller, W. (1943), “On a General Class of ‘Contagious’ Distributions,” Annals of Mathematical Statistics, 14, 389–400.
Feller, W. (1968), An Introduction to Probability Theory and Its Applications, volume
1, edition 3, New York, John Wiley Sons.
Feller, W. (1971), An Introduction to Probability Theory, volume 2, New York, John
Wiley Sons.
Fé., E. (2012), “Estimating Production Frontiers and Efficiency When Output is a Discretely Distributed Economic Bad,” Journal of Productivity Analysis, forthcoming.
Feng, Z.D., and C.E. McCulloch (1996), “Using Bootstrap Likelihood Ratios in Finite
Mixture Models,” Journal of the Royal Statistical Society B, 609–617.
Ferguson, T.S. (1973), “A Bayesian Analysis of Some Nonparametric Problems,” The
Annals of Statistics, 1(2), 209–230.
Fienberg, S.E. (1981), “Deciding What and Whom to Count,” in R.G. Lehnan and
W.G. Skogan, eds., The NCS Working Papers, volume 1, 59–60, Washington, DC,
U.S. Department of Justice.
Firth, D. (1987), “On the Efficiency of Quasi-likelihood Estimation,” Biometrika, 74,
223–245.
Firth, D. (1991), “Generalized Linear Models,” in D.V. Hinkley, N. Reid, and E.J. Snell,
eds., Statistical Theory and Modelling: In Honor of Sir David Cox, FRS, 55–82,
London, Chapman and Hall.
Fleming, T.R., and D.P. Harrington (2005), Counting Process and Survival Analysis,
New York, John Wiley Sons.
Fokianos, F., A. Rahbek, and D. Tjøstheim (2009), “Poisson Autoregression,” Journal
of the American Statistical Association, 104, 1430–1439.
Freeland, R.K., and B.P.M. McCabe (2004), “Forecasting Discrete Valued Low Count
Time Series,” International Journal of Forecasting, 20, 427–434.
Frühwirth-Schnatter, S. (2001), “Markov Chain Monte Carlo Estimation of Classical
and Dynamic Switching and Mixture Models,” Journal of the American Statistical
Association, 96, 194–209.
Frühwirth-Schnatter, S. (2006), Finite Mixture and Markov Switching Models, New
York, Springer-Verlag
Frühwirth-Schnatter, S., and H. Wagner (2006), “Auxiliary Mixture Sampling for
Parameter-Driven Models of Time Series of Counts with Applications to State Space
Modelling,” Biometrika, 93, 827–841.
Gallant, A.R., and D.W. Nychka (1987), “Seminonparametric Maximum Likelihood
Estimation,” Econometrica, 55, 363–390.
Gallant, A.R., and G. Tauchen (1989), “Seminonparametric Estimation of Conditionally
Constrained Heterogeneous Processes: Asset Pricing Applications,” Econometrica,
57, 1091–1120.
Gan, L., and J. Jiang (1999), “A Test of Global Maximum,” Journal of American
Statistical Association, 94, 847–854.

522

References

Gauthier, G., and A. Latour (1994), “Convergence forte des estimateurs des paramètres
d’un processus GENAR(p),” À paraı̂tre dans Ann. Sc. Math. Quèbec (with extended
English abstract).
Geil, P., A. Melion, R. Rotte, and K.F. Zimmermann (1997), “Economic Incentives and
Hospitalization,” Journal of Applied Econometrics, 12, 295–311.
Gelfand, A.E., and S.R. Dalal (1990), “A Note on Overdispersed Exponential Families,”
Biometrika, 77, 55–64.
Gelfand, A.E., and A.F.M. Smith (1990), “Sampling-Based Approaches to Calculating
Marginal Densities,” Journal of the American Statistical Association, 85, 398–409.
Gelman, A., J.B. Carlin, H.S. Stern, and D.B. Rubin (2003), Bayesian Data Analysis,
edition 2, Boca Raton, FL, Chapman and Hall/CRC Press.
Genest, C., and J. Neslehova, (2008), “A Primer on Copulas for Count Data,” ASTIN
Bulletin, 37, 475–515.
Geweke, J. (2003), Contemporary Bayesian Econometrics and Statistics, New York,
John Wiley Sons.
Geweke, J., and M. Keane (2001), “Computationally Intensive Methods for Integration
in Econometrics,” in J.J. Heckman and E. Leamer, eds., Handbook of Econometrics,
volume 5, 3463–3568, Amsterdam, North-Holland.
Gleser, L.J. (1990), “Improvements of the Naive Approach to Estimation in Non-linear
Errors-in-Variables Regression Models,” in P.J. Brown and W.A. Fuller, eds., Statistical Analysis of Measurement Error Models and Application, 99–114. Providence,
RI, American Mathematics Society.
Godambe, V.P., and M.E. Thompson (1989), “An Extension of Quasi-Likelihood Estimation,” Journal of Statistical Planning and Inference, 22, 137–152.
Godfrey, L.G. (1988), Misspecification Tests in Econometrics: The Lagrange Multiplier
Principle and Other Approaches, Cambridge, Cambridge University Press.
Goffe, W.L., G.D. Ferrier, and J. Rogers (1994), “Global Optimization of Statistical
Functions with Simulated Annealing,” Journal of Econometrics, 60, 65–99.
Goldstein, H. (2010), Multilevel Statistical Models, edition 4, Chichester, Wiley.
Good, D., and M.A. Pirog-Good (1989), “Models for Bivariate Count Data with
an Application to Teenage Delinquency and Paternity,” Sociological Methods and
Research, 17, 409–431.
Gourieroux, C., and A. Monfort (1991), “Simulation Based Inference in Models with
Heterogeneity,” Annales D’Economie Et De Statistique, 20–21, 70–107.
Gourieroux, C., and A. Monfort (1995), Statistics and Econometrics Models, volumes 1
and 2, translated by Q. Vuong, Cambridge, Cambridge University Press. (Originally
published as Statistique et modèles économetriques, 1989).
Gourieroux, C., and A. Monfort (1997), Simulation Based Econometric Methods,
Oxford, Oxford University Press.
Gourieroux, C., A. Monfort, E. Renault, and A. Trognon (1987a), “Generalized Residuals,” Journal of Econometrics, 34, 5–32.
Gourieroux, C., A. Monfort, E. Renault, and A. Trognon (1987b), “Simulated Residuals,” Journal of Econometrics, 34, 201–252.
Gourieroux, C., A. Monfort, and A. Trognon (1984a), “Pseudo Maximum Likelihood
Methods: Theory,” Econometrica, 52, 681–700.
Gourieroux, C., A. Monfort, and A. Trognon (1984b), “Pseudo Maximum Likelihood
Methods: Applications to Poisson Models,” Econometrica, 52, 701–720.
Gourieroux, C., and M. Visser (1993), “A Count Data Model with Unobserved Heterogeneity,” Journal of Econometrics, 79, 247–268.

References

523

Greene, W.H. (1994), “Accounting for Excess of Zeros and Sample Selection in Poisson
and Negative Binomial Regression Models,” Discussion Paper EC-94-10, Department
of Economics, New York University.
Greene, W.H. (1997), “FIML Estimation of Sample Selection Models for Count Data,”
Discussion Paper EC-97-02, Department of Economics, Stern School of Business,
New York University.
Greene, W. (2004), “The Behaviour of the Maximum Likelihood Estimator of Limited
Dependent Variable Models in the Presence of Fixed Effects,” Econometrics Journal,
7, 98–119.
Greene, W.H. (2007), “Functional Form and Heterogeneity in Models for Count Data,”
Foundations and Trends in Econometrics, 1, 113–218.
Greene, W.H. (2009), “Models for Count Data with Endogenous Participation,” Empirical Economics, 36,133–173.
Greene, W.H. (2011), Econometric Analysis, edition 7, Upper Saddle River, NJ, Prentice
Hall.
Greenwood, M., and G.U. Yule (1920), “An Inquiry into the Nature of Frequency
Distributions of Multiple Happenings, with Particular Reference to the Occurrence
of Multiple Attacks of Disease or Repeated Accidents,” Journal of Royal Statistical
Society A, 83, 255–279.
Griffith, D.A., and R. Haining (2006), “Beyond Mule Kicks: The Poisson Distribution
in Geographical Analysis,” Geographical Analysis, 38, 123–139.
Grogger, J. (1990), “The Deterrent Effect of Capital Punishment: An Analysis of Daily
Homicide Counts,” Journal of the American Statistical Association, 85, 295–303.
Grogger, J.T., and R.T. Carson (1991), “Models for Truncated Counts,” Journal of
Applied Econometrics, 6, 225–238.
Guimarães, P. (2008), “The Fixed Effects Negative Binomial Model Revisited,” Economics Letters, 99, 63–66.
Guo, J., and T. Li (2001), “Simulation-Based Estimation of the Structural Errors-inVariables Negative Binomial Regression Model with an Application,” Annals of
Economics and Finance, 2, 101–122.
Guo, J.Q., and T. Li (2002), “Poisson Regression Models with Errors-in-Variables,”
Journal of Statistical Planning and Inference, 104, 391–401.
Guo, J.Q., and P.K. Trivedi (2002) “Flexible Parametric Models for Long-Tailed Patent
Count Distributions,” Oxford Bulletin of Economics and Statistics, 64, 63–82.
Gupta, C.R. (1974), “Modified Power Series Distribution and Some of Its Applications,”
Sankhya, Series B, 36, 288–298.
Gurmu, S. (1991), “Tests for Detecting Overdispersion in the Positive Poisson Regression Model,” Journal of Business and Economic Statistics, 9, 215–222.
Gurmu, S. (1993), “Testing for Overdispersion in Censored Poisson Regression
Models,” Discussion Paper 255, Jefferson Center for Political Economy, University
of Virginia.
Gurmu, S. (1997), “Semiparametric Estimation of Hurdle Regression Models With an
Application to Medicaid Utilization,” Journal of Applied Econometrics, 12, 225–242.
Gurmu, S., and J. Elder (2000), “Generalized Bivariate Count Data Regression Models,”
Economics Letters, 68, 31–36.
Gurmu, S., P. Rilstone, and S. Stern (1995), “Nonparametric Hazard Rate Estimation,
Discussion Paper,” University of Virginia.
Gurmu, S., P. Rilstone, and S. Stern (1999), “Semiparametric Estimation of Count
Regression Models,” Journal of Econometrics, 88, 123–150.

524

References

Gurmu, S., and P.K. Trivedi (1992), “Overdispersion Tests for Truncated Poisson Regression Models,” Journal of Econometrics, 54, 347–370.
Gurmu, S., and P.K. Trivedi (1993), “Variable Augmentation Specification Tests in the
Exponential Family,” Econometric Theory, 9, 94–113.
Gurmu, S., and P.K. Trivedi (1994), “Recent Developments in Models of Event Counts:
A Survey,” Discussion Paper No. 261, Thomas Jefferson Center, University of
Virginia, Charlottesville.
Gurmu, S., and P.K. Trivedi (1996), “Excess Zeros in Count Models for Recreational
Trips,” Journal of Business and Economic Statistics, 14, 469–477.
Haab, T.C., and K.E. McConnell (1996), “Count Data Models and the Problem of Zeros
in Reaction Demand Analysis,” American Journal of Agricultural Economics, 78,
89–98.
Haight, F.A. (1967), Handbook of the Poisson Distribution, New York, John Wiley &
Sons.
Hall, A. (1987), “The Information Matrix Test in the Linear Model,” Review of Economic
Studies, 54, 257–265.
Hall, B.H., Z. Griliches, and J.A. Hausman (1986), “Patents and R and D: Is There a
Lag?,” International Economic Review, 27, 265–283.
Hall, P., J. Racine, Q. Li (2004), “Cross-Validation and the Estimation of Conditional
Density Functions,” Journal of the American Statistical Association, 99, 1015–1026.
Hamdan, M.A. (1972), “Estimation in the Truncated Bivariate Poisson Distribution,”
Technometrics, 14, 37–45.
Hamilton, J.D. (1989), “A New Approach to the Economic Analysis of Nonstationary
Time Series and the Business Cycle,” Econometrica, 57, 357–384.
Hamilton, J.D. (1994), Time Series Analysis, Princeton, Princeton University Press.
Hannan, M.T., and J. Freeman (1987), “The Ecology of Organizational Founding:
American Labor Unions, 1836–1985,” American Journal of Sociology, 92, 910–
943.
Hansen, L.P. (1982), “Large Sample Properties of Generalized Method of Moments
Estimators,” Econometrica, 50, 129–1054.
Hansen, L.P., J. Heaton, and A. Yaron (1996), “Finite Sample Properties of Some
Alternative GMM Estimators,” Journal of Business and Economic Statistics, 14(3),
262–280.
Hardin, J.W., H. Schmiediche, and R.J. Carroll (2003a), “The Regression-Calibration
Method for Fitting Generalized Linear Models with Additive Measurement Error,”
Stata Journal, 3, 361–372.
Hardin, J.W., H. Schmiediche, and R.J. Carroll (2003b), “The Simulation Extrapolation
Method for Fitting Generalized Linear Models with Additive Measurement Error,”
Stata Journal, 3, 373–385.
Härdle, W. (1990), Applied Nonparametric Methods, Cambridge, Cambridge University
Press.
Härdle, W., and O. Linton, (1994), “Applied Nonparametric Methods,” in R.F. Engle
and D. McFadden, eds., Handbook of Econometrics, volume 4, Amsterdam, NorthHolland.
Härdle, W., and T.M. Stoker (1989), “Investigating Smooth Multiple Regression by the
Method of Average Derivatives,” Journal of the American Statistical Association, 84,
986–995.
Harvey, A.C. (1989), Forecasting, Structural Time Series Models and the Kalman Filter,
Cambridge, Cambridge University Press.

References

525

Harvey, A.C., and C. Fernandes (1989), “Time Series Models for Count or Qualitative
Observations (with Discussion),” Journal of Business and Economic Statistics, 7,
407–417.
Harvey, A.C., and G.D.A. Phillips (1982), “The Estimation of Regression Models with
Time-Varying Parameters,” in M. Deistler, E. Furst, and G. Schwodiauer, eds., Games,
Economic Dynamics,and Time-Series Analysis, Vienna, Physica-Verlag, 306–321.
Harvey, A.C., and N. Shephard (1993), “Stuctural Time Series Models,” in G.S. Maddala,
C.R. Rao, and H.D. Vinod, eds., Handbook of Statistics, Volume 11: Econometrics,
Amsterdam, North-Holland.
Hastie, T.J., and R.J. Tibshirani (1990), Generalized Additive Models, New York, Chapman and Hall.
Hausman, J.A. (1978), “Specification Tests in Econometrics,” Econometrica, 46, 1251–
1271.
Hausman, J.A., J. Abrevaya, and F.M. Scott-Morton (1998), “Misclassification of the
Dependent Variable in a Discrete-Response Setting,” Journal of Econometrics, 87,
239–269.
Hausman, J.A., B.H. Hall, and Z. Griliches (1984), “Econometric Models for Count
Data with an Application to the Patents–R and D Relationship,” Econometrica, 52,
909–938.
Hausman, J.A., G.K. Leonard, and D. McFadden (1995), “A Utility-Consistent, Combined Discrete Choice and Count Data Model: Assessing Recreational Use Losses
due to Natural Resource Damage,” Journal of Public Economics, 56, 1–30.
Hausman, J.A., A.W. Lo, and A.C. MacKinlay (1992), “An Ordered Probit Analysis of
Transaction Stock Prices,” Journal of Financial Economics, 31, 319–379.
Hausman, J.A., W.K. Newey, and J.L. Powell (1995), “Nonlinear Errors in Variables:
Estimation of Some Engel Curves,” Journal of Ecoometrics, 65, 205–233.
Hayashi, F. (2000), Econometrics, Princeton, NJ, Princeton University Press.
Hayfield, T., and J. Racine (2008), “Nonparametric Econometrics: The np Package,”
Journal of Statistical Software, 27(5), 1–32.
Heckman, J.J. (1976), “The Common Structure of Statistical Models of Truncation,
Sample Selection, and Limited Dependent Variables and a Simple Estimator for Such
Models,” Annals of Economics and Social Measurement, 5, 475–492.
Heckman, J.J. (1978), “Dummy Endogenous Variables in a Simultaneous Equations
System,” Econometrica, 46, 931–960.
Heckman, J.J. (1981), “The Incidental Parameters Problem and the Problem of Initial
Conditions in Estimating a Discrete Time-Discrete Data Stochastic Process,” in C.
Manski and D. McFadden, eds., Structural Analysis of Discrete Data with Econometric Applications, 179–197, Cambridge, MIT Press.
Heckman, J.J. (1984), “The χ 2 Goodness of Fit test for Models with Parameters Estimated from Micro Data,” Econometrica, 52, 1543–1547.
Heckman, J.J., and R. Robb (1985), “Alternative Methods for Evaluating the Impact of
Interventions,” in J.J. Heckman and B. Singer, eds., Longitudinal Analysis of Labor
Market Data, 156–245, New York, Cambridge University Press.
Heckman, J., and B. Singer (1984), “A Method of Minimizing the Impact of Distributional Assumptions in Econometric Models for Duration Data,” Econometrica, 52,
271–320.
Hellstrom, J. (2006), “A Bivariate Count Data Model for Household Tourism Demand,”
Journal of Applied Econometrics, 21, 213–226.
Hendry, D.F. (1995), Dynamic Econometrics, Oxford, Oxford University Press.

526

References

Hill, S., Rothchild, D., and A.C. Cameron, (1998), “Tactical Information and the Diffusion of Protests,” in D.A. Lake and D. Rothchild, eds., Ethnic Fears and Global
Engagement: The International Spread and Management of Ethnic Conflict, 61–88,
Princeton, NJ, Princeton University Press.
Hinde, J. (1982), “Compound Poisson Regression Models,” in R. Gilchrist, ed., GLIM
82: Proceedings of the International Conference on Generalised Linear Models,
109–121, New York, Springer-Verlag.
Holgate, P. (1970), “The Modality of Some Compound Poisson Distributions,”
Biometrika, 57, 666–667.
Holly, A. (1982), “A Remark on Hausman’s Specification Test,” Econometrica, 49,
749–759.
Holly, A. (1987), “Specification Tests: An Overview,” in T.F. Bewley ed., Advances
in Economics and Econometrics: Theory and Applications, volume 1, Fifth World
Congress, 59–97, Cambridge, Cambridge University Press.
Honda, Y. (1988), “A Size Correction to the Lagrange Multiplier Test for Heteroskedasticity,” Journal of Econometrics, 38, 375–386.
Hong, H., and E. Tamer (2003), “A Simple Estimator for Nonlinear Error in Variable
Models,” Journal of Econometrics, 117, 1–19.
Horowitz, J.L. (1997), “Bootstrap Methods in Econometrics: Theory and Numerical
Performance,” in D. M. Kreps and K. F. Wallis, eds., Advances in Economics and
Econometrics: Theory and Applications, volume 3, Seventh World Congress, Tokyo.
Cambridge, Cambridge University Press.
Horowitz, J.L. (2001), “The Bootstrap,” Handbook of Econometrics, Volume 5, 3160–
3228, Editors J.J. Heckman and E. Leamer, Amsterdam: Elsevier.
Hsiao, C. (1989), “Consistent Estimation for Some Nonlinear Errors-in-Variables Models,” Journal of Econometrics, 41, 159–185.
Hsiao, C. (2003), Analysis of Panel Data, edition 2, Cambridge, Cambridge University
Press.
Huber, P.J. (1967), “The Behavior of Maximum Likelihood Estimates under Nonstandard Conditions,” in L. LeCam and J. Neyman, eds., Proceedings of the Fifth Berkeley
Symposium on Mathematical Statistics and Probability, 221–234, Berkeley, University of California Press.
Hyppolite, J., and P.K. Trivedi (2012), “Alternative Approaches for Econometric Analysis of Panel Count Data Using Dynamic Latent Class Models (with Application to
Doctor Visits Data),” Health Economics, 21, Supplement 1, 101–128.
Ichimura, H. (1993), “Semiparametric Least Squares (SLS) and Weighted SLS Estimation of Single-Index Models,” Journal of Econometrics, 58, 71–120.
Ichimura, H., and P. Todd (2007), “Implementing Nonparametric and Semiparametric
Estimators,” Handbook of Econometrics volume 6, Part B, 5364–5468. Amsterdam,
North-Holland.
Imbens, G.W. (2002), “Generalized Method of Moments and Empirical Likelihood,”
Journal of Business and Economic Statistics, 20, 493–506.
Imbens, G.W., and T. Lancaster (1994), “Combining Micro and Macro Data in Microeconometric Models,” Review of Economic Studies, 61, 655–680.
Jacobs, P.A., and P.A.W. Lewis (1977), “A Mixed Autoregressive Moving Average
Exponential Sequence and Point Process,” Advances in Applied Probability, 9, 87–
104.
Jacobs, P.A., and P.A.W. Lewis (1978a), “Discrete Time Series Generated by Mixtures
I: Correlational and Runs Properties,” Journal of the Royal Statistical Society B , 40,
94–105.

References

527

Jacobs, P.A., and P.A.W. Lewis (1978b), “Discrete Time Series Generated by Mixtures
II: Asymptotic Properties,” Journal of the Royal Statistical Society B , 40, 222–228.
Jacobs, P.A., and P.A.W. Lewis (1983), “Stationary Discrete Autoregressive Moving
Average Time Series Generated by Mixtures,” Journal of Time Series Analysis, 4,
19–36.
Jaggia, S. (1991), “Specification Tests Based on the Generalized Gamma Model of
Duration,” Journal of Applied Econometrics, 6, 169–180.
Jaggia, S., and S. Thosar (1993), “Multiple Bids as a Consequence of Target Management Resistance: A Count Data Approach,” Review of Quantitative Finance and
Accounting, 447–457.
Jeffries, N.O. (2003), “A Note on ‘Testing the Number of Components in a Normal
Mixture,’” Biometrika, 90, 991–994.
Jewel, N. (1982), “Mixtures of Exponential Distribtions,” Annals of Statistics, 10, 479–
484.
Joe, H. (1997), Multivariate Models and Dependence Concepts, London, Chapman and
Hall.
Johansson, P (1995), “Tests for Serial Correlation and Overdispersion in a Count Data
Regression Model,” Journal of Statistical Computation and Simulation, 53, 153–
164.
Johansson, P. (1996), “Speed Limitation and Motorway Casualties – A Time Series
Count Data Regression Approach,” Accident Analysis and Prevention, 28, 73–87.
Johansson, P., and M. Palme (1996), “Do Economics Incentives Affect Work Absence –
Empirical Evidence Using Swedish Micro Data,” Journal of Public Economics, 59,
195–218.
Johnson, N.L., A.W. Kemp, and S. Kotz (2005), Univariate Discrete Distributions,
edition 3, New York, John Wiley.
Johnson, N.L., and S. Kotz (1969), Discrete Distributions, Boston, Houghton Mifflin.
Johnson, N.L., S. Kotz, and N. Balakrishnan (1997), Continuous Univariate Distributions, edition 2, New York, John Wiley Sons.
Jordan, P., D. Brubacher, S. Tsugane, Y. Tsubono, K.F. Gey, and U. Moser (1997),
“Modeling Mortality Data from a Multi-Center Study in Japan by Means of Poisson
Regression with Errors in Variables,” International Journal of Epidemiology, 26,
501–507.
Jorgensen, B. (1987), “Exponential Dispersion Models (with discussion),” Journal of
the Royal Statistical Society B, 49, 127–162.
Jorgensen, B. (1997), The Theory of Dispersion Models, London, Chapman and Hall.
Jorgenson, D.W. (1961), “Multiple Regression Analysis of a Poisson Process,” Journal
of the American Statistical Association, 56, 235–245.
Jung, R.C., M. Kukuk, and R. Liesenfeld (2006), “Time Series of Count Data: Modeling,
Estimation and Diagnostics,” Computational Statistics & Data Analysis, 51, 2350–
2364
Jung, R.C., R. Liesenfeld, and J.-F. Richard (2011), “Dynamic Factor Models for Multivariate Count Data: An Application to Stock-Market Trading Activity,” Journal of
Business and Economic Statistics, 29, 73–86.
Jung, C.J., and R. Winkelmann (1993), “Two Apects of Labor Mobility: A Bivariate
Poisson Regression Approach,” Empirical Economics, 18, 543–556.
Jupp, P.E., and K.V. Mardia (1980), “A General Correlation Coefficient for Directional
Data and Related Regression Problems,” Biometrika, 67, 163–173.
Kaiser, M., and N. Cressie (1997), “Modeling Poisson Variables with Positive Spatial
Dependence,” Statistics and Probability Letters 35, 423–432.

528

References

Kalbfleisch, J., and R. Prentice (1980, 2002), The Statistical Analysis of Failure Time
Data, 1st and 2nd editions, New York, John Wiley Sons.
Karlis, D., and I. Ntzoufras (2003), “Analysis of Sports Data Using Bivariate Poisson
Models,” Journal of the Royal Statistical Society D, 52, 381–393.
Karlis, D., and E. Xekalaki, (1998), “Minimum Hellinger Distance Estimation for
Poisson Mixtures,” Computational Statistics and Data Analysis 29, 81–103.
Katz, L. (1963), “Unified Treatment of a Broad Class of Discrete Probability Distributions,” in G. P. Patil, ed., Classical and Contagious Discrete Distributions, Calcutta,
Statistical Publishing Society.
Keane, M.P., and D.E. Runkle (1992), “On the Estimation of Panel-Data Models with
Serial Correlation When Instruments Are Not Strictly Exogenous,” Journal of Business and Economic Statistics, 10, 1–9.
Kennan, J. (1985), “The Duration of Contract Strikes in U.S. Manufacturing,” Journal
of Econometrics, 28, 5–28.
Kianifard, F., and P.P. Gallo (1995), “Poisson Regression Analysis in Clinical Research,”
Journal of Biopharmaceutical Statistics, 5, 115–129.
Kim, C-J., and C.R. Nelson (1999), State-Space Models with Regime Switching, Cambridge, MA, MIT Press.
King, G. (1987a), “Presidential Appointments to the Supreme Court. Adding Systematic
Explanation to Probabilistic Description,” American Political Quarterly, 15, 373–
386.
King, G. (1987b), “Event Count Models for International Relations: Generalizations
and Applications,” International Studies Quarterly, 33, 123–147.
King, G. (1989a), “A Seemingly Unrelated Poisson Regression Model,” Sociological
Methods and Research, 17, 235–255.
King, G. (1989b), “Variance Specification in Event Count Models: From Restrictive
Assumptions to a Generalized Estimator,” American Journal of Political Science, 33,
762–784.
Kingman, J.F.C. (1993), Poisson Processes, Oxford, Oxford University Press.
Kocherlakota, S., and K. Kocherlakota (1993), Bivariate Discrete Distributions, New
York, Marcel Dekker.
Koenker, R. (1982), “A Note on Studentizing a Test for Heteroskedasticity,” Journal of
Econometrics, 17, 107–112.
Koenker, R. (2005), Quantile Regression, Vol. 38, New York, Cambridge University
Press.
Koop, G. (2003), Bayesian Econometrics, New York, John Wiley Sons.
Koop, G., D.J. Poirier, and J.L. Tobias (2007), Bayesian Econometric Methods, New
York, Cambridge University Press.
Kotz, S., and N.L. Johnson (1982–89), Encyclopedia of Statistical Sciences, New York,
John Wiley.
Laird, N. (1978), “Nonparametric Maximum Likelihood Estimation of a Mixing Distribution,” Journal of the American Statistical Association, 73, 805–811.
Lambert, D. (1992), “Zero-Inflated Poisson Regression with an Application to Defects
in Manufacturing,” Technometrics, 34, 1–14.
Lancaster, H.O. (1958), “The Structure of Bivariate Distributions,” Annals of Mathematical Statistics, 29, 719–736.
Lancaster, H.O. (1963), “Correlations and Canonical Forms of Bivariate Distributions,”
Annals of Mathematical Statistics, 34, 532–538.
Lancaster, H.O. (1969), The Chi-Squared Distribution, New York, John Wiley Sons.

References

529

Lancaster, T. (1990), The Econometric Analysis of Transitional Data, New York, Cambridge University Press.
Lancaster, T. (1997), “Orthogonal Parameters and Panel Data,” Working Paper No.
1997–32, Department of Economics, Brown University.
Lancaster, T. (2004), Introduction to Modern Bayesian Econometrics, New York, John
Wiley Sons.
Landwehr, J.M., D. Pregibon, and A.C. Shoemaker (1984), “Graphical Methods for
Assessing Logistic Regression Models (with Discussion),” Journal of the American
Statistical Association, 79, 61–83.
Lawless, J.F. (1987), “Negative Binomial and Mixed Poisson Regressions,” Canadian
Journal of Statistics, 15, 209–225.
Lawless, J.F. (1995), “The Analysis of Recurrent Events for Multiple Subjects,” Applied
Statistics – Journal of the Royal Statistical Society C, 44, 487–498.
Lee, K.L., and D.R. Bell (2009), “A Spatial Negative Binomial Regression of IndividualLevel Count Data with Regional and Person-Specific Covariates,” unpublished
manuscript, Wharton School.
Lee, L.-F. (1983), “Generalized Econometric Models with Selectivity,” Econometrica,
51, 507–512.
Lee, L.-F. (1986), “Specification Test for Poisson Regression Models,” International
Economic Review, 27, 689–706.
Lee, L.-F. (1997), “Specification and Estimation of Count Data Regression and Sample
Selection Models – A Counting Process and Waiting Time Approach,” presented at
the North American Summer Meetings of the Econometric Society, Pasadena, June
1997.
Lee, M-L.T. (1996), “Properties and Applications of the Sarmanov Family of Bivariate
Distributions,” Communication in Statististics, Part A – Theory and Methods, 25,
1207–1222.
Lee, Y., and J.A. Nelder (1996), “Hierarchical Generalized Linear Models,” Journal of
the Royal Statistical Society Series B, 58, 619–678.
Leon, L.F., and C.-L. Tsai (1997), “The Assessment of Model Adequacy for Markov
Regression Time Series Models,” Biometrics, 54, 1165–1175.
Leroux, B.G. (1992), “Consistent Estimation of a Mixing Distribution,” Annals of
Statistics, 20, 3, 1350–1360.
Lewbel, A. (1997), “Constructing Instruments for Regressions with Measurement Error
When no Additional Data Are Available, with an Application to Patents and R&D,”
Econometrica, 65, 1201–1213.
Lewis, P.A.W. (1985), “Some Simple Models for Continuous Variate Time Series,”
Water Resources Bulletin, 21, 635–644.
Li, C.-S., J.-C. Lu, J. Park, K. Kim, P.A. Brinkley, and J.P. Peterson (1999), “Multivariate
Zero-Inflated Poisson Models and Their Applications,” Technometrics, 41, 29–38.
Li, Q., and J. Racine (2007), Nonparametric Econometrics, Princeton, NJ, Princeton
University Press.
Li, Q., and J. Racine (2008), “Nonparametric Estimation of Conditional CDF and Quantile Functions With Mixed Categorical and Continuous Data,” Journal of Business
and Economic Statistics, 26, 423–434.
Li, T. (2000), “Estimation of Nonlinear Errors-in-Variables Models: A Simulated Minimum Distance Estimator,” Statistics and Probability Letters, 47, 243–248.
Li, T. (2002), “Robust and Consistent Estimation of Nonlinear Errors-in-Variables Models,” Journal of Econometrics, 110, 1–26.

530

References

Li, T., P.K. Trivedi, and J. Guo (2003), “Modeling Response Bias in Count: A Structural
Approach with an Application to the National Crime Victimization Survey Data,”
Sociological Methods and Research, 31, 514–545.
Li, W.K. (1991), “Testing Model Adequacy for Some Markov Regression Models for
Time Series,” Biometrika, 78, 83–89.
Liang, K.-Y., and S. Zeger (1986), “Longitudinal Data Analysis Using Generalized
Linear Models,” Biometrika, 73, 13–22.
Liang, K.-Y., S. Zeger, and B. Qaqish (1992), “Multivariate Regression Analyses for
Categorical Data,” Journal of the Royal Statistical Society Series B (Methodological),
54(1), 3–40.
Lindeboom, M., and G.J. van den Berg (1994), “Heterogeneity in Models for Bivariate
Survival: The Importance of Mixing Distribution,” Journal of the Royal Statistical
Society, B, 56, 49–60.
Lindsay, B.G. (1983), “The Geometry of Mixture Likelihoods,” The Annals of Statistics,
11(1), 86–94.
Lindsay, B.G. (1995), Mixture Models: Theory, Geometry and Applications, NSFCBMS Regional Conference Series in Probability and Statistics, volume 5, IMSASA.
Lindsay, B.G., and K. Roeder (1992), “Residual Diagnostics in the Mixture Model,”
Journal of the American Statistical Association, 87, 785–795.
Lindsay, B.G., and M. Stewart (2008), “Mixture Models,” in S.N. Durlauf and L.E.
Blume, eds., The New Palgrave Dictionary of Economics, edition 2, Palgrave Macmillan.
Lo, Y., N.R. Mendell, and D.R. Rubin (2001), “Testing the Number of Components in
a Normal Mixture,” Biometrika, 88, 767–778.
Long, J.S. (1997), Regression Models for Categorical and Limited Dependent Variables,
Thousand Oaks, CA, Sage Publications.
Lourenco, O.D., and P.L. Ferreira (2005), “Utilization of Public Health Centres in Portugal: Effect of Time Costs and Other Determinants. Finite Mixture Models Applied
to Truncated Samples,” Health Economics, 14, 939–953.
Lu, Z., Y.V. Hui, and A.H. Lee (2003), “Minimum Hellinger Distance Estimation for
Finite Mixtures of Poisson Regression Models and Its Applications,” Biometrics, 59
1016–1026.
Lu, Z., and G.E. Mizon (1996), “The Encompassing Principle and Hypothesis Testing,”
Econometric Theory, 12, 845–858.
Luceňo, A. (1995), “A Family of Partially Correlated Poisson Models for Overdispersion,” Computational Statistics and Data Analysis, 20, 511–520.
Lunn, D.J., A. Thomas, N. Best, and D. Spiegelhalter (2000), “WinBUGS – a Bayesian
Modelling Framework: Concepts, Structure, and Extensibility,” Statistics and Computing, 10, 325–337.
MacDonald, I.L., and W. Zucchini (1997), Hidden Markov and Other Models for
Discrete-Valued Time Series, London, Chapman and Hall.
Machado, J.A.F., and J.M.C. Santos Silva (2005), “Quantiles for Counts,” Journal of
the American Statistical Association, 100(472), 1226–1237.
Maddala, G.S. (1983), Limited Dependent and Qualitative Variables in Econometrics,
Cambridge, Cambridge University Press.
Mahajan, A. (2005), “Identification and Estimation of Regression Models with Misclassification,” Econometrica, 74, 631–665.

References

531

Manski, C.F., and D. McFadden (1981), eds., Structural Analysis of Discrete Data with
Econometric Applications, Cambridge, MA, MIT Press.
Marshall, A. (1996), “Copulas, Marginals, and Joint Distributions,” in L. Ruschendorf,
B. Schweizer, and M.D. Taylor, eds., Distributions with Fixed Marginals and Related
Topics, 213–222, Hayward, CA, Institute of Mathematic Statistics.
Marshall, A.W., and I. Olkin (1988), “Families of Multivariate Distributions,” Journal
of the American Statistical Association, 83, 834–841.
Marshall, A.W., and I. Olkin (1990), “Multivariate Distributions Generated from Mixtures of Convolution and Product Families,” in H.W. Block, A.R. Sampson, and T.H.
Savits, eds., Topics in Statistical Dependence, IMS Lecture Notes-Monograph Series,
volume 16, 371–393, Hayward, CA, Institute of Mathematical Statistics.
Mátyás, L., and P. Sevestre (2008), The Econometrics of Panel Data: Fundamentals
and Recent Developments in Theory and Practice, edition 3, New York, Springer.
Matzkin, R. (2007), “Nonparametric Identification,” in E.E. Leamer, eds., Handbook of
Econometrics, volume 68, 5307–5368, Amsterdam, North-Holland.
Matzkin, R.L. (2010), “Estimation of Nonparametric Models with Simultaneity,” Working Paper, UCLA Department of Economics.
Mayer, W.J., and W.F. Chappell (1992), “Determinants of Entry and Exit: An Application of Bivariate Compounded Poisson Distribution to U. S. Industries, 1972–1977”
Southern Economic Journal, 58, 770–778.
McCabe, B.P.M., G.M. Martin, and D. Harris (2011), “Efficient Probabilistic Forecasts
for Counts,” Journal of the Royal Statistical Society B, 73, 253–272.
McCallum, J., C. Raymond, and C. McGilchrist (1995), “How Accurate Are Self Reports
of Doctor Visits? A Comparison Using Australian Health Insurance Commission
Records,” pre-print.
McCullagh, P. (1983), “Quasi-likelihood Functions,” Annals of Statistics, 11, 59–67.
McCullagh, P. (1986), “The Conditional Distribution of Goodness-of-Fit Statistics
for Discrete Data,” Journal of the American Statistical Association, 81, 104–
107.
McCullagh, P., and J.A. Nelder (1983, 1989), Generalized Linear Models, editions 1
and 2, London, Chapman and Hall.
McFadden, D., and P.A. Ruud (1994), “Estimation by Simulation,” Review of Economics
and Statistics, 76, 591–608.
McGilchrist, C.A. (1994), “Estimation in Generalized Mixed Models, Journal of the
Royal Statistical Society B, 56, 61–69.
McKenzie, E. (1985), “Some Simple Models for Discrete Variate Time Series,” Water
Resources Bulletin, 21, 645–650.
McKenzie, E. (1986), “Autoregressive Moving-Average Processes with Negative Binomial and Geometric Marginal Distributions,” Advances in Applied Probability, 18,
679–705.
McKenzie, E. (1988), “Some ARMA Models for Dependent Sequences of Poisson
Counts,” Advances in Applied Probability, 22, 822–835.
McLachlan, G.J., and K.E. Basford, (1988), Mixture Models: Inference and Application
to Clustering, New York, Marcel Dekker.
McLachlan, G., and D. Peel. (2000), Finite Mixture Models, New York, John Wiley
Sons.
McLeod, L. (2011), “A Nonparametric vs. Latent Class Model of General Practitioner
Utilization,” Journal of Health Economics, 20, 1261–1279.

532

References

McShane, B.M., M. Adrian, E.T. Bradlow, and P.S. Fader, (2008), “Count Models
Based on Weibull Interarrival Times,” Journal of Business and Economic Statistics,
26, 369–378.
Meghir, C., and J.-M. Robin (1992), “Frequency of Purchase and Estimation of Demand
Equations,” Journal of Econometrics, 53, 53–86.
Melkersson, M., and D. Rooth (2000) “Modeling Female Fertility Using Inflated Count
Data Models,” Journal of Population Economics, 13, 189–203.
Merkle, L., and K.F. Zimmermann (1992), “The Demographics of Labor Turnover:
A Comparison of Ordinal Probit and Censored Count Data Models,” Reserches
Economiques de Louvain, 58, 283–307.
Miles, D. (2001), “Joint Purchasing Decisions: A Multivariate Negative Binomial
Approach,” Applied Economics, 33, 937–946.
Min, Y., and A. Agresti (2005), “Random Effect Models for Repeated Measures of
Zero-Inflated Count Data,” Statistical Modelling, 5, 1–19.
Miranda, A. (2006), “QCOUNT: Stata Program to Fit Quantile Regression Models
for Count Data,” Statistical Software Components Paper S456714, Boston College
Department of Economics.
Miranda, A. (2008), “Planned Fertility and Family Background: A Quantile Regression
for Counts Analysis,” Journal of Population Economics, 21, 67–81.
Miranda, A. (2010), “A Double-Hurdle Count Model for Completed Fertility Data from
the Developing World,” DoQSS Working Papers 10-01, Department of Quantitative
Social Science, Institute of Education, University of London.
Miravete, E.J. (2011), “Testing for Complementarities among Countable Strategies,”
manuscript, Department of Economics, University of Texas.
Mizon, G.E., and J.-F. Richard (1986), “The Encompassing Principle and Its Application
to Testing Non-Nested Hypotheses,” Econometrica, 54, 657–678.
Montalvo, J.G. (1997), “GMM Estimation of Count-Panel-Data Models with Fixed
Effects and Predetermined Instruments,” Journal of Business and Economic Statistics,
15, 82–89.
Moore, D.F. (1986), “Asymptotic Properties of Moment Estimators for Overdispersed
Counts and Proportions,” Biometrika, 73, 583–588.
Moran, P.A.P. (1971), “Maximum Likelihood Estimation in Non-Standard Conditions,”
Proceedings of the Cambridge Philosophical Society, 70, 441–450.
Morrison, D.G., and D.C. Schmittlein (1988), “Generalizing the NBD Model for Customer Purchases: What Are the Implications and Is It Worth the Effort?,” Journal of
Economics and Business Statistics, 6, 145–166.
Moschopoulos, P., and J.G. Staniswalis (1994), “Estimation Given Conditional from an
Exponential Family,” American Statistician, 48, 271–275.
Mukhopadhyay, K., and P.K. Trivedi (1995), “Regression Models for Under-reported
Counts,” Pre-print.
Mullahy, J. (1986), “Specification and Testing of Some Modified Count Data Models,”
Journal of Econometrics, 33, 341–365.
Mullahy, J. (1997a), “Heterogeneity, Excess Zeros and the Structure of Count Data
Models,” Journal of Applied Econometrics, 12, 337–350.
Mullahy, J. (1997b), “Instrumental Variable Estimation of Poisson Regression Models:
Application to Models of Cigarette Smoking Behavior,” Review of Economics and
Statistics, 586–593.
Mundlak, Y. (1978), “On the Pooling of Time Series and Cross Section Data,” Econometrica, 46, 69–85.

References

533

Munkin, M., and P.K. Trivedi (1999) “Simulated Maximum Likelihood Estimation of
Multivariate Mixed-Poisson Regression Models, with Application,” Econometrics
Journal, 2, 29–48.
Murphy, K., and R. Topel (1985), “Estimation and Inference in Two Step Econometric
Models,” Journal of Business and Economic Statistics, 3, 370–379.
Nagin, D.S., and K.C. Land (1993), “Age, Criminal Careers and Population Heterogeneity: Specification and Estimation of a Nonparametric, Mixed Regression Model,”
Criminology, 31, 327–362.
Nakamura, T. (1990), “Corrected Score Function for Errors-in-Variables Models:
Methodology and Application to Generalized Linear Models,” Biometrika, 77, 127–
137.
Navarro, S. (2008), “Control Functions,” In S.N. Durlauf and L.E. Blume, eds., The
New Palgrave Dictionary of Economics, edition 2, London, Palgrave Macmillan.
Neal, R.M. (2000), “Markov Chain Sampling Methods for Dirichlet Process Mixture
Models,” Journal of Computational and Graphical Statistics, 9(2), 249–265.
Nelder, J.A., and D. Pregibon (1987), “An Extended Quasi-likeihood Function,”
Biometrika, 74, 221–232.
Nelder, J.A., and R.W.M. Wedderburn (1972), “Generalized Linear Models,” Journal
of the Royal Statistical Society A, 135, 370–384.
Nelsen, R.B. (2006), An Introduction to Copulas, edition 2, New York, Springer.
Newell, D.J. (1965), “Unusual Frequency Distributions,” Biometrics, 21, 159–168.
Newey, W.K. (1984), “A Methods of Moments Interpretation of Sequential Estimators,”
Economics Letters, 14, 201–206.
Newey, W.K. (1985), “Maximum Likelihood Specification Testing and Conditional
Moment Tests,” Econometrica, 53, 1047–1070.
Newey, W.K. (1987), “Efficient Estimation of Limited Dependent Variable Models with Endogenous Explanatory Variables,” Journal of Econometrics, 36, 231–
250.
Newey, W.K. (1990a), “Efficient Instrumental Variable Estimation of Nonlinear Models,” Econometrica, 58, 809–838.
Newey, W.K. (1990b), “Semiparametric Efficiency Bounds,” Journal of Applied Econometrics, 5, 99–136.
Newey, W.K. (1993), “Efficient Estimation of Models with Conditional Moment Restrictions,” in G.S. Maddala, C.R. Rao, and H.D. Vinod, eds., Handbook of Statistics,
Volume 11: Econometrics, 419–454, Amsterdam, North-Holland.
Newey, W.K. (2001), “Flexible Simulated Moment Estimation of Nonlinear Errors in
Variables Models,” Review of Economics and Statistics, 83, 616–627.
Newey, W.K., and D. McFadden (1994), “Large Sample Estimation and Hypothesis
Testing,” in R.F. Engle and D. McFadden, eds., Handbook of Econometrics, volume
4, Amsterdam, North-Holland.
Newey, W.K., and K.D. West (1987a), “A Simple, Positive Semi-Definite, Hetereroscedasticity and Autocorrelation Consistent Covariance Matrix,” Econometrica, 55,
703–708.
Newey, W.K., and K.D. West (1987b), “Hypothesis Testing with Efficient Methods of
Moments Estimators,” International Economic Review, 28, 777–787.
Newey, W.K., and F. Windmeijer (2009), “GMM with Many Weak Moment Conditions,”
Econometrica, 77, 687–719.
Newhouse, J.P. (1993), Free For All? Lessons from the Rand Health Insurance Experiment. Cambridge, MA, Harvard University Press.

534

References

Newton, H.J., and N.J. Cox (2003), “A Special Issue of the Stata Journal,” Stata Journal,
3, 327.
Neyman, J. (1939), “On a New Class of Contagious Distributions Applicable in Entomology and Bacteriology,” Annals of Mathematical Statistics, 10, 35–57.
Neyman, J. (1965), “Certain Chance Mechanisms Involving Discrete Distributions,”
in G.N. Patil, ed., Classical and Contagious Discrete Distributions, 1–14, Calcutta,
India, Statistical Publishing House.
Nguyen, T.T., A.K. Gupta, D.M. Nguyen, and Y. Wang (2007), “Characterizations of
Negative Multinomial Distributions Based on Conditional Distributions,” Metrika,
66, 315–322.
Nickell, S. (1981), “Biases in Dynamic Models with Fixed Effects,” Econometrica, 49,
1399–1416.
Noack, A. (1950), “A Class of Random Variables with Discrete Distributions,” Annals
of Mathematical Statistics, 21, 127–132.
Nylund, K.L., T. Asparouhov, and B.O. Muthén (2007), “Deciding on the Number of
Classes in Latent Class Analysis and Growth Mixture Modeling: A Monte Carlo
Simulation Study,” Structural Equation Modeling: A Multidisciplinary Journal, 14,
535–569.
Ogaki, M. (1993), “Generalized Method of Moments: Econometric Applications,” in
G.C. Maddala, C.R. Rao, and H.D. Vinod, eds., Handbook of Statistics, Volume 11:
Econometrics, Amsterdam, North-Holland, 455–488.
Okoruwa, A.A., J.V. Terza, and H.O. Nourse (1988), “Estimating Patronization Shares
for Urban Retail Centers: An Extension of the Poisson Gravity Model,” Journal of
Urban Economics, 24, 241–259.
Olsen, M.K., and J.L. Schafer (2001), “A Two-Part Random-Effects Model for Semicontinuous Longitudinal Data,” Journal of the American Statistical Association, 96,
730–745.
Ord, J., and Whitmore, G. (1986), “The Poisson-Inverse Gaussian Distribution as a
Model for Species Abundance,” Communications in Statistics A: Theory and Methods,
15, 853–876.
Owen, A.B. (1988), “Empirical Likelihood Ratio Confidence Intervals for a Single
Functional,” Biometrika, 75, 237–249.
Ozuna, T., and I. Gomaz (1995), “Specification and Testing of Count Data Recreation
Demand Functions,” Empirical Economics, 20, 543–550.
Pagan, A.R. (1986), “Two Stage and Related Estimators and Their Applications,” Review
of Economic Studies, 53, 517–38.
Pagan, A.R., and A. Ullah (1999), Nonparametric Econometrics, Cambridge, UK, Cambridge University Press.
Pagan, A.R., and F. Vella (1989), “Diagnostic Tests for Models Based on Individual
Data: A Survey,” Journal of Applied Econometrics, 4, S29–S59.
Page, M. (1995), “Racial and Ethnic Discrimination in Urban Housing Markets –
Evidence from a Recent Audit Survey,” Journal of Urban Economics, 38, 183–
206.
Palmgren, J. (1981), “The Fisher Information Matrix for Log-Linear Models Arguing
Conditionally in the Observed Explanatory Variables,” Biometrika, 68, 563–566.
Papadapoulos, G., and J.M.C. Santos Silva (2008), “Identification Issues in Models of
Underreported Counts,” University of Essex Discussion Paper 657.
Patil, G.P. (1970), editor, Random Counts in Models and Structures, volumes 1–3,
University Park, Pennsylvania State University Press.

References

535

Patil, S.A., D.I. Patel, and J.L. Kovner (1977), “On Bivariate Truncated Poisson Distribution,” Journal of Statistical Computation and Simulation, 6, 49–66.
Patton, A. (2006), “Modelling Asymmetric Exchange Rate Dependence,” International
Economic Review, 47, 527–556.
Pesaran, M.H. (1987), “Global and Partial Non-Nested Hypotheses and Asymptotic
Local Power,” Econometric Theory, 3, 677–694.
Pierce, D. (1982), “The Asymptotic Effect of Substituting Estimators for Parameters in
Certain Types of Statistics,” Annals of Statistics, 10, 475–478.
Pierce, D.A., and D.W. Schafer (1986), “Residuals in Generalized Linear Models,”
Journal of the American Statistical Association, 81, 977–986.
Pinquet, J. (1997), “Experience Rating through Heterogeneous Models,” Working Paper
No. 9725, THEMA, Universit_e Paris X-Nanterre.
Pohlmeier, W., and V. Ulrich (1995), “An Econometric Model of the Two-Part Decisionmaking Process in the Demand for Health Care,” Journal of Human Resources,
30, 339–361.
Poisson, S.-D. (1837), Recherches sur la probabilité des jugements en matière criminelle
et en matière civile, Paris, Bachelier.
Pope, A., J. Schwartz, and M. Ransom (1992), “Daily Mortality and PM10 Pollution in
Utah Valley,” Archives of Environmental Health, 47, 211–217.
Pregibon, D. (1980), “Goodness of Link Tests for Generalized Linear Models, Journal
of the Royal Statistical Society C (Applied Statistics), 29, 15–23.
Pregibon, D. (1981), “Logistic Regression Diagnostics,” Annals of Statistics, 9, 705–
724.
Press, W.H., S.A. Teukolsky, W.T. Vetterling, and B.P. Flannery (2008), Numerical
Recipes: The Art of Scientific Computing, edition 3, Cambridge, Cambridge University Press.
Pudney, S. (1989), Modelling Individual Choice: The Econometrics of Corners, Kinks
and Holes, New York, Basil Blackwell.
Qin, J., and J. Lawless (1994), “Empirical Likelihood and General Estimating Equations,” Annals of Statistics, 22, 300–325.
Rabe-Hesketh, S., A. Skrondal, and A. Pickles (2003), “Maximum Likelihood Estimation of Generalized Linear Models with Covariate Measurement Error,” Stata Journal,
3, 386–411.
Ramaswamy, V., E.N. Anderson, and W.S. DeSarbo (1994), “A Diasaggregate Negative
Binomial Regression Procedure for Count Data Analysis,” Management Science, 40,
405–417.
Ridout, M.S., and P. Besbeas (2004). “An Empirical Model of Underdispersed Count
Data,” Statistical Modeling, 4(1), 77–89.
Robert, C.P. (1996), “Mixtures of Distributions: Inference and Estimation,” in W.R.
Gilks, S. Richardson, and D.J. Spiegelhalter (eds.), Markov Chain Monte Carlo in
Practice, 441–464, London, Chapman and Hall.
Robert, C.P., and G. Casella (1996), Monte Carlo Methods, New York: SpringerVerlag.
Robinson, P.M. (1987a), “Semiparametric Econometrics: A Survey,” Journal of Applied
Econometrics, 2, 35–52.
Robinson, P.M. (1987b), “Asymptotically Efficient Estimation in the Presence of Heteroskedasticity of Unknown Form,” Econometrica, 55, 875–891.
Robinson, P.M. (1988), “Root-N Consistent Semiparametric Regression,” Econometrica, 56, 931–954.

536

References

Ronning, G., and R.C. Jung (1992), “Estimation of a First Order Autoregressive Process
with Poisson Marginals for Count Data,” in L. Fahrmeir et al., eds., Advances in GLIM
and Statistical Modelling, 188–194, New York, Springer-Verlag.
Rose, N. (1990), “Profitability and Product Quality: Economic Determinants of Airline
Safety Performance,” Journal of Political Economy, 98, 944–964.
Ross, S.M. (1996), Stochastic Processes, edition 2, New York, John Wiley Sons.
Ruser, J.W. (1991), “Workers’ Compensation and Occupational Injuries and Illnesses,”
Journal of Labor Economics, 9, 325–350.
Santos Silva, J.M.C. (1997), “Unobservables in Count Data Models for On-site Samples,” Economics Letters 54(3), 217–220.
Santos Silva, J., and F. Covas (2000), “A Modified Hurdle Model for Completed Fertility,” Journal of Population Economics, 13, 173–188.
Santos Silva, J.M.C., and S. Tenreyro (2006), “The Log of Gravity,” The Review of
Economics and Statistics, 88, 641–658.
Santos Silva, J.M.C., and F. Windmeijer (2001), “Two-part Multiple Spell Models for
Healthcare Demand,” Journal of Econometrics, 104, 67–89.
Sargan, J.D. (1958), “The Estimation of Economic Relationships using Instrumental
Variables,” Econometrica, 26, 393–415.
Sarmanov, O.V. (1966), “Generalized Normal Correlations and Two-Dimensional
Fréchet classes,” Soviet Mathematics – Doklady, 168, 596–599.
Savani, V., and A.A. Zhigljavsky (2007), “Efficient Parameter Estimation for Independent and INAR(1) Negative Binomial Samples,” Metrika, 65, 207–225.
Scallan, A., R. Gilchrist, and M. Green (1984), “Fitting Parametric Link Functions in
Generalised Linear Models,” Computational Statistics and Data Analysis, 2, 37–49.
Schall, R. (1991), “Estimation in Generalized Linear Models with Random Effects,”
Biometrika, 78, 719–727.
Schennach, S. (2007), “Instrumental Variable Estimation of Nonlinear Errors-inVariables Models,” Econometrica, 75, 201–239.
Schmidt, P., and A. Witte (1989), “Predicting Criminal Recidivism Using SplitPopulation Survival Time Models,” Journal of Econometrics, 40, 141–159.
Schneider, A.L. (1981), “Differences between Survey and Police Information about
Crime,” in R.G. Lehnan and W.G. Skogan, eds., The NCS Working Papers, volume 1,
Washington, DC, U.S. Department of Justice, 33–34.
Schwartz, E.S., and W.N. Torous (1993), “Mortgage Prepayments and Default Decisions: A Poisson Regression Approach,” AREUEA Journal: Journal of the American
Real Estate Association, 21, 431–449.
Schwarz, G. (1978), “Estimating the Dimension of a Model,” Annals of Statistics, 6,
461–464.
Schweizer, B., and A. Sklar (1983), Probabilistic Metric Spaces, New York, North
Holland.
Scott, S.L. (2002), “Bayesian Methods for Hidden Markov Models: Recursive Computing in the 21st Century,” Journal of the American Statistical Association, 97,
337–351.
Sellar, C., J.R. Stoll, and J.P. Chavas (1985), “Validation of Empirical Measures of
Welfare Change: A Comparison of Nonmarket Techniques,” Land Economics, 61,
156–175.
Severini, T.A., and J.G. Staniswalis (1994), “Quasi-Likelihood Estimation in Semiparametric Models,” Journal of American Statistical Association, 89, 501–511.

References

537

Shaban, S.A. (1988), “Poisson-Lognormal Distributions,” in E.L. Crow and K. Shimizu,
eds., Lognormal Distributions, 195–210, New York, Marcel Dekker.
Shaked, M. (1980), “On Mixtures from Exponential Families,” Journal of the Royal
Statistical Society B, 42, 415–433.
Shaw, D. (1988), “On-Site Samples’ Regression Problems of Non-Negative Integers,
Truncation and Endogenous Stratification,” Journal of Econometrics, 37, 211–223.
Shephard, N. (1995), “Generalized Linear Autoregression,” Nuffield College, Oxford
University, pre-print.
Shephard, N., and M.K. Pitt (1997), “Likelihood Analysis of Non-Gaussian measurement Time Series,” Biometrika, 84, 653–667.
Shiba, T., and H. Tsurumi (1988), “Bayesian and Non-Bayesian Tests of Independence
in Seemingly Unrelated Regressions,” International Economic Review, 29, 377–
395.
Shklyar, S., and H. Schneeweiss (2005), “A Comparison of Asymptotic Covariance
Matrices of Three Consistent Estimators in the Poisson Regression Model with Measurment Errors,” Journal of Multivariate Analysis, 94, 250–270.
Sichel, H.S. (1971), “On a Family of Discrete Distributions Particularly Suited to
Represent Long-tailed Frequency Data,” in Proceedings of the Third Symposium on
Mathematical Statistics. N.F. Laubscher (ed.), S.A.C.S.I.R (Pretoria), 51–97.
Sichel, H.S. (1974), “On a Distribution Representing Sentence-Length in Written Prose,”
Journal of the Royal Statistical Society A, 137, 25–34.
Sichel, H.S. (1975), “On a Distribution Law for Word Frequencies,” Journal of the
American Statistical Association, 70, 542–547.
Simar, L. (1976), “Maximum Likelihood Estimation of a Compound Poisson Process,”
Annals of Statistics, 4, 1200–1209.
Singh, A.C., and G.R. Roberts (1992), “State Space Modelling of Cross-Classified Time
Series of Counts,” International Statistical Review, 60, 321–335.
Skellam, J.G. (1946), “The Frequency Distribution of the Difference between Two
Poisson Variates Belonging to Different Populations,” Journal of the Royal Statistical
Society A, 109, 296.
Sklar, A. (1973), “Random Variables, Joint Distributions, and Copulas,” Kybernetica,
9, 449–460.
Skrondal, A., and S. Rabe-Hesketh (2004), Generalized Latent Variable Modeling:
Multilevel, Longitudinal, and Structural Equation Models, London, Chapman and
Hall.
Smith, M.S., and M.A. Khaled (2010), “Estimation of Copula Modles with Discrete
Margins,” manuscript, Melbourne Business School.
Smith, R.J. (1997), “Alternative Semi-Parametric Likelihood Approaches to Generalised
Method of Moment Estimation,” Economic Journal, 107, 503–519.
Smyth, G.K. (1989), “Generalized Linear Models with Varying Dispersion,” Journal of
Royal Statistical Society B, 51, 47–60.
Solow, A.R. (1993), “Estimating Record Inclusion Probability,” American Statistician,
47, 206–209.
Staniswalis, J. (1989), “The Kernel Estimate of a Regression Function in LikelihoodBased Models,” Journal of the American Statistical Association, 84, 426–431.
Stefanski, L.A. (1989), “Unbiased Estimation of a Nonlinear Function of a Normal Mean
with the Application to Measurement Error Models,” Communications in Statistics,
Series A, 18, 4335–4358.

538

References

Stefanski, L.A., and J.S. Buzas (1995), “Instrumental Variable Estimation in Binary
Regression Measurement Error Models,” Journal of the American Statistical Association, 90, 541–550.
Stefanski, L.A., and R.J. Carroll (1987), “Conditional Scores and Optimal Scores in
Generalized Linear Measurement Error Models,” Biometrika, 74, 703–716.
Steutel, F.W., and K. Van Harn (1979), “Discrete Analogues of Self-Decomposability
and Stability,” Annals of Probability, 7, 893–899.
Stewart, M. (2007), “The Interrelated Dynamics of Unemployment and Low-Wage
Employment,” Journal of Applied Econometrics, 22, 511–531.
Stroud, A.H., and D. Secrest (1966), Gaussian Quadrature Formulas, Englewood Cliffs,
NJ, Prentice Hall.
Stukel, T. (1988), “Generalized Logistic Models,” Journal of The American Statistical
Association, 83, 426–431.
Szu, H., and R. Hartley (1987), “Fast Simulated Annealing,” Physics Letters A, 122,
157–162.
Tauchen, G. (1985), “Diagnostic Testing and Evaluation of Maximum Likelihood Models,” Journal of Econometrics, 30, 415–443.
Taylor, H.M., and S. Karlin (1998), An Introduction to Stochastic Modelling, third
edition, San Diego, CA, Academic Press.
Teicher, H. (1961), “The Identifiability of Mixtures,” Annals of Mathematical Statistics,
32, 244–248.
Terza, J.V. (1985), “A Tobit-Type Estimator for the Censored Poisson Regression
Model,” Economics Letters, 18, 361–365.
Terza, J.V. (1998), “Estimating Count Data Models with Endogenous Switching: Sample
Selection and Endogenous Switching Effects,” Journal of Econometrics, 84, 129–139.
Terza, J.V., A. Basu, and P.J. Rathouz (2008), “Two-Stage Residual Inclusion Estimation: Addressing Endogeneity in Health Econometric Modeling,” Journal of Health
Economics, 27, 531–543.
Terza, J.V., and P.W. Wilson (1990), “Analyzing Frequencies of Several Types of Events:
A Mixed Multinomial-Poisson Approach,” Review of Economics and Statistics, 72,
108–115.
Thall, P.F., and S.C. Vail (1990), “Some Covariance Models for Longitudinal Count
Data with Overdispersion,” Biometrika, 46, 657–671.
Thompson, J., T. Palmer, and S. Moreno (2006), “Bayesian Analysis in Stata with
WinBUGS,” The Stata Journal, 6, 530–549.
Titterington, D.M., A.F. Smith, and U.E. Makov (1985), Statistical Analysis of Finite
Mixture Distributions, Chichester, John Wiley.
Trivedi, P.K., and M. Munkin (2010), “Recent Developments in Cross Section and Panel
Count Models,” in A. Ullah and D. Giles, eds., Handbook of Empirical Economics
and Finance, 87–131, Boca Rotan, FL, Francis and Taylor.
Trivedi, P.K., and D.M. Zimmer (2007), “Copula Modeling: An Introduction for Practitioners,” Foundations and Trends in Econometrics, 1, 1–110.
Tweedie, M.C.K. (1957), “Statistical Properties of Inverse Gaussian Distributions: I,”
Annals of Mathematical Statistics, 28, 362–377.
U.S. National Center for Health Statistics (1965), Health Interview Responses Compared
with Medical Records, Vital and Health Statistics Series 2, No. 7, Public Health
Service, Washington, DC, U.S. Government Printing Office.
U.S. National Center for Health Statistics (1967), Interview Data on Chronic Conditions Compared with Information Derived from Medical Records, Vital and Health

References

539

Statistics Series 2, No. 23, Public Health Service, Washington, DC, U.S. Government
Printing Office.
Van Duijn, M.A.J., and U. Böckenholt (1995), “Mixture Models for the Analysis of
Repeated Count Data,” Applied Statistics – Journal of the Royal Statistical Society
C, 44, 473–485.
Van Praag, B.M.S., and E.M. Vermeulen (1993), “A Count-Amount Model With Endogenous Recording of Observations,” Journal of Applied Econometrics, 8, 383–395.
Vose, D. (2008), Risk Analysis: A Quantitative Guide, edition 3, New York, John Wiley
Sons.
Vuong, Q.H. (1989), “Likelihood Ratio Tests for Model Selection and Non-Nested
Hypotheses,” Econometrica, 57, 307–333.
Wang, K., K.K.W. Yau, and A.H. Lee (2002), “A Hierarchical Poisson Mixture Regression Model to Analyze Maternity Length of Hospital Stay,” Statistics in Medicine,
21, 3639–3654.
Wang, P. (2003), “A Bivariate Zero-Inflated Negative Binomial Regression Model for
Count Data with Excess Zeros,” Economics Letters, 78, 373–378.
Watermann, J., R. Jankowski, and I. Madan (1994), “Under-Reporting of Needlestick
Injuries by Medical Students,” Journal of Hospital Infection, 26, 149.
Wedderburn, R.W.M. (1974), “Quasi-Likelihood Functions, Generalized Linear Models,
and the Gauss-Newton Method,” Biometrika, 61, 439–447.
Wedel, M., U. Bockenholt, and W.A. Kamakura (2003), “Factor Models for Multivariate
Count Data,” Journal of Multivariate Analysis, 87, 356–369.
Wedel, W., W.S. DeSarbo, J.R. Bult, and V. Ramaswamy (1993), “A Latent Class Poisson
Regression Model for Heterogeneous Count Data,” Journal of Applied Econometrics,
8, 397–411.
Weisberg, S., and A.H. Welsh (1994), “Adapting for the Missing Link,” Annals of
Statistics, 22, 1674–1700.
Weiss, A.A. (1999), “A Simultaneous Binary Choice/Count Model with an Application
to Credit Card Approvals,” in R.F. Engle and H. White, eds., Cointegration, Causality,
and Forecasting: A Festschrift in Honour of Clive W.J. Granger, ch. 18, Oxford,
Oxford University Press.
Weiss, C.H. (2008), “Serial Dependence and Regression of Poisson INARMA Models,”
Journal of Statistical Planning and Inference, 138, 2975–2990.
Wellner, J.A., and Y. Zhang (2007), “Two Likelihood-Based Semiparametric Estimation
Methods for Panel Count Data with Covariates,” Annals of Statistics, 35, 2106–2142.
West, M., and J. Harrison (1997), Bayesian Forecasting and Dynamic Models, edition
2, New York, Springer.
West, M., P.J. Harrison, and H.S. Migon (1985), “Dynamic Generalized Linear Models
and Bayesian Forecasting (with Discussion),” Journal of the American Statistical
Association, 80, 73–97.
White, H. (1980), “A Heteroskedasticity-Consistent Covariance Matrix Estimator and a
Direct Test for Heteroskedasticity,” Econometrica, 46, 817–838.
White, H. (1982), “Maximum Likelihood Estimation of Misspecified Models, Econometrica, 50, 1–25.
White, H. (1994), Estimation, Inference, and Specification Analysis, Cambridge, UK,
Cambridge University Press.
Whittemore, A.S., and G. Gong (1991), “Poisson Regression with Misclassified
Counts, Application to Cervical Cancer Mortality Rates,” Applied Statistics, 40, 81–
93.

540

References

Willmot, G.E. (1987), “The Poisson-Inverse Gaussian Distribution as an Alternative to
the Negative Binomial,” Scandinavian Actuarial Journal, 198, 113–127.
Williams, D.A. (1987), “Generalized Linear Model Diagnostics Using the Deviance and
Single Case Deletions,” Applied Statistics, 36, 181–191.
Windmeijer, F. (2000), “Moment Conditions for Fixed Effects Count Data Models with
Endogenous Regressors,” Economics Letters, 68, 21–24.
Windmeijer, F. (2002), “ExpEnd, A Gauss Programme for Non-Linear GMM Estimation
of Exponential Models with Endogenous Regressors for Cross Section and Panel
Data,” CEMMAP Working Paper No. CWP 14/02.
Windmeijer F. (2005), “A Finite Sample Correction for the Variance of Linear Efficient
Two-Step GMM estimators,” Journal of Econometrics, 126, 25–517.
Windmeijer, F. (2008), “GMM for Panel Count Data Models,” Advanced Studies in
Theoretical and Applied Econometrics, 46, 603–624.
Windmeijer, F.A.G., and J.M.C. Santos Silva (1997), “Endogeneity in Count Data Models; an Application to Demand for Health Care,” Journal of Applied Econometrics,
12, 281–294.
Winkelmann, R. (1995), “Duration Dependence and Dispersion in Count-Data Models,”
Journal of Business and Economic Statistics, 13, 467–474.
Winkelmann, R. (2004), “Health Care Reform and the Number of Doctor Visits – An
Econometric Analysis,” Journal of Applied Econometrics, 19, 455–472.
Winkelmann, R. (2006), “Reforming Health Care: Evidence from Quantile Regressions
for Counts,” Journal of Health Economics, 25, 131–145.
Winkelmann, R. (2008), Econometric Analysis of Count Data, edition 5, Berlin,
Germany, Springer-Verlag.
Winkelmann, R., and K.F. Zimmermann (1991), “A New Approach for Modeling Economic Count Data,” Economics Letters, 37, 139–143.
Winkelmann, R., and K.F. Zimmermann (1995), “Recent Developments in Count Data
Modelling: Theory and Application,” Journal of Economic Surveys, 9, 1–24.
Wong, W.H. (1986), “Theory of Partial Likelihood,” Annals of Statistics, 14, 88–123.
Wooldridge, J.M. (1990a), “A Unified Approach to Robust, Regression-Based Specification Tests,” Econometric Theory, 6, 17–43.
Wooldridge, J.M. (1990b), “An Encompassing Approach to Conditional Mean Tests
with Applications to Testing Nonlinear Hypotheses,” Journal of Econometrics, 45,
331–350.
Wooldridge, J.M. (1990c), “Distribution-Free Estimation of Some Nonlinear Panel Data
Models,” Working Paper No. 564, Department of Economics, Massachusetts Institute
of Technology.
Wooldridge, J.M. (1991a), “On the Application of Robust, Regression-Based Diagnostics to Models of Conditional Means and Conditional Variances,” Journal of
Econometrics, 47, 5–46.
Wooldridge, J.M. (1991b), “Specification Testing and Quasi-Maximum-Likelihood
Estimation,” Journal of Econometrics, 48, 29–55.
Wooldridge, J.M. (1997a), “Multiplicative Panel Data Models without the Strict Exogeneity Assumption,” Econometric Theory, 13, 667–679.
Wooldridge, J.M. (1997b), “Quasi-Likelihood Methods for Count Data,” in M.H.
Pesaran and P. Schmidt, eds., Handbook of Applied Econometrics, Volume II: Microeconometrics, Malden, MA, Blackwell Publishers.
Wooldridge, J.M. (2005), “Simple Solutions to the Initial Conditions Problem in
Dynamic, Nonlinear Panel Data Models with Unobserved Heterogeneity,” Journal of
Applied Econometrics, 20, 39–54.

References

541

Wooldridge, J.M. (2010), Econometric Analysis of Cross Section and Panel Data, edition
2, Cambridge, MA, MIT Press.
Wu, D. (1973), “Alternative Tests of Independence between Stochastic Regressors and
Disturbances,” Econometrica, 41, 733–750.
Xiang, L., K.K.W.Yau, Y. Van Hui, and A.H. Lee (2008), “Minimum Hellinger Distance
Estimation for k-Component Poisson Mixture with Random Effects,” Biometrics 64,
508–518.
Yannaros, N. (1993), “Analyzing Incomplete Count Data,” The Statistician, 42, 181–
187.
Yule, G.U. (1944), The Statistical Study of Literary Vocabulary, Cambridge: Cambridge
University Press.
Zeger, S.L. (1988), “A Regression Model for Time Series of Counts,” Biometrika, 75,
621–629.
Zeger, S.L., and K.-Y. Liang (1986), “Longitudinal Data Analysis for Discrete and
Continuous Outcomes,” Biometrics, 42, 121–130.
Zeger, S.L., K.-Y. Liang, and P.S. Albert (1988), “Models for Longitudinal Data: A
Generalized Estimating Equation Approach,” Biometrics, 44, 1049–1060.
Zeger, S.L., and Qaqish B. (1988), “Markov Regression Models for Time Series: A
Quasi-Likelihood Approach,” Biometrics, 44, 1019–1031.
Zhu, R., and H. Joe (2006), “Modeling Count Data Time Series with Markov Processes
Based on Binomial Thinning,” Journal of Time Series Analysis, 27, 725–738.
Ziegler, A. (2011), Generalized Estimating Equations, New York, Springer.
Ziegler, A., C. Kastner, and M. Blettner (1998), “The Generalized Estimating Equations:
An Annotated Bibliography,” Biometrical Journal, 40, 115–139.
Zimmer, D.M., and P.K. Trivedi (2006), “Using Trivariate Copulas to Model Sample
Selection and Treatment Effects,” Journal of Business and Economic Statistics, 24(1),
63–76.

Author Index

Abrevaya, J., and C.M. Dahl (2008), 435
Aitchison, J., and C. H. Ho (1989), 339
Aitken, M., and D. B. Rubin (1985), 147
Akaike, H. (1973), 196, 197
Alcaniz, M. (1996), 480, 499
Alfo, M., and G. Trovato (2004), 316
Allison P.D., R.P. Waterman (2002), 357,
358
Al-Osh, M. A., and A. A. Alzaid (1987),
285, 286, 287
Altman, N. S. (1992), 448
Alzaid, A.A., and M.A. Al-Osh (1988),
286
Alzaid, A. A., and M. A. Al-Osh (1990),
286
Alzaid, A.A., and M.A. Al-Osh (1993),
286
Amemiya, T. (1974), 45
Amemiya, T. (1984), 128
Amemiya, T. (1985), 61, 67, 219, 385,
410
Amemiya, Y. (1985), 174, 472
Andersen, E.B. (1970), 355
Andersen, P.K., O. Borgan, R.D. Gill,
and (1993), 8
Andrews, D.W.K. (1988a), 195, 222
Andrews, D.W.K. (1988b), 195, 222, 447
Arellano, M. (1987), 60
Arelleno, M., and S. Bond (1991), 368,
369, 383
Arnold, B. C., and D. J. Strauss (1988),
339
Arnold, B. C., and D. J. Strauss (1992),
339

Bago d’Uva, T. (2005), 379
Bago d’Uva, T. (2006), 381
Baltagi, B.H. (2008), 369, 383
Barlow, R. E., and F. Proschan (1965),
166
Barmby, T.A., C. Orme, and J.G. Treble
(1991), 488
Basu, A., and P.J. Rathouz (2005), 422,
425, 426
Ben-Moshe, D. (2011), 479
Berndt, E., B. Hall, R. Hall, and
J. Hausman (1974), 27
Besag, J. (1974), 160
Bishop, Y.M.M., S.E. Feinberg, and P.W.
Holland (1975), 8, 190
Blonigen, B. (1997), 365
Blundell, R., R. Griffith, and J. Van
Reenan (1995), 374
Blundell, R., R. Griffith, and J. Van
Reenan (1999), 354, 374
Blundell, R., R. Griffith, and F.
Windmeijer (2002), 281, 356, 368,
370, 373, 401
Blundell, R., and R.L. Matzkin (2010),
386
Blundell, R., and J. Powell (2003), 386
Böckenholt, U. (1999), 380
Böhning, D. (1995), 147, 175
Böhning, D., E. Dietz, R. Schaub, P.
Schlattmann, and (1994), 233
Böhning, D., and R. Kuhnert, (2006), 261
Bortkiewicz, L. von (1898), 1
Boswell, M. T., and G. P. Patil (1970),
119, 121, 176
543

544

Author Index

Bound, J., C. Brown, and N. Mathiowetz
(2001), 468
Boyer, B.H., M.S, Gibson, and M.
Loretan (1999), 307
Brännäs, K. (1992), 174
Brännäs, K. (1994), 271, 287
Brännäs, K. (1995a), 285, 287, 288, 302,
371
Brännäs, K. (1995b), 480
Brännäs, K., and J. Hellström (2001), 288
Brännäs, K., and P. Johansson (1994),
279, 290, 368
Brännäs, K., and P. Johansson (1996),
350
Brännäs, K., and G. Rosenqvist (1994),
175
Breslow, N. (1990), 223
Breusch, T.S., and A.R. Pagan (1979),
214
Bryk, A.S., and S.W. Raudenbush (2002),
175
Bu, R., B. McCabe, and K. Hadri (2008),
287, 302
Buonaccorsi, J.P. (1996), 477, 499
Buonaccorsi, J.P. (2010), 499
Burgette, J., A. R. Gallant, and G. Souza
(1982), 46
Buzas, J.S., and L.A. Stefanski, L. A.
(1996)
Cameron, A.C. (1991), 214
Cameron, A.C., J. Gelbach, and D.L.
Miller (2011), 59
Cameron, A. C., and P. Johansson (1997),
196, 199, 330, 415, 419
Cameron, A.C., and L. Leon (1993), 283
Cameron, A.C., T. Li, P.K. Trivedi, and
D. Zimmer (2004), 325, 496
Cameron, A.C., and D.L. Miller (2011),
59, 175
Cameron, A.C., and P.K. Trivedi (1985),
204, 211, 223
Cameron, A.C., and P.K. Trivedi (1986),
31, 76, 78, 83, 87, 109, 115, 118, 168,
203, 222
Cameron, A.C., and P.K. Trivedi (1990a),
204, 211, 223
Cameron, A.C., and P.K. Trivedi (1990b),
215, 217, 329, 330

Cameron, A.C., and P.K. Trivedi (1990c),
214
Cameron, A.C., and P.K. Trivedi (1990d),
218
Cameron, A.C., and P.K. Trivedi (1993),
216, 271, 329, 330, 332, 499
Cameron, A.C., and P.K. Trivedi (1996),
109, 174, 260
Cameron, A.C., and P.K. Trivedi (2005),
48, 52, 56, 61, 67, 98, 109, 389, 451,
467
Cameron, A.C., and P.K. Trivedi (2011),
109
Cameron, A.C., P.K. Trivedi, F. Milne,
and J. Piggott (1988), 12, 77, 317, 322
Cameron, A.C., and F.A.G. Windmeijer
(1996), 191, 192, 193, 222
Cameron, A.C., and F.A.G. Windmeijer
(1997), 191, 222
Campbell, M.J. (1994), 279
Carroll, R.J., D. Ruppert, L.A. Stefanski,
and (2006), 67, 473, 474, 499
Carroll, R.J., and L.A. Stefanski (1990)
474
Carroll, R.J., and L.A. Stefanski (1994),
473
Chamberlain, G. (1982), 363
Chamberlain, G. (1987), 44
Chamberlain, G. (1992a), 327, 339, 353,
372
Chamberlain, G. (1992b), 374
Chan, K.S., and J. Ledolter (1995), 281
Chang, F.-R., and P.K. Trivedi (2003),
142
Chen, T. T. (1979), 499
Chen, X. (2007), 448
Chen, X., H. Hong, and D. Nekipelov
(2011), 479, 499
Chernozhukov, V., and H. Hong (2003),
467
Cherubini, U., E. Luciano, and W.
Vecchiato (2004), 320
Chesher, A.D. (1984), 217
Chesher, A.D. (1991), 471, 499
Chesher, A.D. (2005), 386
Chesher, A,D., (2010), 386
Chesher, A.D., and M. Irish (1987), 181,
182
Chib, S. (2001), 456, 467

Author Index
Chib, S., E. Greenberg, and R.
Winkelmann (1998), 362, 462, 463
Chib, S., and R. Winkelmann (2001),
316, 463
Chiou, J.-M., and H.-G. Muller (1998),
431
Chiou, J.-M., and H.-G. Muller (2005),
431
Christmann, A. (1994), 488
Christmann, A. (1996), 488
Cincera, M. (1997), 375
Cochrane, W. G. (1940), 20
Cohen, A. C. (1960), 494
Collings, B.J., and B.H. Margolin (1985),
222
Conley, T.G. (1999), 60, 159
Conniffe, D.C. (1990), 207
Consul, P.C. (1989), 125
Consul, P. C., and F. Famoye (1992)
Consul, P.C., and G.C. Jain (1973),
125
Consul, P.C., and L.R. Shenton (1972),
420
Cont, R. (2001), 307
Cook, J.R., and L.A. Stefanski (1994),
474
Cowling, B. J., J.L. Hutton, and J.E.H.
Shaw (2006), 335
Cox, D. R. (1955), 113
Cox, D.R. (1961), 199
Cox, D.R. (1962a), 199
Cox, D.R. (1962b), 166
Cox, D.R. (1981), 264, 267
Cox, D.R. (1983), 204, 205, 223, 480,
482
Cox, D.R. and .A.W. Lewis (1966), 272,
302
Cox, D.R., and E.J. Snell (1968), 180,
183, 222
Cragg, J.G. (1971), 137
Cragg, J.C. (1997), 471
Cramer, H. (1946), 328
Creel, M.D., and J.B. Loomis (1990),
174, 368, 370
Crepon, B., and E. Duguet (1997a), 375
Crepon, B., and E. Duguet (1997b),
174
Crowder, M.J. (1976), 25
Crowder, M.J. (1987), 438, 439

545
Daley, D.J., and D. Vere-Jones (1988),
67, 126
Danaher, P.J. (2007), 305, 317
Davidson, R., and J.G. MacKinnon
(1984), 197
Davidson, R., and J.G. MacKinnon
(1993, 2004), 22, 27, 197
Davis, R.A., W.T.M. Dunsmuir, and S.B.
Streett (2003), 13, 284
Davis, R.A., W.T.M. Dunsmuir, and Y.
Wang (1999), 13, 278, 302
Davis, R.A., R. Wu (2009), 278, 302
Davison, A.C., and A. Gigli (1989), 182
Davison, A.C., and E.J. Snell (1991),
183, 222
Davutyan, N. (1989), 15, 271
Dean, C. (1991), 439, 440
Dean, C. (1992), 167, 206
Dean, C. B. (1993), 76
Dean, C.B. (1994), 76
Dean, C.B., and R. Balshaw (1997), 8
Dean, C. B., D. M. Eaves, C.J. Martinez
(1995), 76
Dean, C., and F. Lawless (1989a), 206,
223
Dean, C., and J. F. Lawless (1989b), 207,
439, 440
Dean, C., J. F. Lawless, and G.E. Willmot
(1989), 124, 440
Deb, P., M.K. Munkin, and P.K. Trivedi
(2006), 396, 397, 464, 465, 466
Deb, P., and P.K. Trivedi (1997), 175,
229, 232, 242, 244, 245
Deb, P., and P.K. Trivedi (2002), 12, 261
Deb, P., and P.K. Trivedi. (2006a), 394,
395, 396, 412
Deb, P., and P.K. Trivedi (2006b), 395
Deb, P., and P.K. Trivedi (2013), 379
Deb, P., P.K. Trivedi, and D.M. Zimmer
(2011), 323
Delgado, M.A. (1992), 327, 431
Delgado, M.A., and T.J. Kniesner (1997),
430, 431
Demidenko, E. (2007), 158
Denuit M., and P. Lambert (2005), 309,
310
Diggle, P.J., P. Heagerty, K.-Y. Liang.
and S.L. Zeger (2002), 311, 343, 362,
365, 371, 383

546

Author Index

Dionne, G., D. Desjardins, C.
Labergue-Nadeau, and (1995), 483,
499
Dionne, G., and C. Vanasse (1992), 15,
227, 260
Driscoll and Kraay (1998), 60
Dobbie, M.J., and A.H. Welsh (2001),
170
Drost, F.C., R. Van Den Akker, and
B.J.M. Werker (2008), 287
Drost, F.C., R. Van Den Akker, and
B.J.M. Werker (2009a), 287,
302
Drost, F.C., R. Van Den Akker, and
B.J.M. Werker (2009b), 287
Du, J.-G., and Y. Li (1991), 287
Duan, N. (1983), 104
Duarte, R. and J.J. Escario (2006), 340
Durbin, J. (1954), 219
Durbin, J., and S.J. Koopman (1997),
290
Durbin, J., and S.J. Koopman (2000),
289, 290, 302
Eagleson, G. K. (1964), 499
Eagleson, G. K. (1969), 499
Econometric Software Inc.189
Efron, B. (1979), 55
Efron, B. (1986), 169
Efron, B., and R.J. Tibshirani (1993), 55,
58, 223
Eggenberger, F., and G. Polya (1923), 1,
120, 162
Eicker, F. (1967), 30, 42
Embrechts, P., McNeil, A., and D.
Straumann (2002), 306, 308, 309
Enciso-Mora, V., P. Neal, and T.S. Rao
(2008a), 287, 302
Enciso-Mora, V., P. Neal, and T.S. Rao
(2008b), 287, 289, 302
Engle, R.F. and J.R. Russell (1998)
Englin, J., and J. S. Shonkwiler (1995),
409, 412
Everitt, B.S., and D.J. Hand (1981), 145
Fabbri, D., and C. Monfardini (2011),
396
Fahrmeier, L., and H. Kaufman (1987),
282

Fahrmeier, L., and G.T. Tutz (2001), 67,
283, 302, 339, 362, 365, 383
Famoye, F. (2010), 317
Fang, K.-T., and Y.-T. Zhang (1990),
306
Feinstein, J. S. (1989), 488, 493
Feller, W. (1943), 116, 162
Feller, W. (1968), 121, 491
Feller, W. (1971), 20, 174
Fe-Rodriguez, E. (2012), 128
Feng, Z.D., and C.E. McCulloch (1996),
152, 259
Ferguson, T.S. (1973), 467
Fienberg, S.E. (1981), 488
Firth, D. (1967), 439
Firth, D. (1991b), 222
Fleming, T.R., and D.P. Harrington
(1991), 8
Fokianos, F., A. Rahbek, and D.
Tjøstheim (2009), 284
Freeland, R.K., B.P.M. McCabe (2004),
302
Fruhwirth-Schnatter, S., (2001), 175
Fruhwirth-Schnatter, S., (2006), 290,
302
Frühwirth-Schnatter, S., and H. Wagner
(2006), 290, 302
Gallant, A.R., and D.W. Nychka (1987),
414
Gallant, A. R., and G. Tauchen (1989),
330, 415
Gan and Jiang (1999), 429
Gauthier, G. and A. Latour (1994), 286
Geil, P.A., A. Melion, R. Rotte, and
(1997), 231, 408
Gelfand, A.E., and S.R. Dalal (1990),
174, 237
Gelfand, A.E., and A.F.M. Smith (1990),
455
Gelman, A., J.B. Carlin, H.S. Stern, and
D.B. Rubin (2003), 467
Genest, C., and J. Neslehova, (2008),
320, 322
Geweke, J. (2003), 467
Geweke, J., and M. Keane (2001), 467
Gleser, L.J. (1990), 474
Godambe, V. P., and M. E. Thompson
(1989), 438, 439

Author Index
Godfrey, L.G. (1988), 271
Goffe, W. L., G.D. Ferrier, and J. Rogers
(1994), 418
Goldstein, H. (2010), 383
Good, D., and M. A. Pirog-Good (1989),
339
Gourieroux, C., and A. Monfort (1991),
174
Gourieroux, C., and A. Monfort (1995),
67, 222
Gourieroux, C., and A. Monfort (1997),
122
Gourieroux, C., A. Monfort, E. Renault,
and A. Trognon (1987a), 135, 181,
222
Gourieroux, C., A. Monfort, E. Renault,
and A. Trognon (1987b), 182, 222
Gourieroux, C., A. Monfort, and A.
Trognon (1984a), 2, 31, 33, 34, 35, 37,
76, 109
Gourieroux, C., A. Monfort, and A.
Trognon (1984b), 2, 76, 109, 115, 312,
327
Gourieroux, C., and M. Visser (1993),
175
Greene, W.H. (1994), 15, 389
Greene, W.H. (1997), 389
Greene, W. (2004), 354, 357, 358
Greene, W.H. (2007), 357, 393, 406,
412
Greene, W.H. (2009), 67, 412
Greene, W.H. (2011), 22, 109, 174, 389
Greenwood, M., and G. U. Yule (1920),
117, 162
Griffith, D.A., and R. Haining (2006),
160, 161
Grogger, J. (1990), 20, 271, 398, 399
Grogger, J.T., and R.T. Carson (1991),
174, 260
Guimarães, P. (2008), 357
Guo, J., and T. Li (2001), 477, 478, 499
Guo, J.Q., and T. Li (2002)., 472
Guo, J.Q., and P.K. Trivedi (2002), 124,
419
Gupta, C. R. (1974), 420
Gurmu, S. (1991), 130, 174, 202
Gurmu, S. (1993), 135, 174
Gurmu, S. (1997), 429
Gurmu, S., and J. Elder (2000), 327

547
Gurmu, S., P. Rilstone, and S. Stern
(1995), 481
Gurmu, S., P. Rilstone, and S. Stern
(1999), 427, 428, 429, 447
Gurmu, S., and P. K. Trivedi (1992), 129,
131, 174, 181, 202, 206, 508
Gurmu, S., and P.K. Trivedi (1993), 202,
330
Gurmu, S., and P.K. Trivedi (1994), 109
Gurmu, S., and P.K. Trivedi (1996), 245,
251, 260, 429
Haab, T. C., and K. E. McConnell (1996),
261
Haight, F. A. (1967), 20
Hall, A. (1987), 217
Hall, B.H., Griliches, Z., and J.A.
Hausman (1986), 154, 373, 374, 442
Hall, P.J., J. Racine, and Q. Li (2004), 437
Hamdan, M.A. (1972), 339
Hamilton, J.D. (1989), 154, 266
Hamilton, J.D. (1994), 67
Hannan, M.T., and J. Freeman (1987), 20
Hansen, L.P. (1982), 42, 46, 67
Hansen, L.P., J. Heaton, and A. Yaron
(1996), 48
Hardin, J.W., H. Schmiediche, and R.J.
Carroll (2003a), 497
Hardin, J.W., H. Schmiediche, and R.J.
Carroll (2003b), 497
Härdle, W., (1990), 448
Härdle, W., and O. Linton, (1994), 448
Härdle, W., and T.M. Stoker (1989), 422
Harvey, A.C. (1989), 302
Harvey, A.C., and C. Fernandes (1989),
289, 290
Harvey, A.C., and N. Shephard (1993),
290
Hastie, T. J., and R. J. Tibshirani (1990),
425, 448
Hausman, J.A. (1978), 219, 367
Hausmann, J.A., J. Abrevaya, and F M.
Scott-Morton (1998), 499
Hausman, J.A., B.H. Hall, and Z.
Griliches (1984), 2, 14, 19, 109, 154,
156, 355, 357, 358, 361, 362, 365, 367,
368, 442
Hausman, J.A., G. K. Leonard, and
D. McFadden (1995), 305, 334

548

Author Index

Hausman, J.A., A.W. Lo, and A.C.
MacKinlay (1992), 101
Hausman, J.A., W.K. Newey, and J.L.
Powell (1995), 473
Hayashi, F. (2000), 67
Hayfield, T, and J. Racine (2008), 509
Heckmann, J. J. (1976), 392
Heckman, J.J. (1978), 393
Heckman, J.J. (1981), 375, 376
Heckman, J.J. (1984), 195
Heckman, J.J., and R. Robb (1985), 412
Heckman, J., and B. Singer (1984), 127,
146, 147
Hellstrom, J. (2006), 316, 324, 340
Hendry, D. F. (1995), 67
Hill, S., Rothchild, D., and A.C.
Cameron, (1998), 375
Hinde, J. (1982), 123, 174
Holgate, P. (1970), 126
Holly, A. (1981), 219
Holly, A. (1987), 220
Honda, Y. (1988), 207
Hong, H., and E. Tamer (2003), 479
Horowitz, J.L. (1997), 55, 223
Hsiao, C. (1989), 477, 479
Hsiao, C. (2003), 345, 357, 365, 369, 383
Huber, P.J. (1967), 28, 42
Hyppolite, J., and P. K. Trivedi (2012),
293, 380
Ichimura, H. (1993), 422, 445
Ichimura and Todd (2007), 448
Imbens, G.W. (2002), 48
Imbens, G. W., and T. Lancaster (1994),
412
Jacobs, P.A., and P.A.W. Lewis (1977),
325
Jacobs, P.A., and P.A.W. Lewis (1978a),
294
Jacobs, P.A., and P.A.W. Lewis (1978b),
294, 494
Jacobs, P.A., and P.A.W. Lewis (1983),
294
Jaggia, S. (1991), 14, 272
Jaggia, S., and S. Thosar (1993), 184
Jeffries, N.O. (2003), 152
Jewel, N. (1982), 126
Joe, H. (1997), 319

Johansson, P (1995), 279
Johansson, P. (1996), 290
Johansson, P., and M. Palme (1996), 260,
488
Johnson, N. L., A.W. Kemp, and S. Kotz
(2005), 1, 20, 120, 125, 145, 170, 420,
448, 506
Johnson, N.L., and S. Kotz (1969), 128,
312
Johnson, N.L., S. Kotz, and N.
Balakrishnan (1994), 311, 314, 339
Jordan, P., D. Brubacher, S. Tsugane, and
(1997), 302, 478, 499
Jorgensen, B. (1987), 38, 169
Jorgensen, B. (1997), 39, 85, 169
Jorgenson, D.W. (1961), 20, 109
Jung, R.C., M. Kukuk, and R. Liesenfeld
(2006), 99, 280, 284, 294, 302
Jung, R.C., R. Liesenfeld, and J.-F.
Richard (2011), 298, 299, 301, 302,
463
Jung, C. J., and R. Winkelmann (1993),
313, 339
Jupp, P.E., and K.V. Mardia (1980), 313,
332
Kaiser, M., and N. Cressie (1997), 160
Kalbfleisch, J. and R. Prentice (1980,
2002), 164
Karlis, D., and I. Ntzoufras (2003), 324
Karlis, D., and E. Xekalaki, (1998), 153
Katz, L. (1963), 168
Keane, M.P., and D.E. Runkle (1992),
383
Kennan, J. (1985), 272, 273
Kianifard F., and P.P. Gallo (1995), 109
Kim, C-J., and C.R. Nelson (1999), 154
King, G. (1987a), 15, 20
King, G. (1987b), 20
King, G. (1989a), 313, 415
King, G. (1989b), 168, 340
Kingman, J. F. C. (1993), 4, 5, 18, 20,
113, 174
Kocherlakota, S., and K. Kocherlakota
(1993), 311, 313, 338, 339
Koenker, R. (1982), 211
Koop, G. (2003), 467
Koop, G., Poirier, D.J., and J.L. Tobias
(2007), 467

Author Index
Kotz, S., and N. L. Johnson (1982-89),
420
Laird, N. (1978), 146, 147
Lambert, D. (1992), 16, 141, 261
Lancaster, H.O. (1958), 499
Lancaster, H.O. (1963), 499
Lancaster, H.O. (1969), 328
Lancaster, T. (1990), 126, 127, 175
Lancaster, T. (1997), 354
Lancaster, T. (2004), 510
Landwehr, J.M., D. Pregibon, and A.C.
Shoemaker (1984), 182
Lawless, J.F. (1987), 90, 206
Lawless, J.F. (1995), 383
Lee, K.L., and D.R. Bell (2009), 463
Lee, L.-F. (1983), 394
Lee, L.-F. (1986), 201, 222
Lee, L.-F. (1996), 164, 175, 392
Lee, M.-L.T. (1996), 317
Lee, Y., and J.A. Nelder (1996), 144
Leon, L.F., and C.-L. Tsai, 283
Leroux, B.G. (1992), 233
Lewbel, A. (1997), 471
Lewis, P.A.W. (1985), 285
Li, C.-S., J.-C. Lu, J. Park, K. Kim, P. A.
Brinkley, and (1999), 316, 340
Li, Q., and J. Racine (2007), 423, 435,
437, 448
Li, Q., and J. Racine (2008), 432, 436
Li, T. (2000), 477, 478
Li, T. (2002), 479
Li, T., P.K. Trivedi, and J. Guo (2003), 8,
495
Li, W.K. (1991), 270, 283
Liang, K.-Y., and S. Zeger (1986), 39, 59,
350, 365
Liang K.-Y., S.L. Zeger, and B. Qaqish
(1992), 350
Lindeboom, M., and G.J. van den Berg
(1994), 314, 339
Lindsay, B.G. (1983), 146
Lindsay, B.G. (1995), 149, 151
Lindsay, B.G., and K. Roeder (1992),
236, 237
Lindsay, B.G., and M. Stewart (2008),
175
Lo, Y., N.R. Mendell, and D.R. Rubin
(2001), 152

549
Long, J. S. (1997), 16
Lourenco, O.D., and P.L. Ferreira (2005),
261
Lu, Z., Y.V. Hui, and A.H. Lee (2003),
153
Lu, M.Z., and G.E. Mizon (1996), 197
Lunn, D.J., A. Thomas, N. Best, and
D. Spiegelhalter (2000)
MacDonald, I.L., and W. Zucchini
(1997), 154, 291, 292, 293, 302
Machado, J.A.F. and J.M.C. Santos Silva
(2005), 433, 434
Maddala, G.S. (1983), 3, 101, 128
Mahajan, A. (2005), 479
Manski, C.F., and D. McFadden (1981),
409, 412
Marshall, A. (1996), 309
Marshall, A.W., and I. Olkin (1988), 313
Marshall, A. W., and I. Olkin (1990),
313
Mátyás, L. and P. Sevestre (2008), 383
Matzkin, R. (2007), 448
Matzkin, R.L. (2010), 386
Mayer, W.J., and W.F. Chappell (1992),
305, 339
McCabe, B.P.M., G.M. Martin, and
D. Harris (2011), 287, 302
McCallum, J., C. Raymond, and C.
McGilchrist (1995), 495
McCullagh, P. (1983), 67, 115
McCullagh, P. (1986), 189, 190
McCullagh, P., and J. A. Nelder (1983,
1989), 2, 28, 35, 38, 39, 67, 104, 109,
180, 183, 222, 356, 422
McFadden, D. (1974) and P.A. Ruud
(1994)
McGilchrist, C.A. (1994), 362
McKenzie, E. (1985), 287
McKenzie, E. (1986), 285, 286
McKenzie, E. (1988), 286
McLachlan, G. J., and K. E. Basford
(1988), 145
McLachlan, G., and D. Peel. (2000), 146,
175
McLeod, L. (2011), 448
McShane B.M., M. Adrian, E.T. Bradlow,
and (2008), 164
Meghir, C., and J-M Robin (1992), 340

550

Author Index

Melkersson, M., and D. Rooth (2000),
253, 254, 257, 495
Merkle, L., and K.F. Zimmermann
(1992), 438
Miles, D. (2001), 314
Min, Y., and A. Agresti (2005), 381
Miranda, A. (2006), 433, 448
Miranda, A. (2008), 254, 433, 448
Miranda, A. (2010), 253
Miravete, E.J. (2011), 305, 317
Mizon, G.E., and J.-F. Richard (1986),
197
Montalvo, J.G. (1997), 374
Moore, D.F. (1986), 115
Moran, P.A.P. (1971), 90
Morrison, D.G., and D.C. Schmittlein
(1988), 109
Moschopoulos, P., and J.G. Staniswalis
(1994), 339
Mukhopadhyay, K., and P. K. Trivedi
(1995), 492, 499
Mullahy, J. (1986), 136, 137, 138,
141
Mullahy, J. (1997a), 116, 174, 485
Mullahy, J. (1997b), 398, 399
Mundlak, Y. (1978), 363, 365
Munkin, M., and P.K. Trivedi (1999), 17,
314, 315, 316, 338
Murphy, K., and R. Topel (1985), 47, 52
Nagin, D.S., and K.C. Land (1993), 16,
20, 261
Nakamura, T. (1990), 476
Navarro, S. (2008), 401
Nail, R.M. (2000)
Nelder, J.A., and D. Pregibon (1987),
38
Nelder, J.A., and R.W.M. Wedderburn
(1972), 2, 35, 37, 67
Nelsen, R.B. (2006), 309, 319, 321
Newell, D.J. (1965), 135
Newey, W.K. (1984), 46, 47
Newey, W.K. (1985), 52
Newey, W. K. (1990a), 44, 46, 339
Newey, W.K. (1990b), 327
Newey, W.K. (1993), 44, 442, 448
Newey, W.K. (2001), 473, 479
Newey, W.K., and D. McFadden (1994),
26, 61, 67

Newey, W.K., and K.D. West (1987a),
60, 67
Newey, W.K., and K.D. West (1987b),
52, 279
Newey, W.K., and F. Windmeijer (2009),
373
Newhouse, J.P. (1993), 260
Newton, H.J., and N.J. Cox (2003), 499
Neyman, J. (1939), 162, 170
Neyman, J. (1965), 162, 341
Nguyen, T.T., A.K. Gupta, D.M. Nguyen
and (2007), 314
Nickell, S. (1981), 369
Noack, A. (1950), 420
Nylund, K.L., T. Asparouhov, and B.O.
Muthén (2007), 152
Ogaki, M. (1993), 67
Okoruwa, A.A., J.V. Terza, and H.O.
Nourse (1988), 135, 409
Olsen, M.K., and J.L. Schafer (2001), 380
Ord, J., and Whitmore, G. (1986), 123
Owen, A.B. (1988), 47
Ozuna, T., and I. Gomaz (1995), 13, 245,
247
Pagan, A.R. (1986), 47
Pagan, A.R., and A. Ullah (1999), 423,
448
Pagan, A.R., and F. Vella (1989), 52, 67
Page, M. (1995), 365, 366
Palmgren, J. (1981), 355
Papadapoulos, G., and J.M.C. Santos
Silva (2008), 488, 492
Patil, G. P. (1970), 11, 20
Patil, S. A., D.I. Patel, and J.L. Kovner
(1977), 339
Patton, A. (2006), 318
Pesaran, M.H. (1987), 196
Pierce, D. (1982), 47
Pierce, D.A., and D.W. Schafer (1986),
184
Pinquet, J. (1997), 366
Pohlmeier, W., and V. Ulrich (1995), 139,
231, 260
Poisson, S.-D. (1837), 1
Pope, A., J. Schwartz, and M. Ransom
(1992), 271
Pregibon, D. (1980), 422

Author Index
Pregibon, D. (1981), 183, 222
Press, W.H., S.A. Teukolsky, W.T.
Vetterling, and (2008), 123
Pudney, S. (1989), 3, 253, 410
Qin, J., and J. Lawless (1994), 48
Rabe-Hesketh, S., A. Skrondal, and A.
Pickles (2003), 497
Ramaswamy, V., E. N. Anderson and
W. S. DeSarbo (1994), 261
Ridout, M.S. and P. Besbeas (2004), 169
Robert, C. P. (1996), 175
Robert, C. P., and G. Casella (1996), 467
Robinson, P.M. (1987a), 73
Robinson, P. M. (1987b), 326
Robinson, P.M. (1988), 423
Ronning, G., and R.C. Jung (1992), 287
Rose, N. (1990), 260
Ross, S. M. (1996), 164
Ruser, J.W. (1991), 365, 488
Santos Silva, J.M.C. (1997), 412
Santos Silva, J.M.C., and F. Covas
(2000), 257
Santos Silva, J.M.C., and S. Tenreyro
(2006), 104
Santos Silva, J.M.C., and F. Windmeijer
(2001), 120, 260
Sargan, J.D. (1958), 45
Sarmanov, O. V. (1966), 317
Savani, V., and A.A. Zhigljavsky (2007),
287
Scallan, A., R. Gilchrist, and M. Green
(1984), 422
Schall, R. (1991), 362
Schennach, S. (2005), 479
Schmidt, P., and A. Witte (1989), 137
Schneider, A.L. (1981), 488
Schwartz, E.S., and W.N. Torous (1993),
260
Schwarz, G. (1978), 415
Schweizer, B., and A. Sklar (1983), 322
Scott, S.L. (2002), 293
Sellar, C., J.R. Stoll, and J.P. Chavas
(1985), 246
Severini, T.A., and J.G. Staniswalis
(1994), 424
Shaban, S.A. (1988), 125

551
Shaked, M. (1980), 117, 171, 174
Shaw, D. (1988), 409, 410
Shephard, N. (1995), 261
Shephard, N., and M.K. Pitt (1997),
290
Shiba, T., and H. Tsurumi (1988),
332
Shklyar, S., and H. Schneeweiss (2005),
478
Sichel, H.S. (1971), 123
Sichel, H.S. (1974), 123
Sichel, H.S. (1975), 123
Singh, A.C., and G.R. Roberts (1992),
290
Skellam, J.G. (1946), 324
Sklar, A. (1973), 318
Skrondal, A., and S. Rabe-Hesketh
(2004), 115, 144, 175, 362
Smith, M.S., and M.A. Khaled (2010),
322
Smith, R.J. (1997), 442
Smyth, G.K. (1989), 38
Solow, A.R. (1993), 488, 491
Staniswalis, J. (1989), 424
Stefanski, L.A. (1989), 476
Stefanski, L.A., and J.S. Buzas (1995),
475
Stefanski, L. A., and R.J. Carroll (1987),
475, 476
Steutel, F.W., and K. Van Harn (1979),
285
Stewart, M. (2007), 376
Stroud, A.H., and D. Secrest (1966), 123
Stukel, T. (1988), 141
Szu, H., and R. Hartley (1987), 418
Tauchen, G. (1985), 52, 195
Taylor, H.M., and S. Karlin (1994), 3, 6,
20
Teicher, H. (1961), 125
Terza, J.V. (1985), 133, 135
Terza, J.V. (1998), 389, 393, 394, 412
Terza, J.V., A. Basu, and P.J. Rathouz
(2008), 402, 412
Terza, J.V., and P.W. Wilson (1990), 305,
334
Thall, P.F., and S.C. Vail (1990), 350
Thompson, J., T. Palmer, and S. Moreno
(2006), 510

552

Author Index

Titterington, D.M., A.F. Smith and U.E.
Makov (1985), 145
Trivedi, P.K., and M. Munkin (2010),
109
Trivedi, P.K., and D.M. Zimmer (2007),
319, 320, 321, 322, 340
Tweedie, M. C. K. (1957), 124
U.S. National Center for Health Statistics
(1967), 495
Van Duijn, M.A.J., and U. Böckenholt
(1995), 366
Van Praag, B.M.S., and E.M. Vermeulen
(1993), 335
Vose, D. (2008), 128
Vuong, Q.H. (1989), 152, 196, 198, 199,
222
Wang, K., K.K.W. Yau, and A.H. Lee
(2002), 142
Wang, P. (2003), 340
Watermann, J., R. Jankowski, and I.
Madan (1994), 488
Wedderburn, R.W.M. (1974), 67
Wedel, M., U. Bockenholt, and W.A.
Kamakura (2003), 147
Wedel, W., W.S. DeSarbo, J.R. Bult, and
(1993), 147, 175
Weisberg, S., and A.H. Welsh (1994),
423, 431
Weiss, A.A. (1999), 394
Weiss, C.H. (2008), 288, 302
J.A. Wellner, and Y. Zhang, 368
West, M., and J. Harrison (1997), 266,
289, 302
West, M., P.J. Harrison and H.S. Migon
(1985), 289
White, H. (1980), 30, 42, 415
White, H. (1982), 28, 42, 54
White, H. (1994), 52, 197,
223
Whittemore, A.S., and G. Gong (1991),
486, 487, 499
Willmot, G.E. (1987), 124
Williams, D.A. (1987), 183
Windmeijer F. (2000), 378
Windmeijer, F. (2002), 509

Windmeijer F. (2005), 373
Windmeijer, F. (2008), 373
Windmeijer, F.A.G., and J. M. C. Santos
Silva (1997), 387, 397, 398, 400,
412
Winkelmann, R. (1995), 109, 164, 165,
166
Winkelmann, R. (2004), 12, 123, 139,
174, 380
Winkelmann, R. (2006), 12, 433, 434,
448
Winkelmann, R. (2008), 109, 174
Winkelmann, R., and K.F. Zimmermann
(1991), 168
Winkelmann, R., and K.F. Zimmermann
(1995), 109, 168, 174
Wong, W.H. (1986), 282
Wooldridge, J.M. (1990a)
Wooldridge, J.M. (1990b), 197
Wooldridge, J.M. (1990c), 353
Wooldridge, J.M. (1991a), 223
Wooldridge, J.M. (1991b), 223
Wooldridge, J.M. (1997a), 372, 412
Wooldridge, J.M. (1997b), 109
Wooldridge, J.M. (2005), 375, 376
Wooldridge, J.M. (2010), 52, 61, 67, 109,
383, 389
Wu, D. (1973), 219
Xiang, L., K.K.W.Yau, Y. Van Hui, and
A.H. Lee (2008), 153
Yannaros, N. (1993), 488
Yule, G.U. (1994), 1, 123
Zeger, S.L. (1988), 264, 276, 279, 290,
302
Zeger, S.L., and K.-Y. Liang (1986),
350
Zeger, S.L., K.-Y. Liang, and P.S. Albert
(1988), 350
Zeger, S.L., and Qaqish B. (1988), 281,
283, 302
Zhu, R., and H. Joe (2006), 302
Ziegler, A. (2011), 67
Ziegler, A., C. Kastner, and M. Blettner
(1998), 67
Zimmer and Trivedi (2006), 319, 322

Subject Index

acronyms, 501–504
adaptive estimation, 429
algorithm, see iterative methods
applications to count data
asthma counts, 13
completed fertility, 13, 253–257
doctor visits, 11–12, 77–80, 86–88, 91,
95–97, 105–107
emergency room visits, 336–338
health insurance endogenous, 402–406
hospitalization, 336–338
office visits to physician, 228–245
patents awarded, 14, 154–156,
358–359, 363–364, 376, 442–446
recreational trips, 13, 245–253
stock trades, 298–301
strikes, 272–276, 295–298
takeover bids, 14, 184–188, 195–196,
199–200
attenuation bias, 470, 472
autocorrelation function, 270
autocorrelation tests, 270–271, 275–276,
278, 295–301, 301–302, 367–368
autoregressive conditional Poisson (ACP)
model, 284
autoregressive (AR) model
count, 267, 281–284, 295–301
linear, 265
longitudinal count data, 368
autoregressive moving average (ARMA)
model
discrete (DARMA), 267, 294–295
integer (INARMA), 267, 284–289,
295–301

linear, 264–265
auxiliary regression
for chi-square goodness-of-fit test, 194
for CM test, 54, 67, 208
for independence test, 331
for LM test, 50
for overdispersion test, 90, 202–204
versus regression-based CM test, 211,
212
bandwidth, 436
baseline density, see series expansion
Bayes factor, 452
Bayesian credible region, 452
Bayesian methods, 449–467
count models, 460–467
finite mixtures, 123
measurement error, 478
longitudinal data, 462–463
Poisson models, 453–454
time series data, 266, 281, 289, 293 see
also MCMC
beta distribution, 290
between variation, 343, 362
binary outcome, 99–100
endogenous regressor, 386
in hurdle model, 137
in sample selection model, 393, 394
repeated events, 228
binary Poisson, 99, 105
binomial distribution, 4, 5, 102, 285
as LEF member, 32, 217
binomial-stopped Poisson, 8–9, 167, 228,
498

553

554

Subject Index

binomial thinning operator, 285, 286,
480, 486
bivariate distribution
binomial, 489
exponential class, 313
generalized exponential family, 313
negative binomial, 313–314, 336–338
normal, 390
Poisson, 286, 311–313, 338
bootstrap, 55–58
asymptotically pivotal statistic, 57
asymptotic refinement, 57–58
bias correction, 58
clustered, 56
confidence intervals, 56, 57, 58
and Edgeworth expansion, 57
for finite mixtures model, 152
LR test, 259
pairs, 55, 74, 79
panel, 348
parametric, 56
percentile method, 58
percentile-t method, 57
residual, 56
standard errors, 56
two-step estimator, 56
Wald test, 56, 57
Box-Pierce statistic, 270
censored data, 130, 133–135
durations, 8
negative binomial, 133
Poisson, 134–135
Poisson-gamma polynomial, 429
see also sample selection; truncated
data
chi-square goodness-of-fit test, 193–196,
234
applications of, 195–196, 234
auxiliary regression for, 194
simulations, 258
classification error, 470, 479, 486–487
see also measurement error
cluster dependence
cluster fixed effects, 159–160
correlated error, 157–158
cluster robust inference, see robust
inference
coefficient interpretation, 92–97

application, doctor visits, 95–97
elasticity, 95
for indicator variable, 93
for interactive variables, 95
for logarithmic regressor, 95
in finite mixtures model, 240–242
in hurdle model, 243–244
in individual effects model, 346
in quantile count regression, 434
marginal effects, 92–93
semi-elasticity, 94, 472
semi-standardized, 93
treatment effects, 93–94
cointegration, 265
common shock model, 310
comonotonic, 308
complementary log-log model, 99
complete model, 388
compound Poisson, 115–119, 121–125,
170, 498
concordance, 307
conditional analysis
with longitudinal data, 345
conditional moment (CM) tests, 52–55,
66–67, 207–220
auxiliary regression for, 54, 67, 208
for exclusion of regressors in mean,
208
for serial correlation, 270–271,
301–302, 367–368
goodness-of-fit test, 193–196, 234, 258
Hausman test, 219–220, 367
independence tests, 327–333, 336
information matrix test, 54, 217–219
of proportion of zeros, 247–248
OPG form, 54, 194
orthogonal polynomial tests, 215–217,
330–333
overdispersion tests, 209, 209–212,
220–222
regression-based, 212–214
versus classical hypothesis tests, 55
conditional score estimator, 475
conditional time series models, 268
conditionally correlated random effects,
345, 363, 364, 376
confidence intervals
bootstrap, 56, 57, 58
delta method, 52, 56, 97–98

Subject Index
likelihood ratio, 27
conjugate density, 115, 289, 360–362
consistency, 24, 63, 64, 354
contagion
apparent, 1, 121, 161–162
in longitudinal data, 366
negative binomial as, 120–121
true, 1, 120–121, 161–162
urn model for, 120–121
continuous updating estimator, 48
control function, 401–402, 404, 405
see also endogeneity
convergence
in distribution, 24, 62
in probability, 24, 61
convolutions, 125, 311
see also mixtures
copulas, 308, 317–325
application, simulated data, 320
Clayton, 319
definition, 318
for difference in counts, 324–325
discrete, 321–322
Frank, 319
Gaussian, 319
Gumbel, 319
hurdle example, 323–324
survival Clayton, 319
see also dependence; Sklar’s theorem
corrected score estimator, 476–477
correlated binomial model, 120, 167,
287
correlated Poisson model, 167
correlated shocks model, 310
counting process
definition, 5, 162
martingale theory for, 5
point process, see point process
Poisson process, see Poisson process
renewal process, 162–163
stationary, 5
count data applications, see applications
to count data
count data models
behavioral interpretation, 228
fully parametric versus conditional
mean, 226–227
cross-sectional dependence, 156–161
cross-validation, 437

555
data augmentation, 459–460, 462
data density, 449
data generating process (dgp), 24, 26
deconvolution, 479
Delaporte distribution, 128
delta method, 52, 97–98
versus bootstrap, 56
dependence
asymmetric, 307, 320
cross sectional, 156–161, 159–160
measures, 305–310, 320
parameter for copula, 318, 320
positive quadrant, 309
spatial, 158–159, 160–161
tail, 320
see also cluster dependence;
multivariate data; time series data
detection control estimator, 493
deviance
residual, 179
R-squared, 191–192
scaled, 190
statistic, 190–191
difference in counts model, 324–325
digamma function, 505
directional gradient, 236
discrete ARMA (DARMA) model, 267,
294–295
discrete outcome model, 98–101, 105
dispersion parameter, 74
distributed lag models, 265, 269
distributions, 506–508
double exponential family, 38, 169
double-index models, 492
double Poisson distribution, 169–170,
202
doubly stochastic Poisson, 113
dummy endogenous variables model, 393
duration data
censored, 8
dependence in, 161–167, 272
exponential distribution for, 6–7,
107–108
gamma distribution for, 7
overdispersion and, 166–167
Weibull distribution for, 164
see also waiting time models
dynamic models, see time series data;
longitudinal data

556

Subject Index

dynamic longitudinal models, 368–378
application, 376
finite mixtures, 380
fixed effects, 371–375, 382–383
inconsistency, 369
initial condition, 376
population-averaged, 370–371
random effects, 375–376
serial correlation tests, 368, 373
see also time series data
empirical likelihood, 47–48
endogeneity, 220, 378, 385–412
application, 402–406
definition of endogenous regressor, 388
Hausman test for, 220, 367
moment-based estimation, 397–402
semiparametric estimation, 386
see also control functions; IV;
recursive models; selection models
equidispersion, 4, 23
errors-in-variables model, 470–471
see also measurement errors
estimating equations (EE), 40–42, 61–63,
65, 77, 438–440
optimal, 439
quadratic estimating equations (QEE),
438, 442
see also GEE; GMM; moment-based
estimation
estimation theory, 21–48, 61–65
see also EE; flexible estimation; GEE;
GMM; IV; least squares; ML;
variance matrix estimation
examples of count data, 11–17
see also applications to count data
excess zeros, 116, 136–141
see also hurdle models; zero-inflated
models
exogeneity,
strict, 347
weak, 371
expectation maximization (EM)
algorithm, 135, 149–150, 153, 293,
379
exponential dispersion model, 38
exponential distribution, 6, 163–164
LEF member, 32, 361
versus Poisson, 107

exponential family, 32, 171
exponential feedback, 281, 284
exponential feedback model (EFM), 370
exponential mean function, 71
exposure, 3, 10, 95
measurement error in, 479–485
extreme value distribution, 164
finite mixtures model, 125, 144–156, 232
applications, 255–257, 233–242,
154–156, 250–251
boundary solution, 256
component means, 238
component probabilities, 239
diagnostics, 236–237
general mixture model, 125
hurdle model and, 136
latent class model and, 147–149, 244
longitudinal data, 366, 379–380
marginal effects, 241–242
minimum distance estimation,
153–154
number of components, 151–152,
233–236, 259
sensitivity to outliers, 153, 240
zero-inflated model and, 140
see also hidden Markov model
first difference model, 344
fixed effects, 351–359
application, 358–359
Bayesian model, 463
dynamic models, 371–375
finite mixtures model, 379–380
linear model, 344
marginal effects, 346
moment-based model, 352–353
multiplicative, 346, 352
negative binomial model, 357–358
Poisson model, 352–357, 381–382
quasi-differencing transformation for,
352, 372
time-specific effects, 365, 344
with time-invariant regressors, 365
versus random effects, 364–365,
366–367
flexible estimation, 413–448
application, 442–446
definition of, 413
efficient moment-based, 438

Subject Index
of conditional mean, 421–425, 431
of conditional variance, 425–432
using series expansions, 414–421
see also kernel; nonparametric;
semiparametric; quantile
forecasting, 268, 281, 287, 270, 289
gamma distribution, 7, 118, 165–166,
174, 360, 507
alternative parameterization, 507
as LEF member, 32, 361, 217
gamma function, 118, 505
Gaussian distribution, see normal
distribution
Gaussian quadrature, 123, 391
generalized additive models, 425
generalized estimating equations (GEE),
39–40
longitudinal, 350, 365
multivariate, 326
time series, 279
generalized event count (GEC) model,
168
generalized exponential family, 313
generalized linear autoregressive moving
average (GLARMA) model, 284
generalized linear latent and mixed
(GLAMM) models, 362, 497, 478
generalized linear mixed (GLMM)
models, 311
generalized linear models (GLM), 2,
29–40, 35–39, 64
goodness-of-fit, 188–191
longitudinal data, 356, 371
Poisson, 76–77
residuals for, 178–180
semiparametric estimation, 431–432
time series data, 283, 290, 281
versus LEFN, 37
see also GMM
generalized method of moments (GMM)
estimation, 42–47, 65, 350, 353,
368, 371, 372–375, 378, 397–401,
404, 405, 440–442
hypothesis tests for, 52
identification, 42
longitudinal data, 347–348
optimal, 44–45, 65, 440, 446
optimal instruments, 399

557
optimal weighting matrix, 43
time series data, 279, 288
two-step, 43, 373
versus estimating equations, 42
see also IV
generalized partially linear models,
423–424
generalized Poisson distribution,
170–171, 286
generalized power series distributions,
420
geometric distribution, 506
as LEF member, 32
Gibbs sampler, 454, 455, 459
goodness-of-fit, 188–196
chi-squared test, 193–196, 195–196,
234, 258
deviance statistic, 190–191
Pearson chi-square test, 195
Pearson statistic, 189–190
pseudo R-squared, 191–193
gradient function, 236
G-squared statistic, 190
Hausman test, see CM test
hazard function, 165
Hellinger distance, 153
heterogeneity
additive, 127, 398–399, 400
misspecification of, 127
multiplicative form for, 113–119, 346,
399–401, 481, 484
unobserved correlated, 315, 327
unobserved individual, 113–119, 217,
314, 426
versus true contagion, 121
heteroskedasticity robust inference, see
robust inference
hidden Markov model, 266, 267,
291–293
hierarchical models, 142–144, 454
three-level, 143
two-level, 142
hurdle model, 136–139, 172, 232,
380–381, 390
application, 242–244, 251–253,
256
bivariate, 316, 323–324
correlated components, 139

558

Subject Index

hurdle model (cont.)
endogenous regressor, 407
finite mixture model interpretation,
136
marginal effects, 243–244
selection, 406
see also two-part model
hyperparameter, 142
hypothesis tests, 48–58
at boundary value, 90, 151, 233
encompassing, 197
finite-sample corrections for, 206–207,
57–58
of independence, 327–333, 336
likelihood ratio (LR), 49–50, 198, 233,
257–259
Lagrange multiplier (LM), 49
of nonnested models, 198–200,
233–236
of overdispersion, 89–91, 200–207,
220–222
of serial correlation, 270–271,
275–276, 278, 295–301, 301–302
Wald, 49–52, 56, 57
see also bootstrap, CM tests, robust
inference
identification
GMM estimator, 42
ML estimator, 25
measurement error models, 471, 477,
479, 488, 492
mixture models, 125–126, 151–152
recursive models, 386, 387
sample selection models, 395
incidental parameters problem, 354, 355,
357
incomplete gamma function, 166, 505
independence tests, 327–333
application, 336
individual specific effects, see fixed
effects; random effects
information
Fisher, 388
full, 26
generalized information matrix
equality, 54
limited, 388
matrix equality, 26, 63
information criteria, 152, 197

application, 199–200, 233–236
Akaike (AIC), 197
Bayesian (BIC), 197, 415
consistent Akaike (CAIC), 197
definitions of, 197
Kullback-Liebler (KLIC)198
simulation, 258
information matrix test, see CM tests
instrumental variables (IV) estimation,
45–46
approximate, 475, 497
in measurement error models,
472–473
nonlinear (NLIV), 46, 378, 397–401,
497
optimal, 399
two-stage least squares (2sLS), 46
see also endogeneity, GMM
integer ARMA (INARMA) model, 267,
284–289, 295–301
integration
Gaussian quadrature, 123
Monte Carlo, 122
numerical, 123
intensity parameter, 3, 9
interval-recorded counts,
inverse Gaussian distribution, 124,
507
iterative methods, see EM; method of
scoring; Newton-Raphson;
simulated annealing; reweighted
least squares
jacknife, 56, 348
jittering, 433
Katz family, 167–168
LM test of Poisson against, 200–202,
220–221
Kendall’s rank correlation coefficient,
307, 320
kernel methods, 435–437
application, 442–446
density estimation, 435
for discrete variables, 437
kernel function, 435
regression, 436
Kullback-Liebler
divergence, 192
information criteria, 198

Subject Index
lagged dependent variables, 269, 271
inconsistency if serially correlated
error, 269, 271
see also dynamic longitudinal; time
series
Lagrange multiplier (LM) test
against Katz, 200–202, 220–221
against local alternatives, 204,
221–222
against negative binomial, 91, 202
auxiliary regression for, 50, 90, 202–204
definition of, 49
Laplace approximation, 144
Laplace transform, 173–174
latent class model, 147–149
latent factor models, 299–301, 315–316
see also finite mixtures
latent variable, 9, 101
law of rare events, 5
least squares estimation
conditional, 287
generalized (GLS), 29, 30
in transformed models, 102–104
nonlinear (NLS), 104–105, 105, 392,
393
nonlinear for time series data, 265,
268, 282, 288, 297
nonlinear two-stage (N2SLS), 46
ordinary (OLS), 23, 29, 102–103, 105,
343
semiparametric, 423
semiparametric generalized (SGLS),
327
semiparametric nonlinear weighted,
429–431
two-stage (2sLS), 46
weighted (WLS), 30–31
likelihood
complete data, 148
concentrated, 27, 354
conditional, 28
empirical, 48
expected, 135
function, 25
hierarchical, 144
log-likelihood function, 25
marginal, 28, 450
maximum, see ML estimation
penalized, 233
profile, 27

559
quasilikelihood (QL), 39
ratio index, 192
simulated, 122
weighted, 409
likelihood ratio (LR) test, see hypothesis
tests
linear exponential family (LEF), 31–39,
64
canonical parameterization, 36–38
mean parameterization, 31–34
members of, 32, 216–217
modified power series distribution,
420
nuisance parameter (LEFN), 34–35,
36–38, 64
quadratic variance function
(LEF-QVF), 216–217
versus GLM, 37
see also GLM
linear feedback, 283, 370
link function, 36
canonical, 36, 76, 356, 418
Ljung-Box statistic, 270
local linear estimator, 436
logarithmic series distribution, 119, 420,
506
logistic distribution, 3–4, 492
logit model, 99, 138, 288
log-likelihood, see likelihood
loglinear model, 10, 38, 71
lognormal distribution, 121, 507
longitudinal data, 341–384, 376, 363–364
application, 358–359
applications summary, 365–366
count models summary, 345–347
dynamic, 368–378
endogenous regressors, 378
hurdle model, 380–381
linear, 343–345
panel robust inference, 347, 349, 353
see also dynamic longitudinal; fixed
effects; population-averaged;
random effects
marginal analysis
for longitudinal data, 345
in mixture models, 11, 115
marginal distribution
marginal effects, 92–97, 98
at mean (MEM), 93

560

Subject Index

marginal effects (cont.)
at representative value (MER), 93
average (AME), 92, 472
in finite mixtures model, 241–242
in hurdle model, 243–244
in individual effects model, 346, 350
see also coefficient interpretation
marginal time series models, 268, 277
Markov chain model, 154, 292, 455
count model example, 460–467
Poisson regression example, 456–458
Markov chain Monte Carlo (MCMC),
289, 290, 362, 397, 454–460
see also Bayesian
Markov model, see autoregressive model
matrix
derivative, 24
hat, 183
Hessian, 26
information, 26, 54
notation, 19–20
vech operator, 55
weighting, 42
working, 30–31, 39
maximum likelihood (ML) estimation,
24–29, 26–29, 63–64, 351
conditional, 355–357
constrained, see restricted
estimator (MLE), 26–27
identification, 25, 125–126
log-likelihood function for, 25
misspecified density, 28–29
pseudo-, see quasiquasi- (QMLE), 28–29, 38, 64, 72–76
QMLE for time series, 268–269
QMLE for longitudinal, 349
quasi-generalized PMLE (QGPMLE),
35, 38, 64
regularity conditions for, 25–26, 28,
63, 151–152, 168, 171
restricted, 49
seminonparametric, 414
semiparametric, 149, 427
simulated, 122–123, 280, 391, 395
weighted, 409
see also likelihood
measurement error, 468–500
additive error, 469
application to simulated data, 496–498

Berkson error, 470, 481–483, 484
classical, 469
consequences, 471–472
in counts, 485–496
in exposure, 479–485
in regressors, 469–479, 484–485
nonclassical, 470, 479
nondifferential, 470
nonparametric methods, 478–479
overreported counts, 494–496
proxy variables, 470, 483
structural methods, 477–478
underreported counts, 488–496
see also classification error
Meixner class, 217, 329
method of moments, 40
see also EE; GMM
method of scoring algorithm, 108
Metropolis algorithm, 456–458
Metropolis-Hastings algorithm, 458–459
misspecification
of density, 28–29, 64
of mean in GLM or LEF, 29
of variance in GLM or LEF, 29
mixed count-continuous model, 335–336
mixed multinomial logit (MMNL)
model, 394
mixture models, 112–128, 426–429
binomial, 167
Dirichlet process, 467
double Poisson, 169–170
exponential, 236
finite, 144–156
hierarchical models, 142–144
identification of, 125–126, 151–152
longitudinal, 364
multivariate, 311–317, 317
negative binomial, 117–119
see also finite mixtures; Poisson
mixtures
model discrimination, see nonnested
models
modified count models, 136–141,
172–173, 250–253
modified power series distributions,
419–421
moment-based estimation, 40–48, 65, 77,
325–327, 352–353, 397–402,
438–442

Subject Index

561

see also EE, GEE, GMM
moment-based testing, see CM tests
moment generating function (mgf), 4,
506
moments, 505–508
central, 4, 172–173
finite mixtures model, 145
Poisson, 4
raw, 4, 172–173
truncated negative binomial, 129
truncated Poisson, 130, 507
Monte Carlo integration, 122
see also MCMC
multilevel models, see hierarchical
multinomial logit model, 100, 334, 355,
356, 379
multinomial model, 4, 100–101, 228,
333–335, 355
multiplicative effects, 346, 349, 352
multivariate data, 304–340
application, 336–338
Bayesian, 463
bivariate hurdle, 323–324
bivariate negative binomial, 313–314,
322–323, 336–338
bivariate Poisson, 311–313, 338
copula-based models, 317–325
dependence measures, 305–310
mixed multivariate models, 333–336
mixture models, 311–317
moment-based models, 325–327
seemingly unrelated nonlinear
regressions, 325–327, 336–338
series expansion models, 328–330
tests of independence, 327–333, 336
time series, 299–301
see also bivariate distributions;
dependence
multivariate negative binomial
distribution, 314

definitions of, 81, 506
LEFN member, 35, 217
Poisson as special case, 85
properties of, 117–121
truncated, 129–133, 412
negative binomial regression model,
80–89, 231
applications, 86–88, 248–250, 257
fixed effects, 357–358
NB-logistic model, 492
NB1 GLM estimator, 84
NB1 ML estimator, 83–84
NB1 model, 83–84
NB2 ML estimator, 81–82
NB2 model, 81–83, 84–85, 439
NB2 QGPML estimator, 82–83
random effects, 361
simulation, 88–89
time series, 276, 278, 287, 282, 290
negative binomial polynomial model,
419, 444
negative hypergeometric distribution, 357
negative multinomial distribution, 314
Newton-Raphson algorithm, 71, 108,
150, 151
Neyman contagious distribution, 170
nonnested models, 196–200
application, 199–200, 233–236
simulation, 257–259
nonparametric methods, 182, 435–437
application, 442–446
conditional density estimation,
436–437, 444
conditional mean estimation, 435–436,
445
for measurement error, 478
see also kernel; nearest neighbors
normal distribution
LEF member, 32, 217
nuisance parameter, 27, 36

NB1 variance function, 74–76, 115
NB2 variance function, 74–76, 115
nearest neighbor estimator, 429, 435
negative binomial distribution
alternative parameterizations, 119,
506, 507
bivariate, 313–314, 336–338
characterization, 117–121, 164

observation-driven model, 265, 267, 281
on-site surveys, 409
ordered logit model, 101
ordered probit model, 9, 101, 106
application, 256
dynamic, 267, 293–294
orthogonal polynomials, 327–333
definition of, 215, 328

562

Subject Index

orthogonal polynomials (cont.)
independence tests based on, 330–333
LEF-QVF, 329
multivariate expansions, 329–330, 414
semiparametric estimation, 414, 427
specification tests based on, 215–217
unobserved heterogeneity, 426
see also polynomials
orthonormal polynomials
definition of, 215, 328, 331, 332
outer-product-of-the-gradient (OPG), 26,
54
outlying counts, 178, 487
overdispersion
definition of, 4
duration dependence and, 166–167
interpretation of, 91, 114–115,
overdispersion tests, 89–91, 200–207,
220–222
application, doctor visits, 91, 247
auxiliary regression, 90, 202–204
LM test against double Poisson, 202
LM test against Katz, 200–202,
220–221
LM test against local alternatives,
204–205, 221–222
LM test against negative binomial, 91,
202
LR test, 90
regression-based CM tests, 209–212
small-sample corrections, 206–207
Wald test, 90
overidentification, 42, 46
overidentifying restrictions (OIR) test, 44
panel data, see longitudinal data
panel robust, see robust inference
parameter-driven model, 264, 267, 281
Pascal distribution, 506
Pearson
chi-square test, 195
product moment correlation
coefficient, 306
residual, 179
R-squared, 193
statistic, 189–190
point process, see counting process,
Poisson process
Poisson distribution

bivariate, 286, 311–313, 338
censored, 134–135
characterizations, 3–9, 164
compound, 115–119, 170
definition of, 3, 506
LEF member, 32, 217
properties of, 3–9
truncated, 129–133, 181, 202, 206, 411
Poisson INAR(1s) model, 286–289,
295–301, 297
Poisson mixture models, 11, 115–119,
121–125
Poisson-binomial, 8, 492
Poisson-gamma, 117–119, 361, 453,
454
Poisson-gamma polynomial model,
426–429
Poisson-inverse Gaussian, 123–125
Poisson-lognormal, 121–123, 142,
280, 362, 454, 461
Poisson-multinomial, 334
Poisson-normal, 122
time series, 280, 290, 291–292
Poisson polynomial model, 417–418
Poisson process, 5–9, 9, 20, 161, 487, 490
nonhomogeneous, 272
Poisson regression model, 9–11, 22–23,
27, 71–80
application, 80, 95–97, 255–257
conditional MLE, 355–357
conditionally correlated effects, 363
dummy variables model, 355
EE estimator, 77
fixed effects, 352–357, 381–382
GLM estimator, 76–77, 84
ML estimator, 71–72
QML estimator, 34, 72–76, 105
QMLE with Poisson variance function,
72, 75
QMLE with NB1 variance function,
75
QMLE with NB2 variance function,
75
QMLE with unspecified variance
function, 73–74
QMLE for time series data, 268–269,
273, 278–279, 282
QMLE for longitudinal data, 349–350
random effects, 361

Subject Index
simulation, 88–89
versus exponential, 107
Poisson-stopped log series distribution,
167
Polya distribution, 120–121
polynomials
generalized Laguerre, 427
Gram-Charlier, 215
see also orthogonal polynomials
pooled, see population-averaged
population-averaged analysis, 349–351
application, 358–359
dynamic, 370–371
fully parametric, 351
linear, 343
multiplicative effects, 349
Poisson GEE, 350
Poisson QMLE, 349–350
posterior density, 449–450, 451–452,
454, 460
posterior odds ratio, 452
posterior probability, 148, 244
power series distribution, 420
predetermined regressors, 371
prediction, 97–98
actual value, 97
conditional mean, 97, 227
conditional probability, 98, 227
prior density, 450–451
improper, 451
informative, 450
Jeffrey’s, 451
uninformative, 450
probability generating function (pgf), 8,
285, 314, 329, 498, 506
probability limit, 24
probit model, 99, 323
proportional hazard model
pseudo-ML estimator, see QMLE
pseudo R-squared, 191–193
application, 195–196
deviance, 193
Pearson, 193
squared correlation coefficient, 193
versus likelihood ratio index, 192
pseudo-true value, 24
quantile count regression, 432–435
quasidifferencing, 352, 372

563
quasilikelihood (QL), 39
extended, 38, 438
quasi maximum likelihood estimator
(QMLE), 28–29, 33, 361, 72–76
see also ML estimator, Poisson QML
estimator
random coefficients model, 345, 362–363
random effects, 360–364
application, 363–364
Bayesian model, 462
conditionally correlated, 363, 376
dynamic, 375–376
Gaussian, 362, 365
linear model, 344
moment-based methods, 360
multiplicative, 346
negative binomial model, 361
Poisson model, 361
versus fixed effects, 364–365, 366–367
random intercept model, 146
random utility, 228, 334
recursive models, 386–388
identification
regime-shift model, see hidden Markov
model
regression-based CM tests, 212–214
of overdispersion, 209–212
regression calibration estimator, 474, 497
regularity conditions, 25–26, 28, 63
renewal
function, 163
process, 20, 162–163
replicated data, 471, 473
residual
adjusted deviance, 184
Anscombe, 180
deviance, 179
for Poisson, 178–181
generalized, 180
Pearson, 179
raw, 179
simulated, 182
small sample corrected, 183–184
studentized deviance, 183
studentized Pearson, 183
residual analysis, 178–188
application, 184–188
influential observations, 183

564

Subject Index

residual analysis (cont.)
normal scores plots, 182
outliers, 178
plots, 181–182
serial correlation tests, 270–271,
275–276
robust estimation, 488
robust inference, 58–61
cluster robust, 59, 56, 348
for GMM, 60–61
for Poisson, 73–74
heteroskedastic and autocorrelation
(HAC), 60, 269
heteroskedastic robust, 42, 59
panel robust, 60, 347–348, 353
spatial robust, 60
Roy model, 396, 464–466
R-squared, see pseudo R-squared
sampling, 407–412
choice-based, 408
endogenous stratified, 409–412
exogenous, 408
on-site, 409–412
random, 407
stratified, 408
Sarmanov models, 317
score test, 50, see also LM test
seemingly unrelated nonlinear regression,
313, 325, 336–338
selection models, 388–397
binary regressors, 393–396
fully parametric, 389–392
partially parametric, 392–393
sample selection, 128, 389
selection bias model, 389–393
self-selection, 395
seminonparametric ML estimation, 414
semiparametric
efficiency bounds, 353
estimation, 326–327, 421–425
estimation with endogeneity, 386
GLS estimation, 327
ML estimation in finite mixtures
model, 149
sequential conditional probability model,
256–257
serial correlation tests, 270–271, 278,
301–302

application, 275–276, 295–301
for panel data, 367–368
serially correlated error model, 264, 267,
276–281
series distributions,
generalized power series, 420
modified power series, 419–421
power series, 420
versus LEF, 420
series expansion, 414–421
around baseline density, 328–330,
414–421
around heterogeneity density, 426–429
negative binomial polynomial model,
419, 434
Poisson polynomial model, 417–418
Poisson-gamma polynomial model,
426–429
see also polynomials
short panel, 343, 365
see also longitudinal
simulated annealing iterative method, 418
simulated maximum likelihood,
122–123, 280, 391, 395
simulation analysis
for mismeasured regressor, 496–498
for model selection criteria, 257–259
for Poisson and NB estimators, 88–89
simulation extrapolation (SIMEX)
estimator, 474, 497
simultaneity, see endogeneity; selection
single-index model, 94, 422, 446
Sklar’s theorem, 318
software, 509–510
spatial dependence
spatial error, 158–159
spatial lag, 160–161
Spearman’s rank correlation coefficient,
307
spells, 119, 162, 260
standard error, see variance matrix
estimation
state-space models, 266, 267, 289–290
static time series model, 265, 268–276
stochastic autoregressive mean (SAM)
model, 280
structural model, 387
switching regressions model, 396–397,
464–466

Subject Index
tail dependence, 308
tests, see CM tests; hypothesis tests;
overdispersion tests
time series data, 263–303
application, 272–276, 295, 298–301
autoregressive models,
281–284
conditional versus marginal models,
268
count models summary, 267–268
dynamic ordered probit model,
293–294
hidden Markov models, 291–293
integer-valued ARMA models,
284–289
linear models, 264–266
seasonality, 272, 299
serially correlated error model,
276–281
state space models, 289–290
static models, 268–276
trends, 272, 278, 287
time-varying parameter model, see
state-space model
Tobit model, 128, 135
transformation, 102–104
application, 105–107
Box-Cox, 421, 425
Chamberlain, 372
logarithmic, 103–104
mean-scaling, 373
square-root, 104
Wooldridge, 372
transition model, see dynamic
longitudinal model
treatment effects, 93–94, 466
average (ATE), 94
average on the treated (ATET), 94
endogenous, 394
triangular model, see recursive model
trivariate reduction, 311, 338
truncated data, 128–133, 172
negative binomial, 129–133, 412
Poisson, 129–133, 411, 507–508
with misspecified density, 133
see also censored data; sample
selection
Two Crossings Theorem, 117, 171–172,
236

565
two-part model, 136–139
with endogeneity, 406
with selection, 406
see also hurdle model, zero-inflated
model
two-stage least squares (2SLS) estimator,
46
two-stage residual inclusion, see control
function
two-step estimation
Heckman, 392
sequential, 46–47
uncentered R-squared, 50
underdispersion, 4, 168
see also overdispersion
unit roots, 265, 287
urn model, 120–121
variance function, 74–76
NB1s (linear), 74, 115
NB2s (quadratic), 74, 115
variance matrix estimation
bootstrap, 56, 74, 79
BHHH, 27
cluster robust, 348
delta method, 52
Eicker-White, 42
Fisher information, 26
GLM, 76
Hessian, 26, 72
Huber, 42
Newey-West, 60, 269
outer product (OP), 26, 72
panel robust, 347–348
robust sandwich, 29, 29, 41
robust sandwich for Poisson, 73–74,
269
sandwich form, 24, 27
working, 30–31, 39, 279
varying dispersion model, 38
waiting time models, 6–8, 161–167,
173–174
exponential, 163–164
for counts, 163–166
gamma, 7, 164–166, 174
Weibull, 164
see also duration data

566

Subject Index

Weibull distribution, 164
weighted chisquared distribution, 199
with zeros model, 140
within variation, 344, 362
without zeros model
see also truncated data

zero inflated model, 139–141, 173, 390,
494
application, 251–253, 256
as finite mixtures model, 140
longitudinal, 380–381
multivariate, 316

Other titles in the series (continued from page iii)
Eric Ghysels, Norman R. Swanson, and Mark Watson, Editors, Essays in econometrics: Collected
papers of Clive W. J. Granger (Volume I), 9780521772976, 9780521774963
Eric Ghysels, Norman R. Swanson, and Mark Watson, Editors, Essays in econometrics: Collected
papers of Clive W. J. Granger (Volume II), 9780521792073, 9780521796491
Cheng Hsiao, Analysis of panel data, second edition, 9780521818551, 9780521522717
Mathias Dewatripont, Lars Peter Hansen, and Stephen J. Turnovsky, Editors, Advances in
economics and econometrics – Eighth World Congress (Volume I), 9780521818728,
9780521524117
Mathias Dewatripont, Lars Peter Hansen, and Stephen J. Turnovsky, Editors, Advances in
economics and econometrics – Eighth World Congress (Volume II), 9780521818735,
9780521524124
Mathias Dewatripont, Lars Peter Hansen, and Stephen J. Turnovsky, Editors, Advances in
economics and econometrics – Eighth World Congress (Volume III), 9780521818742,
9780521524131
Roger Koenker, Quantile regression, 9780521845731, 9780521608275
Charles Blackorby, Walter Bossert, and David Donaldson, Population issues in social choice
theory, welfare economics, and ethics, 9780521825511, 9780521532587
John E. Roemer, Democracy, education, and equality, 9780521846653, 9780521609135
Richard Blundell, Whitney K. Newey, and Thorsten Persson, Editors, Advances in economics and
econometrics – Ninth World Congress (Volume I), 9780521871525, 9780521692083
Richard Blundell, Whitney K. Newey, and Thorsten Persson, Editors, Advances in economics and
econometrics – Ninth World Congress (Volume II), 9780521871532, 9780521692090
Richard Blundell, Whitney K. Newey, and Thorsten Persson, Editors, Advances in economics and
econometrics – Ninth World Congress (Volume III), 9780521871549, 9780521692106
Fernando Vega-Redondo, Complex social networks, 9780521857406, 9780521674096
Itzhak Gilboa, Theory of decision under uncertainty, 9780521517324, 9780521741231
Krislert Samphantharak and Robert M. Townsend, Households as corporate firms: An analysis of
household finance using integrated household surveys and corporate financial accounting,
9780521195829, 9780521124164
Rakesh Vohra, Mechanism design: A linear programming approach, 9781107004368,
9780521179461
Daron Acemoglu, Manuel Arellano, and Eddie Dekel, Editors, Advances in economics and
econometrics – Tenth World Congress (Volume I), 9781107016040, 9781107638105
Daron Acemoglu, Manuel Arellano, and Eddie Dekel, Editors, Advances in economics and
econometrics – Tenth World Congress (Volume II), 9781107016057, 9781107674165
Daron Acemoglu, Manuel Arellano, and Eddie Dekel, Editors, Advances in economics and
econometrics – Tenth World Congress (Volume III), 9781107016064, 9781107627314
Andrew Harvey, Dynamic models for volatility and heavy tails: With applications to financial and
economic time series, 9781107034723/ 9781107630024

