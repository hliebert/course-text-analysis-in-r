Submitted to the Annals of Statistics
arXiv: arXiv:0000.0000

EFFICIENT NONPARAMETRIC ESTIMATION OF
CAUSAL MEDIATION EFFECTS

arXiv:1601.03501v1 [stat.ME] 14 Jan 2016

By K.C.G. Chan† , K. Imai‡ , S.C.P. Yam§ , and Z. Zhang¶
University of Washington† , Princeton University‡ ,
The Chinese University of Hong Kong§ , The University of Hong Kong¶
An essential goal of program evaluation and scientific research is
the investigation of causal mechanisms. Over the past several decades,
causal mediation analysis has been used in medical and social sciences
to decompose the treatment effect into the natural direct and indirect
effects. However, all of the existing mediation analysis methods rely
on parametric modeling assumptions in one way or another, typically
requiring researchers to specify multiple regression models involving
the treatment, mediator, outcome, and pre-treatment confounders.
To overcome this limitation, we propose a novel nonparametric estimation method for causal mediation analysis that eliminates the
need for applied researchers to model multiple conditional distributions. The proposed method balances a certain set of empirical moments between the treatment and control groups by weighting each
observation; in particular, we establish that the proposed estimator
is globally semiparametric efficient. We also show how to consistently
estimate the asymptotic variance of the proposed estimator without
additional efforts. Finally, we extend the proposed method to other
relevant settings including the causal mediation analysis with multiple mediators.

1. Introduction. In program evaluation and scientific research, an essential goal is to understand why and how a treatment variable influences the
outcomes of interest, going beyond the estimation of the average treatment
effects. In this regard, causal mediation analysis plays an important role
in the investigation of causal mechanisms by decomposing the treatment effect into the natural direct and indirect effects (Robins and Greenland, 1992;
∗
K.C.G. Chan thanks the United States National Institutes of Health for support (R01
HL122212, R01 AI121259) ; Kosuke Imai thanks the United States National Science Foundation for support (SES–0918968); Phillip Yam acknowledges the financial support from
the Hong Kong RGC GRF 14301015, and Direct Grant for Research 2014/15 with project
code: 4053141 offered by CUHK; Zheng Zhang acknowledges the financial support from
the Chinese University of Hong Kong and the University of Hong Kong; the present work
constitutes part of his research study leading to his Ph.D thesis in the Chinese University
of Hong Kong.
MSC 2010 subject classifications: Primary 60K35, 60K35; secondary 60K35
Keywords and phrases: Exponential tilting, Natural direct effects, Natural indirect effects, Treatment effects, Semiparametric efficiency

1

2

K.C.G. CHAN, K. IMAI, S.C.P. YAM, AND Z. ZHANG

Pearl, 2001; Robins, 2003). Such an approach has been widely used in a number of disciplines in medical and social sciences (see e.g., Baron and Kenny,
1986; Imai et al., 2011; MacKinnon, 2008; VanderWeele, 2015). The methodological literature on causal mediation analysis has also rapidly grown over
the last decade and produced numerous approaches and extensions (see, for
example, Albert, 2008; Geneletti, 2007; Imai, Keele and Yamamoto, 2010;
Jo, 2008; Joffe et al., 2007; Sobel, 2008; Ten Have et al., 2007; Tchetgen Tchetgen and Shpitser,
2012; VanderWeele, 2009; VanderWeele and Vansteelandt, 2010).
In this article, we here contribute to this fast growing literature by developing a new efficient nonparametric estimation method for causal mediation
analysis. All of the existing mediation analysis methods rely on parametric
modeling assumptions in one way or another, typically requiring researchers
to specify multiple regression models involving the treatment T , mediator M , outcome Y , and pre-treatment confounders X. For example, the
standard approach based on the so called “mediation formula” require the
specification of two or three conditional distributions, i.e. fY |M,T,X , fM |T,X ,
and possibly fT |X (for example, Imai, Keele and Tingley, 2010; Pearl, 2012;
VanderWeele, 2009). Inference under this standard approach is only valid
when both the outcome model fY |M,T,X and the mediator model fM |T,X are
correctly specified. Our proposed method eliminates the need for applied
researchers to model these multiple conditional distributions a priori.
We are inspired by the recent work of Tchetgen Tchetgen and Shpitser
(2012) who develop a robust semiparametric estimation procedure to allow
for possible model misspecification. The authors show that their proposed
estimator is consistent when any two out of three chosen models are correctly
specified and is locally semiparametric efficient whenever all three models
are correct. While this estimator represents an important advance in the literature, its validity still relies upon the correct specification of multiple parametric or semiparametric models. We improve this estimator by proposing a
globally semiparametric efficient estimator that attains the semiparametric
efficiency bound, derived by Tchetgen Tchetgen and Shpitser (2012), without imposing the additional structural assumptions required for the existing
semiparametric estimator. To the best of our knowledge, no globally semiparametric efficient estimator has been proposed in the causal mediation
literature.
Our proposed estimator is based on a strategy of balancing covariates
by weighting each observation, which has recently become popular when estimating the average treatment effects (for example, Chan, Yam and Zhang,
2015; Hainmueller, 2012; Graham, Pinto and Egel, 2012; Imai and Ratkovic,
2014). We combine this idea with the construction of globally semiparamet-

NONPARAMETRIC ESTIMATION OF CAUSAL MEDIATION EFFECTS

3

ric efficient estimation of the average treatment effects (see, Chen, Hong and Tarozzi,
2008; Hahn, 1998; Hirano, Imbens and Ridder, 2003; Imbens, Newey and Ridder,
2005). Unlike these plugin-type globally semiparametric efficient estimators
that require semi-parametric estimation of the propensity score or the outcome regression function, we adopt the nonparametric calibration approach
developed by Chan, Yam and Zhang (2015) that constructs observationspecific weights only from covariate balancing conditions. This is a significant advantage in causal mediation analysis because the plugin-type globally
semiparametric estimators would require the semi-parametric estimation of
three conditional distributions, which is a difficult task in practice yielding
more doubt on the robustness of the estimators.
The rest of the paper is organized as follows. In Section 2, we describe the
proposed estimation method, which matches the certain moment conditions
of the mediator and pre-treatment covariates between the treatment and
control groups. We then show how to consistently estimate the asymptotic
variance of the proposed estimator without additional functional estimation.
In Section 3, we extend our method to the case of multiple mediators studied in Imai and Yamamoto (2013). We then discuss two related estimation
problems, namely the estimation of pure indirect effects and natural direct
effect of the untreated. Finally, we apply the proposed methods to two data
sets in Section 4 and offer concluding remarks in Section 5.
2. The Proposed Methodology. In this section, we first consider the
efficient nonparametric estimation of the average natural direct and indirect effects. In Theorem 1, we shall show that the proposed nonparametric
estimator is consistent, asymptotically normal, and globally semiparametric efficient. We then demonstrate how to nonparametrically estimate the
asymptotic variance of the proposed estimator.
2.1. The framework. Suppose that we have a binary treatment variable
T ∈ {0, 1}. Under the standard framework of causal inference, we let M (t)
denote a potential mediating variable, which represents the value of the mediator if the treatment variable is equal to t ∈ {0, 1}. Similarly, let Y (t, m)
represent the potential outcome variable under the scenario where the treatment and mediator variables take the value t and m, respectively. Then, the
observed mediator M is given by M = T M (1) + (1 − T )M (0) whereas the
observed outcome is equal to Y = T Y (1, M (1)) + (1 − T )Y (0, M (0)). We
assume that we have a simple random sample of size N from a population and therefore observe the i.i.d. realizations of these random variables,
{Ti , Mi , Yi , Xi }N
i=1 where X is a vector of pretreatment covariates.

4

K.C.G. CHAN, K. IMAI, S.C.P. YAM, AND Z. ZHANG

A primary goal of causal mediation analysis is the following decomposition of the average treatment effect into the average natural indirect effect
(or average causal mediation effect) and the average natural direct effect
(Robins and Greenland, 1992; Pearl, 2001; Robins, 2003)
(2.1)

E[Y (1, M (1)) − Y (0, M (0))]

= E[Y (1, M (1)) − Y (1, M (0))] + E[Y (1, M (0)) − Y (0, M (0))]

The average natural indirect effect, which is the first term in this equation, is
the average difference between the potential outcome under the treatment
condition and the counterfactual outcome under the treatment condition
where the mediator is equal to the value that would have realized under the
control condition. This quantity represents the average difference that would
result if the mediator value changes from M (0) to M (1) while holding the
treatment variable constant at T = 1. In contrast, the average natural direct
effect, which is the second term in equation (2.1), represents the average
treatment effect when the mediator is held constant at M (0). Therefore,
this decomposition enables researchers to explore how much of the treatment
effect is due to the change in the mediator.
Note that the following alternative decomposition for causal mediation
analysis is also possible,
(2.2)

E[Y (1, M (1)) − Y (0, M (0))]

= E[Y (0, M (1)) − Y (0, M (0))] + E[Y (1, M (1)) − Y (0, M (1))]

where the treatment variable is held constant at T = 0 for the natural indirect effect and the mediator is fixed at M (1) for the natural direct effect.
Robins (2003) called this version of the natural indirect effect as the pure indirect effect while referring the natural indirect effect given in equation (2.1)
as the total indirect effect since it is resulted from both treatment and mediator. Our proposed estimator is applicable to both cases as the difference
between the two decompositions solely depends on the value at which the
treatment is fixed.
To nonparametrically identify the average natural direct and indirect effects, we rely on the following set of assumptions as in Imai, Keele and Tingley
(2010) and Tchetgen Tchetgen and Shpitser (2012).
Assumption 1.
1. (Consistency) If T = t, then M = M (t) with probability 1 for t ∈
{0, 1}. If T = t and M = m, then Y = Y (t, m) with probability 1 for
t ∈ {0, 1} and m ∈ M, where M is the support of the distribution of
M.

NONPARAMETRIC ESTIMATION OF CAUSAL MEDIATION EFFECTS

5

2. (Sequential Ignorability) Given X, {Y (t′ , m), M (t)} is independent of
T for t, t′ ∈ {0, 1}. Also, given T = t and X, Y (t′ , m) is independent
of M (t) for t, t′ ∈ {0, 1} and m ∈ M.
3. (Positivity) With probability 1 with respect to any (t, x) where t ∈
{0, 1} and x ∈ X , fM |T,X (m | t, x) > 0 for all m ∈ M where X
is the support of X. With probability 1 with respect to any x ∈ X ,
fT |X (t | x) > 0 for all t ∈ {0, 1}.
The sequential ignorability assumption is a natural extension of the unconfoundedness assumption for the identification of the average treatment effect except that it requires the “cross-world” independence between Y (t′ , m)
and M (t) (see, Richardson and Robins, 2013). Several researchers have proposed different sensitivity analysis techniques for estimating the bias that
arises when this assumption is violated (see, Imai, Keele and Yamamoto,
2010; VanderWeele, 2010; Tchetgen Tchetgen and Shpitser, 2012). Under
Assumption 1, Imai, Keele and Yamamoto (2010) showed that the average
natural direct and indirect effects are nonparametrically identified. That is,
θt = E(Y (1 − t, M (t)))
Z Z
=
E(Y | T = 1 − t, M = m, X = x)fM |T,X (m | T = t, X = x)fX (x)dxdm
and
δt = E(Y (t, M (t))) =

Z

E(Y | T = t, X = x)fX (x)dx

for t = 0, 1.
Tchetgen Tchetgen and Shpitser (2012) made an important theoretical
advance by showing that under Assumption 1 the efficient influence function
of θt is given by,
S θt

=

1{T = 1 − t}fM |T,X (M | T = t, X)
{Y − E(Y | X, M, T = 1 − t)}
fT |X (1 − t | X)fM |T,X (M | T = 1 − t, X)
1{T = t}
+
{E(Y | X, M, T = 1 − t) − η(1 − t, t, X)} + η(1 − t, t, X) − θt
fT |X (t | X)

(2.3)
where
′

η(t, t , X) =

Z

E(Y | X, M = m, T = t)fM |T,X (m | T = t′ , X)dm

6

K.C.G. CHAN, K. IMAI, S.C.P. YAM, AND Z. ZHANG

for t, t′ ∈ {0, 1}. Hence, the definition of η implies that η(1, 1, X) = E(Y |
X, T = 1) and η(0, 0, X) = E(Y | X, T = 0).
Furthermore, the efficient influence functions of the average natural direct effect when t = 0, i.e., NDE = θ0 − δ0 , and the average natural indirect
effect when t = 1 (or the average total indirect effect), i.e., NIE = δ1 − θ0 ,
are SNDE = Sθ0 − Sδ0 and SNIE = Sδ1 − Sθ0 , respectively, where Sδ1 and Sδ0
are the efficient influence functions for estimating δ1 and δ0 . As shown in
Robins, Rotnitzky and Zhao (1994) and Hahn (1998), these efficient influence functions are given by,
(2.4)

Sδt =

1{T = t}
{Y − E(Y | X, T = t)} + E(Y | X, T = t) − δt ,
fT |X (t | X)

for t = 0, 1. Similarly, the average natural indirect effect when t = 0 (or the
pure indirect effect) is given by PIE = θ1 − δ0 and its efficient function is
equal to Sθ1 − Sδ0 . Therefore, the efficient estimations of the natural direct
and indirect effects involve the efficient estimation of δt and θt for t = 0, 1.
2.2. Efficient estimation of δ1 and δ0 . Before proposing a globally semiparametric efficient estimator of θ0 , which is one of the main contributions of
our paper, we discuss the efficient estimation of δ1 and δ0 , which is required
for the efficient estimation of the natural direct and indirect effects. There exists an extensive literature on the globally efficient estimation of δ0 and δ1 in
econometrics (see, for example, Chen, Hong and Tarozzi, 2008; Hahn, 1998;
Hirano, Imbens and Ridder, 2003; Imbens, Newey and Ridder, 2005). However, many of these existing estimators require the semi-parametric estimation of propensity score or outcome regression model. In this paper, we focus
on a globally efficient estimator recently proposed by Chan, Yam and Zhang
(2015), which serves as a building block of our proposed estimator of θ0 discussed below. Unlike the other estimators, this approach achieves the efficient nonparametric estimation by balancing covariates through weighting.
Let p0 (x) , N1 fT |X (1 | x)−1 and q0 (x) , N1 fT |X (0 | x)−1 . Under Assumption 1, for any suitable integrable functions u(x), the following important
moment conditions hold,
!
N
X
(2.5)
δ1 = E
Ti p0 (Xi )Yi
(2.6)

δ0 = E

i=1
N
X
i=1

(1 − Ti )q0 (Xi )Yi

!

NONPARAMETRIC ESTIMATION OF CAUSAL MEDIATION EFFECTS
N
X

E(u(X)) = E

(2.7)

Ti p0 (Xi )u(Xi )

i=1
N
X

E(u(X)) = E

(2.8)

i=1

!

7

!

(1 − Ti )q0 (Xi )u(Xi )

The first two equalities represent the inverse-probability-weighting (IPW)
estimators of the average potential outcomes. A number of scholars have
exploited the covariate balance conditions in equations (2.7) and (2.8) in order to estimate the average treatment effects (e.g., Chan and Yam, 2014;
Han and Wang, 2013; Imai and Ratkovic, 2014; Graham, Pinto and Egel,
2012; Qin and Zhang, 2007). These existing estimators are locally semiparametric efficient, yet all of these rely on parametric models in one way or
another.
Our goal is, however, to develop a globally fully nonparametric efficient estimator. Thus, we utilize the nonparametric estimator proposed by Chan, Yam and Zhang
(2015). Let D(v, v ′ ) be a distance measure for v, v ′ ∈ R. That is, we assume that D(v, v ′ ) is continuously differentiable in v ∈ R, non-negative, and
strictly convex in v with D(v, v) = 0. Based on equations (2.7) and (2.8),
Chan, Yam and Zhang (2015) constructs calibration weights by solving the
following minimization problem subject to constraints that are empirical
counterparts of equations (2.7) and (2.8):
Minimize

N
X

Ti D(N pi , 1)

i=1

(2.9)

subject to

N
X

Ti pi uK (Xi ) =

i=1

N
1 X
uK (Xi ),
N
i=1

and
Minimize

N
X
i=1

(2.10)

(1 − Ti )D(N qi , 1)

subject to

N
X
i=1

(1 − Ti )qi uK (Xi ) =

N
1 X
uK (Xi ),
N
i=1

where uK is a K(N )-dimensional function of X, whose components form
a set of orthonormal polynomials, here K(N ) increases to infinity when N
goes to infinity yet with K(N ) = o(N ). Furthermore, note that all these
uK ’s have to form a basis on L∞ as K goes to infinity.

8

K.C.G. CHAN, K. IMAI, S.C.P. YAM, AND Z. ZHANG

Furthermore, to gain computational efficiency for implementation, they
consider the dual problems of equations (2.9) and (2.10). While the primal
problems given in equations (2.9) and (2.10) are convex separable programming with linear constraints, Tseng and Bertsekas (1987) showed that the
dual problems are unconstrained convex maximization problems, which can
be solved by efficient and stable numerical algorithms. With slight abuse of
notation, denote D(v) = D(v, 1). For observations with Ti = 1, the dual
solution is given by,
p̂K (Xi ) ,

(2.11)


1 ′ T
ρ φ̂K uK (Xi ) ,
N

where ρ′ is the first derivative of the following strictly concave function,

(2.12)
ρ(v) = D (D ′ )−1 (−v) + v · (D ′ )−1 (−v),

and φ̂K ∈ RK maximizes the following objective function,
(2.13)

N


o
1 Xn
F̂K (φ) ,
Ti ρ φ⊤ uK (Xi ) − φ⊤ uK (Xi ) .
N
i=1

Similarly, for observations with Ti = 0,

1 ′ T
(2.14)
ρ λ̂K uK (Xi ) ,
q̂K (Xi ) ,
N
where λ̂K ∈ RK maximizes the following objective function,
(2.15)

N
X


bK (λ) , 1
G
(1 − Ti )ρ λT uK (Xi ) − λT uK (Xi )
N

.

i=1

According to the first order conditions for the maximizations given in
equations (2.13) and (2.15), one can easily verify that the linear constraints
in equations (2.9) and (2.10) are satisfied. Finally, Chan, Yam and Zhang
(2015) proposed the following empirical covariate balancing estimator for δ1
and δ0 ,
(2.16)

δ̂1K ,

N
X
i=1

Ti p̂K (Xi )Yi

and

δ̂0K ,

N
X
i=1

(1 − Ti )q̂K (Xi )Yi

The authors showed that δ̂1K and δ̂0K attain the semiparametric efficiency
bounds given in equation (2.4) under mild regularity conditions.

NONPARAMETRIC ESTIMATION OF CAUSAL MEDIATION EFFECTS

9

2.3. Efficient estimation of θ0 and θ1 . We begin by considering the efficient estimation of θ0 . As explained below, the same approach can be applied to efficiently estimate θ1 . The efficient influence function of θ0 given in
equation (2.3), involves three sets of nonparametric functions: fT |X (1 | X),
fM |T,X (M | T = t, X) for t = 0, 1, and E(Y | X, M, T = 1). While it is
possible to construct a globally efficient estimator of θ0 by plugging the corresponding nonparametric estimates into equation (2.3), the performance of
the resulting estimator may be poor because it is difficult to estimate the
conditional density of a possibly continuous mediator and fM |T,X (M | 1, X)
appears in the denominator of the first term of Sθ0 . The direct nonparametric
estimation of fM |T,X usually results in extreme weights and the corresponding weighting estimator can become unstable.
Our goal is to construct a weighting estimator for θ0 . Let us represent θ0
as a weighted average of Y among the treated,


fM |T,X (M | 0, X)
TY
·
(2.17)
.
θ0 = E
fT |X (1 | X) fM |T,X (M | 1, X)
Furthermore, define,
(2.18)

r0 (m, x) ,

fM |T,X (m | 0, x)
.
N fT |X (1 | x)fM |T,X (m | 1, x)

If
r0 (m, x) is a known function, then a natural estimator for θ0 is θ̃0 =
PN
i=1 Ti r0 (Mi , Xi )Yi , which converges to θ0 by the Law of Large Number.
Since r0 (m, x) is mostly unknown, we shall replace it by an estimated weight.
To construct moment conditions for estimating r0 (m, x), we need to develop
a covariate balancing property extending equations (2.7) and (2.8). This
result is given in the following lemma.
Lemma 1. With q0 (x) = (N fT |X (0 | x))−1 and r0 (x, m) defined in equation (2.18), we have
E[T r0 (X, M )v(X, M )] = E[(1 − T )q0 (X)v(X, M )]
for any suitable integrable functions v.
Proof.
E[T r0 (X, M )v(X, M )]
= E[r0 (X, M )v(X, M )fT |X,M (1 | X, M )]


fM |T,X (M | 0, X)
1
v(X, M )fT |X,M (1 | X, M )
= E
N fT |X (1 | X) fM |T,X (M | 1, X)

10

=
=
=
=
=

K.C.G. CHAN, K. IMAI, S.C.P. YAM, AND Z. ZHANG

Z

Z

fM |T,X (m | 0, x)
1
v(x, m)fT |X,M (1 | x, m)fX,M (x, m)dxdm
M X N fT |X (1 | x) fM |T,X (m | 1, x)
Z Z
fM |T,X (m | 0, x)
1
v(x, m)fT,X,M (1, x, m)dxdm
M X N fT |X (1 | x) fM |T,X (m | 1, x)
Z Z
fM |T,X (m | 0, x)
v(x, m)fT,M |X (1, m | x)fX (x)dxdm
M X N fM,T |X (m, 1 | x)
Z Z
1
f
(m|0, x)v(x, m)fX (x)dxdm
N M X M |T,X
Z Z
v(x, m)
fT |X,M (0 | x, m)fX,M (x, m)dxdm
M X N fT |X (0 | x)

= E[q0 (X)v(X, M )fT |X,M (0 | X, M )]

= E[(1 − T )q0 (X)v(X, M )].

Lemma 1 motivates us to consider the empirical covariate balancing weights
r̂K (x, m) which solves for the following constrained optimization problem:
(2.19)Minimize

N
X

Ti D(N ri , 1)

subject to

i=1

N
X
i=1

Ti ri vK (Xi , Mi ) =

N
X
(1 − Ti )q̂K (Xi )vK (Xi , Mi ) .
i=1

Note that q̂K (x) is constructed from equations (2.14) and (2.15), and vK (x, m)
with K ∈ N is a L-dimensional vector-valued function, whose components
form a set of orthonormal polynomials, where L = O(K), i.e. L is of the
same order as K. Furthermore, note that these vK ’s have to form a basis on
L∞ as K goes to infinity.
The weights r̂K (x, m)′ s are obtained by minimizing the aggregate distance
between the final weights to a vector of constant working design weights, subject to an empirical analogue of the moment conditions given in Lemma 1.
Unlike to the case of Deville and Särndal (1992) who used the true and
known design weights commonly available in sample surveys, the true design weights for our problem r0 (m, x) is unknown and is a function of two
unknowns fT |X (1 | X) and fM |T,X (M | T, X). Therefore, calibration of true
design weights is impossible in this case. While the true weights are unavailable, we choose the uniform working design weights because they make it
less likely to yield extreme weights. Even with misspecified design weights,

NONPARAMETRIC ESTIMATION OF CAUSAL MEDIATION EFFECTS

11

however, we can still show that the proposed weighting estimator is globally
semiparametric efficient.
Similar to equations (2.11) and (2.14), we can derive the dual solution for
equation (2.19). For observations in the treatment group, i.e., Ti = 1,

1 ′ ⊤
(2.20)
ρ β̂K vK (Xi , Mi ) ,
r̂K (Xi , Mi ) ,
N

where ρ′ is the first derivative of the function given in equation (2.12), and
β̂K maximizes the following objective function:

(2.21)
N n


o
X
b K (β) , 1
H
Ti ρ β ⊤ vK (Xi , Mi ) − N (1 − Ti )q̂K (Xi )β ⊤ vK (Xi , Mi ) .
N
i=1

b K , we can check that
From the first order condition of the maximization of H
(2.22)
N
N


X
1 X
⊤
′
b
Ti ρ β̂K vK (Xi , Mi ) vK (Xi , Mi )− (1−Ti )q̂K (Xi )vK (Xi , Mi ) = 0.
HK (β̂K ) =
N
i=1

i=1

Now, we define the proposed estimator for θ0 to be

(2.23)

θ̂0K

,

N
X

Ti r̂K (Xi , Mi )Yi .

i=1

Asymptotic properties of θ̂0K will be derived in the next subsection. We shall
show that θ̂0K is globally semiparametric efficient under some mild regularity
conditions. Therefore, the proposed estimators δ̂1K − θ̂0K and θ̂0K − δ̂0K are
globally semiparametric efficient estimators for the average natural indirect
and direct effects respectively.
The relationship given in equation (2.12) between ρ(v) and D(v) is derived
in the supplementary materials. In the supplementary materials, we also
show that the strict convexity of D is equivalent to the strict concavity
of ρ. Since the dual formulation is equivalent to the primal problem, we
shall express the proposed estimator in terms of ρ(v) in the rest of the
present paper. When ρ(v) = − exp(−v), the weights are equivalent to the
implied weights of exponential tilting (Kitamura and Stutzer, 1997). When
ρ(v) = log(1 + v), the weights correspond to empirical likelihood (Qin and
Lawless, 1994). When ρ(v) = −(1−v)2 /2, the weights are the implied weights
of the continuous updating estimator of the generalized method of moments
(Hansen, Heaton and Yaron, 1996).

12

K.C.G. CHAN, K. IMAI, S.C.P. YAM, AND Z. ZHANG

The proposed estimator θ̂0K is constructed in a similar manner as done
for δ̂1K and δ̂0K (see Section 2.2). However, there are some important differences. First, δ̂1K and δ̂0K only require balancing pre-treatment variables
X, but θ̂0K requires balancing both pre-treatment variables X and posttreatment mediators M . Moreover, in equation (2.21), ρ appears explicitly
in the first term and implicitly in the second term through the dependency
of q̂K (x) on ρ. This creates new challenges to the establishment of theoretical results. Note that although we consider the weights estimated through a
specific ρ(v), the functional form of the true weights r0 (x, m) is unspecified.
It will be shown later that any function r0 (x, m), satisfying a mild differentiability assumption, can be approximated arbitrarily well by r̂K (x, m)
uniformly as the sample size increases, so long as ρ(v) also satisfies a mild
regularity condition.
We can apply the same methodology to the estimation of θ1 . Note that


fM |T,X (M | 1, X)
(1 − T )Y
·
(2.24)
θ1 = E
fT |X (1 | X) fM |T,X (M | 0, X)
Define
w0 (x, m) ,

fM |T,X (m | 1, x)
N fT,M |X (0, m | x)

For any suitable integrable v(x, m), we have


fM |T,X (M |1, X)
v(X, M )
E (1 − T )
fT,M |X (0, M | X)
Z Z
fM |T,X (m|1, x)
=
v(x, m)fT,M,X (0, m, x)dxdm
M X fT,M |X (0, m | x)
Z Z
fM,T,X (m, 1, x)
=
v(x, m)fX (x)dxdm
fT,X (1, x)
M X


T v(X, M )
=E
.
fT |X (1 | X)
Therefore, we can construct empirical covariate balancing weights ŵK from
the following constrained maximization problem:
Minimize

N
X
(1 − Ti )D (N wi , 1) subject to
i=1

N
N
X
X
Ti p̂K (Xi )vK (Xi , Mi ) .
(1 − Ti )wi vK (Xi , Mi ) =
i=1

i=1

NONPARAMETRIC ESTIMATION OF CAUSAL MEDIATION EFFECTS

13

Its dual solution is given by,

1 ′ ⊤
ρ γ̂K vk (x, m) ,
ŵK (x, m) ,
N

where γ̂K maximizes the following objective function,

N
i
1 Xh
(1 − Ti )ρ(γ ⊤ vK (Xi , Mi )) − N Ti p̂K (Xi )γ ⊤ vK (Xi , Mi )
JˆK (β) ,
N
i=1

Then, we can now suggest the estimator of PIE = θ1 − δ0 by:
(2.25)
d , θ̂1K − δ̂0K =
PIE

N
N
X
X
(1 − Ti )q̂K (Xi )Yi .
(1 − Ti )ŵK (Xi , Mi )Yi −
i=1

i=1

2.4. Asymptotic properties. To derive the asymptotic properties of the
proposed estimator, we list all additional technical assumptions that are
required beyond Assumption 1.
Assumption 2.

E(Y 2 | T = 0) < ∞ and E(Y 2 | T = 1) < ∞.

Assumption 3.
1. The support X of r1 -dimensional covariate X is a Cartesian product
of r1 compact intervals.
2. The support M of r2 -dimensional mediating variable M is a Cartesian
product of r2 compact intervals.
Denote r , r1 + r2 .
Assumption 4. There exist some constants η1 , η2 , η3 , η4 , η5 , η6 such that
the following inequalities hold:
1
1
≤
fT |X (0 | x)
≤
< 1,
η1
η2
1
1
≤ fM |T,X (m | 0, x) ≤
< 1,
0 <
η3
η4
1
1
≤ fM |T,X (m | 1, x) ≤
< 1.
0 <
η5
η6
0 <

Assumption 5. The functions, q(x) and r(x, m), are s-times and s′ times continuously differentiable, respectively, where s′ > 19r > 0 and s >
16r1 > 0.

14

K.C.G. CHAN, K. IMAI, S.C.P. YAM, AND Z. ZHANG

Assumption 6. The function E(Y | T = 1, M = m, X = x) is t-times
jointly continuously differentiable with respect to (x, m), and η(1, 0, x) is d′ times continuously differentiable w.r.t. x, where d > 3r/2 and d′ > 3r1 /2.


1
1
1
ν
.
< ν < 17
Assumption 7. K = O(N ) and
∨
s′ /r − 2 s/r1 + 1
Assumption 8. ρ ∈ C 3 (R) is a strictly concave function defined on R
i.e., ρ′′ (γ) < 0, ∀γ ∈ R, and the range of ρ′ contains the following subset of
the positive real line:


 
η1
η2
η2 η5
η1 η6
[η2 , η1 ] ∪
,
,
.
∪
η1 − 1 η2 − 1
(η1 − 1) η3 (η2 − 1) η4
Assumptions 1–7 or similar assumptions also appeared in the literature
(e.g., Chan, Yam and Zhang, 2015; Hahn, 1998; Hirano, Imbens and Ridder,
2003; Imbens, Newey and Ridder, 2005). As explained earlier, Assumption 1
is used for the identification of the natural direct and indirect effects. Assumption 2 is required for the finiteness of asymptotic variance. Assumptions 3 and 4 are needed to establish the uniform boundedness of approximations. Assumptions 5 and 6 are required for controlling the remainder
of approximations with a given set of basis functions. Assumption 8 is required for controlling the stochastic order of the reminder terms, which is
satisfied by commonly used ρ functions as discussed above. This final assumption imposes a mild regularity condition on ρ. Chan, Yam and Zhang
(2015) maintains the same assumption.
Two intermediate lemmas are needed to prove the main theorem. We
define the following intermediate quantities that are probability limits of
bK , λ̂K , q̂K , H
b k , β̂K and r̂K for each fixed K:
FbK , φ̂K , p̂K , G
h 

i


∗
FK
(φ) , E T ρ φ⊤ uK (X) − φ⊤ uK (X) = E FbK (φ) ,
φ∗K

∗
(φ) ,
, arg max FK
φ∈RK


1 ′ ∗ ⊤
ρ (φK ) uK (x) ,
Nh


i


∗
bK (λ) ,
GK (λ) , E (1 − T )ρ λ⊤ uK (X) − λ⊤ uK (X) = E G
p∗K (x) ,

λ∗K

, arg max G∗K (λ) ,

∗
qK
(x) ,

λ∈RK


1 ′ ∗ ⊤
ρ (λK ) uK (x) ,
N

NONPARAMETRIC ESTIMATION OF CAUSAL MEDIATION EFFECTS

15

h 

i
∗
HK
(β) , E T ρ β ⊤ vK (X, M ) − (1 − T )(fT |X (0 | X))−1 β ⊤ vK (X, M ) ,
∗
βK

∗
(β) ,
, arg max HK
β∈RK

∗
rK
(x, m) ,


1 ′ ∗ ⊤
ρ (βK ) vK (x, m) .
N

Also, let ζ(K) = supx∈X ||uK (x)||. The following lemma establishes the
∗ (x) and r ∗ (x, m).
approximation of functions p0 (x), q0 (x), r0 (x, m) by p∗K (x), qK
K
Lemma 2.

Under Assumptions 3, 4, 5, and 7, we have,


− s
sup |N p0 (x) − N p∗K (x)| = O K 2r1 ζ(K) ,
x∈X


− s
∗
sup |N q0 (x) − N qK
(x)| = O K 2r1 ζ(K) ,
x∈X

sup
(x,m)∈X ×M



s′
∗
|N r0 (x, m) − N rK
(x, m)| = O K − 2r ζ(K) .

Proof. The proof is given in the supplementary material.
The other lemma is about the performance of the estimated auxiliary parameters, φ̂K , λ̂K , and β̂K that maximize equations (2.13), (2.15), and (2.21)
respectively.
Lemma 3.

Under Assumptions 3, 4, 5, and 7, we have
r !
K
,
kφ̂K − φ∗K k = Op
N
r !
K
kλ̂K − λ∗K k = Op
,
N
!
r
5
K
∗
kβ̂K − βK
k = Op
.
N

Proof. The proof is given in the supplementary material.
The following theorem shows that θ̂0K is consistent, asymptotically normal, and globally semiparametric efficient.
Theorem 1.

Under Assumptions 1–8, θ̂0K has the following properties:

16

K.C.G. CHAN, K. IMAI, S.C.P. YAM, AND Z. ZHANG

1. θ̂0K =

N
X
i=1

√
2. N

N
X
i=1

p

Ti r̂K (Xi , Mi )Yi −→ θ0 ;

Ti r̂K (Xi , Mi )Yi − θ0

!


d
−→ N (0, Vθ0 ), where Vθ0 = E Sθ20 ,

attains the semi-parametric efficiency bound (Tchetgen Tchetgen and Shpitser,
2012) with the definition of Sθ0 as given in equation (2.3).
Proof. The proof is given in the supplementary material.
The following corollary establishes the large sample properties of the esd K = δ̂1K − θ̂0K , and of the estitimated average natural indirect effect, NIE
[ K = θ̂0K − δ̂0K .
mated average natural direct effect, NDE
Corollary 2.
lowing properties:
1. Consistency.
dK
NIE

dK
NDE

=

=

d K and NDE
d K have the folUnder Assumptions 1–8, NIE

N
X

i=1
N
X
i=1

Ti p̂K (Xi )Yi −

N
X
i=1

p

Ti r̂K (Xi , Mi )Yi −→ NIE = δ1K − θ0K ,

(1 − Ti )r̂K (Xi , Mi )Yi −

N
X
i=1

p

(1 − Ti )q̂K (Xi )Yi −→ NDE = θ0K − δ0K .

2. Asymptotic normality and semiparametric efficiency.

√ 
d
d K − NIE
N NIE
−→ N (0, VNIE ) ,

√ 
d
d K − NDE
N NDE
−→ N (0, VNDE ) ,

i
i
h
h
where VNIE = E (Sδ1 − Sθ0 )2 and VNDE = E (Sθ0 − Sδ0 )2 , with Sθ0 ,
Sδ1 , and Sδ0 as defined in equations (2.3), and (2.4), respectively.

Similarly, we can derive the analogous asymptotic properties for the pure
indirect effect.
d defined in equation (2.25)
Theorem 3. Under Assumptions 1–8, PIE
has the following properties:
p
d −→
1. PIE
PIE

NONPARAMETRIC ESTIMATION OF CAUSAL MEDIATION EFFECTS

2.

17


√ 


d
d − PIE −→
N PIE
N (0, VPIE ), where VPIE = E (SPIE )2 attains the
semi-parametric efficiency bound (Tchetgen Tchetgen and Shpitser, 2012).
The definition of SPIE is given by,
SPIE =

1{T = 0}fM |T,X (M | 1, X)
{Y − E (Y | X, M, T = 0)}
fT |X (0 | X)fM |T,X (M | 0, X)
1{T = 1}
+
{E (Y | X, M, T = 0) − η(0, 1, X)}
fT |X (1 | X)
−

1{T = 0}
{Y − η(0, 0, X)} + η(0, 1, X) − η(0, 0, X) − PIE.
fT |X (0 | X)

2.5. Nonparametric estimation of the asymptotic variance. We have shown
that the proposed estimator attains the semiparametric efficiency bound
whose efficient influence function depends on three sets of nonparametric
functions. In this section, we propose a consistent variance estimator that
does not require additional nonparametric function estimates and is easy to
compute. Define the following quantities:
τ
gK1 (T, X; φ)
gK2 (T, X; λ)
gK3 (T, X, M ; λ, β)
gK4 (T, X, Y ; φ, δ)
gK5 (T, X, Y ; λ, δ)
gK6 (T, X, M, Y ; β, θ)
gK (T, X, M, Y ; τ )
τ̂K
∗
τK

, (φ⊤ , λ⊤ , β ⊤ , δ, δ′ , θ)⊤ ,


, T ρ′ φ⊤ uK (X) uK (X) − uK (X) ,


, (1 − T )ρ′ λ⊤ uK (X) uK (X) − uK (X) ,




, T ρ′ β ⊤ vK (X, M ) vK (X, M ) − (1 − T )ρ′ λ⊤ uK (X) vK (X, M ) ,


, T ρ′ φ⊤ uK (X) Y − δ ,


, (1 − T )ρ′ λ⊤ uK (X) Y − δ′ ,


, T ρ′ β ⊤ vK (X, M ) Y − θ ,
⊤

⊤
⊤
⊤
,
,
gK1
, gK2
, gK3
, gK4 , gK5 , gK6
⊤

⊤
⊤
,
,
φ̂⊤
K , λ̂K , β̂K , δ̂1K , δ̂0K , θ̂0K
⊤

∗ ⊤ ∗
∗
∗
,
,
(φ∗K )⊤ , (λ∗K )⊤ , (βK
) , δ1K , δ0K
, θ0K

∗ , E [T N p∗ (X)Y ], δ ∗ , E [(1 − T )N q ∗ (X)Y ] and
where δ, δ′ , θ ∈ R, δ1K
K
0K
K
∗ , E [T N r ∗ (X, M )Y ]. Note that by definition τ̂ satisfies:
θK
K
K

(2.26)

N
1 X
gK (Ti , Xi , Mi , Yi ; τ̂K ) = 0 .
N
i=1

18

K.C.G. CHAN, K. IMAI, S.C.P. YAM, AND Z. ZHANG

∗ yields:
Applying the Taylor’s theorem for (2.26) at τK
(2.27)
N
N
1 X ∂gK (Ti , Xi , Mi , Yi ; τ̃K )
1 X
∗
∗
gK (Ti , Xi , Mi , Yi ; τK
)+
(τ̂K −τK
),
0 =
N
N
∂τ
i=1

i=1

∗ . In the supplementary material,
where τ̃K lies on the line joining τ̂K with τK
we show that:

(2.28)


N
∗ )
∂gK (T, X, M, Y ; τK
1 X ∂gK (Ti , Xi , Mi , Yi ; τ̃K )
= E
+ op (1) ,
N
∂τ
∂τ
i=1

where


∗)
∂gK (T, X, M, Y ; τK
E
∂τ



=



A3K×3K , B3K×3
C3×3K ,
D3×3



and
A3K×3K



A11
, 0K×K
0K×K

0K×K
A22
A32

B3K×3 , 03K×3 ,

C11 01×K

01×K C22
C3×3K ,
01×K 01×K


0K×K
0K×K  ,
A33

01×K
01×K  ,
C33

D3×3 , −I3×3 ,
h
i
(X)
,
A11 = E T ρ′′ ((φ∗K )⊤ uK (X))uK (X)u⊤
K

A22 = E[(1 − T )ρ′′ ((λ∗K )⊤ uK (X))uK (X)u⊤
K (X)] ,

A32 = −E[(1 − T )ρ′′ ((λ∗K )⊤ uK (X))vK (X, M )u⊤
K (X)] ,
∗ ⊤
⊤
A33 = E[T ρ′′ ((βK
) vK (X, M ))vK (X, M )vK
(X, M )] ,

C11 = E[T ρ′′ ((φ∗K )⊤ uK (X))Y u⊤
K (X)] ,
C22 = E[(1 − T )ρ′′ (−(λ∗K )⊤ uK (X))Y u⊤
K (X)] ,

∗ ⊤
⊤
C33 = E[T ρ′′ ((βK
) vK (X, M ))Y vK
(X, M )] .

The parameters of interest are






NIE
δ1 − θ0
1 0 −1
NDE = θ0 − δ0  = 0 −1 1  π
θ0
θ0
0 0
1

NONPARAMETRIC ESTIMATION OF CAUSAL MEDIATION EFFECTS

19

π̂K ,
where π , (δ1 , δ0 , θ0 )⊤ . Note that asymptotic variance of estimators √
(δ̂1K , δ̂0K , θ̂0K )⊤ , which is the lower right corner element of limN →∞ V( N (τ̂K −
i−1
h
∗
∗ )). Consider a sub-matrix formed by the last three rows of E ∂gK (T,X,M,Y ;τK )
,
τK
∂τ
which is

LK , C3×3K A−1
3K×3K , −I3×3 .
Algebraic manipulation yields:

L11K
LK = 01×K
01×K

01×K
L22K
L32K

where
L11K
L22K
L32K

01×K
01×K
L33K



−I3×3  ,

= E[T ρ′′ ((φ∗K )⊤ uK (X))Y uK (X)⊤ ] · E[T ρ′′ ((φ∗K )⊤ uK (X))uK (X)uK (X)⊤ ]−1 ,

= E[(1 − T )ρ′′ ((λ∗K )⊤ uK (X))Y uK (X)⊤ ] · E[(1 − T )ρ′′ ((λ∗K )⊤ uK (X))uK (X)uK (X)⊤ ]−1 ,

∗ ⊤
= E[T ρ′′ ((βK
) vK (X, M ))Y vK (X, M )⊤ ]
i−1
h
∗ ⊤
·E T ρ′′ ((βK
) vK (X, M ))vK (X, M )vK (X, M )⊤

·E[(1 − T )ρ′′ ((λ∗K )⊤ uK (X))vK (X, M )uK (X)⊤ ]

L33K

·E[(1 − T )ρ′′ ((λ∗K )⊤ uK (X))uK (X)uK (X)⊤ ]−1 ,

∗ ⊤
= E[T ρ′′ ((βK
) vK (X, M ))Y vK (X, M )⊤ ]

∗ ⊤
·E[T ρ′′ ((βK
) vK (X, M ))vK (X, M )vK (X, M )⊤ ]−1 .

Applying Lemmas 2 and 3, we show in the supplementary material that




s′
− s +1
∗
(2.29)
+ O K − r +1 ,
kE[gK (T, X, M, Y ; τK
)]k2 = O K r1
(2.30)

kLK k2 = O(K 4 ) .

By (2.27), (2.28) we can have
(2.31)
∗
τ̂K − τK



∗)
∂gK (T, X, M, Y ; τK
=E
∂τ

−1

!
N
1 X
gK (Ti , Xi , Mi , Yi ; τ̂K ) .
N
i=1

Also, by equations (2.29) and (2.30), we can show:
(2.32)
√
∗
∗
∗ ⊤ ⊤
lim V ar( N (π̂K − πK
)) = lim LK E[gK (T, X, M, Y ; τK
)gK (T, X, M, Y ; τK
) ]LK
K→∞

K→∞

20

K.C.G. CHAN, K. IMAI, S.C.P. YAM, AND Z. ZHANG

= lim LK PK L⊤
K ,
K→∞

∗ , (δ ∗ , δ ∗ , θ ∗ )⊤ and P , E[g (T, X, M, Y ; τ ∗ )g (T, X, M, Y ; τ ∗ )⊤ ].
where πK
K
K
1K 0K K
K K
K
This leads to the following estimator of the asymptotic variance:

VbK

(2.33)
where
L̂k

b11K
L

b22K
L

b32K
L

b33K
L



b K PbK L
b⊤ ,
, L
K


b 11K 01×K 01×K
L

b 22K 01×K −I3×3 
= 01×K L
 ,
b 32K L
b 33K
01×K L
# "
#−1
"
N
N
1 X
1 X
′′ ⊤
⊤
′′ ⊤
⊤
,
Ti ρ (φ̂K uK (Xi ))uK (Xi ) Yi ·
Ti ρ (φ̂K uK (Xi ))uK (Xi ) uK (Xi )
,
N
N
i=1
i=1
#
"
N
1 X
⊤
(1 − Ti )ρ′′ (λ̂⊤
,
K uK (Xi ))uK (Xi ) Yi
N
i=1
"
#−1
N
1 X
⊤
·
,
(1 − Ti )ρ′′ (λ̂⊤
K uK (Xi ))uK (Xi ) uK (Xi )
N
i=1
"
#
N
1 X
′′ ⊤
⊤
,
Ti ρ (β̂K vK (Xi , Mi ))vK (Xi , Mi ) Yi
N
i=1
#−1
"
N
1 X
′′ ⊤
⊤
Ti ρ (β̂K vK (Xi , Mi ))vK (Xi , Mi )vK (Xi , Mi )
·
N
i=1
"
#
N
X
1
⊤
·
(1 − Ti )ρ′′ (λ̂⊤
K uK (Xi ))vK (Xi , Mi )uK (Xi )
N
i=1
"
#−1
N
1 X
′′ ⊤
⊤
·
,
(1 − Ti )ρ (λ̂K uK (Xi ))uK (Xi )uK (Xi )
N
i=1
"
#
N
1 X
⊤
,
Ti ρ′′ (β̂K
vK (Xi , Mi ))vK (Xi , Mi )⊤ Yi
N
i=1
#−1
"
N
1 X
T
,
Ti ρ′′ (β̂K
vK (Xi , Mi ))vK (Xi , Mi )⊤ vK (Xi , Mi )
·
N

1
PbK ,
N

i=1
N
X

gK (Ti , Xi , Mi , Yi ; τ̂K )gK (Ti , Xi , Mi , Yi ; τ̂K )⊤ .

i=1

NONPARAMETRIC ESTIMATION OF CAUSAL MEDIATION EFFECTS

21

Finally, the following theorem states that this estimator of the asymptotic
variance VbK is consistent, indeed.

Theorem 4. Let k1 = (0, 0, 1), k2 = (1, 0, −1) and k3 = (0,
 −1, 1).

⊤
b
Under Assumptions 1–8, k1 VK k1 is a consistent estimator for E (Sθ0 )2 ,


2 and k V
b ⊤
k2 VbK k2⊤ is a consistent
estimator
for
E
(S
)
3 K k3 is a consistent
NIE


estimator for E (SNDE )2 , where SNIE = Sδ1 − Sθ0 , SNDE = Sθ0 − Sδ0 and
Sθ0 , Sδ1 , Sδ0 are defined in equations (2.3) and (2.4), respectively.
Proof. The proof is given in the supplementary material.
3. Extensions of our Proposed Methodology. In this section, we
consider several extensions of the proposed methodology presented in the
previous section. We first study the case of multiple mediators, and then
discuss the estimation of pure indirect effects and natural indirect effects for
the untreated.
3.1. Multiple mediators. We show that the proposed methodology introduced in the previous section does not require the mediator to be univariate. Instead, we consider the situation where multiple mediators exist and
are not causally independent. Specifically, we study the setting considered
by Imai and Yamamoto (2013) who proposed a semiparametric estimation
method within a linear structural equation modeling framework. We improve
this existing method by considering the efficient nonparametric estimation.
Consider the setting with a binary treatment variable T ∈ {0, 1} and
two mediators W and M with W being causally prior to M . Let W (t) be
a potential mediator variable, which represents the value of the mediator
W when the treatment variable is set to t ∈ {0, 1}. Similarly, denote the
potential mediator variable of M by M (t, w) which represents the value of
the mediator M when T and W are set to (t, w). Finally, the potential
outcome variable can be defined as Y (t, m, w), which represents the value of
the outcome variable Y when the treatment and the two mediators are set
to (t, m, w).
We consider an extension of the sequential ignorability assumption given
in Assumption 1.
Assumption 9.
hold:

The following three conditional independence statements

1. {Y (t, m, w), M (t, w), W (t)} ⊥⊥ T | X = x ,
2. {Y (t′ , m, w), M (t′ , w)} ⊥⊥ W (t) | T = t, X = x ,
3. Y (t′ , m, w) ⊥⊥ M (t, w′ ) | T = t, X = x, W (t) = w′ ;

22

K.C.G. CHAN, K. IMAI, S.C.P. YAM, AND Z. ZHANG

for any t, t′ ∈ {0, 1} and (m, w, w′ , x) ∈ M × W × W × X , where W is the
support of W .
This assumption is stronger than the one considered by Imai and Yamamoto
(2013), which avoids the “cross-world” independence but results in partial
identification. Finally, we also make the relevant consistency and positivity
assumptions as done in Assumption 1. The following lemma establishes an
important connection between two sequential ignorability assumptions given
in Assumptions 1 and 9.
Lemma 4. Under the first two conditions of Assumption 9, the third
condition of Assumption 9 holds if and only if:
(3.1)

Y (t′ , w, m) ⊥⊥ {W (t), M (t, W (t))} | T = t, X = x

for any t, t′ ∈ {0, 1} and (m, w, x) ∈ M × W × X .

Proof. Under the first two conditions of Assumption 9, we first show
that the equation (3.1) implies the third condition of Assumption 9. For any
test functions φ1 (y), φ2 (m), and φ3 (w), by using (3.1) and Assumption 9
(2), we have


E φ1 (Y (t′ , m, w))φ2 (M (t, W (t)))φ3 (W (t))|T = t, X = x


=E φ1 (Y (t′ , m, w))|T = t, X = x · E [φ2 (M (t, W (t)))φ3 (W (t))|T = t, X = x]



=E E φ1 (Y (t′ , m, w))|T = t, X = x

· E [φ2 (M (t, W (t)))φ3 (W (t))|T = t, X = x, W (t)] T = t, X = x



=E E φ1 (Y (t′ , m, w))|T = t, X = x, W (t)

· E [φ2 (M (t, W (t)))|T = t, X = x, W (t)] · φ3 (W (t)) T = t, X = x ,
where the second equality follows from applying the Tower property to the
second term and then plugging the first term inside the second one; the last
equality follows from Assumption 9 (2). Therefore, we can get that
Y (t′ , m, w) ⊥⊥ M (t, W (t)) | T = t, X = x, W (t) .
Conversely, we shall show that under the first two conditions of Assumption 9, Assumption 9 (3) implies (3.1). For any test functions φ1 (y) and
φ4 (w, m), we have


E φ1 (Y (t′ , w, m))φ4 (W (t), M (t, W (t)))|T = t, X = x

NONPARAMETRIC ESTIMATION OF CAUSAL MEDIATION EFFECTS

23

 


=E E φ1 (Y (t′ , w, m))φ4 (W (t), M (t, W (t)))|T = t, X = x, W (t) |T = t, X = x
 

=E E φ1 (Y (t′ , w, m))|T = t, X = x, W (t)

· E [φ4 (W (t), M (t, W (t)))|T = t, X = x, W (t)] |T = t, X = x]


=E φ1 (Y (t′ , w, m))|T = t, X = x

· E [E [φ4 (W (t), M (t, W (t)))|T = t, X = x, W (t)] |T = t, X = x]


=E φ1 (Y (t′ , w, m))|T = t, X = x · E [φ4 (W (t), M (t, W (t)))|T = t, X = x] ,
where the second equality follows from Assumption 9 (3) and the third
equality follows from Assumption 9 (2), which finally yields (3.1).
Lemma 4, together with the discussion in the previous section, implies
that we can estimate E[Y (1, W (0), M (0, W (0)))] using the proposed methodology that calibrates the functions of X, W and M . To study path-specific
effects, we consider the following decomposition of the average treatment
effects:
(3.2)
(3.3)
(3.4)

E[Y (1, W (1), M (1, W (1))) − Y (0, W (0), M (0, W (0)))]

= E[Y (1, W (1), M (1, W (1))) − Y (1, W (0), M (1, W (0)))]

+ E[Y (1, W (0), M (1, W (0))) − Y (1, W (0), M (0, W (0)))]

+ E[Y (1, W (0), M (0, W (0))) − Y (0, W (0), M (0, W (0)))] .

This decomposition is also studied by Avin, Shpitser and Pearl (2005) and
VanderWeele, Vansteelandt and Robins (2014). The first term represents a
partial mediation effect through W , the second term is the partial mediation
effect through M , and the third term is the direct effect of the treatment
that does not go through W or M . Although the above decomposition is not
the only way to define partial mediation effects, it has several advantages.
First, the sum of the two partial mediation effects equals the joint natural
indirect effects through both mediators. Moreover, the first term and the
sum of the second and third terms are identified even if M is not observed.
To estimate the two partial mediation effects (3.2) and (3.3), we show
below that E[Y (1, W (0), M (1, W (0)))] is estimable by adapting the proposed
methodology under Assumption 9. The following lemma presents the results
in the current setting that are analogous to those given in Lemma 1 in the
univariate mediator case.
Lemma 5. Let q0 (X) = (N fT |X (0 | X))−1 and r0 (X, W ) = fT |X,W (0 |
X, W ) · (N fT |X,W (1 | X, W )fT |X (0 | X))−1 . Under Assumption 9, for any
suitable function v(X, M ), we have the following properties:
(3.5)

E[Y (1, W (0), M (1, W (0)))] = E[T N r0 (X, W )Y ] ,

24

K.C.G. CHAN, K. IMAI, S.C.P. YAM, AND Z. ZHANG

(3.6)

E[T N r0 (X, W )v(X, W )] = E[(1 − T )N q0 (X)v(X, W )] .

Proof. We begin by noting that
E [Y (1, W (0), M (1, W (0))) | X = x]
Z
E [Y (1, w, m) | X = x, W (0) = w, M (1, W (0)) = m]
=
W×M

(3.7)

· fW (0),M (1,W (0))|X (w, m | x)dwdm

We can express each term in this equation using the observed data,
(3.8)
E [Y (1, w, m) | X = x, W (0) = w, M (1, W (0)) = m]
=E [Y (1, w, m) | X = x, W (0) = w, M (1, w) = m]

=E [Y (1, w, m) | X = x, W (0) = w, M (1, w) = m, T = 0]

=E [Y (1, w, m) | X = x, M (1, w) = m, T = 0]

=E [Y (1, w, m) | X = x, M (1, w) = m, T = 1]

(by Assumption 9 (1))

(by Assumption 9 (2))

(by Assumption 9 (1))

=E [Y (1, w, m) | X = x, W (1) = w, M (1, w) = m, T = 1]

(by Assumption 9 (2))

=E [Y (1, w, m) | X = x, W (1) = w, M (1, W (1)) = m, T = 1]

=E [Y | X = x, W = w, M = m, T = 1] .
Similarly, we have
(3.9)
fW (0),M (1,W (0))|X (w, m | x)

=fM (1,W (0))|X,W (0) (m | x, w)fW (0)|X (w | x)

=fM (1,w)|X,W (0)(m | x, w)fW (0)|X (w | x)

=fM (1,w)|X,W (0),T (m | x, w, 0)fW (0)|X (w | x) (by Assumption 9 (1))
=fM (1,w)|X,W (0),T (m | x, w, 0)fW (0)|X,T (w | x, 0)
=fM (1,w)|X,T (m | x, 0)fW (0)|X,T (w | x, 0)

=fM (1,w)|X,T (m | x, 1)fW (0)|X,T (w | x, 0)

(by Assumption 9 (1))

(by Assumption 9 (2))
(by Assumption 9 (1))

=fM (1,w)|X,W (1),T (m | x, w, 1)fW (0)|X,T (w | x, 0)

(by Assumption 9 (2))

=fM (1,W (1))|X,W (1),T (m | x, w, 1)fW (0)|X,T (w | x, 0)

=fM |X,W,T (m | x, w, 1)fW |X,T (w | x, 0) .

Then, equations (3.7), (3.8) and (3.9) imply that
E [Y (1, W (0), M (1, W (0))) | X = x]

NONPARAMETRIC ESTIMATION OF CAUSAL MEDIATION EFFECTS

=
=

Z

W×M
1
XZ
t=0

=
=

E(Y | X = x, W = w, M = m, T = 1)fM |X,W,T (m | x, w, 1)fW |X,T (w | x, 0)dwdm

Y×W×M

1 Z
X

t=0 Y×W×M
1 Z
X
t=0

25

Y×W×M

ty · fY |X,W,M,T (y | x, w, m, t)fM |X,W,T (m | x, w, 1)fW |X,T (w | x, 0)dydwdm
ty ·

fY,X,W,M,T (y, x, w, m, t) fM,X,W,T (m, x, w, 1) fW,X,T (w, x, 0)
·
·
dydwdm
fX,W,M,T (x, w, m, 1)
fX,W,T (x, w, 1)
fX,T (x, 0)

ty ·

fY,X,W,M,T (y, x, w, m, t) fW,X,T (w, x, 0)
·
dydwdm .
fX,W,T (x, w, 1)
fX,T (x, 0)

Therefore, we can have
E [Y (1, W (0), M (1, W (0)))]
1 Z
X
fY,X,W,M,T (y, x, w, m, t) fW,X,T (w, x, 0)
=
ty ·
·
f (x)dxdwdmdy
fX,W,T (x, w, 1)
fX,T (x, 0)
t=0 X ×W×M×Y


fX,W,T (X, W, 0)
= E TY
fX,W,T (X, W, 1)fT |X (0 | X)
= E [T Y N r0 (X, W )] .

This proves equation (3.5). For equation (3.6), we can show that the term
on the left-hand side is equal to,

=
=
=
=

E[T N r0 (X, W )v(X, W )]
Z
fT |X,W (0 | x, w)
v(x, w)fT,X,W (1, x, w)dxdw
X ×W fT |X,W (1 | x, w)fT |X (0 | x)
Z
fT |X,W (0 | x, w)
v(x, w)fX,W (x, w)dxdw
fT |X (0 | x)
X ×W
Z
1
v(x, w)fT,X,W (0, x, w)dxdw
X ×W fT |X (0 | x)
1 Z
X
1−t
v(x, w)fT,X,W (t, x, w)dxdw
X ×W fT |X (0 | x)
t=0

= E [(1 − T )N q0 (X)v(X, W )] .
This proves equation (3.6).

In Lemma 5, equation (3.5) expresses the average potential outcome,
E[Y (1, W (0), M (1, W (0)))], in terms of observable variables; and equation (3.6)

26

K.C.G. CHAN, K. IMAI, S.C.P. YAM, AND Z. ZHANG

gives an identification condition of the unknown weight function r0 (x, w).
Therefore, E[Y (1, W (0), M (1, W (0)))] can be estimated by the proposed
methodology described in the previous section that calibrates the functions
of X and W but not M .
3.2. Natural direct effect for the untreated. Lendle, Subbaraman and van der Laan
(2013) considered the estimation of the natural direct effect for the untreated
(NDEU), which is defined as NDEU = E[Y (1, M (0)) − Y (0, M (0)) | T =
0] = θ1′ − δ0′ . Lendle, Subbaraman and van der Laan (2013) showed that the
identification of NDEU requires the following assumption (along with Assumption 1).
Assumption 10. For any t ∈ {0, 1}, m, m′ ∈ M and x ∈ X , the following equality holds,


E Y (t, m) − Y (0, m) | M (0) = m′ , X = x = E [Y (t, m) − Y (0, m) | X = x] .
Under Assumption 10, we have

Define

NDEU , E [Y (1, M (0)) − Y (0, M (0)) | T = 0]


T Y fM,X|T (M, X | 0)
E [(1 − T )Y ]
= E
.
−
fT,M,X (1, M, X)
E(1 − T )
r̃0 (x, m) =

fM,X|T (m, x | 0)
,
N fT,M,X (1, m, x)

for any integrable function v(x, m), we have,
Z
fM,X|T (m, x | 0)
E [T v(X, M )N r̃0 (X, M )] =
v(x, m)
· fT,M,X (1, m, x)dmdx
fT,M,X (1, m, x)
Z
=
v(x, m)fM,X|T (m, x | 0)dmdx
=
Therefore, we define

E[(1 − T )v(X, M )]
.
E(1 − T )


1 ′ ⊤
r̃ˆK (x, m) =
ρ β̂1K vK (x, m) ,
N

where β̂1K maximizes the following general empirical likelihood function
b 1K (β),
H
N 

 (1 − T )β ⊤ v (X , M ) 
1 X
i
K
i
i
⊤
b
H1K (β) ,
Ti ρ β vK (Xi , Mi ) −
,
N
1−T
i=1

NONPARAMETRIC ESTIMATION OF CAUSAL MEDIATION EFFECTS

where T ,
to be,

1
N

PN

i=1 Ti .

27

Therefore, we can define the estimators of θ1′ and δ0′

′
θ̂1K
,

δ̂0′ ,

N
X

Ti r̃ˆK (Xi , Mi )Yi ,

i=1
PN
(1 − Ti )Yi
Pi=1
N
i=1 (1 − Ti )

.

Given these estimators, the proposed estimator for the NDEU is given by,
′
\ , θ̂1K
NDEU
− δ̂0′

\ extends the estimators of average treatment
The proposed estimator NDEU
effects on the treated studied by Hainmueller (2012) and Chan, Yam and Zhang
(2015) to causal mediation analysis. The following theorem summarizes the
asymptotic properties of this estimator.
Theorem 5.
properties:

\ has the following
Under Assumptions 1-8 and 10, NDEU

p
\
1. √
NDEU
 −→ NDEU


d
2
\ − NDEU −→
N (0, VNDEU ), where VNDEU = E SNDEU
2. N NDEU
attained the semi-parametric efficiency bound (Lendle, Subbaraman and van der Laan,
2013), where


1{T = 1} fT |X,M (0 | X, M ) 1{T = 0}
−
{Y − E (Y | T, M, X)}
SNDEU =
fT (0) fT |X,M (1 | X, M )
fT (0)

+

1{T = 0}
{E (Y | T = 1, M, X) − E (Y | T = 0, M, X) − NDEU} .
fT (0)

4. Empirical Applications. In this section, we briefly describe the
application of the proposed methodology to two data sets, one regarding
the evaluation of a job training program, while another concerning a psychological experiment from political science.
4.1. Evaluation of a job training program. We reanalyze the data from
the JOBSII intervention study for unemployed job seekers (Vinokur and Schul,
1997). JOBSII is a randomized intervention study that investigates the efficacy of a job training program. In the study, 1801 unemployed workers were
randomly assigned into two groups, with 1249 workers in the intervention
arm and 552 workers in the control arm. The intervention group received five

28

K.C.G. CHAN, K. IMAI, S.C.P. YAM, AND Z. ZHANG

job training workshops that had a specific focus on improving a general sense
of mastery of job seekers, which is a composite measure including confidence,
internal locus of control, and self-esteem. It was hypothesized that the sense
of mastery was a key mediator of a successful reemployment. The control
group received a booklet but not the workshop sessions. Vinokur and Schul
(1997) used a linear structural equation model and found that the enhanced
sense of mastery had a significant mediating effect on reemployment.
To relax the linearity assumption, we reanalyze the JOBSII data using
the present proposed nonparametric method. We include the following baseline covariates in the analysis: financial strain, depressive symptoms, age,
sex, race, education, marital status, previous income, and previous occupation. The function u(X) is set to be linear in covariates, and v(X, M )
is linear in covariates and the mediator. We find that the overall average
treatment effect is 6.4% with a 95% confidence interval of [0.9%, 11.8%].
The estimated average natural indirect effect is 0.8% (resp. [0.0%, 1.6%]),
while the estimated average direct effect is 5.6% (resp. [0.1%, 11.1%]). Our
result suggests that the improvement in the sense of mastery contributed
approximately 12.5% to the total average treatment effect. This finding is
stronger than the original study, which reported the estimated proportion
of this mediating effect to be 7.2%.
4.2. A political framing study. Next, we reanalyze the data from an experiment conducted by Brader, Valentino and Suhay (2008), who studied
the role of emotions for the effect of news stories on the preferences of immigration policies. The authors randomly assigned 351 White non-Latino
adults into two groups. In one group, respondents were shown a newspaper
article with a picture of a Hispanic immigrant. In the other group, the same
article was shown except with a picture of an European immigrant. The
original authors studied the mediation of the framing effect through two
psychological mechanisms: the perceived harm mechanism and the anxiety
mechanism. They assumed that the two mediators are independent but the
assumption may not be plausible because an increased level of perceived
harm of immigration can cause more anxiety about immigration policies.
Therefore, we apply the proposed methodology described in Section 3.1,
which allows for multiple mediators. Specifically, we use the level of perceived harm as W while the level of anxiety is M . We include the same set
of covariates as in the original paper, which includes education, age, income,
and gender.
We find that the news article with a picture of a Latino immigrant leads to
a 0.430 percentage point increase (relative to the same story with a picture

NONPARAMETRIC ESTIMATION OF CAUSAL MEDIATION EFFECTS

29

of an European immigrant) in the opposition of increased immigration on
the five-point scale, with a 95% confidence interval of [0.199, 0.661]. The
combined mediation effect from the perceived harm and anxiety mechanisms
is estimated to be 0.164 (resp. [0.001, 0.327]). This implies that the two
mediators together account for 38% of the total average treatment effect. We
further decompose this combined mediation effect into two partial mediation
effects. The partial indirect effect concerning the perceived harm mechanism
is estimated to be 0.115 (resp. [−0.03, 0.263]) whereas the estimated partial
mediation effect for the anxiety mechanism is 0.049 (resp. [−0.159, 0.257]).
This finding suggests that the anxiety mechanism may play only a secondary
role in the public opinion about immigration policy. Our results contradict
with the original study, which concluded that the anxiety plays an essential
role by assuming that the two mediators are causally independent.
5. Concluding remarks. In this paper, we proposed a novel methodology for causal mediation analysis. We establish that the proposed estimator is fully nonparametric and globally semiparametric efficient. This improves the existing estimators, which rely upon parametric assumptions and
is only locally efficient. Furthermore, we show how to consistently estimate
the asymptotic variance of this proposed estimator without requiring additional nonparametric estimation. Another advantage is the availability of
efficient and stable numerical algorithms that can be used to compute the
proposed estimator and its estimated variance. We show how to extend our
methodology to a setting with multiple mediators and the estimation of
related causal quantities of interest. While causal mediation analysis has
gained popularity in a variety of disciplines, applied researchers have largely
relied upon parametric methods. We believe that our nonparametric estimator has a potential to significantly improve the credibility of causal mediation
analysis in scientific research.
References.
Albert, J. M. (2008). Mediation analysis via potential outcomes models. Statistics in
Medicine 27 1282–1304.
Avin, C., Shpitser, I. and Pearl, J. (2005). Identifiability of Path-Specific Effects. In
Proceedings of the Nineteenth International Joint Conference on Artificial Intelligence
357–363. Morgan Kaufmann, Edinburgh, Scotland.
Baron, R. M. and Kenny, D. A. (1986). The moderator–mediator variable distinction
in social psychological research: Conceptual, strategic, and statistical considerations.
Journal of personality and social psychology 51 1173–1182.
Brader, T., Valentino, N. and Suhay, E. (2008). What Triggers Public Opposition
to Immigration? Anxiety, Group Cues, and Immigration Threat. American Journal of
Political Science 52 959–978.

30

K.C.G. CHAN, K. IMAI, S.C.P. YAM, AND Z. ZHANG

Chan, K. C. G. and Yam, S. C. P. (2014). Oracle, Multiple Robust and Multipurpose
Calibration in a Missing Response Problem. Statistical Science 29 380–396.
Chan, K., Yam, S. and Zhang, Z. (2015). Globally Efficient Nonparametric Inference of
Average Treatment Effects by Empirical Balancing Calibration Weighting. To appear
in Journal of Royal Statistical Society: Series B.
Chen, X., Hong, H. and Tarozzi (2008). Semiparametric efficiency in GMM models
with auxiliary data. The Annals of Statistics 36 808-843.
Deville, J.-C. and Särndal, C.-E. (1992). Calibration estimators in survey sampling.
Journal of the American statistical Association 87 376–382.
Geneletti, S. (2007). Identifying direct and indirect effects in a non-counterfactual
framework. Journal of the Royal Statistical Society, Series B (Statistical Methodology)
69 199–215.
Graham, B. S., Pinto, C. and Egel, D. (2012). Inverse probability tilting for moment
condition models with missing data. Review of Economic Studies 79 1053–1079.
Hahn, J. (1998). On the role of the propensity score in efficient semiparametric estimation
of average treatment effects. Econometrica 315–331.
Hainmueller, J. (2012). Entropy Balancing for Causal Effects: Multivariate Reweighting
Method to Produce Balanced Samples in Observational Studies. Political Analysis 20
25–46.
Han, P. and Wang, L. (2013). Estimation with missing data: beyond double robustness.
Biometrika 100 417–430.
Hansen, L. P., Heaton, J. and Yaron, A. (1996). Finite-sample properties of some
alternative GMM estimators. Journal of Business & Economic Statistics 14 262–280.
Hirano, K., Imbens, G. and Ridder, G. (2003). Efficient estimation of average treatment
effects using the estimated propensity score. Econometrica 71 1161–1189.
Imai, K., Keele, L. and Tingley, D. (2010). A General Approach to Causal Mediation
Analysis. Psychological Methods 15 309–334.
Imai, K., Keele, L. and Yamamoto, T. (2010). Identification, Inference, and Sensitivity
Analysis for Causal Mediation Effects. Statistical Science 25 51–71.
Imai, K. and Ratkovic, M. (2014). Covariate Balancing Propensity Score. Journal of
the Royal Statistical Society, Series B (Statistical Methodology) 76 243–263.
Imai, K. and Yamamoto, T. (2013). Identification and Sensitivity Analysis for Multiple
Causal Mechanisms: Revisiting Evidence from Framing Experiments. Political Analysis
21 141–171.
Imai, K., Keele, L., Tingley, D. and Yamamoto, T. (2011). Unpacking the Black Box
of Causality: Learning about Causal Mechanisms from Experimental and Observational
Studies. American Political Science Review 105 765–789.
Imbens, G. W., Newey, W. K. and Ridder, G. (2005). Mean-square-error calculations
for average treatment effects. IEPR working paper.
Jo, B. (2008). Causal Inference in Randomized Experiments with Mediational Processes.
Psychological Methods 13 314–336.
Joffe, M. M., Small, D., Hsu, C.-Y. et al. (2007). Defining and estimating intervention
effects for groups that will develop an auxiliary outcome. Statistical Science 22 74–97.
Kitamura, Y. and Stutzer, M. (1997). An information-theoretic alternative to generalized method of moments estimation. Econometrica 65 861–874.
Lendle, S. D., Subbaraman, M. S. and van der Laan, M. J. (2013). Identification
and efficient estimation of the natural direct effect among the untreated. Biometrics 69
310–317.
MacKinnon, D. P. (2008). Introduction to statistical mediation analysis. Routledge.
Pearl, J. (2001). Direct and Indirect Effects. Proceedings of the seventeenth conference

NONPARAMETRIC ESTIMATION OF CAUSAL MEDIATION EFFECTS

31

on uncertainty in articial intelligence 411–420.
Pearl, J. (2012). The Causal Mediation Formula: A Guide to the Assessment of Pathways
and Mechanisms. Prevention Science 13 426–436.
Qin, J. and Zhang, B. (2007). Empirical-likelihood-based inference in missing response
problems and its application in observational studies. Journal of the Royal Statistical
Society: Series B (Statistical Methodology) 69 101–122.
Richardson, T. S. and Robins, J. M. (2013). Single World Intervention Graphs
(SWIGs): A Unification of the Counterfactual and Graphical Approaches to Causality Technical Report, University of Washington.
Robins, J. M. (2003). Semantics of causal DAG models and the identification of direct
and indirect effects. In Highly Structured Stochastic Systems (eds., P.J. Green, N.L.
Hjort, and S. Richardson) 70–81. Oxford University Press, Oxford.
Robins, J. M. and Greenland, S. (1992). Identifiability and exchangeability for direct
and indirect effects. Epidemiology 143–155.
Robins, J. M., Rotnitzky, A. and Zhao, L. P. (1994). Estimation of Regression Coefficients When Some Regressors are Not Always Observed. Journal of the American
Statistical Association 89 846–866.
Sobel, M. E. (2008). Identification of Causal Parameters in Randomized Studies with
Mediating Variables. Journal of Educational and Behavioral Statistics 33 230–251.
Tchetgen Tchetgen, E. J. and Shpitser, I. (2012). Semiparametric theory for causal
mediation analysis: efficiency bounds, multiple robustness and sensitivity analysis. The
Annals of Statistics 40 1816–1845.
Ten Have, T. R., Joffe, M. M., Lynch, K. G., Brown, G. K., Maisto, S. A. and
Beck, A. T. (2007). Causal mediation analyses with rank preserving models. Biometrics 63 926–934.
Tseng, P. and Bertsekas, D. P. (1987). Relaxation methods for problems with strictly
convex separable costs and linear constraints. Mathematical Programming 38 303–321.
VanderWeele, T. J. (2009). Marginal structural models for the estimation of direct and
indirect effects. Epidemiology 20 18–26.
VanderWeele, T. J. (2010). Bias formulas for sensitivity analysis for direct and indirect
effects. Epidemiology 21 540–551.
VanderWeele, T. (2015). Explanation in Causal Inference: Methods for Mediation and
Interaction. Oxford University Press.
VanderWeele, T. J. and Vansteelandt, S. (2010). Odds ratios for mediation analysis
for a dichotomous outcome. American journal of epidemiology 172 1339–1348.
VanderWeele, T. J., Vansteelandt, S. and Robins, J. M. (2014). Effect decomposition in the presence of an exposure-induced mediator-outcome confounder. Epidemiology 25 300–306.
Vinokur, A. D. and Schul, Y. (1997). Mastery and inoculation against setbacks as
active ingredients in the JOBS intervention for the unemployed. Journal of consulting
and clinical psychology 65 867–877.
K.C.G. Chan
Department of Biostatistics
University of Washington
E-mail: kcgchan@uw.edu

K. Imai
Department of Politics
Center for Statistics and Machine Learning
Princeton University
E-mail: kimai@princeton.edu

S.C.P. Yam
Z. Zhang
Department of Statistics
Department of Statistics and Actuarial Science
The Chinese University of Hong Kong The University of Hong Kong
E-mail: scpyam@sta.cuhk.edu.hk
E-mail: zzhang1989@gmail.com

