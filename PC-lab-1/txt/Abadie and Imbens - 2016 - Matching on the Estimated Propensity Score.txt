Econometrica, Vol. 84, No. 2 (March, 2016), 781–807

NOTES AND COMMENTS
MATCHING ON THE ESTIMATED PROPENSITY SCORE
BY ALBERTO ABADIE AND GUIDO W. IMBENS1
Propensity score matching estimators (Rosenbaum and Rubin (1983)) are widely
used in evaluation research to estimate average treatment effects. In this article, we derive the large sample distribution of propensity score matching estimators. Our derivations take into account that the propensity score is itself estimated in a first step, prior to
matching. We prove that first step estimation of the propensity score affects the large
sample distribution of propensity score matching estimators, and derive adjustments
to the large sample variances of propensity score matching estimators of the average
treatment effect (ATE) and the average treatment effect on the treated (ATET). The
adjustment for the ATE estimator is negative (or zero in some special cases), implying
that matching on the estimated propensity score is more efficient than matching on the
true propensity score in large samples. However, for the ATET estimator, the sign of
the adjustment term depends on the data generating process, and ignoring the estimation error in the propensity score may lead to confidence intervals that are either too
large or too small.
KEYWORDS: Matching estimators, propensity score matching, average treatment effects, causal inference, program evaluation.

1. INTRODUCTION
PROPENSITY SCORE MATCHING ESTIMATORS (Rosenbaum and Rubin (1983))
are widely used to estimate treatment effects.2 Rosenbaum and Rubin (1983)
defined the propensity score as the conditional probability of assignment to a
treatment given a vector of covariates. Suppose that adjusting for a set of covariates is sufficient to eliminate confounding. The key insight of Rosenbaum
and Rubin (1983) is that adjusting only for the propensity score is also sufficient to eliminate confounding. Relative to matching directly on the covariates,
propensity score matching has the advantage of reducing the dimensionality of
matching to a single dimension. This greatly facilitates the matching process
1
We are grateful to the editor and three referees for helpful comments, to Ben Hansen, Judith Lok, James Robins, Paul Rosenbaum, Donald Rubin, and participants in many seminars for
comments and discussions, and to Jann Spiess for expert research assistance. Financial support
by the NSF through Grants SES 0820361 and SES 0961707 is gratefully acknowledged.
2
Following the terminology in Abadie and Imbens (2006), the term “matching estimator” is
reserved in this article to estimators that match each unit (or each unit of some sample subset, e.g.,
the treated) to a small number of units with similar characteristics in the opposite treatment arm.
Thus, our discussion does not refer to regression imputation methods, like the kernel matching
method of Heckman, Ichimura, and Todd (1998), which use a large number of matches per unit
and nonparametric smoothing techniques to consistently estimate unit-level regression values
under counterfactual treatment assignments. See Hahn (1998), Heckman, Ichimura, and Todd
(1998), Imbens (2004), and Imbens and Wooldridge (2009) for a discussion of such estimators.

© 2016 The Econometric Society

DOI: 10.3982/ECTA11293

782

A. ABADIE AND G. W. IMBENS

because units with dissimilar covariate values may nevertheless have similar
values for their propensity scores.
In observational studies, propensity scores are not known, so they have to
be estimated prior to matching. In spite of the great popularity that propensity
score matching methods have enjoyed since they were proposed by Rosenbaum
and Rubin in 1983, their large sample distribution has not yet been derived for
the case when the propensity score is estimated in a first step.3 A possible reason for this void in the literature is that matching estimators are non-smooth
functionals of the distribution of the matching variables, which makes it difficult to establish an asymptotic approximation to the distribution of matching estimators when a matching variable is estimated in a first step. This has
motivated the use of bootstrap standard errors for propensity score matching
estimators. However, recently it has been shown that the bootstrap is not, in
general, valid for matching estimators (Abadie and Imbens (2008)).4
In this article, we derive large sample approximations to the distribution of
propensity score matching estimators. Our derivations take into account that
the propensity score is itself estimated in a first step. We show that propensity
matching estimators have approximately Normal distributions in large samples. We demonstrate that first step estimation of the propensity score affects
the large sample distribution of propensity score matching estimators, and derive adjustments to the large sample variance of propensity score matching
estimators that correct for first step estimation of the propensity score. We do
this for estimators of the average treatment effect (ATE) and the average treatment effect on the treated (ATET). The adjustment for the ATE estimator is
negative (or zero in some special cases), implying that matching on the estimated propensity score is more efficient than matching on the true propensity
score in large samples. As a result, treating the estimated propensity score as
it was the true propensity score for estimating the variance of the ATE estimator leads to conservative confidence intervals. However, for the ATET estimator, the sign of the adjustment depends on the data generating process, and
ignoring the estimation error in the propensity score may lead to confidence
intervals that are either too large or too small.
2. MATCHING ESTIMATORS
The setup in this article is a standard one in the program evaluation literature, where the focus of the analysis is often the effect of a binary treatment,
3
Influential papers using matching on the estimated propensity score include Heckman,
Ichimura, and Todd (1997), Dehejia and Wahba (1999), and Smith and Todd (2005).
4
In contexts other than matching, Heckman, Ichimura, and Todd (1998), Hirano, Imbens, and
Ridder (2003), Abadie (2005), Wooldridge (2007), and Angrist and Kuersteiner (2011) derived
large sample properties of statistics based on a first step estimator of the propensity score. In
all these cases, the second step statistics are smooth functionals of the propensity scores and,
therefore, standard stochastic expansions for two-step estimators apply (see, e.g., Newey and
McFadden (1994)).

MATCHING ON THE ESTIMATED PROPENSITY SCORE

783

represented in this paper by the indicator variable W , on some outcome variable, Y . More specifically, W = 1 indicates exposure to the treatment, while
W = 0 indicates lack of exposure to the treatment. Following Rubin (1974),
we define treatment effects in terms of potential outcomes. We define Y (1) as
the potential outcome under exposure to treatment, and Y (0) as the potential
outcome under no exposure to treatment. Our goal is to estimate the average
treatment effect,


τ = E Y (1) − Y (0) 
where the expectation is taken over the population of interest. Alternatively,
the goal may be estimation of the average effect for the treated,


τt = E Y (1) − Y (0)|W = 1 
Estimation of these average treatment effects is complicated by the fact that for
each unit in the population, we observe at most one of the potential outcomes:

Y (0) if W = 0,
Y=
Y (1) if W = 1.
Let X be a vector of covariates of dimension k. The propensity score is p(X) =
Pr(W = 1|X), and p∗ = Pr(W = 1) is the probability of being treated. The
following assumption is often referred to as “strong ignorability” (Rosenbaum
and Rubin (1983)). It means that adjusting for X is sufficient to eliminate all
confounding.
ASSUMPTION 1: (i) Y (1) Y (0) ⊥⊥ W |X almost surely; (ii) p ≤ p(X) ≤ p
almost surely, for some p > 0 and p < 1.
Assumption 1(i) uses the conditional independence notation in Dawid
(1979). This assumption is often referred to as “unconfoundedness.” It will
hold, for example, if all confounders are included in X, so that after controlling for X, treatment exposure is independent of the potential outcomes. Hahn
(1998) derived asymptotic variance bounds and studied asymptotically efficient
estimation under Assumption 1(i). Assumption 1(ii) implies that, for almost all
values of X, the population includes treated and untreated units. Moreover,
Assumption 1(ii) bounds the values of the propensity score away from zero
and 1. Khan and Tamer (2010) have shown that this condition is necessary for
root-N consistent estimation of the average treatment effect.
Let μ(w x) = E[Y |W = w X = x] and σ 2 (w x) = var(Y |W = w X = x)
be the conditional mean and variance of Y given W = w and X = x. Similarly, let μ̄(w p) = E[Y |W = w p(X) = p] and σ̄ 2 (w p) = var(Y |W = w
p(X) = p) be the conditional mean and variance of Y given W = w and

784

A. ABADIE AND G. W. IMBENS

p(X) = p. Under Assumption 1,


τ = E μ(1 X) − μ(0 X)
and


τt = E μ(1 X) − μ(0 X)|W = 1
(see Rubin (1974)). Therefore, adjusting for differences in the distribution of
X between treated and nontreated removes all confounding and, therefore,
allows identification of ATE and ATET. Rosenbaum and Rubin (1983) proved
that W and X are independent conditional on the propensity score, p(X),
which implies that under Assumption 1:
 



τ = E μ̄ 1 p(X) − μ̄ 0 p(X)
and
 




τt = E μ̄ 1 p(X) − μ̄ 0 p(X) |W = 1 
In other words, under Assumption 1, adjusting for the propensity score only
is enough to remove all confounding. This result motivates the use of propensity score matching estimators. A propensity score matching estimator for the
average treatment effect can be defined as

τN∗ =

N
1 
1 
(2Wi − 1) Yi −
Yj 
N i=1
M j∈J (i)
M

where M is a fixed number of matches per unit and JM (i) is the set of matches
τN∗ indicates that matching is done on the true
for unit i.5 (The superscript ∗ on 
propensity score.) For concreteness, in this article we will consider matching
with replacement, so each unit in the sample can be used as a match multiple
times. In the absence of matching ties, the set of matches JM (i) can formally
5
In typical applications, M is small, often M = 1. Choosing a small M reduces finite sample
biases caused by matches of poor quality, that is, matches between individuals with substantial
differences in their propensity score values. Larger values of M produce lower large sample variances (see Abadie and Imbens (2006, Section 3.4)), and one could consider increasing M in a
particular application if such increase has a small effect on the size of the matching discrepancies, which are observed in the data (Abadie and Imbens (2011)). Similarly to Yatchew’s (1997)
work on semiparametric differencing estimators, we derive a large sample approximation to the
distribution of matching estimators for fixed values of M. Large sample approximations based
on fixed values of smoothing parameters have been shown to increase accuracy in other contexts
(see, in particular, Kiefer and Vogelsang (2005)).

MATCHING ON THE ESTIMATED PROPENSITY SCORE

785

be defined as


JM (i) = j = 1     N : Wj = 1 − Wi 


1[|p(Xi )−p(Xk )|≤|p(Xi )−p(Xj )|] ≤ M 

k:Wk =1−Wi

where 1[·] is a binary indicator that takes value 1 if the event inside brackets
is true, and value zero if not. For the average effect on the treated, τt , the
corresponding estimator is
∗
tN


τ

N
1 
1 
=
Wi Yi −
Yj 
N1 i=1
M j∈J (i)
M

N

where N1 = i=1 Wi is the number of treated units in the sample.
∗
τtN
can be easily derived from reThe large sample distributions of 
τN∗ and 
sults on matching estimators in Abadie and Imbens (2006), applied to the case
where the only matching variable is the known propensity score. However, one
of the assumptions in Abadie and Imbens (2006) requires that the density of
the matching variables is bounded away from zero. Although this assumption
may be appropriate in settings where the matching is carried out directly on
the covariates, X, it is much less appealing for propensity score matching estimators. For example, if the propensity score has the form p(X) = F(X  θ),
then even if the density of X is bounded away from zero on its support, the
density of F(X  θ) will generally not be bounded away from zero on its support. We therefore generalize the results in Abadie and Imbens (2006) to allow the density of propensity score to take values that are arbitrarily close to
zero.
ASSUMPTION 2: (i) The propensity score p(X) is continuously distributed, has
interval support [p p], and has a density that is a continuous function on [p p];
(ii) for w = 0 1, μ̄(w p) and σ̄ 2 (w p) are Lipschitz-continuous and continuous
in p, respectively; (iii) for w = 0 1, there exists δ > 0 such that E[|Y |2+δ |W = w
p(X) = p] is uniformly bounded.
ASSUMPTION 3: {(Yi  Wi  Xi )}Ni=1 are independent draws from the distribution
of (Y W  X).
∗
The next proposition presents the large sample distributions of 
τN∗ and 
τtN
under Assumptions 1–3.

PROPOSITION 1: Suppose Assumptions 1–3 hold. Then, (i)
√  ∗
 d 

N 
τN − τ → N 0 σ 2 

786

A. ABADIE AND G. W. IMBENS

where
 



2 
σ 2 = E μ̄ 1 p(X) − μ̄ 0 p(X) − τ

+ E σ̄ 1 p(X)
2



1
1
1
+
− p(X)
p(X) 2M p(X)





+ E σ̄ 2 0 p(X)


1
1
1
+
− 1 − p(X)
×
1 − p(X) 2M 1 − p(X)




and (ii)
√  ∗
 d 

N 
τtN − τt → N 0 σt2 
where
σt2 =

2 

 



2 E p(X) μ̄ 1 p(X) − μ̄ 0 p(X) − τt
E p(X)


1

+

 2


2 E σ̄ 1 p(X) p(X)
E p(X)

+



2
2 E σ̄ 0 p(X)
E p(X)

×




1

1

1
1 p2 (X)
p2 (X)
+ p(X) +
1 − p(X) M
2M 1 − p(X)




The proof of this proposition is available in the Supplemental Material
(Abadie and Imbens (2016)).
Motivated by the fact that, in observational studies, propensity scores are
not known, we are interested in the case where matching is not on the true
propensity score p(X), but on an estimate of the propensity score. Following
Rosenbaum and Rubin (1983) and most of the empirical literature, we consider
a generalized linear specification for the propensity score, p(x) = F(x θ). In
empirical research, the link function F is usually specified as Logit or Probit.
It is straightforward to extend our results to more general parametric models
for the propensity score.6 For unit i, and for arbitrary values for θ, let JM (i θ)
6

Misspecification of the propensity score typically leads to inconsistency of the treatment effect
estimator, unless the misspecified propensity score constitutes a balancing score, that is, a function, b(X), of the covariates such that X ⊥⊥ W |b(X) (see Rosenbaum and Rubin (1983)). Moti-

MATCHING ON THE ESTIMATED PROPENSITY SCORE

787

denote the set of M matches where we match on F(X  θ):

JM (i θ) = j = 1     N : Wj = 1 − Wi 


1[|F(Xi θ)−F(Xk θ)|≤|F(Xi θ)−F(Xj θ)|] ≤ M 

k:Wk =1−Wi

The matching estimator for the average treatment effect where we match on
F(X  θ) is then

τN (θ) =

N
1 
1
(2Wi − 1) Yi −
N i=1
M



Yj 

j∈JM (iθ)

Let θ∗ denote the true value of the propensity score model parameter vector, so that p(X) = F(X  θ∗ ). Then, the estimator based on matching on the
true propensity score can be written as 
τN∗ = 
τN (θ∗ ). We are interested in the
case where 
τN (θ) is evaluated at an estimator 
θN of θ∗ , based on a sample
N
{Yi  Wi  Xi }i=1 . We focus on the case where 
θN is the maximum likelihood esti7
mator of θ:

θN = arg max L(θ|W1  X1      WN  XN )
θ

where the log-likelihood function is
L(θ|W1  X1      WN  XN )
=

N







Wi ln F Xi θ + (1 − Wi ) ln 1 − F Xi θ 

i=1

The propensity score matching estimator of τ that matches on the estimated
propensity score can now be written as
N
1 
1

τN = 
τN (
θN ) =
(2Wi − 1) Yi −
N i=1
M



Yj 

j∈JM (i
θN )

vated by this consideration, empirical researchers routinely use measures of balance in the distribution of the covariates between treated and nontreated, conditional on the estimated propensity score, to perform specification searches on the propensity score (see, e.g., Dehejia and Wahba
(1999)). An alternative safeguard against misspecification of the propensity score is the use “doubly robust” matching estimators, like the bias-corrected matching estimator of Abadie and Imbens (2011).
7
It is straightforward to extend our results to other asymptotically linear estimators of θ∗ .

788

A. ABADIE AND G. W. IMBENS

Similarly, the propensity score matching estimator of τt that matches on the
estimated propensity score can be written as
1 
1
=
τtN (
θN ) =
Wi Yi −
N1 i=1
M
N


τtN



Yj 

j∈JM (i
θN )

Whenever confusion is possible, we will be explicit in the dependence of the
matching estimators on θ. If the argument is omitted, 
τN and 
τtN are used as
θN ) and 
τtN (
θN ), respectively.
shorthand for 
τN (
The two main questions addressed in this article are (i) do the estimators
based on matching on the estimated propensity score have Normal large sample distributions, and (ii) if so, how does their large sample variance compare to
that of the estimators that match on the true propensity score, given in Proposition 1? In the next section, we answer these two questions and derive the
θN ) and 
τtN (
θN ). Conventional linearization
large sample distribution of 
τN (
methods for two-step statistics are difficult to apply in the context of matching
estimators because matching estimators are complicated functionals of the distribution of the data. We therefore follow a different route, building on work
by Andreou and Werker (2012) on residual based statistics, and the martingale
representations for matching estimators derived in Abadie and Imbens (2012).
3. LARGE SAMPLE DISTRIBUTION
In the first part of this section, we derive the large sample approximation
θN ), and in the second part, we present the
to the sampling distribution of 
τN (
θN ).
results for 
τtN (
Let P θ be the distribution of Z = {Y W  X} induced by the propensity score,
F(X  θ), the marginal distribution of X, and the conditional distribution of Y
given X and W . We index this distribution P θ by θ, and will consider properties
of estimators for different values of θ, under the same marginal distribution
for X, and the same conditional distribution for Y given W and X. Given
Assumption 1, the average treatment effect is equal to




τ = E Y (1) − Y (0) = E E[Y |W = 1 X] − E[Y |W = 0 X] 
From this equation, it can be seen that ATE does not depend on the propensity
score; it only depends on the conditional distribution of Y given W and X and
the marginal distribution of X. The average treatment effect for the treated is


τt = E Y (1) − Y (0)|W = 1


= E E[Y |W = 1 X] − E[Y |W = 0 X]|W = 1
 


E F X  θ∗ E[Y |W = 1 X] − E[Y |W = 0 X]




=
E F X  θ∗

MATCHING ON THE ESTIMATED PROPENSITY SCORE

789

In contrast to the average treatment effect, τ, the average treatment effect for
the treated, τt , depends on the propensity score, and we make this dependence
explicit by indexing τt by θ wherever appropriate. In particular, τt = τt (θ∗ ) is
the average effect of the treatment on the treated.
To derive the large sample distribution of 
τN and 
τtN , we invoke some additional regularity conditions. First, we extend Assumption 2 to hold for all θ in
a neighborhood of θ∗ .
ASSUMPTION 4: (i) θ∗ ∈ int(Θ) with Θ compact, X has a bounded support,
and E[XX  ] is nonsingular; (ii) F : R → (0 1) is continuously differentiable with
strictly positive and bounded derivative f ; (iii) there exists a component of X that
is continuously distributed, has nonzero coefficient in θ∗ , and admits a continuous
density function conditional on the rest of X; and (iv) there exists ε > 0 such that,
for all θ with θ − θ∗ ≤ ε, E[Y |W = w F(X  θ) = p] is Lipschitz-continuous in
p, var(Y |W = w F(X  θ) = p) is continuous in p, and there is δ > 0 such that
E[|Y |2+δ |W = w F(X  θ) = p] is uniformly bounded.
The case of only discrete regressors is left out from Assumption 4, but, as
noted in Abadie and Imbens (2006), it is a simple case to treat separately.
With only discrete regressors, each observation (or each treated observation
in the case of ATET) can be matched to every observation with identical estimated propensity score value in the opposite treatment arm. In this case, the
propensity score matching estimator is identical to the subclassification estimator in Cochran (1968) and Angrist (1998), and valid analytical and bootstrap
standard errors can be easily derived.
We will study the behavior of certain statistics under sequences θN that are
local to θ∗ . Consider ZNi = {YNi√
 WNi  XNi } with distribution given by the loθN
∗
cal “shift” P with θN = θ + h/ N, where h is a conformable vector of constants. Let ΛN (θ|θ ) be the difference between the value of the log-likelihood
function evaluated at θ and the value of the log-likelihood function evaluated
at θ :




ΛN θ|θ = L(θ|ZN1      ZNN ) − L θ |ZN1      ZNN 
Let ΔN (θ) be the normalized score function, or central sequence,
1 ∂
ΔN (θ) = √
L(θ|ZN1      ZNN )
N ∂θ
  
N
  
WNi − F XNi
θ
1 
   f XNi
XNi   
θ 
=√
F XNi θ 1 − F XNi θ
N i=1

790

A. ABADIE AND G. W. IMBENS

Finally, let
2


f X θ
   XX 
Iθ = E   
F X θ 1−F X θ
be the Fisher Information Matrix for θ. The expectation in this equation is
taken over the marginal distribution of X, which does not depend on θ, so the
indexing by θ solely reflects the value of θ where f (X  θ) and F(X  θ) are evaluated. The following intermediate lemma derives some important regularity
properties of the propensity score model that will be needed for our derivations.
LEMMA 1: Suppose that Assumptions 3, 4(i), and 4(ii) hold. Then, under P θN ,
(1)



1
ΛN θ∗ |θN = −h ΔN (θN ) − h Iθ∗ h + op (1)
2

(2)

ΔN (θN ) → N(0 Iθ∗ )

d

where Iθ∗ is not singular, and
(3)

√
N(
θN − θN ) = Iθ−1
∗ ΔN (θN ) + op (1)

The proof of this proposition is available in the Supplemental Material
(Abadie and Imbens (2016)). For regular parametric models, equation (1) can
be established using Proposition 2.1.2 in Bickel, Klaassen, Ritov, and Wellner (1998). Also for regular parametric models, equation (2) is derived in
the proof of Proposition 2.1.2 in Bickel et al. (1998). Equation (3) can be
established using the same set of results in combination with classical conditions for asymptotic linearity of maximum likelihood estimators (see, e.g.,
van der Vaart (1998, Theorem 5.39), Lehmann and Romano (2005, Theorem 12.4.1)).
Let Eθ be the expectation operator with respect to the distributions P θ . The
following assumption is a regularity condition that will be used later in this
section.
ASSUMPTION 5: EθN [r(Y W  X)|W  F(X  θN )] converges to E[r(Y W  X)|
W  F(X  θ∗ )] almost surely, for any Rk+2 -to-R bounded and measurable function,
r(y w x), continuous in x, and any sequence, θN → θ∗ .
Primitive conditions for this assumption are provided in the Supplemental
Material.

MATCHING ON THE ESTIMATED PROPENSITY SCORE

791

θN )
3.1. Large Sample Distribution for 
τN (
√
τN − τ) is based on the techOur derivation of the limit distribution of N(
niques developed in Andreou and Werker (2012) to analyze the limit distribution of residual-based statistics.
derive the
√ We proceed in√three steps. First, we
∗

τN (θN ) − τ) N(θ − θN ) ΛN (θ |θN )) under
joint limit distribution of ( N(
P θN .
PROPOSITION 2: Suppose that Assumptions 1–5 hold. Then, under P θN ,
⎞
⎛√ 
N 
τN (θN ) − τ
⎝ √N(
θ −θ ) ⎠
 N∗ N
ΛN θ |θN
⎛
⎞⎞
 ⎛ σ2
c  Iθ−1
−c  h
∗
0
d
 ⎝ Iθ−1
→N⎝
0
Iθ−1
−h ⎠⎠ 
∗ c
∗



−h Iθ∗ h/2
−h c −h h Iθ∗ h
where
(4)




cov X μ(1 X)|F X  θ∗


c=E
F X  θ∗






cov X μ(0 X)|F X  θ∗
  ∗
f X  θ∗ 
+
1−F X θ

All proofs for the results in this section are provided
in the Appendix.
√
∗
τN (θN ) − τ), under P θ
Asymptotic Normality of the first component, N(
follows from
joint Normality of the last two com√ Proposition 1. Asymptotic
θN − θN ) and ΛN (θ∗ |θN ), follows from Lemma 1. Proposition 2
ponents, N(
derives the joint large sample distribution of the three components under P θN .
The proof extends the martingale techniques of Abadie and Imbens (2012) to
derive the result of the proposition.
In the second step of our argument, we use Le Cam’s third lemma (e.g.,
van der Vaart (1998, p. 90)). Given the result of Proposition 2, Le Cam’s third
∗
lemma implies that, under P θ ,
√ 

σ 2 c  Iθ−1
N 
τN (θN ) − τ
∗
d
−c  h
√

→N
 −1
−1
−h

I
c
I
N(θN − θN )
θ∗
θ∗
√
∗
Substituting θN = θ∗ + h/ N, this implies that (still under P θ ), for any h ∈ Rk ,
√ 
√   ∗

σ 2 c  Iθ−1
N 
τN θ + h/ N − τ
∗
d
−c  h
√ 
(5)

→
N


−1
−1
∗
0

Iθ∗ c Iθ∗
N θN − θ

792

A. ABADIE AND G. W. IMBENS

If equation (5) was an exact result rather than an approximation based on convergence in distribution, it would directly lead to the result of interest. In that
case, it would follow that
√   ∗
√ 
√ 

θN − θ∗
N 
τN θ + h/ N − τ | N 


= h ∼ N 0 σ 2 − c  Iθ−1
∗ c
√
∗
∗

(see,
√ e.g., Goldberger (1991, p. 197)). Because
√N(θN − θ ) = h implies θ +
∗
h/ N = 
θN , and thus implies that 
τN (θ + h/ N) = 
τN (
θN ) = 
τN , the last
displayed equation can also be written as
√
√


N(
τN − τ)| N(
θN − θ) = h ∼ N 0 σ 2 − c  Iθ−1
∗ c 
Because this conditional distribution does not depend on h, this in turn implies
∗
that, under P θ , unconditionally,
√


N(
τN − τ) ∼ N 0 σ 2 − c  Iθ−1
∗ c 
which is the result we are looking for: the distribution of the matching estimator based on matching on the estimated propensity score.
√
A
challenge
formalizing
this
argument
is
that
convergence
of
N(
τN − τ)|
√
N(
θN − θ∗ ) = h involves convergence in a conditioning event. To overcome
this challenge, in the third step of the argument, we employ a Le Cam discretization device, as proposed in Andreou
√ and Werker (2012). Consider a
grid of cubes in Rk with sides of length d/ N, for arbitrary positive d. Then
θ̄N is the discretized estimator, defined as the midpoint of the cube 
θN belongs

to. If 
θNj is the jth component
of
the
k-vector
θ
,
then
the
jth
component
of
N
√
√

the k-vector θ̄N is θ̄Nj = (d/ N)[ N θNj /d], where [·] is the nearest integer
function. Now we can state the main result of the paper.
∗

THEOREM 1: Suppose Assumptions 1–5 hold. Then, under P θ ,
lim lim Pr
d↓0 N→∞



=

z
−∞

√  2
−1/2 


N σ − c  Iθ−1

τN (θ̄N ) − τ ≤ z
∗ c

1
1
√ exp − x2 dx
2
2π

An
√ implication of Theorem 1 is that we can approximate the distribution
τN (
θN ) − τ) by a Normal distribution with mean zero and variance
of N(
σ 2 − c  Iθ−1
∗ c. The result in Theorem 1 indicates that the adjustment to the stan-

MATCHING ON THE ESTIMATED PROPENSITY SCORE

793

dard error of the propensity score matching estimator for first step estimation
of the propensity score is always negative, or zero in some special cases as discussed below. This implies that using matching on the estimated propensity
score, rather than on the true propensity score, to estimate ATE increases precision in large samples. As we will see later, this gain in precision from using
the estimated propensity score does not necessarily hold for the estimation of
parameters different than ATE.
Equation (4) and the fact that X and W are independent conditional on
the propensity score imply that if the covariance of X and μ(W  X) given
F(X  θ∗ ) and W is equal to zero, then c = 0 and first step estimation
of the
√
θN − θ∗ ).
propensity score does not affect the large sample variance of N(
This would be the case if the propensity score provides no “dimension reduction,” that is, if the propensity score is a bijective function of X. In that
case, each value of the propensity score corresponds to only one value of X, so
cov(X μ(W  X)|W  F(X  θ∗ )) = 0 and, therefore, c = 0.
For concreteness, our derivations focus on the case of matching with replacement. However, as shown in Abadie and Imbens (2012), martingale representations analogous to the one employed in the proof of Proposition 2 exist for
alternative matching estimators (e.g., estimators that construct the matches
without using replacement). An inspection of the proof of Proposition 2 reveals
that the adjustment term, −c  Iθ∗ c, does not depend on the type of matching
employed to obtain the estimators. Therefore, the result in Theorem 1 translates easily to other matching settings. A different type of matching scheme
may change the form of σ 2 in the result of Theorem 1, but not the adjustment
term, −c  Iθ∗ c.
3.2. Large Sample Distribution for 
τtN

√
In this section, we consider the asymptotic distribution for N(
τtN −
τt (θ∗ )). The derivations are similar to those for the case of ATE, so we relegate details to the Supplemental Material. The following theorem provides
the result.
THEOREM 2: Suppose Assumptions 1–5 hold, and let
ct =

 
 






1
   ∗  E Xf X  θ∗ μ̄ 1 F X  θ∗ − μ̄ 0 F X  θ∗ − τt
E F Xθ



1
   ∗  E cov X μ(1 X)|F X  θ∗
E F Xθ




  ∗    ∗ 
F X  θ∗


cov X μ(0 X)|F X θ
+
f Xθ 
1 − F X  θ∗
+

794

A. ABADIE AND G. W. IMBENS
∗

Then, under P θ ,
lim lim Pr
d↓0 N→∞

√

 
 
∂τt θ∗ −1 ∂τt θ∗
N σ −c I c +
Iθ∗
∂θ
∂θ
2
t

 −1
t θ∗ t

−1/2



× 
τtN (θ̄N ) − τt ≤ z

=

z
−∞

1
1
√ exp − x2 dx
2
2π

Notice that, in contrast to the ATE case, the adjustment for first step estimation of the propensity score for the ATET estimator may result in a decrease or an increase in the standard error. The adjustment to the standard
error of the ATET estimator will be positive, for example, if the propensity
score does not provide “dimension reduction,” so ct = 0, and ∂τt (θ∗ )/∂θ = 0
(which will typically be the case if the average effect of the treatment varies
with the covariates, X). In contrast, if ct = 0 and ∂τt (θ∗ )/∂θ = 0, the adjustment is negative. Like for the case of ATE, it can be shown that the adjustment term does not depend on the particular type of matching estimator of
ATET.
4. ESTIMATION OF THE ASYMPTOTIC VARIANCE
In this section, we discuss estimation of the large sample variances of ATE
and ATET adjusting for first step estimation of the propensity
score. As shown
√
τN − τ) is
in the previous section, the asymptotic variance for N(
(6)

2
σadj
= σ 2 − c  Iθ−1
∗ c

(7)

√

N(
τtN − τt ) is
 
 
∂τt θ∗ −1 ∂τt θ∗
2
2
 −1

σtadj = σt − ct Iθ∗ ct +
Iθ∗
∂θ
∂θ

and the asymptotic variance for

2
2
and σtadj
, we define estimators of each of the components of
To estimate σadj
the right-hand sides of equations (6) and (7). First, estimation of the information matrix, Iθ∗ , is standard:

2
N

θN
f Xi
1




 Xi Xi 
Iθ∗ =
N i=1 F Xi
θN 1 − F Xi
θN

Consider next estimation of the variances corresponding to matching on the
true propensity score, σ 2 and σt2 . For these components, we use estimators

MATCHING ON THE ESTIMATED PROPENSITY SCORE

795

that are based on those in Abadie and Imbens (2006). Let KMθ (i) be the
number of times that observation i is used as a match (when matching on
F(X  θ)):
(8)

KMθ (i) =

N


1[i∈JM (jθ)] 

j=1

and let 
σ̄ (Wi  F(Xi θ∗ )) be an asymptotically unbiased (but not necessarily
consistent) estimator of σ̄ 2 (Wi  F(Xi θ∗ )). The Abadie and Imbens (2006) variance estimators are
2


σ2 =

N
1 
1
(2Wi − 1) Yi −
N i=1
M

+

N
1 
N i=1

KMθ (i)
M

2

+



2

τN
Yj − 

j∈JM (i
θ)

2M − 1 KMθ (i)
M
M



2

σ̄ Wi  F Xi θ∗

and

σt2 =

N
N 
1
Wi Yi −
2
M
N1 i=1



2

Yj − 
τtN

j∈JM (i
θ)



N


KMθ (i) KMθ (i) − 1
N 
2

σ̄ Wi  F Xi θ∗ 
+ 2
(1 − Wi )
2
N1 i=1
M
To obtain the estimator 
σ̄ (Wi  F(Xi θ∗ )), let HL (i θ) be the set of units in
the same treatment arm as unit i that have the closest L values of F(X  θ) to
F(Xi θ),

HL (i θ) = j = 1     N : Wj = Wi 
2



1[|F(Xi θ)−F(Xk θ)|≤|F(Xi θ)−F(Xj θ)|] ≤ L 

k:Wk =Wi

where L is generic notation for a (small) positive integer. Later, we will also
use the set HL(−i) (i θ), which is similarly defined but excludes i:

(−i)
HL (i θ) = j = 1     N : i = j Wj = Wi 

k:Wk =Wi k=i

1[|F(Xi θ)−F(Xk θ)|≤|F(Xi θ)−F(Xj θ)|] ≤ L 

796

A. ABADIE AND G. W. IMBENS

The sets HL (i θ), HL(−i) (i θ), and JL (i θ) (this last one defined in Section 2)
2
2
and σtadj
. The value
will be used to estimate the different components of σadj
of L can vary for different components.
For L ≥ 2 (typically, L = 2), consider the following matching estimator of
σ̄ 2 (Wi  F(Xi θ∗ )):


2

σ̄ Wi  F Xi θ∗ =

1
L−1


j∈HL (i
θN )

Yj −

1
L



2

Yk



k∈HL (i
θN )

2
That is, 
σ̄ (Wi  F(Xi θ∗ )) is a local variance estimator that uses information
only from units with the same value of W as unit i and with similar values of
2
θN ). Because 
θN − θ∗ converges in probability to zero, 
σ̄ (Wi  F(Xi θ∗ ))
F(X 
becomes asymptotically unbiased as N → ∞. But because L is fixed, the vari2
2
σ̄ (Wi  F(Xi θ∗ )) is not
ance of 
σ̄ (Wi  F(Xi θ∗ )) does not converge to zero and 
consistent for σ̄ 2 (Wi  F(Xi θ∗ )). The objects of interest, however, are σ 2 and
σ 2 and 
σt2 average terms that
σt2 , rather than σ̄ 2 (Wi  F(Xi θ∗ )). The estimators 
are bounded in probability and asymptotically unbiased. As a result, as shown
σt2 are consistent for σ 2 and σt2 , respecin Abadie and Imbens (2006), 
σ 2 and 
tively.
Next consider estimation of c and ct . Notice first that




cov X Y |F X  θ∗  W = 1




= cov X μ(1 X)|F X  θ∗  W = 1




+ cov X Y − μ(1 X)|F X  θ∗  W = 1



= cov X μ(1 X)|F X  θ∗




+ cov X Y − μ(1 X)|F X  θ∗  W = 1 

Using the Law of Iterated Expectations,




cov X Y − μ(1 X)|F X  θ∗  W = 1


 
 
= E X Y − μ(1 X) |F X  θ∗  W = 1




− E X|F X  θ∗  W = 1




× E Y − μ(1 X)|F X  θ∗  W = 1


 
 
= E X μ(1 X) − μ(1 X) |F X  θ∗  W = 1




− E X|F X  θ∗  W = 1




× E μ(1 X) − μ(1 X)|F X  θ∗  W = 1
= 0

797

MATCHING ON THE ESTIMATED PROPENSITY SCORE

Therefore,








cov X μ(1 X)|F X  θ∗ = cov X Y |F X  θ∗  W = 1 

and the analogous result is valid conditional on Wi = 0:







cov X μ(0 X)|F X  θ∗ = cov X Y |F X  θ∗  W = 0 
If Wi = w, cov(Xi  μ(w Xi )|F(Xi θ∗ )) can be estimated as



c
ov Xi  μ(w Xi )|F Xi θ∗
=

1
L−1



Xj −

j∈HL (i
θN )

1
L



Xk

Yj −

k∈HL (i
θN )

1
L



Yk 

k∈HL (i
θN )

for L ≥ 2 (typically, L = 2). If Wi = w, then



c
ov Xi  μ(w Xi )|F Xi θ∗
=

1
L−1


j∈JL (i
θN )

Xj −

1
L



Xk

Yj −

k∈JL (i
θN )

1
L



Yk 

k∈JL (i
θN )

also for L ≥ 2 (typically, L = 2). Like 
σ̄ (Wi  F(Xi θ∗ )), the estimators
 ∗
c
ov(Xi  μ(w Xi )|F(Xi θ )) are asymptotically unbiased and bounded in probability. This allows us to construct a consistent analog estimator of c that averages c
ov(Xi  μ(w Xi )|F(Xi θ∗ )) over the sample:



N
ov Xi  μ(1 Xi )|F Xi θ∗
1  c



c=
N
F Xi
θN
2

i=1






c
ov Xi  μ(0 Xi )|F Xi θ∗
  
f Xi
θN 
+

1 − F Xi θN
For ct , we propose separate estimators for the two components, ct1 and ct2 ,
where
 

1
ct1 =    ∗  E Xf X  θ∗
E F Xθ





 

× μ̄ 1 F X  θ∗ − μ̄ 0 F X  θ∗ − τt 
ct2 =




1
   ∗  E cov X μ(1 X)|F X  θ∗
E F Xθ




  ∗    ∗ 
F X  θ∗


cov X μ(0 X)|F X θ
+
f Xθ 
1 − F X  θ∗

798

A. ABADIE AND G. W. IMBENS

and ct = ct1 + ct2 . The second component, ct2 , is similar to ct , and our proposed estimator for ct2 is correspondingly similar to the estimator for c:
(9)


ct2 =

N



1 
c
ov Xi  μ(1 Xi )|F Xi θ∗
N1 i=1



   

F Xi
θN
   c
ov Xi  μ(0 Xi )|F Xi θ∗
θN 
+
f Xi 

1 − F Xi θN

The first component, ct1 , involves the regression functions μ̄(w F(X  θ∗ )). We
estimate these regression functions using matching:





μ̄ 0 F Xi θ∗ =

⎧
1
⎪
⎪
⎪
⎪
⎨L
1
⎪
⎪
⎪
⎪
⎩L


(−i)

j∈HL

Yj

if Wi = 0,

(i
θN )



Yj

if Wi = 1,

j∈JL (i
θN )

and
⎧
1 
⎪
⎪
Yj
⎪
⎪

  ∗  ⎨ L j∈JL (iθN )

μ̄ 1 F Xi θ = 1

⎪
⎪
Yj
⎪
⎪L
⎩

if Wi = 0,
if Wi = 1,

(−i)
j∈HL (i
θN )

for L ≥ 1 (typically, L = 1). Our proposed estimator for ct1 is

ct1 =

N

 






1 
θN 
Xi f Xi
μ̄ 1 F Xi θ∗ − 
μ̄ 0 F Xi θ∗ − 
τt 
N1 i=1

Notice that if Wi = w, the estimator of μ̄(w F(Xi θ∗ )) is an average over
HL(−i) (i 
θN ), rather than over HL (i 
θN ). If observation i was not excluded
to estimate μ̄(Wi  F(Xi θ∗ )), then Yi would be one of the terms of the average 
μ̄(Wi  F(Xi θ∗ )). Therefore, if observation i was not excluded, the estimaθN )(Yi − 
tor 
ct1 would contain terms of the type Xi f (Xi
μ̄(0 F(Xi θ∗ )) − 
τt )

 ∗

τt ) when
when Wi = 1 and terms of the type Xi f (Xi θN )(μ̄(1 F(Xi θ )) − Yi − 
Wi = 0. These terms estimate E[Xf (X  θ∗ )(μ(1 X) − μ̄(0 F(X  θ∗ )) − τt )]
and E[Xf (X  θ∗ )(μ̄(1 F(X  θ∗ )) − μ(0 X) − τt )], respectively, rather than
E[Xf (X  θ∗ )(μ̄(1 F(X  θ∗ )) − μ̄(0 F(X  θ∗ )) − τt )]. To avoid this problem, we
exclude observation i for the estimation of μ̄(Wi  F(Xi θ∗ )).

MATCHING ON THE ESTIMATED PROPENSITY SCORE

799

For the remaining variance component, ∂τt (θ∗ )/∂θ, notice that
 


∂τt  ∗ 
1
θ =    ∗  E Xf X  θ∗ Y (1) − Y (0) − τt
∂θ
E F Xθ
=

 


1
   ∗  E Xf X  θ∗ μ(1 X) − μ(0 X) − τt 
E F Xθ

To estimate this component, we need to estimate the regression functions
μ(1 X) and μ(0 X), which is done by matching on the covariates rather than
on the propensity score. Define the matching set (on covariates):

JLX (i) = j = 1     N : Wj = 1 − Wi 


1[

Xi −Xk ≤ Xi −Xj ]

≤L 

k:Wk =1−Wi

Our estimator of ∂τt (θ∗ )/∂θ is
N



1 
1 
∂τt
θN (2Wi − 1) Yi −
τt 
=
Xi f Xi
Yj − 
∂θ
N1 i=1
L X
j∈JL (i)

Putting these results together, our estimator of the large sample variance
of the propensity score matching estimator of the average treatment effect,
adjusted for first step estimation of the propensity score, is
2
c
Iθ−1
= σ2 − 
c

σadj
∗

The corresponding estimator for the variance for the estimator for the average
effect for the treated is
2

σadjt
ct +
Iθ−1
=
σt2 − 
ct 
∗



∂τt −1 
∂τt

Iθ∗
∂θ
∂θ

Consistency of these estimators for fixed L can be shown using the results in
Abadie and Imbens (2006) and the arguments employed in Section 3.
5. CONCLUSIONS AND EXTENSIONS
In this article, we derive the large sample distribution of propensity score
matching estimators for the case where the propensity score is unknown and
needs to be estimated in a first step prior to matching. We show that first step
estimation of the propensity score generally affects the asymptotic variance
of matching estimators, and derive adjustments for propensity score matching

800

A. ABADIE AND G. W. IMBENS

estimators of ATE and ATET. These results allow, for the first time, valid large
sample inference for estimators that use matching on the estimated propensity
score.
For concreteness, we frame the article within the context of estimation of
average treatment effects under the assumption that treatment assignment is
independent of potential outcomes conditional on a set of covariates, X (Assumption 1(i)). Without this assumption, the results of this article apply still to
the estimation of the “controlled comparison” parameters


E E[Y |X W = 1] − E[Y |X W = 0]
and


E[Y |W = 1] − E E[Y |X W = 0]|W = 1 
which have the same form as ATE and ATET parameters but lack a causal interpretation in the absence of Assumption 1(i). Controlled contrasts are the
building blocks of Oaxaca–Blinder-type decompositions, commonly applied
in economics (Oaxaca (1973), Blinder (1973), DiNardo, Fortin, and Lemieux
(1996)). The ideas and results in this article can easily be applied to other contexts where it is required to adjust for differences in the distribution of covariates between two samples. An important example is estimation with missing
data when missingness is random conditional on a set of covariates (see, e.g.,
Little and Rubin (2002), Wooldridge (2007)).
APPENDIX
Before proving Proposition 2, we introduce some additional notation. Using
τN (θ) can be written as
the definition of KMθ (i) in (8), the estimator 

τN (θ) =

N
1 
KMθ (i)
Yi 
(2Wi − 1) 1 +
N i=1
M

Define μ̄θ (w p) = Eθ [Y |W = w F(X  θ) = p], where Eθ is the expectation
operator under P θ ,
N






1  
μ̄θ 1 F Xi θ − μ̄θ 0 F Xi θ − τ
DN (θ) = √
N i=1
N



1 
KMθ (i) 
Yi − μ̄θ Wi  F Xi θ
+√
(2Wi − 1) 1 +
M
N i=1

MATCHING ON THE ESTIMATED PROPENSITY SCORE

801

and
N
1 
(2Wi − 1)
RN (θ) = √
N i=1







1 
μ̄θ 1 − Wi  F Xj θ 
× μ̄θ 1 − Wi  F Xi θ −
M j∈J (i)
M

Now the normalized estimator can be written as
√ 

N 
τN (θ) − τ = DN (θ) + RN (θ)
PROOF OF PROPOSITION 2: It can be seen that the result of Lemma S.1 in
the Supplemental Material (Abadie and Imbens (2016)) holds uniformly in θ
p
for θ − θ∗ ≤ ε. This implies RN (θN ) → 0. Therefore, in order to prove the
result in the proposition, it suffices to prove that, under P θN ,
⎞
D (θ )
√ N N
⎝ N(
θ − θ )⎠
 N∗ N
ΛN θ |θN
⎛
 ⎛ σ2
0
d
 ⎝ Iθ−1
→N⎝
0
∗ c

−h Iθ∗ h/2
−h c
⎛

c  Iθ−1
∗
Iθ−1
∗
−h

−c  h

⎞⎞

−h ⎠⎠ 
h Iθ∗ h

By Lemma 1, under P θN ,


1
ΛN θ∗ |θN = −h ΔN (θN ) − h Iθ∗ h + op (1)
2
and
√
N(
θN − θN ) = Iθ−1
∗ ΔN (θN ) + op (1)
Therefore, it suffices to prove that, under P θN ,
(A.1)

DN (θN )
ΔN (θN )

d

→N

0
σ2

c
0

c
Iθ∗



To prove (A.1), we extend the martingale representation of matching estimators (Abadie and Imbens (2012)) to allow for estimation of the propensity

802

A. ABADIE AND G. W. IMBENS

score. Consider the linear combination CN = z1 DN (θN ) + z2 ΔN (θN ):
N

 


 


1 
θN − μ̄θN 0 F XNi
θN − τ
CN = z1 √
μ̄θN 1 F XNi
N i=1

KMθN (i)
1 
+ z1 √
(2WNi − 1) 1 +
M
N i=1
 



θN
× YNi − μ̄θN WNi  F XNi
 

N

 

W
−
F
X
θ
1
Ni
N
Ni

 
 f XNi
XNi  
θN 
+ z2 √
F XNi θN 1 − F XNi θN
N i=1
N

We analyze CN using martingale methods. First, notice that
CN =

3N


ξNk 

k=1

where

 


 


1 
ξNk = z1 √ μ̄θN 1 F XNk
θN − μ̄θN 0 F XNk
θN − τ
N
 

1 
θN
+ z2 √ E XNk |F XNk
N
 

 

θN
WNk − F XNk

 
 f XNk
θN
×  
F XNk θN 1 − F XNk θN
for 1 ≤ k ≤ N,


 
1 
ξNk = z2 √ XNk−N − E XNk−N |F XNk−N
θN
N
 
  


θN f XNk−N
θN
WNk−N − F XNk−N
 

 

×
F XNk−N
θN 1 − F XNk−N
θN
KMθN (k − N)
1
+ z1 √ (2WNk−N − 1) 1 +
M
N
 



θN
× μ(WNk−N  XNk−N ) − μ̄θN WNk−N  F XNk−N

MATCHING ON THE ESTIMATED PROPENSITY SCORE

803

for N + 1 ≤ k ≤ 2N, and
KMθN (k − 2N)
1
ξNk = z1 √ (2WNk−2N − 1) 1 +
M
N


× YNk−2N − μ(WNk−2N  XNk−2N ) 

θN 
for 2N + 1 ≤ k ≤ 3N. Consider the σ-fields FNk = σ{WN1      WNk  XN1



    XNk θN } for 1 ≤ k ≤ N, FNk = σ{WN1      WNN  XN1 θN      XNN θN 
XN1      XNk−N } for N + 1 ≤ k ≤ 2N, and FNk = σ{WN1      WNN 
XN1      XNN  YN1      YNk−N } for 2N + 1 ≤ k ≤ 3N. Then,

 i



ξNj  FNi  1 ≤ i ≤ 3N

j=1

is a martingale for each N ≥ 1. Therefore, the limiting distribution of CN can
be studied using a Martingale Central Limit Theorem (e.g., Theorem 35.12
in Billingsley (1995, p. 476); importantly, notice that this theorem allows that
the probability space varies with N). Because of Assumption 4, and because
KMθ (i) has uniformly bounded moments (see Abadie and Imbens (2016)), it
follows that
3N




EθN |ξNk |2+δ → 0

for some δ > 0

k=1

Lindeberg’s condition in Billingsley’s theorem follows easily from the last
equation (Lyapunov’s condition). As a result, we obtain that, under P θN ,


d
CN → N 0 σ12 + σ22 + σ32 
where
σ12 = plim

N


 2

EθN ξNk
|FNk−1 

k=1

σ = plim
2
2

2N


 2

EθN ξNk
|FNk−1 

k=N+1

σ32 = plim

3N

k=2N+1

 2

EθN ξNk
|FNk−1 

804

A. ABADIE AND G. W. IMBENS

Assumption 5 implies
 





2 
σ12 = z12 E μ̄ 1 F X  θ∗ − μ̄ 0 F X  θ∗ − τ


f 2 X  θ∗



+ z2 E   ∗ 
F X θ 1 − F X  θ∗


  ∗      ∗ 
× E X|F X θ E X |F X θ
z2 
Expectations of the sums of terms involving (1 + KMθN (i)/M)2 can be calculated as in Abadie and Imbens (2016). We obtain




  ∗ 
f 2 X  θ∗

 var X|F X θ
z2
σ = z E   ∗ 
F X θ 1 − F X  θ∗





 
var μ(0 X)|F X  θ∗
var μ(1 X)|F X  θ∗
2




+
+ z1 E
F X  θ∗
1 − F X  θ∗
2
2


2

1
+z
E
2M
2
1


  ∗

  ∗ 
1

 −F X θ
var μ(1 X)|F X θ
F X  θ∗




1
  ∗  − 1 − F X  θ∗
1−F X θ




× var μ(0 X)|F X  θ∗
+ z12

1
E
2M




cov X μ(1 X)|F X  θ∗


+ 2z E
F X  θ∗




  ∗
cov X μ(0 X)|F X  θ∗


+
f X θ z1 
1 − F X  θ∗

2

Here we use the fact that, conditional on the propensity score, X is independent of W . Finally, notice that
N
2
KMθN (i)
1 
1+
N i=1
M




× var(Yi |Wi  Xi ) − E var(Yi |Wi  Xi )|Wi  F Xi θN

MATCHING ON THE ESTIMATED PROPENSITY SCORE

805

is a sum of martingale differences
2

ζNi =

KMθN (i)
1
1+
N
M




× var(Yi |Wi  Xi ) − E var(Yi |Wi  Xi )|Wi  F Xi θN

with respect to the filtration FNi = σ{W1      WN  X1 θN      X1 θN 
X1      Xi }. As a result, we obtain that, for i > j, E[ζNi ζNj |FNi−1 ] =
E[ζNi |FNi−1 ]ζNj = 0. Therefore, using the Law of Iterated Expectations to
eliminate the cross-products, we obtain

E

N
1 
ζNi
N i=1

2 


 N

1
2
= 2E
→ 0
ζNi
N
i=1

Therefore,
N
2



KMθN (i)
1 
E var(Yi |Wi  Xi )|Wi  F Xi θN
σ = z plim
1+
N i=1
M



E var(Y |X W = 1)|F X  θ∗
2


= z1 E
F X  θ∗


 
E var(Y |X W = 0)|F X  θ∗


+
1 − F X  θ∗
2
3

2
1



1
  ∗  − F X  θ∗
F Xθ


  ∗ 
× E var(Y |X W = 1)|F X θ
+ z12

1
E
2M




1
  ∗  − 1 − F X  θ∗
1−F X θ




× E var(Y |X W = 0)|F X  θ∗ 
+ z12

1
E
2M

Collecting terms and applying the fact that W is independent of X given
F(X  θ), we obtain
σ12 + σ22 + σ32 = z12 σ 2 + z2 Iθ∗ z2 + 2z2 cz1 

806

A. ABADIE AND G. W. IMBENS

Hence, by the Martingale Central Limit Theorem and the Cramer–Wold device, under P θN ,
DN (θN )
ΔN (θN )

d

→N

0
σ2

c
0

c
Iθ∗



proving (A.1) and thus Proposition 2.

Q.E.D.

PROOF OF THEOREM 1: Given our preliminary results, Theorem 1 follows
from Andreou and Werker (2012).
Q.E.D.
The proof of Theorem 2 can be found in the Supplemental Material.
REFERENCES
ABADIE, A. (2005): “Semiparametric Difference-in-Differences Estimators,” Review of Economic
Studies, 72 (1), 1–19. [782]
ABADIE, A., AND G. W. IMBENS (2006): “Large Sample Properties of Matching Estimators for
Average Treatment Effects,” Econometrica, 74 (1), 235–267. [781,784,785,789,795,796,799]
(2008): “On the Failure of the Bootstrap for Matching Estimators,” Econometrica, 76
(6), 1537–1557. [782]
(2011): “Bias-Corrected Matching Estimators for Average Treatment Effects,” Journal
of Business and Economic Statistics, 29 (1), 1–11. [784,787]
(2012): “A Martingale Representation for Matching Estimators,” Journal of the American Statistical Association, 107 (498), 833–843. [788,791,793,801]
(2016): “Supplement to ‘Matching on the Estimated Propensity Score’,” Econometrica
Supplemental Material, 84, http://dx.doi.org/10.3982/ECTA11293. [786,790,801,803,804]
ANDREOU, E., AND B. J. M. WERKER (2012): “An Alternative Asymptotic Analysis of ResidualBased Statistics,” Review of Economics and Statistics, 94 (1), 88–99. [788,791,792,806]
ANGRIST, J. D. (1998): “Estimating the Labor Market Impact of Voluntary Military Service Using
Social Security Data on Military Applicants,” Econometrica, 66 (2), 249–288. [789]
ANGRIST, J. D., AND G. M. KUERSTEINER (2011): “Causal Effects of Monetary Shocks: Semiparametric Conditional Independence Tests With a Multinomial Propensity Score,” Review of
Economics and Statistics, 93 (3), 725–747. [782]
BICKEL, P. J., C. A. KLAASSEN, Y. RITOV, AND J. A. WELLNER (1998): Efficient and Adaptive
Estimation for Semiparametric Models. New York: Springer. [790]
BILLINGSLEY, P. (1995): Probability and Measure. New York: Wiley. [803]
BLINDER, A. S. (1973): “Wage Discrimination: Reduced Form and Structural Estimates,” Journal
of Human Resources, 8 (4), 436–455. [800]
COCHRAN, W. G. (1968): “The Effectiveness of Adjustment by Subclassification in Removing Bias
in Observational Studies,” Biometrics, 24 (2), 295–313. [789]
DAWID, A. P. (1979): “Conditional Independence in Statistical Theory,” Journal of the Royal Statistical Society, Series B, 41 (1), 1–31. [783]
DEHEJIA, R., AND S. WAHBA (1999): “Causal Effects in Nonexperimental Studies: Reevaluating
the Evaluation of Training Programs,” Journal of the American Statistical Association, 94 (448),
1053–1062. [782,787]
DINARDO, J., N. M. FORTIN, AND T. LEMIEUX (1996): “Labor Market Institutions and the Distribution of Wages, 1973–1992: A Semiparametric Approach,” Econometrica, 64 (5), 1001–1044.
[800]
GOLDBERGER, A. S. (1991): A Course in Econometrics. Cambridge, MA: Harvard University
Press. [792]

MATCHING ON THE ESTIMATED PROPENSITY SCORE

807

HAHN, J. (1998): “On the Role of the Propensity Score in Efficient Semiparametric Estimation
of Average Treatment Effects,” Econometrica, 66 (2), 315–331. [781,783]
HECKMAN, J., H. ICHIMURA, AND P. TODD (1997): “Matching as an Econometric Evaluation
Estimator: Evidence From a Job Training Programme,” Review of Economic Studies, 64 (4),
605–654. [782]
(1998): “Matching as an Econometric Evaluation Estimator,” Review of Economic Studies, 65 (2), 261–294. [781,782]
HIRANO, K., G. W. IMBENS, AND G. RIDDER (2003): “Efficient Estimation of Average Treatment
Effects Using the Estimated Propensity Score,” Econometrica, 71 (4), 1161–1189. [782]
IMBENS, G. (2004): “Nonparametric Estimation of Average Treatment Effects Under Exogeneity:
A Review,” Review of Economics and Statistics, 86 (1), 1–29. [781]
IMBENS, G., AND J. WOOLDRIDGE (2009): “Recent Developments in the Econometrics of Program Evaluation,” Journal of Economic Literature, 47 (1), 5–86. [781]
KHAN, S., AND E. TAMER (2010): “Irregular Identification, Support Conditions, and Inverse
Weight Estimation,” Econometrica, 78 (6), 2021–2042. [783]
KIEFER, N. M., AND T. J. VOGELSANG (2005): “A New Asymptotic Theory for HeteroskedasticityAutocorrelation Robust Tests,” Econometric Theory, 21, 1130–1164. [784]
LEHMANN, E. L., AND J. P. ROMANO (2005): Testing Statistical Hypothesis. New York: Springer.
[790]
LITTLE, R. J., AND D. B. RUBIN (2002): Statistical Analysis With Missing Data (Second Ed.). Hoboken, NJ: Wiley-Interscience. [800]
NEWEY, W. K., AND D. MCFADDEN (1994): “Large Sample Estimation and Hypothesis Testing,”
in Handbook of Econometrics, Vol. 4, ed. by R. F. Engle and D. McFadden. Amsterdam: Elsevier Science. [782]
OAXACA, R. (1973): “Male–Female Wage Differentials in Urban Labor Markets,” International
Economic Review, 14 (3), 693–709. [800]
ROSENBAUM, P., AND D. B. RUBIN (1983): “The Central Role of the Propensity Score in Observational Studies for Causal Effects,” Biometrika, 70 (1), 41–55. [781,783,784,786]
RUBIN, D. B. (1974): “Estimating Causal Effects of Treatments in Randomized and NonRandomized Studies,” Journal of Educational Psychology, 66 (5), 688–701. [783,784]
SMITH, J., AND P. TODD (2005): “Does Matching Overcome LaLonde’s Critique of Nonexperimental Estimators?” Journal of Econometrics, 125 (1–2), 305–353. [782]
VAN DER VAART, A. (1998): Asymptotic Statistics. New York: Cambridge University Press. [790,
791]
WOOLDRIDGE, J. M. (2007): “Inverse Probability Weighted Estimation for General Missing Data
Problems,” Journal of Econometrics, 141 (2), 1281–1301. [782,800]
YATCHEW, A. (1997): “An Elementary Estimator of the Partial Linear Model,” Economics Letters,
75, 135–143. [784]

John F. Kennedy School of Government, 79 John F. Kennedy Street, Cambridge,
MA 02138, U.S.A. and NBER; alberto_abadie@harvard.edu
and
Stanford Graduate School of Business, 655 Knight Way, Stanford, CA 943057298, U.S.A. and NBER; imbens@stanford.edu.
Co-editor Elie Tamer handled this manuscript.
Manuscript received December, 2012; final revision received August, 2015.

