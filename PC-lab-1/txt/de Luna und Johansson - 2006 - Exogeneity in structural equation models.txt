ARTICLE IN PRESS

Journal of Econometrics 132 (2006) 527–543
www.elsevier.com/locate/jeconom

Exogeneity in structural equation models
Xavier de Lunaa,, Per Johanssonb
a

Department of Statistics, Umeå University, S-90187 Umeå, Sweden
Department of Economics, Uppsala University and Institute for Labour Market Policy Evaluation,
S-75120 Uppsala, Sweden

b

Available online 27 March 2005

Abstract
The practical relevance of several concepts of exogeneity of treatments for the estimation of
causal parameters based on observational data are discussed. We show that the traditional
concepts, such as strong ignorability and weak and super-exogeneity, are too restrictive if
interest lies in average effects (i.e. not on distributional effects of the treatment). We suggest a
new deﬁnition of exogeneity, KL-exogeneity. It does not rely on distributional assumptions
and is not based on counterfactual random variables. As a consequence it can be empirically
tested using a proposed test that is simple to implement and is distribution-free.
r 2005 Elsevier B.V. All rights reserved.
JEL classification: C12; C14; C15; C21; C31; C52
Keywords: Kullback–Leibler information; Linear exponential family; Potential outcomes; Ignorability;
Weak and super exogeneity

1. Introduction
A challenging issue with observational data is to assess whether causal conclusions
may be drawn from a given analysis. The concept of exogeneity is closely connected
to this issue, see, e.g., Koopmans (1950) and Imbens (1997).1
Corresponding author. Tel.: +46 90 7865559; fax: +46 90 7866614.

E-mail address: xavier.deluna@stat.umu.se (X. de Luna).
See also Holland (1986, with discussion) for an excellent overview on different deﬁnitions of causality,
and their implications on causal inference. An early reference on causal inference is Strotz and Wold
(1960).
1

0304-4076/$ - see front matter r 2005 Elsevier B.V. All rights reserved.
doi:10.1016/j.jeconom.2005.02.010

ARTICLE IN PRESS
X. de Luna, P. Johansson / Journal of Econometrics 132 (2006) 527–543

528

In many empirical applications, a structural equation model (SEM) is useful when
estimating causal effects. Assume, for the sake of illustration, that a SEM is
formulated as
yi ¼ a þ gzi þ ni .

(1)

The interpretation of a SEM is that g is the causal effect of zi when the value of zi is
set by the policy maker (intervention) and is hence not a passive observation (i.e. a
realization of a random variable). To avoid confusion one should distinguish the two
situations (intervention and observation) by rewriting (1) as
yi ¼ a þ ge
zi þ ni ,
where e
zi denotes an intervention variable which is set by the policy maker and is
therefore not a random variable.2
In contrast, the regression model for observational data is formulated as
yi ¼ y0 þ y1 z i þ  i ,
where Eðyi jzi Þ ¼ y0 þ y1 zi : In general, gay1 which makes the estimation of the causal
effect g difﬁcult.
In this context, and in the spirit of Strotz and Wold (1960), exogeneity of the
observed zi can be deﬁned by the condition
g ¼ y1 .

(2)

Thus, under this exogeneity condition, causal inference may be based on the
estimation of the parameters of Eðyi jzi Þ:
Different exogeneity concepts have been deﬁned in the literature (e.g., weak
and super exogeneity (Engle et al., 1983), ignorability of treatment assignment (Rosenbaum and Rubin, 1983)) which differ from the notion outlined
above.
In this paper, we propose a new deﬁnition of exogeneity, called Kullback–Leibler
(KL) (Kullback and Leibler, 1951) exogeneity, and relate it to the concepts
mentioned above. The KL-exogeneity deﬁnition is not based on hypothetical
(counterfactual) statements as (1) and strong ignorability are. It is instead based
on parameter invariance to confounders.3 This allow us to introduce a distribution-free test for exogeneity. For complex nonlinear SEM this test is simpler
to implement than a Hausman type test, see, e.g., Hausman (1978). Furthermore,
in some instances the test may be performed without instruments, see Example 4
below.
In Section 2, we present a general version of the exogeneity deﬁnition sketched in
this introduction with (2) and relate it to different exogeneity concepts presented in
the literature. In Section 3, KL-exogeneity is deﬁned and the distribution-free test of
KL-exogeneity is described. In Section 4, a Monte Carlo experiment, based on a
2

Here and in the sequel, zi denotes both the random variable and its realization, and e
zi denotes both the
policy intervention variable and its actual intervention value.
3
By a confounder we mean a variable that has an effect on both the outcome yi and the variable zi ; see
Deﬁnition 3.

ARTICLE IN PRESS
X. de Luna, P. Johansson / Journal of Econometrics 132 (2006) 527–543

529

structural equation count data regression model with a binary treatment, is used to
illustrate the test and to study its small sample performance. Section 5 concludes the
paper.

2. Exogeneity, SEM and potential outcomes
2.1. Defining exogeneity
Consider a SEM for an outcome yi ; a treatment variable zi and other covariates
gathered in the vector xi
yi ¼ hðxi ; zi ; bÞ þ ni .

(3)

The treatment zi is understood to be exogenous when passively observed values of zi
or active intervention on this variable have the same effect on the mean outcome.
In order to formalize this loose statement we follow Strotz and Wold (1960) and
interpret a SEM as (see also, Pearl, 2000, Section 5.4)4
hðxi ; e
zi ; bÞ ¼ Eeg ðyi jxi ; e
zi ; bÞ,
zi Þ; i.e. the density of yi
where the expectation is based on the density function geðyi jxi ; e
conditional on xi ; after external intervention on zi :5 Then, we can deﬁne zi to be
def
exogenous for a parameter w ¼ f0 ðbÞ when
w ¼ fðhÞ,

(4)

where h is the parameter vector in Eg ðyi jxi ; zi ; hÞ: the expectation deﬁned with
respect to the conditional density gðyi jxi ; zi Þ ¼ gðyi ; xi ; zi Þ=gðxi ; zi Þ:6; 7 In the
sequel, we do not specify the density used to deﬁne the expectation operator
when it is clear from the context. Note that the parameter w is structural since
it is a function of b by deﬁnition,8 while condition (4) ensures that it can be estimated
with observational data. A stronger deﬁnition of exogeneity would be (Pearl, 2000,
p. 166)
geðyi jxi ; Þ ¼ gðyi jxi ; Þ,

(5)

which is needed only when the interest lies in a causal effect on the density function
(i.e. distributional effects) instead of merely causal effects on the mean.
4

Pearl (2000) uses the notation doðe
zi Þ instead of e
zi :
The function geðyi jxi ; e
zi Þ can also be interpreted as the conditional density corresponding to a controlled
experiment where assignment to treatment zi is randomized.
6
In general, gðyi jxi ; zi Þae
gðyi jxi ; e
zi Þ; see next section for an example.
7
For most SEMs it would be possible to write w as a function of h and the other parameters
characterizing gðyi jxi ; zi Þ: Then, (4) says that we have exogeneity when w is a function of h only.
8
In linear SEM, i.e. hðÞ is linear in zi ; the causal parameter of interest is typically the effect of the
treatment c ¼ qhðxi ; zi ; bÞ=qzi :
5

ARTICLE IN PRESS
530

X. de Luna, P. Johansson / Journal of Econometrics 132 (2006) 527–543

Fig. 1. Directed acyclic graph representing the causal relations which are implicit in model (6–8), ignoring
i and zi :

2.2. Other concepts of exogeneity
We now discuss how different conditions for exogeneity—commonly found in the
literature—relate to (4) through an illustrative SEM:
yi ¼ b þ gzi þ ui þ i ,

(6)

z i ¼ a þ Zi ,

(7)

ui ¼ Zi z i ,

(8)
9

where i ; Zi and zi are regression error terms independent of each other.
Furthermore, Eðui jzi Þ ¼ 0 and Varðui jzi Þ ¼ ðzi  aÞ2 Varðzi Þ: The issue of interest is
whether zi is exogenous for g when ui is not observed. Since Eðui jzi Þ ¼ 0; we have that
(4) holds for w ¼ g:
In contrast, assuming the speciﬁc causal structure of Fig. 1, which is implicit in the
SEM above, we have (by Theorem 3.3.2 in Pearl, 2000)
Z
geðyi je
zi Þ ¼ gðyi jzi ; ui Þgðui Þ dui .
Therefore, in this example geðyi jÞagðyi jÞ; because gðui jzi Þagðui Þ: This suggests that
one needs to control for the unobserved variable ui in order to draw causal
conclusions. However, if the interest lies merely in the causal parameter g then ui can
be ignored since, as noted above, (4) holds for w ¼ g:
Weak exogeneity of a variable has been deﬁned by Engle et al. (1983) as a concept
of efﬁciency. Loosely, if gðyi ; zi Þ ¼ gðyi jzi ; hÞgðzi ; aÞ and h and a vary over a product
space, then zi is said to be weakly exogenous for h: In other words, the parameter h
can be efﬁciently estimated based solely on gðyi jzi ; hÞ: In the above example, the
9

That is they are independent of the other variables placed on the right-hand side of their respective
equation.

ARTICLE IN PRESS
X. de Luna, P. Johansson / Journal of Econometrics 132 (2006) 527–543

531

errors are heteroscedastic, with variance function of zi and a: Since the marginal
density of zi is also function of a; g cannot be estimated efﬁciently when ignoring the
marginal density of zi and, hence, zi is not weakly exogenous for g: However, it is not
efﬁciency but consistency in estimation of the causal parameter of interest which is
essential. Moreover, a variable may be weakly exogenous for a parameter which is
not causal (see Example 3, below).
Super exogeneity (also deﬁned in Engle et al., 1983) is, on the other hand, a causal
concept of exogeneity as (4) and (5) but is even stronger than (5), see Pearl (2000, p.
167). Indeed, although super exogeneity has causal content it intermingles issues of
correct model speciﬁcation, efﬁciency and causality as was noted by White (1994,
Section 7.2), thereby making it overly restrictive for policy analysis. White (1994,
Deﬁnition 7.14) also provides a necessary condition for causal analysis, which, for
cross-sectional situations can be translated as invariance of the conditional density of
yi jzi to intervention on zi : This is equivalent to (5).
The last concept of exogeneity that we discuss here is the condition of
strong ignorability introduced by Rosenbaum and Rubin (1983). For this purpose
we need to deﬁne potential outcomes variables. For a given intervention value e
zi ; the
random variable yi ðe
zi Þ is its potential outcome, i.e., we have gðyðe
zi ÞÞ  geðyi je
zi Þ: The
strong ignorability condition consists essentially in assuming yi ðe
zi Þ@zi :10 In the
example of this section we have yi ðe
zi Þ@zi jui ; while yi ðe
zi Þ zi : Thus, the strong
ignorability condition yi ðe
zi Þ@zi is again not a necessary condition to consistently
estimate g:

3. Kullback–Leibler invariance and exogeneity
Although the deﬁnition of exogeneity (4) is simple, it is a counterfactual statement
and as such is open to controversies, see, e.g., Dawid (2000). In this section, we
propose a causal concept of exogeneity deﬁned without counterfactuals. The simple
idea behind the deﬁnition is stability of estimated parameters to truncation with
respect to certain observed and possibly unobserved variables. This deﬁnition has the
advantage of also providing a distribution-free test of exogeneity.
Let yi and zi be two variables observed on individual i whose causal relationship
is deﬁned by (3).11 It is assumed that ðyi ; zi Þ; i ¼ 1; 2; . . . ; are independently
and identically distributed random variables. As above gðyi ; zi Þ; gðyi jzi Þ; gðyi Þ; gðzi Þ;
denote the true joint, conditional and marginal densities of these random
variables.
In order to investigate the effect of the treatment zi on the variable yi ; a
parametrized regression model with density f ðyi jzi ; hÞ; for yi given zi is speciﬁed up to
the parameter vector h taking value in a given space. We do not assume that
f ðyi jzi ; hÞ ¼ gðyi jzi Þ for one value of h; i.e. the model is possibly misspeciﬁed. This
10
The sign ‘‘@’’ stand for ‘‘independent of’’ and ‘‘ ’’ for ‘‘not independent of’’ as deﬁned in Dawid
(1979).
11
To simplify notation we ignore the covariates xi in the sequel.

ARTICLE IN PRESS
X. de Luna, P. Johansson / Journal of Econometrics 132 (2006) 527–543

532

parameter is estimated using a quasi maximum likelihood estimator (QMLE), i.e.,
n
1X
log f ðyi jzi ; hÞ
n i¼1

(9)

is maximized with respect to h; for the random sample, ðy1 ; z1 Þ; . . . ; ðyn ; zn Þ of size n.
We denote this QMLE b
h: The theory associated with quasi likelihood inference was
presented in White (1982), whose results are now brieﬂy summarized.
Under assumptions A1–A3 in White (1982), such an estimator exists and, as
n ! 1;
a:s:
b
h ! hn ,

where a.s. stands for almost sure convergence. Here, hn is the parameter vector
minimizing the Kullback and Leibler (1951) information criterion (KLIC), i.e.,
hn ¼ arg min Iðg : f ; hÞ,

(10)

h

where12
 

gðyi jzi Þ
Iðg : f ; hÞ ¼ Eg log
.
f ðyi jzi ; hÞ

(11)

The expectation operator Eg ðÞ is deﬁned with respect to the true density, here
gðyi ; zi Þ: The subscript g is omitted below. Further, under assumptions A1–A6 in
White (1982), as n ! 1;
pﬃﬃﬃ
d
nðb
h  hn Þ ! Nð0; Vðhn ÞÞ,
a:s:
and Vðb
hÞ ! Vðhn Þ; where
d stands for convergence in distribution. Here, Vðhn Þ ¼
1 1
1 1
J IJ and Vðb
hÞ ¼ b
J bIb
J ; where

0 
 2


q log f ðyi jzi ; hn Þ
q log f ðyi jzi ; hn Þ q log f ðyi jzi ; hn Þ
J¼E 
; I¼E
qhqh0
qh
qh
and
n
1X
q2 log f ðyi jzi ; b
hÞ
b

;
J¼
n i¼1
qhqh0

!0 #
"
n
X
b
b
1
q
log
f
ðy
jz
;
hÞ
q
log
f
ðy
jz
;
hÞ
i
i
i
i
bI ¼
.
n i¼1
qh
qh

Hence, even if the model for yi is misspeciﬁed (i.e. f ðyi jzi ; hÞ is different from gðyi jzi Þ
for any h), the QML estimator is strongly consistent (with respect to hn ), asymptotic
normal and has an estimable covariance matrix.
However, misspeciﬁcation must be restricted for the ﬁtted model f ðyi jzi ; b
hÞ to have
scientiﬁc content (other than predictive). Thus, this leads us to consider situations
where the estimated parameter is interpretable, i.e. where the parameter of interest is
invariant to truncation with respect to zi :
12

It is equivalent to compare f ðyjz; hÞ to gðy; zÞ or gðyjzÞ; because the former can be factorized as
gðy; zÞ ¼ gðyjzÞgðzÞ; and gðzÞ does not depend on the parameter on which the optimization takes place.

ARTICLE IN PRESS
X. de Luna, P. Johansson / Journal of Econometrics 132 (2006) 527–543

533

Deﬁnition 1. Let
tz ðzi Þ ¼ arg min Iðg : f ; hjzi Þ,
h

where
 
 
gðyi jzi Þ 
Iðg : f ; hjzi Þ ¼ E log
zi
f ðyi jzi ; hÞ 

(12)

is the KLIC conditional on zi : The parameter of interest w ¼ fðhÞ; a function of h
only, is said to be KL-invariant for zi if fðtz ðzi ÞÞ ¼ wn ; a constant, for any value of zi :
Remark 1. A parameter which is not a function of h only is not KL-invariant for zi
by deﬁnition. Moreover, when fðhÞ ¼ h; then wn ¼ hn :
A trivial example where the parameter is invariant is when there is no
misspeciﬁcation, i.e. f ðyi jzi ; h0 Þ ¼ gðyi jzi Þ for a given value h0 of h: The following
deﬁnition and result provide another class of situations where KL-invariance in zi is
guaranteed as soon as the conditional expectation Eðyi jzi Þ is well-speciﬁed.
Deﬁnition 2. The density f ðyi jzi ; hÞ belongs to the linear exponential family (LEF) if
it can be written in the form
log f ðyi jzi ; hÞ ¼ Aðmðzi ; hÞÞ þ Bðyi Þ þ Cðmðzi ; hÞÞyi ,
where mðzi ; hÞ is the conditional mean associated with f ðyi jzi ; hÞ; and AðmÞ; Bðyi Þ and
CðmÞ are scalar functions.
Proposition 1. Assume that f ðyi jzi ; hÞ belongs to the LEF. Under regularity
assumptions (see Gouriéroux et al. 1984, Appendix 1) and if mðzi ; hÞ is well specified,
i.e. Eðyi jzi Þ ¼ mðzi ; h0 Þ for h0 a particular value of h;13 we have that h is KL-invariant
for zi :
Proof. The conditional KLIC (12) is minimized with respect to h by maximizing
Eðlog f ðyi jzi ; hÞjzi Þ ¼ Aðmðzi ; hÞÞ þ E½Bðyi Þjzi  þ Cðmðzi ; hÞÞm0 ,
where m0 ¼ mðzi ; h0 Þ: However, this is equivalent to maximizing
Aðmðzi ; hÞÞ þ Cðmðzi ; hÞÞm0
since E½Bðyi Þjzi  does not depend on h: By Property 4 in Gouriéroux et al. (1984), this
expression is maximized at h ¼ h0 ; for any zi : Thus, h is KL-invariant for zi : &
Example 1. Let us consider the linear SEM
yi ¼ gzi þ ni ,
where ni is such that Eðni jzi Þ ¼ rzi ; ra0: Here y ¼ g þ r is the parameter entering
Eðyi jzi Þ ¼ mðzi ; yÞ: Proposition 1 says that when using a QMLE for y based on the
assumption that yi jzi has a distribution from the LEF (e.g. ordinary least squares,
OLS, estimator), then y is KL-invariant for zi : On the other hand, g is not KL13

By Theorem 1 in Gouriéroux et al. (1984) we know that hn ¼ h0 in (10).

ARTICLE IN PRESS
X. de Luna, P. Johansson / Journal of Econometrics 132 (2006) 527–543

534

invariant for zi if ra0; because then g ¼ y  r is not a function of y only, see
Remark 1.
Remark 2. Note that the result in Proposition 1 does not depend directly on the
density gðyi ; zi Þ; except in that mðzi ; hÞ must be well speciﬁed. On the other hand, the
density f ðyi jzi ; hÞ chosen to obtain a QMLE must be from the LEF. When such a
density is utilized, then if h is not KL-invariant for zi it implies that Eðyi jzi Þ is
misspeciﬁed.
We now give a deﬁnition of exogeneity valid in situations where the model is
possibly misspeciﬁed, although invariant for zi :
Deﬁnition 3. For a random variable ui ; let
tu ðui Þ ¼ arg min Iðg : f ; hjui Þ,
h

where
 
 
gðyi jzi Þ 
Iðg : f ; hjui Þ ¼ E log
ui .
f ðyi jzi ; hÞ 
If w ¼ fðhÞ; a function of h only, is KL-invariant for zi ; then the variable zi is said to
be KL-exogenous for w if for any random variable ui dependent with zi ; and such
that both yi and zi does not cause ui ; we have fðtu ðui ÞÞ ¼ fðtz ðzi ÞÞ ¼ wn : That is w is
also KL-invariant for any such ui :
Both yi and zi are scientiﬁc hypotheses which cannot be empirically tested in
observational studies. For instance, typical SEM used in economics for empirical
analysis implicitly state that the observed heterogeneity is not caused by the outcome
and the treatment; see, for instance, the example of Section 2.2 and Fig. 1. In this,
setting instruments are needed to estimate the effect of zi on yi : If ui is caused by yi or
zi ; then there is no need to control for the presence of ui ; even though ui is correlated
with both zi and yi :
Example 2. Consider the example in Section 2.2: zi was not exogenous for g by the
Engle et al. (1983) deﬁnitions. Indeed, one cannot neglect the second equation
without loosing information on g:14 On the other hand, by Deﬁnition 3, zi is
exogenous for g in the ﬁrst equation, since Zi is the only random variable dependent
on zi ; and clearly the quasi maximum likelihood estimator of g based on f ðyi jzi ; b; gÞ
from the LEF is consistent and independent on the values taken by Zi :
The following example further illustrates the differences between the concepts of
weak exogeneity and KL-exogeneity.
14
A referee noted that if i ; Zi and zi are jointly normal then, since the information matrix is blockdiagonal with respect to (b; gÞ and the remaining parameters, efﬁcient estimation of g can be based on the
marginal density only.

ARTICLE IN PRESS
X. de Luna, P. Johansson / Journal of Econometrics 132 (2006) 527–543

535

Example 3. Consider the sample selection SEM suggested by Garen (1984, 1988):
yi ¼ x0i b þ gzi þ ui þ i ,
zi ¼ xin0 d þ Zi ,

ð13Þ

ui ¼ lZi þ oi ,

(14)
n

n

ðx0i ; h0i Þ0

where Eðoi jZi Þ ¼ EðZi jxi Þ ¼ Eði jxi ; zi ; ui Þ ¼ 0; xi ¼
and xi and hi are vectors
of variables exogenous for the parameter of interest. Further assume that all
variables in the model are jointly normal. We can write
Eðyi jxi ; zi Þ ¼ x0i bn þ ðg þ rÞzi ,

(15)

where r is a function of, among other, l and d; b ab and the conditional
density f ðyi jxi ; zi ; hÞ is a normal density with location parameter h ¼ ðbn0 ; y2 Þ0 ;
where y2 ¼ g þ r: The interest in such a model lies typically in g: However, the
latter is a function of d; since g ¼ y2  r; and therefore is not a function of h
only. The consequence is that zi is not exogenous (endogenous) for g neither in
the Engle et al. (1983) sense nor in the sense of Deﬁnition 3. Let us now assume
that the interest lies in parameter y2 : Then, zi is weakly exogenous for y2 :
However, it is not exogenous in the sense of Deﬁnition 3, although as we
saw in Example 1, y2 is KL-invariant for zi : To see this, consider the sub-population deﬁned by Zi oc; where c is a given constant within the sample space of
Zi : Then
n

Eðyi jxi ; zi ; Zi ocÞ ¼ x0i bnc þ ðg þ rc Þzi ,

(16)

where jrc jojrj: For the sub-population of interest the maximum likelihood estimator is consistent for hc ¼ ðb0cn ; g þ rc Þ0 : This dependence of rc
(and b0cn Þ on Zi ; a random variable dependent on zi ; implies that zi is not exogenous
for y2 :
The intuition of (16)15 can be found from the observation that truncation of the
endogenous variable in a regression model will lead to biased estimates of the
population regression model.
In this example, we have that although h is estimated consistently and efﬁciently
(in particular h is KL-invariant for zi ); zi is not KL-exogenous for h: The same
variable is weakly exogenous for h: On the other hand, the parameter h is not causal,
while g is. For the latter parameter, both deﬁnitions imply non-exogeneity of zi : This
discussion could be applied to other typical econometric models of endogeneity (e.g.,
Vella, 1998).
In the example given in Section 2.2, zi is KL-exogenous for the parameters
of the model. Although for this example KL-exogeneity and (4) both hold, it
remains to be studied under which conditions these two concepts are equivalent.
An advantage with the KL-exogeneity deﬁnition over the counterfactual based
ones, is that it directly provides a test of exogeneity if potential ui are observed
(or can be estimated), without the need of specifying how they should
15

For a proof of the result see de Luna and Johansson (2001b).

ARTICLE IN PRESS
X. de Luna, P. Johansson / Journal of Econometrics 132 (2006) 527–543

536

be incorporated into the SEM. In the following this test of KL-exogeneity is
presented.
3.1. A Wald– Chow test
Assume that we have a random sample of n individuals for which a scalar
variable si has been observed. The data set can then be sorted with respect to
s (in ascending or descending order for si ), called a sorting score. Based on
this sorting, the sample is separated into two parts, one with si oc and one with
si 4c; where c is a ﬁxed truncation point. Further, the parameter h in f ðyi jzi ; hÞ
is estimated separately for each sub-sample using a QMLE, yielding b
hj
and Vðb
hj Þ; j ¼ 1 (si oc) and j ¼ 2 (si 4c). Finally, we can use the Wald
statistic
h2 Þ0 ðVðb
h1 Þ þ Vðb
h2 ÞÞ1 ðb
h1  b
h2 Þ
W ¼ ðb
h1  b

(17)

to test H0 : ‘h is KL-invariant for si ’. This is justiﬁed within the next two sections.
3.1.1. Size of the test
The proposition below shows that, under H0 ; the above Wald test statistic is
asymptotically w2 distributed with p (dimension of h) degrees of freedom. We call the
resulting test a Chow test, in reference to Chow (1960).
Proposition 2. Let A1–A6 in White (1982) hold (also when conditioning with respect
to si ). Then, under H0 : ‘‘h is KL-invariant for si ’’, the Wald statistic W is
asymptotically w2 ðpÞ distributed. Moreover, as n ! 1;
a:s:
b
h1  b
h2 ! 0

(18)

a:s:
h2 Þ ! Vðhn1 Þ þ Vðhn2 Þ.
Vðb
h1 Þ þ Vðb

(19)

and

Proof. Let hn1 ¼ arg maxh E½log f ðyi jzi ; hÞjsi oc:16 By the invariance of h for si ; we
have that
hn1 ¼ arg max E½log f ðyi jzi ; hÞjsi oc
h

¼ arg max E½log f ðyi jzi ; hÞ ¼ hn .
h

pﬃﬃﬃ b
d
a:s:
a:s:
h1 ! hn and Vðb
h1 Þ ! Vðhn1 Þ (White’s (1982)
Then,
nðh1  hn Þ ! Nð0; Vðhn1 ÞÞ; b
n
n
results summarized above). Note that, although h1 ¼ h ; Vðhn1 Þ and Vðhn Þ may
pﬃﬃdiffer.
ﬃ
Let
hn2 ¼ arg maxh E½log f ðyi jzi ; hÞjsi 4c:
Then,
similarly
nðb
h2 
d
a:s:
a:s:
hn Þ ! Nð0; Vðhn2 ÞÞ;pﬃﬃb
hﬃ 2 ! hn and Vðb
h2 Þ ! Vðhn2 Þ: Therefore, under H0 ; (18) and
d
(19) hold, and nðb
h1  b
h2 Þ ! Nð0; Vðhn1 Þ þ Vðhn2 ÞÞ; implying the asymptotic w2
distribution of the quadratic form W. &
Note that this is equivalent to minimizing (11), where the expectation is conditional on si oc:

16

ARTICLE IN PRESS
X. de Luna, P. Johansson / Journal of Econometrics 132 (2006) 527–543

537

Thus, the Chow test associated with an adequate sorting score has the correct size
asymptotically. Note that the choice of c is irrelevant for this result to hold.
We now give a result useful in the sequel.
Proposition 3. If h is KL-invariant for zi ; and yi and ui are two random variables which
are independent conditional on zi ; then h is also KL-invariant for ui :
Proof. We have
E½log f ðyi jzi ; hÞjui  ¼ EfE½log f ðyi jzi ; hÞjzi ; ui jui g
¼ EfE½log f ðyi jzi ; hÞjzi jui g
¼ Efkðzi ; hÞjui g.
The second equality is a consequence of yi and ui being independent, conditional
on zi :
By the KL-invariance of h for zi ;
 
 
gðyi jzi Þ 
zi
Iðg : f ; hjzi Þ ¼ E log
f ðyi jzi ; hÞ 
is minimized for h ¼ hn for any zi : Hence, arg maxh kðzi ; hÞ ¼ hn for any zi : Therefore,
we have, that kðzi ; hÞpkðzi ; hn Þ for all zi ; which implies
Z
Z
kðzi ; hÞgðzi jui Þ dzi p kðzi ; hn Þgðzi jui Þ dzi for all values for ui .
Hence,
arg max Ezju fkðzi ; hÞjui g ¼ hn .
h

Thus, h is also KL-invariant for ui :

&

Remark 3. By Proposition 3, zi is exogenous for h as soon as there is no
random variable ui which is both dependent with zi ; and dependent with yi
conditionally on zi :
3.1.2. Power of the test
When H0 in Proposition 2 does not hold, then in general hn1 ahn2 ; see e.g. Example
3. The above Chow test will then have power depending on the actual difference
hn1  hn2 ; which depends on the
cut point
c. The choice of c also affects the power
n
n
through its inﬂuence on Vðb
h1 Þ and Vðb
h2 Þ; e.g., the value of c determines the number
of observations available in the two sub-samples. In both cases, the inﬂuence of c on
the power is case-dependent and as a general rule, c may be chosen as the median of
the observed values for the sorting score, in order to have 50% of the observations in
each sub-sample.
Two main situations can be distinguished: (i) h is KL-invariant for zi only if zi is
exogenous and (ii) h is KL-invariant for zi even when the latter variable is not
exogenous.
Under situation (ii) (see, e.g., Example 3) Proposition 3 suggests sorting
scores guaranteeing the size of the test of exogeneity, i.e. choose si such that under

ARTICLE IN PRESS
538

X. de Luna, P. Johansson / Journal of Econometrics 132 (2006) 527–543

H0 ; ‘‘zi is exogenous for h’’, yi and si are independent conditional on zi : When
H0 does not hold, then there exists, by deﬁnition, an unobserved variable
ui dependent on zi ; such that h is not KL-invariant for ui : To obtain power for
the test an obvious choice is si ¼ ui : The latter is, however, typically unobserved.
Instead, assume that we have a sorting score si which is dependent on ui (and
therefore on zi ) and such that yi and si are independent, conditional on ui and zi :17; 18
Then, we can write
E½log f ðyi jzi ; hÞjsi oc ¼ EfE½log f ðyi jzi ; hÞjui ; zi ; si ocjsi ocg
¼ EfE½log f ðyi jzi ; hÞjui ; zi jsi ocg
¼ Efkðui ; zi ; hÞjsi ocg.
Because h is not KL-invariant for ui ; arg maxh kðui ; zi ; hÞ ¼ hðui Þ: Thus, in
general,
arg max Eu;z fkðui ; zi ; hÞjsi ocga arg max Eu;z fkðui ; zi ; hÞg,
h2Y

h

thereby implying that h1 ah2 :
For the ﬁrst situation (i), when the model is speciﬁed such that h is KL-invariant
for zi only if zi is exogenous for h; it is possible to test H0 ; ‘‘zi is exogenous for h’’ by
using si ¼ zi : This is a test for exogeneity without instruments and it will have power
since, in general, arg maxh E½log f ðyi jzi ; hÞjzi oca arg maxh E½log f ðyi jzi ; hÞjzi 4c:
n

n

Example 4. We conclude this section by revisiting Example 3, without making any
distributional assumption. We have
Eðyi jxi ; zi ; ui Þ ¼ x0i b þ gzi þ ui .

(20)

To perform inference we consider the normal density f ðyi jxi ; zi ; hÞ of Example 3.
If l ¼ 0 in (14), i.e. Eðui jzi Þ ¼ 0; then zi is exogenous for g: On the other hand,
if Eðui jzi Þ ¼ f ðzi Þ then zi is endogenous for g; see Example 3. Two cases
are distinguished: (i) Eðui jzi Þ is non-linear and (ii) Eðui jzi Þ is linear in zi : Under
(i) h ¼ ðbn0 ; y2 Þ0 is not KL-invariant for zi and, hence, the Chow test associated
with the sorting score si ¼ zi has power to identify the endogeneity. On the other
hand, under (ii) the same parameter h is KL-invariant for zi ; and another sorting
score than zi needs to be used to detect the endogeneity. Thus, we need to ﬁnd
another variable for which h is not KL-invariant under endogeneity. The error term
Zi in (13) is here a natural choice. Because Zi is not observed, the estimate si ¼ b
Zi ; i.e.
the residuals from ﬁtting (13), may be used. This is a sorting score based on
instruments, here hi :

17
This latter condition is not restrictive, and means that si would not need to be introduced in the model
to explain yi ; were zi and ui both available.
18
In practice, such a sorting score is obtained with the help of instrumental variables, see Example 4.

ARTICLE IN PRESS
X. de Luna, P. Johansson / Journal of Econometrics 132 (2006) 527–543

539

4. An example with a Monte Carlo experiment19
4.1. A count data SEM with binary treatment
Terza (1998) considered the setup, where conditional on xi ; zi and ui ; the response
yi is Poisson distributed with expectation and variance
Eðyi jxi ; zi ; ui Þ ¼ V ðyi jxi ; zi ; ui Þ ¼ expðx0i b1 þ gzi þ ui Þ

(21)

and the treatment endogeneity is modelled through a latent variable speciﬁcation:
zni ¼ a0 xni þ Zi ,
zi ¼ Iðzni 40Þ.
n

ðx0i ; h0i Þ0 ;

In general, xi ¼
of zi is modelled as

ð22Þ
where hi are variables not included in Eq. (21). Endogeneity

ui ¼ lZi þ zi .

(23)

In the framework of Terza (1998) Zi and ui are bivariate normal although this is not
necessary to use the Chow test. If l ¼ 0; i.e. ui and Zi are independent, then, for
e
zi ¼ zi ;
zi Þ ¼ expðb0 þ x0i b1 þ gzi Þ ¼ Eg ðyi jxi ; zi Þ.
Eeg ðyi jxi ; e

(24)

Thus, the parametrization of these two conditional expectations are identical and (4)
holds for any functions of the parameters involved in (24). In particular, zi is
exogenous for g; the effect of the treatment.
Again for l ¼ 0 and if (24) is estimated with a QMLE (using a density in the linear
exponential family), we can show that zi is KL-exogenous for g: By Proposition 1 we
have that g is KL-invariant in zi : When ui and Zi are independent, then g is KLinvariant in ui :
On the other hand, when la0; then g is not KL-invariant in zi which can be seen
by noting that the conditional expectation is misspeciﬁed, that is expðb0 þ x0i b1 þ
gzi ÞaEg ðyi jxi ; zi Þ:
4.2. Design of the experiment
The data is generated such that yi jxi ; zi ; ui is Poisson distributed with
Eðyi jxi ; zi ; ui Þ ¼ expðb0 þ lnð2Þxi þ zi þ ui Þ ¼ li expðui Þ,
zi ¼ Iððxi  hi þ Zi Þ40Þ,

ð25Þ

where b0 ¼ 0:18; ui and Zi are bivariate normal with expectations zero, variances
s2u ¼ 0:36; s2Z ¼ 1 and correlation r: We choose the sample sizes n ¼ 200; 400 and
800, the number of replications 1000 and the covariates—ﬁxed within repeated
samples—xi and hi are taken as uniform [0,1] variates.
19

Further Monte Carlo experiments and an empirical application are available in de Luna and
Johansson (2001a).

ARTICLE IN PRESS
X. de Luna, P. Johansson / Journal of Econometrics 132 (2006) 527–543

540

The conditional distribution of yi given xi and zi has no closed form, although
when r ¼ 0 we know that the ﬁrst two conditional moments20 are
Eðyi jxi ; zi Þ ¼ mi ¼ expðlnð2Þxi þ zi Þ

and

Varðyi jxi ; zi Þ ¼ mi ð1 þ 0:43mi Þ.

The regression model Eðyi jxi ; zi Þ ¼ expðb0 þ b1 xi þ gzi Þ is estimated, using the
Poisson’s QMLE. To test for KL-exogeneity of zi ; this is done separately on two subsamples of equal size obtained by ﬁrst ordering the data with respect to the variable
si ; described below. From the two sets of estimates the statistic W (17) is then
computed. The size of the test is obtained with r ¼ 0 and the power with r ¼
0:75; 0:5; 0:25; 0:25; 0:5 and 0.75.
In order to mimic the situation where ui is not observed we do not sort the sample
with respect to ui ; but use only the assumed observed variables, i.e. xi ; hi and zi ; and
the choice equation zi ¼ Iððxi  hi þ Zi Þ40Þ: We have noted in the previous section
that g is not KL-invariant in zi when ra0: We cannot, however, split the sample
with respect to zi ; thereby separating control (zi ¼ 0) from treated (zi ¼ 1), because g
cannot be estimated based solely on control or treated individuals. However, we can
use the predictions from the probit model si ¼ Prðzi ¼ 1jxni Þ ¼ Fðb
a0 xni Þ; where xni ¼
0
ðxi ; hi Þ ; FðÞ is the standard normal distribution function and b
a is the maximum
likelihood estimate. These predictions are correlated with zi and provide a sorting
which allows for the estimation of g:
Note that predictions from a linear probability model or a logit model (see, e.g.,
Amemiya, 1981) would yield approximately the same ordering as using a probit
model.
Terza (1998) suggests a two step method (TSM) to correct for selection in the
model (25). In a ﬁrst step, the probit model mentioned above is ﬁtted and then the
parameters of the following model are estimated
yi ¼ kðxni ; zi ; y; b
aÞ þ Zi

(26)

aÞ ¼ lðxni ; y; b
aÞmi ; where y ¼
with non-linear least squares (NLS). Here, kðxni ; zi ; y; b
0
r=su and




Fðy þ b
a0 xni Þ
1  Fðy þ b
a0 xni Þ
n
b
lðxi ; y; aÞ ¼ zi
þ ð1  zi Þ
.
Fðb
a0 xni Þ
1  Fðb
a0 xni Þ
Let s ¼ ðb0 ; b1 ; g; yÞ0 ; then the NLS estimator bs is consistent and asymptotically
normal.
20

Because ui Nð0; s2u Þ we obtain E expðui Þ ¼ expðs2u =2Þ ¼ expðb0 Þ: The conditional variance is
Varðyjxi ; zi Þ ¼ E½Varðyi jxi ; zi ; ui Þjxi ; zi  þ Var½Eðyi jxi ; zi ; ui Þjxi ; zi 
¼ E½li expðui Þjxi ; zi  þ Var½li expðui Þjxi ; zi 
¼ mi þ l2i Var expðui Þ
¼ mi þ l2i ½expð2s2u Þ  expðs2u Þ
¼ mi ½1 þ ðexpðs2u Þ  1Þmi :

ARTICLE IN PRESS
X. de Luna, P. Johansson / Journal of Econometrics 132 (2006) 527–543

541

Table 1
Power and size of several tests for exogeneity of a treatment variable in a count data regression model
(nominal level 5 percent)
r

0:75

0:5

0:25

0

0.25

0.50

0.75

n
t(TSM)
t(NLWLS)
W

200
0.135
0.114
0.142

0.072
0.065
0.098

0.034
0.030
0.090

0.014
0.015
0.081

0.009
0.019
0.090

0.010
0.038
0.092

0.015
0.066
0.144

n
t(TSM)
t(NLWLS)
W

400
0.406
0.424
0.235

0.169
0.176
0.147

0.075
0.081
0.093

0.021
0.029
0.060

0.016
0.062
0.073

0.032
0.118
0.123

0.095
0.275
0.205

n
t(TSM)
t(NLWLS)
W

800
0.744
0.802
0.392

0.360
0.406
0.183

0.115
0.130
0.096

0.033
0.034
0.063

0.046
0.100
0.075

0.177
0.322
0.163

0.434
0.639
0.339

A more efﬁcient estimator, also suggested by Terza (1998), is to estimate
yi ¼ kðxni ; zi ; y; b
aÞ þ Zi
with non-linear weighted least squares (NLWLS), using the fact that
VarðZi jxni ; zi Þ ¼ kðxni ; zi ; y; b
aÞ þ m2i ðexpfs2u glðxni ; 2y; b
aÞ  lðxni ; y; b
aÞ2 Þ.
Tests for exogeneity of zi are then performed as a Wald test of y ¼ 0 denoted t(TSM)
and t(NLWLS) for the above described methods respectively.21

4.3. Results
The results from the Monte Carlo study are displayed in Table 1. We can see that
the Wald test using the TSM and NLWLS both yield too small sizes, although this
improves when the sample size increases. On the other hand, the Chow test has too
large size for n ¼ 200; but this is corrected with larger samples. The power of the
tests is generally low. The power is higher with ro0 than with r40: The test with
the best performance is, as expected, the Wald test using the NLWLS estimator. The
Chow test and Wald test using the TSM have comparable power for small n and
generally for r40: These results must be put in contrast with the simplicity in
implementation of the Chow test and the fact that it makes less distributional
assumptions.
21

The Gauss code for the estimation were kindly provided to us by Joseph V. Terza.

ARTICLE IN PRESS
542

X. de Luna, P. Johansson / Journal of Econometrics 132 (2006) 527–543

5. Conclusion
In this paper we have discussed causal interpretation of parameters in a SEM, and
the associated concept of exogeneity which allows for estimation of these parameters
with observational data. We have argued that the counterfactual statement (4)
corresponds to the economist’s notion of exogeneity. This deﬁnition is contrasted
with previously proposed concepts of exogeneity (strong ignorability and weak and
super exogeneity) and the KL-exogeneity concept (parameter invariance to
confounders) introduced here. Concepts making no distributional assumptions are
preferred because in applications the interest lies often in causal parameters (e.g.,
average effect) instead of the whole outcome distribution for a given treatment.
In all the treated examples the KL-exogeneity concept has been found equivalent
to (4). An advantage with KL-exogeneity is that it is not based on counterfactuals
and directly suggests a test of exogeneity. The test is easy to implement and can be
used as a ﬁrst step test in complex non-linear SEM, avoiding the implementation of
full maximum likelihood estimators or two step methods as illustrated in the Monte
Carlo study. Furthermore, in contrast with the latter tests, the Chow test is
distribution free.

Acknowledgements
An earlier version of this paper was circulated under the title ‘‘Testing exogeneity
under distributional misspeciﬁcation.’’ We are grateful to two anonymous referees,
Joshua Angrist, Kurt Brännäs, Sune Karlsson, and participants at seminars held at;
the Department of Economic Statistics, Stockholm School of Economics; the
Department of Statistics, Uppsala University; the Department of Economics, Umeå
University; the Institute of for Labour Market Policy Evaluation, Uppsala; and the
EC2 conference on Causality and Exogeneity in Econometrics for helpful comments
on previous drafts of this paper.

References
Amemiya, T., 1981. Qualitative response models: a survey. Journal of Economic Literature XIX,
1483–1536.
Chow, G., 1960. Tests of equality between sets of coefﬁcients in two linear regressions. Econometrica 28,
591–605.
Dawid, A.P., 1979. Conditional independence in statistical theory. Journal of the Royal Statistical Society
Series B 41, 1–31.
Dawid, A.P., 2000. Causal inference without counterfactuals. Journal of the American Statistical
Association 95, 407–448.
de Luna, X., Johansson, P., 2001a. Testing exogeneity under distributional misspeciﬁcation. Working
Paper 2001:9, Institute for Labour Market Policy Evaluation (IFAU), Uppsala.
de Luna, X., Johansson, P., 2001b. Graphical diagnostics of endogeneity. Umeå Economic Studies 553,
Umeå.
Engle, R.F., Hendry, H.F., Richard, J.-F., 1983. Exogeneity. Econometrica 51, 277–304.

ARTICLE IN PRESS
X. de Luna, P. Johansson / Journal of Econometrics 132 (2006) 527–543

543

Garen, J., 1984. The returns to schooling: a selectivity bias approach with a continuous choice variable.
Econometrica 52, 1199–1218.
Garen, J., 1988. Compensating wage differentials and endogeneity of job riskiness. Review of Economics
and Statistics 70, 9–16.
Gouriéroux, C., Monfort, A., Trognon, A., 1984. Pseudo maximum likelihood methods: theory.
Econometrica 52, 681–700.
Hausman, J.A., 1978. Speciﬁcation test in econometrics. Econometrica 46, 1251–1271.
Holland, P., 1986. Statistics and causal inference, with discussion. Journal of the American Statistical
Association 81, 945–970.
Imbens, G.W., 1997. Book review: the foundation of econometric analysis. Journal of Applied
Econometrics 12, 91–94.
Koopmans, T.C., 1950. When is an equation system complete for statistical purposes. In: Koopmans, T.C.
(Ed.), Statistical Inference in Dynamic Economic Models. Wiley, New York, pp. 393–409.
Kullback, S., Leibler, R.A., 1951. On information and sufﬁciency. Annals of Mathematical Statistics 22,
79–86.
Pearl, J.P., 2000. Causality: Models, Reasoning and Inference. Cambridge University Press, Cambridge.
Rosenbaum, P.R., Rubin, D.B., 1983. The central role of the propensity score in observational studies for
causal effects. Biometrika 70, 41–55.
Strotz, R.H., Wold, H.O.A., 1960. Recursive vs. nonrecursive systems: an attempt at synthesis.
Econometrica 28, 417–427.
Terza, J.V., 1998. Estimating count data models with endogenous switching: sample selection and
exogenous treatments effects. Journal of Econometrics 84, 129–154.
Vella, F., 1998. Estimating models with sample selection bias: a survey. Journal of Human Resources
XXXIII, 127–169.
White, H., 1982. Maximum likelihood estimation of misspeciﬁed models. Econometrica 50, 1–25.
White, H., 1994. Estimation, inference and speciﬁcation analysis. Econometric Society Monographs, vol.
22. Cambridge University Press, Cambridge.

